(function(){const Ge=document.createElement("link").relList;if(Ge&&Ge.supports&&Ge.supports("modulepreload"))return;for(const Y of document.querySelectorAll('link[rel="modulepreload"]'))G(Y);new MutationObserver(Y=>{for(const d of Y)if(d.type==="childList")for(const v of d.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&G(v)}).observe(document,{childList:!0,subtree:!0});function m(Y){const d={};return Y.integrity&&(d.integrity=Y.integrity),Y.referrerpolicy&&(d.referrerPolicy=Y.referrerpolicy),Y.crossorigin==="use-credentials"?d.credentials="include":Y.crossorigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function G(Y){if(Y.ep)return;Y.ep=!0;const d=m(Y);fetch(Y.href,d)}})();function $h(Ee,Ge){const m=Object.create(null),G=Ee.split(",");for(let Y=0;Y<G.length;Y++)m[G[Y]]=!0;return Ge?Y=>!!m[Y.toLowerCase()]:Y=>!!m[Y]}const e1="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",t1=$h(e1);function E0(Ee){return!!Ee||Ee===""}function Qh(Ee){if(ea(Ee)){const Ge={};for(let m=0;m<Ee.length;m++){const G=Ee[m],Y=us(G)?i1(G):Qh(G);if(Y)for(const d in Y)Ge[d]=Y[d]}return Ge}else{if(us(Ee))return Ee;if(zo(Ee))return Ee}}const r1=/;(?![^(]*\))/g,n1=/:(.+)/;function i1(Ee){const Ge={};return Ee.split(r1).forEach(m=>{if(m){const G=m.split(n1);G.length>1&&(Ge[G[0].trim()]=G[1].trim())}}),Ge}function ep(Ee){let Ge="";if(us(Ee))Ge=Ee;else if(ea(Ee))for(let m=0;m<Ee.length;m++){const G=ep(Ee[m]);G&&(Ge+=G+" ")}else if(zo(Ee))for(const m in Ee)Ee[m]&&(Ge+=m+" ");return Ge.trim()}const Ja={},Yc=[],al=()=>{},a1=()=>!1,o1=/^on[^a-z]/,Of=Ee=>o1.test(Ee),tp=Ee=>Ee.startsWith("onUpdate:"),cs=Object.assign,rp=(Ee,Ge)=>{const m=Ee.indexOf(Ge);m>-1&&Ee.splice(m,1)},s1=Object.prototype.hasOwnProperty,fa=(Ee,Ge)=>s1.call(Ee,Ge),ea=Array.isArray,Mu=Ee=>Df(Ee)==="[object Map]",l1=Ee=>Df(Ee)==="[object Set]",ra=Ee=>typeof Ee=="function",us=Ee=>typeof Ee=="string",np=Ee=>typeof Ee=="symbol",zo=Ee=>Ee!==null&&typeof Ee=="object",L0=Ee=>zo(Ee)&&ra(Ee.then)&&ra(Ee.catch),c1=Object.prototype.toString,Df=Ee=>c1.call(Ee),u1=Ee=>Df(Ee).slice(8,-1),f1=Ee=>Df(Ee)==="[object Object]",ip=Ee=>us(Ee)&&Ee!=="NaN"&&Ee[0]!=="-"&&""+parseInt(Ee,10)===Ee,kf=$h(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),zf=Ee=>{const Ge=Object.create(null);return m=>Ge[m]||(Ge[m]=Ee(m))},h1=/-(\w)/g,xl=zf(Ee=>Ee.replace(h1,(Ge,m)=>m?m.toUpperCase():"")),p1=/\B([A-Z])/g,Jc=zf(Ee=>Ee.replace(p1,"-$1").toLowerCase()),Rf=zf(Ee=>Ee.charAt(0).toUpperCase()+Ee.slice(1)),Ch=zf(Ee=>Ee?`on${Rf(Ee)}`:""),Su=(Ee,Ge)=>!Object.is(Ee,Ge),Ph=(Ee,Ge)=>{for(let m=0;m<Ee.length;m++)Ee[m](Ge)},Ef=(Ee,Ge,m)=>{Object.defineProperty(Ee,Ge,{configurable:!0,enumerable:!1,value:m})},d1=Ee=>{const Ge=parseFloat(Ee);return isNaN(Ge)?Ee:Ge};let Kd;const m1=()=>Kd||(Kd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let ml;class g1{constructor(Ge=!1){this.detached=Ge,this.active=!0,this.effects=[],this.cleanups=[],this.parent=ml,!Ge&&ml&&(this.index=(ml.scopes||(ml.scopes=[])).push(this)-1)}run(Ge){if(this.active){const m=ml;try{return ml=this,Ge()}finally{ml=m}}}on(){ml=this}off(){ml=this.parent}stop(Ge){if(this.active){let m,G;for(m=0,G=this.effects.length;m<G;m++)this.effects[m].stop();for(m=0,G=this.cleanups.length;m<G;m++)this.cleanups[m]();if(this.scopes)for(m=0,G=this.scopes.length;m<G;m++)this.scopes[m].stop(!0);if(!this.detached&&this.parent&&!Ge){const Y=this.parent.scopes.pop();Y&&Y!==this&&(this.parent.scopes[this.index]=Y,Y.index=this.index)}this.parent=void 0,this.active=!1}}}function v1(Ee,Ge=ml){Ge&&Ge.active&&Ge.effects.push(Ee)}const ap=Ee=>{const Ge=new Set(Ee);return Ge.w=0,Ge.n=0,Ge},C0=Ee=>(Ee.w&Xl)>0,P0=Ee=>(Ee.n&Xl)>0,y1=({deps:Ee})=>{if(Ee.length)for(let Ge=0;Ge<Ee.length;Ge++)Ee[Ge].w|=Xl},x1=Ee=>{const{deps:Ge}=Ee;if(Ge.length){let m=0;for(let G=0;G<Ge.length;G++){const Y=Ge[G];C0(Y)&&!P0(Y)?Y.delete(Ee):Ge[m++]=Y,Y.w&=~Xl,Y.n&=~Xl}Ge.length=m}},Bh=new WeakMap;let Tu=0,Xl=1;const Nh=30;let rl;const gc=Symbol(""),jh=Symbol("");class op{constructor(Ge,m=null,G){this.fn=Ge,this.scheduler=m,this.active=!0,this.deps=[],this.parent=void 0,v1(this,G)}run(){if(!this.active)return this.fn();let Ge=rl,m=Wl;for(;Ge;){if(Ge===this)return;Ge=Ge.parent}try{return this.parent=rl,rl=this,Wl=!0,Xl=1<<++Tu,Tu<=Nh?y1(this):Jd(this),this.fn()}finally{Tu<=Nh&&x1(this),Xl=1<<--Tu,rl=this.parent,Wl=m,this.parent=void 0,this.deferStop&&this.stop()}}stop(){rl===this?this.deferStop=!0:this.active&&(Jd(this),this.onStop&&this.onStop(),this.active=!1)}}function Jd(Ee){const{deps:Ge}=Ee;if(Ge.length){for(let m=0;m<Ge.length;m++)Ge[m].delete(Ee);Ge.length=0}}let Wl=!0;const I0=[];function $c(){I0.push(Wl),Wl=!1}function Qc(){const Ee=I0.pop();Wl=Ee===void 0?!0:Ee}function Os(Ee,Ge,m){if(Wl&&rl){let G=Bh.get(Ee);G||Bh.set(Ee,G=new Map);let Y=G.get(m);Y||G.set(m,Y=ap()),O0(Y)}}function O0(Ee,Ge){let m=!1;Tu<=Nh?P0(Ee)||(Ee.n|=Xl,m=!C0(Ee)):m=!Ee.has(rl),m&&(Ee.add(rl),rl.deps.push(Ee))}function Ll(Ee,Ge,m,G,Y,d){const v=Bh.get(Ee);if(!v)return;let w=[];if(Ge==="clear")w=[...v.values()];else if(m==="length"&&ea(Ee))v.forEach((y,e)=>{(e==="length"||e>=G)&&w.push(y)});else switch(m!==void 0&&w.push(v.get(m)),Ge){case"add":ea(Ee)?ip(m)&&w.push(v.get("length")):(w.push(v.get(gc)),Mu(Ee)&&w.push(v.get(jh)));break;case"delete":ea(Ee)||(w.push(v.get(gc)),Mu(Ee)&&w.push(v.get(jh)));break;case"set":Mu(Ee)&&w.push(v.get(gc));break}if(w.length===1)w[0]&&Uh(w[0]);else{const y=[];for(const e of w)e&&y.push(...e);Uh(ap(y))}}function Uh(Ee,Ge){const m=ea(Ee)?Ee:[...Ee];for(const G of m)G.computed&&$d(G);for(const G of m)G.computed||$d(G)}function $d(Ee,Ge){(Ee!==rl||Ee.allowRecurse)&&(Ee.scheduler?Ee.scheduler():Ee.run())}const b1=$h("__proto__,__v_isRef,__isVue"),D0=new Set(Object.getOwnPropertyNames(Symbol).filter(Ee=>Ee!=="arguments"&&Ee!=="caller").map(Ee=>Symbol[Ee]).filter(np)),_1=sp(),w1=sp(!1,!0),T1=sp(!0),Qd=k1();function k1(){const Ee={};return["includes","indexOf","lastIndexOf"].forEach(Ge=>{Ee[Ge]=function(...m){const G=Ta(this);for(let d=0,v=this.length;d<v;d++)Os(G,"get",d+"");const Y=G[Ge](...m);return Y===-1||Y===!1?G[Ge](...m.map(Ta)):Y}}),["push","pop","shift","unshift","splice"].forEach(Ge=>{Ee[Ge]=function(...m){$c();const G=Ta(this)[Ge].apply(this,m);return Qc(),G}}),Ee}function sp(Ee=!1,Ge=!1){return function(G,Y,d){if(Y==="__v_isReactive")return!Ee;if(Y==="__v_isReadonly")return Ee;if(Y==="__v_isShallow")return Ge;if(Y==="__v_raw"&&d===(Ee?Ge?j1:N0:Ge?B0:F0).get(G))return G;const v=ea(G);if(!Ee&&v&&fa(Qd,Y))return Reflect.get(Qd,Y,d);const w=Reflect.get(G,Y,d);return(np(Y)?D0.has(Y):b1(Y))||(Ee||Os(G,"get",Y),Ge)?w:ns(w)?v&&ip(Y)?w:w.value:zo(w)?Ee?j0(w):up(w):w}}const M1=z0(),A1=z0(!0);function z0(Ee=!1){return function(m,G,Y,d){let v=m[G];if(Xc(v)&&ns(v)&&!ns(Y))return!1;if(!Ee&&(!Lf(Y)&&!Xc(Y)&&(v=Ta(v),Y=Ta(Y)),!ea(m)&&ns(v)&&!ns(Y)))return v.value=Y,!0;const w=ea(m)&&ip(G)?Number(G)<m.length:fa(m,G),y=Reflect.set(m,G,Y,d);return m===Ta(d)&&(w?Su(Y,v)&&Ll(m,"set",G,Y):Ll(m,"add",G,Y)),y}}function S1(Ee,Ge){const m=fa(Ee,Ge);Ee[Ge];const G=Reflect.deleteProperty(Ee,Ge);return G&&m&&Ll(Ee,"delete",Ge,void 0),G}function E1(Ee,Ge){const m=Reflect.has(Ee,Ge);return(!np(Ge)||!D0.has(Ge))&&Os(Ee,"has",Ge),m}function L1(Ee){return Os(Ee,"iterate",ea(Ee)?"length":gc),Reflect.ownKeys(Ee)}const R0={get:_1,set:M1,deleteProperty:S1,has:E1,ownKeys:L1},C1={get:T1,set(Ee,Ge){return!0},deleteProperty(Ee,Ge){return!0}},P1=cs({},R0,{get:w1,set:A1}),lp=Ee=>Ee,Ff=Ee=>Reflect.getPrototypeOf(Ee);function vf(Ee,Ge,m=!1,G=!1){Ee=Ee.__v_raw;const Y=Ta(Ee),d=Ta(Ge);m||(Ge!==d&&Os(Y,"get",Ge),Os(Y,"get",d));const{has:v}=Ff(Y),w=G?lp:m?hp:Eu;if(v.call(Y,Ge))return w(Ee.get(Ge));if(v.call(Y,d))return w(Ee.get(d));Ee!==Y&&Ee.get(Ge)}function yf(Ee,Ge=!1){const m=this.__v_raw,G=Ta(m),Y=Ta(Ee);return Ge||(Ee!==Y&&Os(G,"has",Ee),Os(G,"has",Y)),Ee===Y?m.has(Ee):m.has(Ee)||m.has(Y)}function xf(Ee,Ge=!1){return Ee=Ee.__v_raw,!Ge&&Os(Ta(Ee),"iterate",gc),Reflect.get(Ee,"size",Ee)}function e0(Ee){Ee=Ta(Ee);const Ge=Ta(this);return Ff(Ge).has.call(Ge,Ee)||(Ge.add(Ee),Ll(Ge,"add",Ee,Ee)),this}function t0(Ee,Ge){Ge=Ta(Ge);const m=Ta(this),{has:G,get:Y}=Ff(m);let d=G.call(m,Ee);d||(Ee=Ta(Ee),d=G.call(m,Ee));const v=Y.call(m,Ee);return m.set(Ee,Ge),d?Su(Ge,v)&&Ll(m,"set",Ee,Ge):Ll(m,"add",Ee,Ge),this}function r0(Ee){const Ge=Ta(this),{has:m,get:G}=Ff(Ge);let Y=m.call(Ge,Ee);Y||(Ee=Ta(Ee),Y=m.call(Ge,Ee)),G&&G.call(Ge,Ee);const d=Ge.delete(Ee);return Y&&Ll(Ge,"delete",Ee,void 0),d}function n0(){const Ee=Ta(this),Ge=Ee.size!==0,m=Ee.clear();return Ge&&Ll(Ee,"clear",void 0,void 0),m}function bf(Ee,Ge){return function(G,Y){const d=this,v=d.__v_raw,w=Ta(v),y=Ge?lp:Ee?hp:Eu;return!Ee&&Os(w,"iterate",gc),v.forEach((e,t)=>G.call(Y,y(e),y(t),d))}}function _f(Ee,Ge,m){return function(...G){const Y=this.__v_raw,d=Ta(Y),v=Mu(d),w=Ee==="entries"||Ee===Symbol.iterator&&v,y=Ee==="keys"&&v,e=Y[Ee](...G),t=m?lp:Ge?hp:Eu;return!Ge&&Os(d,"iterate",y?jh:gc),{next(){const{value:n,done:o}=e.next();return o?{value:n,done:o}:{value:w?[t(n[0]),t(n[1])]:t(n),done:o}},[Symbol.iterator](){return this}}}}function ql(Ee){return function(...Ge){return Ee==="delete"?!1:this}}function I1(){const Ee={get(d){return vf(this,d)},get size(){return xf(this)},has:yf,add:e0,set:t0,delete:r0,clear:n0,forEach:bf(!1,!1)},Ge={get(d){return vf(this,d,!1,!0)},get size(){return xf(this)},has:yf,add:e0,set:t0,delete:r0,clear:n0,forEach:bf(!1,!0)},m={get(d){return vf(this,d,!0)},get size(){return xf(this,!0)},has(d){return yf.call(this,d,!0)},add:ql("add"),set:ql("set"),delete:ql("delete"),clear:ql("clear"),forEach:bf(!0,!1)},G={get(d){return vf(this,d,!0,!0)},get size(){return xf(this,!0)},has(d){return yf.call(this,d,!0)},add:ql("add"),set:ql("set"),delete:ql("delete"),clear:ql("clear"),forEach:bf(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(d=>{Ee[d]=_f(d,!1,!1),m[d]=_f(d,!0,!1),Ge[d]=_f(d,!1,!0),G[d]=_f(d,!0,!0)}),[Ee,m,Ge,G]}const[O1,D1,z1,R1]=I1();function cp(Ee,Ge){const m=Ge?Ee?R1:z1:Ee?D1:O1;return(G,Y,d)=>Y==="__v_isReactive"?!Ee:Y==="__v_isReadonly"?Ee:Y==="__v_raw"?G:Reflect.get(fa(m,Y)&&Y in G?m:G,Y,d)}const F1={get:cp(!1,!1)},B1={get:cp(!1,!0)},N1={get:cp(!0,!1)},F0=new WeakMap,B0=new WeakMap,N0=new WeakMap,j1=new WeakMap;function U1(Ee){switch(Ee){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function V1(Ee){return Ee.__v_skip||!Object.isExtensible(Ee)?0:U1(u1(Ee))}function up(Ee){return Xc(Ee)?Ee:fp(Ee,!1,R0,F1,F0)}function H1(Ee){return fp(Ee,!1,P1,B1,B0)}function j0(Ee){return fp(Ee,!0,C1,N1,N0)}function fp(Ee,Ge,m,G,Y){if(!zo(Ee)||Ee.__v_raw&&!(Ge&&Ee.__v_isReactive))return Ee;const d=Y.get(Ee);if(d)return d;const v=V1(Ee);if(v===0)return Ee;const w=new Proxy(Ee,v===2?G:m);return Y.set(Ee,w),w}function Wc(Ee){return Xc(Ee)?Wc(Ee.__v_raw):!!(Ee&&Ee.__v_isReactive)}function Xc(Ee){return!!(Ee&&Ee.__v_isReadonly)}function Lf(Ee){return!!(Ee&&Ee.__v_isShallow)}function U0(Ee){return Wc(Ee)||Xc(Ee)}function Ta(Ee){const Ge=Ee&&Ee.__v_raw;return Ge?Ta(Ge):Ee}function V0(Ee){return Ef(Ee,"__v_skip",!0),Ee}const Eu=Ee=>zo(Ee)?up(Ee):Ee,hp=Ee=>zo(Ee)?j0(Ee):Ee;function H0(Ee){Wl&&rl&&(Ee=Ta(Ee),O0(Ee.dep||(Ee.dep=ap())))}function q0(Ee,Ge){Ee=Ta(Ee),Ee.dep&&Uh(Ee.dep)}function ns(Ee){return!!(Ee&&Ee.__v_isRef===!0)}function ku(Ee){return q1(Ee,!1)}function q1(Ee,Ge){return ns(Ee)?Ee:new G1(Ee,Ge)}class G1{constructor(Ge,m){this.__v_isShallow=m,this.dep=void 0,this.__v_isRef=!0,this._rawValue=m?Ge:Ta(Ge),this._value=m?Ge:Eu(Ge)}get value(){return H0(this),this._value}set value(Ge){const m=this.__v_isShallow||Lf(Ge)||Xc(Ge);Ge=m?Ge:Ta(Ge),Su(Ge,this._rawValue)&&(this._rawValue=Ge,this._value=m?Ge:Eu(Ge),q0(this))}}function Y1(Ee){return ns(Ee)?Ee.value:Ee}const W1={get:(Ee,Ge,m)=>Y1(Reflect.get(Ee,Ge,m)),set:(Ee,Ge,m,G)=>{const Y=Ee[Ge];return ns(Y)&&!ns(m)?(Y.value=m,!0):Reflect.set(Ee,Ge,m,G)}};function G0(Ee){return Wc(Ee)?Ee:new Proxy(Ee,W1)}function wf(Ee){const Ge=ea(Ee)?new Array(Ee.length):{};for(const m in Ee)Ge[m]=X1(Ee,m);return Ge}class Z1{constructor(Ge,m,G){this._object=Ge,this._key=m,this._defaultValue=G,this.__v_isRef=!0}get value(){const Ge=this._object[this._key];return Ge===void 0?this._defaultValue:Ge}set value(Ge){this._object[this._key]=Ge}}function X1(Ee,Ge,m){const G=Ee[Ge];return ns(G)?G:new Z1(Ee,Ge,m)}var Y0;class K1{constructor(Ge,m,G,Y){this._setter=m,this.dep=void 0,this.__v_isRef=!0,this[Y0]=!1,this._dirty=!0,this.effect=new op(Ge,()=>{this._dirty||(this._dirty=!0,q0(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!Y,this.__v_isReadonly=G}get value(){const Ge=Ta(this);return H0(Ge),(Ge._dirty||!Ge._cacheable)&&(Ge._dirty=!1,Ge._value=Ge.effect.run()),Ge._value}set value(Ge){this._setter(Ge)}}Y0="__v_isReadonly";function J1(Ee,Ge,m=!1){let G,Y;const d=ra(Ee);return d?(G=Ee,Y=al):(G=Ee.get,Y=Ee.set),new K1(G,Y,d||!Y,m)}function Zl(Ee,Ge,m,G){let Y;try{Y=G?Ee(...G):Ee()}catch(d){Bf(d,Ge,m)}return Y}function Ns(Ee,Ge,m,G){if(ra(Ee)){const d=Zl(Ee,Ge,m,G);return d&&L0(d)&&d.catch(v=>{Bf(v,Ge,m)}),d}const Y=[];for(let d=0;d<Ee.length;d++)Y.push(Ns(Ee[d],Ge,m,G));return Y}function Bf(Ee,Ge,m,G=!0){const Y=Ge?Ge.vnode:null;if(Ge){let d=Ge.parent;const v=Ge.proxy,w=m;for(;d;){const e=d.ec;if(e){for(let t=0;t<e.length;t++)if(e[t](Ee,v,w)===!1)return}d=d.parent}const y=Ge.appContext.config.errorHandler;if(y){Zl(y,null,10,[Ee,v,w]);return}}$1(Ee,m,Y,G)}function $1(Ee,Ge,m,G=!0){console.error(Ee)}let Lu=!1,Vh=!1;const ls=[];let yl=0;const Zc=[];let Sl=null,pc=0;const W0=Promise.resolve();let pp=null;function Q1(Ee){const Ge=pp||W0;return Ee?Ge.then(this?Ee.bind(this):Ee):Ge}function ev(Ee){let Ge=yl+1,m=ls.length;for(;Ge<m;){const G=Ge+m>>>1;Cu(ls[G])<Ee?Ge=G+1:m=G}return Ge}function dp(Ee){(!ls.length||!ls.includes(Ee,Lu&&Ee.allowRecurse?yl+1:yl))&&(Ee.id==null?ls.push(Ee):ls.splice(ev(Ee.id),0,Ee),Z0())}function Z0(){!Lu&&!Vh&&(Vh=!0,pp=W0.then(K0))}function tv(Ee){const Ge=ls.indexOf(Ee);Ge>yl&&ls.splice(Ge,1)}function rv(Ee){ea(Ee)?Zc.push(...Ee):(!Sl||!Sl.includes(Ee,Ee.allowRecurse?pc+1:pc))&&Zc.push(Ee),Z0()}function i0(Ee,Ge=Lu?yl+1:0){for(;Ge<ls.length;Ge++){const m=ls[Ge];m&&m.pre&&(ls.splice(Ge,1),Ge--,m())}}function X0(Ee){if(Zc.length){const Ge=[...new Set(Zc)];if(Zc.length=0,Sl){Sl.push(...Ge);return}for(Sl=Ge,Sl.sort((m,G)=>Cu(m)-Cu(G)),pc=0;pc<Sl.length;pc++)Sl[pc]();Sl=null,pc=0}}const Cu=Ee=>Ee.id==null?1/0:Ee.id,nv=(Ee,Ge)=>{const m=Cu(Ee)-Cu(Ge);if(m===0){if(Ee.pre&&!Ge.pre)return-1;if(Ge.pre&&!Ee.pre)return 1}return m};function K0(Ee){Vh=!1,Lu=!0,ls.sort(nv);const Ge=al;try{for(yl=0;yl<ls.length;yl++){const m=ls[yl];m&&m.active!==!1&&Zl(m,null,14)}}finally{yl=0,ls.length=0,X0(),Lu=!1,pp=null,(ls.length||Zc.length)&&K0()}}function iv(Ee,Ge,...m){if(Ee.isUnmounted)return;const G=Ee.vnode.props||Ja;let Y=m;const d=Ge.startsWith("update:"),v=d&&Ge.slice(7);if(v&&v in G){const t=`${v==="modelValue"?"model":v}Modifiers`,{number:n,trim:o}=G[t]||Ja;o&&(Y=m.map(r=>r.trim())),n&&(Y=m.map(d1))}let w,y=G[w=Ch(Ge)]||G[w=Ch(xl(Ge))];!y&&d&&(y=G[w=Ch(Jc(Ge))]),y&&Ns(y,Ee,6,Y);const e=G[w+"Once"];if(e){if(!Ee.emitted)Ee.emitted={};else if(Ee.emitted[w])return;Ee.emitted[w]=!0,Ns(e,Ee,6,Y)}}function J0(Ee,Ge,m=!1){const G=Ge.emitsCache,Y=G.get(Ee);if(Y!==void 0)return Y;const d=Ee.emits;let v={},w=!1;if(!ra(Ee)){const y=e=>{const t=J0(e,Ge,!0);t&&(w=!0,cs(v,t))};!m&&Ge.mixins.length&&Ge.mixins.forEach(y),Ee.extends&&y(Ee.extends),Ee.mixins&&Ee.mixins.forEach(y)}return!d&&!w?(zo(Ee)&&G.set(Ee,null),null):(ea(d)?d.forEach(y=>v[y]=null):cs(v,d),zo(Ee)&&G.set(Ee,v),v)}function Nf(Ee,Ge){return!Ee||!Of(Ge)?!1:(Ge=Ge.slice(2).replace(/Once$/,""),fa(Ee,Ge[0].toLowerCase()+Ge.slice(1))||fa(Ee,Jc(Ge))||fa(Ee,Ge))}let nl=null,jf=null;function Cf(Ee){const Ge=nl;return nl=Ee,jf=Ee&&Ee.type.__scopeId||null,Ge}function mp(Ee){jf=Ee}function gp(){jf=null}function av(Ee,Ge=nl,m){if(!Ge||Ee._n)return Ee;const G=(...Y)=>{G._d&&m0(-1);const d=Cf(Ge);let v;try{v=Ee(...Y)}finally{Cf(d),G._d&&m0(1)}return v};return G._n=!0,G._c=!0,G._d=!0,G}function Ih(Ee){const{type:Ge,vnode:m,proxy:G,withProxy:Y,props:d,propsOptions:[v],slots:w,attrs:y,emit:e,render:t,renderCache:n,data:o,setupState:r,ctx:g,inheritAttrs:c}=Ee;let a,h;const l=Cf(Ee);try{if(m.shapeFlag&4){const p=Y||G;a=vl(t.call(p,p,n,d,r,o,g)),h=y}else{const p=Ge;a=vl(p.length>1?p(d,{attrs:y,slots:w,emit:e}):p(d,null)),h=Ge.props?y:ov(y)}}catch(p){Au.length=0,Bf(p,Ee,1),a=Ra(El)}let s=a;if(h&&c!==!1){const p=Object.keys(h),{shapeFlag:u}=s;p.length&&u&7&&(v&&p.some(tp)&&(h=sv(h,v)),s=Kl(s,h))}return m.dirs&&(s=Kl(s),s.dirs=s.dirs?s.dirs.concat(m.dirs):m.dirs),m.transition&&(s.transition=m.transition),a=s,Cf(l),a}const ov=Ee=>{let Ge;for(const m in Ee)(m==="class"||m==="style"||Of(m))&&((Ge||(Ge={}))[m]=Ee[m]);return Ge},sv=(Ee,Ge)=>{const m={};for(const G in Ee)(!tp(G)||!(G.slice(9)in Ge))&&(m[G]=Ee[G]);return m};function lv(Ee,Ge,m){const{props:G,children:Y,component:d}=Ee,{props:v,children:w,patchFlag:y}=Ge,e=d.emitsOptions;if(Ge.dirs||Ge.transition)return!0;if(m&&y>=0){if(y&1024)return!0;if(y&16)return G?a0(G,v,e):!!v;if(y&8){const t=Ge.dynamicProps;for(let n=0;n<t.length;n++){const o=t[n];if(v[o]!==G[o]&&!Nf(e,o))return!0}}}else return(Y||w)&&(!w||!w.$stable)?!0:G===v?!1:G?v?a0(G,v,e):!0:!!v;return!1}function a0(Ee,Ge,m){const G=Object.keys(Ge);if(G.length!==Object.keys(Ee).length)return!0;for(let Y=0;Y<G.length;Y++){const d=G[Y];if(Ge[d]!==Ee[d]&&!Nf(m,d))return!0}return!1}function cv({vnode:Ee,parent:Ge},m){for(;Ge&&Ge.subTree===Ee;)(Ee=Ge.vnode).el=m,Ge=Ge.parent}const uv=Ee=>Ee.__isSuspense;function fv(Ee,Ge){Ge&&Ge.pendingBranch?ea(Ee)?Ge.effects.push(...Ee):Ge.effects.push(Ee):rv(Ee)}function hv(Ee,Ge){if(Zo){let m=Zo.provides;const G=Zo.parent&&Zo.parent.provides;G===m&&(m=Zo.provides=Object.create(G)),m[Ee]=Ge}}function Oh(Ee,Ge,m=!1){const G=Zo||nl;if(G){const Y=G.parent==null?G.vnode.appContext&&G.vnode.appContext.provides:G.parent.provides;if(Y&&Ee in Y)return Y[Ee];if(arguments.length>1)return m&&ra(Ge)?Ge.call(G.proxy):Ge}}const o0={};function rs(Ee,Ge,m){return $0(Ee,Ge,m)}function $0(Ee,Ge,{immediate:m,deep:G,flush:Y,onTrack:d,onTrigger:v}=Ja){const w=Zo;let y,e=!1,t=!1;if(ns(Ee)?(y=()=>Ee.value,e=Lf(Ee)):Wc(Ee)?(y=()=>Ee,G=!0):ea(Ee)?(t=!0,e=Ee.some(h=>Wc(h)||Lf(h)),y=()=>Ee.map(h=>{if(ns(h))return h.value;if(Wc(h))return Gc(h);if(ra(h))return Zl(h,w,2)})):ra(Ee)?Ge?y=()=>Zl(Ee,w,2):y=()=>{if(!(w&&w.isUnmounted))return n&&n(),Ns(Ee,w,3,[o])}:y=al,Ge&&G){const h=y;y=()=>Gc(h())}let n,o=h=>{n=a.onStop=()=>{Zl(h,w,4)}};if(Iu)return o=al,Ge?m&&Ns(Ge,w,3,[y(),t?[]:void 0,o]):y(),al;let r=t?[]:o0;const g=()=>{if(!!a.active)if(Ge){const h=a.run();(G||e||(t?h.some((l,s)=>Su(l,r[s])):Su(h,r)))&&(n&&n(),Ns(Ge,w,3,[h,r===o0?void 0:r,o]),r=h)}else a.run()};g.allowRecurse=!!Ge;let c;Y==="sync"?c=g:Y==="post"?c=()=>Ms(g,w&&w.suspense):(g.pre=!0,w&&(g.id=w.uid),c=()=>dp(g));const a=new op(y,c);return Ge?m?g():r=a.run():Y==="post"?Ms(a.run.bind(a),w&&w.suspense):a.run(),()=>{a.stop(),w&&w.scope&&rp(w.scope.effects,a)}}function pv(Ee,Ge,m){const G=this.proxy,Y=us(Ee)?Ee.includes(".")?Q0(G,Ee):()=>G[Ee]:Ee.bind(G,G);let d;ra(Ge)?d=Ge:(d=Ge.handler,m=Ge);const v=Zo;Kc(this);const w=$0(Y,d.bind(G),m);return v?Kc(v):vc(),w}function Q0(Ee,Ge){const m=Ge.split(".");return()=>{let G=Ee;for(let Y=0;Y<m.length&&G;Y++)G=G[m[Y]];return G}}function Gc(Ee,Ge){if(!zo(Ee)||Ee.__v_skip||(Ge=Ge||new Set,Ge.has(Ee)))return Ee;if(Ge.add(Ee),ns(Ee))Gc(Ee.value,Ge);else if(ea(Ee))for(let m=0;m<Ee.length;m++)Gc(Ee[m],Ge);else if(l1(Ee)||Mu(Ee))Ee.forEach(m=>{Gc(m,Ge)});else if(f1(Ee))for(const m in Ee)Gc(Ee[m],Ge);return Ee}function dv(){const Ee={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Hf(()=>{Ee.isMounted=!0}),nm(()=>{Ee.isUnmounting=!0}),Ee}const Bs=[Function,Array],mv={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Bs,onEnter:Bs,onAfterEnter:Bs,onEnterCancelled:Bs,onBeforeLeave:Bs,onLeave:Bs,onAfterLeave:Bs,onLeaveCancelled:Bs,onBeforeAppear:Bs,onAppear:Bs,onAfterAppear:Bs,onAppearCancelled:Bs},setup(Ee,{slots:Ge}){const m=ty(),G=dv();let Y;return()=>{const d=Ge.default&&tm(Ge.default(),!0);if(!d||!d.length)return;let v=d[0];if(d.length>1){for(const c of d)if(c.type!==El){v=c;break}}const w=Ta(Ee),{mode:y}=w;if(G.isLeaving)return Dh(v);const e=s0(v);if(!e)return Dh(v);const t=Hh(e,w,G,m);qh(e,t);const n=m.subTree,o=n&&s0(n);let r=!1;const{getTransitionKey:g}=e.type;if(g){const c=g();Y===void 0?Y=c:c!==Y&&(Y=c,r=!0)}if(o&&o.type!==El&&(!dc(e,o)||r)){const c=Hh(o,w,G,m);if(qh(o,c),y==="out-in")return G.isLeaving=!0,c.afterLeave=()=>{G.isLeaving=!1,m.update()},Dh(v);y==="in-out"&&e.type!==El&&(c.delayLeave=(a,h,l)=>{const s=em(G,o);s[String(o.key)]=o,a._leaveCb=()=>{h(),a._leaveCb=void 0,delete t.delayedLeave},t.delayedLeave=l})}return v}}},gv=mv;function em(Ee,Ge){const{leavingVNodes:m}=Ee;let G=m.get(Ge.type);return G||(G=Object.create(null),m.set(Ge.type,G)),G}function Hh(Ee,Ge,m,G){const{appear:Y,mode:d,persisted:v=!1,onBeforeEnter:w,onEnter:y,onAfterEnter:e,onEnterCancelled:t,onBeforeLeave:n,onLeave:o,onAfterLeave:r,onLeaveCancelled:g,onBeforeAppear:c,onAppear:a,onAfterAppear:h,onAppearCancelled:l}=Ge,s=String(Ee.key),p=em(m,Ee),u=(f,_)=>{f&&Ns(f,G,9,_)},i=(f,_)=>{const b=_[1];u(f,_),ea(f)?f.every(T=>T.length<=1)&&b():f.length<=1&&b()},x={mode:d,persisted:v,beforeEnter(f){let _=w;if(!m.isMounted)if(Y)_=c||w;else return;f._leaveCb&&f._leaveCb(!0);const b=p[s];b&&dc(Ee,b)&&b.el._leaveCb&&b.el._leaveCb(),u(_,[f])},enter(f){let _=y,b=e,T=t;if(!m.isMounted)if(Y)_=a||y,b=h||e,T=l||t;else return;let k=!1;const L=f._enterCb=A=>{k||(k=!0,A?u(T,[f]):u(b,[f]),x.delayedLeave&&x.delayedLeave(),f._enterCb=void 0)};_?i(_,[f,L]):L()},leave(f,_){const b=String(Ee.key);if(f._enterCb&&f._enterCb(!0),m.isUnmounting)return _();u(n,[f]);let T=!1;const k=f._leaveCb=L=>{T||(T=!0,_(),L?u(g,[f]):u(r,[f]),f._leaveCb=void 0,p[b]===Ee&&delete p[b])};p[b]=Ee,o?i(o,[f,k]):k()},clone(f){return Hh(f,Ge,m,G)}};return x}function Dh(Ee){if(Uf(Ee))return Ee=Kl(Ee),Ee.children=null,Ee}function s0(Ee){return Uf(Ee)?Ee.children?Ee.children[0]:void 0:Ee}function qh(Ee,Ge){Ee.shapeFlag&6&&Ee.component?qh(Ee.component.subTree,Ge):Ee.shapeFlag&128?(Ee.ssContent.transition=Ge.clone(Ee.ssContent),Ee.ssFallback.transition=Ge.clone(Ee.ssFallback)):Ee.transition=Ge}function tm(Ee,Ge=!1,m){let G=[],Y=0;for(let d=0;d<Ee.length;d++){let v=Ee[d];const w=m==null?v.key:String(m)+String(v.key!=null?v.key:d);v.type===Is?(v.patchFlag&128&&Y++,G=G.concat(tm(v.children,Ge,w))):(Ge||v.type!==El)&&G.push(w!=null?Kl(v,{key:w}):v)}if(Y>1)for(let d=0;d<G.length;d++)G[d].patchFlag=-2;return G}function vv(Ee){return ra(Ee)?{setup:Ee,name:Ee.name}:Ee}const Mf=Ee=>!!Ee.type.__asyncLoader,Uf=Ee=>Ee.type.__isKeepAlive;function yv(Ee,Ge){rm(Ee,"a",Ge)}function xv(Ee,Ge){rm(Ee,"da",Ge)}function rm(Ee,Ge,m=Zo){const G=Ee.__wdc||(Ee.__wdc=()=>{let Y=m;for(;Y;){if(Y.isDeactivated)return;Y=Y.parent}return Ee()});if(Vf(Ge,G,m),m){let Y=m.parent;for(;Y&&Y.parent;)Uf(Y.parent.vnode)&&bv(G,Ge,m,Y),Y=Y.parent}}function bv(Ee,Ge,m,G){const Y=Vf(Ge,Ee,G,!0);vp(()=>{rp(G[Ge],Y)},m)}function Vf(Ee,Ge,m=Zo,G=!1){if(m){const Y=m[Ee]||(m[Ee]=[]),d=Ge.__weh||(Ge.__weh=(...v)=>{if(m.isUnmounted)return;$c(),Kc(m);const w=Ns(Ge,m,Ee,v);return vc(),Qc(),w});return G?Y.unshift(d):Y.push(d),d}}const Cl=Ee=>(Ge,m=Zo)=>(!Iu||Ee==="sp")&&Vf(Ee,(...G)=>Ge(...G),m),_v=Cl("bm"),Hf=Cl("m"),wv=Cl("bu"),Tv=Cl("u"),nm=Cl("bum"),vp=Cl("um"),kv=Cl("sp"),Mv=Cl("rtg"),Av=Cl("rtc");function Sv(Ee,Ge=Zo){Vf("ec",Ee,Ge)}function uc(Ee,Ge,m,G){const Y=Ee.dirs,d=Ge&&Ge.dirs;for(let v=0;v<Y.length;v++){const w=Y[v];d&&(w.oldValue=d[v].value);let y=w.dir[G];y&&($c(),Ns(y,m,8,[Ee.el,w,Ee,Ge]),Qc())}}const im="components";function yp(Ee,Ge){return Lv(im,Ee,!0,Ge)||Ee}const Ev=Symbol();function Lv(Ee,Ge,m=!0,G=!1){const Y=nl||Zo;if(Y){const d=Y.type;if(Ee===im){const w=oy(d,!1);if(w&&(w===Ge||w===xl(Ge)||w===Rf(xl(Ge))))return d}const v=l0(Y[Ee]||d[Ee],Ge)||l0(Y.appContext[Ee],Ge);return!v&&G?d:v}}function l0(Ee,Ge){return Ee&&(Ee[Ge]||Ee[xl(Ge)]||Ee[Rf(xl(Ge))])}const Gh=Ee=>Ee?mm(Ee)?Tp(Ee)||Ee.proxy:Gh(Ee.parent):null,Pf=cs(Object.create(null),{$:Ee=>Ee,$el:Ee=>Ee.vnode.el,$data:Ee=>Ee.data,$props:Ee=>Ee.props,$attrs:Ee=>Ee.attrs,$slots:Ee=>Ee.slots,$refs:Ee=>Ee.refs,$parent:Ee=>Gh(Ee.parent),$root:Ee=>Gh(Ee.root),$emit:Ee=>Ee.emit,$options:Ee=>xp(Ee),$forceUpdate:Ee=>Ee.f||(Ee.f=()=>dp(Ee.update)),$nextTick:Ee=>Ee.n||(Ee.n=Q1.bind(Ee.proxy)),$watch:Ee=>pv.bind(Ee)}),Cv={get({_:Ee},Ge){const{ctx:m,setupState:G,data:Y,props:d,accessCache:v,type:w,appContext:y}=Ee;let e;if(Ge[0]!=="$"){const r=v[Ge];if(r!==void 0)switch(r){case 1:return G[Ge];case 2:return Y[Ge];case 4:return m[Ge];case 3:return d[Ge]}else{if(G!==Ja&&fa(G,Ge))return v[Ge]=1,G[Ge];if(Y!==Ja&&fa(Y,Ge))return v[Ge]=2,Y[Ge];if((e=Ee.propsOptions[0])&&fa(e,Ge))return v[Ge]=3,d[Ge];if(m!==Ja&&fa(m,Ge))return v[Ge]=4,m[Ge];Yh&&(v[Ge]=0)}}const t=Pf[Ge];let n,o;if(t)return Ge==="$attrs"&&Os(Ee,"get",Ge),t(Ee);if((n=w.__cssModules)&&(n=n[Ge]))return n;if(m!==Ja&&fa(m,Ge))return v[Ge]=4,m[Ge];if(o=y.config.globalProperties,fa(o,Ge))return o[Ge]},set({_:Ee},Ge,m){const{data:G,setupState:Y,ctx:d}=Ee;return Y!==Ja&&fa(Y,Ge)?(Y[Ge]=m,!0):G!==Ja&&fa(G,Ge)?(G[Ge]=m,!0):fa(Ee.props,Ge)||Ge[0]==="$"&&Ge.slice(1)in Ee?!1:(d[Ge]=m,!0)},has({_:{data:Ee,setupState:Ge,accessCache:m,ctx:G,appContext:Y,propsOptions:d}},v){let w;return!!m[v]||Ee!==Ja&&fa(Ee,v)||Ge!==Ja&&fa(Ge,v)||(w=d[0])&&fa(w,v)||fa(G,v)||fa(Pf,v)||fa(Y.config.globalProperties,v)},defineProperty(Ee,Ge,m){return m.get!=null?Ee._.accessCache[Ge]=0:fa(m,"value")&&this.set(Ee,Ge,m.value,null),Reflect.defineProperty(Ee,Ge,m)}};let Yh=!0;function Pv(Ee){const Ge=xp(Ee),m=Ee.proxy,G=Ee.ctx;Yh=!1,Ge.beforeCreate&&c0(Ge.beforeCreate,Ee,"bc");const{data:Y,computed:d,methods:v,watch:w,provide:y,inject:e,created:t,beforeMount:n,mounted:o,beforeUpdate:r,updated:g,activated:c,deactivated:a,beforeDestroy:h,beforeUnmount:l,destroyed:s,unmounted:p,render:u,renderTracked:i,renderTriggered:x,errorCaptured:f,serverPrefetch:_,expose:b,inheritAttrs:T,components:k,directives:L,filters:A}=Ge;if(e&&Iv(e,G,null,Ee.appContext.config.unwrapInjectedRef),v)for(const S in v){const E=v[S];ra(E)&&(G[S]=E.bind(m))}if(Y){const S=Y.call(m,m);zo(S)&&(Ee.data=up(S))}if(Yh=!0,d)for(const S in d){const E=d[S],z=ra(E)?E.bind(m,m):ra(E.get)?E.get.bind(m,m):al,D=!ra(E)&&ra(E.set)?E.set.bind(m):al,j=Gl({get:z,set:D});Object.defineProperty(G,S,{enumerable:!0,configurable:!0,get:()=>j.value,set:V=>j.value=V})}if(w)for(const S in w)am(w[S],G,m,S);if(y){const S=ra(y)?y.call(m):y;Reflect.ownKeys(S).forEach(E=>{hv(E,S[E])})}t&&c0(t,Ee,"c");function P(S,E){ea(E)?E.forEach(z=>S(z.bind(m))):E&&S(E.bind(m))}if(P(_v,n),P(Hf,o),P(wv,r),P(Tv,g),P(yv,c),P(xv,a),P(Sv,f),P(Av,i),P(Mv,x),P(nm,l),P(vp,p),P(kv,_),ea(b))if(b.length){const S=Ee.exposed||(Ee.exposed={});b.forEach(E=>{Object.defineProperty(S,E,{get:()=>m[E],set:z=>m[E]=z})})}else Ee.exposed||(Ee.exposed={});u&&Ee.render===al&&(Ee.render=u),T!=null&&(Ee.inheritAttrs=T),k&&(Ee.components=k),L&&(Ee.directives=L)}function Iv(Ee,Ge,m=al,G=!1){ea(Ee)&&(Ee=Wh(Ee));for(const Y in Ee){const d=Ee[Y];let v;zo(d)?"default"in d?v=Oh(d.from||Y,d.default,!0):v=Oh(d.from||Y):v=Oh(d),ns(v)&&G?Object.defineProperty(Ge,Y,{enumerable:!0,configurable:!0,get:()=>v.value,set:w=>v.value=w}):Ge[Y]=v}}function c0(Ee,Ge,m){Ns(ea(Ee)?Ee.map(G=>G.bind(Ge.proxy)):Ee.bind(Ge.proxy),Ge,m)}function am(Ee,Ge,m,G){const Y=G.includes(".")?Q0(m,G):()=>m[G];if(us(Ee)){const d=Ge[Ee];ra(d)&&rs(Y,d)}else if(ra(Ee))rs(Y,Ee.bind(m));else if(zo(Ee))if(ea(Ee))Ee.forEach(d=>am(d,Ge,m,G));else{const d=ra(Ee.handler)?Ee.handler.bind(m):Ge[Ee.handler];ra(d)&&rs(Y,d,Ee)}}function xp(Ee){const Ge=Ee.type,{mixins:m,extends:G}=Ge,{mixins:Y,optionsCache:d,config:{optionMergeStrategies:v}}=Ee.appContext,w=d.get(Ge);let y;return w?y=w:!Y.length&&!m&&!G?y=Ge:(y={},Y.length&&Y.forEach(e=>If(y,e,v,!0)),If(y,Ge,v)),zo(Ge)&&d.set(Ge,y),y}function If(Ee,Ge,m,G=!1){const{mixins:Y,extends:d}=Ge;d&&If(Ee,d,m,!0),Y&&Y.forEach(v=>If(Ee,v,m,!0));for(const v in Ge)if(!(G&&v==="expose")){const w=Ov[v]||m&&m[v];Ee[v]=w?w(Ee[v],Ge[v]):Ge[v]}return Ee}const Ov={data:u0,props:hc,emits:hc,methods:hc,computed:hc,beforeCreate:xs,created:xs,beforeMount:xs,mounted:xs,beforeUpdate:xs,updated:xs,beforeDestroy:xs,beforeUnmount:xs,destroyed:xs,unmounted:xs,activated:xs,deactivated:xs,errorCaptured:xs,serverPrefetch:xs,components:hc,directives:hc,watch:zv,provide:u0,inject:Dv};function u0(Ee,Ge){return Ge?Ee?function(){return cs(ra(Ee)?Ee.call(this,this):Ee,ra(Ge)?Ge.call(this,this):Ge)}:Ge:Ee}function Dv(Ee,Ge){return hc(Wh(Ee),Wh(Ge))}function Wh(Ee){if(ea(Ee)){const Ge={};for(let m=0;m<Ee.length;m++)Ge[Ee[m]]=Ee[m];return Ge}return Ee}function xs(Ee,Ge){return Ee?[...new Set([].concat(Ee,Ge))]:Ge}function hc(Ee,Ge){return Ee?cs(cs(Object.create(null),Ee),Ge):Ge}function zv(Ee,Ge){if(!Ee)return Ge;if(!Ge)return Ee;const m=cs(Object.create(null),Ee);for(const G in Ge)m[G]=xs(Ee[G],Ge[G]);return m}function Rv(Ee,Ge,m,G=!1){const Y={},d={};Ef(d,qf,1),Ee.propsDefaults=Object.create(null),om(Ee,Ge,Y,d);for(const v in Ee.propsOptions[0])v in Y||(Y[v]=void 0);m?Ee.props=G?Y:H1(Y):Ee.type.props?Ee.props=Y:Ee.props=d,Ee.attrs=d}function Fv(Ee,Ge,m,G){const{props:Y,attrs:d,vnode:{patchFlag:v}}=Ee,w=Ta(Y),[y]=Ee.propsOptions;let e=!1;if((G||v>0)&&!(v&16)){if(v&8){const t=Ee.vnode.dynamicProps;for(let n=0;n<t.length;n++){let o=t[n];if(Nf(Ee.emitsOptions,o))continue;const r=Ge[o];if(y)if(fa(d,o))r!==d[o]&&(d[o]=r,e=!0);else{const g=xl(o);Y[g]=Zh(y,w,g,r,Ee,!1)}else r!==d[o]&&(d[o]=r,e=!0)}}}else{om(Ee,Ge,Y,d)&&(e=!0);let t;for(const n in w)(!Ge||!fa(Ge,n)&&((t=Jc(n))===n||!fa(Ge,t)))&&(y?m&&(m[n]!==void 0||m[t]!==void 0)&&(Y[n]=Zh(y,w,n,void 0,Ee,!0)):delete Y[n]);if(d!==w)for(const n in d)(!Ge||!fa(Ge,n)&&!0)&&(delete d[n],e=!0)}e&&Ll(Ee,"set","$attrs")}function om(Ee,Ge,m,G){const[Y,d]=Ee.propsOptions;let v=!1,w;if(Ge)for(let y in Ge){if(kf(y))continue;const e=Ge[y];let t;Y&&fa(Y,t=xl(y))?!d||!d.includes(t)?m[t]=e:(w||(w={}))[t]=e:Nf(Ee.emitsOptions,y)||(!(y in G)||e!==G[y])&&(G[y]=e,v=!0)}if(d){const y=Ta(m),e=w||Ja;for(let t=0;t<d.length;t++){const n=d[t];m[n]=Zh(Y,y,n,e[n],Ee,!fa(e,n))}}return v}function Zh(Ee,Ge,m,G,Y,d){const v=Ee[m];if(v!=null){const w=fa(v,"default");if(w&&G===void 0){const y=v.default;if(v.type!==Function&&ra(y)){const{propsDefaults:e}=Y;m in e?G=e[m]:(Kc(Y),G=e[m]=y.call(null,Ge),vc())}else G=y}v[0]&&(d&&!w?G=!1:v[1]&&(G===""||G===Jc(m))&&(G=!0))}return G}function sm(Ee,Ge,m=!1){const G=Ge.propsCache,Y=G.get(Ee);if(Y)return Y;const d=Ee.props,v={},w=[];let y=!1;if(!ra(Ee)){const t=n=>{y=!0;const[o,r]=sm(n,Ge,!0);cs(v,o),r&&w.push(...r)};!m&&Ge.mixins.length&&Ge.mixins.forEach(t),Ee.extends&&t(Ee.extends),Ee.mixins&&Ee.mixins.forEach(t)}if(!d&&!y)return zo(Ee)&&G.set(Ee,Yc),Yc;if(ea(d))for(let t=0;t<d.length;t++){const n=xl(d[t]);f0(n)&&(v[n]=Ja)}else if(d)for(const t in d){const n=xl(t);if(f0(n)){const o=d[t],r=v[n]=ea(o)||ra(o)?{type:o}:o;if(r){const g=d0(Boolean,r.type),c=d0(String,r.type);r[0]=g>-1,r[1]=c<0||g<c,(g>-1||fa(r,"default"))&&w.push(n)}}}const e=[v,w];return zo(Ee)&&G.set(Ee,e),e}function f0(Ee){return Ee[0]!=="$"}function h0(Ee){const Ge=Ee&&Ee.toString().match(/^\s*function (\w+)/);return Ge?Ge[1]:Ee===null?"null":""}function p0(Ee,Ge){return h0(Ee)===h0(Ge)}function d0(Ee,Ge){return ea(Ge)?Ge.findIndex(m=>p0(m,Ee)):ra(Ge)&&p0(Ge,Ee)?0:-1}const lm=Ee=>Ee[0]==="_"||Ee==="$stable",bp=Ee=>ea(Ee)?Ee.map(vl):[vl(Ee)],Bv=(Ee,Ge,m)=>{if(Ge._n)return Ge;const G=av((...Y)=>bp(Ge(...Y)),m);return G._c=!1,G},cm=(Ee,Ge,m)=>{const G=Ee._ctx;for(const Y in Ee){if(lm(Y))continue;const d=Ee[Y];if(ra(d))Ge[Y]=Bv(Y,d,G);else if(d!=null){const v=bp(d);Ge[Y]=()=>v}}},um=(Ee,Ge)=>{const m=bp(Ge);Ee.slots.default=()=>m},Nv=(Ee,Ge)=>{if(Ee.vnode.shapeFlag&32){const m=Ge._;m?(Ee.slots=Ta(Ge),Ef(Ge,"_",m)):cm(Ge,Ee.slots={})}else Ee.slots={},Ge&&um(Ee,Ge);Ef(Ee.slots,qf,1)},jv=(Ee,Ge,m)=>{const{vnode:G,slots:Y}=Ee;let d=!0,v=Ja;if(G.shapeFlag&32){const w=Ge._;w?m&&w===1?d=!1:(cs(Y,Ge),!m&&w===1&&delete Y._):(d=!Ge.$stable,cm(Ge,Y)),v=Ge}else Ge&&(um(Ee,Ge),v={default:1});if(d)for(const w in Y)!lm(w)&&!(w in v)&&delete Y[w]};function fm(){return{app:null,config:{isNativeTag:a1,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Uv=0;function Vv(Ee,Ge){return function(G,Y=null){ra(G)||(G=Object.assign({},G)),Y!=null&&!zo(Y)&&(Y=null);const d=fm(),v=new Set;let w=!1;const y=d.app={_uid:Uv++,_component:G,_props:Y,_container:null,_context:d,_instance:null,version:ly,get config(){return d.config},set config(e){},use(e,...t){return v.has(e)||(e&&ra(e.install)?(v.add(e),e.install(y,...t)):ra(e)&&(v.add(e),e(y,...t))),y},mixin(e){return d.mixins.includes(e)||d.mixins.push(e),y},component(e,t){return t?(d.components[e]=t,y):d.components[e]},directive(e,t){return t?(d.directives[e]=t,y):d.directives[e]},mount(e,t,n){if(!w){const o=Ra(G,Y);return o.appContext=d,t&&Ge?Ge(o,e):Ee(o,e,n),w=!0,y._container=e,e.__vue_app__=y,Tp(o.component)||o.component.proxy}},unmount(){w&&(Ee(null,y._container),delete y._container.__vue_app__)},provide(e,t){return d.provides[e]=t,y}};return y}}function Xh(Ee,Ge,m,G,Y=!1){if(ea(Ee)){Ee.forEach((o,r)=>Xh(o,Ge&&(ea(Ge)?Ge[r]:Ge),m,G,Y));return}if(Mf(G)&&!Y)return;const d=G.shapeFlag&4?Tp(G.component)||G.component.proxy:G.el,v=Y?null:d,{i:w,r:y}=Ee,e=Ge&&Ge.r,t=w.refs===Ja?w.refs={}:w.refs,n=w.setupState;if(e!=null&&e!==y&&(us(e)?(t[e]=null,fa(n,e)&&(n[e]=null)):ns(e)&&(e.value=null)),ra(y))Zl(y,w,12,[v,t]);else{const o=us(y),r=ns(y);if(o||r){const g=()=>{if(Ee.f){const c=o?fa(n,y)?n[y]:t[y]:y.value;Y?ea(c)&&rp(c,d):ea(c)?c.includes(d)||c.push(d):o?(t[y]=[d],fa(n,y)&&(n[y]=t[y])):(y.value=[d],Ee.k&&(t[Ee.k]=y.value))}else o?(t[y]=v,fa(n,y)&&(n[y]=v)):r&&(y.value=v,Ee.k&&(t[Ee.k]=v))};v?(g.id=-1,Ms(g,m)):g()}}}const Ms=fv;function Hv(Ee){return qv(Ee)}function qv(Ee,Ge){const m=m1();m.__VUE__=!0;const{insert:G,remove:Y,patchProp:d,createElement:v,createText:w,createComment:y,setText:e,setElementText:t,parentNode:n,nextSibling:o,setScopeId:r=al,insertStaticContent:g}=Ee,c=(B,K,J,ee=null,ne=null,se=null,oe=!1,me=null,ce=!!K.dynamicChildren)=>{if(B===K)return;B&&!dc(B,K)&&(ee=re(B),V(B,ne,se,!0),B=null),K.patchFlag===-2&&(ce=!1,K.dynamicChildren=null);const{type:ye,ref:Se,shapeFlag:fe}=K;switch(ye){case _p:a(B,K,J,ee);break;case El:h(B,K,J,ee);break;case Af:B==null&&l(K,J,ee,oe);break;case Is:k(B,K,J,ee,ne,se,oe,me,ce);break;default:fe&1?u(B,K,J,ee,ne,se,oe,me,ce):fe&6?L(B,K,J,ee,ne,se,oe,me,ce):(fe&64||fe&128)&&ye.process(B,K,J,ee,ne,se,oe,me,ce,N)}Se!=null&&ne&&Xh(Se,B&&B.ref,se,K||B,!K)},a=(B,K,J,ee)=>{if(B==null)G(K.el=w(K.children),J,ee);else{const ne=K.el=B.el;K.children!==B.children&&e(ne,K.children)}},h=(B,K,J,ee)=>{B==null?G(K.el=y(K.children||""),J,ee):K.el=B.el},l=(B,K,J,ee)=>{[B.el,B.anchor]=g(B.children,K,J,ee,B.el,B.anchor)},s=({el:B,anchor:K},J,ee)=>{let ne;for(;B&&B!==K;)ne=o(B),G(B,J,ee),B=ne;G(K,J,ee)},p=({el:B,anchor:K})=>{let J;for(;B&&B!==K;)J=o(B),Y(B),B=J;Y(K)},u=(B,K,J,ee,ne,se,oe,me,ce)=>{oe=oe||K.type==="svg",B==null?i(K,J,ee,ne,se,oe,me,ce):_(B,K,ne,se,oe,me,ce)},i=(B,K,J,ee,ne,se,oe,me)=>{let ce,ye;const{type:Se,props:fe,shapeFlag:ge,transition:Te,dirs:le}=B;if(ce=B.el=v(B.type,se,fe&&fe.is,fe),ge&8?t(ce,B.children):ge&16&&f(B.children,ce,null,ee,ne,se&&Se!=="foreignObject",oe,me),le&&uc(B,null,ee,"created"),fe){for(const Me in fe)Me!=="value"&&!kf(Me)&&d(ce,Me,null,fe[Me],se,B.children,ee,ne,$);"value"in fe&&d(ce,"value",null,fe.value),(ye=fe.onVnodeBeforeMount)&&dl(ye,ee,B)}x(ce,B,B.scopeId,oe,ee),le&&uc(B,null,ee,"beforeMount");const ve=(!ne||ne&&!ne.pendingBranch)&&Te&&!Te.persisted;ve&&Te.beforeEnter(ce),G(ce,K,J),((ye=fe&&fe.onVnodeMounted)||ve||le)&&Ms(()=>{ye&&dl(ye,ee,B),ve&&Te.enter(ce),le&&uc(B,null,ee,"mounted")},ne)},x=(B,K,J,ee,ne)=>{if(J&&r(B,J),ee)for(let se=0;se<ee.length;se++)r(B,ee[se]);if(ne){let se=ne.subTree;if(K===se){const oe=ne.vnode;x(B,oe,oe.scopeId,oe.slotScopeIds,ne.parent)}}},f=(B,K,J,ee,ne,se,oe,me,ce=0)=>{for(let ye=ce;ye<B.length;ye++){const Se=B[ye]=me?Yl(B[ye]):vl(B[ye]);c(null,Se,K,J,ee,ne,se,oe,me)}},_=(B,K,J,ee,ne,se,oe)=>{const me=K.el=B.el;let{patchFlag:ce,dynamicChildren:ye,dirs:Se}=K;ce|=B.patchFlag&16;const fe=B.props||Ja,ge=K.props||Ja;let Te;J&&fc(J,!1),(Te=ge.onVnodeBeforeUpdate)&&dl(Te,J,K,B),Se&&uc(K,B,J,"beforeUpdate"),J&&fc(J,!0);const le=ne&&K.type!=="foreignObject";if(ye?b(B.dynamicChildren,ye,me,J,ee,le,se):oe||E(B,K,me,null,J,ee,le,se,!1),ce>0){if(ce&16)T(me,K,fe,ge,J,ee,ne);else if(ce&2&&fe.class!==ge.class&&d(me,"class",null,ge.class,ne),ce&4&&d(me,"style",fe.style,ge.style,ne),ce&8){const ve=K.dynamicProps;for(let Me=0;Me<ve.length;Me++){const we=ve[Me],de=fe[we],Ie=ge[we];(Ie!==de||we==="value")&&d(me,we,de,Ie,ne,B.children,J,ee,$)}}ce&1&&B.children!==K.children&&t(me,K.children)}else!oe&&ye==null&&T(me,K,fe,ge,J,ee,ne);((Te=ge.onVnodeUpdated)||Se)&&Ms(()=>{Te&&dl(Te,J,K,B),Se&&uc(K,B,J,"updated")},ee)},b=(B,K,J,ee,ne,se,oe)=>{for(let me=0;me<K.length;me++){const ce=B[me],ye=K[me],Se=ce.el&&(ce.type===Is||!dc(ce,ye)||ce.shapeFlag&70)?n(ce.el):J;c(ce,ye,Se,null,ee,ne,se,oe,!0)}},T=(B,K,J,ee,ne,se,oe)=>{if(J!==ee){if(J!==Ja)for(const me in J)!kf(me)&&!(me in ee)&&d(B,me,J[me],null,oe,K.children,ne,se,$);for(const me in ee){if(kf(me))continue;const ce=ee[me],ye=J[me];ce!==ye&&me!=="value"&&d(B,me,ye,ce,oe,K.children,ne,se,$)}"value"in ee&&d(B,"value",J.value,ee.value)}},k=(B,K,J,ee,ne,se,oe,me,ce)=>{const ye=K.el=B?B.el:w(""),Se=K.anchor=B?B.anchor:w("");let{patchFlag:fe,dynamicChildren:ge,slotScopeIds:Te}=K;Te&&(me=me?me.concat(Te):Te),B==null?(G(ye,J,ee),G(Se,J,ee),f(K.children,J,Se,ne,se,oe,me,ce)):fe>0&&fe&64&&ge&&B.dynamicChildren?(b(B.dynamicChildren,ge,J,ne,se,oe,me),(K.key!=null||ne&&K===ne.subTree)&&hm(B,K,!0)):E(B,K,J,Se,ne,se,oe,me,ce)},L=(B,K,J,ee,ne,se,oe,me,ce)=>{K.slotScopeIds=me,B==null?K.shapeFlag&512?ne.ctx.activate(K,J,ee,oe,ce):A(K,J,ee,ne,se,oe,ce):I(B,K,ce)},A=(B,K,J,ee,ne,se,oe)=>{const me=B.component=ey(B,ee,ne);if(Uf(B)&&(me.ctx.renderer=N),ry(me),me.asyncDep){if(ne&&ne.registerDep(me,P),!B.el){const ce=me.subTree=Ra(El);h(null,ce,K,J)}return}P(me,B,K,J,ne,se,oe)},I=(B,K,J)=>{const ee=K.component=B.component;if(lv(B,K,J))if(ee.asyncDep&&!ee.asyncResolved){S(ee,K,J);return}else ee.next=K,tv(ee.update),ee.update();else K.el=B.el,ee.vnode=K},P=(B,K,J,ee,ne,se,oe)=>{const me=()=>{if(B.isMounted){let{next:Se,bu:fe,u:ge,parent:Te,vnode:le}=B,ve=Se,Me;fc(B,!1),Se?(Se.el=le.el,S(B,Se,oe)):Se=le,fe&&Ph(fe),(Me=Se.props&&Se.props.onVnodeBeforeUpdate)&&dl(Me,Te,Se,le),fc(B,!0);const we=Ih(B),de=B.subTree;B.subTree=we,c(de,we,n(de.el),re(de),B,ne,se),Se.el=we.el,ve===null&&cv(B,we.el),ge&&Ms(ge,ne),(Me=Se.props&&Se.props.onVnodeUpdated)&&Ms(()=>dl(Me,Te,Se,le),ne)}else{let Se;const{el:fe,props:ge}=K,{bm:Te,m:le,parent:ve}=B,Me=Mf(K);if(fc(B,!1),Te&&Ph(Te),!Me&&(Se=ge&&ge.onVnodeBeforeMount)&&dl(Se,ve,K),fc(B,!0),fe&&te){const we=()=>{B.subTree=Ih(B),te(fe,B.subTree,B,ne,null)};Me?K.type.__asyncLoader().then(()=>!B.isUnmounted&&we()):we()}else{const we=B.subTree=Ih(B);c(null,we,J,ee,B,ne,se),K.el=we.el}if(le&&Ms(le,ne),!Me&&(Se=ge&&ge.onVnodeMounted)){const we=K;Ms(()=>dl(Se,ve,we),ne)}(K.shapeFlag&256||ve&&Mf(ve.vnode)&&ve.vnode.shapeFlag&256)&&B.a&&Ms(B.a,ne),B.isMounted=!0,K=J=ee=null}},ce=B.effect=new op(me,()=>dp(ye),B.scope),ye=B.update=()=>ce.run();ye.id=B.uid,fc(B,!0),ye()},S=(B,K,J)=>{K.component=B;const ee=B.vnode.props;B.vnode=K,B.next=null,Fv(B,K.props,ee,J),jv(B,K.children,J),$c(),i0(),Qc()},E=(B,K,J,ee,ne,se,oe,me,ce=!1)=>{const ye=B&&B.children,Se=B?B.shapeFlag:0,fe=K.children,{patchFlag:ge,shapeFlag:Te}=K;if(ge>0){if(ge&128){D(ye,fe,J,ee,ne,se,oe,me,ce);return}else if(ge&256){z(ye,fe,J,ee,ne,se,oe,me,ce);return}}Te&8?(Se&16&&$(ye,ne,se),fe!==ye&&t(J,fe)):Se&16?Te&16?D(ye,fe,J,ee,ne,se,oe,me,ce):$(ye,ne,se,!0):(Se&8&&t(J,""),Te&16&&f(fe,J,ee,ne,se,oe,me,ce))},z=(B,K,J,ee,ne,se,oe,me,ce)=>{B=B||Yc,K=K||Yc;const ye=B.length,Se=K.length,fe=Math.min(ye,Se);let ge;for(ge=0;ge<fe;ge++){const Te=K[ge]=ce?Yl(K[ge]):vl(K[ge]);c(B[ge],Te,J,null,ne,se,oe,me,ce)}ye>Se?$(B,ne,se,!0,!1,fe):f(K,J,ee,ne,se,oe,me,ce,fe)},D=(B,K,J,ee,ne,se,oe,me,ce)=>{let ye=0;const Se=K.length;let fe=B.length-1,ge=Se-1;for(;ye<=fe&&ye<=ge;){const Te=B[ye],le=K[ye]=ce?Yl(K[ye]):vl(K[ye]);if(dc(Te,le))c(Te,le,J,null,ne,se,oe,me,ce);else break;ye++}for(;ye<=fe&&ye<=ge;){const Te=B[fe],le=K[ge]=ce?Yl(K[ge]):vl(K[ge]);if(dc(Te,le))c(Te,le,J,null,ne,se,oe,me,ce);else break;fe--,ge--}if(ye>fe){if(ye<=ge){const Te=ge+1,le=Te<Se?K[Te].el:ee;for(;ye<=ge;)c(null,K[ye]=ce?Yl(K[ye]):vl(K[ye]),J,le,ne,se,oe,me,ce),ye++}}else if(ye>ge)for(;ye<=fe;)V(B[ye],ne,se,!0),ye++;else{const Te=ye,le=ye,ve=new Map;for(ye=le;ye<=ge;ye++){const Fe=K[ye]=ce?Yl(K[ye]):vl(K[ye]);Fe.key!=null&&ve.set(Fe.key,ye)}let Me,we=0;const de=ge-le+1;let Ie=!1,De=0;const Oe=new Array(de);for(ye=0;ye<de;ye++)Oe[ye]=0;for(ye=Te;ye<=fe;ye++){const Fe=B[ye];if(we>=de){V(Fe,ne,se,!0);continue}let ze;if(Fe.key!=null)ze=ve.get(Fe.key);else for(Me=le;Me<=ge;Me++)if(Oe[Me-le]===0&&dc(Fe,K[Me])){ze=Me;break}ze===void 0?V(Fe,ne,se,!0):(Oe[ze-le]=ye+1,ze>=De?De=ze:Ie=!0,c(Fe,K[ze],J,null,ne,se,oe,me,ce),we++)}const Ve=Ie?Gv(Oe):Yc;for(Me=Ve.length-1,ye=de-1;ye>=0;ye--){const Fe=le+ye,ze=K[Fe],Re=Fe+1<Se?K[Fe+1].el:ee;Oe[ye]===0?c(null,ze,J,Re,ne,se,oe,me,ce):Ie&&(Me<0||ye!==Ve[Me]?j(ze,J,Re,2):Me--)}}},j=(B,K,J,ee,ne=null)=>{const{el:se,type:oe,transition:me,children:ce,shapeFlag:ye}=B;if(ye&6){j(B.component.subTree,K,J,ee);return}if(ye&128){B.suspense.move(K,J,ee);return}if(ye&64){oe.move(B,K,J,N);return}if(oe===Is){G(se,K,J);for(let fe=0;fe<ce.length;fe++)j(ce[fe],K,J,ee);G(B.anchor,K,J);return}if(oe===Af){s(B,K,J);return}if(ee!==2&&ye&1&&me)if(ee===0)me.beforeEnter(se),G(se,K,J),Ms(()=>me.enter(se),ne);else{const{leave:fe,delayLeave:ge,afterLeave:Te}=me,le=()=>G(se,K,J),ve=()=>{fe(se,()=>{le(),Te&&Te()})};ge?ge(se,le,ve):ve()}else G(se,K,J)},V=(B,K,J,ee=!1,ne=!1)=>{const{type:se,props:oe,ref:me,children:ce,dynamicChildren:ye,shapeFlag:Se,patchFlag:fe,dirs:ge}=B;if(me!=null&&Xh(me,null,J,B,!0),Se&256){K.ctx.deactivate(B);return}const Te=Se&1&&ge,le=!Mf(B);let ve;if(le&&(ve=oe&&oe.onVnodeBeforeUnmount)&&dl(ve,K,B),Se&6)X(B.component,J,ee);else{if(Se&128){B.suspense.unmount(J,ee);return}Te&&uc(B,null,K,"beforeUnmount"),Se&64?B.type.remove(B,K,J,ne,N,ee):ye&&(se!==Is||fe>0&&fe&64)?$(ye,K,J,!1,!0):(se===Is&&fe&384||!ne&&Se&16)&&$(ce,K,J),ee&&Z(B)}(le&&(ve=oe&&oe.onVnodeUnmounted)||Te)&&Ms(()=>{ve&&dl(ve,K,B),Te&&uc(B,null,K,"unmounted")},J)},Z=B=>{const{type:K,el:J,anchor:ee,transition:ne}=B;if(K===Is){Q(J,ee);return}if(K===Af){p(B);return}const se=()=>{Y(J),ne&&!ne.persisted&&ne.afterLeave&&ne.afterLeave()};if(B.shapeFlag&1&&ne&&!ne.persisted){const{leave:oe,delayLeave:me}=ne,ce=()=>oe(J,se);me?me(B.el,se,ce):ce()}else se()},Q=(B,K)=>{let J;for(;B!==K;)J=o(B),Y(B),B=J;Y(K)},X=(B,K,J)=>{const{bum:ee,scope:ne,update:se,subTree:oe,um:me}=B;ee&&Ph(ee),ne.stop(),se&&(se.active=!1,V(oe,B,K,J)),me&&Ms(me,K),Ms(()=>{B.isUnmounted=!0},K),K&&K.pendingBranch&&!K.isUnmounted&&B.asyncDep&&!B.asyncResolved&&B.suspenseId===K.pendingId&&(K.deps--,K.deps===0&&K.resolve())},$=(B,K,J,ee=!1,ne=!1,se=0)=>{for(let oe=se;oe<B.length;oe++)V(B[oe],K,J,ee,ne)},re=B=>B.shapeFlag&6?re(B.component.subTree):B.shapeFlag&128?B.suspense.next():o(B.anchor||B.el),H=(B,K,J)=>{B==null?K._vnode&&V(K._vnode,null,null,!0):c(K._vnode||null,B,K,null,null,null,J),i0(),X0(),K._vnode=B},N={p:c,um:V,m:j,r:Z,mt:A,mc:f,pc:E,pbc:b,n:re,o:Ee};let U,te;return Ge&&([U,te]=Ge(N)),{render:H,hydrate:U,createApp:Vv(H,U)}}function fc({effect:Ee,update:Ge},m){Ee.allowRecurse=Ge.allowRecurse=m}function hm(Ee,Ge,m=!1){const G=Ee.children,Y=Ge.children;if(ea(G)&&ea(Y))for(let d=0;d<G.length;d++){const v=G[d];let w=Y[d];w.shapeFlag&1&&!w.dynamicChildren&&((w.patchFlag<=0||w.patchFlag===32)&&(w=Y[d]=Yl(Y[d]),w.el=v.el),m||hm(v,w))}}function Gv(Ee){const Ge=Ee.slice(),m=[0];let G,Y,d,v,w;const y=Ee.length;for(G=0;G<y;G++){const e=Ee[G];if(e!==0){if(Y=m[m.length-1],Ee[Y]<e){Ge[G]=Y,m.push(G);continue}for(d=0,v=m.length-1;d<v;)w=d+v>>1,Ee[m[w]]<e?d=w+1:v=w;e<Ee[m[d]]&&(d>0&&(Ge[G]=m[d-1]),m[d]=G)}}for(d=m.length,v=m[d-1];d-- >0;)m[d]=v,v=Ge[v];return m}const Yv=Ee=>Ee.__isTeleport,Is=Symbol(void 0),_p=Symbol(void 0),El=Symbol(void 0),Af=Symbol(void 0),Au=[];let il=null;function Pl(Ee=!1){Au.push(il=Ee?null:[])}function Wv(){Au.pop(),il=Au[Au.length-1]||null}let Pu=1;function m0(Ee){Pu+=Ee}function Zv(Ee){return Ee.dynamicChildren=Pu>0?il||Yc:null,Wv(),Pu>0&&il&&il.push(Ee),Ee}function Il(Ee,Ge,m,G,Y,d){return Zv(Aa(Ee,Ge,m,G,Y,d,!0))}function Xv(Ee){return Ee?Ee.__v_isVNode===!0:!1}function dc(Ee,Ge){return Ee.type===Ge.type&&Ee.key===Ge.key}const qf="__vInternal",pm=({key:Ee})=>Ee!=null?Ee:null,Sf=({ref:Ee,ref_key:Ge,ref_for:m})=>Ee!=null?us(Ee)||ns(Ee)||ra(Ee)?{i:nl,r:Ee,k:Ge,f:!!m}:Ee:null;function Aa(Ee,Ge=null,m=null,G=0,Y=null,d=Ee===Is?0:1,v=!1,w=!1){const y={__v_isVNode:!0,__v_skip:!0,type:Ee,props:Ge,key:Ge&&pm(Ge),ref:Ge&&Sf(Ge),scopeId:jf,slotScopeIds:null,children:m,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:d,patchFlag:G,dynamicProps:Y,dynamicChildren:null,appContext:null};return w?(wp(y,m),d&128&&Ee.normalize(y)):m&&(y.shapeFlag|=us(m)?8:16),Pu>0&&!v&&il&&(y.patchFlag>0||d&6)&&y.patchFlag!==32&&il.push(y),y}const Ra=Kv;function Kv(Ee,Ge=null,m=null,G=0,Y=null,d=!1){if((!Ee||Ee===Ev)&&(Ee=El),Xv(Ee)){const w=Kl(Ee,Ge,!0);return m&&wp(w,m),Pu>0&&!d&&il&&(w.shapeFlag&6?il[il.indexOf(Ee)]=w:il.push(w)),w.patchFlag|=-2,w}if(sy(Ee)&&(Ee=Ee.__vccOpts),Ge){Ge=Jv(Ge);let{class:w,style:y}=Ge;w&&!us(w)&&(Ge.class=ep(w)),zo(y)&&(U0(y)&&!ea(y)&&(y=cs({},y)),Ge.style=Qh(y))}const v=us(Ee)?1:uv(Ee)?128:Yv(Ee)?64:zo(Ee)?4:ra(Ee)?2:0;return Aa(Ee,Ge,m,G,Y,v,d,!0)}function Jv(Ee){return Ee?U0(Ee)||qf in Ee?cs({},Ee):Ee:null}function Kl(Ee,Ge,m=!1){const{props:G,ref:Y,patchFlag:d,children:v}=Ee,w=Ge?dm(G||{},Ge):G;return{__v_isVNode:!0,__v_skip:!0,type:Ee.type,props:w,key:w&&pm(w),ref:Ge&&Ge.ref?m&&Y?ea(Y)?Y.concat(Sf(Ge)):[Y,Sf(Ge)]:Sf(Ge):Y,scopeId:Ee.scopeId,slotScopeIds:Ee.slotScopeIds,children:v,target:Ee.target,targetAnchor:Ee.targetAnchor,staticCount:Ee.staticCount,shapeFlag:Ee.shapeFlag,patchFlag:Ge&&Ee.type!==Is?d===-1?16:d|16:d,dynamicProps:Ee.dynamicProps,dynamicChildren:Ee.dynamicChildren,appContext:Ee.appContext,dirs:Ee.dirs,transition:Ee.transition,component:Ee.component,suspense:Ee.suspense,ssContent:Ee.ssContent&&Kl(Ee.ssContent),ssFallback:Ee.ssFallback&&Kl(Ee.ssFallback),el:Ee.el,anchor:Ee.anchor}}function tl(Ee=" ",Ge=0){return Ra(_p,null,Ee,Ge)}function Gf(Ee,Ge){const m=Ra(Af,null,Ee);return m.staticCount=Ge,m}function vl(Ee){return Ee==null||typeof Ee=="boolean"?Ra(El):ea(Ee)?Ra(Is,null,Ee.slice()):typeof Ee=="object"?Yl(Ee):Ra(_p,null,String(Ee))}function Yl(Ee){return Ee.el===null&&Ee.patchFlag!==-1||Ee.memo?Ee:Kl(Ee)}function wp(Ee,Ge){let m=0;const{shapeFlag:G}=Ee;if(Ge==null)Ge=null;else if(ea(Ge))m=16;else if(typeof Ge=="object")if(G&65){const Y=Ge.default;Y&&(Y._c&&(Y._d=!1),wp(Ee,Y()),Y._c&&(Y._d=!0));return}else{m=32;const Y=Ge._;!Y&&!(qf in Ge)?Ge._ctx=nl:Y===3&&nl&&(nl.slots._===1?Ge._=1:(Ge._=2,Ee.patchFlag|=1024))}else ra(Ge)?(Ge={default:Ge,_ctx:nl},m=32):(Ge=String(Ge),G&64?(m=16,Ge=[tl(Ge)]):m=8);Ee.children=Ge,Ee.shapeFlag|=m}function dm(...Ee){const Ge={};for(let m=0;m<Ee.length;m++){const G=Ee[m];for(const Y in G)if(Y==="class")Ge.class!==G.class&&(Ge.class=ep([Ge.class,G.class]));else if(Y==="style")Ge.style=Qh([Ge.style,G.style]);else if(Of(Y)){const d=Ge[Y],v=G[Y];v&&d!==v&&!(ea(d)&&d.includes(v))&&(Ge[Y]=d?[].concat(d,v):v)}else Y!==""&&(Ge[Y]=G[Y])}return Ge}function dl(Ee,Ge,m,G=null){Ns(Ee,Ge,7,[m,G])}const $v=fm();let Qv=0;function ey(Ee,Ge,m){const G=Ee.type,Y=(Ge?Ge.appContext:Ee.appContext)||$v,d={uid:Qv++,vnode:Ee,type:G,parent:Ge,appContext:Y,root:null,next:null,subTree:null,effect:null,update:null,scope:new g1(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:Ge?Ge.provides:Object.create(Y.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:sm(G,Y),emitsOptions:J0(G,Y),emit:null,emitted:null,propsDefaults:Ja,inheritAttrs:G.inheritAttrs,ctx:Ja,data:Ja,props:Ja,attrs:Ja,slots:Ja,refs:Ja,setupState:Ja,setupContext:null,suspense:m,suspenseId:m?m.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return d.ctx={_:d},d.root=Ge?Ge.root:d,d.emit=iv.bind(null,d),Ee.ce&&Ee.ce(d),d}let Zo=null;const ty=()=>Zo||nl,Kc=Ee=>{Zo=Ee,Ee.scope.on()},vc=()=>{Zo&&Zo.scope.off(),Zo=null};function mm(Ee){return Ee.vnode.shapeFlag&4}let Iu=!1;function ry(Ee,Ge=!1){Iu=Ge;const{props:m,children:G}=Ee.vnode,Y=mm(Ee);Rv(Ee,m,Y,Ge),Nv(Ee,G);const d=Y?ny(Ee,Ge):void 0;return Iu=!1,d}function ny(Ee,Ge){const m=Ee.type;Ee.accessCache=Object.create(null),Ee.proxy=V0(new Proxy(Ee.ctx,Cv));const{setup:G}=m;if(G){const Y=Ee.setupContext=G.length>1?ay(Ee):null;Kc(Ee),$c();const d=Zl(G,Ee,0,[Ee.props,Y]);if(Qc(),vc(),L0(d)){if(d.then(vc,vc),Ge)return d.then(v=>{g0(Ee,v,Ge)}).catch(v=>{Bf(v,Ee,0)});Ee.asyncDep=d}else g0(Ee,d,Ge)}else gm(Ee,Ge)}function g0(Ee,Ge,m){ra(Ge)?Ee.type.__ssrInlineRender?Ee.ssrRender=Ge:Ee.render=Ge:zo(Ge)&&(Ee.setupState=G0(Ge)),gm(Ee,m)}let v0;function gm(Ee,Ge,m){const G=Ee.type;if(!Ee.render){if(!Ge&&v0&&!G.render){const Y=G.template||xp(Ee).template;if(Y){const{isCustomElement:d,compilerOptions:v}=Ee.appContext.config,{delimiters:w,compilerOptions:y}=G,e=cs(cs({isCustomElement:d,delimiters:w},v),y);G.render=v0(Y,e)}}Ee.render=G.render||al}Kc(Ee),$c(),Pv(Ee),Qc(),vc()}function iy(Ee){return new Proxy(Ee.attrs,{get(Ge,m){return Os(Ee,"get","$attrs"),Ge[m]}})}function ay(Ee){const Ge=G=>{Ee.exposed=G||{}};let m;return{get attrs(){return m||(m=iy(Ee))},slots:Ee.slots,emit:Ee.emit,expose:Ge}}function Tp(Ee){if(Ee.exposed)return Ee.exposeProxy||(Ee.exposeProxy=new Proxy(G0(V0(Ee.exposed)),{get(Ge,m){if(m in Ge)return Ge[m];if(m in Pf)return Pf[m](Ee)}}))}function oy(Ee,Ge=!0){return ra(Ee)?Ee.displayName||Ee.name:Ee.name||Ge&&Ee.__name}function sy(Ee){return ra(Ee)&&"__vccOpts"in Ee}const Gl=(Ee,Ge)=>J1(Ee,Ge,Iu),ly="3.2.41",cy="http://www.w3.org/2000/svg",mc=typeof document<"u"?document:null,y0=mc&&mc.createElement("template"),uy={insert:(Ee,Ge,m)=>{Ge.insertBefore(Ee,m||null)},remove:Ee=>{const Ge=Ee.parentNode;Ge&&Ge.removeChild(Ee)},createElement:(Ee,Ge,m,G)=>{const Y=Ge?mc.createElementNS(cy,Ee):mc.createElement(Ee,m?{is:m}:void 0);return Ee==="select"&&G&&G.multiple!=null&&Y.setAttribute("multiple",G.multiple),Y},createText:Ee=>mc.createTextNode(Ee),createComment:Ee=>mc.createComment(Ee),setText:(Ee,Ge)=>{Ee.nodeValue=Ge},setElementText:(Ee,Ge)=>{Ee.textContent=Ge},parentNode:Ee=>Ee.parentNode,nextSibling:Ee=>Ee.nextSibling,querySelector:Ee=>mc.querySelector(Ee),setScopeId(Ee,Ge){Ee.setAttribute(Ge,"")},insertStaticContent(Ee,Ge,m,G,Y,d){const v=m?m.previousSibling:Ge.lastChild;if(Y&&(Y===d||Y.nextSibling))for(;Ge.insertBefore(Y.cloneNode(!0),m),!(Y===d||!(Y=Y.nextSibling)););else{y0.innerHTML=G?`<svg>${Ee}</svg>`:Ee;const w=y0.content;if(G){const y=w.firstChild;for(;y.firstChild;)w.appendChild(y.firstChild);w.removeChild(y)}Ge.insertBefore(w,m)}return[v?v.nextSibling:Ge.firstChild,m?m.previousSibling:Ge.lastChild]}};function fy(Ee,Ge,m){const G=Ee._vtc;G&&(Ge=(Ge?[Ge,...G]:[...G]).join(" ")),Ge==null?Ee.removeAttribute("class"):m?Ee.setAttribute("class",Ge):Ee.className=Ge}function hy(Ee,Ge,m){const G=Ee.style,Y=us(m);if(m&&!Y){for(const d in m)Kh(G,d,m[d]);if(Ge&&!us(Ge))for(const d in Ge)m[d]==null&&Kh(G,d,"")}else{const d=G.display;Y?Ge!==m&&(G.cssText=m):Ge&&Ee.removeAttribute("style"),"_vod"in Ee&&(G.display=d)}}const x0=/\s*!important$/;function Kh(Ee,Ge,m){if(ea(m))m.forEach(G=>Kh(Ee,Ge,G));else if(m==null&&(m=""),Ge.startsWith("--"))Ee.setProperty(Ge,m);else{const G=py(Ee,Ge);x0.test(m)?Ee.setProperty(Jc(G),m.replace(x0,""),"important"):Ee[G]=m}}const b0=["Webkit","Moz","ms"],zh={};function py(Ee,Ge){const m=zh[Ge];if(m)return m;let G=xl(Ge);if(G!=="filter"&&G in Ee)return zh[Ge]=G;G=Rf(G);for(let Y=0;Y<b0.length;Y++){const d=b0[Y]+G;if(d in Ee)return zh[Ge]=d}return Ge}const _0="http://www.w3.org/1999/xlink";function dy(Ee,Ge,m,G,Y){if(G&&Ge.startsWith("xlink:"))m==null?Ee.removeAttributeNS(_0,Ge.slice(6,Ge.length)):Ee.setAttributeNS(_0,Ge,m);else{const d=t1(Ge);m==null||d&&!E0(m)?Ee.removeAttribute(Ge):Ee.setAttribute(Ge,d?"":m)}}function my(Ee,Ge,m,G,Y,d,v){if(Ge==="innerHTML"||Ge==="textContent"){G&&v(G,Y,d),Ee[Ge]=m==null?"":m;return}if(Ge==="value"&&Ee.tagName!=="PROGRESS"&&!Ee.tagName.includes("-")){Ee._value=m;const y=m==null?"":m;(Ee.value!==y||Ee.tagName==="OPTION")&&(Ee.value=y),m==null&&Ee.removeAttribute(Ge);return}let w=!1;if(m===""||m==null){const y=typeof Ee[Ge];y==="boolean"?m=E0(m):m==null&&y==="string"?(m="",w=!0):y==="number"&&(m=0,w=!0)}try{Ee[Ge]=m}catch{}w&&Ee.removeAttribute(Ge)}function gy(Ee,Ge,m,G){Ee.addEventListener(Ge,m,G)}function vy(Ee,Ge,m,G){Ee.removeEventListener(Ge,m,G)}function yy(Ee,Ge,m,G,Y=null){const d=Ee._vei||(Ee._vei={}),v=d[Ge];if(G&&v)v.value=G;else{const[w,y]=xy(Ge);if(G){const e=d[Ge]=wy(G,Y);gy(Ee,w,e,y)}else v&&(vy(Ee,w,v,y),d[Ge]=void 0)}}const w0=/(?:Once|Passive|Capture)$/;function xy(Ee){let Ge;if(w0.test(Ee)){Ge={};let G;for(;G=Ee.match(w0);)Ee=Ee.slice(0,Ee.length-G[0].length),Ge[G[0].toLowerCase()]=!0}return[Ee[2]===":"?Ee.slice(3):Jc(Ee.slice(2)),Ge]}let Rh=0;const by=Promise.resolve(),_y=()=>Rh||(by.then(()=>Rh=0),Rh=Date.now());function wy(Ee,Ge){const m=G=>{if(!G._vts)G._vts=Date.now();else if(G._vts<=m.attached)return;Ns(Ty(G,m.value),Ge,5,[G])};return m.value=Ee,m.attached=_y(),m}function Ty(Ee,Ge){if(ea(Ge)){const m=Ee.stopImmediatePropagation;return Ee.stopImmediatePropagation=()=>{m.call(Ee),Ee._stopped=!0},Ge.map(G=>Y=>!Y._stopped&&G&&G(Y))}else return Ge}const T0=/^on[a-z]/,ky=(Ee,Ge,m,G,Y=!1,d,v,w,y)=>{Ge==="class"?fy(Ee,G,Y):Ge==="style"?hy(Ee,m,G):Of(Ge)?tp(Ge)||yy(Ee,Ge,m,G,v):(Ge[0]==="."?(Ge=Ge.slice(1),!0):Ge[0]==="^"?(Ge=Ge.slice(1),!1):My(Ee,Ge,G,Y))?my(Ee,Ge,G,d,v,w,y):(Ge==="true-value"?Ee._trueValue=G:Ge==="false-value"&&(Ee._falseValue=G),dy(Ee,Ge,G,Y))};function My(Ee,Ge,m,G){return G?!!(Ge==="innerHTML"||Ge==="textContent"||Ge in Ee&&T0.test(Ge)&&ra(m)):Ge==="spellcheck"||Ge==="draggable"||Ge==="translate"||Ge==="form"||Ge==="list"&&Ee.tagName==="INPUT"||Ge==="type"&&Ee.tagName==="TEXTAREA"||T0.test(Ge)&&us(m)?!1:Ge in Ee}const Ay={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};gv.props;const Sy=cs({patchProp:ky},uy);let k0;function Ey(){return k0||(k0=Hv(Sy))}const Ly=(...Ee)=>{const Ge=Ey().createApp(...Ee),{mount:m}=Ge;return Ge.mount=G=>{const Y=Cy(G);if(!Y)return;const d=Ge._component;!ra(d)&&!d.render&&!d.template&&(d.template=Y.innerHTML),Y.innerHTML="";const v=m(Y,!1,Y instanceof SVGElement);return Y instanceof Element&&(Y.removeAttribute("v-cloak"),Y.setAttribute("data-v-app","")),v},Ge};function Cy(Ee){return us(Ee)?document.querySelector(Ee):Ee}const Py="/palbert/assets/background.d0017ff7.svg";const Ol=(Ee,Ge)=>{const m=Ee.__vccOpts||Ee;for(const[G,Y]of Ge)m[G]=Y;return m},Iy={},Oy=Ee=>(mp("data-v-8735f6c3"),Ee=Ee(),gp(),Ee),Dy={class:"container"},zy=Oy(()=>Aa("img",{alt:"",class:"b-image",src:Py},null,-1)),Ry=[zy];function Fy(Ee,Ge){return Pl(),Il("div",Dy,Ry)}const By=Ol(Iy,[["render",Fy],["__scopeId","data-v-8735f6c3"]]);const Ny={},jy=Gf('<div class="centered" data-v-10fc0c42><div class="conference" data-v-10fc0c42>NeurIPS 2022 </div></div><div class="centered" data-v-10fc0c42><b data-v-10fc0c42>Spotlight</b></div><div class="centered" data-v-10fc0c42><div class="author-1" data-v-10fc0c42>Nikita Balagansky</div><div class="author-2" data-v-10fc0c42>Daniil Gavrilov</div></div><div class="centered" data-v-10fc0c42><p data-v-10fc0c42>Tinkoff</p></div><div class="centered" data-v-10fc0c42><div class="paper-column" data-v-10fc0c42>[<a href="https://arxiv.org/abs/2204.03276" target="_blank" data-v-10fc0c42>Paper</a>]</div><div class="paper-column" data-v-10fc0c42>[<a href="https://github.com/tinkoff-ai/palbert" target="_blank" data-v-10fc0c42>Code</a>]</div><div class="video-column" data-v-10fc0c42>[<a data-v-10fc0c42>Video</a>]</div></div>',5);function Uy(Ee,Ge){return jy}const Vy=Ol(Ny,[["render",Uy],["__scopeId","data-v-10fc0c42"]]);function Hy(Ee,Ge){var m=Ee||{},G=m.loadType,Y=m.url,d=function(y,e){var t={};for(var n in y)Object.prototype.hasOwnProperty.call(y,n)&&e.indexOf(n)===-1&&(t[n]=y[n]);return t}(m,["loadType","url"]);(function(y){y===void 0&&(y={});var e=y.loadType,t=y.url;if(!window.MathJax){var n=document.createElement("script");n.src=t||"https://cdn.bootcdn.net/ajax/libs/mathjax/3.2.0/es5/tex-svg.min.js",n[e||"async"]=!0,document.head.appendChild(n)}})({loadType:G,url:Y});var v={tex:{inlineMath:[["$","$"]],displayMath:[["$$","$$"]],processEnvironments:!0,processRefs:!0},options:{skipHtmlTags:["noscript","style","textarea","pre","code"],ignoreHtmlClass:"tex2jax_ignore"},startup:{pageReady:function(){Ge&&Ge()}},svg:{fontCache:"global"}},w=Object.assign({},v,d);window.MathJax=w}function vm(Ee){return window.MathJax&&window.MathJax.typesetPromise?(Ee&&!Array.isArray(Ee)&&(Ee=[Ee]),window.MathJax.typesetPromise(Ee)):Promise.reject()}const ym=vv({props:{latex:{default:""},block:{type:Boolean,default:!1}},setup(Ee){const Ge=Ee,m=ku(null),G=()=>{if(!m.value)return;const Y=m.value;Y.innerText=Ge.block?`$$ ${Ge.latex} $$`:`$ ${Ge.latex} $`,vm(Y).catch(d=>console.warn(d))};return rs(()=>Ge.latex,()=>{G()},{immediate:!0}),Hf(()=>G()),(Y,d)=>(Pl(),Il("span",{ref_key:"ContainerRef",ref:m},null,512))}});function xm(Ee){Ee.component("MathJax",ym)}const qy={version:"1.0.0",install:xm};typeof window<"u"&&window.Vue&&xm(window.Vue);const Gy="/palbert/assets/early_exit_vue.5fba34a8.svg";const Yy={name:"HelloWorld",props:{msg:String},components:{MathJax:ym},data(){return{x:"x",y:"y",lambda:"\\lambda",formula:"x = {-b \\pm \\sqrt{b^2-4ac} \\over 2a}.",pdf_formula:"p(i \\mid x)=\\prod_{p=1}^{i-1}\\left(1-\\lambda_p\\right) \\lambda_i",loss_formula:"\\begin{align} L(x, y) &=\\mathbb{E}_{i \\sim p(i \\mid x)}[\\log (p(y \\mid x, i))] \\\\ &-\\beta K L(p(\\cdot \\mid x) | p(\\cdot \\mid \\lambda)) \\leq \\log (p(y \\mid x)) \\end{align}"}}},Wy=Gf('<div class="text-container" data-v-9a978940><h2 data-v-9a978940>Early Exit</h2></div><div class="text-container" data-v-9a978940><div class="text" data-v-9a978940> These days, pre-trained models can be considered the default choice for a wide range of NLP tasks. However, despite their SoTA results, there is practical evidence that these models may require a different number of computing layers for different input sequences, since evaluating all layers can lead to overconfidence in the wrong predictions (overthinking). This problem can potentially be solved by implementing adaptive computation time approaches, which were first designed to improve inference speed. The recently proposed PonderNet may be a promising solution for performing an early exit by treating the exit layer\u2019s index as a latent variable. This is what the model scheme looks like: </div></div><div class="pic-container" data-v-9a978940><img class="pic" alt="" src="'+Gy+'" data-v-9a978940></div><div class="text-container" data-v-9a978940><div class="text" data-v-9a978940> Instead of using task-specific layers (which, in most cases, are classifiers) to determine the exit layer, PonderNet implies additional layers after every encoder layer. Note that the task layers are entirely independent of the early exit mechanism. The model&#39;s lambda layers output the probability of exit from the current layer. To compute the unconditional probability density function, we can use the following equation: </div></div>',4),Zy={class:"text-container"},Xy={class:"text-container"},Ky={class:"text"},Jy={class:"text-container"};function $y(Ee,Ge,m,G,Y,d){const v=yp("math-jax");return Pl(),Il(Is,null,[Wy,Aa("div",Zy,[Ra(v,{latex:Y.pdf_formula,block:!0,class:"formula"},null,8,["latex"])]),Aa("div",Xy,[Aa("div",Ky,[tl(" It is now clear that our distribution resembles a geometrical distribution, but with a different lambda at every step. PonderNet's training procedure is similar to VAE training. Its loss is two-term: reconstruction loss (reconstructing "),Ra(v,{latex:Y.y},null,8,["latex"]),tl(" from "),Ra(v,{latex:Y.x},null,8,["latex"]),tl(") and regularization loss. ")])]),Aa("div",Jy,[Ra(v,{latex:Y.loss_formula,block:!0,class:"formula"},null,8,["latex"])])],64)}const Qy=Ol(Yy,[["render",$y],["__scopeId","data-v-9a978940"]]);var Ka=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ex(Ee){return Ee&&Ee.__esModule&&Object.prototype.hasOwnProperty.call(Ee,"default")?Ee.default:Ee}function Tf(Ee){throw new Error('Could not dynamically require "'+Ee+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var bm={exports:{}};(function(Ee,Ge){(function(m){Ee.exports=m()})(function(){return function m(G,Y,d){function v(e,t){if(!Y[e]){if(!G[e]){var n=typeof Tf=="function"&&Tf;if(!t&&n)return n(e,!0);if(w)return w(e,!0);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}var r=Y[e]={exports:{}};G[e][0].call(r.exports,function(g){return v(G[e][1][g]||g)},r,r.exports,m,G,Y,d)}return Y[e].exports}for(var w=typeof Tf=="function"&&Tf,y=0;y<d.length;y++)v(d[y]);return v}({1:[function(m,G,Y){var d=m("../src/lib"),v={"X,X div":'direction:ltr;font-family:"Open Sans",verdana,arial,sans-serif;margin:0;padding:0;',"X input,X button":'font-family:"Open Sans",verdana,arial,sans-serif;',"X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color .3s ease 0s;-moz-transition:background-color .3s ease 0s;-ms-transition:background-color .3s ease 0s;-o-transition:background-color .3s ease 0s;transition:background-color .3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity .3s ease 0s;-moz-transition:opacity .3s ease 0s;-ms-transition:opacity .3s ease 0s;-o-transition:opacity .3s ease 0s;transition:opacity .3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":'content:"";position:absolute;background:rgba(0,0,0,0);border:6px solid rgba(0,0,0,0);z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;',"X [data-title]:after":"content:attr(data-title);background:#69738a;color:#fff;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid rgba(0,0,0,0);border-left-color:#69738a;margin-top:8px;margin-right:-30px;",Y:'font-family:"Open Sans",verdana,arial,sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;',"Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var w in v){var y=w.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");d.addStyleRule(y,v[w])}},{"../src/lib":515}],2:[function(m,G,Y){G.exports=m("../src/transforms/aggregate")},{"../src/transforms/aggregate":1127}],3:[function(m,G,Y){G.exports=m("../src/traces/bar")},{"../src/traces/bar":665}],4:[function(m,G,Y){G.exports=m("../src/traces/barpolar")},{"../src/traces/barpolar":678}],5:[function(m,G,Y){G.exports=m("../src/traces/box")},{"../src/traces/box":688}],6:[function(m,G,Y){G.exports=m("../src/components/calendars")},{"../src/components/calendars":365}],7:[function(m,G,Y){G.exports=m("../src/traces/candlestick")},{"../src/traces/candlestick":697}],8:[function(m,G,Y){G.exports=m("../src/traces/carpet")},{"../src/traces/carpet":716}],9:[function(m,G,Y){G.exports=m("../src/traces/choropleth")},{"../src/traces/choropleth":730}],10:[function(m,G,Y){G.exports=m("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":737}],11:[function(m,G,Y){G.exports=m("../src/traces/cone")},{"../src/traces/cone":743}],12:[function(m,G,Y){G.exports=m("../src/traces/contour")},{"../src/traces/contour":758}],13:[function(m,G,Y){G.exports=m("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":769}],14:[function(m,G,Y){G.exports=m("../src/core")},{"../src/core":493}],15:[function(m,G,Y){G.exports=m("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":777}],16:[function(m,G,Y){G.exports=m("../src/transforms/filter")},{"../src/transforms/filter":1128}],17:[function(m,G,Y){G.exports=m("../src/traces/funnel")},{"../src/traces/funnel":787}],18:[function(m,G,Y){G.exports=m("../src/traces/funnelarea")},{"../src/traces/funnelarea":796}],19:[function(m,G,Y){G.exports=m("../src/transforms/groupby")},{"../src/transforms/groupby":1129}],20:[function(m,G,Y){G.exports=m("../src/traces/heatmap")},{"../src/traces/heatmap":809}],21:[function(m,G,Y){G.exports=m("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":820}],22:[function(m,G,Y){G.exports=m("../src/traces/histogram")},{"../src/traces/histogram":832}],23:[function(m,G,Y){G.exports=m("../src/traces/histogram2d")},{"../src/traces/histogram2d":838}],24:[function(m,G,Y){G.exports=m("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":842}],25:[function(m,G,Y){G.exports=m("../src/traces/icicle")},{"../src/traces/icicle":848}],26:[function(m,G,Y){G.exports=m("../src/traces/image")},{"../src/traces/image":861}],27:[function(m,G,Y){var d=m("./core");d.register([m("./bar"),m("./box"),m("./heatmap"),m("./histogram"),m("./histogram2d"),m("./histogram2dcontour"),m("./contour"),m("./scatterternary"),m("./violin"),m("./funnel"),m("./waterfall"),m("./image"),m("./pie"),m("./sunburst"),m("./treemap"),m("./icicle"),m("./funnelarea"),m("./scatter3d"),m("./surface"),m("./isosurface"),m("./volume"),m("./mesh3d"),m("./cone"),m("./streamtube"),m("./scattergeo"),m("./choropleth"),m("./scattergl"),m("./splom"),m("./pointcloud"),m("./heatmapgl"),m("./parcoords"),m("./parcats"),m("./scattermapbox"),m("./choroplethmapbox"),m("./densitymapbox"),m("./sankey"),m("./indicator"),m("./table"),m("./carpet"),m("./scattercarpet"),m("./contourcarpet"),m("./ohlc"),m("./candlestick"),m("./scatterpolar"),m("./scatterpolargl"),m("./barpolar"),m("./scattersmith"),m("./aggregate"),m("./filter"),m("./groupby"),m("./sort"),m("./calendars")]),G.exports=d},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./icicle":25,"./image":26,"./indicator":28,"./isosurface":29,"./mesh3d":30,"./ohlc":31,"./parcats":32,"./parcoords":33,"./pie":34,"./pointcloud":35,"./sankey":36,"./scatter3d":37,"./scattercarpet":38,"./scattergeo":39,"./scattergl":40,"./scattermapbox":41,"./scatterpolar":42,"./scatterpolargl":43,"./scattersmith":44,"./scatterternary":45,"./sort":46,"./splom":47,"./streamtube":48,"./sunburst":49,"./surface":50,"./table":51,"./treemap":52,"./violin":53,"./volume":54,"./waterfall":55}],28:[function(m,G,Y){G.exports=m("../src/traces/indicator")},{"../src/traces/indicator":869}],29:[function(m,G,Y){G.exports=m("../src/traces/isosurface")},{"../src/traces/isosurface":875}],30:[function(m,G,Y){G.exports=m("../src/traces/mesh3d")},{"../src/traces/mesh3d":880}],31:[function(m,G,Y){G.exports=m("../src/traces/ohlc")},{"../src/traces/ohlc":885}],32:[function(m,G,Y){G.exports=m("../src/traces/parcats")},{"../src/traces/parcats":894}],33:[function(m,G,Y){G.exports=m("../src/traces/parcoords")},{"../src/traces/parcoords":905}],34:[function(m,G,Y){G.exports=m("../src/traces/pie")},{"../src/traces/pie":916}],35:[function(m,G,Y){G.exports=m("../src/traces/pointcloud")},{"../src/traces/pointcloud":925}],36:[function(m,G,Y){G.exports=m("../src/traces/sankey")},{"../src/traces/sankey":931}],37:[function(m,G,Y){G.exports=m("../src/traces/scatter3d")},{"../src/traces/scatter3d":969}],38:[function(m,G,Y){G.exports=m("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":976}],39:[function(m,G,Y){G.exports=m("../src/traces/scattergeo")},{"../src/traces/scattergeo":984}],40:[function(m,G,Y){G.exports=m("../src/traces/scattergl")},{"../src/traces/scattergl":998}],41:[function(m,G,Y){G.exports=m("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1008}],42:[function(m,G,Y){G.exports=m("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1016}],43:[function(m,G,Y){G.exports=m("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1024}],44:[function(m,G,Y){G.exports=m("../src/traces/scattersmith")},{"../src/traces/scattersmith":1031}],45:[function(m,G,Y){G.exports=m("../src/traces/scatterternary")},{"../src/traces/scatterternary":1039}],46:[function(m,G,Y){G.exports=m("../src/transforms/sort")},{"../src/transforms/sort":1131}],47:[function(m,G,Y){G.exports=m("../src/traces/splom")},{"../src/traces/splom":1049}],48:[function(m,G,Y){G.exports=m("../src/traces/streamtube")},{"../src/traces/streamtube":1057}],49:[function(m,G,Y){G.exports=m("../src/traces/sunburst")},{"../src/traces/sunburst":1065}],50:[function(m,G,Y){G.exports=m("../src/traces/surface")},{"../src/traces/surface":1074}],51:[function(m,G,Y){G.exports=m("../src/traces/table")},{"../src/traces/table":1082}],52:[function(m,G,Y){G.exports=m("../src/traces/treemap")},{"../src/traces/treemap":1093}],53:[function(m,G,Y){G.exports=m("../src/traces/violin")},{"../src/traces/violin":1106}],54:[function(m,G,Y){G.exports=m("../src/traces/volume")},{"../src/traces/volume":1114}],55:[function(m,G,Y){G.exports=m("../src/traces/waterfall")},{"../src/traces/waterfall":1122}],56:[function(m,G,Y){(function(d,v){typeof Y=="object"&&G!==void 0?v(Y,m("d3-array"),m("d3-collection"),m("d3-shape"),m("elementary-circuits-directed-graph")):v(d.d3=d.d3||{},d.d3,d.d3,d.d3,null)})(this,function(d,v,w,y,e){function t(ee){return ee.target.depth}function n(ee,ne){return ee.sourceLinks.length?ee.depth:ne-1}function o(ee){return function(){return ee}}e=e&&e.hasOwnProperty("default")?e.default:e;var r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ee){return typeof ee}:function(ee){return ee&&typeof Symbol=="function"&&ee.constructor===Symbol&&ee!==Symbol.prototype?"symbol":typeof ee};function g(ee,ne){return a(ee.source,ne.source)||ee.index-ne.index}function c(ee,ne){return a(ee.target,ne.target)||ee.index-ne.index}function a(ee,ne){return ee.partOfCycle===ne.partOfCycle?ee.y0-ne.y0:ee.circularLinkType==="top"||ne.circularLinkType==="bottom"?-1:1}function h(ee){return ee.value}function l(ee){return(ee.y0+ee.y1)/2}function s(ee){return l(ee.source)}function p(ee){return l(ee.target)}function u(ee){return ee.index}function i(ee){return ee.nodes}function x(ee){return ee.links}function f(ee,ne){var se=ee.get(ne);if(!se)throw new Error("missing: "+ne);return se}function _(ee,ne){return ne(ee)}function b(ee,ne,se){var oe=0;if(se===null){for(var me=[],ce=0;ce<ee.links.length;ce++){var ye=ee.links[ce],Se=ye.source.index,fe=ye.target.index;me[Se]||(me[Se]=[]),me[fe]||(me[fe]=[]),me[Se].indexOf(fe)===-1&&me[Se].push(fe)}var ge=e(me);ge.sort(function(ve,Me){return ve.length-Me.length});var Te={};for(ce=0;ce<ge.length;ce++){var le=ge[ce].slice(-2);Te[le[0]]||(Te[le[0]]={}),Te[le[0]][le[1]]=!0}ee.links.forEach(function(ve){var Me=ve.target.index,we=ve.source.index;Me===we||Te[we]&&Te[we][Me]?(ve.circular=!0,ve.circularLinkID=oe,oe+=1):ve.circular=!1})}else ee.links.forEach(function(ve){ve.source[se]<ve.target[se]?ve.circular=!1:(ve.circular=!0,ve.circularLinkID=oe,oe+=1)})}function T(ee,ne){var se=0,oe=0;ee.links.forEach(function(me){me.circular&&(me.source.circularLinkType||me.target.circularLinkType?me.circularLinkType=me.source.circularLinkType?me.source.circularLinkType:me.target.circularLinkType:me.circularLinkType=se<oe?"top":"bottom",me.circularLinkType=="top"?se+=1:oe+=1,ee.nodes.forEach(function(ce){_(ce,ne)!=_(me.source,ne)&&_(ce,ne)!=_(me.target,ne)||(ce.circularLinkType=me.circularLinkType)}))}),ee.links.forEach(function(me){me.circular&&(me.source.circularLinkType==me.target.circularLinkType&&(me.circularLinkType=me.source.circularLinkType),K(me,ne)&&(me.circularLinkType=me.source.circularLinkType))})}function k(ee){var ne=Math.abs(ee.y1-ee.y0),se=Math.abs(ee.target.x0-ee.source.x1);return Math.atan(se/ne)}function L(ee,ne){var se=0;ee.sourceLinks.forEach(function(me){se=me.circular&&!K(me,ne)?se+1:se});var oe=0;return ee.targetLinks.forEach(function(me){oe=me.circular&&!K(me,ne)?oe+1:oe}),se+oe}function A(ee){var ne=ee.source.sourceLinks,se=0;ne.forEach(function(ce){se=ce.circular?se+1:se});var oe=ee.target.targetLinks,me=0;return oe.forEach(function(ce){me=ce.circular?me+1:me}),!(se>1||me>1)}function I(ee,ne,se){return ee.sort(S),ee.forEach(function(oe,me){var ce,ye,Se=0;if(K(oe,se)&&A(oe))oe.circularPathData.verticalBuffer=Se+oe.width/2;else{for(var fe=0;fe<me;fe++)if(ce=ee[me],ye=ee[fe],!(ce.source.column<ye.target.column||ce.target.column>ye.source.column)){var ge=ee[fe].circularPathData.verticalBuffer+ee[fe].width/2+ne;Se=ge>Se?ge:Se}oe.circularPathData.verticalBuffer=Se+oe.width/2}}),ee}function P(ee,ne,se,oe){var me=v.min(ee.links,function(ce){return ce.source.y0});ee.links.forEach(function(ce){ce.circular&&(ce.circularPathData={})}),I(ee.links.filter(function(ce){return ce.circularLinkType=="top"}),ne,oe),I(ee.links.filter(function(ce){return ce.circularLinkType=="bottom"}),ne,oe),ee.links.forEach(function(ce){if(ce.circular){if(ce.circularPathData.arcRadius=ce.width+10,ce.circularPathData.leftNodeBuffer=5,ce.circularPathData.rightNodeBuffer=5,ce.circularPathData.sourceWidth=ce.source.x1-ce.source.x0,ce.circularPathData.sourceX=ce.source.x0+ce.circularPathData.sourceWidth,ce.circularPathData.targetX=ce.target.x0,ce.circularPathData.sourceY=ce.y0,ce.circularPathData.targetY=ce.y1,K(ce,oe)&&A(ce))ce.circularPathData.leftSmallArcRadius=10+ce.width/2,ce.circularPathData.leftLargeArcRadius=10+ce.width/2,ce.circularPathData.rightSmallArcRadius=10+ce.width/2,ce.circularPathData.rightLargeArcRadius=10+ce.width/2,ce.circularLinkType=="bottom"?(ce.circularPathData.verticalFullExtent=ce.source.y1+25+ce.circularPathData.verticalBuffer,ce.circularPathData.verticalLeftInnerExtent=ce.circularPathData.verticalFullExtent-ce.circularPathData.leftLargeArcRadius,ce.circularPathData.verticalRightInnerExtent=ce.circularPathData.verticalFullExtent-ce.circularPathData.rightLargeArcRadius):(ce.circularPathData.verticalFullExtent=ce.source.y0-25-ce.circularPathData.verticalBuffer,ce.circularPathData.verticalLeftInnerExtent=ce.circularPathData.verticalFullExtent+ce.circularPathData.leftLargeArcRadius,ce.circularPathData.verticalRightInnerExtent=ce.circularPathData.verticalFullExtent+ce.circularPathData.rightLargeArcRadius);else{var ye=ce.source.column,Se=ce.circularLinkType,fe=ee.links.filter(function(le){return le.source.column==ye&&le.circularLinkType==Se});ce.circularLinkType=="bottom"?fe.sort(z):fe.sort(E);var ge=0;fe.forEach(function(le,ve){le.circularLinkID==ce.circularLinkID&&(ce.circularPathData.leftSmallArcRadius=10+ce.width/2+ge,ce.circularPathData.leftLargeArcRadius=10+ce.width/2+ve*ne+ge),ge+=le.width}),ye=ce.target.column,fe=ee.links.filter(function(le){return le.target.column==ye&&le.circularLinkType==Se}),ce.circularLinkType=="bottom"?fe.sort(j):fe.sort(D),ge=0,fe.forEach(function(le,ve){le.circularLinkID==ce.circularLinkID&&(ce.circularPathData.rightSmallArcRadius=10+ce.width/2+ge,ce.circularPathData.rightLargeArcRadius=10+ce.width/2+ve*ne+ge),ge+=le.width}),ce.circularLinkType=="bottom"?(ce.circularPathData.verticalFullExtent=Math.max(se,ce.source.y1,ce.target.y1)+25+ce.circularPathData.verticalBuffer,ce.circularPathData.verticalLeftInnerExtent=ce.circularPathData.verticalFullExtent-ce.circularPathData.leftLargeArcRadius,ce.circularPathData.verticalRightInnerExtent=ce.circularPathData.verticalFullExtent-ce.circularPathData.rightLargeArcRadius):(ce.circularPathData.verticalFullExtent=me-25-ce.circularPathData.verticalBuffer,ce.circularPathData.verticalLeftInnerExtent=ce.circularPathData.verticalFullExtent+ce.circularPathData.leftLargeArcRadius,ce.circularPathData.verticalRightInnerExtent=ce.circularPathData.verticalFullExtent+ce.circularPathData.rightLargeArcRadius)}ce.circularPathData.leftInnerExtent=ce.circularPathData.sourceX+ce.circularPathData.leftNodeBuffer,ce.circularPathData.rightInnerExtent=ce.circularPathData.targetX-ce.circularPathData.rightNodeBuffer,ce.circularPathData.leftFullExtent=ce.circularPathData.sourceX+ce.circularPathData.leftLargeArcRadius+ce.circularPathData.leftNodeBuffer,ce.circularPathData.rightFullExtent=ce.circularPathData.targetX-ce.circularPathData.rightLargeArcRadius-ce.circularPathData.rightNodeBuffer}if(ce.circular)ce.path=function(le){var ve="";return ve=le.circularLinkType=="top"?"M"+le.circularPathData.sourceX+" "+le.circularPathData.sourceY+" L"+le.circularPathData.leftInnerExtent+" "+le.circularPathData.sourceY+" A"+le.circularPathData.leftLargeArcRadius+" "+le.circularPathData.leftSmallArcRadius+" 0 0 0 "+le.circularPathData.leftFullExtent+" "+(le.circularPathData.sourceY-le.circularPathData.leftSmallArcRadius)+" L"+le.circularPathData.leftFullExtent+" "+le.circularPathData.verticalLeftInnerExtent+" A"+le.circularPathData.leftLargeArcRadius+" "+le.circularPathData.leftLargeArcRadius+" 0 0 0 "+le.circularPathData.leftInnerExtent+" "+le.circularPathData.verticalFullExtent+" L"+le.circularPathData.rightInnerExtent+" "+le.circularPathData.verticalFullExtent+" A"+le.circularPathData.rightLargeArcRadius+" "+le.circularPathData.rightLargeArcRadius+" 0 0 0 "+le.circularPathData.rightFullExtent+" "+le.circularPathData.verticalRightInnerExtent+" L"+le.circularPathData.rightFullExtent+" "+(le.circularPathData.targetY-le.circularPathData.rightSmallArcRadius)+" A"+le.circularPathData.rightLargeArcRadius+" "+le.circularPathData.rightSmallArcRadius+" 0 0 0 "+le.circularPathData.rightInnerExtent+" "+le.circularPathData.targetY+" L"+le.circularPathData.targetX+" "+le.circularPathData.targetY:"M"+le.circularPathData.sourceX+" "+le.circularPathData.sourceY+" L"+le.circularPathData.leftInnerExtent+" "+le.circularPathData.sourceY+" A"+le.circularPathData.leftLargeArcRadius+" "+le.circularPathData.leftSmallArcRadius+" 0 0 1 "+le.circularPathData.leftFullExtent+" "+(le.circularPathData.sourceY+le.circularPathData.leftSmallArcRadius)+" L"+le.circularPathData.leftFullExtent+" "+le.circularPathData.verticalLeftInnerExtent+" A"+le.circularPathData.leftLargeArcRadius+" "+le.circularPathData.leftLargeArcRadius+" 0 0 1 "+le.circularPathData.leftInnerExtent+" "+le.circularPathData.verticalFullExtent+" L"+le.circularPathData.rightInnerExtent+" "+le.circularPathData.verticalFullExtent+" A"+le.circularPathData.rightLargeArcRadius+" "+le.circularPathData.rightLargeArcRadius+" 0 0 1 "+le.circularPathData.rightFullExtent+" "+le.circularPathData.verticalRightInnerExtent+" L"+le.circularPathData.rightFullExtent+" "+(le.circularPathData.targetY+le.circularPathData.rightSmallArcRadius)+" A"+le.circularPathData.rightLargeArcRadius+" "+le.circularPathData.rightSmallArcRadius+" 0 0 1 "+le.circularPathData.rightInnerExtent+" "+le.circularPathData.targetY+" L"+le.circularPathData.targetX+" "+le.circularPathData.targetY,ve}(ce);else{var Te=y.linkHorizontal().source(function(le){return[le.source.x0+(le.source.x1-le.source.x0),le.y0]}).target(function(le){return[le.target.x0,le.y1]});ce.path=Te(ce)}})}function S(ee,ne){return V(ee)==V(ne)?ee.circularLinkType=="bottom"?z(ee,ne):E(ee,ne):V(ne)-V(ee)}function E(ee,ne){return ee.y0-ne.y0}function z(ee,ne){return ne.y0-ee.y0}function D(ee,ne){return ee.y1-ne.y1}function j(ee,ne){return ne.y1-ee.y1}function V(ee){return ee.target.column-ee.source.column}function Z(ee){return ee.target.x0-ee.source.x1}function Q(ee,ne){var se=k(ee),oe=Z(ne)/Math.tan(se);return B(ee)=="up"?ee.y1+oe:ee.y1-oe}function X(ee,ne){var se=k(ee),oe=Z(ne)/Math.tan(se);return B(ee)=="up"?ee.y1-oe:ee.y1+oe}function $(ee,ne,se,oe){ee.links.forEach(function(me){if(!me.circular&&me.target.column-me.source.column>1){var ce=me.source.column+1,ye=me.target.column-1,Se=1,fe=ye-ce+1;for(Se=1;ce<=ye;ce++,Se++)ee.nodes.forEach(function(ge){if(ge.column==ce){var Te,le=Se/(fe+1),ve=Math.pow(1-le,3),Me=3*le*Math.pow(1-le,2),we=3*Math.pow(le,2)*(1-le),de=Math.pow(le,3),Ie=ve*me.y0+Me*me.y0+we*me.y1+de*me.y1,De=Ie-me.width/2,Oe=Ie+me.width/2;De>ge.y0&&De<ge.y1?(Te=ge.y1-De+10,Te=ge.circularLinkType=="bottom"?Te:-Te,ge=H(ge,Te,ne,se),ee.nodes.forEach(function(Ve){_(Ve,oe)!=_(ge,oe)&&Ve.column==ge.column&&re(ge,Ve)&&H(Ve,Te,ne,se)})):(Oe>ge.y0&&Oe<ge.y1||De<ge.y0&&Oe>ge.y1)&&(Te=Oe-ge.y0+10,ge=H(ge,Te,ne,se),ee.nodes.forEach(function(Ve){_(Ve,oe)!=_(ge,oe)&&Ve.column==ge.column&&Ve.y0<ge.y1&&Ve.y1>ge.y1&&H(Ve,Te,ne,se)}))}})}})}function re(ee,ne){return ee.y0>ne.y0&&ee.y0<ne.y1||ee.y1>ne.y0&&ee.y1<ne.y1||ee.y0<ne.y0&&ee.y1>ne.y1}function H(ee,ne,se,oe){return ee.y0+ne>=se&&ee.y1+ne<=oe&&(ee.y0=ee.y0+ne,ee.y1=ee.y1+ne,ee.targetLinks.forEach(function(me){me.y1=me.y1+ne}),ee.sourceLinks.forEach(function(me){me.y0=me.y0+ne})),ee}function N(ee,ne,se,oe){ee.nodes.forEach(function(me){oe&&me.y+(me.y1-me.y0)>ne&&(me.y=me.y-(me.y+(me.y1-me.y0)-ne));var ce=ee.links.filter(function(fe){return _(fe.source,se)==_(me,se)}),ye=ce.length;ye>1&&ce.sort(function(fe,ge){if(!fe.circular&&!ge.circular){if(fe.target.column==ge.target.column||!te(fe,ge))return fe.y1-ge.y1;if(fe.target.column>ge.target.column){var Te=X(ge,fe);return fe.y1-Te}if(ge.target.column>fe.target.column)return X(fe,ge)-ge.y1}return fe.circular&&!ge.circular?fe.circularLinkType=="top"?-1:1:ge.circular&&!fe.circular?ge.circularLinkType=="top"?1:-1:fe.circular&&ge.circular?fe.circularLinkType===ge.circularLinkType&&fe.circularLinkType=="top"?fe.target.column===ge.target.column?fe.target.y1-ge.target.y1:ge.target.column-fe.target.column:fe.circularLinkType===ge.circularLinkType&&fe.circularLinkType=="bottom"?fe.target.column===ge.target.column?ge.target.y1-fe.target.y1:fe.target.column-ge.target.column:fe.circularLinkType=="top"?-1:1:void 0});var Se=me.y0;ce.forEach(function(fe){fe.y0=Se+fe.width/2,Se+=fe.width}),ce.forEach(function(fe,ge){if(fe.circularLinkType=="bottom"){for(var Te=ge+1,le=0;Te<ye;Te++)le+=ce[Te].width;fe.y0=me.y1-le-fe.width/2}})})}function U(ee,ne,se){ee.nodes.forEach(function(oe){var me=ee.links.filter(function(Se){return _(Se.target,se)==_(oe,se)}),ce=me.length;ce>1&&me.sort(function(Se,fe){if(!Se.circular&&!fe.circular){if(Se.source.column==fe.source.column||!te(Se,fe))return Se.y0-fe.y0;if(fe.source.column<Se.source.column){var ge=Q(fe,Se);return Se.y0-ge}if(Se.source.column<fe.source.column)return Q(Se,fe)-fe.y0}return Se.circular&&!fe.circular?Se.circularLinkType=="top"?-1:1:fe.circular&&!Se.circular?fe.circularLinkType=="top"?1:-1:Se.circular&&fe.circular?Se.circularLinkType===fe.circularLinkType&&Se.circularLinkType=="top"?Se.source.column===fe.source.column?Se.source.y1-fe.source.y1:Se.source.column-fe.source.column:Se.circularLinkType===fe.circularLinkType&&Se.circularLinkType=="bottom"?Se.source.column===fe.source.column?Se.source.y1-fe.source.y1:fe.source.column-Se.source.column:Se.circularLinkType=="top"?-1:1:void 0});var ye=oe.y0;me.forEach(function(Se){Se.y1=ye+Se.width/2,ye+=Se.width}),me.forEach(function(Se,fe){if(Se.circularLinkType=="bottom"){for(var ge=fe+1,Te=0;ge<ce;ge++)Te+=me[ge].width;Se.y1=oe.y1-Te-Se.width/2}})})}function te(ee,ne){return B(ee)==B(ne)}function B(ee){return ee.y0-ee.y1>0?"up":"down"}function K(ee,ne){return _(ee.source,ne)==_(ee.target,ne)}function J(ee,ne,se){var oe=ee.nodes,me=ee.links,ce=!1,ye=!1;if(me.forEach(function(ge){ge.circularLinkType=="top"?ce=!0:ge.circularLinkType=="bottom"&&(ye=!0)}),ce==0||ye==0){var Se=v.min(oe,function(ge){return ge.y0}),fe=(se-ne)/(v.max(oe,function(ge){return ge.y1})-Se);oe.forEach(function(ge){var Te=(ge.y1-ge.y0)*fe;ge.y0=(ge.y0-Se)*fe,ge.y1=ge.y0+Te}),me.forEach(function(ge){ge.y0=(ge.y0-Se)*fe,ge.y1=(ge.y1-Se)*fe,ge.width=ge.width*fe})}}d.sankeyCircular=function(){var ee,ne,se=0,oe=0,me=1,ce=1,ye=24,Se=u,fe=n,ge=i,Te=x,le=32,ve=2,Me=null;function we(){var Fe={nodes:ge.apply(null,arguments),links:Te.apply(null,arguments)};de(Fe),b(Fe,Se,Me),Ie(Fe),De(Fe),T(Fe,Se),Oe(Fe,le,Se),Ve(Fe);for(var ze=4,Re=0;Re<ze;Re++)N(Fe,ce,Se),U(Fe,ce,Se),$(Fe,oe,ce,Se),N(Fe,ce,Se),U(Fe,ce,Se);return J(Fe,oe,ce),P(Fe,ve,ce,Se),Fe}function de(Fe){Fe.nodes.forEach(function(Re,We){Re.index=We,Re.sourceLinks=[],Re.targetLinks=[]});var ze=w.map(Fe.nodes,Se);return Fe.links.forEach(function(Re,We){Re.index=We;var $e=Re.source,at=Re.target;($e===void 0?"undefined":r($e))!=="object"&&($e=Re.source=f(ze,$e)),(at===void 0?"undefined":r(at))!=="object"&&(at=Re.target=f(ze,at)),$e.sourceLinks.push(Re),at.targetLinks.push(Re)}),Fe}function Ie(Fe){Fe.nodes.forEach(function(ze){ze.partOfCycle=!1,ze.value=Math.max(v.sum(ze.sourceLinks,h),v.sum(ze.targetLinks,h)),ze.sourceLinks.forEach(function(Re){Re.circular&&(ze.partOfCycle=!0,ze.circularLinkType=Re.circularLinkType)}),ze.targetLinks.forEach(function(Re){Re.circular&&(ze.partOfCycle=!0,ze.circularLinkType=Re.circularLinkType)})})}function De(Fe){var ze,Re,We;for(ze=Fe.nodes,Re=[],We=0;ze.length;++We,ze=Re,Re=[])ze.forEach(function($e){$e.depth=We,$e.sourceLinks.forEach(function(at){Re.indexOf(at.target)<0&&!at.circular&&Re.push(at.target)})});for(ze=Fe.nodes,Re=[],We=0;ze.length;++We,ze=Re,Re=[])ze.forEach(function($e){$e.height=We,$e.targetLinks.forEach(function(at){Re.indexOf(at.source)<0&&!at.circular&&Re.push(at.source)})});Fe.nodes.forEach(function($e){$e.column=Math.floor(fe.call(null,$e,We))})}function Oe(Fe,ze,Re){var We=w.nest().key(function(mt){return mt.column}).sortKeys(v.ascending).entries(Fe.nodes).map(function(mt){return mt.values});(function(mt){if(ne){var nt=1/0;We.forEach(function(Gt){var $t=ce*ne/(Gt.length+1);nt=$t<nt?$t:nt}),ee=nt}var Qe=v.min(We,function(Gt){return(ce-oe-(Gt.length-1)*ee)/v.sum(Gt,h)});Qe*=.3,Fe.links.forEach(function(Gt){Gt.width=Gt.value*Qe});var vt=function(Gt){var $t=0,Zt=0,cr=0,Dt=0,Ne=v.max(Gt.nodes,function(Ye){return Ye.column});return Gt.links.forEach(function(Ye){Ye.circular&&(Ye.circularLinkType=="top"?$t+=Ye.width:Zt+=Ye.width,Ye.target.column==0&&(Dt+=Ye.width),Ye.source.column==Ne&&(cr+=Ye.width))}),{top:$t=$t>0?$t+25+10:$t,bottom:Zt=Zt>0?Zt+25+10:Zt,left:Dt=Dt>0?Dt+25+10:Dt,right:cr=cr>0?cr+25+10:cr}}(Fe),jt=function(Gt,$t){var Zt=v.max(Gt.nodes,function(pe){return pe.column}),cr=me-se,Dt=ce-oe,Ne=cr/(cr+$t.right+$t.left),Ye=Dt/(Dt+$t.top+$t.bottom);return se=se*Ne+$t.left,me=$t.right==0?me:me*Ne,oe=oe*Ye+$t.top,ce*=Ye,Gt.nodes.forEach(function(pe){pe.x0=se+pe.column*((me-se-ye)/Zt),pe.x1=pe.x0+ye}),Ye}(Fe,vt);Qe*=jt,Fe.links.forEach(function(Gt){Gt.width=Gt.value*Qe}),We.forEach(function(Gt){var $t=Gt.length;Gt.forEach(function(Zt,cr){Zt.depth==We.length-1&&$t==1||Zt.depth==0&&$t==1?(Zt.y0=ce/2-Zt.value*Qe,Zt.y1=Zt.y0+Zt.value*Qe):Zt.partOfCycle?L(Zt,mt)==0?(Zt.y0=ce/2+cr,Zt.y1=Zt.y0+Zt.value*Qe):Zt.circularLinkType=="top"?(Zt.y0=oe+cr,Zt.y1=Zt.y0+Zt.value*Qe):(Zt.y0=ce-Zt.value*Qe-cr,Zt.y1=Zt.y0+Zt.value*Qe):vt.top==0||vt.bottom==0?(Zt.y0=(ce-oe)/$t*cr,Zt.y1=Zt.y0+Zt.value*Qe):(Zt.y0=(ce-oe)/2-$t/2+cr,Zt.y1=Zt.y0+Zt.value*Qe)})})})(Re),xt();for(var $e=1,at=ze;at>0;--at)gt($e*=.99,Re),xt();function gt(mt,nt){var Qe=We.length;We.forEach(function(vt){var jt=vt.length,Gt=vt[0].depth;vt.forEach(function($t){var Zt;if(($t.sourceLinks.length||$t.targetLinks.length)&&!($t.partOfCycle&&L($t,nt)>0))if(Gt==0&&jt==1)Zt=$t.y1-$t.y0,$t.y0=ce/2-Zt/2,$t.y1=ce/2+Zt/2;else if(Gt==Qe-1&&jt==1)Zt=$t.y1-$t.y0,$t.y0=ce/2-Zt/2,$t.y1=ce/2+Zt/2;else{var cr=v.mean($t.sourceLinks,p),Dt=v.mean($t.targetLinks,s),Ne=((cr&&Dt?(cr+Dt)/2:cr||Dt)-l($t))*mt;$t.y0+=Ne,$t.y1+=Ne}})})}function xt(){We.forEach(function(mt){var nt,Qe,vt,jt=oe,Gt=mt.length;for(mt.sort(a),vt=0;vt<Gt;++vt)(Qe=jt-(nt=mt[vt]).y0)>0&&(nt.y0+=Qe,nt.y1+=Qe),jt=nt.y1+ee;if((Qe=jt-ee-ce)>0)for(jt=nt.y0-=Qe,nt.y1-=Qe,vt=Gt-2;vt>=0;--vt)(Qe=(nt=mt[vt]).y1+ee-jt)>0&&(nt.y0-=Qe,nt.y1-=Qe),jt=nt.y0})}}function Ve(Fe){Fe.nodes.forEach(function(ze){ze.sourceLinks.sort(c),ze.targetLinks.sort(g)}),Fe.nodes.forEach(function(ze){var Re=ze.y0,We=Re,$e=ze.y1,at=$e;ze.sourceLinks.forEach(function(gt){gt.circular?(gt.y0=$e-gt.width/2,$e-=gt.width):(gt.y0=Re+gt.width/2,Re+=gt.width)}),ze.targetLinks.forEach(function(gt){gt.circular?(gt.y1=at-gt.width/2,at-=gt.width):(gt.y1=We+gt.width/2,We+=gt.width)})})}return we.nodeId=function(Fe){return arguments.length?(Se=typeof Fe=="function"?Fe:o(Fe),we):Se},we.nodeAlign=function(Fe){return arguments.length?(fe=typeof Fe=="function"?Fe:o(Fe),we):fe},we.nodeWidth=function(Fe){return arguments.length?(ye=+Fe,we):ye},we.nodePadding=function(Fe){return arguments.length?(ee=+Fe,we):ee},we.nodes=function(Fe){return arguments.length?(ge=typeof Fe=="function"?Fe:o(Fe),we):ge},we.links=function(Fe){return arguments.length?(Te=typeof Fe=="function"?Fe:o(Fe),we):Te},we.size=function(Fe){return arguments.length?(se=oe=0,me=+Fe[0],ce=+Fe[1],we):[me-se,ce-oe]},we.extent=function(Fe){return arguments.length?(se=+Fe[0][0],me=+Fe[1][0],oe=+Fe[0][1],ce=+Fe[1][1],we):[[se,oe],[me,ce]]},we.iterations=function(Fe){return arguments.length?(le=+Fe,we):le},we.circularLinkGap=function(Fe){return arguments.length?(ve=+Fe,we):ve},we.nodePaddingRatio=function(Fe){return arguments.length?(ne=+Fe,we):ne},we.sortNodes=function(Fe){return arguments.length?(Me=Fe,we):Me},we.update=function(Fe){return T(Fe,Se),Ve(Fe),Fe.links.forEach(function(ze){ze.circular&&(ze.circularLinkType=ze.y0+ze.y1<ce?"top":"bottom",ze.source.circularLinkType=ze.circularLinkType,ze.target.circularLinkType=ze.circularLinkType)}),N(Fe,ce,Se,!1),U(Fe,ce,Se),P(Fe,ve,ce,Se),Fe},we},d.sankeyCenter=function(ee){return ee.targetLinks.length?ee.depth:ee.sourceLinks.length?v.min(ee.sourceLinks,t)-1:0},d.sankeyLeft=function(ee){return ee.depth},d.sankeyRight=function(ee,ne){return ne-1-ee.height},d.sankeyJustify=n,Object.defineProperty(d,"__esModule",{value:!0})})},{"d3-array":107,"d3-collection":108,"d3-shape":119,"elementary-circuits-directed-graph":130}],57:[function(m,G,Y){(function(d,v){typeof Y=="object"&&G!==void 0?v(Y,m("d3-array"),m("d3-collection"),m("d3-shape")):v(d.d3=d.d3||{},d.d3,d.d3,d.d3)})(this,function(d,v,w,y){function e(_){return _.target.depth}function t(_,b){return _.sourceLinks.length?_.depth:b-1}function n(_){return function(){return _}}function o(_,b){return g(_.source,b.source)||_.index-b.index}function r(_,b){return g(_.target,b.target)||_.index-b.index}function g(_,b){return _.y0-b.y0}function c(_){return _.value}function a(_){return(_.y0+_.y1)/2}function h(_){return a(_.source)*_.value}function l(_){return a(_.target)*_.value}function s(_){return _.index}function p(_){return _.nodes}function u(_){return _.links}function i(_,b){var T=_.get(b);if(!T)throw new Error("missing: "+b);return T}function x(_){return[_.source.x1,_.y0]}function f(_){return[_.target.x0,_.y1]}d.sankey=function(){var _=0,b=0,T=1,k=1,L=24,A=8,I=s,P=t,S=p,E=u,z=32;function D(){var $={nodes:S.apply(null,arguments),links:E.apply(null,arguments)};return j($),V($),Z($),Q($),X($),$}function j($){$.nodes.forEach(function(H,N){H.index=N,H.sourceLinks=[],H.targetLinks=[]});var re=w.map($.nodes,I);$.links.forEach(function(H,N){H.index=N;var U=H.source,te=H.target;typeof U!="object"&&(U=H.source=i(re,U)),typeof te!="object"&&(te=H.target=i(re,te)),U.sourceLinks.push(H),te.targetLinks.push(H)})}function V($){$.nodes.forEach(function(re){re.value=Math.max(v.sum(re.sourceLinks,c),v.sum(re.targetLinks,c))})}function Z($){var re,H,N;for(re=$.nodes,H=[],N=0;re.length;++N,re=H,H=[])re.forEach(function(te){te.depth=N,te.sourceLinks.forEach(function(B){H.indexOf(B.target)<0&&H.push(B.target)})});for(re=$.nodes,H=[],N=0;re.length;++N,re=H,H=[])re.forEach(function(te){te.height=N,te.targetLinks.forEach(function(B){H.indexOf(B.source)<0&&H.push(B.source)})});var U=(T-_-L)/(N-1);$.nodes.forEach(function(te){te.x1=(te.x0=_+Math.max(0,Math.min(N-1,Math.floor(P.call(null,te,N))))*U)+L})}function Q($){var re=w.nest().key(function(K){return K.x0}).sortKeys(v.ascending).entries($.nodes).map(function(K){return K.values});(function(){var K=v.max(re,function(ne){return ne.length}),J=2/3*(k-b)/(K-1);A>J&&(A=J);var ee=v.min(re,function(ne){return(k-b-(ne.length-1)*A)/v.sum(ne,c)});re.forEach(function(ne){ne.forEach(function(se,oe){se.y1=(se.y0=oe)+se.value*ee})}),$.links.forEach(function(ne){ne.width=ne.value*ee})})(),B();for(var H=1,N=z;N>0;--N)te(H*=.99),B(),U(H),B();function U(K){re.forEach(function(J){J.forEach(function(ee){if(ee.targetLinks.length){var ne=(v.sum(ee.targetLinks,h)/v.sum(ee.targetLinks,c)-a(ee))*K;ee.y0+=ne,ee.y1+=ne}})})}function te(K){re.slice().reverse().forEach(function(J){J.forEach(function(ee){if(ee.sourceLinks.length){var ne=(v.sum(ee.sourceLinks,l)/v.sum(ee.sourceLinks,c)-a(ee))*K;ee.y0+=ne,ee.y1+=ne}})})}function B(){re.forEach(function(K){var J,ee,ne,se=b,oe=K.length;for(K.sort(g),ne=0;ne<oe;++ne)(ee=se-(J=K[ne]).y0)>0&&(J.y0+=ee,J.y1+=ee),se=J.y1+A;if((ee=se-A-k)>0)for(se=J.y0-=ee,J.y1-=ee,ne=oe-2;ne>=0;--ne)(ee=(J=K[ne]).y1+A-se)>0&&(J.y0-=ee,J.y1-=ee),se=J.y0})}}function X($){$.nodes.forEach(function(re){re.sourceLinks.sort(r),re.targetLinks.sort(o)}),$.nodes.forEach(function(re){var H=re.y0,N=H;re.sourceLinks.forEach(function(U){U.y0=H+U.width/2,H+=U.width}),re.targetLinks.forEach(function(U){U.y1=N+U.width/2,N+=U.width})})}return D.update=function($){return X($),$},D.nodeId=function($){return arguments.length?(I=typeof $=="function"?$:n($),D):I},D.nodeAlign=function($){return arguments.length?(P=typeof $=="function"?$:n($),D):P},D.nodeWidth=function($){return arguments.length?(L=+$,D):L},D.nodePadding=function($){return arguments.length?(A=+$,D):A},D.nodes=function($){return arguments.length?(S=typeof $=="function"?$:n($),D):S},D.links=function($){return arguments.length?(E=typeof $=="function"?$:n($),D):E},D.size=function($){return arguments.length?(_=b=0,T=+$[0],k=+$[1],D):[T-_,k-b]},D.extent=function($){return arguments.length?(_=+$[0][0],T=+$[1][0],b=+$[0][1],k=+$[1][1],D):[[_,b],[T,k]]},D.iterations=function($){return arguments.length?(z=+$,D):z},D},d.sankeyCenter=function(_){return _.targetLinks.length?_.depth:_.sourceLinks.length?v.min(_.sourceLinks,e)-1:0},d.sankeyLeft=function(_){return _.depth},d.sankeyRight=function(_,b){return b-1-_.height},d.sankeyJustify=t,d.sankeyLinkHorizontal=function(){return y.linkHorizontal().source(x).target(f)},Object.defineProperty(d,"__esModule",{value:!0})})},{"d3-array":107,"d3-collection":108,"d3-shape":119}],58:[function(m,G,Y){(function(){var d={version:"3.8.0"},v=[].slice,w=function(ue){return v.call(ue)},y=self.document;function e(ue){return ue&&(ue.ownerDocument||ue.document||ue).documentElement}function t(ue){return ue&&(ue.ownerDocument&&ue.ownerDocument.defaultView||ue.document&&ue||ue.defaultView)}if(y)try{w(y.documentElement.childNodes)[0].nodeType}catch{w=function(C){for(var R=C.length,F=new Array(R);R--;)F[R]=C[R];return F}}if(Date.now||(Date.now=function(){return+new Date}),y)try{y.createElement("DIV").style.setProperty("opacity",0,"")}catch{var n=this.Element.prototype,o=n.setAttribute,r=n.setAttributeNS,g=this.CSSStyleDeclaration.prototype,c=g.setProperty;n.setAttribute=function(C,R){o.call(this,C,R+"")},n.setAttributeNS=function(C,R,F){r.call(this,C,R,F+"")},g.setProperty=function(C,R,F){c.call(this,C,R+"",F)}}function a(ue,C){return ue<C?-1:ue>C?1:ue>=C?0:NaN}function h(ue){return ue===null?NaN:+ue}function l(ue){return!isNaN(ue)}function s(ue){return{left:function(C,R,F,q){for(arguments.length<3&&(F=0),arguments.length<4&&(q=C.length);F<q;){var ae=F+q>>>1;ue(C[ae],R)<0?F=ae+1:q=ae}return F},right:function(C,R,F,q){for(arguments.length<3&&(F=0),arguments.length<4&&(q=C.length);F<q;){var ae=F+q>>>1;ue(C[ae],R)>0?q=ae:F=ae+1}return F}}}d.ascending=a,d.descending=function(ue,C){return C<ue?-1:C>ue?1:C>=ue?0:NaN},d.min=function(ue,C){var R,F,q=-1,ae=ue.length;if(arguments.length===1){for(;++q<ae;)if((F=ue[q])!=null&&F>=F){R=F;break}for(;++q<ae;)(F=ue[q])!=null&&R>F&&(R=F)}else{for(;++q<ae;)if((F=C.call(ue,ue[q],q))!=null&&F>=F){R=F;break}for(;++q<ae;)(F=C.call(ue,ue[q],q))!=null&&R>F&&(R=F)}return R},d.max=function(ue,C){var R,F,q=-1,ae=ue.length;if(arguments.length===1){for(;++q<ae;)if((F=ue[q])!=null&&F>=F){R=F;break}for(;++q<ae;)(F=ue[q])!=null&&F>R&&(R=F)}else{for(;++q<ae;)if((F=C.call(ue,ue[q],q))!=null&&F>=F){R=F;break}for(;++q<ae;)(F=C.call(ue,ue[q],q))!=null&&F>R&&(R=F)}return R},d.extent=function(ue,C){var R,F,q,ae=-1,he=ue.length;if(arguments.length===1){for(;++ae<he;)if((F=ue[ae])!=null&&F>=F){R=q=F;break}for(;++ae<he;)(F=ue[ae])!=null&&(R>F&&(R=F),q<F&&(q=F))}else{for(;++ae<he;)if((F=C.call(ue,ue[ae],ae))!=null&&F>=F){R=q=F;break}for(;++ae<he;)(F=C.call(ue,ue[ae],ae))!=null&&(R>F&&(R=F),q<F&&(q=F))}return[R,q]},d.sum=function(ue,C){var R,F=0,q=ue.length,ae=-1;if(arguments.length===1)for(;++ae<q;)l(R=+ue[ae])&&(F+=R);else for(;++ae<q;)l(R=+C.call(ue,ue[ae],ae))&&(F+=R);return F},d.mean=function(ue,C){var R,F=0,q=ue.length,ae=-1,he=q;if(arguments.length===1)for(;++ae<q;)l(R=h(ue[ae]))?F+=R:--he;else for(;++ae<q;)l(R=h(C.call(ue,ue[ae],ae)))?F+=R:--he;if(he)return F/he},d.quantile=function(ue,C){var R=(ue.length-1)*C+1,F=Math.floor(R),q=+ue[F-1],ae=R-F;return ae?q+ae*(ue[F]-q):q},d.median=function(ue,C){var R,F=[],q=ue.length,ae=-1;if(arguments.length===1)for(;++ae<q;)l(R=h(ue[ae]))&&F.push(R);else for(;++ae<q;)l(R=h(C.call(ue,ue[ae],ae)))&&F.push(R);if(F.length)return d.quantile(F.sort(a),.5)},d.variance=function(ue,C){var R,F,q=ue.length,ae=0,he=0,be=-1,Ae=0;if(arguments.length===1)for(;++be<q;)l(R=h(ue[be]))&&(he+=(F=R-ae)*(R-(ae+=F/++Ae)));else for(;++be<q;)l(R=h(C.call(ue,ue[be],be)))&&(he+=(F=R-ae)*(R-(ae+=F/++Ae)));if(Ae>1)return he/(Ae-1)},d.deviation=function(){var ue=d.variance.apply(this,arguments);return ue&&Math.sqrt(ue)};var p=s(a);function u(ue){return ue.length}d.bisectLeft=p.left,d.bisect=d.bisectRight=p.right,d.bisector=function(ue){return s(ue.length===1?function(C,R){return a(ue(C),R)}:ue)},d.shuffle=function(ue,C,R){(ae=arguments.length)<3&&(R=ue.length,ae<2&&(C=0));for(var F,q,ae=R-C;ae;)q=Math.random()*ae--|0,F=ue[ae+C],ue[ae+C]=ue[q+C],ue[q+C]=F;return ue},d.permute=function(ue,C){for(var R=C.length,F=new Array(R);R--;)F[R]=ue[C[R]];return F},d.pairs=function(ue){for(var C=0,R=ue.length-1,F=ue[0],q=new Array(R<0?0:R);C<R;)q[C]=[F,F=ue[++C]];return q},d.transpose=function(ue){if(!(q=ue.length))return[];for(var C=-1,R=d.min(ue,u),F=new Array(R);++C<R;)for(var q,ae=-1,he=F[C]=new Array(q);++ae<q;)he[ae]=ue[ae][C];return F},d.zip=function(){return d.transpose(arguments)},d.keys=function(ue){var C=[];for(var R in ue)C.push(R);return C},d.values=function(ue){var C=[];for(var R in ue)C.push(ue[R]);return C},d.entries=function(ue){var C=[];for(var R in ue)C.push({key:R,value:ue[R]});return C},d.merge=function(ue){for(var C,R,F,q=ue.length,ae=-1,he=0;++ae<q;)he+=ue[ae].length;for(R=new Array(he);--q>=0;)for(C=(F=ue[q]).length;--C>=0;)R[--he]=F[C];return R};var i=Math.abs;function x(ue){for(var C=1;ue*C%1;)C*=10;return C}function f(ue,C){for(var R in C)Object.defineProperty(ue.prototype,R,{value:C[R],enumerable:!1})}function _(){this._=Object.create(null)}d.range=function(ue,C,R){if(arguments.length<3&&(R=1,arguments.length<2&&(C=ue,ue=0)),(C-ue)/R==1/0)throw new Error("infinite range");var F,q=[],ae=x(i(R)),he=-1;if(ue*=ae,C*=ae,(R*=ae)<0)for(;(F=ue+R*++he)>C;)q.push(F/ae);else for(;(F=ue+R*++he)<C;)q.push(F/ae);return q},d.map=function(ue,C){var R=new _;if(ue instanceof _)ue.forEach(function(be,Ae){R.set(be,Ae)});else if(Array.isArray(ue)){var F,q=-1,ae=ue.length;if(arguments.length===1)for(;++q<ae;)R.set(q,ue[q]);else for(;++q<ae;)R.set(C.call(ue,F=ue[q],q),F)}else for(var he in ue)R.set(he,ue[he]);return R};function b(ue){return(ue+="")=="__proto__"||ue[0]==="\0"?"\0"+ue:ue}function T(ue){return(ue+="")[0]==="\0"?ue.slice(1):ue}function k(ue){return b(ue)in this._}function L(ue){return(ue=b(ue))in this._&&delete this._[ue]}function A(){var ue=[];for(var C in this._)ue.push(T(C));return ue}function I(){var ue=0;for(var C in this._)++ue;return ue}function P(){for(var ue in this._)return!1;return!0}function S(){this._=Object.create(null)}function E(ue){return ue}function z(ue,C,R){return function(){var F=R.apply(C,arguments);return F===C?ue:F}}function D(ue,C){if(C in ue)return C;C=C.charAt(0).toUpperCase()+C.slice(1);for(var R=0,F=j.length;R<F;++R){var q=j[R]+C;if(q in ue)return q}}f(_,{has:k,get:function(ue){return this._[b(ue)]},set:function(ue,C){return this._[b(ue)]=C},remove:L,keys:A,values:function(){var ue=[];for(var C in this._)ue.push(this._[C]);return ue},entries:function(){var ue=[];for(var C in this._)ue.push({key:T(C),value:this._[C]});return ue},size:I,empty:P,forEach:function(ue){for(var C in this._)ue.call(this,T(C),this._[C])}}),d.nest=function(){var ue,C,R={},F=[],q=[];function ae(he,be,Ae){if(Ae>=F.length)return C?C.call(R,be):ue?be.sort(ue):be;for(var Ce,qe,et,st,kt=-1,Pt=be.length,Et=F[Ae++],Lt=new _;++kt<Pt;)(st=Lt.get(Ce=Et(qe=be[kt])))?st.push(qe):Lt.set(Ce,[qe]);return he?(qe=he(),et=function(Tt,Bt){qe.set(Tt,ae(he,Bt,Ae))}):(qe={},et=function(Tt,Bt){qe[Tt]=ae(he,Bt,Ae)}),Lt.forEach(et),qe}return R.map=function(he,be){return ae(be,he,0)},R.entries=function(he){return function be(Ae,Ce){if(Ce>=F.length)return Ae;var qe=[],et=q[Ce++];return Ae.forEach(function(st,kt){qe.push({key:st,values:be(kt,Ce)})}),et?qe.sort(function(st,kt){return et(st.key,kt.key)}):qe}(ae(d.map,he,0),0)},R.key=function(he){return F.push(he),R},R.sortKeys=function(he){return q[F.length-1]=he,R},R.sortValues=function(he){return ue=he,R},R.rollup=function(he){return C=he,R},R},d.set=function(ue){var C=new S;if(ue)for(var R=0,F=ue.length;R<F;++R)C.add(ue[R]);return C},f(S,{has:k,add:function(ue){return this._[b(ue+="")]=!0,ue},remove:L,values:A,size:I,empty:P,forEach:function(ue){for(var C in this._)ue.call(this,T(C))}}),d.behavior={},d.rebind=function(ue,C){for(var R,F=1,q=arguments.length;++F<q;)ue[R=arguments[F]]=z(ue,C,C[R]);return ue};var j=["webkit","ms","moz","Moz","o","O"];function V(){}function Z(){}function Q(ue){var C=[],R=new _;function F(){for(var q,ae=C,he=-1,be=ae.length;++he<be;)(q=ae[he].on)&&q.apply(this,arguments);return ue}return F.on=function(q,ae){var he,be=R.get(q);return arguments.length<2?be&&be.on:(be&&(be.on=null,C=C.slice(0,he=C.indexOf(be)).concat(C.slice(he+1)),R.remove(q)),ae&&C.push(R.set(q,{on:ae})),ue)},F}function X(){d.event.preventDefault()}function $(){for(var ue,C=d.event;ue=C.sourceEvent;)C=ue;return C}function re(ue){for(var C=new Z,R=0,F=arguments.length;++R<F;)C[arguments[R]]=Q(C);return C.of=function(q,ae){return function(he){try{var be=he.sourceEvent=d.event;he.target=ue,d.event=he,C[he.type].apply(q,ae)}finally{d.event=be}}},C}d.dispatch=function(){for(var ue=new Z,C=-1,R=arguments.length;++C<R;)ue[arguments[C]]=Q(ue);return ue},Z.prototype.on=function(ue,C){var R=ue.indexOf("."),F="";if(R>=0&&(F=ue.slice(R+1),ue=ue.slice(0,R)),ue)return arguments.length<2?this[ue].on(F):this[ue].on(F,C);if(arguments.length===2){if(C==null)for(ue in this)this.hasOwnProperty(ue)&&this[ue].on(F,null);return this}},d.event=null,d.requote=function(ue){return ue.replace(H,"\\$&")};var H=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,N={}.__proto__?function(ue,C){ue.__proto__=C}:function(ue,C){for(var R in C)ue[R]=C[R]};function U(ue){return N(ue,J),ue}var te=function(ue,C){return C.querySelector(ue)},B=function(ue,C){return C.querySelectorAll(ue)},K=function(ue,C){var R=ue.matches||ue[D(ue,"matchesSelector")];return(K=function(F,q){return R.call(F,q)})(ue,C)};typeof Sizzle=="function"&&(te=function(ue,C){return Sizzle(ue,C)[0]||null},B=Sizzle,K=Sizzle.matchesSelector),d.selection=function(){return d.select(y.documentElement)};var J=d.selection.prototype=[];function ee(ue){return typeof ue=="function"?ue:function(){return te(ue,this)}}function ne(ue){return typeof ue=="function"?ue:function(){return B(ue,this)}}J.select=function(ue){var C,R,F,q,ae=[];ue=ee(ue);for(var he=-1,be=this.length;++he<be;){ae.push(C=[]),C.parentNode=(F=this[he]).parentNode;for(var Ae=-1,Ce=F.length;++Ae<Ce;)(q=F[Ae])?(C.push(R=ue.call(q,q.__data__,Ae,he)),R&&"__data__"in q&&(R.__data__=q.__data__)):C.push(null)}return U(ae)},J.selectAll=function(ue){var C,R,F=[];ue=ne(ue);for(var q=-1,ae=this.length;++q<ae;)for(var he=this[q],be=-1,Ae=he.length;++be<Ae;)(R=he[be])&&(F.push(C=w(ue.call(R,R.__data__,be,q))),C.parentNode=R);return U(F)};var se="http://www.w3.org/1999/xhtml",oe={svg:"http://www.w3.org/2000/svg",xhtml:se,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function me(ue,C){return ue=d.ns.qualify(ue),C==null?ue.local?function(){this.removeAttributeNS(ue.space,ue.local)}:function(){this.removeAttribute(ue)}:typeof C=="function"?ue.local?function(){var R=C.apply(this,arguments);R==null?this.removeAttributeNS(ue.space,ue.local):this.setAttributeNS(ue.space,ue.local,R)}:function(){var R=C.apply(this,arguments);R==null?this.removeAttribute(ue):this.setAttribute(ue,R)}:ue.local?function(){this.setAttributeNS(ue.space,ue.local,C)}:function(){this.setAttribute(ue,C)}}function ce(ue){return ue.trim().replace(/\s+/g," ")}function ye(ue){return new RegExp("(?:^|\\s+)"+d.requote(ue)+"(?:\\s+|$)","g")}function Se(ue){return(ue+"").trim().split(/^|\s+/)}function fe(ue,C){var R=(ue=Se(ue).map(ge)).length;return typeof C=="function"?function(){for(var F=-1,q=C.apply(this,arguments);++F<R;)ue[F](this,q)}:function(){for(var F=-1;++F<R;)ue[F](this,C)}}function ge(ue){var C=ye(ue);return function(R,F){if(q=R.classList)return F?q.add(ue):q.remove(ue);var q=R.getAttribute("class")||"";F?(C.lastIndex=0,C.test(q)||R.setAttribute("class",ce(q+" "+ue))):R.setAttribute("class",ce(q.replace(C," ")))}}function Te(ue,C,R){return C==null?function(){this.style.removeProperty(ue)}:typeof C=="function"?function(){var F=C.apply(this,arguments);F==null?this.style.removeProperty(ue):this.style.setProperty(ue,F,R)}:function(){this.style.setProperty(ue,C,R)}}function le(ue,C){return C==null?function(){delete this[ue]}:typeof C=="function"?function(){var R=C.apply(this,arguments);R==null?delete this[ue]:this[ue]=R}:function(){this[ue]=C}}function ve(ue){return typeof ue=="function"?ue:(ue=d.ns.qualify(ue)).local?function(){return this.ownerDocument.createElementNS(ue.space,ue.local)}:function(){var C=this.ownerDocument,R=this.namespaceURI;return R===se&&C.documentElement.namespaceURI===se?C.createElement(ue):C.createElementNS(R,ue)}}function Me(){var ue=this.parentNode;ue&&ue.removeChild(this)}function we(ue){return{__data__:ue}}function de(ue){return function(){return K(this,ue)}}function Ie(ue){return arguments.length||(ue=a),function(C,R){return C&&R?ue(C.__data__,R.__data__):!C-!R}}function De(ue,C){for(var R=0,F=ue.length;R<F;R++)for(var q,ae=ue[R],he=0,be=ae.length;he<be;he++)(q=ae[he])&&C(q,he,R);return ue}function Oe(ue){return N(ue,Ve),ue}d.ns={prefix:oe,qualify:function(ue){var C=ue.indexOf(":"),R=ue;return C>=0&&(R=ue.slice(0,C))!=="xmlns"&&(ue=ue.slice(C+1)),oe.hasOwnProperty(R)?{space:oe[R],local:ue}:ue}},J.attr=function(ue,C){if(arguments.length<2){if(typeof ue=="string"){var R=this.node();return(ue=d.ns.qualify(ue)).local?R.getAttributeNS(ue.space,ue.local):R.getAttribute(ue)}for(C in ue)this.each(me(C,ue[C]));return this}return this.each(me(ue,C))},J.classed=function(ue,C){if(arguments.length<2){if(typeof ue=="string"){var R=this.node(),F=(ue=Se(ue)).length,q=-1;if(C=R.classList){for(;++q<F;)if(!C.contains(ue[q]))return!1}else for(C=R.getAttribute("class");++q<F;)if(!ye(ue[q]).test(C))return!1;return!0}for(C in ue)this.each(fe(C,ue[C]));return this}return this.each(fe(ue,C))},J.style=function(ue,C,R){var F=arguments.length;if(F<3){if(typeof ue!="string"){for(R in F<2&&(C=""),ue)this.each(Te(R,ue[R],C));return this}if(F<2){var q=this.node();return t(q).getComputedStyle(q,null).getPropertyValue(ue)}R=""}return this.each(Te(ue,C,R))},J.property=function(ue,C){if(arguments.length<2){if(typeof ue=="string")return this.node()[ue];for(C in ue)this.each(le(C,ue[C]));return this}return this.each(le(ue,C))},J.text=function(ue){return arguments.length?this.each(typeof ue=="function"?function(){var C=ue.apply(this,arguments);this.textContent=C==null?"":C}:ue==null?function(){this.textContent=""}:function(){this.textContent=ue}):this.node().textContent},J.html=function(ue){return arguments.length?this.each(typeof ue=="function"?function(){var C=ue.apply(this,arguments);this.innerHTML=C==null?"":C}:ue==null?function(){this.innerHTML=""}:function(){this.innerHTML=ue}):this.node().innerHTML},J.append=function(ue){return ue=ve(ue),this.select(function(){return this.appendChild(ue.apply(this,arguments))})},J.insert=function(ue,C){return ue=ve(ue),C=ee(C),this.select(function(){return this.insertBefore(ue.apply(this,arguments),C.apply(this,arguments)||null)})},J.remove=function(){return this.each(Me)},J.data=function(ue,C){var R,F,q=-1,ae=this.length;if(!arguments.length){for(ue=new Array(ae=(R=this[0]).length);++q<ae;)(F=R[q])&&(ue[q]=F.__data__);return ue}function he(qe,et){var st,kt,Pt,Et=qe.length,Lt=et.length,Tt=Math.min(Et,Lt),Bt=new Array(Lt),zt=new Array(Lt),Ht=new Array(Et);if(C){var lr,br=new _,zr=new Array(Et);for(st=-1;++st<Et;)(kt=qe[st])&&(br.has(lr=C.call(kt,kt.__data__,st))?Ht[st]=kt:br.set(lr,kt),zr[st]=lr);for(st=-1;++st<Lt;)(kt=br.get(lr=C.call(et,Pt=et[st],st)))?kt!==!0&&(Bt[st]=kt,kt.__data__=Pt):zt[st]=we(Pt),br.set(lr,!0);for(st=-1;++st<Et;)st in zr&&br.get(zr[st])!==!0&&(Ht[st]=qe[st])}else{for(st=-1;++st<Tt;)kt=qe[st],Pt=et[st],kt?(kt.__data__=Pt,Bt[st]=kt):zt[st]=we(Pt);for(;st<Lt;++st)zt[st]=we(et[st]);for(;st<Et;++st)Ht[st]=qe[st]}zt.update=Bt,zt.parentNode=Bt.parentNode=Ht.parentNode=qe.parentNode,be.push(zt),Ae.push(Bt),Ce.push(Ht)}var be=Oe([]),Ae=U([]),Ce=U([]);if(typeof ue=="function")for(;++q<ae;)he(R=this[q],ue.call(R,R.parentNode.__data__,q));else for(;++q<ae;)he(R=this[q],ue);return Ae.enter=function(){return be},Ae.exit=function(){return Ce},Ae},J.datum=function(ue){return arguments.length?this.property("__data__",ue):this.property("__data__")},J.filter=function(ue){var C,R,F,q=[];typeof ue!="function"&&(ue=de(ue));for(var ae=0,he=this.length;ae<he;ae++){q.push(C=[]),C.parentNode=(R=this[ae]).parentNode;for(var be=0,Ae=R.length;be<Ae;be++)(F=R[be])&&ue.call(F,F.__data__,be,ae)&&C.push(F)}return U(q)},J.order=function(){for(var ue=-1,C=this.length;++ue<C;)for(var R,F=this[ue],q=F.length-1,ae=F[q];--q>=0;)(R=F[q])&&(ae&&ae!==R.nextSibling&&ae.parentNode.insertBefore(R,ae),ae=R);return this},J.sort=function(ue){ue=Ie.apply(this,arguments);for(var C=-1,R=this.length;++C<R;)this[C].sort(ue);return this.order()},J.each=function(ue){return De(this,function(C,R,F){ue.call(C,C.__data__,R,F)})},J.call=function(ue){var C=w(arguments);return ue.apply(C[0]=this,C),this},J.empty=function(){return!this.node()},J.node=function(){for(var ue=0,C=this.length;ue<C;ue++)for(var R=this[ue],F=0,q=R.length;F<q;F++){var ae=R[F];if(ae)return ae}return null},J.size=function(){var ue=0;return De(this,function(){++ue}),ue};var Ve=[];function Fe(ue){var C,R;return function(F,q,ae){var he,be=ue[ae].update,Ae=be.length;for(ae!=R&&(R=ae,C=0),q>=C&&(C=q+1);!(he=be[C])&&++C<Ae;);return he}}function ze(ue,C,R){var F="__on"+ue,q=ue.indexOf("."),ae=We;q>0&&(ue=ue.slice(0,q));var he=Re.get(ue);function be(){var Ae=this[F];Ae&&(this.removeEventListener(ue,Ae,Ae.$),delete this[F])}return he&&(ue=he,ae=$e),q?C?function(){var Ae=ae(C,w(arguments));be.call(this),this.addEventListener(ue,this[F]=Ae,Ae.$=R),Ae._=C}:be:C?V:function(){var Ae,Ce=new RegExp("^__on([^.]+)"+d.requote(ue)+"$");for(var qe in this)if(Ae=qe.match(Ce)){var et=this[qe];this.removeEventListener(Ae[1],et,et.$),delete this[qe]}}}d.selection.enter=Oe,d.selection.enter.prototype=Ve,Ve.append=J.append,Ve.empty=J.empty,Ve.node=J.node,Ve.call=J.call,Ve.size=J.size,Ve.select=function(ue){for(var C,R,F,q,ae,he=[],be=-1,Ae=this.length;++be<Ae;){F=(q=this[be]).update,he.push(C=[]),C.parentNode=q.parentNode;for(var Ce=-1,qe=q.length;++Ce<qe;)(ae=q[Ce])?(C.push(F[Ce]=R=ue.call(q.parentNode,ae.__data__,Ce,be)),R.__data__=ae.__data__):C.push(null)}return U(he)},Ve.insert=function(ue,C){return arguments.length<2&&(C=Fe(this)),J.insert.call(this,ue,C)},d.select=function(ue){var C;return typeof ue=="string"?(C=[te(ue,y)]).parentNode=y.documentElement:(C=[ue]).parentNode=e(ue),U([C])},d.selectAll=function(ue){var C;return typeof ue=="string"?(C=w(B(ue,y))).parentNode=y.documentElement:(C=w(ue)).parentNode=null,U([C])},J.on=function(ue,C,R){var F=arguments.length;if(F<3){if(typeof ue!="string"){for(R in F<2&&(C=!1),ue)this.each(ze(R,ue[R],C));return this}if(F<2)return(F=this.node()["__on"+ue])&&F._;R=!1}return this.each(ze(ue,C,R))};var Re=d.map({mouseenter:"mouseover",mouseleave:"mouseout"});function We(ue,C){return function(R){var F=d.event;d.event=R,C[0]=this.__data__;try{ue.apply(this,C)}finally{d.event=F}}}function $e(ue,C){var R=We(ue,C);return function(F){var q=F.relatedTarget;q&&(q===this||8&q.compareDocumentPosition(this))||R.call(this,F)}}y&&Re.forEach(function(ue){"on"+ue in y&&Re.remove(ue)});var at,gt=0;function xt(ue){var C=".dragsuppress-"+ ++gt,R="click"+C,F=d.select(t(ue)).on("touchmove"+C,X).on("dragstart"+C,X).on("selectstart"+C,X);if(at==null&&(at=!("onselectstart"in ue)&&D(ue.style,"userSelect")),at){var q=e(ue).style,ae=q[at];q[at]="none"}return function(he){if(F.on(C,null),at&&(q[at]=ae),he){var be=function(){F.on(R,null)};F.on(R,function(){X(),be()},!0),setTimeout(be,0)}}}d.mouse=function(ue){return nt(ue,$())};var mt=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function nt(ue,C){C.changedTouches&&(C=C.changedTouches[0]);var R=ue.ownerSVGElement||ue;if(R.createSVGPoint){var F=R.createSVGPoint();if(mt<0){var q=t(ue);if(q.scrollX||q.scrollY){var ae=(R=d.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();mt=!(ae.f||ae.e),R.remove()}}return mt?(F.x=C.pageX,F.y=C.pageY):(F.x=C.clientX,F.y=C.clientY),[(F=F.matrixTransform(ue.getScreenCTM().inverse())).x,F.y]}var he=ue.getBoundingClientRect();return[C.clientX-he.left-ue.clientLeft,C.clientY-he.top-ue.clientTop]}function Qe(){return d.event.changedTouches[0].identifier}d.touch=function(ue,C,R){if(arguments.length<3&&(R=C,C=$().changedTouches),C){for(var F,q=0,ae=C.length;q<ae;++q)if((F=C[q]).identifier===R)return nt(ue,F)}},d.behavior.drag=function(){var ue=re(q,"drag","dragstart","dragend"),C=null,R=ae(V,d.mouse,t,"mousemove","mouseup"),F=ae(Qe,d.touch,E,"touchmove","touchend");function q(){this.on("mousedown.drag",R).on("touchstart.drag",F)}function ae(he,be,Ae,Ce,qe){return function(){var et,st=this,kt=d.event.target.correspondingElement||d.event.target,Pt=st.parentNode,Et=ue.of(st,arguments),Lt=0,Tt=he(),Bt=".drag"+(Tt==null?"":"-"+Tt),zt=d.select(Ae(kt)).on(Ce+Bt,br).on(qe+Bt,zr),Ht=xt(kt),lr=be(Pt,Tt);function br(){var Or,tn,en=be(Pt,Tt);en&&(Or=en[0]-lr[0],tn=en[1]-lr[1],Lt|=Or|tn,lr=en,Et({type:"drag",x:en[0]+et[0],y:en[1]+et[1],dx:Or,dy:tn}))}function zr(){be(Pt,Tt)&&(zt.on(Ce+Bt,null).on(qe+Bt,null),Ht(Lt),Et({type:"dragend"}))}et=C?[(et=C.apply(st,arguments)).x-lr[0],et.y-lr[1]]:[0,0],Et({type:"dragstart"})}}return q.origin=function(he){return arguments.length?(C=he,q):C},d.rebind(q,ue,"on")},d.touches=function(ue,C){return arguments.length<2&&(C=$().touches),C?w(C).map(function(R){var F=nt(ue,R);return F.identifier=R.identifier,F}):[]};var vt=1e-6,jt=Math.PI,Gt=2*jt,$t=Gt-vt,Zt=jt/2,cr=jt/180,Dt=180/jt;function Ne(ue){return ue>1?Zt:ue<-1?-Zt:Math.asin(ue)}function Ye(ue){return((ue=Math.exp(ue))+1/ue)/2}var pe=Math.SQRT2;d.interpolateZoom=function(ue,C){var R,F,q=ue[0],ae=ue[1],he=ue[2],be=C[0],Ae=C[1],Ce=C[2],qe=be-q,et=Ae-ae,st=qe*qe+et*et;if(st<1e-12)F=Math.log(Ce/he)/pe,R=function(Bt){return[q+Bt*qe,ae+Bt*et,he*Math.exp(pe*Bt*F)]};else{var kt=Math.sqrt(st),Pt=(Ce*Ce-he*he+4*st)/(2*he*2*kt),Et=(Ce*Ce-he*he-4*st)/(2*Ce*2*kt),Lt=Math.log(Math.sqrt(Pt*Pt+1)-Pt),Tt=Math.log(Math.sqrt(Et*Et+1)-Et);F=(Tt-Lt)/pe,R=function(Bt){var zt,Ht=Bt*F,lr=Ye(Lt),br=he/(2*kt)*(lr*(zt=pe*Ht+Lt,((zt=Math.exp(2*zt))-1)/(zt+1))-function(zr){return((zr=Math.exp(zr))-1/zr)/2}(Lt));return[q+br*qe,ae+br*et,he*lr/Ye(pe*Ht+Lt)]}}return R.duration=1e3*F,R},d.behavior.zoom=function(){var ue,C,R,F,q,ae,he,be,Ae,Ce={x:0,y:0,k:1},qe=[960,500],et=He,st=250,kt=0,Pt="mousedown.zoom",Et="mousemove.zoom",Lt="mouseup.zoom",Tt="touchstart.zoom",Bt=re(zt,"zoomstart","zoom","zoomend");function zt(Kr){Kr.on(Pt,hn).on(Be+".zoom",Kn).on("dblclick.zoom",hi).on(Tt,Hn)}function Ht(Kr){return[(Kr[0]-Ce.x)/Ce.k,(Kr[1]-Ce.y)/Ce.k]}function lr(Kr){Ce.k=Math.max(et[0],Math.min(et[1],Kr))}function br(Kr,Ln){Ln=function(Jn){return[Jn[0]*Ce.k+Ce.x,Jn[1]*Ce.k+Ce.y]}(Ln),Ce.x+=Kr[0]-Ln[0],Ce.y+=Kr[1]-Ln[1]}function zr(Kr,Ln,Jn,Wn){Kr.__chart__={x:Ce.x,y:Ce.y,k:Ce.k},lr(Math.pow(2,Wn)),br(C=Ln,Jn),Kr=d.select(Kr),st>0&&(Kr=Kr.transition().duration(st)),Kr.call(zt.event)}function Or(){he&&he.domain(ae.range().map(function(Kr){return(Kr-Ce.x)/Ce.k}).map(ae.invert)),Ae&&Ae.domain(be.range().map(function(Kr){return(Kr-Ce.y)/Ce.k}).map(be.invert))}function tn(Kr){kt++||Kr({type:"zoomstart"})}function en(Kr){Or(),Kr({type:"zoom",scale:Ce.k,translate:[Ce.x,Ce.y]})}function vn(Kr){--kt||(Kr({type:"zoomend"}),C=null)}function hn(){var Kr=this,Ln=Bt.of(Kr,arguments),Jn=0,Wn=d.select(t(Kr)).on(Et,Li).on(Lt,ri),oi=Ht(d.mouse(Kr)),di=xt(Kr);function Li(){Jn=1,br(d.mouse(Kr),oi),en(Ln)}function ri(){Wn.on(Et,null).on(Lt,null),di(Jn),vn(Ln)}qs.call(Kr),tn(Ln)}function Hn(){var Kr,Ln=this,Jn=Bt.of(Ln,arguments),Wn={},oi=0,di=".zoom-"+d.event.changedTouches[0].identifier,Li="touchmove"+di,ri="touchend"+di,_i=[],yi=d.select(Ln),Ii=xt(Ln);function wi(){var Ba=d.touches(Ln);return Kr=Ce.k,Ba.forEach(function(Na){Na.identifier in Wn&&(Wn[Na.identifier]=Ht(Na))}),Ba}function Oi(){var Ba=d.event.target;d.select(Ba).on(Li,Hi).on(ri,da),_i.push(Ba);for(var Na=d.event.changedTouches,pa=0,Ca=Na.length;pa<Ca;++pa)Wn[Na[pa].identifier]=null;var ba=wi(),So=Date.now();if(ba.length===1){if(So-q<500){var Qa=ba[0];zr(Ln,Qa,Wn[Qa.identifier],Math.floor(Math.log(Ce.k)/Math.LN2)+1),X()}q=So}else if(ba.length>1){Qa=ba[0];var qo=ba[1],Fs=Qa[0]-qo[0],ul=Qa[1]-qo[1];oi=Fs*Fs+ul*ul}}function Hi(){var Ba,Na,pa,Ca,ba=d.touches(Ln);qs.call(Ln);for(var So=0,Qa=ba.length;So<Qa;++So,Ca=null)if(pa=ba[So],Ca=Wn[pa.identifier]){if(Na)break;Ba=pa,Na=Ca}if(Ca){var qo=(qo=pa[0]-Ba[0])*qo+(qo=pa[1]-Ba[1])*qo,Fs=oi&&Math.sqrt(qo/oi);Ba=[(Ba[0]+pa[0])/2,(Ba[1]+pa[1])/2],Na=[(Na[0]+Ca[0])/2,(Na[1]+Ca[1])/2],lr(Fs*Kr)}q=null,br(Ba,Na),en(Jn)}function da(){if(d.event.touches.length){for(var Ba=d.event.changedTouches,Na=0,pa=Ba.length;Na<pa;++Na)delete Wn[Ba[Na].identifier];for(var Ca in Wn)return void wi()}d.selectAll(_i).on(di,null),yi.on(Pt,hn).on(Tt,Hn),Ii(),vn(Jn)}Oi(),tn(Jn),yi.on(Pt,null).on(Tt,Oi)}function Kn(){var Kr=Bt.of(this,arguments);F?clearTimeout(F):(qs.call(this),ue=Ht(C=R||d.mouse(this)),tn(Kr)),F=setTimeout(function(){F=null,vn(Kr)},50),X(),lr(Math.pow(2,.002*_e())*Ce.k),br(C,ue),en(Kr)}function hi(){var Kr=d.mouse(this),Ln=Math.log(Ce.k)/Math.LN2;zr(this,Kr,Ht(Kr),d.event.shiftKey?Math.ceil(Ln)-1:Math.floor(Ln)+1)}return Be||(Be="onwheel"in y?(_e=function(){return-d.event.deltaY*(d.event.deltaMode?120:1)},"wheel"):"onmousewheel"in y?(_e=function(){return d.event.wheelDelta},"mousewheel"):(_e=function(){return-d.event.detail},"MozMousePixelScroll")),zt.event=function(Kr){Kr.each(function(){var Ln=Bt.of(this,arguments),Jn=Ce;Ls?d.select(this).transition().each("start.zoom",function(){Ce=this.__chart__||{x:0,y:0,k:1},tn(Ln)}).tween("zoom:zoom",function(){var Wn=qe[0],oi=qe[1],di=C?C[0]:Wn/2,Li=C?C[1]:oi/2,ri=d.interpolateZoom([(di-Ce.x)/Ce.k,(Li-Ce.y)/Ce.k,Wn/Ce.k],[(di-Jn.x)/Jn.k,(Li-Jn.y)/Jn.k,Wn/Jn.k]);return function(_i){var yi=ri(_i),Ii=Wn/yi[2];this.__chart__=Ce={x:di-yi[0]*Ii,y:Li-yi[1]*Ii,k:Ii},en(Ln)}}).each("interrupt.zoom",function(){vn(Ln)}).each("end.zoom",function(){vn(Ln)}):(this.__chart__=Ce,tn(Ln),en(Ln),vn(Ln))})},zt.translate=function(Kr){return arguments.length?(Ce={x:+Kr[0],y:+Kr[1],k:Ce.k},Or(),zt):[Ce.x,Ce.y]},zt.scale=function(Kr){return arguments.length?(Ce={x:Ce.x,y:Ce.y,k:null},lr(+Kr),Or(),zt):Ce.k},zt.scaleExtent=function(Kr){return arguments.length?(et=Kr==null?He:[+Kr[0],+Kr[1]],zt):et},zt.center=function(Kr){return arguments.length?(R=Kr&&[+Kr[0],+Kr[1]],zt):R},zt.size=function(Kr){return arguments.length?(qe=Kr&&[+Kr[0],+Kr[1]],zt):qe},zt.duration=function(Kr){return arguments.length?(st=+Kr,zt):st},zt.x=function(Kr){return arguments.length?(he=Kr,ae=Kr.copy(),Ce={x:0,y:0,k:1},zt):he},zt.y=function(Kr){return arguments.length?(Ae=Kr,be=Kr.copy(),Ce={x:0,y:0,k:1},zt):Ae},d.rebind(zt,Bt,"on")};var _e,Be,He=[0,1/0];function Je(){}function Ze(ue,C,R){return this instanceof Ze?(this.h=+ue,this.s=+C,void(this.l=+R)):arguments.length<2?ue instanceof Ze?new Ze(ue.h,ue.s,ue.l):Cr(""+ue,mr,Ze):new Ze(ue,C,R)}d.color=Je,Je.prototype.toString=function(){return this.rgb()+""},d.hsl=Ze;var ct=Ze.prototype=new Je;function lt(ue,C,R){var F,q;function ae(he){return Math.round(255*function(be){return be>360?be-=360:be<0&&(be+=360),be<60?F+(q-F)*be/60:be<180?q:be<240?F+(q-F)*(240-be)/60:F}(he))}return ue=isNaN(ue)?0:(ue%=360)<0?ue+360:ue,C=isNaN(C)||C<0?0:C>1?1:C,F=2*(R=R<0?0:R>1?1:R)-(q=R<=.5?R*(1+C):R+C-R*C),new St(ae(ue+120),ae(ue),ae(ue-120))}function At(ue,C,R){return this instanceof At?(this.h=+ue,this.c=+C,void(this.l=+R)):arguments.length<2?ue instanceof At?new At(ue.h,ue.c,ue.l):Le(ue instanceof ht?ue.l:(ue=tr((ue=d.rgb(ue)).r,ue.g,ue.b)).l,ue.a,ue.b):new At(ue,C,R)}ct.brighter=function(ue){return ue=Math.pow(.7,arguments.length?ue:1),new Ze(this.h,this.s,this.l/ue)},ct.darker=function(ue){return ue=Math.pow(.7,arguments.length?ue:1),new Ze(this.h,this.s,ue*this.l)},ct.rgb=function(){return lt(this.h,this.s,this.l)},d.hcl=At;var Ot=At.prototype=new Je;function it(ue,C,R){return isNaN(ue)&&(ue=0),isNaN(C)&&(C=0),new ht(R,Math.cos(ue*=cr)*C,Math.sin(ue)*C)}function ht(ue,C,R){return this instanceof ht?(this.l=+ue,this.a=+C,void(this.b=+R)):arguments.length<2?ue instanceof ht?new ht(ue.l,ue.a,ue.b):ue instanceof At?it(ue.h,ue.c,ue.l):tr((ue=St(ue)).r,ue.g,ue.b):new ht(ue,C,R)}Ot.brighter=function(ue){return new At(this.h,this.c,Math.min(100,this.l+Ut*(arguments.length?ue:1)))},Ot.darker=function(ue){return new At(this.h,this.c,Math.max(0,this.l-Ut*(arguments.length?ue:1)))},Ot.rgb=function(){return it(this.h,this.c,this.l).rgb()},d.lab=ht;var Ut=18,Mt=ht.prototype=new Je;function It(ue,C,R){var F=(ue+16)/116,q=F+C/500,ae=F-R/200;return new St(pt(3.2404542*(q=.95047*Xe(q))-1.5371385*(F=1*Xe(F))-.4985314*(ae=1.08883*Xe(ae))),pt(-.969266*q+1.8760108*F+.041556*ae),pt(.0556434*q-.2040259*F+1.0572252*ae))}function Le(ue,C,R){return ue>0?new At(Math.atan2(R,C)*Dt,Math.sqrt(C*C+R*R),ue):new At(NaN,NaN,ue)}function Xe(ue){return ue>.206893034?ue*ue*ue:(ue-4/29)/7.787037}function ot(ue){return ue>.008856?Math.pow(ue,1/3):7.787037*ue+4/29}function pt(ue){return Math.round(255*(ue<=.00304?12.92*ue:1.055*Math.pow(ue,1/2.4)-.055))}function St(ue,C,R){return this instanceof St?(this.r=~~ue,this.g=~~C,void(this.b=~~R)):arguments.length<2?ue instanceof St?new St(ue.r,ue.g,ue.b):Cr(""+ue,St,lt):new St(ue,C,R)}function Vt(ue){return new St(ue>>16,ue>>8&255,255&ue)}function Jt(ue){return Vt(ue)+""}Mt.brighter=function(ue){return new ht(Math.min(100,this.l+Ut*(arguments.length?ue:1)),this.a,this.b)},Mt.darker=function(ue){return new ht(Math.max(0,this.l-Ut*(arguments.length?ue:1)),this.a,this.b)},Mt.rgb=function(){return It(this.l,this.a,this.b)},d.rgb=St;var qt=St.prototype=new Je;function gr(ue){return ue<16?"0"+Math.max(0,ue).toString(16):Math.min(255,ue).toString(16)}function Cr(ue,C,R){var F,q,ae,he=0,be=0,Ae=0;if(F=/([a-z]+)\((.*)\)/.exec(ue=ue.toLowerCase()))switch(q=F[2].split(","),F[1]){case"hsl":return R(parseFloat(q[0]),parseFloat(q[1])/100,parseFloat(q[2])/100);case"rgb":return C(Qt(q[0]),Qt(q[1]),Qt(q[2]))}return(ae=dr.get(ue))?C(ae.r,ae.g,ae.b):(ue==null||ue.charAt(0)!=="#"||isNaN(ae=parseInt(ue.slice(1),16))||(ue.length===4?(he=(3840&ae)>>4,he|=he>>4,be=240&ae,be|=be>>4,Ae=15&ae,Ae|=Ae<<4):ue.length===7&&(he=(16711680&ae)>>16,be=(65280&ae)>>8,Ae=255&ae)),C(he,be,Ae))}function mr(ue,C,R){var F,q,ae=Math.min(ue/=255,C/=255,R/=255),he=Math.max(ue,C,R),be=he-ae,Ae=(he+ae)/2;return be?(q=Ae<.5?be/(he+ae):be/(2-he-ae),F=ue==he?(C-R)/be+(C<R?6:0):C==he?(R-ue)/be+2:(ue-C)/be+4,F*=60):(F=NaN,q=Ae>0&&Ae<1?0:F),new Ze(F,q,Ae)}function tr(ue,C,R){var F=ot((.4124564*(ue=nr(ue))+.3575761*(C=nr(C))+.1804375*(R=nr(R)))/.95047),q=ot((.2126729*ue+.7151522*C+.072175*R)/1);return ht(116*q-16,500*(F-q),200*(q-ot((.0193339*ue+.119192*C+.9503041*R)/1.08883)))}function nr(ue){return(ue/=255)<=.04045?ue/12.92:Math.pow((ue+.055)/1.055,2.4)}function Qt(ue){var C=parseFloat(ue);return ue.charAt(ue.length-1)==="%"?Math.round(2.55*C):C}qt.brighter=function(ue){ue=Math.pow(.7,arguments.length?ue:1);var C=this.r,R=this.g,F=this.b,q=30;return C||R||F?(C&&C<q&&(C=q),R&&R<q&&(R=q),F&&F<q&&(F=q),new St(Math.min(255,C/ue),Math.min(255,R/ue),Math.min(255,F/ue))):new St(q,q,q)},qt.darker=function(ue){return new St((ue=Math.pow(.7,arguments.length?ue:1))*this.r,ue*this.g,ue*this.b)},qt.hsl=function(){return mr(this.r,this.g,this.b)},qt.toString=function(){return"#"+gr(this.r)+gr(this.g)+gr(this.b)};var dr=d.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function _r(ue){return typeof ue=="function"?ue:function(){return ue}}function Ir(ue){return function(C,R,F){return arguments.length===2&&typeof R=="function"&&(F=R,R=null),Rr(C,R,ue,F)}}function Rr(ue,C,R,F){var q={},ae=d.dispatch("beforesend","progress","load","error"),he={},be=new XMLHttpRequest,Ae=null;function Ce(){var qe,et=be.status;if(!et&&function(st){var kt=st.responseType;return kt&&kt!=="text"?st.response:st.responseText}(be)||et>=200&&et<300||et===304){try{qe=R.call(q,be)}catch(st){return void ae.error.call(q,st)}ae.load.call(q,qe)}else ae.error.call(q,be)}return self.XDomainRequest&&!("withCredentials"in be)&&/^(http(s)?:)?\/\//.test(ue)&&(be=new XDomainRequest),"onload"in be?be.onload=be.onerror=Ce:be.onreadystatechange=function(){be.readyState>3&&Ce()},be.onprogress=function(qe){var et=d.event;d.event=qe;try{ae.progress.call(q,be)}finally{d.event=et}},q.header=function(qe,et){return qe=(qe+"").toLowerCase(),arguments.length<2?he[qe]:(et==null?delete he[qe]:he[qe]=et+"",q)},q.mimeType=function(qe){return arguments.length?(C=qe==null?null:qe+"",q):C},q.responseType=function(qe){return arguments.length?(Ae=qe,q):Ae},q.response=function(qe){return R=qe,q},["get","post"].forEach(function(qe){q[qe]=function(){return q.send.apply(q,[qe].concat(w(arguments)))}}),q.send=function(qe,et,st){if(arguments.length===2&&typeof et=="function"&&(st=et,et=null),be.open(qe,ue,!0),C==null||"accept"in he||(he.accept=C+",*/*"),be.setRequestHeader)for(var kt in he)be.setRequestHeader(kt,he[kt]);return C!=null&&be.overrideMimeType&&be.overrideMimeType(C),Ae!=null&&(be.responseType=Ae),st!=null&&q.on("error",st).on("load",function(Pt){st(null,Pt)}),ae.beforesend.call(q,be),be.send(et==null?null:et),q},q.abort=function(){return be.abort(),q},d.rebind(q,ae,"on"),F==null?q:q.get(function(qe){return qe.length===1?function(et,st){qe(et==null?st:null)}:qe}(F))}dr.forEach(function(ue,C){dr.set(ue,Vt(C))}),d.functor=_r,d.xhr=Ir(E),d.dsv=function(ue,C){var R=new RegExp('["'+ue+`
]`),F=ue.charCodeAt(0);function q(Ce,qe,et){arguments.length<3&&(et=qe,qe=null);var st=Rr(Ce,C,qe==null?ae:he(qe),et);return st.row=function(kt){return arguments.length?st.response((qe=kt)==null?ae:he(kt)):qe},st}function ae(Ce){return q.parse(Ce.responseText)}function he(Ce){return function(qe){return q.parse(qe.responseText,Ce)}}function be(Ce){return Ce.map(Ae).join(ue)}function Ae(Ce){return R.test(Ce)?'"'+Ce.replace(/\"/g,'""')+'"':Ce}return q.parse=function(Ce,qe){var et;return q.parseRows(Ce,function(st,kt){if(et)return et(st,kt-1);var Pt=function(Et){for(var Lt={},Tt=st.length,Bt=0;Bt<Tt;++Bt)Lt[st[Bt]]=Et[Bt];return Lt};et=qe?function(Et,Lt){return qe(Pt(Et),Lt)}:Pt})},q.parseRows=function(Ce,qe){var et,st,kt={},Pt={},Et=[],Lt=Ce.length,Tt=0,Bt=0;function zt(){if(Tt>=Lt)return Pt;if(st)return st=!1,kt;var lr=Tt;if(Ce.charCodeAt(lr)===34){for(var br=lr;br++<Lt;)if(Ce.charCodeAt(br)===34){if(Ce.charCodeAt(br+1)!==34)break;++br}return Tt=br+2,(zr=Ce.charCodeAt(br+1))===13?(st=!0,Ce.charCodeAt(br+2)===10&&++Tt):zr===10&&(st=!0),Ce.slice(lr+1,br).replace(/""/g,'"')}for(;Tt<Lt;){var zr,Or=1;if((zr=Ce.charCodeAt(Tt++))===10)st=!0;else if(zr===13)st=!0,Ce.charCodeAt(Tt)===10&&(++Tt,++Or);else if(zr!==F)continue;return Ce.slice(lr,Tt-Or)}return Ce.slice(lr)}for(;(et=zt())!==Pt;){for(var Ht=[];et!==kt&&et!==Pt;)Ht.push(et),et=zt();qe&&(Ht=qe(Ht,Bt++))==null||Et.push(Ht)}return Et},q.format=function(Ce){if(Array.isArray(Ce[0]))return q.formatRows(Ce);var qe=new S,et=[];return Ce.forEach(function(st){for(var kt in st)qe.has(kt)||et.push(qe.add(kt))}),[et.map(Ae).join(ue)].concat(Ce.map(function(st){return et.map(function(kt){return Ae(st[kt])}).join(ue)})).join(`
`)},q.formatRows=function(Ce){return Ce.map(be).join(`
`)},q},d.csv=d.dsv(",","text/csv"),d.tsv=d.dsv("	","text/tab-separated-values");var Vr,Xr,cn,an,zn=this[D(this,"requestAnimationFrame")]||function(ue){setTimeout(ue,17)};function on(ue,C,R){var F=arguments.length;F<2&&(C=0),F<3&&(R=Date.now());var q=R+C,ae={c:ue,t:q,n:null};return Xr?Xr.n=ae:Vr=ae,Xr=ae,cn||(an=clearTimeout(an),cn=1,zn(Tn)),ae}function Tn(){var ue=Mn(),C=ei()-ue;C>24?(isFinite(C)&&(clearTimeout(an),an=setTimeout(Tn,C)),cn=0):(cn=1,zn(Tn))}function Mn(){for(var ue=Date.now(),C=Vr;C;)ue>=C.t&&C.c(ue-C.t)&&(C.c=null),C=C.n;return ue}function ei(){for(var ue,C=Vr,R=1/0;C;)C.c?(C.t<R&&(R=C.t),C=(ue=C).n):C=ue?ue.n=C.n:Vr=C.n;return Xr=ue,R}function Hr(ue){return ue[0]}function ln(ue){return ue[1]}function bn(ue){for(var C,R,F,q=ue.length,ae=[0,1],he=2,be=2;be<q;be++){for(;he>1&&(C=ue[ae[he-2]],R=ue[ae[he-1]],F=ue[be],(R[0]-C[0])*(F[1]-C[1])-(R[1]-C[1])*(F[0]-C[0])<=0);)--he;ae[he++]=be}return ae.slice(0,he)}function nn(ue,C){return ue[0]-C[0]||ue[1]-C[1]}d.timer=function(){on.apply(this,arguments)},d.timer.flush=function(){Mn(),ei()},d.round=function(ue,C){return C?Math.round(ue*(C=Math.pow(10,C)))/C:Math.round(ue)},d.geom={},d.geom.hull=function(ue){var C=Hr,R=ln;if(arguments.length)return F(ue);function F(q){if(q.length<3)return[];var ae,he=_r(C),be=_r(R),Ae=q.length,Ce=[],qe=[];for(ae=0;ae<Ae;ae++)Ce.push([+he.call(this,q[ae],ae),+be.call(this,q[ae],ae),ae]);for(Ce.sort(nn),ae=0;ae<Ae;ae++)qe.push([Ce[ae][0],-Ce[ae][1]]);var et=bn(Ce),st=bn(qe),kt=st[0]===et[0],Pt=st[st.length-1]===et[et.length-1],Et=[];for(ae=et.length-1;ae>=0;--ae)Et.push(q[Ce[et[ae]][2]]);for(ae=+kt;ae<st.length-Pt;++ae)Et.push(q[Ce[st[ae]][2]]);return Et}return F.x=function(q){return arguments.length?(C=q,F):C},F.y=function(q){return arguments.length?(R=q,F):R},F},d.geom.polygon=function(ue){return N(ue,pn),ue};var pn=d.geom.polygon.prototype=[];function qn(ue,C,R){return(R[0]-C[0])*(ue[1]-C[1])<(R[1]-C[1])*(ue[0]-C[0])}function sr(ue,C,R,F){var q=ue[0],ae=R[0],he=C[0]-q,be=F[0]-ae,Ae=ue[1],Ce=R[1],qe=C[1]-Ae,et=F[1]-Ce,st=(be*(Ae-Ce)-et*(q-ae))/(et*he-be*qe);return[q+st*he,Ae+st*qe]}function xr(ue){var C=ue[0],R=ue[ue.length-1];return!(C[0]-R[0]||C[1]-R[1])}pn.area=function(){for(var ue,C=-1,R=this.length,F=this[R-1],q=0;++C<R;)ue=F,F=this[C],q+=ue[1]*F[0]-ue[0]*F[1];return .5*q},pn.centroid=function(ue){var C,R,F=-1,q=this.length,ae=0,he=0,be=this[q-1];for(arguments.length||(ue=-1/(6*this.area()));++F<q;)C=be,be=this[F],R=C[0]*be[1]-be[0]*C[1],ae+=(C[0]+be[0])*R,he+=(C[1]+be[1])*R;return[ae*ue,he*ue]},pn.clip=function(ue){for(var C,R,F,q,ae,he,be=xr(ue),Ae=-1,Ce=this.length-xr(this),qe=this[Ce-1];++Ae<Ce;){for(C=ue.slice(),ue.length=0,q=this[Ae],ae=C[(F=C.length-be)-1],R=-1;++R<F;)qn(he=C[R],qe,q)?(qn(ae,qe,q)||ue.push(sr(ae,he,qe,q)),ue.push(he)):qn(ae,qe,q)&&ue.push(sr(ae,he,qe,q)),ae=he;be&&ue.push(ue[0]),qe=q}return ue};var jr,Rt,or,wt,ir,ar=[],Dr=[];function Pr(){Cn(this),this.edge=this.site=this.circle=null}function Er(ue){var C=ar.pop()||new Pr;return C.site=ue,C}function Ar(ue){yn(ue),or.remove(ue),ar.push(ue),Cn(ue)}function vr(ue){var C=ue.circle,R=C.x,F=C.cy,q={x:R,y:F},ae=ue.P,he=ue.N,be=[ue];Ar(ue);for(var Ae=ae;Ae.circle&&i(R-Ae.circle.x)<vt&&i(F-Ae.circle.cy)<vt;)ae=Ae.P,be.unshift(Ae),Ar(Ae),Ae=ae;be.unshift(Ae),yn(Ae);for(var Ce=he;Ce.circle&&i(R-Ce.circle.x)<vt&&i(F-Ce.circle.cy)<vt;)he=Ce.N,be.push(Ce),Ar(Ce),Ce=he;be.push(Ce),yn(Ce);var qe,et=be.length;for(qe=1;qe<et;++qe)Ce=be[qe],Ae=be[qe-1],Xn(Ce.edge,Ae.site,Ce.site,q);Ae=be[0],(Ce=be[et-1]).edge=Pn(Ae.site,Ce.site,null,q),sn(Ae),sn(Ce)}function wr(ue){for(var C,R,F,q,ae=ue.x,he=ue.y,be=or._;be;)if((F=Mr(be,he)-ae)>vt)be=be.L;else{if(!((q=ae-Lr(be,he))>vt)){F>-vt?(C=be.P,R=be):q>-vt?(C=be,R=be.N):C=R=be;break}if(!be.R){C=be;break}be=be.R}var Ae=Er(ue);if(or.insert(C,Ae),C||R){if(C===R)return yn(C),R=Er(C.site),or.insert(Ae,R),Ae.edge=R.edge=Pn(C.site,Ae.site),sn(C),void sn(R);if(R){yn(C),yn(R);var Ce=C.site,qe=Ce.x,et=Ce.y,st=ue.x-qe,kt=ue.y-et,Pt=R.site,Et=Pt.x-qe,Lt=Pt.y-et,Tt=2*(st*Lt-kt*Et),Bt=st*st+kt*kt,zt=Et*Et+Lt*Lt,Ht={x:(Lt*Bt-kt*zt)/Tt+qe,y:(st*zt-Et*Bt)/Tt+et};Xn(R.edge,Ce,Pt,Ht),Ae.edge=Pn(Ce,ue,null,Ht),R.edge=Pn(ue,Pt,null,Ht),sn(C),sn(R)}else Ae.edge=Pn(C.site,Ae.site)}}function Mr(ue,C){var R=ue.site,F=R.x,q=R.y,ae=q-C;if(!ae)return F;var he=ue.P;if(!he)return-1/0;var be=(R=he.site).x,Ae=R.y,Ce=Ae-C;if(!Ce)return be;var qe=be-F,et=1/ae-1/Ce,st=qe/Ce;return et?(-st+Math.sqrt(st*st-2*et*(qe*qe/(-2*Ce)-Ae+Ce/2+q-ae/2)))/et+F:(F+be)/2}function Lr(ue,C){var R=ue.N;if(R)return Mr(R,C);var F=ue.site;return F.y===C?F.x:1/0}function Zr(ue){this.site=ue,this.edges=[]}function Yr(ue,C){return C.angle-ue.angle}function rn(){Cn(this),this.x=this.y=this.arc=this.site=this.cy=null}function sn(ue){var C=ue.P,R=ue.N;if(C&&R){var F=C.site,q=ue.site,ae=R.site;if(F!==ae){var he=q.x,be=q.y,Ae=F.x-he,Ce=F.y-be,qe=ae.x-he,et=2*(Ae*(Lt=ae.y-be)-Ce*qe);if(!(et>=-1e-12)){var st=Ae*Ae+Ce*Ce,kt=qe*qe+Lt*Lt,Pt=(Lt*st-Ce*kt)/et,Et=(Ae*kt-qe*st)/et,Lt=Et+be,Tt=Dr.pop()||new rn;Tt.arc=ue,Tt.site=q,Tt.x=Pt+he,Tt.y=Lt+Math.sqrt(Pt*Pt+Et*Et),Tt.cy=Lt,ue.circle=Tt;for(var Bt=null,zt=ir._;zt;)if(Tt.y<zt.y||Tt.y===zt.y&&Tt.x<=zt.x){if(!zt.L){Bt=zt.P;break}zt=zt.L}else{if(!zt.R){Bt=zt;break}zt=zt.R}ir.insert(Bt,Tt),Bt||(wt=Tt)}}}}function yn(ue){var C=ue.circle;C&&(C.P||(wt=C.N),ir.remove(C),Dr.push(C),Cn(C),ue.circle=null)}function kn(ue,C){var R=ue.b;if(R)return!0;var F,q,ae=ue.a,he=C[0][0],be=C[1][0],Ae=C[0][1],Ce=C[1][1],qe=ue.l,et=ue.r,st=qe.x,kt=qe.y,Pt=et.x,Et=et.y,Lt=(st+Pt)/2,Tt=(kt+Et)/2;if(Et===kt){if(Lt<he||Lt>=be)return;if(st>Pt){if(ae){if(ae.y>=Ce)return}else ae={x:Lt,y:Ae};R={x:Lt,y:Ce}}else{if(ae){if(ae.y<Ae)return}else ae={x:Lt,y:Ce};R={x:Lt,y:Ae}}}else if(q=Tt-(F=(st-Pt)/(Et-kt))*Lt,F<-1||F>1)if(st>Pt){if(ae){if(ae.y>=Ce)return}else ae={x:(Ae-q)/F,y:Ae};R={x:(Ce-q)/F,y:Ce}}else{if(ae){if(ae.y<Ae)return}else ae={x:(Ce-q)/F,y:Ce};R={x:(Ae-q)/F,y:Ae}}else if(kt<Et){if(ae){if(ae.x>=be)return}else ae={x:he,y:F*he+q};R={x:be,y:F*be+q}}else{if(ae){if(ae.x<he)return}else ae={x:be,y:F*be+q};R={x:he,y:F*he+q}}return ue.a=ae,ue.b=R,!0}function wn(ue,C){this.l=ue,this.r=C,this.a=this.b=null}function Pn(ue,C,R,F){var q=new wn(ue,C);return jr.push(q),R&&Xn(q,ue,C,R),F&&Xn(q,C,ue,F),Rt[ue.i].edges.push(new Ai(q,ue,C)),Rt[C.i].edges.push(new Ai(q,C,ue)),q}function Rn(ue,C,R){var F=new wn(ue,null);return F.a=C,F.b=R,jr.push(F),F}function Xn(ue,C,R,F){ue.a||ue.b?ue.l===R?ue.b=F:ue.a=F:(ue.a=F,ue.l=C,ue.r=R)}function Ai(ue,C,R){var F=ue.a,q=ue.b;this.edge=ue,this.site=C,this.angle=R?Math.atan2(R.y-C.y,R.x-C.x):ue.l===C?Math.atan2(q.x-F.x,F.y-q.y):Math.atan2(F.x-q.x,q.y-F.y)}function Mi(){this._=null}function Cn(ue){ue.U=ue.C=ue.L=ue.R=ue.P=ue.N=null}function ti(ue,C){var R=C,F=C.R,q=R.U;q?q.L===R?q.L=F:q.R=F:ue._=F,F.U=q,R.U=F,R.R=F.L,R.R&&(R.R.U=R),F.L=R}function $n(ue,C){var R=C,F=C.L,q=R.U;q?q.L===R?q.L=F:q.R=F:ue._=F,F.U=q,R.U=F,R.L=F.R,R.L&&(R.L.U=R),F.R=R}function Di(ue){for(;ue.L;)ue=ue.L;return ue}function va(ue,C){var R,F,q,ae=ue.sort(ja).pop();for(jr=[],Rt=new Array(ue.length),or=new Mi,ir=new Mi;;)if(q=wt,ae&&(!q||ae.y<q.y||ae.y===q.y&&ae.x<q.x))ae.x===R&&ae.y===F||(Rt[ae.i]=new Zr(ae),wr(ae),R=ae.x,F=ae.y),ae=ue.pop();else{if(!q)break;vr(q.arc)}C&&(function(be){for(var Ae,Ce,qe,et,st,kt=jr,Pt=(Ce=be[0][0],qe=be[0][1],et=be[1][0],st=be[1][1],function(Lt){var Tt,Bt=Lt.a,zt=Lt.b,Ht=Bt.x,lr=Bt.y,br=0,zr=1,Or=zt.x-Ht,tn=zt.y-lr;if(Tt=Ce-Ht,Or||!(Tt>0)){if(Tt/=Or,Or<0){if(Tt<br)return;Tt<zr&&(zr=Tt)}else if(Or>0){if(Tt>zr)return;Tt>br&&(br=Tt)}if(Tt=et-Ht,Or||!(Tt<0)){if(Tt/=Or,Or<0){if(Tt>zr)return;Tt>br&&(br=Tt)}else if(Or>0){if(Tt<br)return;Tt<zr&&(zr=Tt)}if(Tt=qe-lr,tn||!(Tt>0)){if(Tt/=tn,tn<0){if(Tt<br)return;Tt<zr&&(zr=Tt)}else if(tn>0){if(Tt>zr)return;Tt>br&&(br=Tt)}if(Tt=st-lr,tn||!(Tt<0)){if(Tt/=tn,tn<0){if(Tt>zr)return;Tt>br&&(br=Tt)}else if(tn>0){if(Tt<br)return;Tt<zr&&(zr=Tt)}return br>0&&(Lt.a={x:Ht+br*Or,y:lr+br*tn}),zr<1&&(Lt.b={x:Ht+zr*Or,y:lr+zr*tn}),Lt}}}}}),Et=kt.length;Et--;)(!kn(Ae=kt[Et],be)||!Pt(Ae)||i(Ae.a.x-Ae.b.x)<vt&&i(Ae.a.y-Ae.b.y)<vt)&&(Ae.a=Ae.b=null,kt.splice(Et,1))}(C),function(be){for(var Ae,Ce,qe,et,st,kt,Pt,Et,Lt,Tt,Bt=be[0][0],zt=be[1][0],Ht=be[0][1],lr=be[1][1],br=Rt,zr=br.length;zr--;)if((st=br[zr])&&st.prepare())for(Et=(Pt=st.edges).length,kt=0;kt<Et;)qe=(Tt=Pt[kt].end()).x,et=Tt.y,Ae=(Lt=Pt[++kt%Et].start()).x,Ce=Lt.y,(i(qe-Ae)>vt||i(et-Ce)>vt)&&(Pt.splice(kt,0,new Ai(Rn(st.site,Tt,i(qe-Bt)<vt&&lr-et>vt?{x:Bt,y:i(Ae-Bt)<vt?Ce:lr}:i(et-lr)<vt&&zt-qe>vt?{x:i(Ce-lr)<vt?Ae:zt,y:lr}:i(qe-zt)<vt&&et-Ht>vt?{x:zt,y:i(Ae-zt)<vt?Ce:Ht}:i(et-Ht)<vt&&qe-Bt>vt?{x:i(Ce-Ht)<vt?Ae:Bt,y:Ht}:null),st.site,null)),++Et)}(C));var he={cells:Rt,edges:jr};return or=ir=jr=Rt=null,he}function ja(ue,C){return C.y-ue.y||C.x-ue.x}Zr.prototype.prepare=function(){for(var ue,C=this.edges,R=C.length;R--;)(ue=C[R].edge).b&&ue.a||C.splice(R,1);return C.sort(Yr),C.length},Ai.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Mi.prototype={insert:function(ue,C){var R,F,q;if(ue){if(C.P=ue,C.N=ue.N,ue.N&&(ue.N.P=C),ue.N=C,ue.R){for(ue=ue.R;ue.L;)ue=ue.L;ue.L=C}else ue.R=C;R=ue}else this._?(ue=Di(this._),C.P=null,C.N=ue,ue.P=ue.L=C,R=ue):(C.P=C.N=null,this._=C,R=null);for(C.L=C.R=null,C.U=R,C.C=!0,ue=C;R&&R.C;)R===(F=R.U).L?(q=F.R)&&q.C?(R.C=q.C=!1,F.C=!0,ue=F):(ue===R.R&&(ti(this,R),R=(ue=R).U),R.C=!1,F.C=!0,$n(this,F)):(q=F.L)&&q.C?(R.C=q.C=!1,F.C=!0,ue=F):(ue===R.L&&($n(this,R),R=(ue=R).U),R.C=!1,F.C=!0,ti(this,F)),R=ue.U;this._.C=!1},remove:function(ue){ue.N&&(ue.N.P=ue.P),ue.P&&(ue.P.N=ue.N),ue.N=ue.P=null;var C,R,F,q=ue.U,ae=ue.L,he=ue.R;if(R=ae?he?Di(he):ae:he,q?q.L===ue?q.L=R:q.R=R:this._=R,ae&&he?(F=R.C,R.C=ue.C,R.L=ae,ae.U=R,R!==he?(q=R.U,R.U=ue.U,ue=R.R,q.L=ue,R.R=he,he.U=R):(R.U=q,q=R,ue=R.R)):(F=ue.C,ue=R),ue&&(ue.U=q),!F)if(ue&&ue.C)ue.C=!1;else{do{if(ue===this._)break;if(ue===q.L){if((C=q.R).C&&(C.C=!1,q.C=!0,ti(this,q),C=q.R),C.L&&C.L.C||C.R&&C.R.C){C.R&&C.R.C||(C.L.C=!1,C.C=!0,$n(this,C),C=q.R),C.C=q.C,q.C=C.R.C=!1,ti(this,q),ue=this._;break}}else if((C=q.L).C&&(C.C=!1,q.C=!0,$n(this,q),C=q.L),C.L&&C.L.C||C.R&&C.R.C){C.L&&C.L.C||(C.R.C=!1,C.C=!0,ti(this,C),C=q.L),C.C=q.C,q.C=C.L.C=!1,$n(this,q),ue=this._;break}C.C=!0,ue=q,q=q.U}while(!ue.C);ue&&(ue.C=!1)}}},d.geom.voronoi=function(ue){var C=Hr,R=ln,F=C,q=R,ae=vo;if(ue)return he(ue);function he(Ae){var Ce=new Array(Ae.length),qe=ae[0][0],et=ae[0][1],st=ae[1][0],kt=ae[1][1];return va(be(Ae),ae).cells.forEach(function(Pt,Et){var Lt=Pt.edges,Tt=Pt.site;(Ce[Et]=Lt.length?Lt.map(function(Bt){var zt=Bt.start();return[zt.x,zt.y]}):Tt.x>=qe&&Tt.x<=st&&Tt.y>=et&&Tt.y<=kt?[[qe,kt],[st,kt],[st,et],[qe,et]]:[]).point=Ae[Et]}),Ce}function be(Ae){return Ae.map(function(Ce,qe){return{x:Math.round(F(Ce,qe)/vt)*vt,y:Math.round(q(Ce,qe)/vt)*vt,i:qe}})}return he.links=function(Ae){return va(be(Ae)).edges.filter(function(Ce){return Ce.l&&Ce.r}).map(function(Ce){return{source:Ae[Ce.l.i],target:Ae[Ce.r.i]}})},he.triangles=function(Ae){var Ce=[];return va(be(Ae)).cells.forEach(function(qe,et){for(var st,kt,Pt,Et,Lt=qe.site,Tt=qe.edges.sort(Yr),Bt=-1,zt=Tt.length,Ht=Tt[zt-1].edge,lr=Ht.l===Lt?Ht.r:Ht.l;++Bt<zt;)st=lr,lr=(Ht=Tt[Bt].edge).l===Lt?Ht.r:Ht.l,et<st.i&&et<lr.i&&(Pt=st,Et=lr,((kt=Lt).x-Et.x)*(Pt.y-kt.y)-(kt.x-Pt.x)*(Et.y-kt.y)<0)&&Ce.push([Ae[et],Ae[st.i],Ae[lr.i]])}),Ce},he.x=function(Ae){return arguments.length?(F=_r(C=Ae),he):C},he.y=function(Ae){return arguments.length?(q=_r(R=Ae),he):R},he.clipExtent=function(Ae){return arguments.length?(ae=Ae==null?vo:Ae,he):ae===vo?null:ae},he.size=function(Ae){return arguments.length?he.clipExtent(Ae&&[[0,0],Ae]):ae===vo?null:ae&&ae[1]},he};var vo=[[-1e6,-1e6],[1e6,1e6]];function Wi(ue){return ue.x}function Zi(ue){return ue.y}function no(ue,C,R,F,q,ae){if(!ue(C,R,F,q,ae)){var he=.5*(R+q),be=.5*(F+ae),Ae=C.nodes;Ae[0]&&no(ue,Ae[0],R,F,he,be),Ae[1]&&no(ue,Ae[1],he,F,q,be),Ae[2]&&no(ue,Ae[2],R,be,he,ae),Ae[3]&&no(ue,Ae[3],he,be,q,ae)}}function Ni(ue,C,R,F,q,ae,he){var be,Ae=1/0;return function Ce(qe,et,st,kt,Pt){if(!(et>ae||st>he||kt<F||Pt<q)){if(Et=qe.point){var Et,Lt=C-qe.x,Tt=R-qe.y,Bt=Lt*Lt+Tt*Tt;if(Bt<Ae){var zt=Math.sqrt(Ae=Bt);F=C-zt,q=R-zt,ae=C+zt,he=R+zt,be=Et}}for(var Ht=qe.nodes,lr=.5*(et+kt),br=.5*(st+Pt),zr=(R>=br)<<1|C>=lr,Or=zr+4;zr<Or;++zr)if(qe=Ht[3&zr])switch(3&zr){case 0:Ce(qe,et,st,lr,br);break;case 1:Ce(qe,lr,st,kt,br);break;case 2:Ce(qe,et,br,lr,Pt);break;case 3:Ce(qe,lr,br,kt,Pt)}}}(ue,F,q,ae,he),be}function yo(ue,C){ue=d.rgb(ue),C=d.rgb(C);var R=ue.r,F=ue.g,q=ue.b,ae=C.r-R,he=C.g-F,be=C.b-q;return function(Ae){return"#"+gr(Math.round(R+ae*Ae))+gr(Math.round(F+he*Ae))+gr(Math.round(q+be*Ae))}}function wo(ue,C){var R,F={},q={};for(R in ue)R in C?F[R]=qa(ue[R],C[R]):q[R]=ue[R];for(R in C)R in ue||(q[R]=C[R]);return function(ae){for(R in F)q[R]=F[R](ae);return q}}function Sa(ue,C){return ue=+ue,C=+C,function(R){return ue*(1-R)+C*R}}function io(ue,C){var R,F,q,ae=To.lastIndex=Io.lastIndex=0,he=-1,be=[],Ae=[];for(ue+="",C+="";(R=To.exec(ue))&&(F=Io.exec(C));)(q=F.index)>ae&&(q=C.slice(ae,q),be[he]?be[he]+=q:be[++he]=q),(R=R[0])===(F=F[0])?be[he]?be[he]+=F:be[++he]=F:(be[++he]=null,Ae.push({i:he,x:Sa(R,F)})),ae=Io.lastIndex;return ae<C.length&&(q=C.slice(ae),be[he]?be[he]+=q:be[++he]=q),be.length<2?Ae[0]?(C=Ae[0].x,function(Ce){return C(Ce)+""}):function(){return C}:(C=Ae.length,function(Ce){for(var qe,et=0;et<C;++et)be[(qe=Ae[et]).i]=qe.x(Ce);return be.join("")})}d.geom.delaunay=function(ue){return d.geom.voronoi().triangles(ue)},d.geom.quadtree=function(ue,C,R,F,q){var ae,he=Hr,be=ln;if(ae=arguments.length)return he=Wi,be=Zi,ae===3&&(q=R,F=C,R=C=0),Ae(ue);function Ae(Ce){var qe,et,st,kt,Pt,Et,Lt,Tt,Bt,zt=_r(he),Ht=_r(be);if(C!=null)Et=C,Lt=R,Tt=F,Bt=q;else if(Tt=Bt=-(Et=Lt=1/0),et=[],st=[],Pt=Ce.length,ae)for(kt=0;kt<Pt;++kt)(qe=Ce[kt]).x<Et&&(Et=qe.x),qe.y<Lt&&(Lt=qe.y),qe.x>Tt&&(Tt=qe.x),qe.y>Bt&&(Bt=qe.y),et.push(qe.x),st.push(qe.y);else for(kt=0;kt<Pt;++kt){var lr=+zt(qe=Ce[kt],kt),br=+Ht(qe,kt);lr<Et&&(Et=lr),br<Lt&&(Lt=br),lr>Tt&&(Tt=lr),br>Bt&&(Bt=br),et.push(lr),st.push(br)}var zr=Tt-Et,Or=Bt-Lt;function tn(hn,Hn,Kn,hi,Kr,Ln,Jn,Wn){if(!isNaN(Kn)&&!isNaN(hi))if(hn.leaf){var oi=hn.x,di=hn.y;if(oi!=null)if(i(oi-Kn)+i(di-hi)<.01)en(hn,Hn,Kn,hi,Kr,Ln,Jn,Wn);else{var Li=hn.point;hn.x=hn.y=hn.point=null,en(hn,Li,oi,di,Kr,Ln,Jn,Wn),en(hn,Hn,Kn,hi,Kr,Ln,Jn,Wn)}else hn.x=Kn,hn.y=hi,hn.point=Hn}else en(hn,Hn,Kn,hi,Kr,Ln,Jn,Wn)}function en(hn,Hn,Kn,hi,Kr,Ln,Jn,Wn){var oi=.5*(Kr+Jn),di=.5*(Ln+Wn),Li=Kn>=oi,ri=hi>=di,_i=ri<<1|Li;hn.leaf=!1,Li?Kr=oi:Jn=oi,ri?Ln=di:Wn=di,tn(hn=hn.nodes[_i]||(hn.nodes[_i]={leaf:!0,nodes:[],point:null,x:null,y:null}),Hn,Kn,hi,Kr,Ln,Jn,Wn)}zr>Or?Bt=Lt+zr:Tt=Et+Or;var vn={leaf:!0,nodes:[],point:null,x:null,y:null,add:function(hn){tn(vn,hn,+zt(hn,++kt),+Ht(hn,kt),Et,Lt,Tt,Bt)},visit:function(hn){no(hn,vn,Et,Lt,Tt,Bt)},find:function(hn){return Ni(vn,hn[0],hn[1],Et,Lt,Tt,Bt)}};if(kt=-1,C==null){for(;++kt<Pt;)tn(vn,Ce[kt],et[kt],st[kt],Et,Lt,Tt,Bt);--kt}else Ce.forEach(vn.add);return et=st=Ce=qe=null,vn}return Ae.x=function(Ce){return arguments.length?(he=Ce,Ae):he},Ae.y=function(Ce){return arguments.length?(be=Ce,Ae):be},Ae.extent=function(Ce){return arguments.length?(Ce==null?C=R=F=q=null:(C=+Ce[0][0],R=+Ce[0][1],F=+Ce[1][0],q=+Ce[1][1]),Ae):C==null?null:[[C,R],[F,q]]},Ae.size=function(Ce){return arguments.length?(Ce==null?C=R=F=q=null:(C=R=0,F=+Ce[0],q=+Ce[1]),Ae):C==null?null:[F-C,q-R]},Ae},d.interpolateRgb=yo,d.interpolateObject=wo,d.interpolateNumber=Sa,d.interpolateString=io;var To=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Io=new RegExp(To.source,"g");function qa(ue,C){for(var R,F=d.interpolators.length;--F>=0&&!(R=d.interpolators[F](ue,C)););return R}function ya(ue,C){var R,F=[],q=[],ae=ue.length,he=C.length,be=Math.min(ue.length,C.length);for(R=0;R<be;++R)F.push(qa(ue[R],C[R]));for(;R<ae;++R)q[R]=ue[R];for(;R<he;++R)q[R]=C[R];return function(Ae){for(R=0;R<be;++R)q[R]=F[R](Ae);return q}}d.interpolate=qa,d.interpolators=[function(ue,C){var R=typeof C;return(R==="string"?dr.has(C.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(C)?yo:io:C instanceof Je?yo:Array.isArray(C)?ya:R==="object"&&isNaN(C)?wo:Sa)(ue,C)}],d.interpolateArray=ya;var to=function(){return E},Ds=d.map({linear:to,poly:function(ue){return function(C){return Math.pow(C,ue)}},quad:function(){return Us},cubic:function(){return Vs},sin:function(){return Hs},exp:function(){return Ro},circle:function(){return Fo},elastic:function(ue,C){var R;return arguments.length<2&&(C=.45),arguments.length?R=C/Gt*Math.asin(1/ue):(ue=1,R=C/4),function(F){return 1+ue*Math.pow(2,-10*F)*Math.sin((F-R)*Gt/C)}},back:function(ue){return ue||(ue=1.70158),function(C){return C*C*((ue+1)*C-ue)}},bounce:function(){return Xo}}),js=d.map({in:E,out:As,"in-out":fs,"out-in":function(ue){return fs(As(ue))}});function Xi(ue){return function(C){return C<=0?0:C>=1?1:ue(C)}}function As(ue){return function(C){return 1-ue(1-C)}}function fs(ue){return function(C){return .5*(C<.5?ue(2*C):2-ue(2-2*C))}}function Us(ue){return ue*ue}function Vs(ue){return ue*ue*ue}function zs(ue){if(ue<=0)return 0;if(ue>=1)return 1;var C=ue*ue,R=C*ue;return 4*(ue<.5?R:3*(ue-C)+R-.75)}function Hs(ue){return 1-Math.cos(ue*Zt)}function Ro(ue){return Math.pow(2,10*(ue-1))}function Fo(ue){return 1-Math.sqrt(1-ue*ue)}function Xo(ue){return ue<1/2.75?7.5625*ue*ue:ue<2/2.75?7.5625*(ue-=1.5/2.75)*ue+.75:ue<2.5/2.75?7.5625*(ue-=2.25/2.75)*ue+.9375:7.5625*(ue-=2.625/2.75)*ue+.984375}function Ko(ue,C){return C-=ue,function(R){return Math.round(ue+C*R)}}function Jo(ue){var C,R,F,q=[ue.a,ue.b],ae=[ue.c,ue.d],he=ko(q),be=hs(q,ae),Ae=ko(((C=ae)[0]+=(F=-be)*(R=q)[0],C[1]+=F*R[1],C))||0;q[0]*ae[1]<ae[0]*q[1]&&(q[0]*=-1,q[1]*=-1,he*=-1,be*=-1),this.rotate=(he?Math.atan2(q[1],q[0]):Math.atan2(-ae[0],ae[1]))*Dt,this.translate=[ue.e,ue.f],this.scale=[he,Ae],this.skew=Ae?Math.atan2(be,Ae)*Dt:0}function hs(ue,C){return ue[0]*C[0]+ue[1]*C[1]}function ko(ue){var C=Math.sqrt(hs(ue,ue));return C&&(ue[0]/=C,ue[1]/=C),C}d.ease=function(ue){var C=ue.indexOf("-"),R=C>=0?ue.slice(0,C):ue,F=C>=0?ue.slice(C+1):"in";return R=Ds.get(R)||to,Xi((F=js.get(F)||E)(R.apply(null,v.call(arguments,1))))},d.interpolateHcl=function(ue,C){ue=d.hcl(ue),C=d.hcl(C);var R=ue.h,F=ue.c,q=ue.l,ae=C.h-R,he=C.c-F,be=C.l-q;return isNaN(he)&&(he=0,F=isNaN(F)?C.c:F),isNaN(ae)?(ae=0,R=isNaN(R)?C.h:R):ae>180?ae-=360:ae<-180&&(ae+=360),function(Ae){return it(R+ae*Ae,F+he*Ae,q+be*Ae)+""}},d.interpolateHsl=function(ue,C){ue=d.hsl(ue),C=d.hsl(C);var R=ue.h,F=ue.s,q=ue.l,ae=C.h-R,he=C.s-F,be=C.l-q;return isNaN(he)&&(he=0,F=isNaN(F)?C.s:F),isNaN(ae)?(ae=0,R=isNaN(R)?C.h:R):ae>180?ae-=360:ae<-180&&(ae+=360),function(Ae){return lt(R+ae*Ae,F+he*Ae,q+be*Ae)+""}},d.interpolateLab=function(ue,C){ue=d.lab(ue),C=d.lab(C);var R=ue.l,F=ue.a,q=ue.b,ae=C.l-R,he=C.a-F,be=C.b-q;return function(Ae){return It(R+ae*Ae,F+he*Ae,q+be*Ae)+""}},d.interpolateRound=Ko,d.transform=function(ue){var C=y.createElementNS(d.ns.prefix.svg,"g");return(d.transform=function(R){if(R!=null){C.setAttribute("transform",R);var F=C.transform.baseVal.consolidate()}return new Jo(F?F.matrix:Ss)})(ue)},Jo.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var Ss={a:1,b:0,c:0,d:1,e:0,f:0};function xo(ue){return ue.length?ue.pop()+",":""}function $o(ue,C){var R=[],F=[];return ue=d.transform(ue),C=d.transform(C),function(q,ae,he,be){if(q[0]!==ae[0]||q[1]!==ae[1]){var Ae=he.push("translate(",null,",",null,")");be.push({i:Ae-4,x:Sa(q[0],ae[0])},{i:Ae-2,x:Sa(q[1],ae[1])})}else(ae[0]||ae[1])&&he.push("translate("+ae+")")}(ue.translate,C.translate,R,F),function(q,ae,he,be){q!==ae?(q-ae>180?ae+=360:ae-q>180&&(q+=360),be.push({i:he.push(xo(he)+"rotate(",null,")")-2,x:Sa(q,ae)})):ae&&he.push(xo(he)+"rotate("+ae+")")}(ue.rotate,C.rotate,R,F),function(q,ae,he,be){q!==ae?be.push({i:he.push(xo(he)+"skewX(",null,")")-2,x:Sa(q,ae)}):ae&&he.push(xo(he)+"skewX("+ae+")")}(ue.skew,C.skew,R,F),function(q,ae,he,be){if(q[0]!==ae[0]||q[1]!==ae[1]){var Ae=he.push(xo(he)+"scale(",null,",",null,")");be.push({i:Ae-4,x:Sa(q[0],ae[0])},{i:Ae-2,x:Sa(q[1],ae[1])})}else ae[0]===1&&ae[1]===1||he.push(xo(he)+"scale("+ae+")")}(ue.scale,C.scale,R,F),ue=C=null,function(q){for(var ae,he=-1,be=F.length;++he<be;)R[(ae=F[he]).i]=ae.x(q);return R.join("")}}function Es(ue,C){return C=(C-=ue=+ue)||1/C,function(R){return(R-ue)/C}}function Bo(ue,C){return C=(C-=ue=+ue)||1/C,function(R){return Math.max(0,Math.min(1,(R-ue)/C))}}function Gi(ue){for(var C=ue.source,R=ue.target,F=function(he,be){if(he===be)return he;for(var Ae=Ue(he),Ce=Ue(be),qe=Ae.pop(),et=Ce.pop(),st=null;qe===et;)st=qe,qe=Ae.pop(),et=Ce.pop();return st}(C,R),q=[C];C!==F;)C=C.parent,q.push(C);for(var ae=q.length;R!==F;)q.splice(ae,0,R),R=R.parent;return q}function Ue(ue){for(var C=[],R=ue.parent;R!=null;)C.push(ue),ue=R,R=R.parent;return C.push(ue),C}function Ke(ue){ue.fixed|=2}function rt(ue){ue.fixed&=-7}function ut(ue){ue.fixed|=4,ue.px=ue.x,ue.py=ue.y}function _t(ue){ue.fixed&=-5}d.interpolateTransform=$o,d.layout={},d.layout.bundle=function(){return function(ue){for(var C=[],R=-1,F=ue.length;++R<F;)C.push(Gi(ue[R]));return C}},d.layout.chord=function(){var ue,C,R,F,q,ae,he,be={},Ae=0;function Ce(){var et,st,kt,Pt,Et,Lt={},Tt=[],Bt=d.range(F),zt=[];for(ue=[],C=[],et=0,Pt=-1;++Pt<F;){for(st=0,Et=-1;++Et<F;)st+=R[Pt][Et];Tt.push(st),zt.push(d.range(F)),et+=st}for(q&&Bt.sort(function(vn,hn){return q(Tt[vn],Tt[hn])}),ae&&zt.forEach(function(vn,hn){vn.sort(function(Hn,Kn){return ae(R[hn][Hn],R[hn][Kn])})}),et=(Gt-Ae*F)/et,st=0,Pt=-1;++Pt<F;){for(kt=st,Et=-1;++Et<F;){var Ht=Bt[Pt],lr=zt[Ht][Et],br=R[Ht][lr],zr=st,Or=st+=br*et;Lt[Ht+"-"+lr]={index:Ht,subindex:lr,startAngle:zr,endAngle:Or,value:br}}C[Ht]={index:Ht,startAngle:kt,endAngle:st,value:Tt[Ht]},st+=Ae}for(Pt=-1;++Pt<F;)for(Et=Pt-1;++Et<F;){var tn=Lt[Pt+"-"+Et],en=Lt[Et+"-"+Pt];(tn.value||en.value)&&ue.push(tn.value<en.value?{source:en,target:tn}:{source:tn,target:en})}he&&qe()}function qe(){ue.sort(function(et,st){return he((et.source.value+et.target.value)/2,(st.source.value+st.target.value)/2)})}return be.matrix=function(et){return arguments.length?(F=(R=et)&&R.length,ue=C=null,be):R},be.padding=function(et){return arguments.length?(Ae=et,ue=C=null,be):Ae},be.sortGroups=function(et){return arguments.length?(q=et,ue=C=null,be):q},be.sortSubgroups=function(et){return arguments.length?(ae=et,ue=null,be):ae},be.sortChords=function(et){return arguments.length?(he=et,ue&&qe(),be):he},be.chords=function(){return ue||Ce(),ue},be.groups=function(){return C||Ce(),C},be},d.layout.force=function(){var ue,C,R,F,q,ae,he={},be=d.dispatch("start","tick","end"),Ae=[1,1],Ce=.9,qe=yt,et=Ct,st=-30,kt=er,Pt=.1,Et=.64,Lt=[],Tt=[];function Bt(Ht){return function(lr,br,zr,Or){if(lr.point!==Ht){var tn=lr.cx-Ht.x,en=lr.cy-Ht.y,vn=Or-br,hn=tn*tn+en*en;if(vn*vn/Et<hn){if(hn<kt){var Hn=lr.charge/hn;Ht.px-=tn*Hn,Ht.py-=en*Hn}return!0}lr.point&&hn&&hn<kt&&(Hn=lr.pointCharge/hn,Ht.px-=tn*Hn,Ht.py-=en*Hn)}return!lr.charge}}function zt(Ht){Ht.px=d.event.x,Ht.py=d.event.y,he.resume()}return he.tick=function(){if((R*=.99)<.005)return ue=null,be.end({type:"end",alpha:R=0}),!0;var Ht,lr,br,zr,Or,tn,en,vn,hn,Hn=Lt.length,Kn=Tt.length;for(lr=0;lr<Kn;++lr)zr=(br=Tt[lr]).source,(tn=(vn=(Or=br.target).x-zr.x)*vn+(hn=Or.y-zr.y)*hn)&&(vn*=tn=R*q[lr]*((tn=Math.sqrt(tn))-F[lr])/tn,hn*=tn,Or.x-=vn*(en=zr.weight+Or.weight?zr.weight/(zr.weight+Or.weight):.5),Or.y-=hn*en,zr.x+=vn*(en=1-en),zr.y+=hn*en);if((en=R*Pt)&&(vn=Ae[0]/2,hn=Ae[1]/2,lr=-1,en))for(;++lr<Hn;)(br=Lt[lr]).x+=(vn-br.x)*en,br.y+=(hn-br.y)*en;if(st)for(function hi(Kr,Ln,Jn){var Wn=0,oi=0;if(Kr.charge=0,!Kr.leaf)for(var di,Li=Kr.nodes,ri=Li.length,_i=-1;++_i<ri;)(di=Li[_i])!=null&&(hi(di,Ln,Jn),Kr.charge+=di.charge,Wn+=di.charge*di.cx,oi+=di.charge*di.cy);if(Kr.point){Kr.leaf||(Kr.point.x+=Math.random()-.5,Kr.point.y+=Math.random()-.5);var yi=Ln*Jn[Kr.point.index];Kr.charge+=Kr.pointCharge=yi,Wn+=yi*Kr.point.x,oi+=yi*Kr.point.y}Kr.cx=Wn/Kr.charge,Kr.cy=oi/Kr.charge}(Ht=d.geom.quadtree(Lt),R,ae),lr=-1;++lr<Hn;)(br=Lt[lr]).fixed||Ht.visit(Bt(br));for(lr=-1;++lr<Hn;)(br=Lt[lr]).fixed?(br.x=br.px,br.y=br.py):(br.x-=(br.px-(br.px=br.x))*Ce,br.y-=(br.py-(br.py=br.y))*Ce);be.tick({type:"tick",alpha:R})},he.nodes=function(Ht){return arguments.length?(Lt=Ht,he):Lt},he.links=function(Ht){return arguments.length?(Tt=Ht,he):Tt},he.size=function(Ht){return arguments.length?(Ae=Ht,he):Ae},he.linkDistance=function(Ht){return arguments.length?(qe=typeof Ht=="function"?Ht:+Ht,he):qe},he.distance=he.linkDistance,he.linkStrength=function(Ht){return arguments.length?(et=typeof Ht=="function"?Ht:+Ht,he):et},he.friction=function(Ht){return arguments.length?(Ce=+Ht,he):Ce},he.charge=function(Ht){return arguments.length?(st=typeof Ht=="function"?Ht:+Ht,he):st},he.chargeDistance=function(Ht){return arguments.length?(kt=Ht*Ht,he):Math.sqrt(kt)},he.gravity=function(Ht){return arguments.length?(Pt=+Ht,he):Pt},he.theta=function(Ht){return arguments.length?(Et=Ht*Ht,he):Math.sqrt(Et)},he.alpha=function(Ht){return arguments.length?(Ht=+Ht,R?Ht>0?R=Ht:(ue.c=null,ue.t=NaN,ue=null,be.end({type:"end",alpha:R=0})):Ht>0&&(be.start({type:"start",alpha:R=Ht}),ue=on(he.tick)),he):R},he.start=function(){var Ht,lr,br,zr=Lt.length,Or=Tt.length,tn=Ae[0],en=Ae[1];for(Ht=0;Ht<zr;++Ht)(br=Lt[Ht]).index=Ht,br.weight=0;for(Ht=0;Ht<Or;++Ht)typeof(br=Tt[Ht]).source=="number"&&(br.source=Lt[br.source]),typeof br.target=="number"&&(br.target=Lt[br.target]),++br.source.weight,++br.target.weight;for(Ht=0;Ht<zr;++Ht)br=Lt[Ht],isNaN(br.x)&&(br.x=vn("x",tn)),isNaN(br.y)&&(br.y=vn("y",en)),isNaN(br.px)&&(br.px=br.x),isNaN(br.py)&&(br.py=br.y);if(F=[],typeof qe=="function")for(Ht=0;Ht<Or;++Ht)F[Ht]=+qe.call(this,Tt[Ht],Ht);else for(Ht=0;Ht<Or;++Ht)F[Ht]=qe;if(q=[],typeof et=="function")for(Ht=0;Ht<Or;++Ht)q[Ht]=+et.call(this,Tt[Ht],Ht);else for(Ht=0;Ht<Or;++Ht)q[Ht]=et;if(ae=[],typeof st=="function")for(Ht=0;Ht<zr;++Ht)ae[Ht]=+st.call(this,Lt[Ht],Ht);else for(Ht=0;Ht<zr;++Ht)ae[Ht]=st;function vn(hn,Hn){if(!lr){for(lr=new Array(zr),Ln=0;Ln<zr;++Ln)lr[Ln]=[];for(Ln=0;Ln<Or;++Ln){var Kn=Tt[Ln];lr[Kn.source.index].push(Kn.target),lr[Kn.target.index].push(Kn.source)}}for(var hi,Kr=lr[Ht],Ln=-1,Jn=Kr.length;++Ln<Jn;)if(!isNaN(hi=Kr[Ln][hn]))return hi;return Math.random()*Hn}return he.resume()},he.resume=function(){return he.alpha(.1)},he.stop=function(){return he.alpha(0)},he.drag=function(){if(C||(C=d.behavior.drag().origin(E).on("dragstart.force",Ke).on("drag.force",zt).on("dragend.force",rt)),!arguments.length)return C;this.on("mouseover.force",ut).on("mouseout.force",_t).call(C)},d.rebind(he,be,"on")};var yt=20,Ct=1,er=1/0;function rr(ue,C){return d.rebind(ue,C,"sort","children","value"),ue.nodes=ue,ue.links=Ur,ue}function Xt(ue,C){for(var R=[ue];(ue=R.pop())!=null;)if(C(ue),(q=ue.children)&&(F=q.length))for(var F,q;--F>=0;)R.push(q[F])}function ur(ue,C){for(var R=[ue],F=[];(ue=R.pop())!=null;)if(F.push(ue),(ae=ue.children)&&(q=ae.length))for(var q,ae,he=-1;++he<q;)R.push(ae[he]);for(;(ue=F.pop())!=null;)C(ue)}function yr(ue){return ue.children}function kr(ue){return ue.value}function Sr(ue,C){return C.value-ue.value}function Ur(ue){return d.merge(ue.map(function(C){return(C.children||[]).map(function(R){return{source:C,target:R}})}))}d.layout.hierarchy=function(){var ue=Sr,C=yr,R=kr;function F(q){var ae,he=[q],be=[];for(q.depth=0;(ae=he.pop())!=null;)if(be.push(ae),(Ce=C.call(F,ae,ae.depth))&&(Ae=Ce.length)){for(var Ae,Ce,qe;--Ae>=0;)he.push(qe=Ce[Ae]),qe.parent=ae,qe.depth=ae.depth+1;R&&(ae.value=0),ae.children=Ce}else R&&(ae.value=+R.call(F,ae,ae.depth)||0),delete ae.children;return ur(q,function(et){var st,kt;ue&&(st=et.children)&&st.sort(ue),R&&(kt=et.parent)&&(kt.value+=et.value)}),be}return F.sort=function(q){return arguments.length?(ue=q,F):ue},F.children=function(q){return arguments.length?(C=q,F):C},F.value=function(q){return arguments.length?(R=q,F):R},F.revalue=function(q){return R&&(Xt(q,function(ae){ae.children&&(ae.value=0)}),ur(q,function(ae){var he;ae.children||(ae.value=+R.call(F,ae,ae.depth)||0),(he=ae.parent)&&(he.value+=ae.value)})),q},F},d.layout.partition=function(){var ue=d.layout.hierarchy(),C=[1,1];function R(F,q){var ae=ue.call(this,F,q);return function he(be,Ae,Ce,qe){var et=be.children;if(be.x=Ae,be.y=be.depth*qe,be.dx=Ce,be.dy=qe,et&&(st=et.length)){var st,kt,Pt,Et=-1;for(Ce=be.value?Ce/be.value:0;++Et<st;)he(kt=et[Et],Ae,Pt=kt.value*Ce,qe),Ae+=Pt}}(ae[0],0,C[0],C[1]/function he(be){var Ae=be.children,Ce=0;if(Ae&&(qe=Ae.length))for(var qe,et=-1;++et<qe;)Ce=Math.max(Ce,he(Ae[et]));return 1+Ce}(ae[0])),ae}return R.size=function(F){return arguments.length?(C=F,R):C},rr(R,ue)},d.layout.pie=function(){var ue=Number,C=un,R=0,F=Gt,q=0;function ae(he){var be,Ae=he.length,Ce=he.map(function(Bt,zt){return+ue.call(ae,Bt,zt)}),qe=+(typeof R=="function"?R.apply(this,arguments):R),et=(typeof F=="function"?F.apply(this,arguments):F)-qe,st=Math.min(Math.abs(et)/Ae,+(typeof q=="function"?q.apply(this,arguments):q)),kt=st*(et<0?-1:1),Pt=d.sum(Ce),Et=Pt?(et-Ae*kt)/Pt:0,Lt=d.range(Ae),Tt=[];return C!=null&&Lt.sort(C===un?function(Bt,zt){return Ce[zt]-Ce[Bt]}:function(Bt,zt){return C(he[Bt],he[zt])}),Lt.forEach(function(Bt){Tt[Bt]={data:he[Bt],value:be=Ce[Bt],startAngle:qe,endAngle:qe+=be*Et+kt,padAngle:st}}),Tt}return ae.value=function(he){return arguments.length?(ue=he,ae):ue},ae.sort=function(he){return arguments.length?(C=he,ae):C},ae.startAngle=function(he){return arguments.length?(R=he,ae):R},ae.endAngle=function(he){return arguments.length?(F=he,ae):F},ae.padAngle=function(he){return arguments.length?(q=he,ae):q},ae};var un={};function xn(ue){return ue.x}function On(ue){return ue.y}function Fn(ue,C,R){ue.y0=C,ue.y=R}d.layout.stack=function(){var ue=E,C=vi,R=Si,F=Fn,q=xn,ae=On;function he(be,Ae){if(!(st=be.length))return be;var Ce=be.map(function(Bt,zt){return ue.call(he,Bt,zt)}),qe=Ce.map(function(Bt){return Bt.map(function(zt,Ht){return[q.call(he,zt,Ht),ae.call(he,zt,Ht)]})}),et=C.call(he,qe,Ae);Ce=d.permute(Ce,et),qe=d.permute(qe,et);var st,kt,Pt,Et,Lt=R.call(he,qe,Ae),Tt=Ce[0].length;for(Pt=0;Pt<Tt;++Pt)for(F.call(he,Ce[0][Pt],Et=Lt[Pt],qe[0][Pt][1]),kt=1;kt<st;++kt)F.call(he,Ce[kt][Pt],Et+=qe[kt-1][Pt][1],qe[kt][Pt][1]);return be}return he.values=function(be){return arguments.length?(ue=be,he):ue},he.order=function(be){return arguments.length?(C=typeof be=="function"?be:Yn.get(be)||vi,he):C},he.offset=function(be){return arguments.length?(R=typeof be=="function"?be:Bn.get(be)||Si,he):R},he.x=function(be){return arguments.length?(q=be,he):q},he.y=function(be){return arguments.length?(ae=be,he):ae},he.out=function(be){return arguments.length?(F=be,he):F},he};var Yn=d.map({"inside-out":function(ue){var C,R,F=ue.length,q=ue.map(Ui),ae=ue.map(ji),he=d.range(F).sort(function(et,st){return q[et]-q[st]}),be=0,Ae=0,Ce=[],qe=[];for(C=0;C<F;++C)R=he[C],be<Ae?(be+=ae[R],Ce.push(R)):(Ae+=ae[R],qe.push(R));return qe.reverse().concat(Ce)},reverse:function(ue){return d.range(ue.length).reverse()},default:vi}),Bn=d.map({silhouette:function(ue){var C,R,F,q=ue.length,ae=ue[0].length,he=[],be=0,Ae=[];for(R=0;R<ae;++R){for(C=0,F=0;C<q;C++)F+=ue[C][R][1];F>be&&(be=F),he.push(F)}for(R=0;R<ae;++R)Ae[R]=(be-he[R])/2;return Ae},wiggle:function(ue){var C,R,F,q,ae,he,be,Ae,Ce,qe=ue.length,et=ue[0],st=et.length,kt=[];for(kt[0]=Ae=Ce=0,R=1;R<st;++R){for(C=0,q=0;C<qe;++C)q+=ue[C][R][1];for(C=0,ae=0,be=et[R][0]-et[R-1][0];C<qe;++C){for(F=0,he=(ue[C][R][1]-ue[C][R-1][1])/(2*be);F<C;++F)he+=(ue[F][R][1]-ue[F][R-1][1])/be;ae+=he*ue[C][R][1]}kt[R]=Ae-=q?ae/q*be:0,Ae<Ce&&(Ce=Ae)}for(R=0;R<st;++R)kt[R]-=Ce;return kt},expand:function(ue){var C,R,F,q=ue.length,ae=ue[0].length,he=1/q,be=[];for(R=0;R<ae;++R){for(C=0,F=0;C<q;C++)F+=ue[C][R][1];if(F)for(C=0;C<q;C++)ue[C][R][1]/=F;else for(C=0;C<q;C++)ue[C][R][1]=he}for(R=0;R<ae;++R)be[R]=0;return be},zero:Si});function vi(ue){return d.range(ue.length)}function Si(ue){for(var C=-1,R=ue[0].length,F=[];++C<R;)F[C]=0;return F}function Ui(ue){for(var C,R=1,F=0,q=ue[0][1],ae=ue.length;R<ae;++R)(C=ue[R][1])>q&&(F=R,q=C);return F}function ji(ue){return ue.reduce(Vi,0)}function Vi(ue,C){return ue+C[1]}function Ea(ue,C){return ka(ue,Math.ceil(Math.log(C.length)/Math.LN2+1))}function ka(ue,C){for(var R=-1,F=+ue[0],q=(ue[1]-F)/C,ae=[];++R<=C;)ae[R]=q*R+F;return ae}function ca(ue){return[d.min(ue),d.max(ue)]}function ua(ue,C){return ue.value-C.value}function Ma(ue,C){var R=ue._pack_next;ue._pack_next=C,C._pack_prev=ue,C._pack_next=R,R._pack_prev=C}function Ga(ue,C){ue._pack_next=C,C._pack_prev=ue}function ao(ue,C){var R=C.x-ue.x,F=C.y-ue.y,q=ue.r+C.r;return .999*q*q>R*R+F*F}function oo(ue){if((C=ue.children)&&(Ae=C.length)){var C,R,F,q,ae,he,be,Ae,Ce=1/0,qe=-1/0,et=1/0,st=-1/0;if(C.forEach(so),(R=C[0]).x=-R.r,R.y=0,zt(R),Ae>1&&((F=C[1]).x=F.r,F.y=0,zt(F),Ae>2))for(zi(R,F,q=C[2]),zt(q),Ma(R,q),R._pack_prev=q,Ma(q,F),F=R._pack_next,ae=3;ae<Ae;ae++){zi(R,F,q=C[ae]);var kt=0,Pt=1,Et=1;for(he=F._pack_next;he!==F;he=he._pack_next,Pt++)if(ao(he,q)){kt=1;break}if(kt==1)for(be=R._pack_prev;be!==he._pack_prev&&!ao(be,q);be=be._pack_prev,Et++);kt?(Pt<Et||Pt==Et&&F.r<R.r?Ga(R,F=he):Ga(R=be,F),ae--):(Ma(R,q),F=q,zt(q))}var Lt=(Ce+qe)/2,Tt=(et+st)/2,Bt=0;for(ae=0;ae<Ae;ae++)(q=C[ae]).x-=Lt,q.y-=Tt,Bt=Math.max(Bt,q.r+Math.sqrt(q.x*q.x+q.y*q.y));ue.r=Bt,C.forEach(lo)}function zt(Ht){Ce=Math.min(Ht.x-Ht.r,Ce),qe=Math.max(Ht.x+Ht.r,qe),et=Math.min(Ht.y-Ht.r,et),st=Math.max(Ht.y+Ht.r,st)}}function so(ue){ue._pack_next=ue._pack_prev=ue}function lo(ue){delete ue._pack_next,delete ue._pack_prev}function zi(ue,C,R){var F=ue.r+R.r,q=C.x-ue.x,ae=C.y-ue.y;if(F&&(q||ae)){var he=C.r+R.r,be=q*q+ae*ae,Ae=.5+((F*=F)-(he*=he))/(2*be),Ce=Math.sqrt(Math.max(0,2*he*(F+be)-(F-=be)*F-he*he))/(2*be);R.x=ue.x+Ae*q+Ce*ae,R.y=ue.y+Ae*ae-Ce*q}else R.x=ue.x+F,R.y=ue.y}function dt(ue,C){return ue.parent==C.parent?1:2}function Ft(ue){var C=ue.children;return C.length?C[0]:ue.t}function hr(ue){var C,R=ue.children;return(C=R.length)?R[C-1]:ue.t}function Yt(ue,C,R){var F=R/(C.i-ue.i);C.c-=F,C.s+=R,ue.c+=F,C.z+=R,C.m+=R}function pr(ue,C,R){return ue.a.parent===C.parent?ue.a:R}function Nr(ue){return{x:ue.x,y:ue.y,dx:ue.dx,dy:ue.dy}}function qr(ue,C){var R=ue.x+C[3],F=ue.y+C[0],q=ue.dx-C[1]-C[3],ae=ue.dy-C[0]-C[2];return q<0&&(R+=q/2,q=0),ae<0&&(F+=ae/2,ae=0),{x:R,y:F,dx:q,dy:ae}}function $r(ue){var C=ue[0],R=ue[ue.length-1];return C<R?[C,R]:[R,C]}function dn(ue){return ue.rangeExtent?ue.rangeExtent():$r(ue.range())}function fn(ue,C,R,F){var q=R(ue[0],ue[1]),ae=F(C[0],C[1]);return function(he){return ae(q(he))}}function _n(ue,C){var R,F=0,q=ue.length-1,ae=ue[F],he=ue[q];return he<ae&&(R=F,F=q,q=R,R=ae,ae=he,he=R),ue[F]=C.floor(ae),ue[q]=C.ceil(he),ue}function Sn(ue){return ue?{floor:function(C){return Math.floor(C/ue)*ue},ceil:function(C){return Math.ceil(C/ue)*ue}}:mn}d.layout.histogram=function(){var ue=!0,C=Number,R=ca,F=Ea;function q(ae,he){for(var be,Ae,Ce=[],qe=ae.map(C,this),et=R.call(this,qe,he),st=F.call(this,et,qe,he),kt=(he=-1,qe.length),Pt=st.length-1,Et=ue?1:1/kt;++he<Pt;)(be=Ce[he]=[]).dx=st[he+1]-(be.x=st[he]),be.y=0;if(Pt>0)for(he=-1;++he<kt;)(Ae=qe[he])>=et[0]&&Ae<=et[1]&&((be=Ce[d.bisect(st,Ae,1,Pt)-1]).y+=Et,be.push(ae[he]));return Ce}return q.value=function(ae){return arguments.length?(C=ae,q):C},q.range=function(ae){return arguments.length?(R=_r(ae),q):R},q.bins=function(ae){return arguments.length?(F=typeof ae=="number"?function(he){return ka(he,ae)}:_r(ae),q):F},q.frequency=function(ae){return arguments.length?(ue=!!ae,q):ue},q},d.layout.pack=function(){var ue,C=d.layout.hierarchy().sort(ua),R=0,F=[1,1];function q(ae,he){var be=C.call(this,ae,he),Ae=be[0],Ce=F[0],qe=F[1],et=ue==null?Math.sqrt:typeof ue=="function"?ue:function(){return ue};if(Ae.x=Ae.y=0,ur(Ae,function(kt){kt.r=+et(kt.value)}),ur(Ae,oo),R){var st=R*(ue?1:Math.max(2*Ae.r/Ce,2*Ae.r/qe))/2;ur(Ae,function(kt){kt.r+=st}),ur(Ae,oo),ur(Ae,function(kt){kt.r-=st})}return function kt(Pt,Et,Lt,Tt){var Bt=Pt.children;if(Pt.x=Et+=Tt*Pt.x,Pt.y=Lt+=Tt*Pt.y,Pt.r*=Tt,Bt)for(var zt=-1,Ht=Bt.length;++zt<Ht;)kt(Bt[zt],Et,Lt,Tt)}(Ae,Ce/2,qe/2,ue?1:1/Math.max(2*Ae.r/Ce,2*Ae.r/qe)),be}return q.size=function(ae){return arguments.length?(F=ae,q):F},q.radius=function(ae){return arguments.length?(ue=ae==null||typeof ae=="function"?ae:+ae,q):ue},q.padding=function(ae){return arguments.length?(R=+ae,q):R},rr(q,C)},d.layout.tree=function(){var ue=d.layout.hierarchy().sort(null).value(null),C=dt,R=[1,1],F=null;function q(Ae,Ce){var qe=ue.call(this,Ae,Ce),et=qe[0],st=function(zt){for(var Ht,lr={A:null,children:[zt]},br=[lr];(Ht=br.pop())!=null;)for(var zr,Or=Ht.children,tn=0,en=Or.length;tn<en;++tn)br.push((Or[tn]=zr={_:Or[tn],parent:Ht,children:(zr=Or[tn].children)&&zr.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:tn}).a=zr);return lr.children[0]}(et);if(ur(st,ae),st.parent.m=-st.z,Xt(st,he),F)Xt(et,be);else{var kt=et,Pt=et,Et=et;Xt(et,function(zt){zt.x<kt.x&&(kt=zt),zt.x>Pt.x&&(Pt=zt),zt.depth>Et.depth&&(Et=zt)});var Lt=C(kt,Pt)/2-kt.x,Tt=R[0]/(Pt.x+C(Pt,kt)/2+Lt),Bt=R[1]/(Et.depth||1);Xt(et,function(zt){zt.x=(zt.x+Lt)*Tt,zt.y=zt.depth*Bt})}return qe}function ae(Ae){var Ce=Ae.children,qe=Ae.parent.children,et=Ae.i?qe[Ae.i-1]:null;if(Ce.length){(function(kt){for(var Pt,Et=0,Lt=0,Tt=kt.children,Bt=Tt.length;--Bt>=0;)(Pt=Tt[Bt]).z+=Et,Pt.m+=Et,Et+=Pt.s+(Lt+=Pt.c)})(Ae);var st=(Ce[0].z+Ce[Ce.length-1].z)/2;et?(Ae.z=et.z+C(Ae._,et._),Ae.m=Ae.z-st):Ae.z=st}else et&&(Ae.z=et.z+C(Ae._,et._));Ae.parent.A=function(kt,Pt,Et){if(Pt){for(var Lt,Tt=kt,Bt=kt,zt=Pt,Ht=Tt.parent.children[0],lr=Tt.m,br=Bt.m,zr=zt.m,Or=Ht.m;zt=hr(zt),Tt=Ft(Tt),zt&&Tt;)Ht=Ft(Ht),(Bt=hr(Bt)).a=kt,(Lt=zt.z+zr-Tt.z-lr+C(zt._,Tt._))>0&&(Yt(pr(zt,kt,Et),kt,Lt),lr+=Lt,br+=Lt),zr+=zt.m,lr+=Tt.m,Or+=Ht.m,br+=Bt.m;zt&&!hr(Bt)&&(Bt.t=zt,Bt.m+=zr-br),Tt&&!Ft(Ht)&&(Ht.t=Tt,Ht.m+=lr-Or,Et=kt)}return Et}(Ae,et,Ae.parent.A||qe[0])}function he(Ae){Ae._.x=Ae.z+Ae.parent.m,Ae.m+=Ae.parent.m}function be(Ae){Ae.x*=R[0],Ae.y=Ae.depth*R[1]}return q.separation=function(Ae){return arguments.length?(C=Ae,q):C},q.size=function(Ae){return arguments.length?(F=(R=Ae)==null?be:null,q):F?null:R},q.nodeSize=function(Ae){return arguments.length?(F=(R=Ae)==null?null:be,q):F?R:null},rr(q,ue)},d.layout.cluster=function(){var ue=d.layout.hierarchy().sort(null).value(null),C=dt,R=[1,1],F=!1;function q(ae,he){var be,Ae=ue.call(this,ae,he),Ce=Ae[0],qe=0;ur(Ce,function(Et){var Lt=Et.children;Lt&&Lt.length?(Et.x=function(Tt){return Tt.reduce(function(Bt,zt){return Bt+zt.x},0)/Tt.length}(Lt),Et.y=function(Tt){return 1+d.max(Tt,function(Bt){return Bt.y})}(Lt)):(Et.x=be?qe+=C(Et,be):0,Et.y=0,be=Et)});var et=function Et(Lt){var Tt=Lt.children;return Tt&&Tt.length?Et(Tt[0]):Lt}(Ce),st=function Et(Lt){var Tt,Bt=Lt.children;return Bt&&(Tt=Bt.length)?Et(Bt[Tt-1]):Lt}(Ce),kt=et.x-C(et,st)/2,Pt=st.x+C(st,et)/2;return ur(Ce,F?function(Et){Et.x=(Et.x-Ce.x)*R[0],Et.y=(Ce.y-Et.y)*R[1]}:function(Et){Et.x=(Et.x-kt)/(Pt-kt)*R[0],Et.y=(1-(Ce.y?Et.y/Ce.y:1))*R[1]}),Ae}return q.separation=function(ae){return arguments.length?(C=ae,q):C},q.size=function(ae){return arguments.length?(F=(R=ae)==null,q):F?null:R},q.nodeSize=function(ae){return arguments.length?(F=(R=ae)!=null,q):F?R:null},rr(q,ue)},d.layout.treemap=function(){var ue,C=d.layout.hierarchy(),R=Math.round,F=[1,1],q=null,ae=Nr,he=!1,be="squarify",Ae=.5*(1+Math.sqrt(5));function Ce(Et,Lt){for(var Tt,Bt,zt=-1,Ht=Et.length;++zt<Ht;)Bt=(Tt=Et[zt]).value*(Lt<0?0:Lt),Tt.area=isNaN(Bt)||Bt<=0?0:Bt}function qe(Et){var Lt=Et.children;if(Lt&&Lt.length){var Tt,Bt,zt,Ht=ae(Et),lr=[],br=Lt.slice(),zr=1/0,Or=be==="slice"?Ht.dx:be==="dice"?Ht.dy:be==="slice-dice"?1&Et.depth?Ht.dy:Ht.dx:Math.min(Ht.dx,Ht.dy);for(Ce(br,Ht.dx*Ht.dy/Et.value),lr.area=0;(zt=br.length)>0;)lr.push(Tt=br[zt-1]),lr.area+=Tt.area,be!=="squarify"||(Bt=st(lr,Or))<=zr?(br.pop(),zr=Bt):(lr.area-=lr.pop().area,kt(lr,Or,Ht,!1),Or=Math.min(Ht.dx,Ht.dy),lr.length=lr.area=0,zr=1/0);lr.length&&(kt(lr,Or,Ht,!0),lr.length=lr.area=0),Lt.forEach(qe)}}function et(Et){var Lt=Et.children;if(Lt&&Lt.length){var Tt,Bt=ae(Et),zt=Lt.slice(),Ht=[];for(Ce(zt,Bt.dx*Bt.dy/Et.value),Ht.area=0;Tt=zt.pop();)Ht.push(Tt),Ht.area+=Tt.area,Tt.z!=null&&(kt(Ht,Tt.z?Bt.dx:Bt.dy,Bt,!zt.length),Ht.length=Ht.area=0);Lt.forEach(et)}}function st(Et,Lt){for(var Tt,Bt=Et.area,zt=0,Ht=1/0,lr=-1,br=Et.length;++lr<br;)(Tt=Et[lr].area)&&(Tt<Ht&&(Ht=Tt),Tt>zt&&(zt=Tt));return Lt*=Lt,(Bt*=Bt)?Math.max(Lt*zt*Ae/Bt,Bt/(Lt*Ht*Ae)):1/0}function kt(Et,Lt,Tt,Bt){var zt,Ht=-1,lr=Et.length,br=Tt.x,zr=Tt.y,Or=Lt?R(Et.area/Lt):0;if(Lt==Tt.dx){for((Bt||Or>Tt.dy)&&(Or=Tt.dy);++Ht<lr;)(zt=Et[Ht]).x=br,zt.y=zr,zt.dy=Or,br+=zt.dx=Math.min(Tt.x+Tt.dx-br,Or?R(zt.area/Or):0);zt.z=!0,zt.dx+=Tt.x+Tt.dx-br,Tt.y+=Or,Tt.dy-=Or}else{for((Bt||Or>Tt.dx)&&(Or=Tt.dx);++Ht<lr;)(zt=Et[Ht]).x=br,zt.y=zr,zt.dx=Or,zr+=zt.dy=Math.min(Tt.y+Tt.dy-zr,Or?R(zt.area/Or):0);zt.z=!1,zt.dy+=Tt.y+Tt.dy-zr,Tt.x+=Or,Tt.dx-=Or}}function Pt(Et){var Lt=ue||C(Et),Tt=Lt[0];return Tt.x=Tt.y=0,Tt.value?(Tt.dx=F[0],Tt.dy=F[1]):Tt.dx=Tt.dy=0,ue&&C.revalue(Tt),Ce([Tt],Tt.dx*Tt.dy/Tt.value),(ue?et:qe)(Tt),he&&(ue=Lt),Lt}return Pt.size=function(Et){return arguments.length?(F=Et,Pt):F},Pt.padding=function(Et){if(!arguments.length)return q;function Lt(zt){var Ht=Et.call(Pt,zt,zt.depth);return Ht==null?Nr(zt):qr(zt,typeof Ht=="number"?[Ht,Ht,Ht,Ht]:Ht)}function Tt(zt){return qr(zt,Et)}var Bt;return ae=(q=Et)==null?Nr:(Bt=typeof Et)=="function"?Lt:(Bt==="number"&&(Et=[Et,Et,Et,Et]),Tt),Pt},Pt.round=function(Et){return arguments.length?(R=Et?Math.round:Number,Pt):R!=Number},Pt.sticky=function(Et){return arguments.length?(he=Et,ue=null,Pt):he},Pt.ratio=function(Et){return arguments.length?(Ae=Et,Pt):Ae},Pt.mode=function(Et){return arguments.length?(be=Et+"",Pt):be},rr(Pt,C)},d.random={normal:function(ue,C){var R=arguments.length;return R<2&&(C=1),R<1&&(ue=0),function(){var F,q,ae;do ae=(F=2*Math.random()-1)*F+(q=2*Math.random()-1)*q;while(!ae||ae>1);return ue+C*F*Math.sqrt(-2*Math.log(ae)/ae)}},logNormal:function(){var ue=d.random.normal.apply(d,arguments);return function(){return Math.exp(ue())}},bates:function(ue){var C=d.random.irwinHall(ue);return function(){return C()/ue}},irwinHall:function(ue){return function(){for(var C=0,R=0;R<ue;R++)C+=Math.random();return C}}},d.scale={};var mn={floor:E,ceil:E};function En(ue,C,R,F){var q=[],ae=[],he=0,be=Math.min(ue.length,C.length)-1;for(ue[be]<ue[0]&&(ue=ue.slice().reverse(),C=C.slice().reverse());++he<=be;)q.push(R(ue[he-1],ue[he])),ae.push(F(C[he-1],C[he]));return function(Ae){var Ce=d.bisect(ue,Ae,1,be)-1;return ae[Ce](q[Ce](Ae))}}function Nn(ue,C){return d.rebind(ue,C,"range","rangeRound","interpolate","clamp")}function Gn(ue,C){return _n(ue,Sn(si(ue,C)[2])),_n(ue,Sn(si(ue,C)[2])),ue}function si(ue,C){C==null&&(C=10);var R=$r(ue),F=R[1]-R[0],q=Math.pow(10,Math.floor(Math.log(F/C)/Math.LN10)),ae=C/F*q;return ae<=.15?q*=10:ae<=.35?q*=5:ae<=.75&&(q*=2),R[0]=Math.ceil(R[0]/q)*q,R[1]=Math.floor(R[1]/q)*q+.5*q,R[2]=q,R}function Qr(ue,C){return d.range.apply(d,si(ue,C))}d.scale.linear=function(){return function ue(C,R,F,q){var ae,he;function be(){var Ce=Math.min(C.length,R.length)>2?En:fn,qe=q?Bo:Es;return ae=Ce(C,R,qe,F),he=Ce(R,C,qe,qa),Ae}function Ae(Ce){return ae(Ce)}return Ae.invert=function(Ce){return he(Ce)},Ae.domain=function(Ce){return arguments.length?(C=Ce.map(Number),be()):C},Ae.range=function(Ce){return arguments.length?(R=Ce,be()):R},Ae.rangeRound=function(Ce){return Ae.range(Ce).interpolate(Ko)},Ae.clamp=function(Ce){return arguments.length?(q=Ce,be()):q},Ae.interpolate=function(Ce){return arguments.length?(F=Ce,be()):F},Ae.ticks=function(Ce){return Qr(C,Ce)},Ae.tickFormat=function(Ce,qe){return d3_scale_linearTickFormat(C,Ce,qe)},Ae.nice=function(Ce){return Gn(C,Ce),be()},Ae.copy=function(){return ue(C,R,F,q)},be()}([0,1],[0,1],qa,!1)},d.scale.log=function(){return function ue(C,R,F,q){function ae(Ae){return(F?Math.log(Ae<0?0:Ae):-Math.log(Ae>0?0:-Ae))/Math.log(R)}function he(Ae){return F?Math.pow(R,Ae):-Math.pow(R,-Ae)}function be(Ae){return C(ae(Ae))}return be.invert=function(Ae){return he(C.invert(Ae))},be.domain=function(Ae){return arguments.length?(F=Ae[0]>=0,C.domain((q=Ae.map(Number)).map(ae)),be):q},be.base=function(Ae){return arguments.length?(R=+Ae,C.domain(q.map(ae)),be):R},be.nice=function(){var Ae=_n(q.map(ae),F?Math:ii);return C.domain(Ae),q=Ae.map(he),be},be.ticks=function(){var Ae=$r(q),Ce=[],qe=Ae[0],et=Ae[1],st=Math.floor(ae(qe)),kt=Math.ceil(ae(et)),Pt=R%1?2:R;if(isFinite(kt-st)){if(F){for(;st<kt;st++)for(var Et=1;Et<Pt;Et++)Ce.push(he(st)*Et);Ce.push(he(st))}else for(Ce.push(he(st));st++<kt;)for(Et=Pt-1;Et>0;Et--)Ce.push(he(st)*Et);for(st=0;Ce[st]<qe;st++);for(kt=Ce.length;Ce[kt-1]>et;kt--);Ce=Ce.slice(st,kt)}return Ce},be.copy=function(){return ue(C.copy(),R,F,q)},Nn(be,C)}(d.scale.linear().domain([0,1]),10,!0,[1,10])};var ii={floor:function(ue){return-Math.ceil(-ue)},ceil:function(ue){return-Math.floor(-ue)}};function Dn(ue){return function(C){return C<0?-Math.pow(-C,ue):Math.pow(C,ue)}}d.scale.pow=function(){return function ue(C,R,F){var q=Dn(R),ae=Dn(1/R);function he(be){return C(q(be))}return he.invert=function(be){return ae(C.invert(be))},he.domain=function(be){return arguments.length?(C.domain((F=be.map(Number)).map(q)),he):F},he.ticks=function(be){return Qr(F,be)},he.tickFormat=function(be,Ae){return d3_scale_linearTickFormat(F,be,Ae)},he.nice=function(be){return he.domain(Gn(F,be))},he.exponent=function(be){return arguments.length?(q=Dn(R=be),ae=Dn(1/R),C.domain(F.map(q)),he):R},he.copy=function(){return ue(C.copy(),R,F)},Nn(he,C)}(d.scale.linear(),1,[0,1])},d.scale.sqrt=function(){return d.scale.pow().exponent(.5)},d.scale.ordinal=function(){return function ue(C,R){var F,q,ae;function he(Ae){return q[((F.get(Ae)||(R.t==="range"?F.set(Ae,C.push(Ae)):NaN))-1)%q.length]}function be(Ae,Ce){return d.range(C.length).map(function(qe){return Ae+Ce*qe})}return he.domain=function(Ae){if(!arguments.length)return C;C=[],F=new _;for(var Ce,qe=-1,et=Ae.length;++qe<et;)F.has(Ce=Ae[qe])||F.set(Ce,C.push(Ce));return he[R.t].apply(he,R.a)},he.range=function(Ae){return arguments.length?(q=Ae,ae=0,R={t:"range",a:arguments},he):q},he.rangePoints=function(Ae,Ce){arguments.length<2&&(Ce=0);var qe=Ae[0],et=Ae[1],st=C.length<2?(qe=(qe+et)/2,0):(et-qe)/(C.length-1+Ce);return q=be(qe+st*Ce/2,st),ae=0,R={t:"rangePoints",a:arguments},he},he.rangeRoundPoints=function(Ae,Ce){arguments.length<2&&(Ce=0);var qe=Ae[0],et=Ae[1],st=C.length<2?(qe=et=Math.round((qe+et)/2),0):(et-qe)/(C.length-1+Ce)|0;return q=be(qe+Math.round(st*Ce/2+(et-qe-(C.length-1+Ce)*st)/2),st),ae=0,R={t:"rangeRoundPoints",a:arguments},he},he.rangeBands=function(Ae,Ce,qe){arguments.length<2&&(Ce=0),arguments.length<3&&(qe=Ce);var et=Ae[1]<Ae[0],st=Ae[et-0],kt=Ae[1-et],Pt=(kt-st)/(C.length-Ce+2*qe);return q=be(st+Pt*qe,Pt),et&&q.reverse(),ae=Pt*(1-Ce),R={t:"rangeBands",a:arguments},he},he.rangeRoundBands=function(Ae,Ce,qe){arguments.length<2&&(Ce=0),arguments.length<3&&(qe=Ce);var et=Ae[1]<Ae[0],st=Ae[et-0],kt=Ae[1-et],Pt=Math.floor((kt-st)/(C.length-Ce+2*qe));return q=be(st+Math.round((kt-st-(C.length-Ce)*Pt)/2),Pt),et&&q.reverse(),ae=Math.round(Pt*(1-Ce)),R={t:"rangeRoundBands",a:arguments},he},he.rangeBand=function(){return ae},he.rangeExtent=function(){return $r(R.a[0])},he.copy=function(){return ue(C,R)},he.domain(C)}([],{t:"range",a:[[]]})},d.scale.category10=function(){return d.scale.ordinal().range(Vn)},d.scale.category20=function(){return d.scale.ordinal().range(ni)},d.scale.category20b=function(){return d.scale.ordinal().range(ki)},d.scale.category20c=function(){return d.scale.ordinal().range(Pi)};var Vn=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(Jt),ni=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(Jt),ki=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(Jt),Pi=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(Jt);function In(){return 0}d.scale.quantile=function(){return function ue(C,R){var F;function q(){var he=0,be=R.length;for(F=[];++he<be;)F[he-1]=d.quantile(C,he/be);return ae}function ae(he){if(!isNaN(he=+he))return R[d.bisect(F,he)]}return ae.domain=function(he){return arguments.length?(C=he.map(h).filter(l).sort(a),q()):C},ae.range=function(he){return arguments.length?(R=he,q()):R},ae.quantiles=function(){return F},ae.invertExtent=function(he){return(he=R.indexOf(he))<0?[NaN,NaN]:[he>0?F[he-1]:C[0],he<F.length?F[he]:C[C.length-1]]},ae.copy=function(){return ue(C,R)},q()}([],[])},d.scale.quantize=function(){return function ue(C,R,F){var q,ae;function he(Ae){return F[Math.max(0,Math.min(ae,Math.floor(q*(Ae-C))))]}function be(){return q=F.length/(R-C),ae=F.length-1,he}return he.domain=function(Ae){return arguments.length?(C=+Ae[0],R=+Ae[Ae.length-1],be()):[C,R]},he.range=function(Ae){return arguments.length?(F=Ae,be()):F},he.invertExtent=function(Ae){return[Ae=(Ae=F.indexOf(Ae))<0?NaN:Ae/q+C,Ae+1/q]},he.copy=function(){return ue(C,R,F)},be()}(0,1,[0,1])},d.scale.threshold=function(){return function ue(C,R){function F(q){if(q<=q)return R[d.bisect(C,q)]}return F.domain=function(q){return arguments.length?(C=q,F):C},F.range=function(q){return arguments.length?(R=q,F):R},F.invertExtent=function(q){return q=R.indexOf(q),[C[q-1],C[q]]},F.copy=function(){return ue(C,R)},F}([.5],[0,1])},d.scale.identity=function(){return function ue(C){function R(F){return+F}return R.invert=R,R.domain=R.range=function(F){return arguments.length?(C=F.map(R),R):C},R.ticks=function(F){return Qr(C,F)},R.tickFormat=function(F,q){return d3_scale_linearTickFormat(C,F,q)},R.copy=function(){return ue(C)},R}([0,1])},d.svg={},d.svg.arc=function(){var ue=Ci,C=gi,R=In,F=Ri,q=Fi,ae=Ei,he=na;function be(){var Ce=Math.max(0,+ue.apply(this,arguments)),qe=Math.max(0,+C.apply(this,arguments)),et=q.apply(this,arguments)-Zt,st=ae.apply(this,arguments)-Zt,kt=Math.abs(st-et),Pt=et>st?0:1;if(qe<Ce&&(Et=qe,qe=Ce,Ce=Et),kt>=$t)return Ae(qe,Pt)+(Ce?Ae(Ce,1-Pt):"")+"Z";var Et,Lt,Tt,Bt,zt,Ht,lr,br,zr,Or,tn,en,vn=0,hn=0,Hn=[];if((Bt=(+he.apply(this,arguments)||0)/2)&&(Tt=F===Ri?Math.sqrt(Ce*Ce+qe*qe):+F.apply(this,arguments),Pt||(hn*=-1),qe&&(hn=Ne(Tt/qe*Math.sin(Bt))),Ce&&(vn=Ne(Tt/Ce*Math.sin(Bt)))),qe){zt=qe*Math.cos(et+hn),Ht=qe*Math.sin(et+hn),lr=qe*Math.cos(st-hn),br=qe*Math.sin(st-hn);var Kn=Math.abs(st-et-2*hn)<=jt?0:1;if(hn&&ai(zt,Ht,lr,br)===Pt^Kn){var hi=(et+st)/2;zt=qe*Math.cos(hi),Ht=qe*Math.sin(hi),lr=br=null}}else zt=Ht=0;if(Ce){zr=Ce*Math.cos(st-vn),Or=Ce*Math.sin(st-vn),tn=Ce*Math.cos(et+vn),en=Ce*Math.sin(et+vn);var Kr=Math.abs(et-st+2*vn)<=jt?0:1;if(vn&&ai(zr,Or,tn,en)===1-Pt^Kr){var Ln=(et+st)/2;zr=Ce*Math.cos(Ln),Or=Ce*Math.sin(Ln),tn=en=null}}else zr=Or=0;if(kt>vt&&(Et=Math.min(Math.abs(qe-Ce)/2,+R.apply(this,arguments)))>.001){Lt=Ce<qe^Pt?0:1;var Jn=Et,Wn=Et;if(kt<jt){var oi=tn==null?[zr,Or]:lr==null?[zt,Ht]:sr([zt,Ht],[tn,en],[lr,br],[zr,Or]),di=zt-oi[0],Li=Ht-oi[1],ri=lr-oi[0],_i=br-oi[1],yi=1/Math.sin(Math.acos((di*ri+Li*_i)/(Math.sqrt(di*di+Li*Li)*Math.sqrt(ri*ri+_i*_i)))/2),Ii=Math.sqrt(oi[0]*oi[0]+oi[1]*oi[1]);Wn=Math.min(Et,(Ce-Ii)/(yi-1)),Jn=Math.min(Et,(qe-Ii)/(yi+1))}if(lr!=null){var wi=Ki(tn==null?[zr,Or]:[tn,en],[zt,Ht],qe,Jn,Pt),Oi=Ki([lr,br],[zr,Or],qe,Jn,Pt);Et===Jn?Hn.push("M",wi[0],"A",Jn,",",Jn," 0 0,",Lt," ",wi[1],"A",qe,",",qe," 0 ",1-Pt^ai(wi[1][0],wi[1][1],Oi[1][0],Oi[1][1]),",",Pt," ",Oi[1],"A",Jn,",",Jn," 0 0,",Lt," ",Oi[0]):Hn.push("M",wi[0],"A",Jn,",",Jn," 0 1,",Lt," ",Oi[0])}else Hn.push("M",zt,",",Ht);if(tn!=null){var Hi=Ki([zt,Ht],[tn,en],Ce,-Wn,Pt),da=Ki([zr,Or],lr==null?[zt,Ht]:[lr,br],Ce,-Wn,Pt);Et===Wn?Hn.push("L",da[0],"A",Wn,",",Wn," 0 0,",Lt," ",da[1],"A",Ce,",",Ce," 0 ",Pt^ai(da[1][0],da[1][1],Hi[1][0],Hi[1][1]),",",1-Pt," ",Hi[1],"A",Wn,",",Wn," 0 0,",Lt," ",Hi[0]):Hn.push("L",da[0],"A",Wn,",",Wn," 0 0,",Lt," ",Hi[0])}else Hn.push("L",zr,",",Or)}else Hn.push("M",zt,",",Ht),lr!=null&&Hn.push("A",qe,",",qe," 0 ",Kn,",",Pt," ",lr,",",br),Hn.push("L",zr,",",Or),tn!=null&&Hn.push("A",Ce,",",Ce," 0 ",Kr,",",1-Pt," ",tn,",",en);return Hn.push("Z"),Hn.join("")}function Ae(Ce,qe){return"M0,"+Ce+"A"+Ce+","+Ce+" 0 1,"+qe+" 0,"+-Ce+"A"+Ce+","+Ce+" 0 1,"+qe+" 0,"+Ce}return be.innerRadius=function(Ce){return arguments.length?(ue=_r(Ce),be):ue},be.outerRadius=function(Ce){return arguments.length?(C=_r(Ce),be):C},be.cornerRadius=function(Ce){return arguments.length?(R=_r(Ce),be):R},be.padRadius=function(Ce){return arguments.length?(F=Ce==Ri?Ri:_r(Ce),be):F},be.startAngle=function(Ce){return arguments.length?(q=_r(Ce),be):q},be.endAngle=function(Ce){return arguments.length?(ae=_r(Ce),be):ae},be.padAngle=function(Ce){return arguments.length?(he=_r(Ce),be):he},be.centroid=function(){var Ce=(+ue.apply(this,arguments)+ +C.apply(this,arguments))/2,qe=(+q.apply(this,arguments)+ +ae.apply(this,arguments))/2-Zt;return[Math.cos(qe)*Ce,Math.sin(qe)*Ce]},be};var Ri="auto";function Ci(ue){return ue.innerRadius}function gi(ue){return ue.outerRadius}function Fi(ue){return ue.startAngle}function Ei(ue){return ue.endAngle}function na(ue){return ue&&ue.padAngle}function ai(ue,C,R,F){return(ue-R)*C-(C-F)*ue>0?0:1}function Ki(ue,C,R,F,q){var ae=ue[0]-C[0],he=ue[1]-C[1],be=(q?F:-F)/Math.sqrt(ae*ae+he*he),Ae=be*he,Ce=-be*ae,qe=ue[0]+Ae,et=ue[1]+Ce,st=C[0]+Ae,kt=C[1]+Ce,Pt=(qe+st)/2,Et=(et+kt)/2,Lt=st-qe,Tt=kt-et,Bt=Lt*Lt+Tt*Tt,zt=R-F,Ht=qe*kt-st*et,lr=(Tt<0?-1:1)*Math.sqrt(Math.max(0,zt*zt*Bt-Ht*Ht)),br=(Ht*Tt-Lt*lr)/Bt,zr=(-Ht*Lt-Tt*lr)/Bt,Or=(Ht*Tt+Lt*lr)/Bt,tn=(-Ht*Lt+Tt*lr)/Bt,en=br-Pt,vn=zr-Et,hn=Or-Pt,Hn=tn-Et;return en*en+vn*vn>hn*hn+Hn*Hn&&(br=Or,zr=tn),[[br-Ae,zr-Ce],[br*R/zt,zr*R/zt]]}function Ya(){return!0}function is(ue){var C=Hr,R=ln,F=Ya,q=Mo,ae=q.key,he=.7;function be(Ae){var Ce,qe=[],et=[],st=-1,kt=Ae.length,Pt=_r(C),Et=_r(R);function Lt(){qe.push("M",q(ue(et),he))}for(;++st<kt;)F.call(this,Ce=Ae[st],st)?et.push([+Pt.call(this,Ce,st),+Et.call(this,Ce,st)]):et.length&&(Lt(),et=[]);return et.length&&Lt(),qe.length?qe.join(""):null}return be.x=function(Ae){return arguments.length?(C=Ae,be):C},be.y=function(Ae){return arguments.length?(R=Ae,be):R},be.defined=function(Ae){return arguments.length?(F=Ae,be):F},be.interpolate=function(Ae){return arguments.length?(ae=typeof Ae=="function"?q=Ae:(q=Ho.get(Ae)||Mo).key,be):ae},be.tension=function(Ae){return arguments.length?(he=Ae,be):he},be}d.svg.line=function(){return is(E)};var Ho=d.map({linear:Mo,"linear-closed":xi,step:function(ue){for(var C=0,R=ue.length,F=ue[0],q=[F[0],",",F[1]];++C<R;)q.push("H",(F[0]+(F=ue[C])[0])/2,"V",F[1]);return R>1&&q.push("H",F[0]),q.join("")},"step-before":xa,"step-after":Ao,basis:$a,"basis-open":function(ue){if(ue.length<4)return Mo(ue);for(var C,R=[],F=-1,q=ue.length,ae=[0],he=[0];++F<3;)C=ue[F],ae.push(C[0]),he.push(C[1]);for(R.push(aa(co,ae)+","+aa(co,he)),--F;++F<q;)C=ue[F],ae.shift(),ae.push(C[0]),he.shift(),he.push(C[1]),bs(R,ae,he);return R.join("")},"basis-closed":function(ue){for(var C,R,F=-1,q=ue.length,ae=q+4,he=[],be=[];++F<4;)R=ue[F%q],he.push(R[0]),be.push(R[1]);for(C=[aa(co,he),",",aa(co,be)],--F;++F<ae;)R=ue[F%q],he.shift(),he.push(R[0]),be.shift(),be.push(R[1]),bs(C,he,be);return C.join("")},bundle:function(ue,C){var R=ue.length-1;if(R)for(var F,q,ae=ue[0][0],he=ue[0][1],be=ue[R][0]-ae,Ae=ue[R][1]-he,Ce=-1;++Ce<=R;)F=ue[Ce],q=Ce/R,F[0]=C*F[0]+(1-C)*(ae+q*be),F[1]=C*F[1]+(1-C)*(he+q*Ae);return $a(ue)},cardinal:function(ue,C){return ue.length<3?Mo(ue):ue[0]+Ji(ue,La(ue,C))},"cardinal-open":function(ue,C){return ue.length<4?Mo(ue):ue[1]+Ji(ue.slice(1,-1),La(ue,C))},"cardinal-closed":function(ue,C){return ue.length<3?xi(ue):ue[0]+Ji((ue.push(ue[0]),ue),La([ue[ue.length-2]].concat(ue,[ue[1]]),C))},monotone:function(ue){return ue.length<3?Mo(ue):ue[0]+Ji(ue,function(C){for(var R,F,q,ae,he=[],be=function(qe){for(var et=0,st=qe.length-1,kt=[],Pt=qe[0],Et=qe[1],Lt=kt[0]=ps(Pt,Et);++et<st;)kt[et]=(Lt+(Lt=ps(Pt=Et,Et=qe[et+1])))/2;return kt[et]=Lt,kt}(C),Ae=-1,Ce=C.length-1;++Ae<Ce;)R=ps(C[Ae],C[Ae+1]),i(R)<vt?be[Ae]=be[Ae+1]=0:(F=be[Ae]/R,q=be[Ae+1]/R,(ae=F*F+q*q)>9&&(ae=3*R/Math.sqrt(ae),be[Ae]=ae*F,be[Ae+1]=ae*q));for(Ae=-1;++Ae<=Ce;)ae=(C[Math.min(Ce,Ae+1)][0]-C[Math.max(0,Ae-1)][0])/(6*(1+be[Ae]*be[Ae])),he.push([ae||0,be[Ae]*ae||0]);return he}(ue))}});function Mo(ue){return ue.length>1?ue.join("L"):ue+"Z"}function xi(ue){return ue.join("L")+"Z"}function xa(ue){for(var C=0,R=ue.length,F=ue[0],q=[F[0],",",F[1]];++C<R;)q.push("V",(F=ue[C])[1],"H",F[0]);return q.join("")}function Ao(ue){for(var C=0,R=ue.length,F=ue[0],q=[F[0],",",F[1]];++C<R;)q.push("H",(F=ue[C])[0],"V",F[1]);return q.join("")}function Ji(ue,C){if(C.length<1||ue.length!=C.length&&ue.length!=C.length+2)return Mo(ue);var R=ue.length!=C.length,F="",q=ue[0],ae=ue[1],he=C[0],be=he,Ae=1;if(R&&(F+="Q"+(ae[0]-2*he[0]/3)+","+(ae[1]-2*he[1]/3)+","+ae[0]+","+ae[1],q=ue[1],Ae=2),C.length>1){be=C[1],ae=ue[Ae],Ae++,F+="C"+(q[0]+he[0])+","+(q[1]+he[1])+","+(ae[0]-be[0])+","+(ae[1]-be[1])+","+ae[0]+","+ae[1];for(var Ce=2;Ce<C.length;Ce++,Ae++)ae=ue[Ae],be=C[Ce],F+="S"+(ae[0]-be[0])+","+(ae[1]-be[1])+","+ae[0]+","+ae[1]}if(R){var qe=ue[Ae];F+="Q"+(ae[0]+2*be[0]/3)+","+(ae[1]+2*be[1]/3)+","+qe[0]+","+qe[1]}return F}function La(ue,C){for(var R,F=[],q=(1-C)/2,ae=ue[0],he=ue[1],be=1,Ae=ue.length;++be<Ae;)R=ae,ae=he,he=ue[be],F.push([q*(he[0]-R[0]),q*(he[1]-R[1])]);return F}function $a(ue){if(ue.length<3)return Mo(ue);var C=1,R=ue.length,F=ue[0],q=F[0],ae=F[1],he=[q,q,q,(F=ue[1])[0]],be=[ae,ae,ae,F[1]],Ae=[q,",",ae,"L",aa(co,he),",",aa(co,be)];for(ue.push(ue[R-1]);++C<=R;)F=ue[C],he.shift(),he.push(F[0]),be.shift(),be.push(F[1]),bs(Ae,he,be);return ue.pop(),Ae.push("L",F),Ae.join("")}function aa(ue,C){return ue[0]*C[0]+ue[1]*C[1]+ue[2]*C[2]+ue[3]*C[3]}Ho.forEach(function(ue,C){C.key=ue,C.closed=/-closed$/.test(ue)});var bo=[0,2/3,1/3,0],oa=[0,1/3,2/3,0],co=[0,1/6,2/3,1/6];function bs(ue,C,R){ue.push("C",aa(bo,C),",",aa(bo,R),",",aa(oa,C),",",aa(oa,R),",",aa(co,C),",",aa(co,R))}function ps(ue,C){return(C[1]-ue[1])/(C[0]-ue[0])}function ol(ue){for(var C,R,F,q=-1,ae=ue.length;++q<ae;)R=(C=ue[q])[0],F=C[1]-Zt,C[0]=R*Math.cos(F),C[1]=R*Math.sin(F);return ue}function Ua(ue){var C=Hr,R=Hr,F=0,q=ln,ae=Ya,he=Mo,be=he.key,Ae=he,Ce="L",qe=.7;function et(st){var kt,Pt,Et,Lt=[],Tt=[],Bt=[],zt=-1,Ht=st.length,lr=_r(C),br=_r(F),zr=C===R?function(){return Pt}:_r(R),Or=F===q?function(){return Et}:_r(q);function tn(){Lt.push("M",he(ue(Bt),qe),Ce,Ae(ue(Tt.reverse()),qe),"Z")}for(;++zt<Ht;)ae.call(this,kt=st[zt],zt)?(Tt.push([Pt=+lr.call(this,kt,zt),Et=+br.call(this,kt,zt)]),Bt.push([+zr.call(this,kt,zt),+Or.call(this,kt,zt)])):Tt.length&&(tn(),Tt=[],Bt=[]);return Tt.length&&tn(),Lt.length?Lt.join(""):null}return et.x=function(st){return arguments.length?(C=R=st,et):R},et.x0=function(st){return arguments.length?(C=st,et):C},et.x1=function(st){return arguments.length?(R=st,et):R},et.y=function(st){return arguments.length?(F=q=st,et):q},et.y0=function(st){return arguments.length?(F=st,et):F},et.y1=function(st){return arguments.length?(q=st,et):q},et.defined=function(st){return arguments.length?(ae=st,et):ae},et.interpolate=function(st){return arguments.length?(be=typeof st=="function"?he=st:(he=Ho.get(st)||Mo).key,Ae=he.reverse||he,Ce=he.closed?"M":"L",et):be},et.tension=function(st){return arguments.length?(qe=st,et):qe},et}function sl(ue){return ue.source}function Va(ue){return ue.target}function ds(ue){return ue.radius}function fi(ue){return[ue.x,ue.y]}function bi(ue){return function(){var C=ue.apply(this,arguments),R=C[0],F=C[1]-Zt;return[R*Math.cos(F),R*Math.sin(F)]}}function ll(){return 64}function cl(){return"circle"}function ms(ue){var C=Math.sqrt(ue/jt);return"M0,"+C+"A"+C+","+C+" 0 1,1 0,"+-C+"A"+C+","+C+" 0 1,1 0,"+C+"Z"}d.svg.line.radial=function(){var ue=is(ol);return ue.radius=ue.x,delete ue.x,ue.angle=ue.y,delete ue.y,ue},xa.reverse=Ao,Ao.reverse=xa,d.svg.area=function(){return Ua(E)},d.svg.area.radial=function(){var ue=Ua(ol);return ue.radius=ue.x,delete ue.x,ue.innerRadius=ue.x0,delete ue.x0,ue.outerRadius=ue.x1,delete ue.x1,ue.angle=ue.y,delete ue.y,ue.startAngle=ue.y0,delete ue.y0,ue.endAngle=ue.y1,delete ue.y1,ue},d.svg.chord=function(){var ue=sl,C=Va,R=ds,F=Fi,q=Ei;function ae(Ce,qe){var et,st,kt=he(this,ue,Ce,qe),Pt=he(this,C,Ce,qe);return"M"+kt.p0+be(kt.r,kt.p1,kt.a1-kt.a0)+(st=Pt,((et=kt).a0==st.a0&&et.a1==st.a1?Ae(kt.r,kt.p1,kt.r,kt.p0):Ae(kt.r,kt.p1,Pt.r,Pt.p0)+be(Pt.r,Pt.p1,Pt.a1-Pt.a0)+Ae(Pt.r,Pt.p1,kt.r,kt.p0))+"Z")}function he(Ce,qe,et,st){var kt=qe.call(Ce,et,st),Pt=R.call(Ce,kt,st),Et=F.call(Ce,kt,st)-Zt,Lt=q.call(Ce,kt,st)-Zt;return{r:Pt,a0:Et,a1:Lt,p0:[Pt*Math.cos(Et),Pt*Math.sin(Et)],p1:[Pt*Math.cos(Lt),Pt*Math.sin(Lt)]}}function be(Ce,qe,et){return"A"+Ce+","+Ce+" 0 "+ +(et>jt)+",1 "+qe}function Ae(Ce,qe,et,st){return"Q 0,0 "+st}return ae.radius=function(Ce){return arguments.length?(R=_r(Ce),ae):R},ae.source=function(Ce){return arguments.length?(ue=_r(Ce),ae):ue},ae.target=function(Ce){return arguments.length?(C=_r(Ce),ae):C},ae.startAngle=function(Ce){return arguments.length?(F=_r(Ce),ae):F},ae.endAngle=function(Ce){return arguments.length?(q=_r(Ce),ae):q},ae},d.svg.diagonal=function(){var ue=sl,C=Va,R=fi;function F(q,ae){var he=ue.call(this,q,ae),be=C.call(this,q,ae),Ae=(he.y+be.y)/2,Ce=[he,{x:he.x,y:Ae},{x:be.x,y:Ae},be];return"M"+(Ce=Ce.map(R))[0]+"C"+Ce[1]+" "+Ce[2]+" "+Ce[3]}return F.source=function(q){return arguments.length?(ue=_r(q),F):ue},F.target=function(q){return arguments.length?(C=_r(q),F):C},F.projection=function(q){return arguments.length?(R=q,F):R},F},d.svg.diagonal.radial=function(){var ue=d.svg.diagonal(),C=fi,R=ue.projection;return ue.projection=function(F){return arguments.length?R(bi(C=F)):C},ue},d.svg.symbol=function(){var ue=cl,C=ll;function R(F,q){return(No.get(ue.call(this,F,q))||ms)(C.call(this,F,q))}return R.type=function(F){return arguments.length?(ue=_r(F),R):ue},R.size=function(F){return arguments.length?(C=_r(F),R):C},R};var No=d.map({circle:ms,cross:function(ue){var C=Math.sqrt(ue/5)/2;return"M"+-3*C+","+-C+"H"+-C+"V"+-3*C+"H"+C+"V"+-C+"H"+3*C+"V"+C+"H"+C+"V"+3*C+"H"+-C+"V"+C+"H"+-3*C+"Z"},diamond:function(ue){var C=Math.sqrt(ue/(2*Dl)),R=C*Dl;return"M0,"+-C+"L"+R+",0 0,"+C+" "+-R+",0Z"},square:function(ue){var C=Math.sqrt(ue)/2;return"M"+-C+","+-C+"L"+C+","+-C+" "+C+","+C+" "+-C+","+C+"Z"},"triangle-down":function(ue){var C=Math.sqrt(ue/Qo),R=C*Qo/2;return"M0,"+R+"L"+C+","+-R+" "+-C+","+-R+"Z"},"triangle-up":function(ue){var C=Math.sqrt(ue/Qo),R=C*Qo/2;return"M0,"+-R+"L"+C+","+R+" "+-C+","+R+"Z"}});d.svg.symbolTypes=No.keys();var Qo=Math.sqrt(3),Dl=Math.tan(30*cr);J.transition=function(ue){for(var C,R,F=Ls||++Cs,q=Ys(ue),ae=[],he=_s||{time:Date.now(),ease:zs,delay:0,duration:250},be=-1,Ae=this.length;++be<Ae;){ae.push(C=[]);for(var Ce=this[be],qe=-1,et=Ce.length;++qe<et;)(R=Ce[qe])&&ws(R,qe,q,F,he),C.push(R)}return sa(ae,q,F)},J.interrupt=function(ue){return this.each(ue==null?qs:$i(Ys(ue)))};var qs=$i(Ys());function $i(ue){return function(){var C,R,F;(C=this[ue])&&(F=C[R=C.active])&&(F.timer.c=null,F.timer.t=NaN,--C.count?delete C[R]:delete this[ue],C.active+=.5,F.event&&F.event.interrupt.call(this,this.__data__,F.index))}}function sa(ue,C,R){return N(ue,Fa),ue.namespace=C,ue.id=R,ue}var Ls,_s,Fa=[],Cs=0;function Gs(ue,C,R,F){var q=ue.id,ae=ue.namespace;return De(ue,typeof R=="function"?function(he,be,Ae){he[ae][q].tween.set(C,F(R.call(he,he.__data__,be,Ae)))}:(R=F(R),function(he){he[ae][q].tween.set(C,R)}))}function Rs(ue){return ue==null&&(ue=""),function(){this.textContent=ue}}function Ys(ue){return ue==null?"__transition__":"__transition_"+ue+"__"}function ws(ue,C,R,F,q){var ae,he,be,Ae,Ce,qe=ue[R]||(ue[R]={active:0,count:0}),et=qe[F];function st(Pt){var Et=qe.active,Lt=qe[Et];for(var Tt in Lt&&(Lt.timer.c=null,Lt.timer.t=NaN,--qe.count,delete qe[Et],Lt.event&&Lt.event.interrupt.call(ue,ue.__data__,Lt.index)),qe)if(+Tt<F){var Bt=qe[Tt];Bt.timer.c=null,Bt.timer.t=NaN,--qe.count,delete qe[Tt]}he.c=kt,on(function(){return he.c&&kt(Pt||1)&&(he.c=null,he.t=NaN),1},0,ae),qe.active=F,et.event&&et.event.start.call(ue,ue.__data__,C),Ce=[],et.tween.forEach(function(zt,Ht){(Ht=Ht.call(ue,ue.__data__,C))&&Ce.push(Ht)}),Ae=et.ease,be=et.duration}function kt(Pt){for(var Et=Pt/be,Lt=Ae(Et),Tt=Ce.length;Tt>0;)Ce[--Tt].call(ue,Lt);if(Et>=1)return et.event&&et.event.end.call(ue,ue.__data__,C),--qe.count?delete qe[F]:delete ue[R],1}et||(ae=q.time,he=on(function(Pt){var Et=et.delay;if(he.t=Et+ae,Et<=Pt)return st(Pt-Et);he.c=st},0,ae),et=qe[F]={tween:new _,time:ae,timer:he,delay:q.delay,duration:q.duration,ease:q.ease,index:C},q=null,++qe.count)}Fa.call=J.call,Fa.empty=J.empty,Fa.node=J.node,Fa.size=J.size,d.transition=function(ue,C){return ue&&ue.transition?Ls?ue.transition(C):ue:d.selection().transition(ue)},d.transition.prototype=Fa,Fa.select=function(ue){var C,R,F,q=this.id,ae=this.namespace,he=[];ue=ee(ue);for(var be=-1,Ae=this.length;++be<Ae;){he.push(C=[]);for(var Ce=this[be],qe=-1,et=Ce.length;++qe<et;)(F=Ce[qe])&&(R=ue.call(F,F.__data__,qe,be))?("__data__"in F&&(R.__data__=F.__data__),ws(R,qe,ae,q,F[ae][q]),C.push(R)):C.push(null)}return sa(he,ae,q)},Fa.selectAll=function(ue){var C,R,F,q,ae,he=this.id,be=this.namespace,Ae=[];ue=ne(ue);for(var Ce=-1,qe=this.length;++Ce<qe;)for(var et=this[Ce],st=-1,kt=et.length;++st<kt;)if(F=et[st]){ae=F[be][he],R=ue.call(F,F.__data__,st,Ce),Ae.push(C=[]);for(var Pt=-1,Et=R.length;++Pt<Et;)(q=R[Pt])&&ws(q,Pt,be,he,ae),C.push(q)}return sa(Ae,be,he)},Fa.filter=function(ue){var C,R,F=[];typeof ue!="function"&&(ue=de(ue));for(var q=0,ae=this.length;q<ae;q++){F.push(C=[]);for(var he,be=0,Ae=(he=this[q]).length;be<Ae;be++)(R=he[be])&&ue.call(R,R.__data__,be,q)&&C.push(R)}return sa(F,this.namespace,this.id)},Fa.tween=function(ue,C){var R=this.id,F=this.namespace;return arguments.length<2?this.node()[F][R].tween.get(ue):De(this,C==null?function(q){q[F][R].tween.remove(ue)}:function(q){q[F][R].tween.set(ue,C)})},Fa.attr=function(ue,C){if(arguments.length<2){for(C in ue)this.attr(C,ue[C]);return this}var R=ue=="transform"?$o:qa,F=d.ns.qualify(ue);function q(){this.removeAttribute(F)}function ae(){this.removeAttributeNS(F.space,F.local)}function he(Ae){return Ae==null?q:(Ae+="",function(){var Ce,qe=this.getAttribute(F);return qe!==Ae&&(Ce=R(qe,Ae),function(et){this.setAttribute(F,Ce(et))})})}function be(Ae){return Ae==null?ae:(Ae+="",function(){var Ce,qe=this.getAttributeNS(F.space,F.local);return qe!==Ae&&(Ce=R(qe,Ae),function(et){this.setAttributeNS(F.space,F.local,Ce(et))})})}return Gs(this,"attr."+ue,C,F.local?be:he)},Fa.attrTween=function(ue,C){var R=d.ns.qualify(ue);return this.tween("attr."+ue,R.local?function(F,q){var ae=C.call(this,F,q,this.getAttributeNS(R.space,R.local));return ae&&function(he){this.setAttributeNS(R.space,R.local,ae(he))}}:function(F,q){var ae=C.call(this,F,q,this.getAttribute(R));return ae&&function(he){this.setAttribute(R,ae(he))}})},Fa.style=function(ue,C,R){var F=arguments.length;if(F<3){if(typeof ue!="string"){for(R in F<2&&(C=""),ue)this.style(R,ue[R],C);return this}R=""}function q(){this.style.removeProperty(ue)}function ae(he){return he==null?q:(he+="",function(){var be,Ae=t(this).getComputedStyle(this,null).getPropertyValue(ue);return Ae!==he&&(be=qa(Ae,he),function(Ce){this.style.setProperty(ue,be(Ce),R)})})}return Gs(this,"style."+ue,C,ae)},Fa.styleTween=function(ue,C,R){function F(q,ae){var he=C.call(this,q,ae,t(this).getComputedStyle(this,null).getPropertyValue(ue));return he&&function(be){this.style.setProperty(ue,he(be),R)}}return arguments.length<3&&(R=""),this.tween("style."+ue,F)},Fa.text=function(ue){return Gs(this,"text",ue,Rs)},Fa.remove=function(){var ue=this.namespace;return this.each("end.transition",function(){var C;this[ue].count<2&&(C=this.parentNode)&&C.removeChild(this)})},Fa.ease=function(ue){var C=this.id,R=this.namespace;return arguments.length<1?this.node()[R][C].ease:(typeof ue!="function"&&(ue=d.ease.apply(d,arguments)),De(this,function(F){F[R][C].ease=ue}))},Fa.delay=function(ue){var C=this.id,R=this.namespace;return arguments.length<1?this.node()[R][C].delay:De(this,typeof ue=="function"?function(F,q,ae){F[R][C].delay=+ue.call(F,F.__data__,q,ae)}:(ue=+ue,function(F){F[R][C].delay=ue}))},Fa.duration=function(ue){var C=this.id,R=this.namespace;return arguments.length<1?this.node()[R][C].duration:De(this,typeof ue=="function"?function(F,q,ae){F[R][C].duration=Math.max(1,ue.call(F,F.__data__,q,ae))}:(ue=Math.max(1,ue),function(F){F[R][C].duration=ue}))},Fa.each=function(ue,C){var R=this.id,F=this.namespace;if(arguments.length<2){var q=_s,ae=Ls;try{Ls=R,De(this,function(he,be,Ae){_s=he[F][R],ue.call(he,he.__data__,be,Ae)})}finally{_s=q,Ls=ae}}else De(this,function(he){var be=he[F][R];(be.event||(be.event=d.dispatch("start","end","interrupt"))).on(ue,C)});return this},Fa.transition=function(){for(var ue,C,R,F=this.id,q=++Cs,ae=this.namespace,he=[],be=0,Ae=this.length;be<Ae;be++){he.push(ue=[]);for(var Ce,qe=0,et=(Ce=this[be]).length;qe<et;qe++)(C=Ce[qe])&&ws(C,qe,ae,q,{time:(R=C[ae][F]).time,ease:R.ease,delay:R.delay+R.duration,duration:R.duration}),ue.push(C)}return sa(he,ae,q)},d.svg.axis=function(){var ue,C=d.scale.linear(),R=zl,F=6,q=6,ae=3,he=[10],be=null;function Ae(Ce){Ce.each(function(){var qe,et=d.select(this),st=this.__chart__||C,kt=this.__chart__=C.copy(),Pt=be==null?kt.ticks?kt.ticks.apply(kt,he):kt.domain():be,Et=ue==null?kt.tickFormat?kt.tickFormat.apply(kt,he):E:ue,Lt=et.selectAll(".tick").data(Pt,kt),Tt=Lt.enter().insert("g",".domain").attr("class","tick").style("opacity",vt),Bt=d.transition(Lt.exit()).style("opacity",vt).remove(),zt=d.transition(Lt.order()).style("opacity",1),Ht=Math.max(F,0)+ae,lr=dn(kt),br=et.selectAll(".domain").data([0]),zr=(br.enter().append("path").attr("class","domain"),d.transition(br));Tt.append("line"),Tt.append("text");var Or,tn,en,vn,hn=Tt.select("line"),Hn=zt.select("line"),Kn=Lt.select("text").text(Et),hi=Tt.select("text"),Kr=zt.select("text"),Ln=R==="top"||R==="left"?-1:1;if(R==="bottom"||R==="top"?(qe=Ps,Or="x",en="y",tn="x2",vn="y2",Kn.attr("dy",Ln<0?"0em":".71em").style("text-anchor","middle"),zr.attr("d","M"+lr[0]+","+Ln*q+"V0H"+lr[1]+"V"+Ln*q)):(qe=Rl,Or="y",en="x",tn="y2",vn="x2",Kn.attr("dy",".32em").style("text-anchor",Ln<0?"end":"start"),zr.attr("d","M"+Ln*q+","+lr[0]+"H0V"+lr[1]+"H"+Ln*q)),hn.attr(vn,Ln*F),hi.attr(en,Ln*Ht),Hn.attr(tn,0).attr(vn,Ln*F),Kr.attr(Or,0).attr(en,Ln*Ht),kt.rangeBand){var Jn=kt,Wn=Jn.rangeBand()/2;st=kt=function(oi){return Jn(oi)+Wn}}else st.rangeBand?st=kt:Bt.call(qe,kt,st);Tt.call(qe,st,kt),zt.call(qe,kt,kt)})}return Ae.scale=function(Ce){return arguments.length?(C=Ce,Ae):C},Ae.orient=function(Ce){return arguments.length?(R=Ce in Jl?Ce+"":zl,Ae):R},Ae.ticks=function(){return arguments.length?(he=w(arguments),Ae):he},Ae.tickValues=function(Ce){return arguments.length?(be=Ce,Ae):be},Ae.tickFormat=function(Ce){return arguments.length?(ue=Ce,Ae):ue},Ae.tickSize=function(Ce){var qe=arguments.length;return qe?(F=+Ce,q=+arguments[qe-1],Ae):F},Ae.innerTickSize=function(Ce){return arguments.length?(F=+Ce,Ae):F},Ae.outerTickSize=function(Ce){return arguments.length?(q=+Ce,Ae):q},Ae.tickPadding=function(Ce){return arguments.length?(ae=+Ce,Ae):ae},Ae.tickSubdivide=function(){return arguments.length&&Ae},Ae};var zl="bottom",Jl={top:1,right:1,bottom:1,left:1};function Ps(ue,C,R){ue.attr("transform",function(F){var q=C(F);return"translate("+(isFinite(q)?q:R(F))+",0)"})}function Rl(ue,C,R){ue.attr("transform",function(F){var q=C(F);return"translate(0,"+(isFinite(q)?q:R(F))+")"})}d.svg.brush=function(){var ue,C,R=re(qe,"brushstart","brush","brushend"),F=null,q=null,ae=[0,0],he=[0,0],be=!0,Ae=!0,Ce=uo[0];function qe(Et){Et.each(function(){var Lt=d.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",Pt).on("touchstart.brush",Pt),Tt=Lt.selectAll(".background").data([0]);Tt.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),Lt.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var Bt=Lt.selectAll(".resize").data(Ce,E);Bt.exit().remove(),Bt.enter().append("g").attr("class",function(br){return"resize "+br}).style("cursor",function(br){return Ws[br]}).append("rect").attr("x",function(br){return/[ew]$/.test(br)?-3:null}).attr("y",function(br){return/^[ns]/.test(br)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),Bt.style("display",qe.empty()?"none":null);var zt,Ht=d.transition(Lt),lr=d.transition(Tt);F&&(zt=dn(F),lr.attr("x",zt[0]).attr("width",zt[1]-zt[0]),st(Ht)),q&&(zt=dn(q),lr.attr("y",zt[0]).attr("height",zt[1]-zt[0]),kt(Ht)),et(Ht)})}function et(Et){Et.selectAll(".resize").attr("transform",function(Lt){return"translate("+ae[+/e$/.test(Lt)]+","+he[+/^s/.test(Lt)]+")"})}function st(Et){Et.select(".extent").attr("x",ae[0]),Et.selectAll(".extent,.n>rect,.s>rect").attr("width",ae[1]-ae[0])}function kt(Et){Et.select(".extent").attr("y",he[0]),Et.selectAll(".extent,.e>rect,.w>rect").attr("height",he[1]-he[0])}function Pt(){var Et,Lt,Tt=this,Bt=d.select(d.event.target),zt=R.of(Tt,arguments),Ht=d.select(Tt),lr=Bt.datum(),br=!/^(n|s)$/.test(lr)&&F,zr=!/^(e|w)$/.test(lr)&&q,Or=Bt.classed("extent"),tn=xt(Tt),en=d.mouse(Tt),vn=d.select(t(Tt)).on("keydown.brush",Kn).on("keyup.brush",hi);if(d.event.changedTouches?vn.on("touchmove.brush",Kr).on("touchend.brush",Jn):vn.on("mousemove.brush",Kr).on("mouseup.brush",Jn),Ht.interrupt().selectAll("*").interrupt(),Or)en[0]=ae[0]-en[0],en[1]=he[0]-en[1];else if(lr){var hn=+/w$/.test(lr),Hn=+/^n/.test(lr);Lt=[ae[1-hn]-en[0],he[1-Hn]-en[1]],en[0]=ae[hn],en[1]=he[Hn]}else d.event.altKey&&(Et=en.slice());function Kn(){d.event.keyCode==32&&(Or||(Et=null,en[0]-=ae[1],en[1]-=he[1],Or=2),X())}function hi(){d.event.keyCode==32&&Or==2&&(en[0]+=ae[1],en[1]+=he[1],Or=0,X())}function Kr(){var Wn=d.mouse(Tt),oi=!1;Lt&&(Wn[0]+=Lt[0],Wn[1]+=Lt[1]),Or||(d.event.altKey?(Et||(Et=[(ae[0]+ae[1])/2,(he[0]+he[1])/2]),en[0]=ae[+(Wn[0]<Et[0])],en[1]=he[+(Wn[1]<Et[1])]):Et=null),br&&Ln(Wn,F,0)&&(st(Ht),oi=!0),zr&&Ln(Wn,q,1)&&(kt(Ht),oi=!0),oi&&(et(Ht),zt({type:"brush",mode:Or?"move":"resize"}))}function Ln(Wn,oi,di){var Li,ri,_i=dn(oi),yi=_i[0],Ii=_i[1],wi=en[di],Oi=di?he:ae,Hi=Oi[1]-Oi[0];if(Or&&(yi-=wi,Ii-=Hi+wi),Li=(di?Ae:be)?Math.max(yi,Math.min(Ii,Wn[di])):Wn[di],Or?ri=(Li+=wi)+Hi:(Et&&(wi=Math.max(yi,Math.min(Ii,2*Et[di]-Li))),wi<Li?(ri=Li,Li=wi):ri=wi),Oi[0]!=Li||Oi[1]!=ri)return di?C=null:ue=null,Oi[0]=Li,Oi[1]=ri,!0}function Jn(){Kr(),Ht.style("pointer-events","all").selectAll(".resize").style("display",qe.empty()?"none":null),d.select("body").style("cursor",null),vn.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),tn(),zt({type:"brushend"})}Ht.style("pointer-events","none").selectAll(".resize").style("display",null),d.select("body").style("cursor",Bt.style("cursor")),zt({type:"brushstart"}),Kr()}return qe.event=function(Et){Et.each(function(){var Lt=R.of(this,arguments),Tt={x:ae,y:he,i:ue,j:C},Bt=this.__chart__||Tt;this.__chart__=Tt,Ls?d.select(this).transition().each("start.brush",function(){ue=Bt.i,C=Bt.j,ae=Bt.x,he=Bt.y,Lt({type:"brushstart"})}).tween("brush:brush",function(){var zt=ya(ae,Tt.x),Ht=ya(he,Tt.y);return ue=C=null,function(lr){ae=Tt.x=zt(lr),he=Tt.y=Ht(lr),Lt({type:"brush",mode:"resize"})}}).each("end.brush",function(){ue=Tt.i,C=Tt.j,Lt({type:"brush",mode:"resize"}),Lt({type:"brushend"})}):(Lt({type:"brushstart"}),Lt({type:"brush",mode:"resize"}),Lt({type:"brushend"}))})},qe.x=function(Et){return arguments.length?(Ce=uo[!(F=Et)<<1|!q],qe):F},qe.y=function(Et){return arguments.length?(Ce=uo[!F<<1|!(q=Et)],qe):q},qe.clamp=function(Et){return arguments.length?(F&&q?(be=!!Et[0],Ae=!!Et[1]):F?be=!!Et:q&&(Ae=!!Et),qe):F&&q?[be,Ae]:F?be:q?Ae:null},qe.extent=function(Et){var Lt,Tt,Bt,zt,Ht;return arguments.length?(F&&(Lt=Et[0],Tt=Et[1],q&&(Lt=Lt[0],Tt=Tt[0]),ue=[Lt,Tt],F.invert&&(Lt=F(Lt),Tt=F(Tt)),Tt<Lt&&(Ht=Lt,Lt=Tt,Tt=Ht),Lt==ae[0]&&Tt==ae[1]||(ae=[Lt,Tt])),q&&(Bt=Et[0],zt=Et[1],F&&(Bt=Bt[1],zt=zt[1]),C=[Bt,zt],q.invert&&(Bt=q(Bt),zt=q(zt)),zt<Bt&&(Ht=Bt,Bt=zt,zt=Ht),Bt==he[0]&&zt==he[1]||(he=[Bt,zt])),qe):(F&&(ue?(Lt=ue[0],Tt=ue[1]):(Lt=ae[0],Tt=ae[1],F.invert&&(Lt=F.invert(Lt),Tt=F.invert(Tt)),Tt<Lt&&(Ht=Lt,Lt=Tt,Tt=Ht))),q&&(C?(Bt=C[0],zt=C[1]):(Bt=he[0],zt=he[1],q.invert&&(Bt=q.invert(Bt),zt=q.invert(zt)),zt<Bt&&(Ht=Bt,Bt=zt,zt=Ht))),F&&q?[[Lt,Bt],[Tt,zt]]:F?[Lt,Tt]:q&&[Bt,zt])},qe.clear=function(){return qe.empty()||(ae=[0,0],he=[0,0],ue=C=null),qe},qe.empty=function(){return!!F&&ae[0]==ae[1]||!!q&&he[0]==he[1]},d.rebind(qe,R,"on")};var Ws={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},uo=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];function $l(ue){return JSON.parse(ue.responseText)}function Ql(ue){var C=y.createRange();return C.selectNode(y.body),C.createContextualFragment(ue.responseText)}d.text=Ir(function(ue){return ue.responseText}),d.json=function(ue,C){return Rr(ue,"application/json",$l,C)},d.html=function(ue,C){return Rr(ue,"text/html",Ql,C)},d.xml=Ir(function(ue){return ue.responseXML}),typeof G=="object"&&G.exports?G.exports=d:this.d3=d}).apply(self)},{}],59:[function(m,G,Y){G.exports=m("./quad")},{"./quad":60}],60:[function(m,G,Y){var d=m("binary-search-bounds"),v=m("clamp"),w=m("parse-rect"),y=m("array-bounds"),e=m("pick-by-alias"),t=m("defined"),n=m("flatten-vertex-data"),o=m("is-obj"),r=m("dtype"),g=m("math-log2");function c(a,h){for(var l=h[0],s=h[1],p=1/(h[2]-l),u=1/(h[3]-s),i=new Array(a.length),x=0,f=a.length/2;x<f;x++)i[2*x]=v((a[2*x]-l)*p,0,1),i[2*x+1]=v((a[2*x+1]-s)*u,0,1);return i}G.exports=function(a,h){h||(h={}),a=n(a,"float64"),h=e(h,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var l=t(h.maxDepth,255),s=t(h.bounds,y(a,2));s[0]===s[2]&&s[2]++,s[1]===s[3]&&s[3]++;var p,u=c(a,s),i=a.length>>>1;h.dtype||(h.dtype="array"),typeof h.dtype=="string"?p=new(r(h.dtype))(i):h.dtype&&(p=h.dtype,Array.isArray(p)&&(p.length=i));for(var x=0;x<i;++x)p[x]=x;var f=[],_=[],b=[],T=[];(function D(j,V,Z,Q,X,$){if(!Q.length)return null;var re=f[X]||(f[X]=[]),H=b[X]||(b[X]=[]),N=_[X]||(_[X]=[]),U=re.length;if(++X>l||$>1073741824){for(var te=0;te<Q.length;te++)re.push(Q[te]),H.push($),N.push(null,null,null,null);return U}if(re.push(Q[0]),H.push($),Q.length<=1)return N.push(null,null,null,null),U;for(var B=.5*Z,K=j+B,J=V+B,ee=[],ne=[],se=[],oe=[],me=1,ce=Q.length;me<ce;me++){var ye=Q[me],Se=u[2*ye],fe=u[2*ye+1];Se<K?fe<J?ee.push(ye):ne.push(ye):fe<J?se.push(ye):oe.push(ye)}return $<<=2,N.push(D(j,V,B,ee,X,$),D(j,J,B,ne,X,$+1),D(K,V,B,se,X,$+2),D(K,J,B,oe,X,$+3)),U})(0,0,1,p,0,1);for(var k=0,L=0;L<f.length;L++){var A=f[L];if(p.set)p.set(A,k);else for(var I=0,P=A.length;I<P;I++)p[I+k]=A[I];var S=k+f[L].length;T[L]=[k,S],k=S}return p.range=function(){for(var D,j=[],V=arguments.length;V--;)j[V]=arguments[V];if(o(j[j.length-1])){var Z=j.pop();j.length||Z.x==null&&Z.l==null&&Z.left==null||(j=[Z],D={}),D=e(Z,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else D={};j.length||(j=s);var Q=w.apply(void 0,j),X=[Math.min(Q.x,Q.x+Q.width),Math.min(Q.y,Q.y+Q.height),Math.max(Q.x,Q.x+Q.width),Math.max(Q.y,Q.y+Q.height)],$=X[0],re=X[1],H=X[2],N=X[3],U=c([$,re,H,N],s),te=U[0],B=U[1],K=U[2],J=U[3],ee=t(D.level,f.length);if(D.d!=null){var ne;typeof D.d=="number"?ne=[D.d,D.d]:D.d.length&&(ne=D.d),ee=Math.min(Math.max(Math.ceil(-g(Math.abs(ne[0])/(s[2]-s[0]))),Math.ceil(-g(Math.abs(ne[1])/(s[3]-s[1])))),ee)}if(ee=Math.min(ee,f.length),D.lod)return E(te,B,K,J,ee);var se=[];function oe(ce,ye,Se,fe,ge,Te){if(ge!==null&&Te!==null&&!(te>ce+Se||B>ye+Se||K<ce||J<ye||fe>=ee||ge===Te)){var le=f[fe];Te===void 0&&(Te=le.length);for(var ve=ge;ve<Te;ve++){var Me=le[ve],we=a[2*Me],de=a[2*Me+1];we>=$&&we<=H&&de>=re&&de<=N&&se.push(Me)}var Ie=_[fe],De=Ie[4*ge+0],Oe=Ie[4*ge+1],Ve=Ie[4*ge+2],Fe=Ie[4*ge+3],ze=me(Ie,ge+1),Re=.5*Se,We=fe+1;oe(ce,ye,Re,We,De,Oe||Ve||Fe||ze),oe(ce,ye+Re,Re,We,Oe,Ve||Fe||ze),oe(ce+Re,ye,Re,We,Ve,Fe||ze),oe(ce+Re,ye+Re,Re,We,Fe,ze)}}function me(ce,ye){for(var Se=null,fe=0;Se===null;)if(Se=ce[4*ye+fe],++fe>ce.length)return null;return Se}return oe(0,0,1,0,0,1),se},p;function E(D,j,V,Z,Q){for(var X=[],$=0;$<Q;$++){var re=b[$],H=T[$][0],N=z(D,j,$),U=z(V,Z,$),te=d.ge(re,N),B=d.gt(re,U,te,re.length-1);X[$]=[te+H,B+H]}return X}function z(D,j,V){for(var Z=1,Q=.5,X=.5,$=.5,re=0;re<V;re++)Z<<=2,Z+=D<Q?j<X?0:1:j<X?2:3,$*=.5,Q+=D<Q?-$:$,X+=j<X?-$:$;return Z}}},{"array-bounds":71,"binary-search-bounds":80,clamp:86,defined:124,dtype:127,"flatten-vertex-data":191,"is-obj":235,"math-log2":240,"parse-rect":249,"pick-by-alias":253}],61:[function(m,G,Y){Object.defineProperty(Y,"__esModule",{value:!0});var d=m("@turf/meta");function v(e){var t=0;if(e&&e.length>0){t+=Math.abs(w(e[0]));for(var n=1;n<e.length;n++)t-=Math.abs(w(e[n]))}return t}function w(e){var t,n,o,r,g,c,a=0,h=e.length;if(h>2){for(c=0;c<h;c++)c===h-2?(o=h-2,r=h-1,g=0):c===h-1?(o=h-1,r=0,g=1):(o=c,r=c+1,g=c+2),t=e[o],n=e[r],a+=(y(e[g][0])-y(t[0]))*Math.sin(y(n[1]));a=6378137*a*6378137/2}return a}function y(e){return e*Math.PI/180}Y.default=function(e){return d.geomReduce(e,function(t,n){return t+function(o){var r,g=0;switch(o.type){case"Polygon":return v(o.coordinates);case"MultiPolygon":for(r=0;r<o.coordinates.length;r++)g+=v(o.coordinates[r]);return g;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(n)},0)}},{"@turf/meta":63}],62:[function(m,G,Y){function d(h,l,s){s===void 0&&(s={});var p={type:"Feature"};return(s.id===0||s.id)&&(p.id=s.id),s.bbox&&(p.bbox=s.bbox),p.properties=l||{},p.geometry=h,p}function v(h,l,s){if(s===void 0&&(s={}),!h)throw new Error("coordinates is required");if(!Array.isArray(h))throw new Error("coordinates must be an Array");if(h.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!a(h[0])||!a(h[1]))throw new Error("coordinates must contain numbers");return d({type:"Point",coordinates:h},l,s)}function w(h,l,s){s===void 0&&(s={});for(var p=0,u=h;p<u.length;p++){var i=u[p];if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var x=0;x<i[i.length-1].length;x++)if(i[i.length-1][x]!==i[0][x])throw new Error("First and last Position are not equivalent.")}return d({type:"Polygon",coordinates:h},l,s)}function y(h,l,s){if(s===void 0&&(s={}),h.length<2)throw new Error("coordinates must be an array of two or more positions");return d({type:"LineString",coordinates:h},l,s)}function e(h,l){l===void 0&&(l={});var s={type:"FeatureCollection"};return l.id&&(s.id=l.id),l.bbox&&(s.bbox=l.bbox),s.features=h,s}function t(h,l,s){return s===void 0&&(s={}),d({type:"MultiLineString",coordinates:h},l,s)}function n(h,l,s){return s===void 0&&(s={}),d({type:"MultiPoint",coordinates:h},l,s)}function o(h,l,s){return s===void 0&&(s={}),d({type:"MultiPolygon",coordinates:h},l,s)}function r(h,l){l===void 0&&(l="kilometers");var s=Y.factors[l];if(!s)throw new Error(l+" units is invalid");return h*s}function g(h,l){l===void 0&&(l="kilometers");var s=Y.factors[l];if(!s)throw new Error(l+" units is invalid");return h/s}function c(h){return 180*(h%(2*Math.PI))/Math.PI}function a(h){return!isNaN(h)&&h!==null&&!Array.isArray(h)}Object.defineProperty(Y,"__esModule",{value:!0}),Y.earthRadius=63710088e-1,Y.factors={centimeters:100*Y.earthRadius,centimetres:100*Y.earthRadius,degrees:Y.earthRadius/111325,feet:3.28084*Y.earthRadius,inches:39.37*Y.earthRadius,kilometers:Y.earthRadius/1e3,kilometres:Y.earthRadius/1e3,meters:Y.earthRadius,metres:Y.earthRadius,miles:Y.earthRadius/1609.344,millimeters:1e3*Y.earthRadius,millimetres:1e3*Y.earthRadius,nauticalmiles:Y.earthRadius/1852,radians:1,yards:1.0936*Y.earthRadius},Y.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/Y.earthRadius,yards:1.0936133},Y.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},Y.feature=d,Y.geometry=function(h,l,s){switch(h){case"Point":return v(l).geometry;case"LineString":return y(l).geometry;case"Polygon":return w(l).geometry;case"MultiPoint":return n(l).geometry;case"MultiLineString":return t(l).geometry;case"MultiPolygon":return o(l).geometry;default:throw new Error(h+" is invalid")}},Y.point=v,Y.points=function(h,l,s){return s===void 0&&(s={}),e(h.map(function(p){return v(p,l)}),s)},Y.polygon=w,Y.polygons=function(h,l,s){return s===void 0&&(s={}),e(h.map(function(p){return w(p,l)}),s)},Y.lineString=y,Y.lineStrings=function(h,l,s){return s===void 0&&(s={}),e(h.map(function(p){return y(p,l)}),s)},Y.featureCollection=e,Y.multiLineString=t,Y.multiPoint=n,Y.multiPolygon=o,Y.geometryCollection=function(h,l,s){return s===void 0&&(s={}),d({type:"GeometryCollection",geometries:h},l,s)},Y.round=function(h,l){if(l===void 0&&(l=0),l&&!(l>=0))throw new Error("precision must be a positive number");var s=Math.pow(10,l||0);return Math.round(h*s)/s},Y.radiansToLength=r,Y.lengthToRadians=g,Y.lengthToDegrees=function(h,l){return c(g(h,l))},Y.bearingToAzimuth=function(h){var l=h%360;return l<0&&(l+=360),l},Y.radiansToDegrees=c,Y.degreesToRadians=function(h){return h%360*Math.PI/180},Y.convertLength=function(h,l,s){if(l===void 0&&(l="kilometers"),s===void 0&&(s="kilometers"),!(h>=0))throw new Error("length must be a positive number");return r(g(h,l),s)},Y.convertArea=function(h,l,s){if(l===void 0&&(l="meters"),s===void 0&&(s="kilometers"),!(h>=0))throw new Error("area must be a positive number");var p=Y.areaFactors[l];if(!p)throw new Error("invalid original units");var u=Y.areaFactors[s];if(!u)throw new Error("invalid final units");return h/p*u},Y.isNumber=a,Y.isObject=function(h){return!!h&&h.constructor===Object},Y.validateBBox=function(h){if(!h)throw new Error("bbox is required");if(!Array.isArray(h))throw new Error("bbox must be an Array");if(h.length!==4&&h.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");h.forEach(function(l){if(!a(l))throw new Error("bbox must only contain numbers")})},Y.validateId=function(h){if(!h)throw new Error("id is required");if(["string","number"].indexOf(typeof h)===-1)throw new Error("id must be a number or a string")}},{}],63:[function(m,G,Y){Object.defineProperty(Y,"__esModule",{value:!0});var d=m("@turf/helpers");function v(r,g,c){if(r!==null)for(var a,h,l,s,p,u,i,x,f=0,_=0,b=r.type,T=b==="FeatureCollection",k=b==="Feature",L=T?r.features.length:1,A=0;A<L;A++){p=(x=!!(i=T?r.features[A].geometry:k?r.geometry:r)&&i.type==="GeometryCollection")?i.geometries.length:1;for(var I=0;I<p;I++){var P=0,S=0;if((s=x?i.geometries[I]:i)!==null){u=s.coordinates;var E=s.type;switch(f=!c||E!=="Polygon"&&E!=="MultiPolygon"?0:1,E){case null:break;case"Point":if(g(u,_,A,P,S)===!1)return!1;_++,P++;break;case"LineString":case"MultiPoint":for(a=0;a<u.length;a++){if(g(u[a],_,A,P,S)===!1)return!1;_++,E==="MultiPoint"&&P++}E==="LineString"&&P++;break;case"Polygon":case"MultiLineString":for(a=0;a<u.length;a++){for(h=0;h<u[a].length-f;h++){if(g(u[a][h],_,A,P,S)===!1)return!1;_++}E==="MultiLineString"&&P++,E==="Polygon"&&S++}E==="Polygon"&&P++;break;case"MultiPolygon":for(a=0;a<u.length;a++){for(S=0,h=0;h<u[a].length;h++){for(l=0;l<u[a][h].length-f;l++){if(g(u[a][h][l],_,A,P,S)===!1)return!1;_++}S++}P++}break;case"GeometryCollection":for(a=0;a<s.geometries.length;a++)if(v(s.geometries[a],g,c)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function w(r,g){var c;switch(r.type){case"FeatureCollection":for(c=0;c<r.features.length&&g(r.features[c].properties,c)!==!1;c++);break;case"Feature":g(r.properties,0)}}function y(r,g){if(r.type==="Feature")g(r,0);else if(r.type==="FeatureCollection")for(var c=0;c<r.features.length&&g(r.features[c],c)!==!1;c++);}function e(r,g){var c,a,h,l,s,p,u,i,x,f,_=0,b=r.type==="FeatureCollection",T=r.type==="Feature",k=b?r.features.length:1;for(c=0;c<k;c++){for(p=b?r.features[c].geometry:T?r.geometry:r,i=b?r.features[c].properties:T?r.properties:{},x=b?r.features[c].bbox:T?r.bbox:void 0,f=b?r.features[c].id:T?r.id:void 0,s=(u=!!p&&p.type==="GeometryCollection")?p.geometries.length:1,h=0;h<s;h++)if((l=u?p.geometries[h]:p)!==null)switch(l.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(g(l,_,i,x,f)===!1)return!1;break;case"GeometryCollection":for(a=0;a<l.geometries.length;a++)if(g(l.geometries[a],_,i,x,f)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}else if(g(null,_,i,x,f)===!1)return!1;_++}}function t(r,g){e(r,function(c,a,h,l,s){var p,u=c===null?null:c.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return g(d.feature(c,h,{bbox:l,id:s}),a,0)!==!1&&void 0}switch(u){case"MultiPoint":p="Point";break;case"MultiLineString":p="LineString";break;case"MultiPolygon":p="Polygon"}for(var i=0;i<c.coordinates.length;i++){var x={type:p,coordinates:c.coordinates[i]};if(g(d.feature(x,h),a,i)===!1)return!1}})}function n(r,g){t(r,function(c,a,h){var l=0;if(c.geometry){var s=c.geometry.type;if(s!=="Point"&&s!=="MultiPoint"){var p,u=0,i=0,x=0;return v(c,function(f,_,b,T,k){if(p===void 0||a>u||T>i||k>x)return p=f,u=a,i=T,x=k,void(l=0);var L=d.lineString([p,f],c.properties);if(g(L,a,h,k,l)===!1)return!1;l++,p=f})!==!1&&void 0}}})}function o(r,g){if(!r)throw new Error("geojson is required");t(r,function(c,a,h){if(c.geometry!==null){var l=c.geometry.type,s=c.geometry.coordinates;switch(l){case"LineString":if(g(c,a,h,0,0)===!1)return!1;break;case"Polygon":for(var p=0;p<s.length;p++)if(g(d.lineString(s[p],c.properties),a,h,p)===!1)return!1}}})}Y.coordEach=v,Y.coordReduce=function(r,g,c,a){var h=c;return v(r,function(l,s,p,u,i){h=s===0&&c===void 0?l:g(h,l,s,p,u,i)},a),h},Y.propEach=w,Y.propReduce=function(r,g,c){var a=c;return w(r,function(h,l){a=l===0&&c===void 0?h:g(a,h,l)}),a},Y.featureEach=y,Y.featureReduce=function(r,g,c){var a=c;return y(r,function(h,l){a=l===0&&c===void 0?h:g(a,h,l)}),a},Y.coordAll=function(r){var g=[];return v(r,function(c){g.push(c)}),g},Y.geomEach=e,Y.geomReduce=function(r,g,c){var a=c;return e(r,function(h,l,s,p,u){a=l===0&&c===void 0?h:g(a,h,l,s,p,u)}),a},Y.flattenEach=t,Y.flattenReduce=function(r,g,c){var a=c;return t(r,function(h,l,s){a=l===0&&s===0&&c===void 0?h:g(a,h,l,s)}),a},Y.segmentEach=n,Y.segmentReduce=function(r,g,c){var a=c,h=!1;return n(r,function(l,s,p,u,i){a=h===!1&&c===void 0?l:g(a,l,s,p,u,i),h=!0}),a},Y.lineEach=o,Y.lineReduce=function(r,g,c){var a=c;return o(r,function(h,l,s,p){a=l===0&&c===void 0?h:g(a,h,l,s,p)}),a},Y.findSegment=function(r,g){if(g=g||{},!d.isObject(g))throw new Error("options is invalid");var c,a=g.featureIndex||0,h=g.multiFeatureIndex||0,l=g.geometryIndex||0,s=g.segmentIndex||0,p=g.properties;switch(r.type){case"FeatureCollection":a<0&&(a=r.features.length+a),p=p||r.features[a].properties,c=r.features[a].geometry;break;case"Feature":p=p||r.properties,c=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":c=r;break;default:throw new Error("geojson is invalid")}if(c===null)return null;var u=c.coordinates;switch(c.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=u.length+s-1),d.lineString([u[s],u[s+1]],p,g);case"Polygon":return l<0&&(l=u.length+l),s<0&&(s=u[l].length+s-1),d.lineString([u[l][s],u[l][s+1]],p,g);case"MultiLineString":return h<0&&(h=u.length+h),s<0&&(s=u[h].length+s-1),d.lineString([u[h][s],u[h][s+1]],p,g);case"MultiPolygon":return h<0&&(h=u.length+h),l<0&&(l=u[h].length+l),s<0&&(s=u[h][l].length-s-1),d.lineString([u[h][l][s],u[h][l][s+1]],p,g)}throw new Error("geojson is invalid")},Y.findPoint=function(r,g){if(g=g||{},!d.isObject(g))throw new Error("options is invalid");var c,a=g.featureIndex||0,h=g.multiFeatureIndex||0,l=g.geometryIndex||0,s=g.coordIndex||0,p=g.properties;switch(r.type){case"FeatureCollection":a<0&&(a=r.features.length+a),p=p||r.features[a].properties,c=r.features[a].geometry;break;case"Feature":p=p||r.properties,c=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":c=r;break;default:throw new Error("geojson is invalid")}if(c===null)return null;var u=c.coordinates;switch(c.type){case"Point":return d.point(u,p,g);case"MultiPoint":return h<0&&(h=u.length+h),d.point(u[h],p,g);case"LineString":return s<0&&(s=u.length+s),d.point(u[s],p,g);case"Polygon":return l<0&&(l=u.length+l),s<0&&(s=u[l].length+s),d.point(u[l][s],p,g);case"MultiLineString":return h<0&&(h=u.length+h),s<0&&(s=u[h].length+s),d.point(u[h][s],p,g);case"MultiPolygon":return h<0&&(h=u.length+h),l<0&&(l=u[h].length+l),s<0&&(s=u[h][l].length-s),d.point(u[h][l][s],p,g)}throw new Error("geojson is invalid")}},{"@turf/helpers":62}],64:[function(m,G,Y){Object.defineProperty(Y,"__esModule",{value:!0});var d=m("@turf/meta");function v(w){var y=[1/0,1/0,-1/0,-1/0];return d.coordEach(w,function(e){y[0]>e[0]&&(y[0]=e[0]),y[1]>e[1]&&(y[1]=e[1]),y[2]<e[0]&&(y[2]=e[0]),y[3]<e[1]&&(y[3]=e[1])}),y}v.default=v,Y.default=v},{"@turf/meta":66}],65:[function(m,G,Y){arguments[4][62][0].apply(Y,arguments)},{dup:62}],66:[function(m,G,Y){arguments[4][63][0].apply(Y,arguments)},{"@turf/helpers":65,dup:63}],67:[function(m,G,Y){Object.defineProperty(Y,"__esModule",{value:!0});var d=m("@turf/meta"),v=m("@turf/helpers");Y.default=function(w,y){y===void 0&&(y={});var e=0,t=0,n=0;return d.coordEach(w,function(o){e+=o[0],t+=o[1],n++}),v.point([e/n,t/n],y.properties)}},{"@turf/helpers":68,"@turf/meta":69}],68:[function(m,G,Y){function d(h,l,s){s===void 0&&(s={});var p={type:"Feature"};return(s.id===0||s.id)&&(p.id=s.id),s.bbox&&(p.bbox=s.bbox),p.properties=l||{},p.geometry=h,p}function v(h,l,s){return s===void 0&&(s={}),d({type:"Point",coordinates:h},l,s)}function w(h,l,s){s===void 0&&(s={});for(var p=0,u=h;p<u.length;p++){var i=u[p];if(i.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var x=0;x<i[i.length-1].length;x++)if(i[i.length-1][x]!==i[0][x])throw new Error("First and last Position are not equivalent.")}return d({type:"Polygon",coordinates:h},l,s)}function y(h,l,s){if(s===void 0&&(s={}),h.length<2)throw new Error("coordinates must be an array of two or more positions");return d({type:"LineString",coordinates:h},l,s)}function e(h,l){l===void 0&&(l={});var s={type:"FeatureCollection"};return l.id&&(s.id=l.id),l.bbox&&(s.bbox=l.bbox),s.features=h,s}function t(h,l,s){return s===void 0&&(s={}),d({type:"MultiLineString",coordinates:h},l,s)}function n(h,l,s){return s===void 0&&(s={}),d({type:"MultiPoint",coordinates:h},l,s)}function o(h,l,s){return s===void 0&&(s={}),d({type:"MultiPolygon",coordinates:h},l,s)}function r(h,l){l===void 0&&(l="kilometers");var s=Y.factors[l];if(!s)throw new Error(l+" units is invalid");return h*s}function g(h,l){l===void 0&&(l="kilometers");var s=Y.factors[l];if(!s)throw new Error(l+" units is invalid");return h/s}function c(h){return 180*(h%(2*Math.PI))/Math.PI}function a(h){return!isNaN(h)&&h!==null&&!Array.isArray(h)&&!/^\s*$/.test(h)}Object.defineProperty(Y,"__esModule",{value:!0}),Y.earthRadius=63710088e-1,Y.factors={centimeters:100*Y.earthRadius,centimetres:100*Y.earthRadius,degrees:Y.earthRadius/111325,feet:3.28084*Y.earthRadius,inches:39.37*Y.earthRadius,kilometers:Y.earthRadius/1e3,kilometres:Y.earthRadius/1e3,meters:Y.earthRadius,metres:Y.earthRadius,miles:Y.earthRadius/1609.344,millimeters:1e3*Y.earthRadius,millimetres:1e3*Y.earthRadius,nauticalmiles:Y.earthRadius/1852,radians:1,yards:Y.earthRadius/1.0936},Y.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/Y.earthRadius,yards:1/1.0936},Y.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},Y.feature=d,Y.geometry=function(h,l,s){switch(h){case"Point":return v(l).geometry;case"LineString":return y(l).geometry;case"Polygon":return w(l).geometry;case"MultiPoint":return n(l).geometry;case"MultiLineString":return t(l).geometry;case"MultiPolygon":return o(l).geometry;default:throw new Error(h+" is invalid")}},Y.point=v,Y.points=function(h,l,s){return s===void 0&&(s={}),e(h.map(function(p){return v(p,l)}),s)},Y.polygon=w,Y.polygons=function(h,l,s){return s===void 0&&(s={}),e(h.map(function(p){return w(p,l)}),s)},Y.lineString=y,Y.lineStrings=function(h,l,s){return s===void 0&&(s={}),e(h.map(function(p){return y(p,l)}),s)},Y.featureCollection=e,Y.multiLineString=t,Y.multiPoint=n,Y.multiPolygon=o,Y.geometryCollection=function(h,l,s){return s===void 0&&(s={}),d({type:"GeometryCollection",geometries:h},l,s)},Y.round=function(h,l){if(l===void 0&&(l=0),l&&!(l>=0))throw new Error("precision must be a positive number");var s=Math.pow(10,l||0);return Math.round(h*s)/s},Y.radiansToLength=r,Y.lengthToRadians=g,Y.lengthToDegrees=function(h,l){return c(g(h,l))},Y.bearingToAzimuth=function(h){var l=h%360;return l<0&&(l+=360),l},Y.radiansToDegrees=c,Y.degreesToRadians=function(h){return h%360*Math.PI/180},Y.convertLength=function(h,l,s){if(l===void 0&&(l="kilometers"),s===void 0&&(s="kilometers"),!(h>=0))throw new Error("length must be a positive number");return r(g(h,l),s)},Y.convertArea=function(h,l,s){if(l===void 0&&(l="meters"),s===void 0&&(s="kilometers"),!(h>=0))throw new Error("area must be a positive number");var p=Y.areaFactors[l];if(!p)throw new Error("invalid original units");var u=Y.areaFactors[s];if(!u)throw new Error("invalid final units");return h/p*u},Y.isNumber=a,Y.isObject=function(h){return!!h&&h.constructor===Object},Y.validateBBox=function(h){if(!h)throw new Error("bbox is required");if(!Array.isArray(h))throw new Error("bbox must be an Array");if(h.length!==4&&h.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");h.forEach(function(l){if(!a(l))throw new Error("bbox must only contain numbers")})},Y.validateId=function(h){if(!h)throw new Error("id is required");if(["string","number"].indexOf(typeof h)===-1)throw new Error("id must be a number or a string")},Y.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},Y.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},Y.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},Y.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},Y.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},Y.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},Y.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},{}],69:[function(m,G,Y){Object.defineProperty(Y,"__esModule",{value:!0});var d=m("@turf/helpers");function v(r,g,c){if(r!==null)for(var a,h,l,s,p,u,i,x,f=0,_=0,b=r.type,T=b==="FeatureCollection",k=b==="Feature",L=T?r.features.length:1,A=0;A<L;A++){p=(x=!!(i=T?r.features[A].geometry:k?r.geometry:r)&&i.type==="GeometryCollection")?i.geometries.length:1;for(var I=0;I<p;I++){var P=0,S=0;if((s=x?i.geometries[I]:i)!==null){u=s.coordinates;var E=s.type;switch(f=!c||E!=="Polygon"&&E!=="MultiPolygon"?0:1,E){case null:break;case"Point":if(g(u,_,A,P,S)===!1)return!1;_++,P++;break;case"LineString":case"MultiPoint":for(a=0;a<u.length;a++){if(g(u[a],_,A,P,S)===!1)return!1;_++,E==="MultiPoint"&&P++}E==="LineString"&&P++;break;case"Polygon":case"MultiLineString":for(a=0;a<u.length;a++){for(h=0;h<u[a].length-f;h++){if(g(u[a][h],_,A,P,S)===!1)return!1;_++}E==="MultiLineString"&&P++,E==="Polygon"&&S++}E==="Polygon"&&P++;break;case"MultiPolygon":for(a=0;a<u.length;a++){for(S=0,h=0;h<u[a].length;h++){for(l=0;l<u[a][h].length-f;l++){if(g(u[a][h][l],_,A,P,S)===!1)return!1;_++}S++}P++}break;case"GeometryCollection":for(a=0;a<s.geometries.length;a++)if(v(s.geometries[a],g,c)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function w(r,g){var c;switch(r.type){case"FeatureCollection":for(c=0;c<r.features.length&&g(r.features[c].properties,c)!==!1;c++);break;case"Feature":g(r.properties,0)}}function y(r,g){if(r.type==="Feature")g(r,0);else if(r.type==="FeatureCollection")for(var c=0;c<r.features.length&&g(r.features[c],c)!==!1;c++);}function e(r,g){var c,a,h,l,s,p,u,i,x,f,_=0,b=r.type==="FeatureCollection",T=r.type==="Feature",k=b?r.features.length:1;for(c=0;c<k;c++){for(p=b?r.features[c].geometry:T?r.geometry:r,i=b?r.features[c].properties:T?r.properties:{},x=b?r.features[c].bbox:T?r.bbox:void 0,f=b?r.features[c].id:T?r.id:void 0,s=(u=!!p&&p.type==="GeometryCollection")?p.geometries.length:1,h=0;h<s;h++)if((l=u?p.geometries[h]:p)!==null)switch(l.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(g(l,_,i,x,f)===!1)return!1;break;case"GeometryCollection":for(a=0;a<l.geometries.length;a++)if(g(l.geometries[a],_,i,x,f)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}else if(g(null,_,i,x,f)===!1)return!1;_++}}function t(r,g){e(r,function(c,a,h,l,s){var p,u=c===null?null:c.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return g(d.feature(c,h,{bbox:l,id:s}),a,0)!==!1&&void 0}switch(u){case"MultiPoint":p="Point";break;case"MultiLineString":p="LineString";break;case"MultiPolygon":p="Polygon"}for(var i=0;i<c.coordinates.length;i++){var x={type:p,coordinates:c.coordinates[i]};if(g(d.feature(x,h),a,i)===!1)return!1}})}function n(r,g){t(r,function(c,a,h){var l=0;if(c.geometry){var s=c.geometry.type;if(s!=="Point"&&s!=="MultiPoint"){var p,u=0,i=0,x=0;return v(c,function(f,_,b,T,k){if(p===void 0||a>u||T>i||k>x)return p=f,u=a,i=T,x=k,void(l=0);var L=d.lineString([p,f],c.properties);if(g(L,a,h,k,l)===!1)return!1;l++,p=f})!==!1&&void 0}}})}function o(r,g){if(!r)throw new Error("geojson is required");t(r,function(c,a,h){if(c.geometry!==null){var l=c.geometry.type,s=c.geometry.coordinates;switch(l){case"LineString":if(g(c,a,h,0,0)===!1)return!1;break;case"Polygon":for(var p=0;p<s.length;p++)if(g(d.lineString(s[p],c.properties),a,h,p)===!1)return!1}}})}Y.coordEach=v,Y.coordReduce=function(r,g,c,a){var h=c;return v(r,function(l,s,p,u,i){h=s===0&&c===void 0?l:g(h,l,s,p,u,i)},a),h},Y.propEach=w,Y.propReduce=function(r,g,c){var a=c;return w(r,function(h,l){a=l===0&&c===void 0?h:g(a,h,l)}),a},Y.featureEach=y,Y.featureReduce=function(r,g,c){var a=c;return y(r,function(h,l){a=l===0&&c===void 0?h:g(a,h,l)}),a},Y.coordAll=function(r){var g=[];return v(r,function(c){g.push(c)}),g},Y.geomEach=e,Y.geomReduce=function(r,g,c){var a=c;return e(r,function(h,l,s,p,u){a=l===0&&c===void 0?h:g(a,h,l,s,p,u)}),a},Y.flattenEach=t,Y.flattenReduce=function(r,g,c){var a=c;return t(r,function(h,l,s){a=l===0&&s===0&&c===void 0?h:g(a,h,l,s)}),a},Y.segmentEach=n,Y.segmentReduce=function(r,g,c){var a=c,h=!1;return n(r,function(l,s,p,u,i){a=h===!1&&c===void 0?l:g(a,l,s,p,u,i),h=!0}),a},Y.lineEach=o,Y.lineReduce=function(r,g,c){var a=c;return o(r,function(h,l,s,p){a=l===0&&c===void 0?h:g(a,h,l,s,p)}),a},Y.findSegment=function(r,g){if(g=g||{},!d.isObject(g))throw new Error("options is invalid");var c,a=g.featureIndex||0,h=g.multiFeatureIndex||0,l=g.geometryIndex||0,s=g.segmentIndex||0,p=g.properties;switch(r.type){case"FeatureCollection":a<0&&(a=r.features.length+a),p=p||r.features[a].properties,c=r.features[a].geometry;break;case"Feature":p=p||r.properties,c=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":c=r;break;default:throw new Error("geojson is invalid")}if(c===null)return null;var u=c.coordinates;switch(c.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=u.length+s-1),d.lineString([u[s],u[s+1]],p,g);case"Polygon":return l<0&&(l=u.length+l),s<0&&(s=u[l].length+s-1),d.lineString([u[l][s],u[l][s+1]],p,g);case"MultiLineString":return h<0&&(h=u.length+h),s<0&&(s=u[h].length+s-1),d.lineString([u[h][s],u[h][s+1]],p,g);case"MultiPolygon":return h<0&&(h=u.length+h),l<0&&(l=u[h].length+l),s<0&&(s=u[h][l].length-s-1),d.lineString([u[h][l][s],u[h][l][s+1]],p,g)}throw new Error("geojson is invalid")},Y.findPoint=function(r,g){if(g=g||{},!d.isObject(g))throw new Error("options is invalid");var c,a=g.featureIndex||0,h=g.multiFeatureIndex||0,l=g.geometryIndex||0,s=g.coordIndex||0,p=g.properties;switch(r.type){case"FeatureCollection":a<0&&(a=r.features.length+a),p=p||r.features[a].properties,c=r.features[a].geometry;break;case"Feature":p=p||r.properties,c=r.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":c=r;break;default:throw new Error("geojson is invalid")}if(c===null)return null;var u=c.coordinates;switch(c.type){case"Point":return d.point(u,p,g);case"MultiPoint":return h<0&&(h=u.length+h),d.point(u[h],p,g);case"LineString":return s<0&&(s=u.length+s),d.point(u[s],p,g);case"Polygon":return l<0&&(l=u.length+l),s<0&&(s=u[l].length+s),d.point(u[l][s],p,g);case"MultiLineString":return h<0&&(h=u.length+h),s<0&&(s=u[h].length+s),d.point(u[h][s],p,g);case"MultiPolygon":return h<0&&(h=u.length+h),l<0&&(l=u[h].length+l),s<0&&(s=u[h][l].length-s),d.point(u[h][l][s],p,g)}throw new Error("geojson is invalid")}},{"@turf/helpers":68}],70:[function(m,G,Y){G.exports=function(d){var v=0,w=0,y=0,e=0;return d.map(function(t){var n=(t=t.slice())[0],o=n.toUpperCase();if(n!=o)switch(t[0]=o,n){case"a":t[6]+=y,t[7]+=e;break;case"v":t[1]+=e;break;case"h":t[1]+=y;break;default:for(var r=1;r<t.length;)t[r++]+=y,t[r++]+=e}switch(o){case"Z":y=v,e=w;break;case"H":y=t[1];break;case"V":e=t[1];break;case"M":y=v=t[1],e=w=t[2];break;default:y=t[t.length-2],e=t[t.length-1]}return t})}},{}],71:[function(m,G,Y){G.exports=function(d,v){if(!d||d.length==null)throw Error("Argument should be an array");v=v==null?1:Math.floor(v);for(var w=Array(2*v),y=0;y<v;y++){for(var e=-1/0,t=1/0,n=y,o=d.length;n<o;n+=v)d[n]>e&&(e=d[n]),d[n]<t&&(t=d[n]);w[y]=t,w[v+y]=e}return w}},{}],72:[function(m,G,Y){G.exports=function(d,v,w){if(typeof Array.prototype.findIndex=="function")return d.findIndex(v,w);if(typeof v!="function")throw new TypeError("predicate must be a function");var y=Object(d),e=y.length;if(e===0)return-1;for(var t=0;t<e;t++)if(v.call(w,y[t],t,y))return t;return-1}},{}],73:[function(m,G,Y){var d=m("array-bounds");G.exports=function(v,w,y){if(!v||v.length==null)throw Error("Argument should be an array");w==null&&(w=1),y==null&&(y=d(v,w));for(var e=0;e<w;e++){var t=y[w+e],n=y[e],o=e,r=v.length;if(t===1/0&&n===-1/0)for(o=e;o<r;o+=w)v[o]=v[o]===t?1:v[o]===n?0:.5;else if(t===1/0)for(o=e;o<r;o+=w)v[o]=v[o]===t?1:0;else if(n===-1/0)for(o=e;o<r;o+=w)v[o]=v[o]===n?0:1;else{var g=t-n;for(o=e;o<r;o+=w)isNaN(v[o])||(v[o]=g===0?.5:(v[o]-n)/g)}}return v}},{"array-bounds":71}],74:[function(m,G,Y){G.exports=function(d,v){var w=typeof d=="number",y=typeof v=="number";w&&!y?(v=d,d=0):w||y||(d=0,v=0);var e=(v|=0)-(d|=0);if(e<0)throw new Error("array length must be positive");for(var t=new Array(e),n=0,o=d;n<e;n++,o++)t[n]=o;return t}},{}],75:[function(m,G,Y){(function(d){(function(){var v=m("object-assign");/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function w(T,k){if(T===k)return 0;for(var L=T.length,A=k.length,I=0,P=Math.min(L,A);I<P;++I)if(T[I]!==k[I]){L=T[I],A=k[I];break}return L<A?-1:A<L?1:0}function y(T){return d.Buffer&&typeof d.Buffer.isBuffer=="function"?d.Buffer.isBuffer(T):!(T==null||!T._isBuffer)}var e=m("util/"),t=Object.prototype.hasOwnProperty,n=Array.prototype.slice,o=function(){}.name==="foo";function r(T){return Object.prototype.toString.call(T)}function g(T){return!y(T)&&typeof d.ArrayBuffer=="function"&&(typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(T):!!T&&(T instanceof DataView||!!(T.buffer&&T.buffer instanceof ArrayBuffer)))}var c=G.exports=u,a=/\s*function\s+([^\(\s]*)\s*/;function h(T){if(e.isFunction(T)){if(o)return T.name;var k=T.toString().match(a);return k&&k[1]}}function l(T,k){return typeof T=="string"?T.length<k?T:T.slice(0,k):T}function s(T){if(o||!e.isFunction(T))return e.inspect(T);var k=h(T);return"[Function"+(k?": "+k:"")+"]"}function p(T,k,L,A,I){throw new c.AssertionError({message:L,actual:T,expected:k,operator:A,stackStartFunction:I})}function u(T,k){T||p(T,!0,k,"==",c.ok)}function i(T,k,L,A){if(T===k)return!0;if(y(T)&&y(k))return w(T,k)===0;if(e.isDate(T)&&e.isDate(k))return T.getTime()===k.getTime();if(e.isRegExp(T)&&e.isRegExp(k))return T.source===k.source&&T.global===k.global&&T.multiline===k.multiline&&T.lastIndex===k.lastIndex&&T.ignoreCase===k.ignoreCase;if(T!==null&&typeof T=="object"||k!==null&&typeof k=="object"){if(g(T)&&g(k)&&r(T)===r(k)&&!(T instanceof Float32Array||T instanceof Float64Array))return w(new Uint8Array(T.buffer),new Uint8Array(k.buffer))===0;if(y(T)!==y(k))return!1;var I=(A=A||{actual:[],expected:[]}).actual.indexOf(T);return I!==-1&&I===A.expected.indexOf(k)||(A.actual.push(T),A.expected.push(k),function(P,S,E,z){if(P==null||S==null)return!1;if(e.isPrimitive(P)||e.isPrimitive(S))return P===S;if(E&&Object.getPrototypeOf(P)!==Object.getPrototypeOf(S))return!1;var D=x(P),j=x(S);if(D&&!j||!D&&j)return!1;if(D)return P=n.call(P),S=n.call(S),i(P,S,E);var V,Z,Q=b(P),X=b(S);if(Q.length!==X.length)return!1;for(Q.sort(),X.sort(),Z=Q.length-1;Z>=0;Z--)if(Q[Z]!==X[Z])return!1;for(Z=Q.length-1;Z>=0;Z--)if(V=Q[Z],!i(P[V],S[V],E,z))return!1;return!0}(T,k,L,A))}return L?T===k:T==k}function x(T){return Object.prototype.toString.call(T)=="[object Arguments]"}function f(T,k){if(!T||!k)return!1;if(Object.prototype.toString.call(k)=="[object RegExp]")return k.test(T);try{if(T instanceof k)return!0}catch{}return!Error.isPrototypeOf(k)&&k.call({},T)===!0}function _(T,k,L,A){var I;if(typeof k!="function")throw new TypeError('"block" argument must be a function');typeof L=="string"&&(A=L,L=null),I=function(E){var z;try{E()}catch(D){z=D}return z}(k),A=(L&&L.name?" ("+L.name+").":".")+(A?" "+A:"."),T&&!I&&p(I,L,"Missing expected exception"+A);var P=typeof A=="string",S=!T&&I&&!L;if((!T&&e.isError(I)&&P&&f(I,L)||S)&&p(I,L,"Got unwanted exception"+A),T&&I&&L&&!f(I,L)||!T&&I)throw I}c.AssertionError=function(T){this.name="AssertionError",this.actual=T.actual,this.expected=T.expected,this.operator=T.operator,T.message?(this.message=T.message,this.generatedMessage=!1):(this.message=function(E){return l(s(E.actual),128)+" "+E.operator+" "+l(s(E.expected),128)}(this),this.generatedMessage=!0);var k=T.stackStartFunction||p;if(Error.captureStackTrace)Error.captureStackTrace(this,k);else{var L=new Error;if(L.stack){var A=L.stack,I=h(k),P=A.indexOf(`
`+I);if(P>=0){var S=A.indexOf(`
`,P+1);A=A.substring(S+1)}this.stack=A}}},e.inherits(c.AssertionError,Error),c.fail=p,c.ok=u,c.equal=function(T,k,L){T!=k&&p(T,k,L,"==",c.equal)},c.notEqual=function(T,k,L){T==k&&p(T,k,L,"!=",c.notEqual)},c.deepEqual=function(T,k,L){i(T,k,!1)||p(T,k,L,"deepEqual",c.deepEqual)},c.deepStrictEqual=function(T,k,L){i(T,k,!0)||p(T,k,L,"deepStrictEqual",c.deepStrictEqual)},c.notDeepEqual=function(T,k,L){i(T,k,!1)&&p(T,k,L,"notDeepEqual",c.notDeepEqual)},c.notDeepStrictEqual=function T(k,L,A){i(k,L,!0)&&p(k,L,A,"notDeepStrictEqual",T)},c.strictEqual=function(T,k,L){T!==k&&p(T,k,L,"===",c.strictEqual)},c.notStrictEqual=function(T,k,L){T===k&&p(T,k,L,"!==",c.notStrictEqual)},c.throws=function(T,k,L){_(!0,T,k,L)},c.doesNotThrow=function(T,k,L){_(!1,T,k,L)},c.ifError=function(T){if(T)throw T},c.strict=v(function T(k,L){k||p(k,!0,L,"==",T)},c,{equal:c.strictEqual,deepEqual:c.deepStrictEqual,notEqual:c.notStrictEqual,notDeepEqual:c.notDeepStrictEqual}),c.strict.strict=c.strict;var b=Object.keys||function(T){var k=[];for(var L in T)t.call(T,L)&&k.push(L);return k}}).call(this)}).call(this,typeof Ka<"u"?Ka:typeof self<"u"?self:typeof window<"u"?window:{})},{"object-assign":247,"util/":78}],76:[function(m,G,Y){typeof Object.create=="function"?G.exports=function(d,v){d.super_=v,d.prototype=Object.create(v.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}})}:G.exports=function(d,v){d.super_=v;var w=function(){};w.prototype=v.prototype,d.prototype=new w,d.prototype.constructor=d}},{}],77:[function(m,G,Y){G.exports=function(d){return d&&typeof d=="object"&&typeof d.copy=="function"&&typeof d.fill=="function"&&typeof d.readUInt8=="function"}},{}],78:[function(m,G,Y){(function(d,v){(function(){var w=/%[sdj%]/g;Y.format=function(P){if(!p(P)){for(var S=[],E=0;E<arguments.length;E++)S.push(t(arguments[E]));return S.join(" ")}E=1;for(var z=arguments,D=z.length,j=String(P).replace(w,function(Z){if(Z==="%%")return"%";if(E>=D)return Z;switch(Z){case"%s":return String(z[E++]);case"%d":return Number(z[E++]);case"%j":try{return JSON.stringify(z[E++])}catch{return"[Circular]"}default:return Z}}),V=z[E];E<D;V=z[++E])l(V)||!x(V)?j+=" "+V:j+=" "+t(V);return j},Y.deprecate=function(P,S){if(u(v.process))return function(){return Y.deprecate(P,S).apply(this,arguments)};if(d.noDeprecation===!0)return P;var E=!1;return function(){if(!E){if(d.throwDeprecation)throw new Error(S);d.traceDeprecation?console.trace(S):console.error(S),E=!0}return P.apply(this,arguments)}};var y,e={};function t(P,S){var E={seen:[],stylize:o};return arguments.length>=3&&(E.depth=arguments[2]),arguments.length>=4&&(E.colors=arguments[3]),h(S)?E.showHidden=S:S&&Y._extend(E,S),u(E.showHidden)&&(E.showHidden=!1),u(E.depth)&&(E.depth=2),u(E.colors)&&(E.colors=!1),u(E.customInspect)&&(E.customInspect=!0),E.colors&&(E.stylize=n),r(E,P,E.depth)}function n(P,S){var E=t.styles[S];return E?"\x1B["+t.colors[E][0]+"m"+P+"\x1B["+t.colors[E][1]+"m":P}function o(P,S){return P}function r(P,S,E){if(P.customInspect&&S&&b(S.inspect)&&S.inspect!==Y.inspect&&(!S.constructor||S.constructor.prototype!==S)){var z=S.inspect(E,P);return p(z)||(z=r(P,z,E)),z}var D=function(H,N){if(u(N))return H.stylize("undefined","undefined");if(p(N)){var U="'"+JSON.stringify(N).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return H.stylize(U,"string")}if(s(N))return H.stylize(""+N,"number");if(h(N))return H.stylize(""+N,"boolean");if(l(N))return H.stylize("null","null")}(P,S);if(D)return D;var j=Object.keys(S),V=function(H){var N={};return H.forEach(function(U,te){N[U]=!0}),N}(j);if(P.showHidden&&(j=Object.getOwnPropertyNames(S)),_(S)&&(j.indexOf("message")>=0||j.indexOf("description")>=0))return g(S);if(j.length===0){if(b(S)){var Z=S.name?": "+S.name:"";return P.stylize("[Function"+Z+"]","special")}if(i(S))return P.stylize(RegExp.prototype.toString.call(S),"regexp");if(f(S))return P.stylize(Date.prototype.toString.call(S),"date");if(_(S))return g(S)}var Q,X="",$=!1,re=["{","}"];return a(S)&&($=!0,re=["[","]"]),b(S)&&(X=" [Function"+(S.name?": "+S.name:"")+"]"),i(S)&&(X=" "+RegExp.prototype.toString.call(S)),f(S)&&(X=" "+Date.prototype.toUTCString.call(S)),_(S)&&(X=" "+g(S)),j.length!==0||$&&S.length!=0?E<0?i(S)?P.stylize(RegExp.prototype.toString.call(S),"regexp"):P.stylize("[Object]","special"):(P.seen.push(S),Q=$?function(H,N,U,te,B){for(var K=[],J=0,ee=N.length;J<ee;++J)I(N,String(J))?K.push(c(H,N,U,te,String(J),!0)):K.push("");return B.forEach(function(ne){ne.match(/^\d+$/)||K.push(c(H,N,U,te,ne,!0))}),K}(P,S,E,V,j):j.map(function(H){return c(P,S,E,V,H,$)}),P.seen.pop(),function(H,N,U){return H.reduce(function(te,B){return B.indexOf(`
`)>=0,te+B.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?U[0]+(N===""?"":N+`
 `)+" "+H.join(`,
  `)+" "+U[1]:U[0]+N+" "+H.join(", ")+" "+U[1]}(Q,X,re)):re[0]+X+re[1]}function g(P){return"["+Error.prototype.toString.call(P)+"]"}function c(P,S,E,z,D,j){var V,Z,Q;if((Q=Object.getOwnPropertyDescriptor(S,D)||{value:S[D]}).get?Z=Q.set?P.stylize("[Getter/Setter]","special"):P.stylize("[Getter]","special"):Q.set&&(Z=P.stylize("[Setter]","special")),I(z,D)||(V="["+D+"]"),Z||(P.seen.indexOf(Q.value)<0?(Z=l(E)?r(P,Q.value,null):r(P,Q.value,E-1)).indexOf(`
`)>-1&&(Z=j?Z.split(`
`).map(function(X){return"  "+X}).join(`
`).substr(2):`
`+Z.split(`
`).map(function(X){return"   "+X}).join(`
`)):Z=P.stylize("[Circular]","special")),u(V)){if(j&&D.match(/^\d+$/))return Z;(V=JSON.stringify(""+D)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(V=V.substr(1,V.length-2),V=P.stylize(V,"name")):(V=V.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),V=P.stylize(V,"string"))}return V+": "+Z}function a(P){return Array.isArray(P)}function h(P){return typeof P=="boolean"}function l(P){return P===null}function s(P){return typeof P=="number"}function p(P){return typeof P=="string"}function u(P){return P===void 0}function i(P){return x(P)&&T(P)==="[object RegExp]"}function x(P){return typeof P=="object"&&P!==null}function f(P){return x(P)&&T(P)==="[object Date]"}function _(P){return x(P)&&(T(P)==="[object Error]"||P instanceof Error)}function b(P){return typeof P=="function"}function T(P){return Object.prototype.toString.call(P)}function k(P){return P<10?"0"+P.toString(10):P.toString(10)}Y.debuglog=function(P){if(u(y)&&(y=d.env.NODE_DEBUG||""),P=P.toUpperCase(),!e[P])if(new RegExp("\\b"+P+"\\b","i").test(y)){var S=d.pid;e[P]=function(){var E=Y.format.apply(Y,arguments);console.error("%s %d: %s",P,S,E)}}else e[P]=function(){};return e[P]},Y.inspect=t,t.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},t.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},Y.isArray=a,Y.isBoolean=h,Y.isNull=l,Y.isNullOrUndefined=function(P){return P==null},Y.isNumber=s,Y.isString=p,Y.isSymbol=function(P){return typeof P=="symbol"},Y.isUndefined=u,Y.isRegExp=i,Y.isObject=x,Y.isDate=f,Y.isError=_,Y.isFunction=b,Y.isPrimitive=function(P){return P===null||typeof P=="boolean"||typeof P=="number"||typeof P=="string"||typeof P=="symbol"||P===void 0},Y.isBuffer=m("./support/isBuffer");var L=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function A(){var P=new Date,S=[k(P.getHours()),k(P.getMinutes()),k(P.getSeconds())].join(":");return[P.getDate(),L[P.getMonth()],S].join(" ")}function I(P,S){return Object.prototype.hasOwnProperty.call(P,S)}Y.log=function(){console.log("%s - %s",A(),Y.format.apply(Y,arguments))},Y.inherits=m("inherits"),Y._extend=function(P,S){if(!S||!x(S))return P;for(var E=Object.keys(S),z=E.length;z--;)P[E[z]]=S[E[z]];return P}}).call(this)}).call(this,m("_process"),typeof Ka<"u"?Ka:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":77,_process:278,inherits:76}],79:[function(m,G,Y){Y.byteLength=function(r){var g=n(r),c=g[0],a=g[1];return 3*(c+a)/4-a},Y.toByteArray=function(r){var g,c,a=n(r),h=a[0],l=a[1],s=new w(function(i,x,f){return 3*(x+f)/4-f}(0,h,l)),p=0,u=l>0?h-4:h;for(c=0;c<u;c+=4)g=v[r.charCodeAt(c)]<<18|v[r.charCodeAt(c+1)]<<12|v[r.charCodeAt(c+2)]<<6|v[r.charCodeAt(c+3)],s[p++]=g>>16&255,s[p++]=g>>8&255,s[p++]=255&g;return l===2&&(g=v[r.charCodeAt(c)]<<2|v[r.charCodeAt(c+1)]>>4,s[p++]=255&g),l===1&&(g=v[r.charCodeAt(c)]<<10|v[r.charCodeAt(c+1)]<<4|v[r.charCodeAt(c+2)]>>2,s[p++]=g>>8&255,s[p++]=255&g),s},Y.fromByteArray=function(r){for(var g,c=r.length,a=c%3,h=[],l=0,s=c-a;l<s;l+=16383)h.push(o(r,l,l+16383>s?s:l+16383));return a===1?(g=r[c-1],h.push(d[g>>2]+d[g<<4&63]+"==")):a===2&&(g=(r[c-2]<<8)+r[c-1],h.push(d[g>>10]+d[g>>4&63]+d[g<<2&63]+"=")),h.join("")};for(var d=[],v=[],w=typeof Uint8Array<"u"?Uint8Array:Array,y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,t=y.length;e<t;++e)d[e]=y[e],v[y.charCodeAt(e)]=e;function n(r){var g=r.length;if(g%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var c=r.indexOf("=");return c===-1&&(c=g),[c,c===g?0:4-c%4]}function o(r,g,c){for(var a,h,l=[],s=g;s<c;s+=3)a=(r[s]<<16&16711680)+(r[s+1]<<8&65280)+(255&r[s+2]),l.push(d[(h=a)>>18&63]+d[h>>12&63]+d[h>>6&63]+d[63&h]);return l.join("")}v["-".charCodeAt(0)]=62,v["_".charCodeAt(0)]=63},{}],80:[function(m,G,Y){function d(n,o,r,g,c){for(var a=c+1;g<=c;){var h=g+c>>>1,l=n[h];(r!==void 0?r(l,o):l-o)>=0?(a=h,c=h-1):g=h+1}return a}function v(n,o,r,g,c){for(var a=c+1;g<=c;){var h=g+c>>>1,l=n[h];(r!==void 0?r(l,o):l-o)>0?(a=h,c=h-1):g=h+1}return a}function w(n,o,r,g,c){for(var a=g-1;g<=c;){var h=g+c>>>1,l=n[h];(r!==void 0?r(l,o):l-o)<0?(a=h,g=h+1):c=h-1}return a}function y(n,o,r,g,c){for(var a=g-1;g<=c;){var h=g+c>>>1,l=n[h];(r!==void 0?r(l,o):l-o)<=0?(a=h,g=h+1):c=h-1}return a}function e(n,o,r,g,c){for(;g<=c;){var a=g+c>>>1,h=n[a],l=r!==void 0?r(h,o):h-o;if(l===0)return a;l<=0?g=a+1:c=a-1}return-1}function t(n,o,r,g,c,a){return typeof r=="function"?a(n,o,r,g===void 0?0:0|g,c===void 0?n.length-1:0|c):a(n,o,void 0,r===void 0?0:0|r,g===void 0?n.length-1:0|g)}G.exports={ge:function(n,o,r,g,c){return t(n,o,r,g,c,d)},gt:function(n,o,r,g,c){return t(n,o,r,g,c,v)},lt:function(n,o,r,g,c){return t(n,o,r,g,c,w)},le:function(n,o,r,g,c){return t(n,o,r,g,c,y)},eq:function(n,o,r,g,c){return t(n,o,r,g,c,e)}}},{}],81:[function(m,G,Y){function d(w){var y=32;return(w&=-w)&&y--,65535&w&&(y-=16),16711935&w&&(y-=8),252645135&w&&(y-=4),858993459&w&&(y-=2),1431655765&w&&(y-=1),y}Y.INT_BITS=32,Y.INT_MAX=2147483647,Y.INT_MIN=-1<<31,Y.sign=function(w){return(w>0)-(w<0)},Y.abs=function(w){var y=w>>31;return(w^y)-y},Y.min=function(w,y){return y^(w^y)&-(w<y)},Y.max=function(w,y){return w^(w^y)&-(w<y)},Y.isPow2=function(w){return!(w&w-1||!w)},Y.log2=function(w){var y,e;return y=(w>65535)<<4,y|=e=((w>>>=y)>255)<<3,y|=e=((w>>>=e)>15)<<2,(y|=e=((w>>>=e)>3)<<1)|(w>>>=e)>>1},Y.log10=function(w){return w>=1e9?9:w>=1e8?8:w>=1e7?7:w>=1e6?6:w>=1e5?5:w>=1e4?4:w>=1e3?3:w>=100?2:w>=10?1:0},Y.popCount=function(w){return 16843009*((w=(858993459&(w-=w>>>1&1431655765))+(w>>>2&858993459))+(w>>>4)&252645135)>>>24},Y.countTrailingZeros=d,Y.nextPow2=function(w){return w+=w===0,--w,w|=w>>>1,w|=w>>>2,w|=w>>>4,w|=w>>>8,(w|=w>>>16)+1},Y.prevPow2=function(w){return w|=w>>>1,w|=w>>>2,w|=w>>>4,w|=w>>>8,(w|=w>>>16)-(w>>>1)},Y.parity=function(w){return w^=w>>>16,w^=w>>>8,w^=w>>>4,27030>>>(w&=15)&1};var v=new Array(256);(function(w){for(var y=0;y<256;++y){var e=y,t=y,n=7;for(e>>>=1;e;e>>>=1)t<<=1,t|=1&e,--n;w[y]=t<<n&255}})(v),Y.reverse=function(w){return v[255&w]<<24|v[w>>>8&255]<<16|v[w>>>16&255]<<8|v[w>>>24&255]},Y.interleave2=function(w,y){return(w=1431655765&((w=858993459&((w=252645135&((w=16711935&((w&=65535)|w<<8))|w<<4))|w<<2))|w<<1))|(y=1431655765&((y=858993459&((y=252645135&((y=16711935&((y&=65535)|y<<8))|y<<4))|y<<2))|y<<1))<<1},Y.deinterleave2=function(w,y){return(w=65535&((w=16711935&((w=252645135&((w=858993459&((w=w>>>y&1431655765)|w>>>1))|w>>>2))|w>>>4))|w>>>16))<<16>>16},Y.interleave3=function(w,y,e){return w=1227133513&((w=3272356035&((w=251719695&((w=4278190335&((w&=1023)|w<<16))|w<<8))|w<<4))|w<<2),(w|=(y=1227133513&((y=3272356035&((y=251719695&((y=4278190335&((y&=1023)|y<<16))|y<<8))|y<<4))|y<<2))<<1)|(e=1227133513&((e=3272356035&((e=251719695&((e=4278190335&((e&=1023)|e<<16))|e<<8))|e<<4))|e<<2))<<2},Y.deinterleave3=function(w,y){return(w=1023&((w=4278190335&((w=251719695&((w=3272356035&((w=w>>>y&1227133513)|w>>>2))|w>>>4))|w>>>8))|w>>>16))<<22>>22},Y.nextCombination=function(w){var y=w|w-1;return y+1|(~y&-~y)-1>>>d(w)+1}},{}],82:[function(m,G,Y){var d=m("clamp");G.exports=function(e,t){t||(t={});var n,o,r,g,c,a,h,l,s,p,u,i=t.cutoff==null?.25:t.cutoff,x=t.radius==null?8:t.radius,f=t.channel||0;if(ArrayBuffer.isView(e)||Array.isArray(e)){if(!t.width||!t.height)throw Error("For raw data width and height should be provided by options");n=t.width,o=t.height,g=e,a=t.stride?t.stride:Math.floor(e.length/n/o)}else window.HTMLCanvasElement&&e instanceof window.HTMLCanvasElement?(h=(l=e).getContext("2d"),n=l.width,o=l.height,s=h.getImageData(0,0,n,o),g=s.data,a=4):window.CanvasRenderingContext2D&&e instanceof window.CanvasRenderingContext2D?(l=e.canvas,h=e,n=l.width,o=l.height,s=h.getImageData(0,0,n,o),g=s.data,a=4):window.ImageData&&e instanceof window.ImageData&&(s=e,n=e.width,o=e.height,g=s.data,a=4);if(r=Math.max(n,o),window.Uint8ClampedArray&&g instanceof window.Uint8ClampedArray||window.Uint8Array&&g instanceof window.Uint8Array)for(c=g,g=Array(n*o),p=0,u=c.length;p<u;p++)g[p]=c[p*a+f]/255;else if(a!==1)throw Error("Raw data can have only 1 value per pixel");var _=Array(n*o),b=Array(n*o),T=Array(r),k=Array(r),L=Array(r+1),A=Array(r);for(p=0,u=n*o;p<u;p++){var I=g[p];_[p]=I===1?0:I===0?v:Math.pow(Math.max(0,.5-I),2),b[p]=I===1?v:I===0?0:Math.pow(Math.max(0,I-.5),2)}w(_,n,o,T,k,A,L),w(b,n,o,T,k,A,L);var P=window.Float32Array?new Float32Array(n*o):new Array(n*o);for(p=0,u=n*o;p<u;p++)P[p]=d(1-((_[p]-b[p])/x+i),0,1);return P};var v=1e20;function w(e,t,n,o,r,g,c){for(var a=0;a<t;a++){for(var h=0;h<n;h++)o[h]=e[h*t+a];for(y(o,r,g,c,n),h=0;h<n;h++)e[h*t+a]=r[h]}for(h=0;h<n;h++){for(a=0;a<t;a++)o[a]=e[h*t+a];for(y(o,r,g,c,t),a=0;a<t;a++)e[h*t+a]=Math.sqrt(r[a])}}function y(e,t,n,o,r){n[0]=0,o[0]=-v,o[1]=+v;for(var g=1,c=0;g<r;g++){for(var a=(e[g]+g*g-(e[n[c]]+n[c]*n[c]))/(2*g-2*n[c]);a<=o[c];)c--,a=(e[g]+g*g-(e[n[c]]+n[c]*n[c]))/(2*g-2*n[c]);n[++c]=g,o[c]=a,o[c+1]=+v}for(g=0,c=0;g<r;g++){for(;o[c+1]<g;)c++;t[g]=(g-n[c])*(g-n[c])+e[n[c]]}}},{clamp:86}],83:[function(m,G,Y){},{}],84:[function(m,G,Y){var d,v=typeof Reflect=="object"?Reflect:null,w=v&&typeof v.apply=="function"?v.apply:function(s,p,u){return Function.prototype.apply.call(s,p,u)};d=v&&typeof v.ownKeys=="function"?v.ownKeys:Object.getOwnPropertySymbols?function(s){return Object.getOwnPropertyNames(s).concat(Object.getOwnPropertySymbols(s))}:function(s){return Object.getOwnPropertyNames(s)};var y=Number.isNaN||function(s){return s!=s};function e(){e.init.call(this)}G.exports=e,G.exports.once=function(s,p){return new Promise(function(u,i){function x(){f!==void 0&&s.removeListener("error",f),u([].slice.call(arguments))}var f;p!=="error"&&(f=function(_){s.removeListener(p,x),i(_)},s.once("error",f)),s.once(p,x)})},e.EventEmitter=e,e.prototype._events=void 0,e.prototype._eventsCount=0,e.prototype._maxListeners=void 0;var t=10;function n(s){if(typeof s!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof s)}function o(s){return s._maxListeners===void 0?e.defaultMaxListeners:s._maxListeners}function r(s,p,u,i){var x,f,_,b;if(n(u),(f=s._events)===void 0?(f=s._events=Object.create(null),s._eventsCount=0):(f.newListener!==void 0&&(s.emit("newListener",p,u.listener?u.listener:u),f=s._events),_=f[p]),_===void 0)_=f[p]=u,++s._eventsCount;else if(typeof _=="function"?_=f[p]=i?[u,_]:[_,u]:i?_.unshift(u):_.push(u),(x=o(s))>0&&_.length>x&&!_.warned){_.warned=!0;var T=new Error("Possible EventEmitter memory leak detected. "+_.length+" "+String(p)+" listeners added. Use emitter.setMaxListeners() to increase limit");T.name="MaxListenersExceededWarning",T.emitter=s,T.type=p,T.count=_.length,b=T,console&&console.warn&&console.warn(b)}return s}function g(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function c(s,p,u){var i={fired:!1,wrapFn:void 0,target:s,type:p,listener:u},x=g.bind(i);return x.listener=u,i.wrapFn=x,x}function a(s,p,u){var i=s._events;if(i===void 0)return[];var x=i[p];return x===void 0?[]:typeof x=="function"?u?[x.listener||x]:[x]:u?function(f){for(var _=new Array(f.length),b=0;b<_.length;++b)_[b]=f[b].listener||f[b];return _}(x):l(x,x.length)}function h(s){var p=this._events;if(p!==void 0){var u=p[s];if(typeof u=="function")return 1;if(u!==void 0)return u.length}return 0}function l(s,p){for(var u=new Array(p),i=0;i<p;++i)u[i]=s[i];return u}Object.defineProperty(e,"defaultMaxListeners",{enumerable:!0,get:function(){return t},set:function(s){if(typeof s!="number"||s<0||y(s))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+s+".");t=s}}),e.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},e.prototype.setMaxListeners=function(s){if(typeof s!="number"||s<0||y(s))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+s+".");return this._maxListeners=s,this},e.prototype.getMaxListeners=function(){return o(this)},e.prototype.emit=function(s){for(var p=[],u=1;u<arguments.length;u++)p.push(arguments[u]);var i=s==="error",x=this._events;if(x!==void 0)i=i&&x.error===void 0;else if(!i)return!1;if(i){var f;if(p.length>0&&(f=p[0]),f instanceof Error)throw f;var _=new Error("Unhandled error."+(f?" ("+f.message+")":""));throw _.context=f,_}var b=x[s];if(b===void 0)return!1;if(typeof b=="function")w(b,this,p);else{var T=b.length,k=l(b,T);for(u=0;u<T;++u)w(k[u],this,p)}return!0},e.prototype.addListener=function(s,p){return r(this,s,p,!1)},e.prototype.on=e.prototype.addListener,e.prototype.prependListener=function(s,p){return r(this,s,p,!0)},e.prototype.once=function(s,p){return n(p),this.on(s,c(this,s,p)),this},e.prototype.prependOnceListener=function(s,p){return n(p),this.prependListener(s,c(this,s,p)),this},e.prototype.removeListener=function(s,p){var u,i,x,f,_;if(n(p),(i=this._events)===void 0)return this;if((u=i[s])===void 0)return this;if(u===p||u.listener===p)--this._eventsCount==0?this._events=Object.create(null):(delete i[s],i.removeListener&&this.emit("removeListener",s,u.listener||p));else if(typeof u!="function"){for(x=-1,f=u.length-1;f>=0;f--)if(u[f]===p||u[f].listener===p){_=u[f].listener,x=f;break}if(x<0)return this;x===0?u.shift():function(b,T){for(;T+1<b.length;T++)b[T]=b[T+1];b.pop()}(u,x),u.length===1&&(i[s]=u[0]),i.removeListener!==void 0&&this.emit("removeListener",s,_||p)}return this},e.prototype.off=e.prototype.removeListener,e.prototype.removeAllListeners=function(s){var p,u,i;if((u=this._events)===void 0)return this;if(u.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):u[s]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete u[s]),this;if(arguments.length===0){var x,f=Object.keys(u);for(i=0;i<f.length;++i)(x=f[i])!=="removeListener"&&this.removeAllListeners(x);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(p=u[s])=="function")this.removeListener(s,p);else if(p!==void 0)for(i=p.length-1;i>=0;i--)this.removeListener(s,p[i]);return this},e.prototype.listeners=function(s){return a(this,s,!0)},e.prototype.rawListeners=function(s){return a(this,s,!1)},e.listenerCount=function(s,p){return typeof s.listenerCount=="function"?s.listenerCount(p):h.call(s,p)},e.prototype.listenerCount=h,e.prototype.eventNames=function(){return this._eventsCount>0?d(this._events):[]}},{}],85:[function(m,G,Y){(function(d){(function(){var v=m("base64-js"),w=m("ieee754");Y.Buffer=e,Y.SlowBuffer=function(H){return+H!=H&&(H=0),e.alloc(+H)},Y.INSPECT_MAX_BYTES=50;function y(H){if(H>2147483647)throw new RangeError('The value "'+H+'" is invalid for option "size"');var N=new Uint8Array(H);return N.__proto__=e.prototype,N}function e(H,N,U){if(typeof H=="number"){if(typeof N=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return o(H)}return t(H,N,U)}function t(H,N,U){if(typeof H=="string")return function(K,J){if(typeof J=="string"&&J!==""||(J="utf8"),!e.isEncoding(J))throw new TypeError("Unknown encoding: "+J);var ee=0|c(K,J),ne=y(ee),se=ne.write(K,J);return se!==ee&&(ne=ne.slice(0,se)),ne}(H,N);if(ArrayBuffer.isView(H))return r(H);if(H==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof H);if($(H,ArrayBuffer)||H&&$(H.buffer,ArrayBuffer))return function(K,J,ee){if(J<0||K.byteLength<J)throw new RangeError('"offset" is outside of buffer bounds');if(K.byteLength<J+(ee||0))throw new RangeError('"length" is outside of buffer bounds');var ne;return ne=J===void 0&&ee===void 0?new Uint8Array(K):ee===void 0?new Uint8Array(K,J):new Uint8Array(K,J,ee),ne.__proto__=e.prototype,ne}(H,N,U);if(typeof H=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var te=H.valueOf&&H.valueOf();if(te!=null&&te!==H)return e.from(te,N,U);var B=function(K){if(e.isBuffer(K)){var J=0|g(K.length),ee=y(J);return ee.length===0||K.copy(ee,0,0,J),ee}if(K.length!==void 0)return typeof K.length!="number"||re(K.length)?y(0):r(K);if(K.type==="Buffer"&&Array.isArray(K.data))return r(K.data)}(H);if(B)return B;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof H[Symbol.toPrimitive]=="function")return e.from(H[Symbol.toPrimitive]("string"),N,U);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof H)}function n(H){if(typeof H!="number")throw new TypeError('"size" argument must be of type number');if(H<0)throw new RangeError('The value "'+H+'" is invalid for option "size"')}function o(H){return n(H),y(H<0?0:0|g(H))}function r(H){for(var N=H.length<0?0:0|g(H.length),U=y(N),te=0;te<N;te+=1)U[te]=255&H[te];return U}function g(H){if(H>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|H}function c(H,N){if(e.isBuffer(H))return H.length;if(ArrayBuffer.isView(H)||$(H,ArrayBuffer))return H.byteLength;if(typeof H!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof H);var U=H.length,te=arguments.length>2&&arguments[2]===!0;if(!te&&U===0)return 0;for(var B=!1;;)switch(N){case"ascii":case"latin1":case"binary":return U;case"utf8":case"utf-8":return Z(H).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*U;case"hex":return U>>>1;case"base64":return Q(H).length;default:if(B)return te?-1:Z(H).length;N=(""+N).toLowerCase(),B=!0}}function a(H,N,U){var te=!1;if((N===void 0||N<0)&&(N=0),N>this.length||((U===void 0||U>this.length)&&(U=this.length),U<=0)||(U>>>=0)<=(N>>>=0))return"";for(H||(H="utf8");;)switch(H){case"hex":return A(this,N,U);case"utf8":case"utf-8":return T(this,N,U);case"ascii":return k(this,N,U);case"latin1":case"binary":return L(this,N,U);case"base64":return b(this,N,U);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,N,U);default:if(te)throw new TypeError("Unknown encoding: "+H);H=(H+"").toLowerCase(),te=!0}}function h(H,N,U){var te=H[N];H[N]=H[U],H[U]=te}function l(H,N,U,te,B){if(H.length===0)return-1;if(typeof U=="string"?(te=U,U=0):U>2147483647?U=2147483647:U<-2147483648&&(U=-2147483648),re(U=+U)&&(U=B?0:H.length-1),U<0&&(U=H.length+U),U>=H.length){if(B)return-1;U=H.length-1}else if(U<0){if(!B)return-1;U=0}if(typeof N=="string"&&(N=e.from(N,te)),e.isBuffer(N))return N.length===0?-1:s(H,N,U,te,B);if(typeof N=="number")return N&=255,typeof Uint8Array.prototype.indexOf=="function"?B?Uint8Array.prototype.indexOf.call(H,N,U):Uint8Array.prototype.lastIndexOf.call(H,N,U):s(H,[N],U,te,B);throw new TypeError("val must be string, number or Buffer")}function s(H,N,U,te,B){var K,J=1,ee=H.length,ne=N.length;if(te!==void 0&&((te=String(te).toLowerCase())==="ucs2"||te==="ucs-2"||te==="utf16le"||te==="utf-16le")){if(H.length<2||N.length<2)return-1;J=2,ee/=2,ne/=2,U/=2}function se(ye,Se){return J===1?ye[Se]:ye.readUInt16BE(Se*J)}if(B){var oe=-1;for(K=U;K<ee;K++)if(se(H,K)===se(N,oe===-1?0:K-oe)){if(oe===-1&&(oe=K),K-oe+1===ne)return oe*J}else oe!==-1&&(K-=K-oe),oe=-1}else for(U+ne>ee&&(U=ee-ne),K=U;K>=0;K--){for(var me=!0,ce=0;ce<ne;ce++)if(se(H,K+ce)!==se(N,ce)){me=!1;break}if(me)return K}return-1}function p(H,N,U,te){U=Number(U)||0;var B=H.length-U;te?(te=Number(te))>B&&(te=B):te=B;var K=N.length;te>K/2&&(te=K/2);for(var J=0;J<te;++J){var ee=parseInt(N.substr(2*J,2),16);if(re(ee))return J;H[U+J]=ee}return J}function u(H,N,U,te){return X(Z(N,H.length-U),H,U,te)}function i(H,N,U,te){return X(function(B){for(var K=[],J=0;J<B.length;++J)K.push(255&B.charCodeAt(J));return K}(N),H,U,te)}function x(H,N,U,te){return i(H,N,U,te)}function f(H,N,U,te){return X(Q(N),H,U,te)}function _(H,N,U,te){return X(function(B,K){for(var J,ee,ne,se=[],oe=0;oe<B.length&&!((K-=2)<0);++oe)J=B.charCodeAt(oe),ee=J>>8,ne=J%256,se.push(ne),se.push(ee);return se}(N,H.length-U),H,U,te)}function b(H,N,U){return N===0&&U===H.length?v.fromByteArray(H):v.fromByteArray(H.slice(N,U))}function T(H,N,U){U=Math.min(H.length,U);for(var te=[],B=N;B<U;){var K,J,ee,ne,se=H[B],oe=null,me=se>239?4:se>223?3:se>191?2:1;if(B+me<=U)switch(me){case 1:se<128&&(oe=se);break;case 2:(192&(K=H[B+1]))==128&&(ne=(31&se)<<6|63&K)>127&&(oe=ne);break;case 3:K=H[B+1],J=H[B+2],(192&K)==128&&(192&J)==128&&(ne=(15&se)<<12|(63&K)<<6|63&J)>2047&&(ne<55296||ne>57343)&&(oe=ne);break;case 4:K=H[B+1],J=H[B+2],ee=H[B+3],(192&K)==128&&(192&J)==128&&(192&ee)==128&&(ne=(15&se)<<18|(63&K)<<12|(63&J)<<6|63&ee)>65535&&ne<1114112&&(oe=ne)}oe===null?(oe=65533,me=1):oe>65535&&(oe-=65536,te.push(oe>>>10&1023|55296),oe=56320|1023&oe),te.push(oe),B+=me}return function(ce){var ye=ce.length;if(ye<=4096)return String.fromCharCode.apply(String,ce);for(var Se="",fe=0;fe<ye;)Se+=String.fromCharCode.apply(String,ce.slice(fe,fe+=4096));return Se}(te)}Y.kMaxLength=2147483647,e.TYPED_ARRAY_SUPPORT=function(){try{var H=new Uint8Array(1);return H.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},H.foo()===42}catch{return!1}}(),e.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(e.prototype,"parent",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.buffer}}),Object.defineProperty(e.prototype,"offset",{enumerable:!0,get:function(){if(e.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&e[Symbol.species]===e&&Object.defineProperty(e,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),e.poolSize=8192,e.from=function(H,N,U){return t(H,N,U)},e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array,e.alloc=function(H,N,U){return function(te,B,K){return n(te),te<=0?y(te):B!==void 0?typeof K=="string"?y(te).fill(B,K):y(te).fill(B):y(te)}(H,N,U)},e.allocUnsafe=function(H){return o(H)},e.allocUnsafeSlow=function(H){return o(H)},e.isBuffer=function(H){return H!=null&&H._isBuffer===!0&&H!==e.prototype},e.compare=function(H,N){if($(H,Uint8Array)&&(H=e.from(H,H.offset,H.byteLength)),$(N,Uint8Array)&&(N=e.from(N,N.offset,N.byteLength)),!e.isBuffer(H)||!e.isBuffer(N))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(H===N)return 0;for(var U=H.length,te=N.length,B=0,K=Math.min(U,te);B<K;++B)if(H[B]!==N[B]){U=H[B],te=N[B];break}return U<te?-1:te<U?1:0},e.isEncoding=function(H){switch(String(H).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(H,N){if(!Array.isArray(H))throw new TypeError('"list" argument must be an Array of Buffers');if(H.length===0)return e.alloc(0);var U;if(N===void 0)for(N=0,U=0;U<H.length;++U)N+=H[U].length;var te=e.allocUnsafe(N),B=0;for(U=0;U<H.length;++U){var K=H[U];if($(K,Uint8Array)&&(K=e.from(K)),!e.isBuffer(K))throw new TypeError('"list" argument must be an Array of Buffers');K.copy(te,B),B+=K.length}return te},e.byteLength=c,e.prototype._isBuffer=!0,e.prototype.swap16=function(){var H=this.length;if(H%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var N=0;N<H;N+=2)h(this,N,N+1);return this},e.prototype.swap32=function(){var H=this.length;if(H%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var N=0;N<H;N+=4)h(this,N,N+3),h(this,N+1,N+2);return this},e.prototype.swap64=function(){var H=this.length;if(H%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var N=0;N<H;N+=8)h(this,N,N+7),h(this,N+1,N+6),h(this,N+2,N+5),h(this,N+3,N+4);return this},e.prototype.toString=function(){var H=this.length;return H===0?"":arguments.length===0?T(this,0,H):a.apply(this,arguments)},e.prototype.toLocaleString=e.prototype.toString,e.prototype.equals=function(H){if(!e.isBuffer(H))throw new TypeError("Argument must be a Buffer");return this===H||e.compare(this,H)===0},e.prototype.inspect=function(){var H="",N=Y.INSPECT_MAX_BYTES;return H=this.toString("hex",0,N).replace(/(.{2})/g,"$1 ").trim(),this.length>N&&(H+=" ... "),"<Buffer "+H+">"},e.prototype.compare=function(H,N,U,te,B){if($(H,Uint8Array)&&(H=e.from(H,H.offset,H.byteLength)),!e.isBuffer(H))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof H);if(N===void 0&&(N=0),U===void 0&&(U=H?H.length:0),te===void 0&&(te=0),B===void 0&&(B=this.length),N<0||U>H.length||te<0||B>this.length)throw new RangeError("out of range index");if(te>=B&&N>=U)return 0;if(te>=B)return-1;if(N>=U)return 1;if(this===H)return 0;for(var K=(B>>>=0)-(te>>>=0),J=(U>>>=0)-(N>>>=0),ee=Math.min(K,J),ne=this.slice(te,B),se=H.slice(N,U),oe=0;oe<ee;++oe)if(ne[oe]!==se[oe]){K=ne[oe],J=se[oe];break}return K<J?-1:J<K?1:0},e.prototype.includes=function(H,N,U){return this.indexOf(H,N,U)!==-1},e.prototype.indexOf=function(H,N,U){return l(this,H,N,U,!0)},e.prototype.lastIndexOf=function(H,N,U){return l(this,H,N,U,!1)},e.prototype.write=function(H,N,U,te){if(N===void 0)te="utf8",U=this.length,N=0;else if(U===void 0&&typeof N=="string")te=N,U=this.length,N=0;else{if(!isFinite(N))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");N>>>=0,isFinite(U)?(U>>>=0,te===void 0&&(te="utf8")):(te=U,U=void 0)}var B=this.length-N;if((U===void 0||U>B)&&(U=B),H.length>0&&(U<0||N<0)||N>this.length)throw new RangeError("Attempt to write outside buffer bounds");te||(te="utf8");for(var K=!1;;)switch(te){case"hex":return p(this,H,N,U);case"utf8":case"utf-8":return u(this,H,N,U);case"ascii":return i(this,H,N,U);case"latin1":case"binary":return x(this,H,N,U);case"base64":return f(this,H,N,U);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,H,N,U);default:if(K)throw new TypeError("Unknown encoding: "+te);te=(""+te).toLowerCase(),K=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function k(H,N,U){var te="";U=Math.min(H.length,U);for(var B=N;B<U;++B)te+=String.fromCharCode(127&H[B]);return te}function L(H,N,U){var te="";U=Math.min(H.length,U);for(var B=N;B<U;++B)te+=String.fromCharCode(H[B]);return te}function A(H,N,U){var te=H.length;(!N||N<0)&&(N=0),(!U||U<0||U>te)&&(U=te);for(var B="",K=N;K<U;++K)B+=V(H[K]);return B}function I(H,N,U){for(var te=H.slice(N,U),B="",K=0;K<te.length;K+=2)B+=String.fromCharCode(te[K]+256*te[K+1]);return B}function P(H,N,U){if(H%1!=0||H<0)throw new RangeError("offset is not uint");if(H+N>U)throw new RangeError("Trying to access beyond buffer length")}function S(H,N,U,te,B,K){if(!e.isBuffer(H))throw new TypeError('"buffer" argument must be a Buffer instance');if(N>B||N<K)throw new RangeError('"value" argument is out of bounds');if(U+te>H.length)throw new RangeError("Index out of range")}function E(H,N,U,te,B,K){if(U+te>H.length)throw new RangeError("Index out of range");if(U<0)throw new RangeError("Index out of range")}function z(H,N,U,te,B){return N=+N,U>>>=0,B||E(H,0,U,4),w.write(H,N,U,te,23,4),U+4}function D(H,N,U,te,B){return N=+N,U>>>=0,B||E(H,0,U,8),w.write(H,N,U,te,52,8),U+8}e.prototype.slice=function(H,N){var U=this.length;(H=~~H)<0?(H+=U)<0&&(H=0):H>U&&(H=U),(N=N===void 0?U:~~N)<0?(N+=U)<0&&(N=0):N>U&&(N=U),N<H&&(N=H);var te=this.subarray(H,N);return te.__proto__=e.prototype,te},e.prototype.readUIntLE=function(H,N,U){H>>>=0,N>>>=0,U||P(H,N,this.length);for(var te=this[H],B=1,K=0;++K<N&&(B*=256);)te+=this[H+K]*B;return te},e.prototype.readUIntBE=function(H,N,U){H>>>=0,N>>>=0,U||P(H,N,this.length);for(var te=this[H+--N],B=1;N>0&&(B*=256);)te+=this[H+--N]*B;return te},e.prototype.readUInt8=function(H,N){return H>>>=0,N||P(H,1,this.length),this[H]},e.prototype.readUInt16LE=function(H,N){return H>>>=0,N||P(H,2,this.length),this[H]|this[H+1]<<8},e.prototype.readUInt16BE=function(H,N){return H>>>=0,N||P(H,2,this.length),this[H]<<8|this[H+1]},e.prototype.readUInt32LE=function(H,N){return H>>>=0,N||P(H,4,this.length),(this[H]|this[H+1]<<8|this[H+2]<<16)+16777216*this[H+3]},e.prototype.readUInt32BE=function(H,N){return H>>>=0,N||P(H,4,this.length),16777216*this[H]+(this[H+1]<<16|this[H+2]<<8|this[H+3])},e.prototype.readIntLE=function(H,N,U){H>>>=0,N>>>=0,U||P(H,N,this.length);for(var te=this[H],B=1,K=0;++K<N&&(B*=256);)te+=this[H+K]*B;return te>=(B*=128)&&(te-=Math.pow(2,8*N)),te},e.prototype.readIntBE=function(H,N,U){H>>>=0,N>>>=0,U||P(H,N,this.length);for(var te=N,B=1,K=this[H+--te];te>0&&(B*=256);)K+=this[H+--te]*B;return K>=(B*=128)&&(K-=Math.pow(2,8*N)),K},e.prototype.readInt8=function(H,N){return H>>>=0,N||P(H,1,this.length),128&this[H]?-1*(255-this[H]+1):this[H]},e.prototype.readInt16LE=function(H,N){H>>>=0,N||P(H,2,this.length);var U=this[H]|this[H+1]<<8;return 32768&U?4294901760|U:U},e.prototype.readInt16BE=function(H,N){H>>>=0,N||P(H,2,this.length);var U=this[H+1]|this[H]<<8;return 32768&U?4294901760|U:U},e.prototype.readInt32LE=function(H,N){return H>>>=0,N||P(H,4,this.length),this[H]|this[H+1]<<8|this[H+2]<<16|this[H+3]<<24},e.prototype.readInt32BE=function(H,N){return H>>>=0,N||P(H,4,this.length),this[H]<<24|this[H+1]<<16|this[H+2]<<8|this[H+3]},e.prototype.readFloatLE=function(H,N){return H>>>=0,N||P(H,4,this.length),w.read(this,H,!0,23,4)},e.prototype.readFloatBE=function(H,N){return H>>>=0,N||P(H,4,this.length),w.read(this,H,!1,23,4)},e.prototype.readDoubleLE=function(H,N){return H>>>=0,N||P(H,8,this.length),w.read(this,H,!0,52,8)},e.prototype.readDoubleBE=function(H,N){return H>>>=0,N||P(H,8,this.length),w.read(this,H,!1,52,8)},e.prototype.writeUIntLE=function(H,N,U,te){H=+H,N>>>=0,U>>>=0,te||S(this,H,N,U,Math.pow(2,8*U)-1,0);var B=1,K=0;for(this[N]=255&H;++K<U&&(B*=256);)this[N+K]=H/B&255;return N+U},e.prototype.writeUIntBE=function(H,N,U,te){H=+H,N>>>=0,U>>>=0,te||S(this,H,N,U,Math.pow(2,8*U)-1,0);var B=U-1,K=1;for(this[N+B]=255&H;--B>=0&&(K*=256);)this[N+B]=H/K&255;return N+U},e.prototype.writeUInt8=function(H,N,U){return H=+H,N>>>=0,U||S(this,H,N,1,255,0),this[N]=255&H,N+1},e.prototype.writeUInt16LE=function(H,N,U){return H=+H,N>>>=0,U||S(this,H,N,2,65535,0),this[N]=255&H,this[N+1]=H>>>8,N+2},e.prototype.writeUInt16BE=function(H,N,U){return H=+H,N>>>=0,U||S(this,H,N,2,65535,0),this[N]=H>>>8,this[N+1]=255&H,N+2},e.prototype.writeUInt32LE=function(H,N,U){return H=+H,N>>>=0,U||S(this,H,N,4,4294967295,0),this[N+3]=H>>>24,this[N+2]=H>>>16,this[N+1]=H>>>8,this[N]=255&H,N+4},e.prototype.writeUInt32BE=function(H,N,U){return H=+H,N>>>=0,U||S(this,H,N,4,4294967295,0),this[N]=H>>>24,this[N+1]=H>>>16,this[N+2]=H>>>8,this[N+3]=255&H,N+4},e.prototype.writeIntLE=function(H,N,U,te){if(H=+H,N>>>=0,!te){var B=Math.pow(2,8*U-1);S(this,H,N,U,B-1,-B)}var K=0,J=1,ee=0;for(this[N]=255&H;++K<U&&(J*=256);)H<0&&ee===0&&this[N+K-1]!==0&&(ee=1),this[N+K]=(H/J>>0)-ee&255;return N+U},e.prototype.writeIntBE=function(H,N,U,te){if(H=+H,N>>>=0,!te){var B=Math.pow(2,8*U-1);S(this,H,N,U,B-1,-B)}var K=U-1,J=1,ee=0;for(this[N+K]=255&H;--K>=0&&(J*=256);)H<0&&ee===0&&this[N+K+1]!==0&&(ee=1),this[N+K]=(H/J>>0)-ee&255;return N+U},e.prototype.writeInt8=function(H,N,U){return H=+H,N>>>=0,U||S(this,H,N,1,127,-128),H<0&&(H=255+H+1),this[N]=255&H,N+1},e.prototype.writeInt16LE=function(H,N,U){return H=+H,N>>>=0,U||S(this,H,N,2,32767,-32768),this[N]=255&H,this[N+1]=H>>>8,N+2},e.prototype.writeInt16BE=function(H,N,U){return H=+H,N>>>=0,U||S(this,H,N,2,32767,-32768),this[N]=H>>>8,this[N+1]=255&H,N+2},e.prototype.writeInt32LE=function(H,N,U){return H=+H,N>>>=0,U||S(this,H,N,4,2147483647,-2147483648),this[N]=255&H,this[N+1]=H>>>8,this[N+2]=H>>>16,this[N+3]=H>>>24,N+4},e.prototype.writeInt32BE=function(H,N,U){return H=+H,N>>>=0,U||S(this,H,N,4,2147483647,-2147483648),H<0&&(H=4294967295+H+1),this[N]=H>>>24,this[N+1]=H>>>16,this[N+2]=H>>>8,this[N+3]=255&H,N+4},e.prototype.writeFloatLE=function(H,N,U){return z(this,H,N,!0,U)},e.prototype.writeFloatBE=function(H,N,U){return z(this,H,N,!1,U)},e.prototype.writeDoubleLE=function(H,N,U){return D(this,H,N,!0,U)},e.prototype.writeDoubleBE=function(H,N,U){return D(this,H,N,!1,U)},e.prototype.copy=function(H,N,U,te){if(!e.isBuffer(H))throw new TypeError("argument should be a Buffer");if(U||(U=0),te||te===0||(te=this.length),N>=H.length&&(N=H.length),N||(N=0),te>0&&te<U&&(te=U),te===U||H.length===0||this.length===0)return 0;if(N<0)throw new RangeError("targetStart out of bounds");if(U<0||U>=this.length)throw new RangeError("Index out of range");if(te<0)throw new RangeError("sourceEnd out of bounds");te>this.length&&(te=this.length),H.length-N<te-U&&(te=H.length-N+U);var B=te-U;if(this===H&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(N,U,te);else if(this===H&&U<N&&N<te)for(var K=B-1;K>=0;--K)H[K+N]=this[K+U];else Uint8Array.prototype.set.call(H,this.subarray(U,te),N);return B},e.prototype.fill=function(H,N,U,te){if(typeof H=="string"){if(typeof N=="string"?(te=N,N=0,U=this.length):typeof U=="string"&&(te=U,U=this.length),te!==void 0&&typeof te!="string")throw new TypeError("encoding must be a string");if(typeof te=="string"&&!e.isEncoding(te))throw new TypeError("Unknown encoding: "+te);if(H.length===1){var B=H.charCodeAt(0);(te==="utf8"&&B<128||te==="latin1")&&(H=B)}}else typeof H=="number"&&(H&=255);if(N<0||this.length<N||this.length<U)throw new RangeError("Out of range index");if(U<=N)return this;var K;if(N>>>=0,U=U===void 0?this.length:U>>>0,H||(H=0),typeof H=="number")for(K=N;K<U;++K)this[K]=H;else{var J=e.isBuffer(H)?H:e.from(H,te),ee=J.length;if(ee===0)throw new TypeError('The value "'+H+'" is invalid for argument "value"');for(K=0;K<U-N;++K)this[K+N]=J[K%ee]}return this};var j=/[^+/0-9A-Za-z-_]/g;function V(H){return H<16?"0"+H.toString(16):H.toString(16)}function Z(H,N){var U;N=N||1/0;for(var te=H.length,B=null,K=[],J=0;J<te;++J){if((U=H.charCodeAt(J))>55295&&U<57344){if(!B){if(U>56319){(N-=3)>-1&&K.push(239,191,189);continue}if(J+1===te){(N-=3)>-1&&K.push(239,191,189);continue}B=U;continue}if(U<56320){(N-=3)>-1&&K.push(239,191,189),B=U;continue}U=65536+(B-55296<<10|U-56320)}else B&&(N-=3)>-1&&K.push(239,191,189);if(B=null,U<128){if((N-=1)<0)break;K.push(U)}else if(U<2048){if((N-=2)<0)break;K.push(U>>6|192,63&U|128)}else if(U<65536){if((N-=3)<0)break;K.push(U>>12|224,U>>6&63|128,63&U|128)}else{if(!(U<1114112))throw new Error("Invalid code point");if((N-=4)<0)break;K.push(U>>18|240,U>>12&63|128,U>>6&63|128,63&U|128)}}return K}function Q(H){return v.toByteArray(function(N){if((N=(N=N.split("=")[0]).trim().replace(j,"")).length<2)return"";for(;N.length%4!=0;)N+="=";return N}(H))}function X(H,N,U,te){for(var B=0;B<te&&!(B+U>=N.length||B>=H.length);++B)N[B+U]=H[B];return B}function $(H,N){return H instanceof N||H!=null&&H.constructor!=null&&H.constructor.name!=null&&H.constructor.name===N.name}function re(H){return H!=H}}).call(this)}).call(this,m("buffer").Buffer)},{"base64-js":79,buffer:85,ieee754:230}],86:[function(m,G,Y){G.exports=function(d,v,w){return v<w?d<v?v:d>w?w:d:d<w?w:d>v?v:d}},{}],87:[function(m,G,Y){var d=m("clamp");function v(w,y){y==null&&(y=!0);var e=w[0],t=w[1],n=w[2],o=w[3];return o==null&&(o=y?1:255),y&&(e*=255,t*=255,n*=255,o*=255),16777216*(e=255&d(e,0,255))+((t=255&d(t,0,255))<<16)+((n=255&d(n,0,255))<<8)+(o=255&d(o,0,255))}G.exports=v,G.exports.to=v,G.exports.from=function(w,y){var e=(w=+w)>>>24,t=(16711680&w)>>>16,n=(65280&w)>>>8,o=255&w;return y===!1?[e,t,n,o]:[e/255,t/255,n/255,o/255]}},{clamp:86}],88:[function(m,G,Y){G.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],89:[function(m,G,Y){var d=m("color-rgba"),v=m("clamp"),w=m("dtype");G.exports=function(y,e){e!=="float"&&e||(e="array"),e==="uint"&&(e="uint8"),e==="uint_clamped"&&(e="uint8_clamped");var t=new(w(e))(4),n=e!=="uint8"&&e!=="uint8_clamped";return y.length&&typeof y!="string"||((y=d(y))[0]/=255,y[1]/=255,y[2]/=255),function(o){return o instanceof Uint8Array||o instanceof Uint8ClampedArray||!!(Array.isArray(o)&&(o[0]>1||o[0]===0)&&(o[1]>1||o[1]===0)&&(o[2]>1||o[2]===0)&&(!o[3]||o[3]>1))}(y)?(t[0]=y[0],t[1]=y[1],t[2]=y[2],t[3]=y[3]!=null?y[3]:255,n&&(t[0]/=255,t[1]/=255,t[2]/=255,t[3]/=255),t):(n?(t[0]=y[0],t[1]=y[1],t[2]=y[2],t[3]=y[3]!=null?y[3]:1):(t[0]=v(Math.floor(255*y[0]),0,255),t[1]=v(Math.floor(255*y[1]),0,255),t[2]=v(Math.floor(255*y[2]),0,255),t[3]=y[3]==null?255:v(Math.floor(255*y[3]),0,255)),t)}},{clamp:86,"color-rgba":91,dtype:127}],90:[function(m,G,Y){(function(d){(function(){var v=m("color-name"),w=m("is-plain-obj"),y=m("defined");G.exports=function(t){var n,o,r=[],g=1;if(typeof t=="string")if(v[t])r=v[t].slice(),o="rgb";else if(t==="transparent")g=0,o="rgb",r=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(t)){var c=(l=t.slice(1)).length;g=1,c<=4?(r=[parseInt(l[0]+l[0],16),parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16)],c===4&&(g=parseInt(l[3]+l[3],16)/255)):(r=[parseInt(l[0]+l[1],16),parseInt(l[2]+l[3],16),parseInt(l[4]+l[5],16)],c===8&&(g=parseInt(l[6]+l[7],16)/255)),r[0]||(r[0]=0),r[1]||(r[1]=0),r[2]||(r[2]=0),o="rgb"}else if(n=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(t)){var a=n[1],h=a==="rgb",l=a.replace(/a$/,"");o=l,c=l==="cmyk"?4:l==="gray"?1:3,r=n[2].trim().split(/\s*,\s*/).map(function(p,u){if(/%$/.test(p))return u===c?parseFloat(p)/100:l==="rgb"?255*parseFloat(p)/100:parseFloat(p);if(l[u]==="h"){if(/deg$/.test(p))return parseFloat(p);if(e[p]!==void 0)return e[p]}return parseFloat(p)}),a===l&&r.push(1),g=h||r[c]===void 0?1:r[c],r=r.slice(0,c)}else t.length>10&&/[0-9](?:\s|\/)/.test(t)&&(r=t.match(/([0-9]+)/g).map(function(p){return parseFloat(p)}),o=t.match(/([a-z])/gi).join("").toLowerCase());else if(isNaN(t))if(w(t)){var s=y(t.r,t.red,t.R,null);s!==null?(o="rgb",r=[s,y(t.g,t.green,t.G),y(t.b,t.blue,t.B)]):(o="hsl",r=[y(t.h,t.hue,t.H),y(t.s,t.saturation,t.S),y(t.l,t.lightness,t.L,t.b,t.brightness)]),g=y(t.a,t.alpha,t.opacity,1),t.opacity!=null&&(g/=100)}else(Array.isArray(t)||d.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(t))&&(r=[t[0],t[1],t[2]],o="rgb",g=t.length===4?t[3]:1);else o="rgb",r=[t>>>16,(65280&t)>>>8,255&t];return{space:o,values:r,alpha:g}};var e={red:0,orange:60,yellow:120,green:180,blue:240,purple:300}}).call(this)}).call(this,typeof Ka<"u"?Ka:typeof self<"u"?self:typeof window<"u"?window:{})},{"color-name":88,defined:124,"is-plain-obj":236}],91:[function(m,G,Y){var d=m("color-parse"),v=m("color-space/hsl"),w=m("clamp");G.exports=function(y){var e,t=d(y);return t.space?((e=Array(3))[0]=w(t.values[0],0,255),e[1]=w(t.values[1],0,255),e[2]=w(t.values[2],0,255),t.space[0]==="h"&&(e=v.rgb(e)),e.push(w(t.alpha,0,1)),e):[]}},{clamp:86,"color-parse":90,"color-space/hsl":92}],92:[function(m,G,Y){var d=m("./rgb");G.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(v){var w,y,e,t,n,o=v[0]/360,r=v[1]/100,g=v[2]/100;if(r===0)return[n=255*g,n,n];w=2*g-(y=g<.5?g*(1+r):g+r-g*r),t=[0,0,0];for(var c=0;c<3;c++)(e=o+1/3*-(c-1))<0?e++:e>1&&e--,n=6*e<1?w+6*(y-w)*e:2*e<1?y:3*e<2?w+(y-w)*(2/3-e)*6:w,t[c]=255*n;return t}},d.hsl=function(v){var w,y,e=v[0]/255,t=v[1]/255,n=v[2]/255,o=Math.min(e,t,n),r=Math.max(e,t,n),g=r-o;return r===o?w=0:e===r?w=(t-n)/g:t===r?w=2+(n-e)/g:n===r&&(w=4+(e-t)/g),(w=Math.min(60*w,360))<0&&(w+=360),y=(o+r)/2,[w,100*(r===o?0:y<=.5?g/(r+o):g/(2-r-o)),100*y]}},{"./rgb":93}],93:[function(m,G,Y){G.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],94:[function(m,G,Y){G.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|\xE7)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|\xE9)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|\xE9)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|\xE3)o.?tom(e|\xE9)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],95:[function(m,G,Y){G.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],96:[function(m,G,Y){G.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],97:[function(m,G,Y){G.exports=["normal","italic","oblique"]},{}],98:[function(m,G,Y){G.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],99:[function(m,G,Y){G.exports={parse:m("./parse"),stringify:m("./stringify")}},{"./parse":101,"./stringify":102}],100:[function(m,G,Y){var d=m("css-font-size-keywords");G.exports={isSize:function(v){return/^[\d\.]/.test(v)||v.indexOf("/")!==-1||d.indexOf(v)!==-1}}},{"css-font-size-keywords":95}],101:[function(m,G,Y){var d=m("unquote"),v=m("css-global-keywords"),w=m("css-system-font-keywords"),y=m("css-font-weight-keywords"),e=m("css-font-style-keywords"),t=m("css-font-stretch-keywords"),n=m("string-split-by"),o=m("./lib/util").isSize;G.exports=g;var r=g.cache={};function g(a){if(typeof a!="string")throw new Error("Font argument must be a string.");if(r[a])return r[a];if(a==="")throw new Error("Cannot parse an empty string.");if(w.indexOf(a)!==-1)return r[a]={system:a};for(var h,l={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},s=n(a,/\s+/);h=s.shift();){if(v.indexOf(h)!==-1)return["style","variant","weight","stretch"].forEach(function(u){l[u]=h}),r[a]=l;if(e.indexOf(h)===-1)if(h!=="normal"&&h!=="small-caps")if(t.indexOf(h)===-1){if(y.indexOf(h)===-1){if(o(h)){var p=n(h,"/");if(l.size=p[0],p[1]!=null?l.lineHeight=c(p[1]):s[0]==="/"&&(s.shift(),l.lineHeight=c(s.shift())),!s.length)throw new Error("Missing required font-family.");return l.family=n(s.join(" "),/\s*,\s*/).map(d),r[a]=l}throw new Error("Unknown or unsupported font token: "+h)}l.weight=h}else l.stretch=h;else l.variant=h;else l.style=h}throw new Error("Missing required font-size.")}function c(a){var h=parseFloat(a);return h.toString()===a?h:a}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"string-split-by":306,unquote:329}],102:[function(m,G,Y){var d=m("pick-by-alias"),v=m("./lib/util").isSize,w=h(m("css-global-keywords")),y=h(m("css-system-font-keywords")),e=h(m("css-font-weight-keywords")),t=h(m("css-font-style-keywords")),n=h(m("css-font-stretch-keywords")),o={normal:1,"small-caps":1},r={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},g="1rem",c="serif";function a(l,s){if(l&&!s[l]&&!w[l])throw Error("Unknown keyword `"+l+"`");return l}function h(l){for(var s={},p=0;p<l.length;p++)s[l[p]]=1;return s}G.exports=function(l){if((l=d(l,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"})).system)return l.system&&a(l.system,y),l.system;if(a(l.style,t),a(l.variant,o),a(l.weight,e),a(l.stretch,n),l.size==null&&(l.size=g),typeof l.size=="number"&&(l.size+="px"),!v)throw Error("Bad size value `"+l.size+"`");l.family||(l.family=c),Array.isArray(l.family)&&(l.family.length||(l.family=[c]),l.family=l.family.map(function(p){return r[p]?p:'"'+p+'"'}).join(", "));var s=[];return s.push(l.style),l.variant!==l.style&&s.push(l.variant),l.weight!==l.variant&&l.weight!==l.style&&s.push(l.weight),l.stretch!==l.weight&&l.stretch!==l.variant&&l.stretch!==l.style&&s.push(l.stretch),s.push(l.size+(l.lineHeight==null||l.lineHeight==="normal"||l.lineHeight+""=="1"?"":"/"+l.lineHeight)),s.push(l.family),s.filter(Boolean).join(" ")}},{"./lib/util":100,"css-font-stretch-keywords":96,"css-font-style-keywords":97,"css-font-weight-keywords":98,"css-global-keywords":103,"css-system-font-keywords":104,"pick-by-alias":253}],103:[function(m,G,Y){G.exports=["inherit","initial","unset"]},{}],104:[function(m,G,Y){G.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],105:[function(m,G,Y){var d,v=m("type/value/is"),w=m("type/value/ensure"),y=m("type/plain-function/ensure"),e=m("es5-ext/object/copy"),t=m("es5-ext/object/normalize-options"),n=m("es5-ext/object/map"),o=Function.prototype.bind,r=Object.defineProperty,g=Object.prototype.hasOwnProperty;d=function(c,a,h){var l,s=w(a)&&y(a.value);return delete(l=e(a)).writable,delete l.value,l.get=function(){return!h.overwriteDefinition&&g.call(this,c)?s:(a.value=o.call(s,h.resolveContext?h.resolveContext(this):this),r(this,c,a),this[c])},l},G.exports=function(c){var a=t(arguments[1]);return v(a.resolveContext)&&y(a.resolveContext),n(c,function(h,l){return d(l,h,a)})}},{"es5-ext/object/copy":147,"es5-ext/object/map":155,"es5-ext/object/normalize-options":156,"type/plain-function/ensure":322,"type/value/ensure":326,"type/value/is":327}],106:[function(m,G,Y){var d=m("type/value/is"),v=m("type/plain-function/is"),w=m("es5-ext/object/assign"),y=m("es5-ext/object/normalize-options"),e=m("es5-ext/string/#/contains");(G.exports=function(t,n){var o,r,g,c,a;return arguments.length<2||typeof t!="string"?(c=n,n=t,t=null):c=arguments[2],d(t)?(o=e.call(t,"c"),r=e.call(t,"e"),g=e.call(t,"w")):(o=g=!0,r=!1),a={value:n,configurable:o,enumerable:r,writable:g},c?w(y(c),a):a}).gs=function(t,n,o){var r,g,c,a;return typeof t!="string"?(c=o,o=n,n=t,t=null):c=arguments[3],d(n)?v(n)?d(o)?v(o)||(c=o,o=void 0):o=void 0:(c=n,n=o=void 0):n=void 0,d(t)?(r=e.call(t,"c"),g=e.call(t,"e")):(r=!0,g=!1),a={get:n,set:o,configurable:r,enumerable:g},c?w(y(c),a):a}},{"es5-ext/object/assign":144,"es5-ext/object/normalize-options":156,"es5-ext/string/#/contains":163,"type/plain-function/is":323,"type/value/is":327}],107:[function(m,G,Y){(function(d,v){v(typeof Y=="object"&&G!==void 0?Y:d.d3=d.d3||{})})(this,function(d){function v(P,S){return P<S?-1:P>S?1:P>=S?0:NaN}function w(P){var S;return P.length===1&&(S=P,P=function(E,z){return v(S(E),z)}),{left:function(E,z,D,j){for(D==null&&(D=0),j==null&&(j=E.length);D<j;){var V=D+j>>>1;P(E[V],z)<0?D=V+1:j=V}return D},right:function(E,z,D,j){for(D==null&&(D=0),j==null&&(j=E.length);D<j;){var V=D+j>>>1;P(E[V],z)>0?j=V:D=V+1}return D}}}var y=w(v),e=y.right,t=y.left;function n(P,S){return[P,S]}function o(P){return P===null?NaN:+P}function r(P,S){var E,z,D=P.length,j=0,V=-1,Z=0,Q=0;if(S==null)for(;++V<D;)isNaN(E=o(P[V]))||(Q+=(z=E-Z)*(E-(Z+=z/++j)));else for(;++V<D;)isNaN(E=o(S(P[V],V,P)))||(Q+=(z=E-Z)*(E-(Z+=z/++j)));if(j>1)return Q/(j-1)}function g(P,S){var E=r(P,S);return E&&Math.sqrt(E)}function c(P,S){var E,z,D,j=P.length,V=-1;if(S==null){for(;++V<j;)if((E=P[V])!=null&&E>=E)for(z=D=E;++V<j;)(E=P[V])!=null&&(z>E&&(z=E),D<E&&(D=E))}else for(;++V<j;)if((E=S(P[V],V,P))!=null&&E>=E)for(z=D=E;++V<j;)(E=S(P[V],V,P))!=null&&(z>E&&(z=E),D<E&&(D=E));return[z,D]}var a=Array.prototype,h=a.slice,l=a.map;function s(P){return function(){return P}}function p(P){return P}function u(P,S,E){P=+P,S=+S,E=(D=arguments.length)<2?(S=P,P=0,1):D<3?1:+E;for(var z=-1,D=0|Math.max(0,Math.ceil((S-P)/E)),j=new Array(D);++z<D;)j[z]=P+z*E;return j}var i=Math.sqrt(50),x=Math.sqrt(10),f=Math.sqrt(2);function _(P,S,E){var z=(S-P)/Math.max(0,E),D=Math.floor(Math.log(z)/Math.LN10),j=z/Math.pow(10,D);return D>=0?(j>=i?10:j>=x?5:j>=f?2:1)*Math.pow(10,D):-Math.pow(10,-D)/(j>=i?10:j>=x?5:j>=f?2:1)}function b(P,S,E){var z=Math.abs(S-P)/Math.max(0,E),D=Math.pow(10,Math.floor(Math.log(z)/Math.LN10)),j=z/D;return j>=i?D*=10:j>=x?D*=5:j>=f&&(D*=2),S<P?-D:D}function T(P){return Math.ceil(Math.log(P.length)/Math.LN2)+1}function k(P,S,E){if(E==null&&(E=o),z=P.length){if((S=+S)<=0||z<2)return+E(P[0],0,P);if(S>=1)return+E(P[z-1],z-1,P);var z,D=(z-1)*S,j=Math.floor(D),V=+E(P[j],j,P);return V+(+E(P[j+1],j+1,P)-V)*(D-j)}}function L(P,S){var E,z,D=P.length,j=-1;if(S==null){for(;++j<D;)if((E=P[j])!=null&&E>=E)for(z=E;++j<D;)(E=P[j])!=null&&z>E&&(z=E)}else for(;++j<D;)if((E=S(P[j],j,P))!=null&&E>=E)for(z=E;++j<D;)(E=S(P[j],j,P))!=null&&z>E&&(z=E);return z}function A(P){if(!(D=P.length))return[];for(var S=-1,E=L(P,I),z=new Array(E);++S<E;)for(var D,j=-1,V=z[S]=new Array(D);++j<D;)V[j]=P[j][S];return z}function I(P){return P.length}d.bisect=e,d.bisectRight=e,d.bisectLeft=t,d.ascending=v,d.bisector=w,d.cross=function(P,S,E){var z,D,j,V,Z=P.length,Q=S.length,X=new Array(Z*Q);for(E==null&&(E=n),z=j=0;z<Z;++z)for(V=P[z],D=0;D<Q;++D,++j)X[j]=E(V,S[D]);return X},d.descending=function(P,S){return S<P?-1:S>P?1:S>=P?0:NaN},d.deviation=g,d.extent=c,d.histogram=function(){var P=p,S=c,E=T;function z(D){var j,V,Z=D.length,Q=new Array(Z);for(j=0;j<Z;++j)Q[j]=P(D[j],j,D);var X=S(Q),$=X[0],re=X[1],H=E(Q,$,re);Array.isArray(H)||(H=b($,re,H),H=u(Math.ceil($/H)*H,re,H));for(var N=H.length;H[0]<=$;)H.shift(),--N;for(;H[N-1]>re;)H.pop(),--N;var U,te=new Array(N+1);for(j=0;j<=N;++j)(U=te[j]=[]).x0=j>0?H[j-1]:$,U.x1=j<N?H[j]:re;for(j=0;j<Z;++j)$<=(V=Q[j])&&V<=re&&te[e(H,V,0,N)].push(D[j]);return te}return z.value=function(D){return arguments.length?(P=typeof D=="function"?D:s(D),z):P},z.domain=function(D){return arguments.length?(S=typeof D=="function"?D:s([D[0],D[1]]),z):S},z.thresholds=function(D){return arguments.length?(E=typeof D=="function"?D:Array.isArray(D)?s(h.call(D)):s(D),z):E},z},d.thresholdFreedmanDiaconis=function(P,S,E){return P=l.call(P,o).sort(v),Math.ceil((E-S)/(2*(k(P,.75)-k(P,.25))*Math.pow(P.length,-1/3)))},d.thresholdScott=function(P,S,E){return Math.ceil((E-S)/(3.5*g(P)*Math.pow(P.length,-1/3)))},d.thresholdSturges=T,d.max=function(P,S){var E,z,D=P.length,j=-1;if(S==null){for(;++j<D;)if((E=P[j])!=null&&E>=E)for(z=E;++j<D;)(E=P[j])!=null&&E>z&&(z=E)}else for(;++j<D;)if((E=S(P[j],j,P))!=null&&E>=E)for(z=E;++j<D;)(E=S(P[j],j,P))!=null&&E>z&&(z=E);return z},d.mean=function(P,S){var E,z=P.length,D=z,j=-1,V=0;if(S==null)for(;++j<z;)isNaN(E=o(P[j]))?--D:V+=E;else for(;++j<z;)isNaN(E=o(S(P[j],j,P)))?--D:V+=E;if(D)return V/D},d.median=function(P,S){var E,z=P.length,D=-1,j=[];if(S==null)for(;++D<z;)isNaN(E=o(P[D]))||j.push(E);else for(;++D<z;)isNaN(E=o(S(P[D],D,P)))||j.push(E);return k(j.sort(v),.5)},d.merge=function(P){for(var S,E,z,D=P.length,j=-1,V=0;++j<D;)V+=P[j].length;for(E=new Array(V);--D>=0;)for(S=(z=P[D]).length;--S>=0;)E[--V]=z[S];return E},d.min=L,d.pairs=function(P,S){S==null&&(S=n);for(var E=0,z=P.length-1,D=P[0],j=new Array(z<0?0:z);E<z;)j[E]=S(D,D=P[++E]);return j},d.permute=function(P,S){for(var E=S.length,z=new Array(E);E--;)z[E]=P[S[E]];return z},d.quantile=k,d.range=u,d.scan=function(P,S){if(E=P.length){var E,z,D=0,j=0,V=P[j];for(S==null&&(S=v);++D<E;)(S(z=P[D],V)<0||S(V,V)!==0)&&(V=z,j=D);return S(V,V)===0?j:void 0}},d.shuffle=function(P,S,E){for(var z,D,j=(E==null?P.length:E)-(S=S==null?0:+S);j;)D=Math.random()*j--|0,z=P[j+S],P[j+S]=P[D+S],P[D+S]=z;return P},d.sum=function(P,S){var E,z=P.length,D=-1,j=0;if(S==null)for(;++D<z;)(E=+P[D])&&(j+=E);else for(;++D<z;)(E=+S(P[D],D,P))&&(j+=E);return j},d.ticks=function(P,S,E){var z,D,j,V,Z=-1;if(E=+E,(P=+P)==(S=+S)&&E>0)return[P];if((z=S<P)&&(D=P,P=S,S=D),(V=_(P,S,E))===0||!isFinite(V))return[];if(V>0)for(P=Math.ceil(P/V),S=Math.floor(S/V),j=new Array(D=Math.ceil(S-P+1));++Z<D;)j[Z]=(P+Z)*V;else for(P=Math.floor(P*V),S=Math.ceil(S*V),j=new Array(D=Math.ceil(P-S+1));++Z<D;)j[Z]=(P-Z)/V;return z&&j.reverse(),j},d.tickIncrement=_,d.tickStep=b,d.transpose=A,d.variance=r,d.zip=function(){return A(arguments)},Object.defineProperty(d,"__esModule",{value:!0})})},{}],108:[function(m,G,Y){(function(d,v){v(typeof Y=="object"&&G!==void 0?Y:d.d3=d.d3||{})})(this,function(d){function v(){}function w(c,a){var h=new v;if(c instanceof v)c.each(function(i,x){h.set(x,i)});else if(Array.isArray(c)){var l,s=-1,p=c.length;if(a==null)for(;++s<p;)h.set(s,c[s]);else for(;++s<p;)h.set(a(l=c[s],s,c),l)}else if(c)for(var u in c)h.set(u,c[u]);return h}function y(){return{}}function e(c,a,h){c[a]=h}function t(){return w()}function n(c,a,h){c.set(a,h)}function o(){}v.prototype=w.prototype={constructor:v,has:function(c){return"$"+c in this},get:function(c){return this["$"+c]},set:function(c,a){return this["$"+c]=a,this},remove:function(c){var a="$"+c;return a in this&&delete this[a]},clear:function(){for(var c in this)c[0]==="$"&&delete this[c]},keys:function(){var c=[];for(var a in this)a[0]==="$"&&c.push(a.slice(1));return c},values:function(){var c=[];for(var a in this)a[0]==="$"&&c.push(this[a]);return c},entries:function(){var c=[];for(var a in this)a[0]==="$"&&c.push({key:a.slice(1),value:this[a]});return c},size:function(){var c=0;for(var a in this)a[0]==="$"&&++c;return c},empty:function(){for(var c in this)if(c[0]==="$")return!1;return!0},each:function(c){for(var a in this)a[0]==="$"&&c(this[a],a.slice(1),this)}};var r=w.prototype;function g(c,a){var h=new o;if(c instanceof o)c.each(function(p){h.add(p)});else if(c){var l=-1,s=c.length;if(a==null)for(;++l<s;)h.add(c[l]);else for(;++l<s;)h.add(a(c[l],l,c))}return h}o.prototype=g.prototype={constructor:o,has:r.has,add:function(c){return this["$"+(c+="")]=c,this},remove:r.remove,clear:r.clear,values:r.keys,size:r.size,empty:r.empty,each:r.each},d.nest=function(){var c,a,h,l=[],s=[];function p(u,i,x,f){if(i>=l.length)return c!=null&&u.sort(c),a!=null?a(u):u;for(var _,b,T,k=-1,L=u.length,A=l[i++],I=w(),P=x();++k<L;)(T=I.get(_=A(b=u[k])+""))?T.push(b):I.set(_,[b]);return I.each(function(S,E){f(P,E,p(S,i,x,f))}),P}return h={object:function(u){return p(u,0,y,e)},map:function(u){return p(u,0,t,n)},entries:function(u){return function i(x,f){if(++f>l.length)return x;var _,b=s[f-1];return a!=null&&f>=l.length?_=x.entries():(_=[],x.each(function(T,k){_.push({key:k,values:i(T,f)})})),b!=null?_.sort(function(T,k){return b(T.key,k.key)}):_}(p(u,0,t,n),0)},key:function(u){return l.push(u),h},sortKeys:function(u){return s[l.length-1]=u,h},sortValues:function(u){return c=u,h},rollup:function(u){return a=u,h}}},d.set=g,d.map=w,d.keys=function(c){var a=[];for(var h in c)a.push(h);return a},d.values=function(c){var a=[];for(var h in c)a.push(c[h]);return a},d.entries=function(c){var a=[];for(var h in c)a.push({key:h,value:c[h]});return a},Object.defineProperty(d,"__esModule",{value:!0})})},{}],109:[function(m,G,Y){(function(d,v){v(typeof Y=="object"&&G!==void 0?Y:(d=d||self).d3=d.d3||{})})(this,function(d){function v(le,ve,Me){le.prototype=ve.prototype=Me,Me.constructor=le}function w(le,ve){var Me=Object.create(le.prototype);for(var we in ve)Me[we]=ve[we];return Me}function y(){}var e="\\s*([+-]?\\d+)\\s*",t="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",n="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",o=/^#([0-9a-f]{3,8})$/,r=new RegExp("^rgb\\("+[e,e,e]+"\\)$"),g=new RegExp("^rgb\\("+[n,n,n]+"\\)$"),c=new RegExp("^rgba\\("+[e,e,e,t]+"\\)$"),a=new RegExp("^rgba\\("+[n,n,n,t]+"\\)$"),h=new RegExp("^hsl\\("+[t,n,n]+"\\)$"),l=new RegExp("^hsla\\("+[t,n,n,t]+"\\)$"),s={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function p(){return this.rgb().formatHex()}function u(){return this.rgb().formatRgb()}function i(le){var ve,Me;return le=(le+"").trim().toLowerCase(),(ve=o.exec(le))?(Me=ve[1].length,ve=parseInt(ve[1],16),Me===6?x(ve):Me===3?new T(ve>>8&15|ve>>4&240,ve>>4&15|240&ve,(15&ve)<<4|15&ve,1):Me===8?f(ve>>24&255,ve>>16&255,ve>>8&255,(255&ve)/255):Me===4?f(ve>>12&15|ve>>8&240,ve>>8&15|ve>>4&240,ve>>4&15|240&ve,((15&ve)<<4|15&ve)/255):null):(ve=r.exec(le))?new T(ve[1],ve[2],ve[3],1):(ve=g.exec(le))?new T(255*ve[1]/100,255*ve[2]/100,255*ve[3]/100,1):(ve=c.exec(le))?f(ve[1],ve[2],ve[3],ve[4]):(ve=a.exec(le))?f(255*ve[1]/100,255*ve[2]/100,255*ve[3]/100,ve[4]):(ve=h.exec(le))?I(ve[1],ve[2]/100,ve[3]/100,1):(ve=l.exec(le))?I(ve[1],ve[2]/100,ve[3]/100,ve[4]):s.hasOwnProperty(le)?x(s[le]):le==="transparent"?new T(NaN,NaN,NaN,0):null}function x(le){return new T(le>>16&255,le>>8&255,255&le,1)}function f(le,ve,Me,we){return we<=0&&(le=ve=Me=NaN),new T(le,ve,Me,we)}function _(le){return le instanceof y||(le=i(le)),le?new T((le=le.rgb()).r,le.g,le.b,le.opacity):new T}function b(le,ve,Me,we){return arguments.length===1?_(le):new T(le,ve,Me,we==null?1:we)}function T(le,ve,Me,we){this.r=+le,this.g=+ve,this.b=+Me,this.opacity=+we}function k(){return"#"+A(this.r)+A(this.g)+A(this.b)}function L(){var le=this.opacity;return((le=isNaN(le)?1:Math.max(0,Math.min(1,le)))===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(le===1?")":", "+le+")")}function A(le){return((le=Math.max(0,Math.min(255,Math.round(le)||0)))<16?"0":"")+le.toString(16)}function I(le,ve,Me,we){return we<=0?le=ve=Me=NaN:Me<=0||Me>=1?le=ve=NaN:ve<=0&&(le=NaN),new E(le,ve,Me,we)}function P(le){if(le instanceof E)return new E(le.h,le.s,le.l,le.opacity);if(le instanceof y||(le=i(le)),!le)return new E;if(le instanceof E)return le;var ve=(le=le.rgb()).r/255,Me=le.g/255,we=le.b/255,de=Math.min(ve,Me,we),Ie=Math.max(ve,Me,we),De=NaN,Oe=Ie-de,Ve=(Ie+de)/2;return Oe?(De=ve===Ie?(Me-we)/Oe+6*(Me<we):Me===Ie?(we-ve)/Oe+2:(ve-Me)/Oe+4,Oe/=Ve<.5?Ie+de:2-Ie-de,De*=60):Oe=Ve>0&&Ve<1?0:De,new E(De,Oe,Ve,le.opacity)}function S(le,ve,Me,we){return arguments.length===1?P(le):new E(le,ve,Me,we==null?1:we)}function E(le,ve,Me,we){this.h=+le,this.s=+ve,this.l=+Me,this.opacity=+we}function z(le,ve,Me){return 255*(le<60?ve+(Me-ve)*le/60:le<180?Me:le<240?ve+(Me-ve)*(240-le)/60:ve)}v(y,i,{copy:function(le){return Object.assign(new this.constructor,this,le)},displayable:function(){return this.rgb().displayable()},hex:p,formatHex:p,formatHsl:function(){return P(this).formatHsl()},formatRgb:u,toString:u}),v(T,b,w(y,{brighter:function(le){return le=le==null?1/.7:Math.pow(1/.7,le),new T(this.r*le,this.g*le,this.b*le,this.opacity)},darker:function(le){return le=le==null?.7:Math.pow(.7,le),new T(this.r*le,this.g*le,this.b*le,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:k,formatHex:k,formatRgb:L,toString:L})),v(E,S,w(y,{brighter:function(le){return le=le==null?1/.7:Math.pow(1/.7,le),new E(this.h,this.s,this.l*le,this.opacity)},darker:function(le){return le=le==null?.7:Math.pow(.7,le),new E(this.h,this.s,this.l*le,this.opacity)},rgb:function(){var le=this.h%360+360*(this.h<0),ve=isNaN(le)||isNaN(this.s)?0:this.s,Me=this.l,we=Me+(Me<.5?Me:1-Me)*ve,de=2*Me-we;return new T(z(le>=240?le-240:le+120,de,we),z(le,de,we),z(le<120?le+240:le-120,de,we),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var le=this.opacity;return((le=isNaN(le)?1:Math.max(0,Math.min(1,le)))===1?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(le===1?")":", "+le+")")}}));var D=Math.PI/180,j=180/Math.PI,V=6/29,Z=3*V*V;function Q(le){if(le instanceof $)return new $(le.l,le.a,le.b,le.opacity);if(le instanceof K)return J(le);le instanceof T||(le=_(le));var ve,Me,we=U(le.r),de=U(le.g),Ie=U(le.b),De=re((.2225045*we+.7168786*de+.0606169*Ie)/1);return we===de&&de===Ie?ve=Me=De:(ve=re((.4360747*we+.3850649*de+.1430804*Ie)/.96422),Me=re((.0139322*we+.0971045*de+.7141733*Ie)/.82521)),new $(116*De-16,500*(ve-De),200*(De-Me),le.opacity)}function X(le,ve,Me,we){return arguments.length===1?Q(le):new $(le,ve,Me,we==null?1:we)}function $(le,ve,Me,we){this.l=+le,this.a=+ve,this.b=+Me,this.opacity=+we}function re(le){return le>.008856451679035631?Math.pow(le,1/3):le/Z+4/29}function H(le){return le>V?le*le*le:Z*(le-4/29)}function N(le){return 255*(le<=.0031308?12.92*le:1.055*Math.pow(le,1/2.4)-.055)}function U(le){return(le/=255)<=.04045?le/12.92:Math.pow((le+.055)/1.055,2.4)}function te(le){if(le instanceof K)return new K(le.h,le.c,le.l,le.opacity);if(le instanceof $||(le=Q(le)),le.a===0&&le.b===0)return new K(NaN,0<le.l&&le.l<100?0:NaN,le.l,le.opacity);var ve=Math.atan2(le.b,le.a)*j;return new K(ve<0?ve+360:ve,Math.sqrt(le.a*le.a+le.b*le.b),le.l,le.opacity)}function B(le,ve,Me,we){return arguments.length===1?te(le):new K(le,ve,Me,we==null?1:we)}function K(le,ve,Me,we){this.h=+le,this.c=+ve,this.l=+Me,this.opacity=+we}function J(le){if(isNaN(le.h))return new $(le.l,0,0,le.opacity);var ve=le.h*D;return new $(le.l,Math.cos(ve)*le.c,Math.sin(ve)*le.c,le.opacity)}v($,X,w(y,{brighter:function(le){return new $(this.l+18*(le==null?1:le),this.a,this.b,this.opacity)},darker:function(le){return new $(this.l-18*(le==null?1:le),this.a,this.b,this.opacity)},rgb:function(){var le=(this.l+16)/116,ve=isNaN(this.a)?le:le+this.a/500,Me=isNaN(this.b)?le:le-this.b/200;return new T(N(3.1338561*(ve=.96422*H(ve))-1.6168667*(le=1*H(le))-.4906146*(Me=.82521*H(Me))),N(-.9787684*ve+1.9161415*le+.033454*Me),N(.0719453*ve-.2289914*le+1.4052427*Me),this.opacity)}})),v(K,B,w(y,{brighter:function(le){return new K(this.h,this.c,this.l+18*(le==null?1:le),this.opacity)},darker:function(le){return new K(this.h,this.c,this.l-18*(le==null?1:le),this.opacity)},rgb:function(){return J(this).rgb()}}));var ee=-.14861,ne=1.78277,se=-.29227,oe=-.90649,me=1.97294,ce=me*oe,ye=me*ne,Se=ne*se-oe*ee;function fe(le){if(le instanceof Te)return new Te(le.h,le.s,le.l,le.opacity);le instanceof T||(le=_(le));var ve=le.r/255,Me=le.g/255,we=le.b/255,de=(Se*we+ce*ve-ye*Me)/(Se+ce-ye),Ie=we-de,De=(me*(Me-de)-se*Ie)/oe,Oe=Math.sqrt(De*De+Ie*Ie)/(me*de*(1-de)),Ve=Oe?Math.atan2(De,Ie)*j-120:NaN;return new Te(Ve<0?Ve+360:Ve,Oe,de,le.opacity)}function ge(le,ve,Me,we){return arguments.length===1?fe(le):new Te(le,ve,Me,we==null?1:we)}function Te(le,ve,Me,we){this.h=+le,this.s=+ve,this.l=+Me,this.opacity=+we}v(Te,ge,w(y,{brighter:function(le){return le=le==null?1/.7:Math.pow(1/.7,le),new Te(this.h,this.s,this.l*le,this.opacity)},darker:function(le){return le=le==null?.7:Math.pow(.7,le),new Te(this.h,this.s,this.l*le,this.opacity)},rgb:function(){var le=isNaN(this.h)?0:(this.h+120)*D,ve=+this.l,Me=isNaN(this.s)?0:this.s*ve*(1-ve),we=Math.cos(le),de=Math.sin(le);return new T(255*(ve+Me*(ee*we+ne*de)),255*(ve+Me*(se*we+oe*de)),255*(ve+Me*(me*we)),this.opacity)}})),d.color=i,d.cubehelix=ge,d.gray=function(le,ve){return new $(le,0,0,ve==null?1:ve)},d.hcl=B,d.hsl=S,d.lab=X,d.lch=function(le,ve,Me,we){return arguments.length===1?te(le):new K(Me,ve,le,we==null?1:we)},d.rgb=b,Object.defineProperty(d,"__esModule",{value:!0})})},{}],110:[function(m,G,Y){(function(d,v){v(typeof Y=="object"&&G!==void 0?Y:(d=d||self).d3=d.d3||{})})(this,function(d){var v={value:function(){}};function w(){for(var o,r=0,g=arguments.length,c={};r<g;++r){if(!(o=arguments[r]+"")||o in c||/[\s.]/.test(o))throw new Error("illegal type: "+o);c[o]=[]}return new y(c)}function y(o){this._=o}function e(o,r){return o.trim().split(/^|\s+/).map(function(g){var c="",a=g.indexOf(".");if(a>=0&&(c=g.slice(a+1),g=g.slice(0,a)),g&&!r.hasOwnProperty(g))throw new Error("unknown type: "+g);return{type:g,name:c}})}function t(o,r){for(var g,c=0,a=o.length;c<a;++c)if((g=o[c]).name===r)return g.value}function n(o,r,g){for(var c=0,a=o.length;c<a;++c)if(o[c].name===r){o[c]=v,o=o.slice(0,c).concat(o.slice(c+1));break}return g!=null&&o.push({name:r,value:g}),o}y.prototype=w.prototype={constructor:y,on:function(o,r){var g,c=this._,a=e(o+"",c),h=-1,l=a.length;if(!(arguments.length<2)){if(r!=null&&typeof r!="function")throw new Error("invalid callback: "+r);for(;++h<l;)if(g=(o=a[h]).type)c[g]=n(c[g],o.name,r);else if(r==null)for(g in c)c[g]=n(c[g],o.name,null);return this}for(;++h<l;)if((g=(o=a[h]).type)&&(g=t(c[g],o.name)))return g},copy:function(){var o={},r=this._;for(var g in r)o[g]=r[g].slice();return new y(o)},call:function(o,r){if((g=arguments.length-2)>0)for(var g,c,a=new Array(g),h=0;h<g;++h)a[h]=arguments[h+2];if(!this._.hasOwnProperty(o))throw new Error("unknown type: "+o);for(h=0,g=(c=this._[o]).length;h<g;++h)c[h].value.apply(r,a)},apply:function(o,r,g){if(!this._.hasOwnProperty(o))throw new Error("unknown type: "+o);for(var c=this._[o],a=0,h=c.length;a<h;++a)c[a].value.apply(r,g)}},d.dispatch=w,Object.defineProperty(d,"__esModule",{value:!0})})},{}],111:[function(m,G,Y){(function(d,v){typeof Y=="object"&&G!==void 0?v(Y,m("d3-quadtree"),m("d3-collection"),m("d3-dispatch"),m("d3-timer")):v(d.d3=d.d3||{},d.d3,d.d3,d.d3,d.d3)})(this,function(d,v,w,y,e){function t(s){return function(){return s}}function n(){return 1e-6*(Math.random()-.5)}function o(s){return s.x+s.vx}function r(s){return s.y+s.vy}function g(s){return s.index}function c(s,p){var u=s.get(p);if(!u)throw new Error("missing: "+p);return u}function a(s){return s.x}function h(s){return s.y}var l=Math.PI*(3-Math.sqrt(5));d.forceCenter=function(s,p){var u;function i(){var x,f,_=u.length,b=0,T=0;for(x=0;x<_;++x)b+=(f=u[x]).x,T+=f.y;for(b=b/_-s,T=T/_-p,x=0;x<_;++x)(f=u[x]).x-=b,f.y-=T}return s==null&&(s=0),p==null&&(p=0),i.initialize=function(x){u=x},i.x=function(x){return arguments.length?(s=+x,i):s},i.y=function(x){return arguments.length?(p=+x,i):p},i},d.forceCollide=function(s){var p,u,i=1,x=1;function f(){for(var T,k,L,A,I,P,S,E=p.length,z=0;z<x;++z)for(k=v.quadtree(p,o,r).visitAfter(_),T=0;T<E;++T)L=p[T],P=u[L.index],S=P*P,A=L.x+L.vx,I=L.y+L.vy,k.visit(D);function D(j,V,Z,Q,X){var $=j.data,re=j.r,H=P+re;if(!$)return V>A+H||Q<A-H||Z>I+H||X<I-H;if($.index>L.index){var N=A-$.x-$.vx,U=I-$.y-$.vy,te=N*N+U*U;te<H*H&&(N===0&&(te+=(N=n())*N),U===0&&(te+=(U=n())*U),te=(H-(te=Math.sqrt(te)))/te*i,L.vx+=(N*=te)*(H=(re*=re)/(S+re)),L.vy+=(U*=te)*H,$.vx-=N*(H=1-H),$.vy-=U*H)}}}function _(T){if(T.data)return T.r=u[T.data.index];for(var k=T.r=0;k<4;++k)T[k]&&T[k].r>T.r&&(T.r=T[k].r)}function b(){if(p){var T,k,L=p.length;for(u=new Array(L),T=0;T<L;++T)k=p[T],u[k.index]=+s(k,T,p)}}return typeof s!="function"&&(s=t(s==null?1:+s)),f.initialize=function(T){p=T,b()},f.iterations=function(T){return arguments.length?(x=+T,f):x},f.strength=function(T){return arguments.length?(i=+T,f):i},f.radius=function(T){return arguments.length?(s=typeof T=="function"?T:t(+T),b(),f):s},f},d.forceLink=function(s){var p,u,i,x,f,_=g,b=function(S){return 1/Math.min(x[S.source.index],x[S.target.index])},T=t(30),k=1;function L(S){for(var E=0,z=s.length;E<k;++E)for(var D,j,V,Z,Q,X,$,re=0;re<z;++re)j=(D=s[re]).source,Z=(V=D.target).x+V.vx-j.x-j.vx||n(),Q=V.y+V.vy-j.y-j.vy||n(),Z*=X=((X=Math.sqrt(Z*Z+Q*Q))-u[re])/X*S*p[re],Q*=X,V.vx-=Z*($=f[re]),V.vy-=Q*$,j.vx+=Z*($=1-$),j.vy+=Q*$}function A(){if(i){var S,E,z=i.length,D=s.length,j=w.map(i,_);for(S=0,x=new Array(z);S<D;++S)(E=s[S]).index=S,typeof E.source!="object"&&(E.source=c(j,E.source)),typeof E.target!="object"&&(E.target=c(j,E.target)),x[E.source.index]=(x[E.source.index]||0)+1,x[E.target.index]=(x[E.target.index]||0)+1;for(S=0,f=new Array(D);S<D;++S)E=s[S],f[S]=x[E.source.index]/(x[E.source.index]+x[E.target.index]);p=new Array(D),I(),u=new Array(D),P()}}function I(){if(i)for(var S=0,E=s.length;S<E;++S)p[S]=+b(s[S],S,s)}function P(){if(i)for(var S=0,E=s.length;S<E;++S)u[S]=+T(s[S],S,s)}return s==null&&(s=[]),L.initialize=function(S){i=S,A()},L.links=function(S){return arguments.length?(s=S,A(),L):s},L.id=function(S){return arguments.length?(_=S,L):_},L.iterations=function(S){return arguments.length?(k=+S,L):k},L.strength=function(S){return arguments.length?(b=typeof S=="function"?S:t(+S),I(),L):b},L.distance=function(S){return arguments.length?(T=typeof S=="function"?S:t(+S),P(),L):T},L},d.forceManyBody=function(){var s,p,u,i,x=t(-30),f=1,_=1/0,b=.81;function T(I){var P,S=s.length,E=v.quadtree(s,a,h).visitAfter(L);for(u=I,P=0;P<S;++P)p=s[P],E.visit(A)}function k(){if(s){var I,P,S=s.length;for(i=new Array(S),I=0;I<S;++I)P=s[I],i[P.index]=+x(P,I,s)}}function L(I){var P,S,E,z,D,j=0,V=0;if(I.length){for(E=z=D=0;D<4;++D)(P=I[D])&&(S=Math.abs(P.value))&&(j+=P.value,V+=S,E+=S*P.x,z+=S*P.y);I.x=E/V,I.y=z/V}else{(P=I).x=P.data.x,P.y=P.data.y;do j+=i[P.data.index];while(P=P.next)}I.value=j}function A(I,P,S,E){if(!I.value)return!0;var z=I.x-p.x,D=I.y-p.y,j=E-P,V=z*z+D*D;if(j*j/b<V)return V<_&&(z===0&&(V+=(z=n())*z),D===0&&(V+=(D=n())*D),V<f&&(V=Math.sqrt(f*V)),p.vx+=z*I.value*u/V,p.vy+=D*I.value*u/V),!0;if(!(I.length||V>=_)){(I.data!==p||I.next)&&(z===0&&(V+=(z=n())*z),D===0&&(V+=(D=n())*D),V<f&&(V=Math.sqrt(f*V)));do I.data!==p&&(j=i[I.data.index]*u/V,p.vx+=z*j,p.vy+=D*j);while(I=I.next)}}return T.initialize=function(I){s=I,k()},T.strength=function(I){return arguments.length?(x=typeof I=="function"?I:t(+I),k(),T):x},T.distanceMin=function(I){return arguments.length?(f=I*I,T):Math.sqrt(f)},T.distanceMax=function(I){return arguments.length?(_=I*I,T):Math.sqrt(_)},T.theta=function(I){return arguments.length?(b=I*I,T):Math.sqrt(b)},T},d.forceRadial=function(s,p,u){var i,x,f,_=t(.1);function b(k){for(var L=0,A=i.length;L<A;++L){var I=i[L],P=I.x-p||1e-6,S=I.y-u||1e-6,E=Math.sqrt(P*P+S*S),z=(f[L]-E)*x[L]*k/E;I.vx+=P*z,I.vy+=S*z}}function T(){if(i){var k,L=i.length;for(x=new Array(L),f=new Array(L),k=0;k<L;++k)f[k]=+s(i[k],k,i),x[k]=isNaN(f[k])?0:+_(i[k],k,i)}}return typeof s!="function"&&(s=t(+s)),p==null&&(p=0),u==null&&(u=0),b.initialize=function(k){i=k,T()},b.strength=function(k){return arguments.length?(_=typeof k=="function"?k:t(+k),T(),b):_},b.radius=function(k){return arguments.length?(s=typeof k=="function"?k:t(+k),T(),b):s},b.x=function(k){return arguments.length?(p=+k,b):p},b.y=function(k){return arguments.length?(u=+k,b):u},b},d.forceSimulation=function(s){var p,u=1,i=.001,x=1-Math.pow(i,1/300),f=0,_=.6,b=w.map(),T=e.timer(L),k=y.dispatch("tick","end");function L(){A(),k.call("tick",p),u<i&&(T.stop(),k.call("end",p))}function A(S){var E,z,D=s.length;S===void 0&&(S=1);for(var j=0;j<S;++j)for(u+=(f-u)*x,b.each(function(V){V(u)}),E=0;E<D;++E)(z=s[E]).fx==null?z.x+=z.vx*=_:(z.x=z.fx,z.vx=0),z.fy==null?z.y+=z.vy*=_:(z.y=z.fy,z.vy=0);return p}function I(){for(var S,E=0,z=s.length;E<z;++E){if((S=s[E]).index=E,S.fx!=null&&(S.x=S.fx),S.fy!=null&&(S.y=S.fy),isNaN(S.x)||isNaN(S.y)){var D=10*Math.sqrt(E),j=E*l;S.x=D*Math.cos(j),S.y=D*Math.sin(j)}(isNaN(S.vx)||isNaN(S.vy))&&(S.vx=S.vy=0)}}function P(S){return S.initialize&&S.initialize(s),S}return s==null&&(s=[]),I(),p={tick:A,restart:function(){return T.restart(L),p},stop:function(){return T.stop(),p},nodes:function(S){return arguments.length?(s=S,I(),b.each(P),p):s},alpha:function(S){return arguments.length?(u=+S,p):u},alphaMin:function(S){return arguments.length?(i=+S,p):i},alphaDecay:function(S){return arguments.length?(x=+S,p):+x},alphaTarget:function(S){return arguments.length?(f=+S,p):f},velocityDecay:function(S){return arguments.length?(_=1-S,p):1-_},force:function(S,E){return arguments.length>1?(E==null?b.remove(S):b.set(S,P(E)),p):b.get(S)},find:function(S,E,z){var D,j,V,Z,Q,X=0,$=s.length;for(z==null?z=1/0:z*=z,X=0;X<$;++X)(V=(D=S-(Z=s[X]).x)*D+(j=E-Z.y)*j)<z&&(Q=Z,z=V);return Q},on:function(S,E){return arguments.length>1?(k.on(S,E),p):k.on(S)}}},d.forceX=function(s){var p,u,i,x=t(.1);function f(b){for(var T,k=0,L=p.length;k<L;++k)(T=p[k]).vx+=(i[k]-T.x)*u[k]*b}function _(){if(p){var b,T=p.length;for(u=new Array(T),i=new Array(T),b=0;b<T;++b)u[b]=isNaN(i[b]=+s(p[b],b,p))?0:+x(p[b],b,p)}}return typeof s!="function"&&(s=t(s==null?0:+s)),f.initialize=function(b){p=b,_()},f.strength=function(b){return arguments.length?(x=typeof b=="function"?b:t(+b),_(),f):x},f.x=function(b){return arguments.length?(s=typeof b=="function"?b:t(+b),_(),f):s},f},d.forceY=function(s){var p,u,i,x=t(.1);function f(b){for(var T,k=0,L=p.length;k<L;++k)(T=p[k]).vy+=(i[k]-T.y)*u[k]*b}function _(){if(p){var b,T=p.length;for(u=new Array(T),i=new Array(T),b=0;b<T;++b)u[b]=isNaN(i[b]=+s(p[b],b,p))?0:+x(p[b],b,p)}}return typeof s!="function"&&(s=t(s==null?0:+s)),f.initialize=function(b){p=b,_()},f.strength=function(b){return arguments.length?(x=typeof b=="function"?b:t(+b),_(),f):x},f.y=function(b){return arguments.length?(s=typeof b=="function"?b:t(+b),_(),f):s},f},Object.defineProperty(d,"__esModule",{value:!0})})},{"d3-collection":108,"d3-dispatch":110,"d3-quadtree":118,"d3-timer":123}],112:[function(m,G,Y){(function(d,v){v(typeof Y=="object"&&G!==void 0?Y:(d=typeof globalThis<"u"?globalThis:d||self).d3=d.d3||{})})(this,function(d){function v(p,u){if((i=(p=u?p.toExponential(u-1):p.toExponential()).indexOf("e"))<0)return null;var i,x=p.slice(0,i);return[x.length>1?x[0]+x.slice(2):x,+p.slice(i+1)]}function w(p){return(p=v(Math.abs(p)))?p[1]:NaN}var y,e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function t(p){if(!(u=e.exec(p)))throw new Error("invalid format: "+p);var u;return new n({fill:u[1],align:u[2],sign:u[3],symbol:u[4],zero:u[5],width:u[6],comma:u[7],precision:u[8]&&u[8].slice(1),trim:u[9],type:u[10]})}function n(p){this.fill=p.fill===void 0?" ":p.fill+"",this.align=p.align===void 0?">":p.align+"",this.sign=p.sign===void 0?"-":p.sign+"",this.symbol=p.symbol===void 0?"":p.symbol+"",this.zero=!!p.zero,this.width=p.width===void 0?void 0:+p.width,this.comma=!!p.comma,this.precision=p.precision===void 0?void 0:+p.precision,this.trim=!!p.trim,this.type=p.type===void 0?"":p.type+""}function o(p,u){var i=v(p,u);if(!i)return p+"";var x=i[0],f=i[1];return f<0?"0."+new Array(-f).join("0")+x:x.length>f+1?x.slice(0,f+1)+"."+x.slice(f+1):x+new Array(f-x.length+2).join("0")}t.prototype=n.prototype,n.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,0|this.width))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var r={"%":function(p,u){return(100*p).toFixed(u)},b:function(p){return Math.round(p).toString(2)},c:function(p){return p+""},d:function(p){return Math.abs(p=Math.round(p))>=1e21?p.toLocaleString("en").replace(/,/g,""):p.toString(10)},e:function(p,u){return p.toExponential(u)},f:function(p,u){return p.toFixed(u)},g:function(p,u){return p.toPrecision(u)},o:function(p){return Math.round(p).toString(8)},p:function(p,u){return o(100*p,u)},r:o,s:function(p,u){var i=v(p,u);if(!i)return p+"";var x=i[0],f=i[1],_=f-(y=3*Math.max(-8,Math.min(8,Math.floor(f/3))))+1,b=x.length;return _===b?x:_>b?x+new Array(_-b+1).join("0"):_>0?x.slice(0,_)+"."+x.slice(_):"0."+new Array(1-_).join("0")+v(p,Math.max(0,u+_-1))[0]},X:function(p){return Math.round(p).toString(16).toUpperCase()},x:function(p){return Math.round(p).toString(16)}};function g(p){return p}var c,a=Array.prototype.map,h=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function l(p){var u,i,x=p.grouping===void 0||p.thousands===void 0?g:(u=a.call(p.grouping,Number),i=p.thousands+"",function(P,S){for(var E=P.length,z=[],D=0,j=u[0],V=0;E>0&&j>0&&(V+j+1>S&&(j=Math.max(1,S-V)),z.push(P.substring(E-=j,E+j)),!((V+=j+1)>S));)j=u[D=(D+1)%u.length];return z.reverse().join(i)}),f=p.currency===void 0?"":p.currency[0]+"",_=p.currency===void 0?"":p.currency[1]+"",b=p.decimal===void 0?".":p.decimal+"",T=p.numerals===void 0?g:function(P){return function(S){return S.replace(/[0-9]/g,function(E){return P[+E]})}}(a.call(p.numerals,String)),k=p.percent===void 0?"%":p.percent+"",L=p.minus===void 0?"-":p.minus+"",A=p.nan===void 0?"NaN":p.nan+"";function I(P){var S=(P=t(P)).fill,E=P.align,z=P.sign,D=P.symbol,j=P.zero,V=P.width,Z=P.comma,Q=P.precision,X=P.trim,$=P.type;$==="n"?(Z=!0,$="g"):r[$]||(Q===void 0&&(Q=12),X=!0,$="g"),(j||S==="0"&&E==="=")&&(j=!0,S="0",E="=");var re=D==="$"?f:D==="#"&&/[boxX]/.test($)?"0"+$.toLowerCase():"",H=D==="$"?_:/[%p]/.test($)?k:"",N=r[$],U=/[defgprs%]/.test($);function te(B){var K,J,ee,ne=re,se=H;if($==="c")se=N(B)+se,B="";else{var oe=(B=+B)<0||1/B<0;if(B=isNaN(B)?A:N(Math.abs(B),Q),X&&(B=function(ye){e:for(var Se,fe=ye.length,ge=1,Te=-1;ge<fe;++ge)switch(ye[ge]){case".":Te=Se=ge;break;case"0":Te===0&&(Te=ge),Se=ge;break;default:if(!+ye[ge])break e;Te>0&&(Te=0)}return Te>0?ye.slice(0,Te)+ye.slice(Se+1):ye}(B)),oe&&+B==0&&z!=="+"&&(oe=!1),ne=(oe?z==="("?z:L:z==="-"||z==="("?"":z)+ne,se=($==="s"?h[8+y/3]:"")+se+(oe&&z==="("?")":""),U){for(K=-1,J=B.length;++K<J;)if(48>(ee=B.charCodeAt(K))||ee>57){se=(ee===46?b+B.slice(K+1):B.slice(K))+se,B=B.slice(0,K);break}}}Z&&!j&&(B=x(B,1/0));var me=ne.length+B.length+se.length,ce=me<V?new Array(V-me+1).join(S):"";switch(Z&&j&&(B=x(ce+B,ce.length?V-se.length:1/0),ce=""),E){case"<":B=ne+B+se+ce;break;case"=":B=ne+ce+B+se;break;case"^":B=ce.slice(0,me=ce.length>>1)+ne+B+se+ce.slice(me);break;default:B=ce+ne+B+se}return T(B)}return Q=Q===void 0?6:/[gprs]/.test($)?Math.max(1,Math.min(21,Q)):Math.max(0,Math.min(20,Q)),te.toString=function(){return P+""},te}return{format:I,formatPrefix:function(P,S){var E=I(((P=t(P)).type="f",P)),z=3*Math.max(-8,Math.min(8,Math.floor(w(S)/3))),D=Math.pow(10,-z),j=h[8+z/3];return function(V){return E(D*V)+j}}}}function s(p){return c=l(p),d.format=c.format,d.formatPrefix=c.formatPrefix,c}s({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),d.FormatSpecifier=n,d.formatDefaultLocale=s,d.formatLocale=l,d.formatSpecifier=t,d.precisionFixed=function(p){return Math.max(0,-w(Math.abs(p)))},d.precisionPrefix=function(p,u){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(w(u)/3)))-w(Math.abs(p)))},d.precisionRound=function(p,u){return p=Math.abs(p),u=Math.abs(u)-p,Math.max(0,w(u)-w(p))+1},Object.defineProperty(d,"__esModule",{value:!0})})},{}],113:[function(m,G,Y){(function(d,v){typeof Y=="object"&&G!==void 0?v(Y,m("d3-geo"),m("d3-array")):v(d.d3=d.d3||{},d.d3,d.d3)})(this,function(d,v,w){var y=Math.abs,e=Math.atan,t=Math.atan2,n=Math.cos,o=Math.exp,r=Math.floor,g=Math.log,c=Math.max,a=Math.min,h=Math.pow,l=Math.round,s=Math.sign||function(Ue){return Ue>0?1:Ue<0?-1:0},p=Math.sin,u=Math.tan,i=1e-6,x=Math.PI,f=x/2,_=x/4,b=Math.SQRT1_2,T=E(2),k=E(x),L=2*x,A=180/x,I=x/180;function P(Ue){return Ue>1?f:Ue<-1?-f:Math.asin(Ue)}function S(Ue){return Ue>1?0:Ue<-1?x:Math.acos(Ue)}function E(Ue){return Ue>0?Math.sqrt(Ue):0}function z(Ue){return(o(Ue)-o(-Ue))/2}function D(Ue){return(o(Ue)+o(-Ue))/2}function j(Ue){var Ke=u(Ue/2),rt=2*g(n(Ue/2))/(Ke*Ke);function ut(_t,yt){var Ct=n(_t),er=n(yt),rr=p(yt),Xt=er*Ct,ur=-((1-Xt?g((1+Xt)/2)/(1-Xt):-.5)+rt/(1+Xt));return[ur*er*p(_t),ur*rr]}return ut.invert=function(_t,yt){var Ct,er=E(_t*_t+yt*yt),rr=-Ue/2,Xt=50;if(!er)return[0,0];do{var ur=rr/2,yr=n(ur),kr=p(ur),Sr=kr/yr,Ur=-g(y(yr));rr-=Ct=(2/Sr*Ur-rt*Sr-er)/(-Ur/(kr*kr)+1-rt/(2*yr*yr))*(yr<0?.7:1)}while(y(Ct)>i&&--Xt>0);var un=p(rr);return[t(_t*un,er*n(rr)),P(yt*un/er)]},ut}function V(Ue,Ke){var rt=n(Ke),ut=function(_t){return _t?_t/Math.sin(_t):1}(S(rt*n(Ue/=2)));return[2*rt*p(Ue)*ut,p(Ke)*ut]}function Z(Ue){var Ke=p(Ue),rt=n(Ue),ut=Ue>=0?1:-1,_t=u(ut*Ue),yt=(1+Ke-rt)/2;function Ct(er,rr){var Xt=n(rr),ur=n(er/=2);return[(1+Xt)*p(er),(ut*rr>-t(ur,_t)-.001?0:10*-ut)+yt+p(rr)*rt-(1+Xt)*Ke*ur]}return Ct.invert=function(er,rr){var Xt=0,ur=0,yr=50;do{var kr=n(Xt),Sr=p(Xt),Ur=n(ur),un=p(ur),xn=1+Ur,On=xn*Sr-er,Fn=yt+un*rt-xn*Ke*kr-rr,Yn=xn*kr/2,Bn=-Sr*un,vi=Ke*xn*Sr/2,Si=rt*Ur+Ke*kr*un,Ui=Bn*vi-Si*Yn,ji=(Fn*Bn-On*Si)/Ui/2,Vi=(On*vi-Fn*Yn)/Ui;y(Vi)>2&&(Vi/=2),Xt-=ji,ur-=Vi}while((y(ji)>i||y(Vi)>i)&&--yr>0);return ut*ur>-t(n(Xt),_t)-.001?[2*Xt,ur]:null},Ct}function Q(Ue,Ke){var rt=u(Ke/2),ut=E(1-rt*rt),_t=1+ut*n(Ue/=2),yt=p(Ue)*ut/_t,Ct=rt/_t,er=yt*yt,rr=Ct*Ct;return[4/3*yt*(3+er-3*rr),4/3*Ct*(3+3*er-rr)]}V.invert=function(Ue,Ke){if(!(Ue*Ue+4*Ke*Ke>x*x+i)){var rt=Ue,ut=Ke,_t=25;do{var yt,Ct=p(rt),er=p(rt/2),rr=n(rt/2),Xt=p(ut),ur=n(ut),yr=p(2*ut),kr=Xt*Xt,Sr=ur*ur,Ur=er*er,un=1-Sr*rr*rr,xn=un?S(ur*rr)*E(yt=1/un):yt=0,On=2*xn*ur*er-Ue,Fn=xn*Xt-Ke,Yn=yt*(Sr*Ur+xn*ur*rr*kr),Bn=yt*(.5*Ct*yr-2*xn*Xt*er),vi=.25*yt*(yr*er-xn*Xt*Sr*Ct),Si=yt*(kr*rr+xn*Ur*ur),Ui=Bn*vi-Si*Yn;if(!Ui)break;var ji=(Fn*Bn-On*Si)/Ui,Vi=(On*vi-Fn*Yn)/Ui;rt-=ji,ut-=Vi}while((y(ji)>i||y(Vi)>i)&&--_t>0);return[rt,ut]}},Q.invert=function(Ue,Ke){if(Ke*=3/8,!(Ue*=3/8)&&y(Ke)>1)return null;var rt=1+Ue*Ue+Ke*Ke,ut=E((rt-E(rt*rt-4*Ke*Ke))/2),_t=P(ut)/3,yt=ut?function(Xt){return g(Xt+E(Xt*Xt-1))}(y(Ke/ut))/3:function(Xt){return g(Xt+E(Xt*Xt+1))}(y(Ue))/3,Ct=n(_t),er=D(yt),rr=er*er-Ct*Ct;return[2*s(Ue)*t(z(yt)*Ct,.25-rr),2*s(Ke)*t(er*p(_t),.25+rr)]};var X=E(8),$=g(1+T);function re(Ue,Ke){var rt=y(Ke);return rt<_?[Ue,g(u(_+Ke/2))]:[Ue*n(rt)*(2*T-1/p(rt)),s(Ke)*(2*T*(rt-_)-g(u(rt/2)))]}function H(Ue){var Ke=2*x/Ue;function rt(ut,_t){var yt=v.geoAzimuthalEquidistantRaw(ut,_t);if(y(ut)>f){var Ct=t(yt[1],yt[0]),er=E(yt[0]*yt[0]+yt[1]*yt[1]),rr=Ke*l((Ct-f)/Ke)+f,Xt=t(p(Ct-=rr),2-n(Ct));Ct=rr+P(x/er*p(Xt))-Xt,yt[0]=er*n(Ct),yt[1]=er*p(Ct)}return yt}return rt.invert=function(ut,_t){var yt=E(ut*ut+_t*_t);if(yt>f){var Ct=t(_t,ut),er=Ke*l((Ct-f)/Ke)+f,rr=Ct>er?-1:1,Xt=yt*n(er-Ct),ur=1/u(rr*S((Xt-x)/E(x*(x-2*Xt)+yt*yt)));Ct=er+2*e((ur+rr*E(ur*ur-3))/3),ut=yt*n(Ct),_t=yt*p(Ct)}return v.geoAzimuthalEquidistantRaw.invert(ut,_t)},rt}function N(Ue,Ke){if(arguments.length<2&&(Ke=Ue),Ke===1)return v.geoAzimuthalEqualAreaRaw;if(Ke===1/0)return U;function rt(ut,_t){var yt=v.geoAzimuthalEqualAreaRaw(ut/Ke,_t);return yt[0]*=Ue,yt}return rt.invert=function(ut,_t){var yt=v.geoAzimuthalEqualAreaRaw.invert(ut/Ue,_t);return yt[0]*=Ke,yt},rt}function U(Ue,Ke){return[Ue*n(Ke)/n(Ke/=2),2*p(Ke)]}function te(Ue,Ke,rt){var ut,_t,yt,Ct=100;rt=rt===void 0?0:+rt,Ke=+Ke;do(_t=Ue(rt))===(yt=Ue(rt+i))&&(yt=_t+i),rt-=ut=-1*i*(_t-Ke)/(_t-yt);while(Ct-- >0&&y(ut)>i);return Ct<0?NaN:rt}function B(Ue,Ke,rt){return Ke===void 0&&(Ke=40),rt===void 0&&(rt=1e-12),function(ut,_t,yt,Ct){var er,rr,Xt;yt=yt===void 0?0:+yt,Ct=Ct===void 0?0:+Ct;for(var ur=0;ur<Ke;ur++){var yr=Ue(yt,Ct),kr=yr[0]-ut,Sr=yr[1]-_t;if(y(kr)<rt&&y(Sr)<rt)break;var Ur=kr*kr+Sr*Sr;if(Ur>er)yt-=rr/=2,Ct-=Xt/=2;else{er=Ur;var un=(yt>0?-1:1)*rt,xn=(Ct>0?-1:1)*rt,On=Ue(yt+un,Ct),Fn=Ue(yt,Ct+xn),Yn=(On[0]-yr[0])/un,Bn=(On[1]-yr[1])/un,vi=(Fn[0]-yr[0])/xn,Si=(Fn[1]-yr[1])/xn,Ui=Si*Yn-Bn*vi,ji=(y(Ui)<.5?.5:1)/Ui;if(yt+=rr=(Sr*vi-kr*Si)*ji,Ct+=Xt=(kr*Bn-Sr*Yn)*ji,y(rr)<rt&&y(Xt)<rt)break}}return[yt,Ct]}}function K(){var Ue=N(1.68,2);function Ke(rt,ut){if(rt+ut<-1.4){var _t=(rt-ut+1.6)*(rt+ut+1.4)/8;rt+=_t,ut-=.8*_t*p(ut+x/2)}var yt=Ue(rt,ut),Ct=(1-n(rt*ut))/12;return yt[1]<0&&(yt[0]*=1+Ct),yt[1]>0&&(yt[1]*=1+Ct/1.5*yt[0]*yt[0]),yt}return Ke.invert=B(Ke),Ke}function J(Ue,Ke){var rt,ut=Ue*p(Ke),_t=30;do Ke-=rt=(Ke+p(Ke)-ut)/(1+n(Ke));while(y(rt)>i&&--_t>0);return Ke/2}function ee(Ue,Ke,rt){function ut(_t,yt){return[Ue*_t*n(yt=J(rt,yt)),Ke*p(yt)]}return ut.invert=function(_t,yt){return yt=P(yt/Ke),[_t/(Ue*n(yt)),P((2*yt+p(2*yt))/rt)]},ut}re.invert=function(Ue,Ke){if((ut=y(Ke))<$)return[Ue,2*e(o(Ke))-f];var rt,ut,_t=_,yt=25;do{var Ct=n(_t/2),er=u(_t/2);_t-=rt=(X*(_t-_)-g(er)-ut)/(X-Ct*Ct/(2*er))}while(y(rt)>1e-12&&--yt>0);return[Ue/(n(_t)*(X-1/p(_t))),s(Ke)*_t]},U.invert=function(Ue,Ke){var rt=2*P(Ke/2);return[Ue*n(rt/2)/n(rt),rt]};var ne=ee(T/f,T,x),se=2.00276,oe=1.11072;function me(Ue,Ke){var rt=J(x,Ke);return[se*Ue/(1/n(Ke)+oe/n(rt)),(Ke+T*p(rt))/se]}function ce(Ue){var Ke=0,rt=v.geoProjectionMutator(Ue),ut=rt(Ke);return ut.parallel=function(_t){return arguments.length?rt(Ke=_t*I):Ke*A},ut}function ye(Ue,Ke){return[Ue*n(Ke),Ke]}function Se(Ue){if(!Ue)return ye;var Ke=1/u(Ue);function rt(ut,_t){var yt=Ke+Ue-_t,Ct=yt&&ut*n(_t)/yt;return[yt*p(Ct),Ke-yt*n(Ct)]}return rt.invert=function(ut,_t){var yt=E(ut*ut+(_t=Ke-_t)*_t),Ct=Ke+Ue-yt;return[yt/n(Ct)*t(ut,_t),Ct]},rt}function fe(Ue){function Ke(rt,ut){var _t=f-ut,yt=_t&&rt*Ue*p(_t)/_t;return[_t*p(yt)/Ue,f-_t*n(yt)]}return Ke.invert=function(rt,ut){var _t=rt*Ue,yt=f-ut,Ct=E(_t*_t+yt*yt),er=t(_t,yt);return[(Ct?Ct/p(Ct):1)*er/Ue,f-Ct]},Ke}me.invert=function(Ue,Ke){var rt,ut,_t=se*Ke,yt=Ke<0?-_:_,Ct=25;do ut=_t-T*p(yt),yt-=rt=(p(2*yt)+2*yt-x*p(ut))/(2*n(2*yt)+2+x*n(ut)*T*n(yt));while(y(rt)>i&&--Ct>0);return ut=_t-T*p(yt),[Ue*(1/n(ut)+oe/n(yt))/se,ut]},ye.invert=function(Ue,Ke){return[Ue/n(Ke),Ke]};var ge=ee(1,4/x,x);function Te(Ue,Ke,rt,ut,_t,yt){var Ct,er=n(yt);if(y(Ue)>1||y(yt)>1)Ct=S(rt*_t+Ke*ut*er);else{var rr=p(Ue/2),Xt=p(yt/2);Ct=2*P(E(rr*rr+Ke*ut*Xt*Xt))}return y(Ct)>i?[Ct,t(ut*p(yt),Ke*_t-rt*ut*er)]:[0,0]}function le(Ue,Ke,rt){return S((Ue*Ue+Ke*Ke-rt*rt)/(2*Ue*Ke))}function ve(Ue){return Ue-2*x*r((Ue+x)/(2*x))}function Me(Ue,Ke,rt){for(var ut,_t=[[Ue[0],Ue[1],p(Ue[1]),n(Ue[1])],[Ke[0],Ke[1],p(Ke[1]),n(Ke[1])],[rt[0],rt[1],p(rt[1]),n(rt[1])]],yt=_t[2],Ct=0;Ct<3;++Ct,yt=ut)ut=_t[Ct],yt.v=Te(ut[1]-yt[1],yt[3],yt[2],ut[3],ut[2],ut[0]-yt[0]),yt.point=[0,0];var er=le(_t[0].v[0],_t[2].v[0],_t[1].v[0]),rr=le(_t[0].v[0],_t[1].v[0],_t[2].v[0]),Xt=x-er;_t[2].point[1]=0,_t[0].point[0]=-(_t[1].point[0]=_t[0].v[0]/2);var ur=[_t[2].point[0]=_t[0].point[0]+_t[2].v[0]*n(er),2*(_t[0].point[1]=_t[1].point[1]=_t[2].v[0]*p(er))];return function(yr,kr){var Sr,Ur=p(kr),un=n(kr),xn=new Array(3);for(Sr=0;Sr<3;++Sr){var On=_t[Sr];if(xn[Sr]=Te(kr-On[1],On[3],On[2],un,Ur,yr-On[0]),!xn[Sr][0])return On.point;xn[Sr][1]=ve(xn[Sr][1]-On.v[1])}var Fn=ur.slice();for(Sr=0;Sr<3;++Sr){var Yn=Sr==2?0:Sr+1,Bn=le(_t[Sr].v[0],xn[Sr][0],xn[Yn][0]);xn[Sr][1]<0&&(Bn=-Bn),Sr?Sr==1?(Bn=rr-Bn,Fn[0]-=xn[Sr][0]*n(Bn),Fn[1]-=xn[Sr][0]*p(Bn)):(Bn=Xt-Bn,Fn[0]+=xn[Sr][0]*n(Bn),Fn[1]+=xn[Sr][0]*p(Bn)):(Fn[0]+=xn[Sr][0]*n(Bn),Fn[1]-=xn[Sr][0]*p(Bn))}return Fn[0]/=3,Fn[1]/=3,Fn}}function we(Ue){return Ue[0]*=I,Ue[1]*=I,Ue}function de(Ue,Ke,rt){var ut=v.geoCentroid({type:"MultiPoint",coordinates:[Ue,Ke,rt]}),_t=[-ut[0],-ut[1]],yt=v.geoRotation(_t),Ct=Me(we(yt(Ue)),we(yt(Ke)),we(yt(rt)));Ct.invert=B(Ct);var er=v.geoProjection(Ct).rotate(_t),rr=er.center;return delete er.rotate,er.center=function(Xt){return arguments.length?rr(yt(Xt)):yt.invert(rr())},er.clipAngle(90)}function Ie(Ue,Ke){var rt=E(1-p(Ke));return[2/k*Ue*rt,k*(1-rt)]}function De(Ue){var Ke=u(Ue);function rt(ut,_t){return[ut,(ut?ut/p(ut):1)*(p(_t)*n(ut)-Ke*n(_t))]}return rt.invert=Ke?function(ut,_t){ut&&(_t*=p(ut)/ut);var yt=n(ut);return[ut,2*t(E(yt*yt+Ke*Ke-_t*_t)-yt,Ke-_t)]}:function(ut,_t){return[ut,P(ut?_t*u(ut)/ut:_t)]},rt}Ie.invert=function(Ue,Ke){var rt=(rt=Ke/k-1)*rt;return[rt>0?Ue*E(x/rt)/2:0,P(1-rt)]};var Oe=E(3);function Ve(Ue,Ke){return[Oe*Ue*(2*n(2*Ke/3)-1)/k,Oe*k*p(Ke/3)]}function Fe(Ue){var Ke=n(Ue);function rt(ut,_t){return[ut*Ke,p(_t)/Ke]}return rt.invert=function(ut,_t){return[ut/Ke,P(_t*Ke)]},rt}function ze(Ue){var Ke=n(Ue);function rt(ut,_t){return[ut*Ke,(1+Ke)*u(_t/2)]}return rt.invert=function(ut,_t){return[ut/Ke,2*e(_t/(1+Ke))]},rt}function Re(Ue,Ke){var rt=E(8/(3*x));return[rt*Ue*(1-y(Ke)/x),rt*Ke]}function We(Ue,Ke){var rt=E(4-3*p(y(Ke)));return[2/E(6*x)*Ue*rt,s(Ke)*E(2*x/3)*(2-rt)]}function $e(Ue,Ke){var rt=E(x*(4+x));return[2/rt*Ue*(1+E(1-4*Ke*Ke/(x*x))),4/rt*Ke]}function at(Ue,Ke){var rt=(2+f)*p(Ke);Ke/=2;for(var ut=0,_t=1/0;ut<10&&y(_t)>i;ut++){var yt=n(Ke);Ke-=_t=(Ke+p(Ke)*(yt+2)-rt)/(2*yt*(1+yt))}return[2/E(x*(4+x))*Ue*(1+n(Ke)),2*E(x/(4+x))*p(Ke)]}function gt(Ue,Ke){return[Ue*(1+n(Ke))/E(2+x),2*Ke/E(2+x)]}function xt(Ue,Ke){for(var rt=(1+f)*p(Ke),ut=0,_t=1/0;ut<10&&y(_t)>i;ut++)Ke-=_t=(Ke+p(Ke)-rt)/(1+n(Ke));return rt=E(2+x),[Ue*(1+n(Ke))/rt,2*Ke/rt]}Ve.invert=function(Ue,Ke){var rt=3*P(Ke/(Oe*k));return[k*Ue/(Oe*(2*n(2*rt/3)-1)),rt]},Re.invert=function(Ue,Ke){var rt=E(8/(3*x)),ut=Ke/rt;return[Ue/(rt*(1-y(ut)/x)),ut]},We.invert=function(Ue,Ke){var rt=2-y(Ke)/E(2*x/3);return[Ue*E(6*x)/(2*rt),s(Ke)*P((4-rt*rt)/3)]},$e.invert=function(Ue,Ke){var rt=E(x*(4+x))/2;return[Ue*rt/(1+E(1-Ke*Ke*(4+x)/(4*x))),Ke*rt/2]},at.invert=function(Ue,Ke){var rt=Ke*E((4+x)/x)/2,ut=P(rt),_t=n(ut);return[Ue/(2/E(x*(4+x))*(1+_t)),P((ut+rt*(_t+2))/(2+f))]},gt.invert=function(Ue,Ke){var rt=E(2+x),ut=Ke*rt/2;return[rt*Ue/(1+n(ut)),ut]},xt.invert=function(Ue,Ke){var rt=1+f,ut=E(rt/2);return[2*Ue*ut/(1+n(Ke*=ut)),P((Ke+p(Ke))/rt)]};var mt=3+2*T;function nt(Ue,Ke){var rt=p(Ue/=2),ut=n(Ue),_t=E(n(Ke)),yt=n(Ke/=2),Ct=p(Ke)/(yt+T*ut*_t),er=E(2/(1+Ct*Ct)),rr=E((T*yt+(ut+rt)*_t)/(T*yt+(ut-rt)*_t));return[mt*(er*(rr-1/rr)-2*g(rr)),mt*(er*Ct*(rr+1/rr)-2*e(Ct))]}nt.invert=function(Ue,Ke){if(!(rt=Q.invert(Ue/1.2,1.065*Ke)))return null;var rt,ut=rt[0],_t=rt[1],yt=20;Ue/=mt,Ke/=mt;do{var Ct=ut/2,er=_t/2,rr=p(Ct),Xt=n(Ct),ur=p(er),yr=n(er),kr=n(_t),Sr=E(kr),Ur=ur/(yr+T*Xt*Sr),un=Ur*Ur,xn=E(2/(1+un)),On=(T*yr+(Xt+rr)*Sr)/(T*yr+(Xt-rr)*Sr),Fn=E(On),Yn=Fn-1/Fn,Bn=Fn+1/Fn,vi=xn*Yn-2*g(Fn)-Ue,Si=xn*Ur*Bn-2*e(Ur)-Ke,Ui=ur&&b*Sr*rr*un/ur,ji=(T*Xt*yr+Sr)/(2*(yr+T*Xt*Sr)*(yr+T*Xt*Sr)*Sr),Vi=-.5*Ur*xn*xn*xn,Ea=Vi*Ui,ka=Vi*ji,ca=(ca=2*yr+T*Sr*(Xt-rr))*ca*Fn,ua=(T*Xt*yr*Sr+kr)/ca,Ma=-T*rr*ur/(Sr*ca),Ga=Yn*Ea-2*ua/Fn+xn*(ua+ua/On),ao=Yn*ka-2*Ma/Fn+xn*(Ma+Ma/On),oo=Ur*Bn*Ea-2*Ui/(1+un)+xn*Bn*Ui+xn*Ur*(ua-ua/On),so=Ur*Bn*ka-2*ji/(1+un)+xn*Bn*ji+xn*Ur*(Ma-Ma/On),lo=ao*oo-so*Ga;if(!lo)break;var zi=(Si*ao-vi*so)/lo,dt=(vi*oo-Si*Ga)/lo;ut-=zi,_t=c(-f,a(f,_t-dt))}while((y(zi)>i||y(dt)>i)&&--yt>0);return y(y(_t)-f)<i?[0,_t]:yt&&[ut,_t]};var Qe=n(35*I);function vt(Ue,Ke){var rt=u(Ke/2);return[Ue*Qe*E(1-rt*rt),(1+Qe)*rt]}function jt(Ue,Ke){var rt=Ke/2,ut=n(rt);return[2*Ue/k*n(Ke)*ut*ut,k*u(rt)]}function Gt(Ue){var Ke=1-Ue,rt=_t(x,0)[0]-_t(-x,0)[0],ut=E(2*(_t(0,f)[1]-_t(0,-f)[1])/rt);function _t(er,rr){var Xt=n(rr),ur=p(rr);return[Xt/(Ke+Ue*Xt)*er,Ke*rr+Ue*ur]}function yt(er,rr){var Xt=_t(er,rr);return[Xt[0]*ut,Xt[1]/ut]}function Ct(er){return yt(0,er)[1]}return yt.invert=function(er,rr){var Xt=te(Ct,rr);return[er/ut*(Ue+Ke/n(Xt)),Xt]},yt}function $t(Ue){return[Ue[0]/2,P(u(Ue[1]/2*I))*A]}function Zt(Ue){return[2*Ue[0],2*e(p(Ue[1]*I))*A]}function cr(Ue,Ke){var rt=2*x/Ke,ut=Ue*Ue;function _t(yt,Ct){var er=v.geoAzimuthalEquidistantRaw(yt,Ct),rr=er[0],Xt=er[1],ur=rr*rr+Xt*Xt;if(ur>ut){var yr=E(ur),kr=t(Xt,rr),Sr=rt*l(kr/rt),Ur=kr-Sr,un=Ue*n(Ur),xn=(Ue*p(Ur)-Ur*p(un))/(f-un),On=Dt(Ur,xn),Fn=(x-Ue)/Ne(On,un,x);rr=yr;var Yn,Bn=50;do rr-=Yn=(Ue+Ne(On,un,rr)*Fn-yr)/(On(rr)*Fn);while(y(Yn)>i&&--Bn>0);Xt=Ur*p(rr),rr<f&&(Xt-=xn*(rr-f));var vi=p(Sr),Si=n(Sr);er[0]=rr*Si-Xt*vi,er[1]=rr*vi+Xt*Si}return er}return _t.invert=function(yt,Ct){var er=yt*yt+Ct*Ct;if(er>ut){var rr=E(er),Xt=t(Ct,yt),ur=rt*l(Xt/rt),yr=Xt-ur;yt=rr*n(yr),Ct=rr*p(yr);for(var kr=yt-f,Sr=p(yt),Ur=Ct/Sr,un=yt<f?1/0:0,xn=10;;){var On=Ue*p(Ur),Fn=Ue*n(Ur),Yn=p(Fn),Bn=f-Fn,vi=(On-Ur*Yn)/Bn,Si=Dt(Ur,vi);if(y(un)<1e-12||!--xn)break;Ur-=un=(Ur*Sr-vi*kr-Ct)/(Sr-2*kr*(Bn*(Fn+Ur*On*n(Fn)-Yn)-On*(On-Ur*Yn))/(Bn*Bn))}yt=(rr=Ue+Ne(Si,Fn,yt)*(x-Ue)/Ne(Si,Fn,x))*n(Xt=ur+Ur),Ct=rr*p(Xt)}return v.geoAzimuthalEquidistantRaw.invert(yt,Ct)},_t}function Dt(Ue,Ke){return function(rt){var ut=Ue*n(rt);return rt<f&&(ut-=Ke),E(1+ut*ut)}}function Ne(Ue,Ke,rt){for(var ut=(rt-Ke)/50,_t=Ue(Ke)+Ue(rt),yt=1,Ct=Ke;yt<50;++yt)_t+=2*Ue(Ct+=ut);return .5*_t*ut}function Ye(Ue,Ke,rt,ut,_t,yt,Ct,er){function rr(Xt,ur){if(!ur)return[Ue*Xt/x,0];var yr=ur*ur,kr=Ue+yr*(Ke+yr*(rt+yr*ut)),Sr=ur*(_t-1+yr*(yt-er+yr*Ct)),Ur=(kr*kr+Sr*Sr)/(2*Sr),un=Xt*P(kr/Ur)/x;return[Ur*p(un),ur*(1+yr*er)+Ur*(1-n(un))]}return arguments.length<8&&(er=0),rr.invert=function(Xt,ur){var yr,kr,Sr=x*Xt/Ue,Ur=ur,un=50;do{var xn=Ur*Ur,On=Ue+xn*(Ke+xn*(rt+xn*ut)),Fn=Ur*(_t-1+xn*(yt-er+xn*Ct)),Yn=On*On+Fn*Fn,Bn=2*Fn,vi=Yn/Bn,Si=vi*vi,Ui=P(On/vi)/x,ji=Sr*Ui,Vi=On*On,Ea=(2*Ke+xn*(4*rt+6*xn*ut))*Ur,ka=_t+xn*(3*yt+5*xn*Ct),ca=(2*(On*Ea+Fn*(ka-1))*Bn-Yn*(2*(ka-1)))/(Bn*Bn),ua=n(ji),Ma=p(ji),Ga=vi*ua,ao=vi*Ma,oo=Sr/x*(1/E(1-Vi/Si))*(Ea*vi-On*ca)/Si,so=ao-Xt,lo=Ur*(1+xn*er)+vi-Ga-ur,zi=ca*Ma+Ga*oo,dt=Ga*Ui,Ft=1+ca-(ca*ua-ao*oo),hr=ao*Ui,Yt=zi*hr-Ft*dt;if(!Yt)break;Sr-=yr=(lo*zi-so*Ft)/Yt,Ur-=kr=(so*hr-lo*dt)/Yt}while((y(yr)>i||y(kr)>i)&&--un>0);return[Sr,Ur]},rr}vt.invert=function(Ue,Ke){var rt=Ke/(1+Qe);return[Ue&&Ue/(Qe*E(1-rt*rt)),2*e(rt)]},jt.invert=function(Ue,Ke){var rt=e(Ke/k),ut=n(rt),_t=2*rt;return[Ue*k/2/(n(_t)*ut*ut),_t]};var pe=Ye(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555),_e=Ye(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742),Be=Ye(5/6*x,-.62636,-.0344,0,1.3493,-.05524,0,.045);function He(Ue,Ke){var rt=Ue*Ue,ut=Ke*Ke;return[Ue*(1-.162388*ut)*(.87-952426e-9*rt*rt),Ke*(1+ut/12)]}He.invert=function(Ue,Ke){var rt,ut=Ue,_t=Ke,yt=50;do{var Ct=_t*_t;_t-=rt=(_t*(1+Ct/12)-Ke)/(1+Ct/4)}while(y(rt)>i&&--yt>0);yt=50,Ue/=1-.162388*Ct;do{var er=(er=ut*ut)*er;ut-=rt=(ut*(.87-952426e-9*er)-Ue)/(.87-.00476213*er)}while(y(rt)>i&&--yt>0);return[ut,_t]};var Je=Ye(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762);function Ze(Ue){var Ke=Ue(f,0)[0]-Ue(-f,0)[0];function rt(ut,_t){var yt=ut>0?-.5:.5,Ct=Ue(ut+yt*x,_t);return Ct[0]-=yt*Ke,Ct}return Ue.invert&&(rt.invert=function(ut,_t){var yt=ut>0?-.5:.5,Ct=Ue.invert(ut+yt*Ke,_t),er=Ct[0]-yt*x;return er<-x?er+=2*x:er>x&&(er-=2*x),Ct[0]=er,Ct}),rt}function ct(Ue,Ke){var rt=s(Ue),ut=s(Ke),_t=n(Ke),yt=n(Ue)*_t,Ct=p(Ue)*_t,er=p(ut*Ke);Ue=y(t(Ct,er)),Ke=P(yt),y(Ue-f)>i&&(Ue%=f);var rr=function(Xt,ur){if(ur===f)return[0,0];var yr,kr,Sr=p(ur),Ur=Sr*Sr,un=Ur*Ur,xn=1+un,On=1+3*un,Fn=1-un,Yn=P(1/E(xn)),Bn=Fn+Ur*xn*Yn,vi=(1-Sr)/Bn,Si=E(vi),Ui=vi*xn,ji=E(Ui),Vi=Si*Fn;if(Xt===0)return[0,-(Vi+Ur*ji)];var Ea,ka=n(ur),ca=1/ka,ua=2*Sr*ka,Ma=(-Bn*ka-(-3*Ur+Yn*On)*ua*(1-Sr))/(Bn*Bn),Ga=-ca*ua,ao=-ca*(Ur*xn*Ma+vi*On*ua),oo=-2*ca*(Fn*(.5*Ma/Si)-2*Ur*Si*ua),so=4*Xt/x;if(Xt>.222*x||ur<x/4&&Xt>.175*x){if(yr=(Vi+Ur*E(Ui*(1+un)-Vi*Vi))/(1+un),Xt>x/4)return[yr,yr];var lo=yr,zi=.5*yr;yr=.5*(zi+lo),kr=50;do{var dt=E(Ui-yr*yr),Ft=yr*(oo+Ga*dt)+ao*P(yr/ji)-so;if(!Ft)break;Ft<0?zi=yr:lo=yr,yr=.5*(zi+lo)}while(y(lo-zi)>i&&--kr>0)}else{yr=i,kr=25;do{var hr=yr*yr,Yt=E(Ui-hr),pr=oo+Ga*Yt,Nr=yr*pr+ao*P(yr/ji)-so,qr=pr+(ao-Ga*hr)/Yt;yr-=Ea=Yt?Nr/qr:0}while(y(Ea)>i&&--kr>0)}return[yr,-Vi-Ur*E(Ui-yr*yr)]}(Ue>x/4?f-Ue:Ue,Ke);return Ue>x/4&&(er=rr[0],rr[0]=-rr[1],rr[1]=-er),rr[0]*=rt,rr[1]*=-ut,rr}function lt(Ue,Ke){var rt,ut,_t,yt,Ct,er;if(Ke<i)return[(yt=p(Ue))-(rt=Ke*(Ue-yt*(ut=n(Ue)))/4)*ut,ut+rt*yt,1-Ke*yt*yt/2,Ue-rt];if(Ke>=1-i)return rt=(1-Ke)/4,_t=1/(ut=D(Ue)),[(yt=((er=o(2*(er=Ue)))-1)/(er+1))+rt*((Ct=ut*z(Ue))-Ue)/(ut*ut),_t-rt*yt*_t*(Ct-Ue),_t+rt*yt*_t*(Ct+Ue),2*e(o(Ue))-f+rt*(Ct-Ue)/ut];var rr=[1,0,0,0,0,0,0,0,0],Xt=[E(Ke),0,0,0,0,0,0,0,0],ur=0;for(ut=E(1-Ke),Ct=1;y(Xt[ur]/rr[ur])>i&&ur<8;)rt=rr[ur++],Xt[ur]=(rt-ut)/2,rr[ur]=(rt+ut)/2,ut=E(rt*ut),Ct*=2;_t=Ct*rr[ur]*Ue;do _t=(P(yt=Xt[ur]*p(ut=_t)/rr[ur])+_t)/2;while(--ur);return[p(_t),yt=n(_t),yt/n(_t-ut),_t]}function At(Ue,Ke){if(!Ke)return Ue;if(Ke===1)return g(u(Ue/2+_));for(var rt=1,ut=E(1-Ke),_t=E(Ke),yt=0;y(_t)>i;yt++){if(Ue%x){var Ct=e(ut*u(Ue)/rt);Ct<0&&(Ct+=x),Ue+=Ct+~~(Ue/x)*x}else Ue+=Ue;_t=(rt+ut)/2,ut=E(rt*ut),_t=((rt=_t)-ut)/2}return Ue/(h(2,yt)*rt)}function Ot(Ue,Ke){var rt=(T-1)/(T+1),ut=E(1-rt*rt),_t=At(f,ut*ut),yt=g(u(x/4+y(Ke)/2)),Ct=o(-1*yt)/E(rt),er=function(Xt,ur){var yr=Xt*Xt,kr=ur+1,Sr=1-yr-ur*ur;return[.5*((Xt>=0?f:-f)-t(Sr,2*Xt)),-.25*g(Sr*Sr+4*yr)+.5*g(kr*kr+yr)]}(Ct*n(-1*Ue),Ct*p(-1*Ue)),rr=function(Xt,ur,yr){var kr=y(Xt),Sr=z(y(ur));if(kr){var Ur=1/p(kr),un=1/(u(kr)*u(kr)),xn=-(un+yr*(Sr*Sr*Ur*Ur)-1+yr),On=(-xn+E(xn*xn-4*((yr-1)*un)))/2;return[At(e(1/E(On)),yr)*s(Xt),At(e(E((On/un-1)/yr)),1-yr)*s(ur)]}return[0,At(e(Sr),1-yr)*s(ur)]}(er[0],er[1],ut*ut);return[-rr[1],(Ke>=0?1:-1)*(.5*_t-rr[0])]}function it(Ue){var Ke=p(Ue),rt=n(Ue),ut=ht(Ue);function _t(yt,Ct){var er=ut(yt,Ct);yt=er[0],Ct=er[1];var rr=p(Ct),Xt=n(Ct),ur=n(yt),yr=S(Ke*rr+rt*Xt*ur),kr=p(yr),Sr=y(kr)>i?yr/kr:1;return[Sr*rt*p(yt),(y(yt)>f?Sr:-Sr)*(Ke*Xt-rt*rr*ur)]}return ut.invert=ht(-Ue),_t.invert=function(yt,Ct){var er=E(yt*yt+Ct*Ct),rr=-p(er),Xt=n(er),ur=er*Xt,yr=-Ct*rr,kr=er*Ke,Sr=E(ur*ur+yr*yr-kr*kr),Ur=t(ur*kr+yr*Sr,yr*kr-ur*Sr),un=(er>f?-1:1)*t(yt*rr,er*n(Ur)*Xt+Ct*p(Ur)*rr);return ut.invert(un,Ur)},_t}function ht(Ue){var Ke=p(Ue),rt=n(Ue);return function(ut,_t){var yt=n(_t),Ct=n(ut)*yt,er=p(ut)*yt,rr=p(_t);return[t(er,Ct*rt-rr*Ke),P(rr*rt+Ct*Ke)]}}ct.invert=function(Ue,Ke){y(Ue)>1&&(Ue=2*s(Ue)-Ue),y(Ke)>1&&(Ke=2*s(Ke)-Ke);var rt=s(Ue),ut=s(Ke),_t=-rt*Ue,yt=-ut*Ke,Ct=yt/_t<1,er=function(yr,kr){for(var Sr=0,Ur=1,un=.5,xn=50;;){var On=un*un,Fn=E(un),Yn=P(1/E(1+On)),Bn=1-On+un*(1+On)*Yn,vi=(1-Fn)/Bn,Si=E(vi),Ui=vi*(1+On),ji=Si*(1-On),Vi=E(Ui-yr*yr),Ea=kr+ji+un*Vi;if(y(Ur-Sr)<1e-12||--xn==0||Ea===0)break;Ea>0?Sr=un:Ur=un,un=.5*(Sr+Ur)}if(!xn)return null;var ka=P(Fn),ca=n(ka),ua=1/ca,Ma=2*Fn*ca,Ga=(-Bn*ca-(-3*un+Yn*(1+3*On))*Ma*(1-Fn))/(Bn*Bn);return[x/4*(yr*(-2*ua*(.5*Ga/Si*(1-On)-2*un*Si*Ma)+-ua*Ma*Vi)+-ua*(un*(1+On)*Ga+vi*(1+3*On)*Ma)*P(yr/E(Ui))),ka]}(Ct?yt:_t,Ct?_t:yt),rr=er[0],Xt=er[1],ur=n(Xt);return Ct&&(rr=-f-rr),[rt*(t(p(rr)*ur,-p(Xt))+x),ut*P(n(rr)*ur)]},Ot.invert=function(Ue,Ke){var rt,ut,_t,yt,Ct,er,rr=(T-1)/(T+1),Xt=E(1-rr*rr),ur=At(f,Xt*Xt),yr=(ut=-Ue,_t=Xt*Xt,(rt=.5*ur-Ke)?(yt=lt(rt,_t),ut?(er=(Ct=lt(ut,1-_t))[1]*Ct[1]+_t*yt[0]*yt[0]*Ct[0]*Ct[0],[[yt[0]*Ct[2]/er,yt[1]*yt[2]*Ct[0]*Ct[1]/er],[yt[1]*Ct[1]/er,-yt[0]*yt[2]*Ct[0]*Ct[2]/er],[yt[2]*Ct[1]*Ct[2]/er,-_t*yt[0]*yt[1]*Ct[0]/er]]):[[yt[0],0],[yt[1],0],[yt[2],0]]):[[0,(Ct=lt(ut,1-_t))[0]/Ct[1]],[1/Ct[1],0],[Ct[2]/Ct[1],0]]),kr=function(Sr,Ur){var un=Ur[0]*Ur[0]+Ur[1]*Ur[1];return[(Sr[0]*Ur[0]+Sr[1]*Ur[1])/un,(Sr[1]*Ur[0]-Sr[0]*Ur[1])/un]}(yr[0],yr[1]);return[t(kr[1],kr[0])/-1,2*e(o(-.5*g(rr*kr[0]*kr[0]+rr*kr[1]*kr[1])))-f]};var Ut=P(1-1/3)*A,Mt=Fe(0);function It(Ue){var Ke=Ut*I,rt=Ie(x,Ke)[0]-Ie(-x,Ke)[0],ut=Mt(0,Ke)[1],_t=Ie(0,Ke)[1],yt=k-_t,Ct=L/Ue,er=4/L,rr=ut+yt*yt*4/L;function Xt(ur,yr){var kr,Sr=y(yr);if(Sr>Ke){var Ur=a(Ue-1,c(0,r((ur+x)/Ct)));(kr=Ie(ur+=x*(Ue-1)/Ue-Ur*Ct,Sr))[0]=kr[0]*L/rt-L*(Ue-1)/(2*Ue)+Ur*L/Ue,kr[1]=ut+4*(kr[1]-_t)*yt/L,yr<0&&(kr[1]=-kr[1])}else kr=Mt(ur,yr);return kr[0]*=er,kr[1]/=rr,kr}return Xt.invert=function(ur,yr){ur/=er;var kr=y(yr*=rr);if(kr>ut){var Sr=a(Ue-1,c(0,r((ur+x)/Ct)));ur=(ur+x*(Ue-1)/Ue-Sr*Ct)*rt/L;var Ur=Ie.invert(ur,.25*(kr-ut)*L/yt+_t);return Ur[0]-=x*(Ue-1)/Ue-Sr*Ct,yr<0&&(Ur[1]=-Ur[1]),Ur}return Mt.invert(ur,yr)},Xt}function Le(Ue,Ke){return[Ue,1&Ke?90-i:Ut]}function Xe(Ue,Ke){return[Ue,1&Ke?-90+i:-Ut]}function ot(Ue){return[Ue[0]*(1-i),Ue[1]]}function pt(Ue){var Ke,rt=1+Ue,ut=P(p(1/rt)),_t=2*E(x/(Ke=x+4*ut*rt)),yt=.5*_t*(rt+E(Ue*(2+Ue))),Ct=Ue*Ue,er=rt*rt;function rr(Xt,ur){var yr,kr,Sr=1-p(ur);if(Sr&&Sr<2){var Ur,un=f-ur,xn=25;do{var On=p(un),Fn=n(un),Yn=ut+t(On,rt-Fn),Bn=1+er-2*rt*Fn;un-=Ur=(un-Ct*ut-rt*On+Bn*Yn-.5*Sr*Ke)/(2*rt*On*Yn)}while(y(Ur)>1e-12&&--xn>0);yr=_t*E(Bn),kr=Xt*Yn/x}else yr=_t*(Ue+Sr),kr=Xt*ut/x;return[yr*p(kr),yt-yr*n(kr)]}return rr.invert=function(Xt,ur){var yr=Xt*Xt+(ur-=yt)*ur,kr=(1+er-yr/(_t*_t))/(2*rt),Sr=S(kr),Ur=p(Sr),un=ut+t(Ur,rt-kr);return[P(Xt/E(yr))*x/un,P(1-2*(Sr-Ct*ut-rt*Ur+(1+er-2*rt*kr)*un)/Ke)]},rr}function St(Ue,Ke){return Ke>-.7109889596207567?((Ue=ne(Ue,Ke))[1]+=.0528035274542,Ue):ye(Ue,Ke)}function Vt(Ue,Ke){return y(Ke)>.7109889596207567?((Ue=ne(Ue,Ke))[1]-=Ke>0?.0528035274542:-.0528035274542,Ue):ye(Ue,Ke)}function Jt(Ue,Ke,rt,ut){var _t=E(4*x/(2*rt+(1+Ue-Ke/2)*p(2*rt)+(Ue+Ke)/2*p(4*rt)+Ke/2*p(6*rt))),yt=E(ut*p(rt)*E((1+Ue*n(2*rt)+Ke*n(4*rt))/(1+Ue+Ke))),Ct=rt*rr(1);function er(yr){return E(1+Ue*n(2*yr)+Ke*n(4*yr))}function rr(yr){var kr=yr*rt;return(2*kr+(1+Ue-Ke/2)*p(2*kr)+(Ue+Ke)/2*p(4*kr)+Ke/2*p(6*kr))/rt}function Xt(yr){return er(yr)*p(yr)}var ur=function(yr,kr){var Sr=rt*te(rr,Ct*p(kr)/rt,kr/x);isNaN(Sr)&&(Sr=rt*s(kr));var Ur=_t*er(Sr);return[Ur*yt*yr/x*n(Sr),Ur/yt*p(Sr)]};return ur.invert=function(yr,kr){var Sr=te(Xt,kr*yt/_t);return[yr*x/(n(Sr)*_t*yt*er(Sr)),P(rt*rr(Sr/rt)/Ct)]},rt===0&&(_t=E(ut/x),(ur=function(yr,kr){return[yr*_t,p(kr)/_t]}).invert=function(yr,kr){return[yr/_t,P(kr*_t)]}),ur}function qt(Ue,Ke,rt,ut,_t){ut===void 0&&(ut=1e-8),_t===void 0&&(_t=20);var yt=Ue(Ke),Ct=Ue(.5*(Ke+rt)),er=Ue(rt);return function rr(Xt,ur,yr,kr,Sr,Ur,un,xn,On,Fn,Yn){if(Yn.nanEncountered)return NaN;var Bn,vi,Si,Ui,ji,Vi,Ea,ka,ca,ua;if(vi=Xt(ur+.25*(Bn=yr-ur)),Si=Xt(yr-.25*Bn),isNaN(vi))Yn.nanEncountered=!0;else{if(!isNaN(Si))return ua=((Vi=(Ui=Bn*(kr+4*vi+Sr)/12)+(ji=Bn*(Sr+4*Si+Ur)/12))-un)/15,Fn>On?(Yn.maxDepthCount++,Vi+ua):Math.abs(ua)<xn?Vi+ua:(ka=rr(Xt,ur,Ea=ur+.5*Bn,kr,vi,Sr,Ui,.5*xn,On,Fn+1,Yn),isNaN(ka)?(Yn.nanEncountered=!0,NaN):(ca=rr(Xt,Ea,yr,Sr,Si,Ur,ji,.5*xn,On,Fn+1,Yn),isNaN(ca)?(Yn.nanEncountered=!0,NaN):ka+ca));Yn.nanEncountered=!0}}(Ue,Ke,rt,yt,Ct,er,(yt+4*Ct+er)*(rt-Ke)/6,ut,_t,1,{maxDepthCount:0,nanEncountered:!1})}function gr(Ue,Ke,rt){function ut(Sr){return Ue+(1-Ue)*h(1-h(Sr,Ke),1/Ke)}function _t(Sr){return qt(ut,0,Sr,1e-4)}for(var yt=1/_t(1),Ct=1e3,er=(1+1e-8)*yt,rr=[],Xt=0;Xt<=Ct;Xt++)rr.push(_t(Xt/Ct)*er);function ur(Sr){var Ur=0,un=Ct,xn=500;do rr[xn]>Sr?un=xn:Ur=xn,xn=Ur+un>>1;while(xn>Ur);var On=rr[xn+1]-rr[xn];return On&&(On=(Sr-rr[xn+1])/On),(xn+1+On)/Ct}var yr=2*ur(1)/x*yt/rt,kr=function(Sr,Ur){var un=ur(y(p(Ur))),xn=ut(un)*Sr;return un/=yr,[xn,Ur>=0?un:-un]};return kr.invert=function(Sr,Ur){var un;return y(Ur*=yr)<1&&(un=s(Ur)*P(_t(y(Ur))*yt)),[Sr/ut(y(Ur)),un]},kr}function Cr(Ue,Ke){return y(Ue[0]-Ke[0])<i&&y(Ue[1]-Ke[1])<i}function mr(Ue,Ke){for(var rt,ut,_t,yt=-1,Ct=Ue.length,er=Ue[0],rr=[];++yt<Ct;){ut=((rt=Ue[yt])[0]-er[0])/Ke,_t=(rt[1]-er[1])/Ke;for(var Xt=0;Xt<Ke;++Xt)rr.push([er[0]+Xt*ut,er[1]+Xt*_t]);er=rt}return rr.push(rt),rr}function tr(Ue){var Ke,rt,ut,_t,yt,Ct,er,rr=[],Xt=Ue[0].length;for(er=0;er<Xt;++er)rt=(Ke=Ue[0][er])[0][0],ut=Ke[0][1],_t=Ke[1][1],yt=Ke[2][0],Ct=Ke[2][1],rr.push(mr([[rt+i,ut+i],[rt+i,_t-i],[yt-i,_t-i],[yt-i,Ct+i]],30));for(er=Ue[1].length-1;er>=0;--er)rt=(Ke=Ue[1][er])[0][0],ut=Ke[0][1],_t=Ke[1][1],yt=Ke[2][0],Ct=Ke[2][1],rr.push(mr([[yt-i,Ct-i],[yt-i,_t+i],[rt+i,_t+i],[rt+i,ut-i]],30));return{type:"Polygon",coordinates:[w.merge(rr)]}}function nr(Ue,Ke,rt){var ut,_t;function yt(rr,Xt){for(var ur=Xt<0?-1:1,yr=Ke[+(Xt<0)],kr=0,Sr=yr.length-1;kr<Sr&&rr>yr[kr][2][0];++kr);var Ur=Ue(rr-yr[kr][1][0],Xt);return Ur[0]+=Ue(yr[kr][1][0],ur*Xt>ur*yr[kr][0][1]?yr[kr][0][1]:Xt)[0],Ur}rt?yt.invert=rt(yt):Ue.invert&&(yt.invert=function(rr,Xt){for(var ur=_t[+(Xt<0)],yr=Ke[+(Xt<0)],kr=0,Sr=ur.length;kr<Sr;++kr){var Ur=ur[kr];if(Ur[0][0]<=rr&&rr<Ur[1][0]&&Ur[0][1]<=Xt&&Xt<Ur[1][1]){var un=Ue.invert(rr-Ue(yr[kr][1][0],0)[0],Xt);return un[0]+=yr[kr][1][0],Cr(yt(un[0],un[1]),[rr,Xt])?un:null}}});var Ct=v.geoProjection(yt),er=Ct.stream;return Ct.stream=function(rr){var Xt=Ct.rotate(),ur=er(rr),yr=(Ct.rotate([0,0]),er(rr));return Ct.rotate(Xt),ur.sphere=function(){v.geoStream(ut,yr)},ur},Ct.lobes=function(rr){return arguments.length?(ut=tr(rr),Ke=rr.map(function(Xt){return Xt.map(function(ur){return[[ur[0][0]*I,ur[0][1]*I],[ur[1][0]*I,ur[1][1]*I],[ur[2][0]*I,ur[2][1]*I]]})}),_t=Ke.map(function(Xt){return Xt.map(function(ur){var yr,kr=Ue(ur[0][0],ur[0][1])[0],Sr=Ue(ur[2][0],ur[2][1])[0],Ur=Ue(ur[1][0],ur[0][1])[1],un=Ue(ur[1][0],ur[1][1])[1];return Ur>un&&(yr=Ur,Ur=un,un=yr),[[kr,Ur],[Sr,un]]})}),Ct):Ke.map(function(Xt){return Xt.map(function(ur){return[[ur[0][0]*A,ur[0][1]*A],[ur[1][0]*A,ur[1][1]*A],[ur[2][0]*A,ur[2][1]*A]]})})},Ke!=null&&Ct.lobes(Ke),Ct}St.invert=function(Ue,Ke){return Ke>-.7109889596207567?ne.invert(Ue,Ke-.0528035274542):ye.invert(Ue,Ke)},Vt.invert=function(Ue,Ke){return y(Ke)>.7109889596207567?ne.invert(Ue,Ke+(Ke>0?.0528035274542:-.0528035274542)):ye.invert(Ue,Ke)};var Qt=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],dr=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],_r=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],Ir=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]],Rr=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]],Vr=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]];function Xr(Ue,Ke){return[3/L*Ue*E(x*x/3-Ke*Ke),Ke]}function cn(Ue){function Ke(rt,ut){if(y(y(ut)-f)<i)return[0,ut<0?-2:2];var _t=p(ut),yt=h((1+_t)/(1-_t),Ue/2),Ct=.5*(yt+1/yt)+n(rt*=Ue);return[2*p(rt)/Ct,(yt-1/yt)/Ct]}return Ke.invert=function(rt,ut){var _t=y(ut);if(y(_t-2)<i)return rt?null:[0,s(ut)*f];if(_t>2)return null;var yt=(rt/=2)*rt,Ct=(ut/=2)*ut,er=2*ut/(1+yt+Ct);return er=h((1+er)/(1-er),1/Ue),[t(2*rt,1-yt-Ct)/Ue,P((er-1)/(er+1))]},Ke}Xr.invert=function(Ue,Ke){return[L/3*Ue/E(x*x/3-Ke*Ke),Ke]};var an=x/T;function zn(Ue,Ke){return[Ue*(1+E(n(Ke)))/2,Ke/(n(Ke/2)*n(Ue/6))]}function on(Ue,Ke){var rt=Ue*Ue,ut=Ke*Ke;return[Ue*(.975534+ut*(-.0143059*rt-.119161+-.0547009*ut)),Ke*(1.00384+rt*(.0802894+-.02855*ut+199025e-9*rt)+ut*(.0998909+-.0491032*ut))]}function Tn(Ue,Ke){return[p(Ue)/n(Ke),u(Ke)*n(Ue)]}function Mn(Ue){var Ke=n(Ue),rt=u(_+Ue/2);function ut(_t,yt){var Ct=yt-Ue,er=y(Ct)<i?_t*Ke:y(er=_+yt/2)<i||y(y(er)-f)<i?0:_t*Ct/g(u(er)/rt);return[er,Ct]}return ut.invert=function(_t,yt){var Ct,er=yt+Ue;return[y(yt)<i?_t/Ke:y(Ct=_+er/2)<i||y(y(Ct)-f)<i?0:_t*g(u(Ct)/rt)/yt,er]},ut}function ei(Ue,Ke){return[Ue,1.25*g(u(_+.4*Ke))]}function Hr(Ue){var Ke=Ue.length-1;function rt(ut,_t){for(var yt,Ct=n(_t),er=2/(1+Ct*n(ut)),rr=er*Ct*p(ut),Xt=er*p(_t),ur=Ke,yr=Ue[ur],kr=yr[0],Sr=yr[1];--ur>=0;)kr=(yr=Ue[ur])[0]+rr*(yt=kr)-Xt*Sr,Sr=yr[1]+rr*Sr+Xt*yt;return[kr=rr*(yt=kr)-Xt*Sr,Sr=rr*Sr+Xt*yt]}return rt.invert=function(ut,_t){var yt=20,Ct=ut,er=_t;do{for(var rr,Xt=Ke,ur=Ue[Xt],yr=ur[0],kr=ur[1],Sr=0,Ur=0;--Xt>=0;)Sr=yr+Ct*(rr=Sr)-er*Ur,Ur=kr+Ct*Ur+er*rr,yr=(ur=Ue[Xt])[0]+Ct*(rr=yr)-er*kr,kr=ur[1]+Ct*kr+er*rr;var un,xn,On=(Sr=yr+Ct*(rr=Sr)-er*Ur)*Sr+(Ur=kr+Ct*Ur+er*rr)*Ur;Ct-=un=((yr=Ct*(rr=yr)-er*kr-ut)*Sr+(kr=Ct*kr+er*rr-_t)*Ur)/On,er-=xn=(kr*Sr-yr*Ur)/On}while(y(un)+y(xn)>1e-12&&--yt>0);if(yt){var Fn=E(Ct*Ct+er*er),Yn=2*e(.5*Fn),Bn=p(Yn);return[t(Ct*Bn,Fn*n(Yn)),Fn?P(er*Bn/Fn):0]}},rt}zn.invert=function(Ue,Ke){var rt=y(Ue),ut=y(Ke),_t=i,yt=f;ut<an?yt*=ut/an:_t+=6*S(an/ut);for(var Ct=0;Ct<25;Ct++){var er=p(yt),rr=E(n(yt)),Xt=p(yt/2),ur=n(yt/2),yr=p(_t/6),kr=n(_t/6),Sr=.5*_t*(1+rr)-rt,Ur=yt/(ur*kr)-ut,un=rr?-.25*_t*er/rr:0,xn=.5*(1+rr),On=(1+.5*yt*Xt/ur)/(ur*kr),Fn=yt/ur*(yr/6)/(kr*kr),Yn=un*Fn-On*xn,Bn=(Sr*Fn-Ur*xn)/Yn,vi=(Ur*un-Sr*On)/Yn;if(yt-=Bn,_t-=vi,y(Bn)<i&&y(vi)<i)break}return[Ue<0?-_t:_t,Ke<0?-yt:yt]},on.invert=function(Ue,Ke){var rt=s(Ue)*x,ut=Ke/2,_t=50;do{var yt=rt*rt,Ct=ut*ut,er=rt*ut,rr=rt*(.975534+Ct*(-.0143059*yt-.119161+-.0547009*Ct))-Ue,Xt=ut*(1.00384+yt*(.0802894+-.02855*Ct+199025e-9*yt)+Ct*(.0998909+-.0491032*Ct))-Ke,ur=.975534-Ct*(.119161+3*yt*.0143059+.0547009*Ct),yr=-er*(.238322+.2188036*Ct+.0286118*yt),kr=er*(.1605788+7961e-7*yt+-.0571*Ct),Sr=1.00384+yt*(.0802894+199025e-9*yt)+Ct*(3*(.0998909-.02855*yt)-.245516*Ct),Ur=yr*kr-Sr*ur,un=(Xt*yr-rr*Sr)/Ur,xn=(rr*kr-Xt*ur)/Ur;rt-=un,ut-=xn}while((y(un)>i||y(xn)>i)&&--_t>0);return _t&&[rt,ut]},Tn.invert=function(Ue,Ke){var rt=Ue*Ue,ut=Ke*Ke+1,_t=rt+ut,yt=Ue?b*E((_t-E(_t*_t-4*rt))/rt):1/E(ut);return[P(Ue*yt),s(Ke)*S(yt)]},ei.invert=function(Ue,Ke){return[Ue,2.5*e(o(.8*Ke))-.625*x]};var ln=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],bn=[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],nn=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],pn=[[.9245,0],[0,0],[.01943,0]],qn=[[.721316,0],[0,0],[-.00881625,-.00617325]];function sr(Ue,Ke){var rt=v.geoProjection(Hr(Ue)).rotate(Ke).clipAngle(90),ut=v.geoRotation(Ke),_t=rt.center;return delete rt.rotate,rt.center=function(yt){return arguments.length?_t(ut(yt)):ut.invert(_t())},rt}var xr=E(6),jr=E(7);function Rt(Ue,Ke){var rt=P(7*p(Ke)/(3*xr));return[xr*Ue*(2*n(2*rt/3)-1)/jr,9*p(rt/3)/jr]}function or(Ue,Ke){for(var rt,ut=(1+b)*p(Ke),_t=Ke,yt=0;yt<25&&(_t-=rt=(p(_t/2)+p(_t)-ut)/(.5*n(_t/2)+n(_t)),!(y(rt)<i));yt++);return[Ue*(1+2*n(_t)/n(_t/2))/(3*T),2*E(3)*p(_t/2)/E(2+T)]}function wt(Ue,Ke){for(var rt,ut=E(6/(4+x)),_t=(1+x/4)*p(Ke),yt=Ke/2,Ct=0;Ct<25&&(yt-=rt=(yt/2+p(yt)-_t)/(.5+n(yt)),!(y(rt)<i));Ct++);return[ut*(.5+n(yt))*Ue/1.5,ut*yt]}function ir(Ue,Ke){var rt=Ke*Ke,ut=rt*rt,_t=rt*ut;return[Ue*(.84719-.13063*rt+_t*_t*(.05494*rt-.04515-.02326*ut+.00331*_t)),Ke*(1.01183+ut*ut*(.01926*rt-.02625-.00396*ut))]}function ar(Ue,Ke){return[Ue*(1+n(Ke))/2,2*(Ke-u(Ke/2))]}Rt.invert=function(Ue,Ke){var rt=3*P(Ke*jr/9);return[Ue*jr/(xr*(2*n(2*rt/3)-1)),P(3*p(rt)*xr/7)]},or.invert=function(Ue,Ke){var rt=Ke*E(2+T)/(2*E(3)),ut=2*P(rt);return[3*T*Ue/(1+2*n(ut)/n(ut/2)),P((rt+p(ut))/(1+b))]},wt.invert=function(Ue,Ke){var rt=E(6/(4+x)),ut=Ke/rt;return y(y(ut)-f)<i&&(ut=ut<0?-f:f),[1.5*Ue/(rt*(.5+n(ut))),P((ut/2+p(ut))/(1+x/4))]},ir.invert=function(Ue,Ke){var rt,ut,_t,yt,Ct=Ke,er=25;do Ct-=rt=(Ct*(1.01183+(_t=(ut=Ct*Ct)*ut)*_t*(.01926*ut-.02625-.00396*_t))-Ke)/(1.01183+_t*_t*(.21186*ut-.23625+-.05148*_t));while(y(rt)>1e-12&&--er>0);return[Ue/(.84719-.13063*(ut=Ct*Ct)+(yt=ut*(_t=ut*ut))*yt*(.05494*ut-.04515-.02326*_t+.00331*yt)),Ct]},ar.invert=function(Ue,Ke){for(var rt=Ke/2,ut=0,_t=1/0;ut<10&&y(_t)>i;++ut){var yt=n(Ke/2);Ke-=_t=(Ke-u(Ke/2)-rt)/(1-.5/(yt*yt))}return[2*Ue/(1+n(Ke)),Ke]};var Dr=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]];function Pr(Ue,Ke){var rt=p(Ke),ut=n(Ke),_t=s(Ue);if(Ue===0||y(Ke)===f)return[0,Ke];if(Ke===0)return[Ue,0];if(y(Ue)===f)return[Ue*ut,f*rt];var yt=x/(2*Ue)-2*Ue/x,Ct=2*Ke/x,er=(1-Ct*Ct)/(rt-Ct),rr=yt*yt,Xt=er*er,ur=1+rr/Xt,yr=1+Xt/rr,kr=(yt*rt/er-yt/2)/ur,Sr=(Xt*rt/rr+er/2)/yr,Ur=Sr*Sr-(Xt*rt*rt/rr+er*rt-1)/yr;return[f*(kr+E(kr*kr+ut*ut/ur)*_t),f*(Sr+E(Ur<0?0:Ur)*s(-Ke*yt)*_t)]}Pr.invert=function(Ue,Ke){var rt=(Ue/=f)*Ue,ut=rt+(Ke/=f)*Ke,_t=x*x;return[Ue?(ut-1+E((1-ut)*(1-ut)+4*rt))/(2*Ue)*f:0,te(function(yt){return ut*(x*p(yt)-2*yt)*x+4*yt*yt*(Ke-p(yt))+2*x*yt-_t*Ke},0)]};function Er(Ue,Ke){var rt=Ke*Ke;return[Ue,Ke*(1.0148+rt*rt*(.23185+rt*(.02406*rt-.14499)))]}function Ar(Ue,Ke){if(y(Ke)<i)return[Ue,0];var rt=u(Ke),ut=Ue*p(Ke);return[p(ut)/rt,Ke+(1-n(ut))/rt]}function vr(Ue,Ke){var rt=Mr(Ue[1],Ue[0]),ut=Mr(Ke[1],Ke[0]),_t=function(Ct,er){return t(Ct[0]*er[1]-Ct[1]*er[0],Ct[0]*er[0]+Ct[1]*er[1])}(rt,ut),yt=Lr(rt)/Lr(ut);return wr([1,0,Ue[0][0],0,1,Ue[0][1]],wr([yt,0,0,0,yt,0],wr([n(_t),p(_t),0,-p(_t),n(_t),0],[1,0,-Ke[0][0],0,1,-Ke[0][1]])))}function wr(Ue,Ke){return[Ue[0]*Ke[0]+Ue[1]*Ke[3],Ue[0]*Ke[1]+Ue[1]*Ke[4],Ue[0]*Ke[2]+Ue[1]*Ke[5]+Ue[2],Ue[3]*Ke[0]+Ue[4]*Ke[3],Ue[3]*Ke[1]+Ue[4]*Ke[4],Ue[3]*Ke[2]+Ue[4]*Ke[5]+Ue[5]]}function Mr(Ue,Ke){return[Ue[0]-Ke[0],Ue[1]-Ke[1]]}function Lr(Ue){return E(Ue[0]*Ue[0]+Ue[1]*Ue[1])}function Zr(Ue,Ke,rt){function ut(Ct,er){var rr,Xt=Ke(Ct,er),ur=Xt.project([Ct*A,er*A]);return(rr=Xt.transform)?[rr[0]*ur[0]+rr[1]*ur[1]+rr[2],-(rr[3]*ur[0]+rr[4]*ur[1]+rr[5])]:(ur[1]=-ur[1],ur)}(function Ct(er,rr){if(er.edges=function(Ur){for(var un=Ur.length,xn=[],On=Ur[un-1],Fn=0;Fn<un;++Fn)xn.push([On,On=Ur[Fn]]);return xn}(er.face),rr.face){var Xt=er.shared=function(Ur,un){for(var xn,On,Fn=Ur.length,Yn=null,Bn=0;Bn<Fn;++Bn){xn=Ur[Bn];for(var vi=un.length;--vi>=0;)if(On=un[vi],xn[0]===On[0]&&xn[1]===On[1]){if(Yn)return[Yn,xn];Yn=xn}}}(er.face,rr.face),ur=vr(Xt.map(rr.project),Xt.map(er.project));er.transform=rr.transform?wr(rr.transform,ur):ur;for(var yr=rr.edges,kr=0,Sr=yr.length;kr<Sr;++kr)Yr(Xt[0],yr[kr][1])&&Yr(Xt[1],yr[kr][0])&&(yr[kr]=er),Yr(Xt[0],yr[kr][0])&&Yr(Xt[1],yr[kr][1])&&(yr[kr]=er);for(yr=er.edges,kr=0,Sr=yr.length;kr<Sr;++kr)Yr(Xt[0],yr[kr][0])&&Yr(Xt[1],yr[kr][1])&&(yr[kr]=rr),Yr(Xt[0],yr[kr][1])&&Yr(Xt[1],yr[kr][0])&&(yr[kr]=rr)}else er.transform=rr.transform;return er.children&&er.children.forEach(function(Ur){Ct(Ur,er)}),er})(Ue,{transform:null}),rn(Ue)&&(ut.invert=function(Ct,er){var rr=function Xt(ur,yr){var kr=ur.project.invert,Sr=ur.transform,Ur=yr;if(Sr&&(Sr=function(Yn){var Bn=1/(Yn[0]*Yn[4]-Yn[1]*Yn[3]);return[Bn*Yn[4],-Bn*Yn[1],Bn*(Yn[1]*Yn[5]-Yn[2]*Yn[4]),-Bn*Yn[3],Bn*Yn[0],Bn*(Yn[2]*Yn[3]-Yn[0]*Yn[5])]}(Sr),Ur=[Sr[0]*Ur[0]+Sr[1]*Ur[1]+Sr[2],Sr[3]*Ur[0]+Sr[4]*Ur[1]+Sr[5]]),kr&&ur===function(Yn){return Ke(Yn[0]*I,Yn[1]*I)}(un=kr(Ur)))return un;for(var un,xn=ur.children,On=0,Fn=xn&&xn.length;On<Fn;++On)if(un=Xt(xn[On],yr))return un}(Ue,[Ct,-er]);return rr&&(rr[0]*=I,rr[1]*=I,rr)});var _t=v.geoProjection(ut),yt=_t.stream;return _t.stream=function(Ct){var er=_t.rotate(),rr=yt(Ct),Xt=(_t.rotate([0,0]),yt(Ct));return _t.rotate(er),rr.sphere=function(){Xt.polygonStart(),Xt.lineStart(),function ur(yr,kr,Sr){var Ur,un,xn=kr.edges,On=xn.length,Fn={type:"MultiPoint",coordinates:kr.face},Yn=kr.face.filter(function(Ea){return y(Ea[1])!==90}),Bn=v.geoBounds({type:"MultiPoint",coordinates:Yn}),vi=!1,Si=-1,Ui=Bn[1][0]-Bn[0][0],ji=Ui===180||Ui===360?[(Bn[0][0]+Bn[1][0])/2,(Bn[0][1]+Bn[1][1])/2]:v.geoCentroid(Fn);if(Sr)for(;++Si<On&&xn[Si]!==Sr;);++Si;for(var Vi=0;Vi<On;++Vi)un=xn[(Vi+Si)%On],Array.isArray(un)?(vi||(yr.point((Ur=v.geoInterpolate(un[0],ji)(i))[0],Ur[1]),vi=!0),yr.point((Ur=v.geoInterpolate(un[1],ji)(i))[0],Ur[1])):(vi=!1,un!==Sr&&ur(yr,un,kr))}(Xt,Ue),Xt.lineEnd(),Xt.polygonEnd()},rr},_t.angle(rt==null?-30:rt*A)}function Yr(Ue,Ke){return Ue&&Ke&&Ue[0]===Ke[0]&&Ue[1]===Ke[1]}function rn(Ue){return Ue.project.invert||Ue.children&&Ue.children.some(rn)}Er.invert=function(Ue,Ke){Ke>1.790857183?Ke=1.790857183:Ke<-1.790857183&&(Ke=-1.790857183);var rt,ut=Ke;do{var _t=ut*ut;ut-=rt=(ut*(1.0148+_t*_t*(.23185+_t*(.02406*_t-.14499)))-Ke)/(1.0148+_t*_t*(5*.23185+_t*(.21654*_t-1.01493)))}while(y(rt)>i);return[Ue,ut]},Ar.invert=function(Ue,Ke){if(y(Ke)<i)return[Ue,0];var rt,ut=Ue*Ue+Ke*Ke,_t=.5*Ke,yt=10;do{var Ct=u(_t),er=1/n(_t),rr=ut-2*Ke*_t+_t*_t;_t-=rt=(Ct*rr+2*(_t-Ke))/(2+rr*er*er+2*(_t-Ke)*Ct)}while(y(rt)>i&&--yt>0);return Ct=u(_t),[(y(Ke)<y(_t+1/Ct)?P(Ue*Ct):s(Ke)*s(Ue)*(S(y(Ue*Ct))+f))/p(_t),_t]};var sn=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],yn=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(Ue){return Ue.map(function(Ke){return sn[Ke]})}),kn=2/E(3);function wn(Ue,Ke){var rt=Ie(Ue,Ke);return[rt[0]*kn,rt[1]]}function Pn(Ue,Ke){for(var rt=0,ut=Ue.length,_t=0;rt<ut;++rt)_t+=Ue[rt]*Ke[rt];return _t}function Rn(Ue){return[t(Ue[1],Ue[0])*A,P(c(-1,a(1,Ue[2])))*A]}function Xn(Ue){var Ke=Ue[0]*I,rt=Ue[1]*I,ut=n(rt);return[ut*n(Ke),ut*p(Ke),p(rt)]}function Ai(){}function Mi(Ue,Ke){return{type:"FeatureCollection",features:Ue.features.map(function(rt){return Cn(rt,Ke)})}}function Cn(Ue,Ke){return{type:"Feature",id:Ue.id,properties:Ue.properties,geometry:ti(Ue.geometry,Ke)}}function ti(Ue,Ke){if(!Ue)return null;if(Ue.type==="GeometryCollection")return function(ut,_t){return{type:"GeometryCollection",geometries:ut.geometries.map(function(yt){return ti(yt,_t)})}}(Ue,Ke);var rt;switch(Ue.type){case"Point":case"MultiPoint":rt=va;break;case"LineString":case"MultiLineString":rt=ja;break;case"Polygon":case"MultiPolygon":case"Sphere":rt=vo;break;default:return null}return v.geoStream(Ue,Ke(rt)),rt.result()}wn.invert=function(Ue,Ke){return Ie.invert(Ue/kn,Ke)};var $n=[],Di=[],va={point:function(Ue,Ke){$n.push([Ue,Ke])},result:function(){var Ue=$n.length?$n.length<2?{type:"Point",coordinates:$n[0]}:{type:"MultiPoint",coordinates:$n}:null;return $n=[],Ue}},ja={lineStart:Ai,point:function(Ue,Ke){$n.push([Ue,Ke])},lineEnd:function(){$n.length&&(Di.push($n),$n=[])},result:function(){var Ue=Di.length?Di.length<2?{type:"LineString",coordinates:Di[0]}:{type:"MultiLineString",coordinates:Di}:null;return Di=[],Ue}},vo={polygonStart:Ai,lineStart:Ai,point:function(Ue,Ke){$n.push([Ue,Ke])},lineEnd:function(){var Ue=$n.length;if(Ue){do $n.push($n[0].slice());while(++Ue<4);Di.push($n),$n=[]}},polygonEnd:Ai,result:function(){if(!Di.length)return null;var Ue=[],Ke=[];return Di.forEach(function(rt){(function(ut){if((_t=ut.length)<4)return!1;for(var _t,yt=0,Ct=ut[_t-1][1]*ut[0][0]-ut[_t-1][0]*ut[0][1];++yt<_t;)Ct+=ut[yt-1][1]*ut[yt][0]-ut[yt-1][0]*ut[yt][1];return Ct<=0})(rt)?Ue.push([rt]):Ke.push(rt)}),Ke.forEach(function(rt){var ut=rt[0];Ue.some(function(_t){if(function(yt,Ct){for(var er=Ct[0],rr=Ct[1],Xt=!1,ur=0,yr=yt.length,kr=yr-1;ur<yr;kr=ur++){var Sr=yt[ur],Ur=Sr[0],un=Sr[1],xn=yt[kr],On=xn[0],Fn=xn[1];un>rr^Fn>rr&&er<(On-Ur)*(rr-un)/(Fn-un)+Ur&&(Xt=!Xt)}return Xt}(_t[0],ut))return _t.push(rt),!0})||Ue.push([rt])}),Di=[],Ue.length?Ue.length>1?{type:"MultiPolygon",coordinates:Ue}:{type:"Polygon",coordinates:Ue[0]}:null}};function Wi(Ue){var Ke=Ue(f,0)[0]-Ue(-f,0)[0];function rt(ut,_t){var yt=y(ut)<f,Ct=Ue(yt?ut:ut>0?ut-x:ut+x,_t),er=(Ct[0]-Ct[1])*b,rr=(Ct[0]+Ct[1])*b;if(yt)return[er,rr];var Xt=Ke*b,ur=er>0^rr>0?-1:1;return[ur*er-s(rr)*Xt,ur*rr-s(er)*Xt]}return Ue.invert&&(rt.invert=function(ut,_t){var yt=(ut+_t)*b,Ct=(_t-ut)*b,er=y(yt)<.5*Ke&&y(Ct)<.5*Ke;if(!er){var rr=Ke*b,Xt=yt>0^Ct>0?-1:1,ur=-Xt*ut+(Ct>0?1:-1)*rr,yr=-Xt*_t+(yt>0?1:-1)*rr;yt=(-ur-yr)*b,Ct=(ur-yr)*b}var kr=Ue.invert(yt,Ct);return er||(kr[0]+=yt>0?x:-x),kr}),v.geoProjection(rt).rotate([-90,-90,45]).clipAngle(179.999)}function Zi(){return Wi(Ot).scale(111.48)}function no(Ue){var Ke=p(Ue);function rt(ut,_t){var yt=Ke?u(ut*Ke/2)/Ke:ut/2;if(!_t)return[2*yt,-Ue];var Ct=2*e(yt*p(_t)),er=1/u(_t);return[p(Ct)*er,_t+(1-n(Ct))*er-Ue]}return rt.invert=function(ut,_t){if(y(_t+=Ue)<i)return[Ke?2*e(Ke*ut/2)/Ke:ut,0];var yt,Ct=ut*ut+_t*_t,er=0,rr=10;do{var Xt=u(er),ur=1/n(er),yr=Ct-2*_t*er+er*er;er-=yt=(Xt*yr+2*(er-_t))/(2+yr*ur*ur+2*(er-_t)*Xt)}while(y(yt)>i&&--rr>0);var kr=ut*(Xt=u(er)),Sr=u(y(_t)<y(er+1/Xt)?.5*P(kr):.5*S(kr)+x/4)/p(er);return[Ke?2*e(Ke*Sr)/Ke:2*Sr,er]},rt}var Ni=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];function yo(Ue,Ke){var rt,ut=a(18,36*y(Ke)/x),_t=r(ut),yt=ut-_t,Ct=(rt=Ni[_t])[0],er=rt[1],rr=(rt=Ni[++_t])[0],Xt=rt[1],ur=(rt=Ni[a(19,++_t)])[0],yr=rt[1];return[Ue*(rr+yt*(ur-Ct)/2+yt*yt*(ur-2*rr+Ct)/2),(Ke>0?f:-f)*(Xt+yt*(yr-er)/2+yt*yt*(yr-2*Xt+er)/2)]}function wo(Ue,Ke){var rt=function(Ct){function er(rr,Xt){var ur=n(Xt),yr=(Ct-1)/(Ct-ur*n(rr));return[yr*ur*p(rr),yr*p(Xt)]}return er.invert=function(rr,Xt){var ur=rr*rr+Xt*Xt,yr=E(ur),kr=(Ct-E(1-ur*(Ct+1)/(Ct-1)))/((Ct-1)/yr+yr/(Ct-1));return[t(rr*kr,yr*E(1-kr*kr)),yr?P(Xt*kr/yr):0]},er}(Ue);if(!Ke)return rt;var ut=n(Ke),_t=p(Ke);function yt(Ct,er){var rr=rt(Ct,er),Xt=rr[1],ur=Xt*_t/(Ue-1)+ut;return[rr[0]*ut/ur,Xt/ur]}return yt.invert=function(Ct,er){var rr=(Ue-1)/(Ue-1-er*_t);return rt.invert(rr*Ct,rr*er*ut)},yt}Ni.forEach(function(Ue){Ue[1]*=1.0144}),yo.invert=function(Ue,Ke){var rt=Ke/f,ut=90*rt,_t=a(18,y(ut/5)),yt=c(0,r(_t));do{var Ct=Ni[yt][1],er=Ni[yt+1][1],rr=Ni[a(19,yt+2)][1],Xt=rr-Ct,ur=rr-2*er+Ct,yr=2*(y(rt)-er)/Xt,kr=ur/Xt,Sr=yr*(1-kr*yr*(1-2*kr*yr));if(Sr>=0||yt===1){ut=(Ke>=0?5:-5)*(Sr+_t);var Ur,un=50;do Sr=(_t=a(18,y(ut)/5))-(yt=r(_t)),Ct=Ni[yt][1],er=Ni[yt+1][1],rr=Ni[a(19,yt+2)][1],ut-=(Ur=(Ke>=0?f:-f)*(er+Sr*(rr-Ct)/2+Sr*Sr*(rr-2*er+Ct)/2)-Ke)*A;while(y(Ur)>1e-12&&--un>0);break}}while(--yt>=0);var xn=Ni[yt][0],On=Ni[yt+1][0],Fn=Ni[a(19,yt+2)][0];return[Ue/(On+Sr*(Fn-xn)/2+Sr*Sr*(Fn-2*On+xn)/2),ut*I]};var Sa=-179.9999,io=179.9999,To=-89.9999;function Io(Ue){return Ue.length>0}function qa(Ue){return Ue===-90||Ue===90?[0,Ue]:[-180,(Ke=Ue,Math.floor(1e4*Ke)/1e4)];var Ke}function ya(Ue){var Ke=Ue[0],rt=Ue[1],ut=!1;return Ke<=Sa?(Ke=-180,ut=!0):Ke>=io&&(Ke=180,ut=!0),rt<=To?(rt=-90,ut=!0):rt>=89.9999&&(rt=90,ut=!0),ut?[Ke,rt]:Ue}function to(Ue){return Ue.map(ya)}function Ds(Ue,Ke,rt){for(var ut=0,_t=Ue.length;ut<_t;++ut){var yt=Ue[ut].slice();rt.push({index:-1,polygon:Ke,ring:yt});for(var Ct=0,er=yt.length;Ct<er;++Ct){var rr=yt[Ct],Xt=rr[0],ur=rr[1];if(Xt<=Sa||Xt>=io||ur<=To||ur>=89.9999){yt[Ct]=ya(rr);for(var yr=Ct+1;yr<er;++yr){var kr=yt[yr],Sr=kr[0],Ur=kr[1];if(Sr>Sa&&Sr<io&&Ur>To&&Ur<89.9999)break}if(yr===Ct+1)continue;if(Ct){var un={index:-1,polygon:Ke,ring:yt.slice(0,Ct+1)};un.ring[un.ring.length-1]=qa(ur),rt[rt.length-1]=un}else rt.pop();if(yr>=er)break;rt.push({index:-1,polygon:Ke,ring:yt=yt.slice(yr-1)}),yt[0]=qa(yt[0][1]),Ct=-1,er=yt.length}}}}function js(Ue){var Ke,rt,ut,_t,yt,Ct,er=Ue.length,rr={},Xt={};for(Ke=0;Ke<er;++Ke)ut=(rt=Ue[Ke]).ring[0],yt=rt.ring[rt.ring.length-1],ut[0]!==yt[0]||ut[1]!==yt[1]?(rt.index=Ke,rr[ut]=Xt[yt]=rt):(rt.polygon.push(rt.ring),Ue[Ke]=null);for(Ke=0;Ke<er;++Ke)if(rt=Ue[Ke]){if(ut=rt.ring[0],yt=rt.ring[rt.ring.length-1],_t=Xt[ut],Ct=rr[yt],delete rr[ut],delete Xt[yt],ut[0]===yt[0]&&ut[1]===yt[1]){rt.polygon.push(rt.ring);continue}_t?(delete Xt[ut],delete rr[_t.ring[0]],_t.ring.pop(),Ue[_t.index]=null,rt={index:-1,polygon:_t.polygon,ring:_t.ring.concat(rt.ring)},_t===Ct?rt.polygon.push(rt.ring):(rt.index=er++,Ue.push(rr[rt.ring[0]]=Xt[rt.ring[rt.ring.length-1]]=rt))):Ct?(delete rr[yt],delete Xt[Ct.ring[Ct.ring.length-1]],rt.ring.pop(),rt={index:er++,polygon:Ct.polygon,ring:rt.ring.concat(Ct.ring)},Ue[Ct.index]=null,Ue.push(rr[rt.ring[0]]=Xt[rt.ring[rt.ring.length-1]]=rt)):(rt.ring.push(rt.ring[0]),rt.polygon.push(rt.ring))}}function Xi(Ue){var Ke={type:"Feature",geometry:As(Ue.geometry)};return Ue.id!=null&&(Ke.id=Ue.id),Ue.bbox!=null&&(Ke.bbox=Ue.bbox),Ue.properties!=null&&(Ke.properties=Ue.properties),Ke}function As(Ue){if(Ue==null)return Ue;var Ke,rt,ut,_t;switch(Ue.type){case"GeometryCollection":Ke={type:"GeometryCollection",geometries:Ue.geometries.map(As)};break;case"Point":Ke={type:"Point",coordinates:ya(Ue.coordinates)};break;case"MultiPoint":case"LineString":Ke={type:Ue.type,coordinates:to(Ue.coordinates)};break;case"MultiLineString":Ke={type:"MultiLineString",coordinates:Ue.coordinates.map(to)};break;case"Polygon":var yt=[];Ds(Ue.coordinates,yt,rt=[]),js(rt),Ke={type:"Polygon",coordinates:yt};break;case"MultiPolygon":rt=[],ut=-1,_t=Ue.coordinates.length;for(var Ct=new Array(_t);++ut<_t;)Ds(Ue.coordinates[ut],Ct[ut]=[],rt);js(rt),Ke={type:"MultiPolygon",coordinates:Ct.filter(Io)};break;default:return Ue}return Ue.bbox!=null&&(Ke.bbox=Ue.bbox),Ke}function fs(Ue,Ke){var rt=u(Ke/2),ut=p(_*rt);return[Ue*(.74482-.34588*ut*ut),1.70711*rt]}function Us(Ue,Ke,rt){var ut=v.geoInterpolate(Ke,rt),_t=ut(.5),yt=v.geoRotation([-_t[0],-_t[1]])(Ke),Ct=ut.distance/2,er=-P(p(yt[1]*I)/p(Ct)),rr=[-_t[0],-_t[1],-(yt[0]>0?x-er:er)*A],Xt=v.geoProjection(Ue(Ct)).rotate(rr),ur=v.geoRotation(rr),yr=Xt.center;return delete Xt.rotate,Xt.center=function(kr){return arguments.length?yr(ur(kr)):ur.invert(yr())},Xt.clipAngle(90)}function Vs(Ue){var Ke=n(Ue);function rt(ut,_t){var yt=v.geoGnomonicRaw(ut,_t);return yt[0]*=Ke,yt}return rt.invert=function(ut,_t){return v.geoGnomonicRaw.invert(ut/Ke,_t)},rt}function zs(Ue,Ke){return Us(Vs,Ue,Ke)}function Hs(Ue){if(!(Ue*=2))return v.geoAzimuthalEquidistantRaw;var Ke=-Ue/2,rt=-Ke,ut=Ue*Ue,_t=u(rt),yt=.5/p(rt);function Ct(er,rr){var Xt=S(n(rr)*n(er-Ke)),ur=S(n(rr)*n(er-rt));return[((Xt*=Xt)-(ur*=ur))/(2*Ue),(rr<0?-1:1)*E(4*ut*ur-(ut-Xt+ur)*(ut-Xt+ur))/(2*Ue)]}return Ct.invert=function(er,rr){var Xt,ur,yr=rr*rr,kr=n(E(yr+(Xt=er+Ke)*Xt)),Sr=n(E(yr+(Xt=er+rt)*Xt));return[t(ur=kr-Sr,Xt=(kr+Sr)*_t),(rr<0?-1:1)*S(E(Xt*Xt+ur*ur)*yt)]},Ct}function Ro(Ue,Ke){return Us(Hs,Ue,Ke)}function Fo(Ue,Ke){if(y(Ke)<i)return[Ue,0];var rt=y(Ke/f),ut=P(rt);if(y(Ue)<i||y(y(Ke)-f)<i)return[0,s(Ke)*x*u(ut/2)];var _t=n(ut),yt=y(x/Ue-Ue/x)/2,Ct=yt*yt,er=_t/(rt+_t-1),rr=er*(2/rt-1),Xt=rr*rr,ur=Xt+Ct,yr=er-Xt,kr=Ct+er;return[s(Ue)*x*(yt*yr+E(Ct*yr*yr-ur*(er*er-Xt)))/ur,s(Ke)*x*(rr*kr-yt*E((Ct+1)*ur-kr*kr))/ur]}function Xo(Ue,Ke){if(y(Ke)<i)return[Ue,0];var rt=y(Ke/f),ut=P(rt);if(y(Ue)<i||y(y(Ke)-f)<i)return[0,s(Ke)*x*u(ut/2)];var _t=n(ut),yt=y(x/Ue-Ue/x)/2,Ct=yt*yt,er=_t*(E(1+Ct)-yt*_t)/(1+Ct*rt*rt);return[s(Ue)*x*er,s(Ke)*x*E(1-er*(2*yt+er))]}function Ko(Ue,Ke){if(y(Ke)<i)return[Ue,0];var rt=Ke/f,ut=P(rt);if(y(Ue)<i||y(y(Ke)-f)<i)return[0,x*u(ut/2)];var _t=(x/Ue-Ue/x)/2,yt=rt/(1+n(ut));return[x*(s(Ue)*E(_t*_t+1-yt*yt)-_t),x*yt]}function Jo(Ue,Ke){if(!Ke)return[Ue,0];var rt=y(Ke);if(!Ue||rt===f)return[0,Ke];var ut=rt/f,_t=ut*ut,yt=(8*ut-_t*(_t+2)-5)/(2*_t*(ut-1)),Ct=yt*yt,er=ut*yt,rr=_t+Ct+2*er,Xt=ut+3*yt,ur=Ue/f,yr=ur+1/ur,kr=s(y(Ue)-f)*E(yr*yr-4),Sr=kr*kr,Ur=(kr*(rr+Ct-1)+2*E(rr*(_t+Ct*Sr-1)+(1-_t)*(_t*(Xt*Xt+4*Ct)+12*er*Ct+4*Ct*Ct)))/(4*rr+Sr);return[s(Ue)*f*Ur,s(Ke)*f*E(1+kr*y(Ur)-Ur*Ur)]}function hs(Ue,Ke,rt,ut){var _t=x/3;Ue=c(Ue,i),Ke=c(Ke,i),Ue=a(Ue,f),Ke=a(Ke,x-i),rt=c(rt,0),rt=a(rt,100-i);var yt=(ut=c(ut,i))/100,Ct=S((rt/100+1)*n(_t))/_t,er=p(Ue)/p(Ct*f),rr=Ke/x,Xt=E(yt*p(Ue/2)/p(Ke/2));return function(ur,yr,kr,Sr,Ur){function un(xn,On){var Fn=kr*p(Sr*On),Yn=E(1-Fn*Fn),Bn=E(2/(1+Yn*n(xn*=Ur)));return[ur*Yn*Bn*p(xn),yr*Fn*Bn]}return un.invert=function(xn,On){var Fn=xn/ur,Yn=On/yr,Bn=E(Fn*Fn+Yn*Yn),vi=2*P(Bn/2);return[t(xn*u(vi),ur*Bn)/Ur,Bn&&P(On*p(vi)/(yr*kr*Bn))/Sr]},un}(Xt/E(rr*er*Ct),1/(Xt*E(rr*er*Ct)),er,Ct,rr)}function ko(){var Ue=65*I,Ke=60*I,rt=20,ut=200,_t=v.geoProjectionMutator(hs),yt=_t(Ue,Ke,rt,ut);return yt.poleline=function(Ct){return arguments.length?_t(Ue=+Ct*I,Ke,rt,ut):Ue*A},yt.parallels=function(Ct){return arguments.length?_t(Ue,Ke=+Ct*I,rt,ut):Ke*A},yt.inflation=function(Ct){return arguments.length?_t(Ue,Ke,rt=+Ct,ut):rt},yt.ratio=function(Ct){return arguments.length?_t(Ue,Ke,rt,ut=+Ct):ut},yt.scale(163.775)}fs.invert=function(Ue,Ke){var rt=Ke/1.70711,ut=p(_*rt);return[Ue/(.74482-.34588*ut*ut),2*e(rt)]},Fo.invert=function(Ue,Ke){if(y(Ke)<i)return[Ue,0];if(y(Ue)<i)return[0,f*p(2*e(Ke/x))];var rt=(Ue/=x)*Ue,ut=(Ke/=x)*Ke,_t=rt+ut,yt=_t*_t,Ct=-y(Ke)*(1+_t),er=Ct-2*ut+rt,rr=-2*Ct+1+2*ut+yt,Xt=ut/rr+(2*er*er*er/(rr*rr*rr)-9*Ct*er/(rr*rr))/27,ur=(Ct-er*er/(3*rr))/rr,yr=2*E(-ur/3),kr=S(3*Xt/(ur*yr))/3;return[x*(_t-1+E(1+2*(rt-ut)+yt))/(2*Ue),s(Ke)*x*(-yr*n(kr+x/3)-er/(3*rr))]},Xo.invert=function(Ue,Ke){if(!Ue)return[0,f*p(2*e(Ke/x))];var rt=y(Ue/x),ut=(1-rt*rt-(Ke/=x)*Ke)/(2*rt),_t=E(ut*ut+1);return[s(Ue)*x*(_t-ut),s(Ke)*f*p(2*t(E((1-2*ut*rt)*(ut+_t)-rt),E(_t+ut+rt)))]},Ko.invert=function(Ue,Ke){if(!Ke)return[Ue,0];var rt=Ke/x,ut=(x*x*(1-rt*rt)-Ue*Ue)/(2*x*Ue);return[Ue?x*(s(Ue)*E(ut*ut+1)-ut):0,f*p(2*e(rt))]},Jo.invert=function(Ue,Ke){var rt;if(!Ue||!Ke)return[Ue,Ke];Ke/=x;var ut=s(Ue)*Ue/f,_t=(ut*ut-1+4*Ke*Ke)/y(ut),yt=_t*_t,Ct=2*Ke,er=50;do{var rr=Ct*Ct,Xt=(8*Ct-rr*(rr+2)-5)/(2*rr*(Ct-1)),ur=(3*Ct-rr*Ct-10)/(2*rr*Ct),yr=Xt*Xt,kr=Ct*Xt,Sr=Ct+Xt,Ur=Sr*Sr,un=Ct+3*Xt,xn=-2*Sr*(4*kr*yr+(1-4*rr+3*rr*rr)*(1+ur)+yr*(14*rr-6-yt+(8*rr-8-2*yt)*ur)+kr*(12*rr-8+(10*rr-10-yt)*ur)),On=E(Ur*(rr+yr*yt-1)+(1-rr)*(rr*(un*un+4*yr)+yr*(12*kr+4*yr)));Ct-=rt=(_t*(Ur+yr-1)+2*On-ut*(4*Ur+yt))/(_t*(2*Xt*ur+2*Sr*(1+ur))+xn/On-8*Sr*(_t*(-1+yr+Ur)+2*On)*(1+ur)/(yt+4*Ur))}while(rt>i&&--er>0);return[s(Ue)*(E(_t*_t+4)+_t)*x/4,f*Ct]};var Ss=4*x+3*E(3),xo=2*E(2*x*E(3)/Ss),$o=ee(xo*E(3)/x,xo,Ss/6);function Es(Ue,Ke){return[Ue*E(1-3*Ke*Ke/(x*x)),Ke]}function Bo(Ue,Ke){var rt=n(Ke),ut=n(Ue)*rt,_t=1-ut,yt=n(Ue=t(p(Ue)*rt,-p(Ke))),Ct=p(Ue);return[Ct*(rt=E(1-ut*ut))-yt*_t,-yt*rt-Ct*_t]}function Gi(Ue,Ke){var rt=V(Ue,Ke);return[(rt[0]+Ue/f)/2,(rt[1]+Ke)/2]}Es.invert=function(Ue,Ke){return[Ue/E(1-3*Ke*Ke/(x*x)),Ke]},Bo.invert=function(Ue,Ke){var rt=(Ue*Ue+Ke*Ke)/-2,ut=E(-rt*(2+rt)),_t=Ke*rt+Ue*ut,yt=Ue*rt-Ke*ut,Ct=E(yt*yt+_t*_t);return[t(ut*_t,Ct*(1+rt)),Ct?-P(ut*yt/Ct):0]},Gi.invert=function(Ue,Ke){var rt=Ue,ut=Ke,_t=25;do{var yt,Ct=n(ut),er=p(ut),rr=p(2*ut),Xt=er*er,ur=Ct*Ct,yr=p(rt),kr=n(rt/2),Sr=p(rt/2),Ur=Sr*Sr,un=1-ur*kr*kr,xn=un?S(Ct*kr)*E(yt=1/un):yt=0,On=.5*(2*xn*Ct*Sr+rt/f)-Ue,Fn=.5*(xn*er+ut)-Ke,Yn=.5*yt*(ur*Ur+xn*Ct*kr*Xt)+.5/f,Bn=yt*(yr*rr/4-xn*er*Sr),vi=.125*yt*(rr*Sr-xn*er*ur*yr),Si=.5*yt*(Xt*kr+xn*Ur*Ct)+.5,Ui=Bn*vi-Si*Yn,ji=(Fn*Bn-On*Si)/Ui,Vi=(On*vi-Fn*Yn)/Ui;rt-=ji,ut-=Vi}while((y(ji)>i||y(Vi)>i)&&--_t>0);return[rt,ut]},d.geoNaturalEarth=v.geoNaturalEarth1,d.geoNaturalEarthRaw=v.geoNaturalEarth1Raw,d.geoAiry=function(){var Ue=f,Ke=v.geoProjectionMutator(j),rt=Ke(Ue);return rt.radius=function(ut){return arguments.length?Ke(Ue=ut*I):Ue*A},rt.scale(179.976).clipAngle(147)},d.geoAiryRaw=j,d.geoAitoff=function(){return v.geoProjection(V).scale(152.63)},d.geoAitoffRaw=V,d.geoArmadillo=function(){var Ue=20*I,Ke=Ue>=0?1:-1,rt=u(Ke*Ue),ut=v.geoProjectionMutator(Z),_t=ut(Ue),yt=_t.stream;return _t.parallel=function(Ct){return arguments.length?(rt=u((Ke=(Ue=Ct*I)>=0?1:-1)*Ue),ut(Ue)):Ue*A},_t.stream=function(Ct){var er=_t.rotate(),rr=yt(Ct),Xt=(_t.rotate([0,0]),yt(Ct)),ur=_t.precision();return _t.rotate(er),rr.sphere=function(){Xt.polygonStart(),Xt.lineStart();for(var yr=-180*Ke;Ke*yr<180;yr+=90*Ke)Xt.point(yr,90*Ke);if(Ue)for(;Ke*(yr-=3*Ke*ur)>=-180;)Xt.point(yr,Ke*-t(n(yr*I/2),rt)*A);Xt.lineEnd(),Xt.polygonEnd()},rr},_t.scale(218.695).center([0,28.0974])},d.geoArmadilloRaw=Z,d.geoAugust=function(){return v.geoProjection(Q).scale(66.1603)},d.geoAugustRaw=Q,d.geoBaker=function(){return v.geoProjection(re).scale(112.314)},d.geoBakerRaw=re,d.geoBerghaus=function(){var Ue=5,Ke=v.geoProjectionMutator(H),rt=Ke(Ue),ut=rt.stream,_t=-n(.01*I),yt=p(.01*I);return rt.lobes=function(Ct){return arguments.length?Ke(Ue=+Ct):Ue},rt.stream=function(Ct){var er=rt.rotate(),rr=ut(Ct),Xt=(rt.rotate([0,0]),ut(Ct));return rt.rotate(er),rr.sphere=function(){Xt.polygonStart(),Xt.lineStart();for(var ur=0,yr=360/Ue,kr=2*x/Ue,Sr=90-180/Ue,Ur=f;ur<Ue;++ur,Sr-=yr,Ur-=kr)Xt.point(t(yt*n(Ur),_t)*A,P(yt*p(Ur))*A),Sr<-90?(Xt.point(-90,-180-Sr-.01),Xt.point(-90,-180-Sr+.01)):(Xt.point(90,Sr+.01),Xt.point(90,Sr-.01));Xt.lineEnd(),Xt.polygonEnd()},rr},rt.scale(87.8076).center([0,17.1875]).clipAngle(179.999)},d.geoBerghausRaw=H,d.geoBertin1953=function(){return v.geoProjection(K()).rotate([-16.5,-42]).scale(176.57).center([7.93,.09])},d.geoBertin1953Raw=K,d.geoBoggs=function(){return v.geoProjection(me).scale(160.857)},d.geoBoggsRaw=me,d.geoBonne=function(){return ce(Se).scale(123.082).center([0,26.1441]).parallel(45)},d.geoBonneRaw=Se,d.geoBottomley=function(){var Ue=.5,Ke=v.geoProjectionMutator(fe),rt=Ke(Ue);return rt.fraction=function(ut){return arguments.length?Ke(Ue=+ut):Ue},rt.scale(158.837)},d.geoBottomleyRaw=fe,d.geoBromley=function(){return v.geoProjection(ge).scale(152.63)},d.geoBromleyRaw=ge,d.geoChamberlin=de,d.geoChamberlinRaw=Me,d.geoChamberlinAfrica=function(){return de([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])},d.geoCollignon=function(){return v.geoProjection(Ie).scale(95.6464).center([0,30])},d.geoCollignonRaw=Ie,d.geoCraig=function(){return ce(De).scale(249.828).clipAngle(90)},d.geoCraigRaw=De,d.geoCraster=function(){return v.geoProjection(Ve).scale(156.19)},d.geoCrasterRaw=Ve,d.geoCylindricalEqualArea=function(){return ce(Fe).parallel(38.58).scale(195.044)},d.geoCylindricalEqualAreaRaw=Fe,d.geoCylindricalStereographic=function(){return ce(ze).scale(124.75)},d.geoCylindricalStereographicRaw=ze,d.geoEckert1=function(){return v.geoProjection(Re).scale(165.664)},d.geoEckert1Raw=Re,d.geoEckert2=function(){return v.geoProjection(We).scale(165.664)},d.geoEckert2Raw=We,d.geoEckert3=function(){return v.geoProjection($e).scale(180.739)},d.geoEckert3Raw=$e,d.geoEckert4=function(){return v.geoProjection(at).scale(180.739)},d.geoEckert4Raw=at,d.geoEckert5=function(){return v.geoProjection(gt).scale(173.044)},d.geoEckert5Raw=gt,d.geoEckert6=function(){return v.geoProjection(xt).scale(173.044)},d.geoEckert6Raw=xt,d.geoEisenlohr=function(){return v.geoProjection(nt).scale(62.5271)},d.geoEisenlohrRaw=nt,d.geoFahey=function(){return v.geoProjection(vt).scale(137.152)},d.geoFaheyRaw=vt,d.geoFoucaut=function(){return v.geoProjection(jt).scale(135.264)},d.geoFoucautRaw=jt,d.geoFoucautSinusoidal=function(){var Ue=.5,Ke=v.geoProjectionMutator(Gt),rt=Ke(Ue);return rt.alpha=function(ut){return arguments.length?Ke(Ue=+ut):Ue},rt.scale(168.725)},d.geoFoucautSinusoidalRaw=Gt,d.geoGilbert=function(Ue){Ue==null&&(Ue=v.geoOrthographic);var Ke=Ue(),rt=v.geoEquirectangular().scale(A).precision(0).clipAngle(null).translate([0,0]);function ut(yt){return Ke($t(yt))}function _t(yt){ut[yt]=function(){return arguments.length?(Ke[yt].apply(Ke,arguments),ut):Ke[yt]()}}return Ke.invert&&(ut.invert=function(yt){return Zt(Ke.invert(yt))}),ut.stream=function(yt){var Ct=Ke.stream(yt),er=rt.stream({point:function(rr,Xt){Ct.point(rr/2,P(u(-Xt/2*I))*A)},lineStart:function(){Ct.lineStart()},lineEnd:function(){Ct.lineEnd()},polygonStart:function(){Ct.polygonStart()},polygonEnd:function(){Ct.polygonEnd()}});return er.sphere=Ct.sphere,er},ut.rotate=function(yt){return arguments.length?(rt.rotate(yt),ut):rt.rotate()},ut.center=function(yt){return arguments.length?(Ke.center($t(yt)),ut):Zt(Ke.center())},_t("angle"),_t("clipAngle"),_t("clipExtent"),_t("fitExtent"),_t("fitHeight"),_t("fitSize"),_t("fitWidth"),_t("scale"),_t("translate"),_t("precision"),ut.scale(249.5)},d.geoGingery=function(){var Ue=6,Ke=30*I,rt=n(Ke),ut=p(Ke),_t=v.geoProjectionMutator(cr),yt=_t(Ke,Ue),Ct=yt.stream,er=-n(.01*I),rr=p(.01*I);return yt.radius=function(Xt){return arguments.length?(rt=n(Ke=Xt*I),ut=p(Ke),_t(Ke,Ue)):Ke*A},yt.lobes=function(Xt){return arguments.length?_t(Ke,Ue=+Xt):Ue},yt.stream=function(Xt){var ur=yt.rotate(),yr=Ct(Xt),kr=(yt.rotate([0,0]),Ct(Xt));return yt.rotate(ur),yr.sphere=function(){kr.polygonStart(),kr.lineStart();for(var Sr=0,Ur=2*x/Ue,un=0;Sr<Ue;++Sr,un-=Ur)kr.point(t(rr*n(un),er)*A,P(rr*p(un))*A),kr.point(t(ut*n(un-Ur/2),rt)*A,P(ut*p(un-Ur/2))*A);kr.lineEnd(),kr.polygonEnd()},yr},yt.rotate([90,-40]).scale(91.7095).clipAngle(179.999)},d.geoGingeryRaw=cr,d.geoGinzburg4=function(){return v.geoProjection(pe).scale(149.995)},d.geoGinzburg4Raw=pe,d.geoGinzburg5=function(){return v.geoProjection(_e).scale(153.93)},d.geoGinzburg5Raw=_e,d.geoGinzburg6=function(){return v.geoProjection(Be).scale(130.945)},d.geoGinzburg6Raw=Be,d.geoGinzburg8=function(){return v.geoProjection(He).scale(131.747)},d.geoGinzburg8Raw=He,d.geoGinzburg9=function(){return v.geoProjection(Je).scale(131.087)},d.geoGinzburg9Raw=Je,d.geoGringorten=function(){return v.geoProjection(Ze(ct)).scale(239.75)},d.geoGringortenRaw=ct,d.geoGuyou=function(){return v.geoProjection(Ze(Ot)).scale(151.496)},d.geoGuyouRaw=Ot,d.geoHammer=function(){var Ue=2,Ke=v.geoProjectionMutator(N),rt=Ke(Ue);return rt.coefficient=function(ut){return arguments.length?Ke(Ue=+ut):Ue},rt.scale(169.529)},d.geoHammerRaw=N,d.geoHammerRetroazimuthal=function(){var Ue=0,Ke=v.geoProjectionMutator(it),rt=Ke(Ue),ut=rt.rotate,_t=rt.stream,yt=v.geoCircle();return rt.parallel=function(Ct){if(!arguments.length)return Ue*A;var er=rt.rotate();return Ke(Ue=Ct*I).rotate(er)},rt.rotate=function(Ct){return arguments.length?(ut.call(rt,[Ct[0],Ct[1]-Ue*A]),yt.center([-Ct[0],-Ct[1]]),rt):((Ct=ut.call(rt))[1]+=Ue*A,Ct)},rt.stream=function(Ct){return(Ct=_t(Ct)).sphere=function(){Ct.polygonStart();var er,rr=yt.radius(89.99)().coordinates[0],Xt=rr.length-1,ur=-1;for(Ct.lineStart();++ur<Xt;)Ct.point((er=rr[ur])[0],er[1]);for(Ct.lineEnd(),Xt=(rr=yt.radius(90.01)().coordinates[0]).length-1,Ct.lineStart();--ur>=0;)Ct.point((er=rr[ur])[0],er[1]);Ct.lineEnd(),Ct.polygonEnd()},Ct},rt.scale(79.4187).parallel(45).clipAngle(179.999)},d.geoHammerRetroazimuthalRaw=it,d.geoHealpix=function(){var Ue=4,Ke=v.geoProjectionMutator(It),rt=Ke(Ue),ut=rt.stream;return rt.lobes=function(_t){return arguments.length?Ke(Ue=+_t):Ue},rt.stream=function(_t){var yt=rt.rotate(),Ct=ut(_t),er=(rt.rotate([0,0]),ut(_t));return rt.rotate(yt),Ct.sphere=function(){var rr,Xt;v.geoStream((rr=180/Ue,Xt=[].concat(w.range(-180,180+rr/2,rr).map(Le),w.range(180,-180-rr/2,-rr).map(Xe)),{type:"Polygon",coordinates:[rr===180?Xt.map(ot):Xt]}),er)},Ct},rt.scale(239.75)},d.geoHealpixRaw=It,d.geoHill=function(){var Ue=1,Ke=v.geoProjectionMutator(pt),rt=Ke(Ue);return rt.ratio=function(ut){return arguments.length?Ke(Ue=+ut):Ue},rt.scale(167.774).center([0,18.67])},d.geoHillRaw=pt,d.geoHomolosine=function(){return v.geoProjection(Vt).scale(152.63)},d.geoHomolosineRaw=Vt,d.geoHufnagel=function(){var Ue=1,Ke=0,rt=45*I,ut=2,_t=v.geoProjectionMutator(Jt),yt=_t(Ue,Ke,rt,ut);return yt.a=function(Ct){return arguments.length?_t(Ue=+Ct,Ke,rt,ut):Ue},yt.b=function(Ct){return arguments.length?_t(Ue,Ke=+Ct,rt,ut):Ke},yt.psiMax=function(Ct){return arguments.length?_t(Ue,Ke,rt=+Ct*I,ut):rt*A},yt.ratio=function(Ct){return arguments.length?_t(Ue,Ke,rt,ut=+Ct):ut},yt.scale(180.739)},d.geoHufnagelRaw=Jt,d.geoHyperelliptical=function(){var Ue=0,Ke=2.5,rt=1.183136,ut=v.geoProjectionMutator(gr),_t=ut(Ue,Ke,rt);return _t.alpha=function(yt){return arguments.length?ut(Ue=+yt,Ke,rt):Ue},_t.k=function(yt){return arguments.length?ut(Ue,Ke=+yt,rt):Ke},_t.gamma=function(yt){return arguments.length?ut(Ue,Ke,rt=+yt):rt},_t.scale(152.63)},d.geoHyperellipticalRaw=gr,d.geoInterrupt=nr,d.geoInterruptedBoggs=function(){return nr(me,Qt).scale(160.857)},d.geoInterruptedHomolosine=function(){return nr(Vt,dr).scale(152.63)},d.geoInterruptedMollweide=function(){return nr(ne,_r).scale(169.529)},d.geoInterruptedMollweideHemispheres=function(){return nr(ne,Ir).scale(169.529).rotate([20,0])},d.geoInterruptedSinuMollweide=function(){return nr(St,Rr,B).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},d.geoInterruptedSinusoidal=function(){return nr(ye,Vr).scale(152.63).rotate([-20,0])},d.geoKavrayskiy7=function(){return v.geoProjection(Xr).scale(158.837)},d.geoKavrayskiy7Raw=Xr,d.geoLagrange=function(){var Ue=.5,Ke=v.geoProjectionMutator(cn),rt=Ke(Ue);return rt.spacing=function(ut){return arguments.length?Ke(Ue=+ut):Ue},rt.scale(124.75)},d.geoLagrangeRaw=cn,d.geoLarrivee=function(){return v.geoProjection(zn).scale(97.2672)},d.geoLarriveeRaw=zn,d.geoLaskowski=function(){return v.geoProjection(on).scale(139.98)},d.geoLaskowskiRaw=on,d.geoLittrow=function(){return v.geoProjection(Tn).scale(144.049).clipAngle(89.999)},d.geoLittrowRaw=Tn,d.geoLoximuthal=function(){return ce(Mn).parallel(40).scale(158.837)},d.geoLoximuthalRaw=Mn,d.geoMiller=function(){return v.geoProjection(ei).scale(108.318)},d.geoMillerRaw=ei,d.geoModifiedStereographic=sr,d.geoModifiedStereographicRaw=Hr,d.geoModifiedStereographicAlaska=function(){return sr(ln,[152,-64]).scale(1400).center([-160.908,62.4864]).clipAngle(30).angle(7.8)},d.geoModifiedStereographicGs48=function(){return sr(bn,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])},d.geoModifiedStereographicGs50=function(){return sr(nn,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])},d.geoModifiedStereographicMiller=function(){return sr(pn,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)},d.geoModifiedStereographicLee=function(){return sr(qn,[165,10]).scale(250).clipAngle(130).center([-165,-10])},d.geoMollweide=function(){return v.geoProjection(ne).scale(169.529)},d.geoMollweideRaw=ne,d.geoMtFlatPolarParabolic=function(){return v.geoProjection(Rt).scale(164.859)},d.geoMtFlatPolarParabolicRaw=Rt,d.geoMtFlatPolarQuartic=function(){return v.geoProjection(or).scale(188.209)},d.geoMtFlatPolarQuarticRaw=or,d.geoMtFlatPolarSinusoidal=function(){return v.geoProjection(wt).scale(166.518)},d.geoMtFlatPolarSinusoidalRaw=wt,d.geoNaturalEarth2=function(){return v.geoProjection(ir).scale(175.295)},d.geoNaturalEarth2Raw=ir,d.geoNellHammer=function(){return v.geoProjection(ar).scale(152.63)},d.geoNellHammerRaw=ar,d.geoInterruptedQuarticAuthalic=function(){return nr(N(1/0),Dr).rotate([20,0]).scale(152.63)},d.geoNicolosi=function(){return v.geoProjection(Pr).scale(127.267)},d.geoNicolosiRaw=Pr,d.geoPatterson=function(){return v.geoProjection(Er).scale(139.319)},d.geoPattersonRaw=Er,d.geoPolyconic=function(){return v.geoProjection(Ar).scale(103.74)},d.geoPolyconicRaw=Ar,d.geoPolyhedral=Zr,d.geoPolyhedralButterfly=function(Ue){Ue=Ue||function(rt){var ut=v.geoCentroid({type:"MultiPoint",coordinates:rt});return v.geoGnomonic().scale(1).translate([0,0]).rotate([-ut[0],-ut[1]])};var Ke=yn.map(function(rt){return{face:rt,project:Ue(rt)}});return[-1,0,0,1,0,1,4,5].forEach(function(rt,ut){var _t=Ke[rt];_t&&(_t.children||(_t.children=[])).push(Ke[ut])}),Zr(Ke[0],function(rt,ut){return Ke[rt<-x/2?ut<0?6:4:rt<0?ut<0?2:0:rt<x/2?ut<0?3:1:ut<0?7:5]}).angle(-30).scale(101.858).center([0,45])},d.geoPolyhedralCollignon=function(Ue){Ue=Ue||function(rt){var ut=v.geoCentroid({type:"MultiPoint",coordinates:rt});return v.geoProjection(wn).translate([0,0]).scale(1).rotate(ut[1]>0?[-ut[0],0]:[180-ut[0],180])};var Ke=yn.map(function(rt){return{face:rt,project:Ue(rt)}});return[-1,0,0,1,0,1,4,5].forEach(function(rt,ut){var _t=Ke[rt];_t&&(_t.children||(_t.children=[])).push(Ke[ut])}),Zr(Ke[0],function(rt,ut){return Ke[rt<-x/2?ut<0?6:4:rt<0?ut<0?2:0:rt<x/2?ut<0?3:1:ut<0?7:5]}).angle(-30).scale(121.906).center([0,48.5904])},d.geoPolyhedralWaterman=function(Ue){Ue=Ue||function(yt){var Ct=yt.length===6?v.geoCentroid({type:"MultiPoint",coordinates:yt}):yt[0];return v.geoGnomonic().scale(1).translate([0,0]).rotate([-Ct[0],-Ct[1]])};var Ke=yn.map(function(yt){for(var Ct,er=yt.map(Xn),rr=er.length,Xt=er[rr-1],ur=[],yr=0;yr<rr;++yr)Ct=er[yr],ur.push(Rn([.9486832980505138*Xt[0]+.31622776601683794*Ct[0],.9486832980505138*Xt[1]+.31622776601683794*Ct[1],.9486832980505138*Xt[2]+.31622776601683794*Ct[2]]),Rn([.9486832980505138*Ct[0]+.31622776601683794*Xt[0],.9486832980505138*Ct[1]+.31622776601683794*Xt[1],.9486832980505138*Ct[2]+.31622776601683794*Xt[2]])),Xt=Ct;return ur}),rt=[],ut=[-1,0,0,1,0,1,4,5];Ke.forEach(function(yt,Ct){for(var er,rr,Xt=yn[Ct],ur=Xt.length,yr=rt[Ct]=[],kr=0;kr<ur;++kr)Ke.push([Xt[kr],yt[(2*kr+2)%(2*ur)],yt[(2*kr+1)%(2*ur)]]),ut.push(Ct),yr.push((er=Xn(yt[(2*kr+2)%(2*ur)]),rr=Xn(yt[(2*kr+1)%(2*ur)]),[er[1]*rr[2]-er[2]*rr[1],er[2]*rr[0]-er[0]*rr[2],er[0]*rr[1]-er[1]*rr[0]]))});var _t=Ke.map(function(yt){return{project:Ue(yt),face:yt}});return ut.forEach(function(yt,Ct){var er=_t[yt];er&&(er.children||(er.children=[])).push(_t[Ct])}),Zr(_t[0],function(yt,Ct){var er=n(Ct),rr=[er*n(yt),er*p(yt),p(Ct)],Xt=yt<-x/2?Ct<0?6:4:yt<0?Ct<0?2:0:yt<x/2?Ct<0?3:1:Ct<0?7:5,ur=rt[Xt];return _t[Pn(ur[0],rr)<0?8+3*Xt:Pn(ur[1],rr)<0?8+3*Xt+1:Pn(ur[2],rr)<0?8+3*Xt+2:Xt]}).angle(-30).scale(110.625).center([0,45])},d.geoProject=function(Ue,Ke){var rt,ut=Ke.stream;if(!ut)throw new Error("invalid projection");switch(Ue&&Ue.type){case"Feature":rt=Cn;break;case"FeatureCollection":rt=Mi;break;default:rt=ti}return rt(Ue,ut)},d.geoGringortenQuincuncial=function(){return Wi(ct).scale(176.423)},d.geoPeirceQuincuncial=Zi,d.geoPierceQuincuncial=Zi,d.geoQuantize=function(Ue,Ke){if(!(0<=(Ke=+Ke)&&Ke<=20))throw new Error("invalid digits");function rt(Xt){var ur=Xt.length,yr=2,kr=new Array(ur);for(kr[0]=+Xt[0].toFixed(Ke),kr[1]=+Xt[1].toFixed(Ke);yr<ur;)kr[yr]=Xt[yr],++yr;return kr}function ut(Xt){return Xt.map(rt)}function _t(Xt){for(var ur=rt(Xt[0]),yr=[ur],kr=1;kr<Xt.length;kr++){var Sr=rt(Xt[kr]);(Sr.length>2||Sr[0]!=ur[0]||Sr[1]!=ur[1])&&(yr.push(Sr),ur=Sr)}return yr.length===1&&Xt.length>1&&yr.push(rt(Xt[Xt.length-1])),yr}function yt(Xt){return Xt.map(_t)}function Ct(Xt){if(Xt==null)return Xt;var ur;switch(Xt.type){case"GeometryCollection":ur={type:"GeometryCollection",geometries:Xt.geometries.map(Ct)};break;case"Point":ur={type:"Point",coordinates:rt(Xt.coordinates)};break;case"MultiPoint":ur={type:Xt.type,coordinates:ut(Xt.coordinates)};break;case"LineString":ur={type:Xt.type,coordinates:_t(Xt.coordinates)};break;case"MultiLineString":case"Polygon":ur={type:Xt.type,coordinates:yt(Xt.coordinates)};break;case"MultiPolygon":ur={type:"MultiPolygon",coordinates:Xt.coordinates.map(yt)};break;default:return Xt}return Xt.bbox!=null&&(ur.bbox=Xt.bbox),ur}function er(Xt){var ur={type:"Feature",properties:Xt.properties,geometry:Ct(Xt.geometry)};return Xt.id!=null&&(ur.id=Xt.id),Xt.bbox!=null&&(ur.bbox=Xt.bbox),ur}if(Ue!=null)switch(Ue.type){case"Feature":return er(Ue);case"FeatureCollection":var rr={type:"FeatureCollection",features:Ue.features.map(er)};return Ue.bbox!=null&&(rr.bbox=Ue.bbox),rr;default:return Ct(Ue)}return Ue},d.geoQuincuncial=Wi,d.geoRectangularPolyconic=function(){return ce(no).scale(131.215)},d.geoRectangularPolyconicRaw=no,d.geoRobinson=function(){return v.geoProjection(yo).scale(152.63)},d.geoRobinsonRaw=yo,d.geoSatellite=function(){var Ue=2,Ke=0,rt=v.geoProjectionMutator(wo),ut=rt(Ue,Ke);return ut.distance=function(_t){return arguments.length?rt(Ue=+_t,Ke):Ue},ut.tilt=function(_t){return arguments.length?rt(Ue,Ke=_t*I):Ke*A},ut.scale(432.147).clipAngle(S(1/Ue)*A-1e-6)},d.geoSatelliteRaw=wo,d.geoSinuMollweide=function(){return v.geoProjection(St).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},d.geoSinuMollweideRaw=St,d.geoSinusoidal=function(){return v.geoProjection(ye).scale(152.63)},d.geoSinusoidalRaw=ye,d.geoStitch=function(Ue){if(Ue==null)return Ue;switch(Ue.type){case"Feature":return Xi(Ue);case"FeatureCollection":var Ke={type:"FeatureCollection",features:Ue.features.map(Xi)};return Ue.bbox!=null&&(Ke.bbox=Ue.bbox),Ke;default:return As(Ue)}},d.geoTimes=function(){return v.geoProjection(fs).scale(146.153)},d.geoTimesRaw=fs,d.geoTwoPointAzimuthal=zs,d.geoTwoPointAzimuthalRaw=Vs,d.geoTwoPointAzimuthalUsa=function(){return zs([-158,21.5],[-77,39]).clipAngle(60).scale(400)},d.geoTwoPointEquidistant=Ro,d.geoTwoPointEquidistantRaw=Hs,d.geoTwoPointEquidistantUsa=function(){return Ro([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)},d.geoVanDerGrinten=function(){return v.geoProjection(Fo).scale(79.4183)},d.geoVanDerGrintenRaw=Fo,d.geoVanDerGrinten2=function(){return v.geoProjection(Xo).scale(79.4183)},d.geoVanDerGrinten2Raw=Xo,d.geoVanDerGrinten3=function(){return v.geoProjection(Ko).scale(79.4183)},d.geoVanDerGrinten3Raw=Ko,d.geoVanDerGrinten4=function(){return v.geoProjection(Jo).scale(127.16)},d.geoVanDerGrinten4Raw=Jo,d.geoWagner=ko,d.geoWagner7=function(){return ko().poleline(65).parallels(60).inflation(0).ratio(200).scale(172.633)},d.geoWagnerRaw=hs,d.geoWagner4=function(){return v.geoProjection($o).scale(176.84)},d.geoWagner4Raw=$o,d.geoWagner6=function(){return v.geoProjection(Es).scale(152.63)},d.geoWagner6Raw=Es,d.geoWiechel=function(){return v.geoProjection(Bo).rotate([0,-90,45]).scale(124.75).clipAngle(179.999)},d.geoWiechelRaw=Bo,d.geoWinkel3=function(){return v.geoProjection(Gi).scale(158.837)},d.geoWinkel3Raw=Gi,Object.defineProperty(d,"__esModule",{value:!0})})},{"d3-array":107,"d3-geo":114}],114:[function(m,G,Y){(function(d,v){typeof Y=="object"&&G!==void 0?v(Y,m("d3-array")):v((d=d||self).d3=d.d3||{},d.d3)})(this,function(d,v){function w(){return new y}function y(){this.reset()}y.prototype={constructor:y,reset:function(){this.s=this.t=0},add:function(dt){t(e,dt,this.t),t(this,e.s,this.s),this.s?this.t+=e.t:this.s=e.t},valueOf:function(){return this.s}};var e=new y;function t(dt,Ft,hr){var Yt=dt.s=Ft+hr,pr=Yt-Ft,Nr=Yt-pr;dt.t=Ft-Nr+(hr-pr)}var n=1e-6,o=Math.PI,r=o/2,g=o/4,c=2*o,a=180/o,h=o/180,l=Math.abs,s=Math.atan,p=Math.atan2,u=Math.cos,i=Math.ceil,x=Math.exp,f=Math.log,_=Math.pow,b=Math.sin,T=Math.sign||function(dt){return dt>0?1:dt<0?-1:0},k=Math.sqrt,L=Math.tan;function A(dt){return dt>1?0:dt<-1?o:Math.acos(dt)}function I(dt){return dt>1?r:dt<-1?-r:Math.asin(dt)}function P(dt){return(dt=b(dt/2))*dt}function S(){}function E(dt,Ft){dt&&D.hasOwnProperty(dt.type)&&D[dt.type](dt,Ft)}var z={Feature:function(dt,Ft){E(dt.geometry,Ft)},FeatureCollection:function(dt,Ft){for(var hr=dt.features,Yt=-1,pr=hr.length;++Yt<pr;)E(hr[Yt].geometry,Ft)}},D={Sphere:function(dt,Ft){Ft.sphere()},Point:function(dt,Ft){dt=dt.coordinates,Ft.point(dt[0],dt[1],dt[2])},MultiPoint:function(dt,Ft){for(var hr=dt.coordinates,Yt=-1,pr=hr.length;++Yt<pr;)dt=hr[Yt],Ft.point(dt[0],dt[1],dt[2])},LineString:function(dt,Ft){j(dt.coordinates,Ft,0)},MultiLineString:function(dt,Ft){for(var hr=dt.coordinates,Yt=-1,pr=hr.length;++Yt<pr;)j(hr[Yt],Ft,0)},Polygon:function(dt,Ft){V(dt.coordinates,Ft)},MultiPolygon:function(dt,Ft){for(var hr=dt.coordinates,Yt=-1,pr=hr.length;++Yt<pr;)V(hr[Yt],Ft)},GeometryCollection:function(dt,Ft){for(var hr=dt.geometries,Yt=-1,pr=hr.length;++Yt<pr;)E(hr[Yt],Ft)}};function j(dt,Ft,hr){var Yt,pr=-1,Nr=dt.length-hr;for(Ft.lineStart();++pr<Nr;)Yt=dt[pr],Ft.point(Yt[0],Yt[1],Yt[2]);Ft.lineEnd()}function V(dt,Ft){var hr=-1,Yt=dt.length;for(Ft.polygonStart();++hr<Yt;)j(dt[hr],Ft,1);Ft.polygonEnd()}function Z(dt,Ft){dt&&z.hasOwnProperty(dt.type)?z[dt.type](dt,Ft):E(dt,Ft)}var Q,X,$,re,H,N=w(),U=w(),te={point:S,lineStart:S,lineEnd:S,polygonStart:function(){N.reset(),te.lineStart=B,te.lineEnd=K},polygonEnd:function(){var dt=+N;U.add(dt<0?c+dt:dt),this.lineStart=this.lineEnd=this.point=S},sphere:function(){U.add(c)}};function B(){te.point=J}function K(){ee(Q,X)}function J(dt,Ft){te.point=ee,Q=dt,X=Ft,$=dt*=h,re=u(Ft=(Ft*=h)/2+g),H=b(Ft)}function ee(dt,Ft){var hr=(dt*=h)-$,Yt=hr>=0?1:-1,pr=Yt*hr,Nr=u(Ft=(Ft*=h)/2+g),qr=b(Ft),$r=H*qr,dn=re*Nr+$r*u(pr),fn=$r*Yt*b(pr);N.add(p(fn,dn)),$=dt,re=Nr,H=qr}function ne(dt){return[p(dt[1],dt[0]),I(dt[2])]}function se(dt){var Ft=dt[0],hr=dt[1],Yt=u(hr);return[Yt*u(Ft),Yt*b(Ft),b(hr)]}function oe(dt,Ft){return dt[0]*Ft[0]+dt[1]*Ft[1]+dt[2]*Ft[2]}function me(dt,Ft){return[dt[1]*Ft[2]-dt[2]*Ft[1],dt[2]*Ft[0]-dt[0]*Ft[2],dt[0]*Ft[1]-dt[1]*Ft[0]]}function ce(dt,Ft){dt[0]+=Ft[0],dt[1]+=Ft[1],dt[2]+=Ft[2]}function ye(dt,Ft){return[dt[0]*Ft,dt[1]*Ft,dt[2]*Ft]}function Se(dt){var Ft=k(dt[0]*dt[0]+dt[1]*dt[1]+dt[2]*dt[2]);dt[0]/=Ft,dt[1]/=Ft,dt[2]/=Ft}var fe,ge,Te,le,ve,Me,we,de,Ie,De,Oe,Ve,Fe,ze,Re,We,$e,at,gt,xt,mt,nt,Qe,vt,jt,Gt,$t=w(),Zt={point:cr,lineStart:Ne,lineEnd:Ye,polygonStart:function(){Zt.point=pe,Zt.lineStart=_e,Zt.lineEnd=Be,$t.reset(),te.polygonStart()},polygonEnd:function(){te.polygonEnd(),Zt.point=cr,Zt.lineStart=Ne,Zt.lineEnd=Ye,N<0?(fe=-(Te=180),ge=-(le=90)):$t>n?le=90:$t<-n&&(ge=-90),De[0]=fe,De[1]=Te},sphere:function(){fe=-(Te=180),ge=-(le=90)}};function cr(dt,Ft){Ie.push(De=[fe=dt,Te=dt]),Ft<ge&&(ge=Ft),Ft>le&&(le=Ft)}function Dt(dt,Ft){var hr=se([dt*h,Ft*h]);if(de){var Yt=me(de,hr),pr=me([Yt[1],-Yt[0],0],Yt);Se(pr),pr=ne(pr);var Nr,qr=dt-ve,$r=qr>0?1:-1,dn=pr[0]*a*$r,fn=l(qr)>180;fn^($r*ve<dn&&dn<$r*dt)?(Nr=pr[1]*a)>le&&(le=Nr):fn^($r*ve<(dn=(dn+360)%360-180)&&dn<$r*dt)?(Nr=-pr[1]*a)<ge&&(ge=Nr):(Ft<ge&&(ge=Ft),Ft>le&&(le=Ft)),fn?dt<ve?He(fe,dt)>He(fe,Te)&&(Te=dt):He(dt,Te)>He(fe,Te)&&(fe=dt):Te>=fe?(dt<fe&&(fe=dt),dt>Te&&(Te=dt)):dt>ve?He(fe,dt)>He(fe,Te)&&(Te=dt):He(dt,Te)>He(fe,Te)&&(fe=dt)}else Ie.push(De=[fe=dt,Te=dt]);Ft<ge&&(ge=Ft),Ft>le&&(le=Ft),de=hr,ve=dt}function Ne(){Zt.point=Dt}function Ye(){De[0]=fe,De[1]=Te,Zt.point=cr,de=null}function pe(dt,Ft){if(de){var hr=dt-ve;$t.add(l(hr)>180?hr+(hr>0?360:-360):hr)}else Me=dt,we=Ft;te.point(dt,Ft),Dt(dt,Ft)}function _e(){te.lineStart()}function Be(){pe(Me,we),te.lineEnd(),l($t)>n&&(fe=-(Te=180)),De[0]=fe,De[1]=Te,de=null}function He(dt,Ft){return(Ft-=dt)<0?Ft+360:Ft}function Je(dt,Ft){return dt[0]-Ft[0]}function Ze(dt,Ft){return dt[0]<=dt[1]?dt[0]<=Ft&&Ft<=dt[1]:Ft<dt[0]||dt[1]<Ft}var ct={sphere:S,point:lt,lineStart:Ot,lineEnd:Ut,polygonStart:function(){ct.lineStart=Mt,ct.lineEnd=It},polygonEnd:function(){ct.lineStart=Ot,ct.lineEnd=Ut}};function lt(dt,Ft){dt*=h;var hr=u(Ft*=h);At(hr*u(dt),hr*b(dt),b(Ft))}function At(dt,Ft,hr){++Oe,Fe+=(dt-Fe)/Oe,ze+=(Ft-ze)/Oe,Re+=(hr-Re)/Oe}function Ot(){ct.point=it}function it(dt,Ft){dt*=h;var hr=u(Ft*=h);vt=hr*u(dt),jt=hr*b(dt),Gt=b(Ft),ct.point=ht,At(vt,jt,Gt)}function ht(dt,Ft){dt*=h;var hr=u(Ft*=h),Yt=hr*u(dt),pr=hr*b(dt),Nr=b(Ft),qr=p(k((qr=jt*Nr-Gt*pr)*qr+(qr=Gt*Yt-vt*Nr)*qr+(qr=vt*pr-jt*Yt)*qr),vt*Yt+jt*pr+Gt*Nr);Ve+=qr,We+=qr*(vt+(vt=Yt)),$e+=qr*(jt+(jt=pr)),at+=qr*(Gt+(Gt=Nr)),At(vt,jt,Gt)}function Ut(){ct.point=lt}function Mt(){ct.point=Le}function It(){Xe(nt,Qe),ct.point=lt}function Le(dt,Ft){nt=dt,Qe=Ft,dt*=h,Ft*=h,ct.point=Xe;var hr=u(Ft);vt=hr*u(dt),jt=hr*b(dt),Gt=b(Ft),At(vt,jt,Gt)}function Xe(dt,Ft){dt*=h;var hr=u(Ft*=h),Yt=hr*u(dt),pr=hr*b(dt),Nr=b(Ft),qr=jt*Nr-Gt*pr,$r=Gt*Yt-vt*Nr,dn=vt*pr-jt*Yt,fn=k(qr*qr+$r*$r+dn*dn),_n=I(fn),Sn=fn&&-_n/fn;gt+=Sn*qr,xt+=Sn*$r,mt+=Sn*dn,Ve+=_n,We+=_n*(vt+(vt=Yt)),$e+=_n*(jt+(jt=pr)),at+=_n*(Gt+(Gt=Nr)),At(vt,jt,Gt)}function ot(dt){return function(){return dt}}function pt(dt,Ft){function hr(Yt,pr){return Yt=dt(Yt,pr),Ft(Yt[0],Yt[1])}return dt.invert&&Ft.invert&&(hr.invert=function(Yt,pr){return(Yt=Ft.invert(Yt,pr))&&dt.invert(Yt[0],Yt[1])}),hr}function St(dt,Ft){return[l(dt)>o?dt+Math.round(-dt/c)*c:dt,Ft]}function Vt(dt,Ft,hr){return(dt%=c)?Ft||hr?pt(qt(dt),gr(Ft,hr)):qt(dt):Ft||hr?gr(Ft,hr):St}function Jt(dt){return function(Ft,hr){return[(Ft+=dt)>o?Ft-c:Ft<-o?Ft+c:Ft,hr]}}function qt(dt){var Ft=Jt(dt);return Ft.invert=Jt(-dt),Ft}function gr(dt,Ft){var hr=u(dt),Yt=b(dt),pr=u(Ft),Nr=b(Ft);function qr($r,dn){var fn=u(dn),_n=u($r)*fn,Sn=b($r)*fn,mn=b(dn),En=mn*hr+_n*Yt;return[p(Sn*pr-En*Nr,_n*hr-mn*Yt),I(En*pr+Sn*Nr)]}return qr.invert=function($r,dn){var fn=u(dn),_n=u($r)*fn,Sn=b($r)*fn,mn=b(dn),En=mn*pr-Sn*Nr;return[p(Sn*pr+mn*Nr,_n*hr+En*Yt),I(En*hr-_n*Yt)]},qr}function Cr(dt){function Ft(hr){return(hr=dt(hr[0]*h,hr[1]*h))[0]*=a,hr[1]*=a,hr}return dt=Vt(dt[0]*h,dt[1]*h,dt.length>2?dt[2]*h:0),Ft.invert=function(hr){return(hr=dt.invert(hr[0]*h,hr[1]*h))[0]*=a,hr[1]*=a,hr},Ft}function mr(dt,Ft,hr,Yt,pr,Nr){if(hr){var qr=u(Ft),$r=b(Ft),dn=Yt*hr;pr==null?(pr=Ft+Yt*c,Nr=Ft-dn/2):(pr=tr(qr,pr),Nr=tr(qr,Nr),(Yt>0?pr<Nr:pr>Nr)&&(pr+=Yt*c));for(var fn,_n=pr;Yt>0?_n>Nr:_n<Nr;_n-=dn)fn=ne([qr,-$r*u(_n),-$r*b(_n)]),dt.point(fn[0],fn[1])}}function tr(dt,Ft){(Ft=se(Ft))[0]-=dt,Se(Ft);var hr=A(-Ft[1]);return((-Ft[2]<0?-hr:hr)+c-n)%c}function nr(){var dt,Ft=[];return{point:function(hr,Yt,pr){dt.push([hr,Yt,pr])},lineStart:function(){Ft.push(dt=[])},lineEnd:S,rejoin:function(){Ft.length>1&&Ft.push(Ft.pop().concat(Ft.shift()))},result:function(){var hr=Ft;return Ft=[],dt=null,hr}}}function Qt(dt,Ft){return l(dt[0]-Ft[0])<n&&l(dt[1]-Ft[1])<n}function dr(dt,Ft,hr,Yt){this.x=dt,this.z=Ft,this.o=hr,this.e=Yt,this.v=!1,this.n=this.p=null}function _r(dt,Ft,hr,Yt,pr){var Nr,qr,$r=[],dn=[];if(dt.forEach(function(Nn){if(!((Gn=Nn.length-1)<=0)){var Gn,si,Qr=Nn[0],ii=Nn[Gn];if(Qt(Qr,ii)){if(!Qr[2]&&!ii[2]){for(pr.lineStart(),Nr=0;Nr<Gn;++Nr)pr.point((Qr=Nn[Nr])[0],Qr[1]);return void pr.lineEnd()}ii[0]+=2*n}$r.push(si=new dr(Qr,Nn,null,!0)),dn.push(si.o=new dr(Qr,null,si,!1)),$r.push(si=new dr(ii,Nn,null,!1)),dn.push(si.o=new dr(ii,null,si,!0))}}),$r.length){for(dn.sort(Ft),Ir($r),Ir(dn),Nr=0,qr=dn.length;Nr<qr;++Nr)dn[Nr].e=hr=!hr;for(var fn,_n,Sn=$r[0];;){for(var mn=Sn,En=!0;mn.v;)if((mn=mn.n)===Sn)return;fn=mn.z,pr.lineStart();do{if(mn.v=mn.o.v=!0,mn.e){if(En)for(Nr=0,qr=fn.length;Nr<qr;++Nr)pr.point((_n=fn[Nr])[0],_n[1]);else Yt(mn.x,mn.n.x,1,pr);mn=mn.n}else{if(En)for(fn=mn.p.z,Nr=fn.length-1;Nr>=0;--Nr)pr.point((_n=fn[Nr])[0],_n[1]);else Yt(mn.x,mn.p.x,-1,pr);mn=mn.p}fn=(mn=mn.o).z,En=!En}while(!mn.v);pr.lineEnd()}}}function Ir(dt){if(Ft=dt.length){for(var Ft,hr,Yt=0,pr=dt[0];++Yt<Ft;)pr.n=hr=dt[Yt],hr.p=pr,pr=hr;pr.n=hr=dt[0],hr.p=pr}}St.invert=St;var Rr=w();function Vr(dt){return l(dt[0])<=o?dt[0]:T(dt[0])*((l(dt[0])+o)%c-o)}function Xr(dt,Ft){var hr=Vr(Ft),Yt=Ft[1],pr=b(Yt),Nr=[b(hr),-u(hr),0],qr=0,$r=0;Rr.reset(),pr===1?Yt=r+n:pr===-1&&(Yt=-r-n);for(var dn=0,fn=dt.length;dn<fn;++dn)if(Sn=(_n=dt[dn]).length)for(var _n,Sn,mn=_n[Sn-1],En=Vr(mn),Nn=mn[1]/2+g,Gn=b(Nn),si=u(Nn),Qr=0;Qr<Sn;++Qr,En=Dn,Gn=ni,si=ki,mn=ii){var ii=_n[Qr],Dn=Vr(ii),Vn=ii[1]/2+g,ni=b(Vn),ki=u(Vn),Pi=Dn-En,In=Pi>=0?1:-1,Ri=In*Pi,Ci=Ri>o,gi=Gn*ni;if(Rr.add(p(gi*In*b(Ri),si*ki+gi*u(Ri))),qr+=Ci?Pi+In*c:Pi,Ci^En>=hr^Dn>=hr){var Fi=me(se(mn),se(ii));Se(Fi);var Ei=me(Nr,Fi);Se(Ei);var na=(Ci^Pi>=0?-1:1)*I(Ei[2]);(Yt>na||Yt===na&&(Fi[0]||Fi[1]))&&($r+=Ci^Pi>=0?1:-1)}}return(qr<-n||qr<n&&Rr<-n)^1&$r}function cn(dt,Ft,hr,Yt){return function(pr){var Nr,qr,$r,dn=Ft(pr),fn=nr(),_n=Ft(fn),Sn=!1,mn={point:En,lineStart:Gn,lineEnd:si,polygonStart:function(){mn.point=Qr,mn.lineStart=ii,mn.lineEnd=Dn,qr=[],Nr=[]},polygonEnd:function(){mn.point=En,mn.lineStart=Gn,mn.lineEnd=si,qr=v.merge(qr);var Vn=Xr(Nr,Yt);qr.length?(Sn||(pr.polygonStart(),Sn=!0),_r(qr,zn,Vn,hr,pr)):Vn&&(Sn||(pr.polygonStart(),Sn=!0),pr.lineStart(),hr(null,null,1,pr),pr.lineEnd()),Sn&&(pr.polygonEnd(),Sn=!1),qr=Nr=null},sphere:function(){pr.polygonStart(),pr.lineStart(),hr(null,null,1,pr),pr.lineEnd(),pr.polygonEnd()}};function En(Vn,ni){dt(Vn,ni)&&pr.point(Vn,ni)}function Nn(Vn,ni){dn.point(Vn,ni)}function Gn(){mn.point=Nn,dn.lineStart()}function si(){mn.point=En,dn.lineEnd()}function Qr(Vn,ni){$r.push([Vn,ni]),_n.point(Vn,ni)}function ii(){_n.lineStart(),$r=[]}function Dn(){Qr($r[0][0],$r[0][1]),_n.lineEnd();var Vn,ni,ki,Pi,In=_n.clean(),Ri=fn.result(),Ci=Ri.length;if($r.pop(),Nr.push($r),$r=null,Ci)if(1&In){if((ni=(ki=Ri[0]).length-1)>0){for(Sn||(pr.polygonStart(),Sn=!0),pr.lineStart(),Vn=0;Vn<ni;++Vn)pr.point((Pi=ki[Vn])[0],Pi[1]);pr.lineEnd()}}else Ci>1&&2&In&&Ri.push(Ri.pop().concat(Ri.shift())),qr.push(Ri.filter(an))}return mn}}function an(dt){return dt.length>1}function zn(dt,Ft){return((dt=dt.x)[0]<0?dt[1]-r-n:r-dt[1])-((Ft=Ft.x)[0]<0?Ft[1]-r-n:r-Ft[1])}var on=cn(function(){return!0},function(dt){var Ft,hr=NaN,Yt=NaN,pr=NaN;return{lineStart:function(){dt.lineStart(),Ft=1},point:function(Nr,qr){var $r=Nr>0?o:-o,dn=l(Nr-hr);l(dn-o)<n?(dt.point(hr,Yt=(Yt+qr)/2>0?r:-r),dt.point(pr,Yt),dt.lineEnd(),dt.lineStart(),dt.point($r,Yt),dt.point(Nr,Yt),Ft=0):pr!==$r&&dn>=o&&(l(hr-pr)<n&&(hr-=pr*n),l(Nr-$r)<n&&(Nr-=$r*n),Yt=function(fn,_n,Sn,mn){var En,Nn,Gn=b(fn-Sn);return l(Gn)>n?s((b(_n)*(Nn=u(mn))*b(Sn)-b(mn)*(En=u(_n))*b(fn))/(En*Nn*Gn)):(_n+mn)/2}(hr,Yt,Nr,qr),dt.point(pr,Yt),dt.lineEnd(),dt.lineStart(),dt.point($r,Yt),Ft=0),dt.point(hr=Nr,Yt=qr),pr=$r},lineEnd:function(){dt.lineEnd(),hr=Yt=NaN},clean:function(){return 2-Ft}}},function(dt,Ft,hr,Yt){var pr;if(dt==null)pr=hr*r,Yt.point(-o,pr),Yt.point(0,pr),Yt.point(o,pr),Yt.point(o,0),Yt.point(o,-pr),Yt.point(0,-pr),Yt.point(-o,-pr),Yt.point(-o,0),Yt.point(-o,pr);else if(l(dt[0]-Ft[0])>n){var Nr=dt[0]<Ft[0]?o:-o;pr=hr*Nr/2,Yt.point(-Nr,pr),Yt.point(0,pr),Yt.point(Nr,pr)}else Yt.point(Ft[0],Ft[1])},[-o,-r]);function Tn(dt){var Ft=u(dt),hr=6*h,Yt=Ft>0,pr=l(Ft)>n;function Nr(dn,fn){return u(dn)*u(fn)>Ft}function qr(dn,fn,_n){var Sn=[1,0,0],mn=me(se(dn),se(fn)),En=oe(mn,mn),Nn=mn[0],Gn=En-Nn*Nn;if(!Gn)return!_n&&dn;var si=Ft*En/Gn,Qr=-Ft*Nn/Gn,ii=me(Sn,mn),Dn=ye(Sn,si);ce(Dn,ye(mn,Qr));var Vn=ii,ni=oe(Dn,Vn),ki=oe(Vn,Vn),Pi=ni*ni-ki*(oe(Dn,Dn)-1);if(!(Pi<0)){var In=k(Pi),Ri=ye(Vn,(-ni-In)/ki);if(ce(Ri,Dn),Ri=ne(Ri),!_n)return Ri;var Ci,gi=dn[0],Fi=fn[0],Ei=dn[1],na=fn[1];Fi<gi&&(Ci=gi,gi=Fi,Fi=Ci);var ai=Fi-gi,Ki=l(ai-o)<n;if(!Ki&&na<Ei&&(Ci=Ei,Ei=na,na=Ci),Ki||ai<n?Ki?Ei+na>0^Ri[1]<(l(Ri[0]-gi)<n?Ei:na):Ei<=Ri[1]&&Ri[1]<=na:ai>o^(gi<=Ri[0]&&Ri[0]<=Fi)){var Ya=ye(Vn,(-ni+In)/ki);return ce(Ya,Dn),[Ri,ne(Ya)]}}}function $r(dn,fn){var _n=Yt?dt:o-dt,Sn=0;return dn<-_n?Sn|=1:dn>_n&&(Sn|=2),fn<-_n?Sn|=4:fn>_n&&(Sn|=8),Sn}return cn(Nr,function(dn){var fn,_n,Sn,mn,En;return{lineStart:function(){mn=Sn=!1,En=1},point:function(Nn,Gn){var si,Qr=[Nn,Gn],ii=Nr(Nn,Gn),Dn=Yt?ii?0:$r(Nn,Gn):ii?$r(Nn+(Nn<0?o:-o),Gn):0;if(!fn&&(mn=Sn=ii)&&dn.lineStart(),ii!==Sn&&(!(si=qr(fn,Qr))||Qt(fn,si)||Qt(Qr,si))&&(Qr[2]=1),ii!==Sn)En=0,ii?(dn.lineStart(),si=qr(Qr,fn),dn.point(si[0],si[1])):(si=qr(fn,Qr),dn.point(si[0],si[1],2),dn.lineEnd()),fn=si;else if(pr&&fn&&Yt^ii){var Vn;Dn&_n||!(Vn=qr(Qr,fn,!0))||(En=0,Yt?(dn.lineStart(),dn.point(Vn[0][0],Vn[0][1]),dn.point(Vn[1][0],Vn[1][1]),dn.lineEnd()):(dn.point(Vn[1][0],Vn[1][1]),dn.lineEnd(),dn.lineStart(),dn.point(Vn[0][0],Vn[0][1],3)))}!ii||fn&&Qt(fn,Qr)||dn.point(Qr[0],Qr[1]),fn=Qr,Sn=ii,_n=Dn},lineEnd:function(){Sn&&dn.lineEnd(),fn=null},clean:function(){return En|(mn&&Sn)<<1}}},function(dn,fn,_n,Sn){mr(Sn,dt,hr,_n,dn,fn)},Yt?[0,-dt]:[-o,dt-o])}function Mn(dt,Ft,hr,Yt){function pr(fn,_n){return dt<=fn&&fn<=hr&&Ft<=_n&&_n<=Yt}function Nr(fn,_n,Sn,mn){var En=0,Nn=0;if(fn==null||(En=qr(fn,Sn))!==(Nn=qr(_n,Sn))||dn(fn,_n)<0^Sn>0)do mn.point(En===0||En===3?dt:hr,En>1?Yt:Ft);while((En=(En+Sn+4)%4)!==Nn);else mn.point(_n[0],_n[1])}function qr(fn,_n){return l(fn[0]-dt)<n?_n>0?0:3:l(fn[0]-hr)<n?_n>0?2:1:l(fn[1]-Ft)<n?_n>0?1:0:_n>0?3:2}function $r(fn,_n){return dn(fn.x,_n.x)}function dn(fn,_n){var Sn=qr(fn,1),mn=qr(_n,1);return Sn!==mn?Sn-mn:Sn===0?_n[1]-fn[1]:Sn===1?fn[0]-_n[0]:Sn===2?fn[1]-_n[1]:_n[0]-fn[0]}return function(fn){var _n,Sn,mn,En,Nn,Gn,si,Qr,ii,Dn,Vn,ni=fn,ki=nr(),Pi={point:In,lineStart:function(){Pi.point=Ri,Sn&&Sn.push(mn=[]),Dn=!0,ii=!1,si=Qr=NaN},lineEnd:function(){_n&&(Ri(En,Nn),Gn&&ii&&ki.rejoin(),_n.push(ki.result())),Pi.point=In,ii&&ni.lineEnd()},polygonStart:function(){ni=ki,_n=[],Sn=[],Vn=!0},polygonEnd:function(){var Ci=function(){for(var Ei=0,na=0,ai=Sn.length;na<ai;++na)for(var Ki,Ya,is=Sn[na],Ho=1,Mo=is.length,xi=is[0],xa=xi[0],Ao=xi[1];Ho<Mo;++Ho)Ki=xa,Ya=Ao,xi=is[Ho],xa=xi[0],Ao=xi[1],Ya<=Yt?Ao>Yt&&(xa-Ki)*(Yt-Ya)>(Ao-Ya)*(dt-Ki)&&++Ei:Ao<=Yt&&(xa-Ki)*(Yt-Ya)<(Ao-Ya)*(dt-Ki)&&--Ei;return Ei}(),gi=Vn&&Ci,Fi=(_n=v.merge(_n)).length;(gi||Fi)&&(fn.polygonStart(),gi&&(fn.lineStart(),Nr(null,null,1,fn),fn.lineEnd()),Fi&&_r(_n,$r,Ci,Nr,fn),fn.polygonEnd()),ni=fn,_n=Sn=mn=null}};function In(Ci,gi){pr(Ci,gi)&&ni.point(Ci,gi)}function Ri(Ci,gi){var Fi=pr(Ci,gi);if(Sn&&mn.push([Ci,gi]),Dn)En=Ci,Nn=gi,Gn=Fi,Dn=!1,Fi&&(ni.lineStart(),ni.point(Ci,gi));else if(Fi&&ii)ni.point(Ci,gi);else{var Ei=[si=Math.max(-1e9,Math.min(1e9,si)),Qr=Math.max(-1e9,Math.min(1e9,Qr))],na=[Ci=Math.max(-1e9,Math.min(1e9,Ci)),gi=Math.max(-1e9,Math.min(1e9,gi))];(function(ai,Ki,Ya,is,Ho,Mo){var xi,xa=ai[0],Ao=ai[1],Ji=0,La=1,$a=Ki[0]-xa,aa=Ki[1]-Ao;if(xi=Ya-xa,$a||!(xi>0)){if(xi/=$a,$a<0){if(xi<Ji)return;xi<La&&(La=xi)}else if($a>0){if(xi>La)return;xi>Ji&&(Ji=xi)}if(xi=Ho-xa,$a||!(xi<0)){if(xi/=$a,$a<0){if(xi>La)return;xi>Ji&&(Ji=xi)}else if($a>0){if(xi<Ji)return;xi<La&&(La=xi)}if(xi=is-Ao,aa||!(xi>0)){if(xi/=aa,aa<0){if(xi<Ji)return;xi<La&&(La=xi)}else if(aa>0){if(xi>La)return;xi>Ji&&(Ji=xi)}if(xi=Mo-Ao,aa||!(xi<0)){if(xi/=aa,aa<0){if(xi>La)return;xi>Ji&&(Ji=xi)}else if(aa>0){if(xi<Ji)return;xi<La&&(La=xi)}return Ji>0&&(ai[0]=xa+Ji*$a,ai[1]=Ao+Ji*aa),La<1&&(Ki[0]=xa+La*$a,Ki[1]=Ao+La*aa),!0}}}}})(Ei,na,dt,Ft,hr,Yt)?(ii||(ni.lineStart(),ni.point(Ei[0],Ei[1])),ni.point(na[0],na[1]),Fi||ni.lineEnd(),Vn=!1):Fi&&(ni.lineStart(),ni.point(Ci,gi),Vn=!1)}si=Ci,Qr=gi,ii=Fi}return Pi}}var ei,Hr,ln,bn=w(),nn={sphere:S,point:S,lineStart:function(){nn.point=qn,nn.lineEnd=pn},lineEnd:S,polygonStart:S,polygonEnd:S};function pn(){nn.point=nn.lineEnd=S}function qn(dt,Ft){ei=dt*=h,Hr=b(Ft*=h),ln=u(Ft),nn.point=sr}function sr(dt,Ft){dt*=h;var hr=b(Ft*=h),Yt=u(Ft),pr=l(dt-ei),Nr=u(pr),qr=Yt*b(pr),$r=ln*hr-Hr*Yt*Nr,dn=Hr*hr+ln*Yt*Nr;bn.add(p(k(qr*qr+$r*$r),dn)),ei=dt,Hr=hr,ln=Yt}function xr(dt){return bn.reset(),Z(dt,nn),+bn}var jr=[null,null],Rt={type:"LineString",coordinates:jr};function or(dt,Ft){return jr[0]=dt,jr[1]=Ft,xr(Rt)}var wt={Feature:function(dt,Ft){return ar(dt.geometry,Ft)},FeatureCollection:function(dt,Ft){for(var hr=dt.features,Yt=-1,pr=hr.length;++Yt<pr;)if(ar(hr[Yt].geometry,Ft))return!0;return!1}},ir={Sphere:function(){return!0},Point:function(dt,Ft){return Dr(dt.coordinates,Ft)},MultiPoint:function(dt,Ft){for(var hr=dt.coordinates,Yt=-1,pr=hr.length;++Yt<pr;)if(Dr(hr[Yt],Ft))return!0;return!1},LineString:function(dt,Ft){return Pr(dt.coordinates,Ft)},MultiLineString:function(dt,Ft){for(var hr=dt.coordinates,Yt=-1,pr=hr.length;++Yt<pr;)if(Pr(hr[Yt],Ft))return!0;return!1},Polygon:function(dt,Ft){return Er(dt.coordinates,Ft)},MultiPolygon:function(dt,Ft){for(var hr=dt.coordinates,Yt=-1,pr=hr.length;++Yt<pr;)if(Er(hr[Yt],Ft))return!0;return!1},GeometryCollection:function(dt,Ft){for(var hr=dt.geometries,Yt=-1,pr=hr.length;++Yt<pr;)if(ar(hr[Yt],Ft))return!0;return!1}};function ar(dt,Ft){return!(!dt||!ir.hasOwnProperty(dt.type))&&ir[dt.type](dt,Ft)}function Dr(dt,Ft){return or(dt,Ft)===0}function Pr(dt,Ft){for(var hr,Yt,pr,Nr=0,qr=dt.length;Nr<qr;Nr++){if((Yt=or(dt[Nr],Ft))===0||Nr>0&&(pr=or(dt[Nr],dt[Nr-1]))>0&&hr<=pr&&Yt<=pr&&(hr+Yt-pr)*(1-Math.pow((hr-Yt)/pr,2))<1e-12*pr)return!0;hr=Yt}return!1}function Er(dt,Ft){return!!Xr(dt.map(Ar),vr(Ft))}function Ar(dt){return(dt=dt.map(vr)).pop(),dt}function vr(dt){return[dt[0]*h,dt[1]*h]}function wr(dt,Ft,hr){var Yt=v.range(dt,Ft-n,hr).concat(Ft);return function(pr){return Yt.map(function(Nr){return[pr,Nr]})}}function Mr(dt,Ft,hr){var Yt=v.range(dt,Ft-n,hr).concat(Ft);return function(pr){return Yt.map(function(Nr){return[Nr,pr]})}}function Lr(){var dt,Ft,hr,Yt,pr,Nr,qr,$r,dn,fn,_n,Sn,mn=10,En=mn,Nn=90,Gn=360,si=2.5;function Qr(){return{type:"MultiLineString",coordinates:ii()}}function ii(){return v.range(i(Yt/Nn)*Nn,hr,Nn).map(_n).concat(v.range(i($r/Gn)*Gn,qr,Gn).map(Sn)).concat(v.range(i(Ft/mn)*mn,dt,mn).filter(function(Dn){return l(Dn%Nn)>n}).map(dn)).concat(v.range(i(Nr/En)*En,pr,En).filter(function(Dn){return l(Dn%Gn)>n}).map(fn))}return Qr.lines=function(){return ii().map(function(Dn){return{type:"LineString",coordinates:Dn}})},Qr.outline=function(){return{type:"Polygon",coordinates:[_n(Yt).concat(Sn(qr).slice(1),_n(hr).reverse().slice(1),Sn($r).reverse().slice(1))]}},Qr.extent=function(Dn){return arguments.length?Qr.extentMajor(Dn).extentMinor(Dn):Qr.extentMinor()},Qr.extentMajor=function(Dn){return arguments.length?(Yt=+Dn[0][0],hr=+Dn[1][0],$r=+Dn[0][1],qr=+Dn[1][1],Yt>hr&&(Dn=Yt,Yt=hr,hr=Dn),$r>qr&&(Dn=$r,$r=qr,qr=Dn),Qr.precision(si)):[[Yt,$r],[hr,qr]]},Qr.extentMinor=function(Dn){return arguments.length?(Ft=+Dn[0][0],dt=+Dn[1][0],Nr=+Dn[0][1],pr=+Dn[1][1],Ft>dt&&(Dn=Ft,Ft=dt,dt=Dn),Nr>pr&&(Dn=Nr,Nr=pr,pr=Dn),Qr.precision(si)):[[Ft,Nr],[dt,pr]]},Qr.step=function(Dn){return arguments.length?Qr.stepMajor(Dn).stepMinor(Dn):Qr.stepMinor()},Qr.stepMajor=function(Dn){return arguments.length?(Nn=+Dn[0],Gn=+Dn[1],Qr):[Nn,Gn]},Qr.stepMinor=function(Dn){return arguments.length?(mn=+Dn[0],En=+Dn[1],Qr):[mn,En]},Qr.precision=function(Dn){return arguments.length?(si=+Dn,dn=wr(Nr,pr,90),fn=Mr(Ft,dt,si),_n=wr($r,qr,90),Sn=Mr(Yt,hr,si),Qr):si},Qr.extentMajor([[-180,-90+n],[180,90-n]]).extentMinor([[-180,-80-n],[180,80+n]])}function Zr(dt){return dt}var Yr,rn,sn,yn,kn=w(),wn=w(),Pn={point:S,lineStart:S,lineEnd:S,polygonStart:function(){Pn.lineStart=Rn,Pn.lineEnd=Mi},polygonEnd:function(){Pn.lineStart=Pn.lineEnd=Pn.point=S,kn.add(l(wn)),wn.reset()},result:function(){var dt=kn/2;return kn.reset(),dt}};function Rn(){Pn.point=Xn}function Xn(dt,Ft){Pn.point=Ai,Yr=sn=dt,rn=yn=Ft}function Ai(dt,Ft){wn.add(yn*dt-sn*Ft),sn=dt,yn=Ft}function Mi(){Ai(Yr,rn)}var Cn=1/0,ti=Cn,$n=-Cn,Di=$n,va={point:function(dt,Ft){dt<Cn&&(Cn=dt),dt>$n&&($n=dt),Ft<ti&&(ti=Ft),Ft>Di&&(Di=Ft)},lineStart:S,lineEnd:S,polygonStart:S,polygonEnd:S,result:function(){var dt=[[Cn,ti],[$n,Di]];return $n=Di=-(ti=Cn=1/0),dt}},ja,vo,Wi,Zi,no=0,Ni=0,yo=0,wo=0,Sa=0,io=0,To=0,Io=0,qa=0,ya={point:to,lineStart:Ds,lineEnd:As,polygonStart:function(){ya.lineStart=fs,ya.lineEnd=Us},polygonEnd:function(){ya.point=to,ya.lineStart=Ds,ya.lineEnd=As},result:function(){var dt=qa?[To/qa,Io/qa]:io?[wo/io,Sa/io]:yo?[no/yo,Ni/yo]:[NaN,NaN];return no=Ni=yo=wo=Sa=io=To=Io=qa=0,dt}};function to(dt,Ft){no+=dt,Ni+=Ft,++yo}function Ds(){ya.point=js}function js(dt,Ft){ya.point=Xi,to(Wi=dt,Zi=Ft)}function Xi(dt,Ft){var hr=dt-Wi,Yt=Ft-Zi,pr=k(hr*hr+Yt*Yt);wo+=pr*(Wi+dt)/2,Sa+=pr*(Zi+Ft)/2,io+=pr,to(Wi=dt,Zi=Ft)}function As(){ya.point=to}function fs(){ya.point=Vs}function Us(){zs(ja,vo)}function Vs(dt,Ft){ya.point=zs,to(ja=Wi=dt,vo=Zi=Ft)}function zs(dt,Ft){var hr=dt-Wi,Yt=Ft-Zi,pr=k(hr*hr+Yt*Yt);wo+=pr*(Wi+dt)/2,Sa+=pr*(Zi+Ft)/2,io+=pr,To+=(pr=Zi*dt-Wi*Ft)*(Wi+dt),Io+=pr*(Zi+Ft),qa+=3*pr,to(Wi=dt,Zi=Ft)}function Hs(dt){this._context=dt}Hs.prototype={_radius:4.5,pointRadius:function(dt){return this._radius=dt,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(dt,Ft){switch(this._point){case 0:this._context.moveTo(dt,Ft),this._point=1;break;case 1:this._context.lineTo(dt,Ft);break;default:this._context.moveTo(dt+this._radius,Ft),this._context.arc(dt,Ft,this._radius,0,c)}},result:S};var Ro,Fo,Xo,Ko,Jo,hs=w(),ko={point:S,lineStart:function(){ko.point=Ss},lineEnd:function(){Ro&&xo(Fo,Xo),ko.point=S},polygonStart:function(){Ro=!0},polygonEnd:function(){Ro=null},result:function(){var dt=+hs;return hs.reset(),dt}};function Ss(dt,Ft){ko.point=xo,Fo=Ko=dt,Xo=Jo=Ft}function xo(dt,Ft){Ko-=dt,Jo-=Ft,hs.add(k(Ko*Ko+Jo*Jo)),Ko=dt,Jo=Ft}function $o(){this._string=[]}function Es(dt){return"m0,"+dt+"a"+dt+","+dt+" 0 1,1 0,"+-2*dt+"a"+dt+","+dt+" 0 1,1 0,"+2*dt+"z"}function Bo(dt){return function(Ft){var hr=new Gi;for(var Yt in dt)hr[Yt]=dt[Yt];return hr.stream=Ft,hr}}function Gi(){}function Ue(dt,Ft,hr){var Yt=dt.clipExtent&&dt.clipExtent();return dt.scale(150).translate([0,0]),Yt!=null&&dt.clipExtent(null),Z(hr,dt.stream(va)),Ft(va.result()),Yt!=null&&dt.clipExtent(Yt),dt}function Ke(dt,Ft,hr){return Ue(dt,function(Yt){var pr=Ft[1][0]-Ft[0][0],Nr=Ft[1][1]-Ft[0][1],qr=Math.min(pr/(Yt[1][0]-Yt[0][0]),Nr/(Yt[1][1]-Yt[0][1])),$r=+Ft[0][0]+(pr-qr*(Yt[1][0]+Yt[0][0]))/2,dn=+Ft[0][1]+(Nr-qr*(Yt[1][1]+Yt[0][1]))/2;dt.scale(150*qr).translate([$r,dn])},hr)}function rt(dt,Ft,hr){return Ke(dt,[[0,0],Ft],hr)}function ut(dt,Ft,hr){return Ue(dt,function(Yt){var pr=+Ft,Nr=pr/(Yt[1][0]-Yt[0][0]),qr=(pr-Nr*(Yt[1][0]+Yt[0][0]))/2,$r=-Nr*Yt[0][1];dt.scale(150*Nr).translate([qr,$r])},hr)}function _t(dt,Ft,hr){return Ue(dt,function(Yt){var pr=+Ft,Nr=pr/(Yt[1][1]-Yt[0][1]),qr=-Nr*Yt[0][0],$r=(pr-Nr*(Yt[1][1]+Yt[0][1]))/2;dt.scale(150*Nr).translate([qr,$r])},hr)}$o.prototype={_radius:4.5,_circle:Es(4.5),pointRadius:function(dt){return(dt=+dt)!==this._radius&&(this._radius=dt,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(dt,Ft){switch(this._point){case 0:this._string.push("M",dt,",",Ft),this._point=1;break;case 1:this._string.push("L",dt,",",Ft);break;default:this._circle==null&&(this._circle=Es(this._radius)),this._string.push("M",dt,",",Ft,this._circle)}},result:function(){if(this._string.length){var dt=this._string.join("");return this._string=[],dt}return null}},Gi.prototype={constructor:Gi,point:function(dt,Ft){this.stream.point(dt,Ft)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var yt=u(30*h);function Ct(dt,Ft){return+Ft?function(hr,Yt){function pr(Nr,qr,$r,dn,fn,_n,Sn,mn,En,Nn,Gn,si,Qr,ii){var Dn=Sn-Nr,Vn=mn-qr,ni=Dn*Dn+Vn*Vn;if(ni>4*Yt&&Qr--){var ki=dn+Nn,Pi=fn+Gn,In=_n+si,Ri=k(ki*ki+Pi*Pi+In*In),Ci=I(In/=Ri),gi=l(l(In)-1)<n||l($r-En)<n?($r+En)/2:p(Pi,ki),Fi=hr(gi,Ci),Ei=Fi[0],na=Fi[1],ai=Ei-Nr,Ki=na-qr,Ya=Vn*ai-Dn*Ki;(Ya*Ya/ni>Yt||l((Dn*ai+Vn*Ki)/ni-.5)>.3||dn*Nn+fn*Gn+_n*si<yt)&&(pr(Nr,qr,$r,dn,fn,_n,Ei,na,gi,ki/=Ri,Pi/=Ri,In,Qr,ii),ii.point(Ei,na),pr(Ei,na,gi,ki,Pi,In,Sn,mn,En,Nn,Gn,si,Qr,ii))}}return function(Nr){var qr,$r,dn,fn,_n,Sn,mn,En,Nn,Gn,si,Qr,ii={point:Dn,lineStart:Vn,lineEnd:ki,polygonStart:function(){Nr.polygonStart(),ii.lineStart=Pi},polygonEnd:function(){Nr.polygonEnd(),ii.lineStart=Vn}};function Dn(Ci,gi){Ci=hr(Ci,gi),Nr.point(Ci[0],Ci[1])}function Vn(){En=NaN,ii.point=ni,Nr.lineStart()}function ni(Ci,gi){var Fi=se([Ci,gi]),Ei=hr(Ci,gi);pr(En,Nn,mn,Gn,si,Qr,En=Ei[0],Nn=Ei[1],mn=Ci,Gn=Fi[0],si=Fi[1],Qr=Fi[2],16,Nr),Nr.point(En,Nn)}function ki(){ii.point=Dn,Nr.lineEnd()}function Pi(){Vn(),ii.point=In,ii.lineEnd=Ri}function In(Ci,gi){ni(qr=Ci,gi),$r=En,dn=Nn,fn=Gn,_n=si,Sn=Qr,ii.point=ni}function Ri(){pr(En,Nn,mn,Gn,si,Qr,$r,dn,qr,fn,_n,Sn,16,Nr),ii.lineEnd=ki,ki()}return ii}}(dt,Ft):function(hr){return Bo({point:function(Yt,pr){Yt=hr(Yt,pr),this.stream.point(Yt[0],Yt[1])}})}(dt)}var er=Bo({point:function(dt,Ft){this.stream.point(dt*h,Ft*h)}});function rr(dt,Ft,hr,Yt,pr){function Nr(qr,$r){return[Ft+dt*(qr*=Yt),hr-dt*($r*=pr)]}return Nr.invert=function(qr,$r){return[(qr-Ft)/dt*Yt,(hr-$r)/dt*pr]},Nr}function Xt(dt,Ft,hr,Yt,pr,Nr){var qr=u(Nr),$r=b(Nr),dn=qr*dt,fn=$r*dt,_n=qr/dt,Sn=$r/dt,mn=($r*hr-qr*Ft)/dt,En=($r*Ft+qr*hr)/dt;function Nn(Gn,si){return[dn*(Gn*=Yt)-fn*(si*=pr)+Ft,hr-fn*Gn-dn*si]}return Nn.invert=function(Gn,si){return[Yt*(_n*Gn-Sn*si+mn),pr*(En-Sn*Gn-_n*si)]},Nn}function ur(dt){return yr(function(){return dt})()}function yr(dt){var Ft,hr,Yt,pr,Nr,qr,$r,dn,fn,_n,Sn=150,mn=480,En=250,Nn=0,Gn=0,si=0,Qr=0,ii=0,Dn=0,Vn=1,ni=1,ki=null,Pi=on,In=null,Ri=Zr,Ci=.5;function gi(ai){return dn(ai[0]*h,ai[1]*h)}function Fi(ai){return(ai=dn.invert(ai[0],ai[1]))&&[ai[0]*a,ai[1]*a]}function Ei(){var ai=Xt(Sn,0,0,Vn,ni,Dn).apply(null,Ft(Nn,Gn)),Ki=(Dn?Xt:rr)(Sn,mn-ai[0],En-ai[1],Vn,ni,Dn);return hr=Vt(si,Qr,ii),$r=pt(Ft,Ki),dn=pt(hr,$r),qr=Ct($r,Ci),na()}function na(){return fn=_n=null,gi}return gi.stream=function(ai){return fn&&_n===ai?fn:fn=er(function(Ki){return Bo({point:function(Ya,is){var Ho=Ki(Ya,is);return this.stream.point(Ho[0],Ho[1])}})}(hr)(Pi(qr(Ri(_n=ai)))))},gi.preclip=function(ai){return arguments.length?(Pi=ai,ki=void 0,na()):Pi},gi.postclip=function(ai){return arguments.length?(Ri=ai,In=Yt=pr=Nr=null,na()):Ri},gi.clipAngle=function(ai){return arguments.length?(Pi=+ai?Tn(ki=ai*h):(ki=null,on),na()):ki*a},gi.clipExtent=function(ai){return arguments.length?(Ri=ai==null?(In=Yt=pr=Nr=null,Zr):Mn(In=+ai[0][0],Yt=+ai[0][1],pr=+ai[1][0],Nr=+ai[1][1]),na()):In==null?null:[[In,Yt],[pr,Nr]]},gi.scale=function(ai){return arguments.length?(Sn=+ai,Ei()):Sn},gi.translate=function(ai){return arguments.length?(mn=+ai[0],En=+ai[1],Ei()):[mn,En]},gi.center=function(ai){return arguments.length?(Nn=ai[0]%360*h,Gn=ai[1]%360*h,Ei()):[Nn*a,Gn*a]},gi.rotate=function(ai){return arguments.length?(si=ai[0]%360*h,Qr=ai[1]%360*h,ii=ai.length>2?ai[2]%360*h:0,Ei()):[si*a,Qr*a,ii*a]},gi.angle=function(ai){return arguments.length?(Dn=ai%360*h,Ei()):Dn*a},gi.reflectX=function(ai){return arguments.length?(Vn=ai?-1:1,Ei()):Vn<0},gi.reflectY=function(ai){return arguments.length?(ni=ai?-1:1,Ei()):ni<0},gi.precision=function(ai){return arguments.length?(qr=Ct($r,Ci=ai*ai),na()):k(Ci)},gi.fitExtent=function(ai,Ki){return Ke(gi,ai,Ki)},gi.fitSize=function(ai,Ki){return rt(gi,ai,Ki)},gi.fitWidth=function(ai,Ki){return ut(gi,ai,Ki)},gi.fitHeight=function(ai,Ki){return _t(gi,ai,Ki)},function(){return Ft=dt.apply(this,arguments),gi.invert=Ft.invert&&Fi,Ei()}}function kr(dt){var Ft=0,hr=o/3,Yt=yr(dt),pr=Yt(Ft,hr);return pr.parallels=function(Nr){return arguments.length?Yt(Ft=Nr[0]*h,hr=Nr[1]*h):[Ft*a,hr*a]},pr}function Sr(dt,Ft){var hr=b(dt),Yt=(hr+b(Ft))/2;if(l(Yt)<n)return function($r){var dn=u($r);function fn(_n,Sn){return[_n*dn,b(Sn)/dn]}return fn.invert=function(_n,Sn){return[_n/dn,I(Sn*dn)]},fn}(dt);var pr=1+hr*(2*Yt-hr),Nr=k(pr)/Yt;function qr($r,dn){var fn=k(pr-2*Yt*b(dn))/Yt;return[fn*b($r*=Yt),Nr-fn*u($r)]}return qr.invert=function($r,dn){var fn=Nr-dn,_n=p($r,l(fn))*T(fn);return fn*Yt<0&&(_n-=o*T($r)*T(fn)),[_n/Yt,I((pr-($r*$r+fn*fn)*Yt*Yt)/(2*Yt))]},qr}function Ur(){return kr(Sr).scale(155.424).center([0,33.6442])}function un(){return Ur().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function xn(dt){return function(Ft,hr){var Yt=u(Ft),pr=u(hr),Nr=dt(Yt*pr);return[Nr*pr*b(Ft),Nr*b(hr)]}}function On(dt){return function(Ft,hr){var Yt=k(Ft*Ft+hr*hr),pr=dt(Yt),Nr=b(pr),qr=u(pr);return[p(Ft*Nr,Yt*qr),I(Yt&&hr*Nr/Yt)]}}var Fn=xn(function(dt){return k(2/(1+dt))});Fn.invert=On(function(dt){return 2*I(dt/2)});var Yn=xn(function(dt){return(dt=A(dt))&&dt/b(dt)});function Bn(dt,Ft){return[dt,f(L((r+Ft)/2))]}function vi(dt){var Ft,hr,Yt,pr=ur(dt),Nr=pr.center,qr=pr.scale,$r=pr.translate,dn=pr.clipExtent,fn=null;function _n(){var Sn=o*qr(),mn=pr(Cr(pr.rotate()).invert([0,0]));return dn(fn==null?[[mn[0]-Sn,mn[1]-Sn],[mn[0]+Sn,mn[1]+Sn]]:dt===Bn?[[Math.max(mn[0]-Sn,fn),Ft],[Math.min(mn[0]+Sn,hr),Yt]]:[[fn,Math.max(mn[1]-Sn,Ft)],[hr,Math.min(mn[1]+Sn,Yt)]])}return pr.scale=function(Sn){return arguments.length?(qr(Sn),_n()):qr()},pr.translate=function(Sn){return arguments.length?($r(Sn),_n()):$r()},pr.center=function(Sn){return arguments.length?(Nr(Sn),_n()):Nr()},pr.clipExtent=function(Sn){return arguments.length?(Sn==null?fn=Ft=hr=Yt=null:(fn=+Sn[0][0],Ft=+Sn[0][1],hr=+Sn[1][0],Yt=+Sn[1][1]),_n()):fn==null?null:[[fn,Ft],[hr,Yt]]},_n()}function Si(dt){return L((r+dt)/2)}function Ui(dt,Ft){var hr=u(dt),Yt=dt===Ft?b(dt):f(hr/u(Ft))/f(Si(Ft)/Si(dt)),pr=hr*_(Si(dt),Yt)/Yt;if(!Yt)return Bn;function Nr(qr,$r){pr>0?$r<-r+n&&($r=-r+n):$r>r-n&&($r=r-n);var dn=pr/_(Si($r),Yt);return[dn*b(Yt*qr),pr-dn*u(Yt*qr)]}return Nr.invert=function(qr,$r){var dn=pr-$r,fn=T(Yt)*k(qr*qr+dn*dn),_n=p(qr,l(dn))*T(dn);return dn*Yt<0&&(_n-=o*T(qr)*T(dn)),[_n/Yt,2*s(_(pr/fn,1/Yt))-r]},Nr}function ji(dt,Ft){return[dt,Ft]}function Vi(dt,Ft){var hr=u(dt),Yt=dt===Ft?b(dt):(hr-u(Ft))/(Ft-dt),pr=hr/Yt+dt;if(l(Yt)<n)return ji;function Nr(qr,$r){var dn=pr-$r,fn=Yt*qr;return[dn*b(fn),pr-dn*u(fn)]}return Nr.invert=function(qr,$r){var dn=pr-$r,fn=p(qr,l(dn))*T(dn);return dn*Yt<0&&(fn-=o*T(qr)*T(dn)),[fn/Yt,pr-T(Yt)*k(qr*qr+dn*dn)]},Nr}Yn.invert=On(function(dt){return dt}),Bn.invert=function(dt,Ft){return[dt,2*s(x(Ft))-r]},ji.invert=ji;var Ea=1.340264,ka=-.081106,ca=893e-6,ua=.003796,Ma=k(3)/2;function Ga(dt,Ft){var hr=I(Ma*b(Ft)),Yt=hr*hr,pr=Yt*Yt*Yt;return[dt*u(hr)/(Ma*(Ea+3*ka*Yt+pr*(7*ca+9*ua*Yt))),hr*(Ea+ka*Yt+pr*(ca+ua*Yt))]}function ao(dt,Ft){var hr=u(Ft),Yt=u(dt)*hr;return[hr*b(dt)/Yt,b(Ft)/Yt]}function oo(dt,Ft){var hr=Ft*Ft,Yt=hr*hr;return[dt*(.8707-.131979*hr+Yt*(Yt*(.003971*hr-.001529*Yt)-.013791)),Ft*(1.007226+hr*(.015085+Yt*(.028874*hr-.044475-.005916*Yt)))]}function so(dt,Ft){return[u(Ft)*b(dt),b(Ft)]}function lo(dt,Ft){var hr=u(Ft),Yt=1+u(dt)*hr;return[hr*b(dt)/Yt,b(Ft)/Yt]}function zi(dt,Ft){return[f(L((r+Ft)/2)),-dt]}Ga.invert=function(dt,Ft){for(var hr,Yt=Ft,pr=Yt*Yt,Nr=pr*pr*pr,qr=0;qr<12&&(Nr=(pr=(Yt-=hr=(Yt*(Ea+ka*pr+Nr*(ca+ua*pr))-Ft)/(Ea+3*ka*pr+Nr*(7*ca+9*ua*pr)))*Yt)*pr*pr,!(l(hr)<1e-12));++qr);return[Ma*dt*(Ea+3*ka*pr+Nr*(7*ca+9*ua*pr))/u(Yt),I(b(Yt)/Ma)]},ao.invert=On(s),oo.invert=function(dt,Ft){var hr,Yt=Ft,pr=25;do{var Nr=Yt*Yt,qr=Nr*Nr;Yt-=hr=(Yt*(1.007226+Nr*(.015085+qr*(.028874*Nr-.044475-.005916*qr)))-Ft)/(1.007226+Nr*(.045255+qr*(.259866*Nr-.311325-.005916*11*qr)))}while(l(hr)>n&&--pr>0);return[dt/(.8707+(Nr=Yt*Yt)*(Nr*(Nr*Nr*Nr*(.003971-.001529*Nr)-.013791)-.131979)),Yt]},so.invert=On(I),lo.invert=On(function(dt){return 2*s(dt)}),zi.invert=function(dt,Ft){return[-Ft,2*s(x(dt))-r]},d.geoAlbers=un,d.geoAlbersUsa=function(){var dt,Ft,hr,Yt,pr,Nr,qr=un(),$r=Ur().rotate([154,0]).center([-2,58.5]).parallels([55,65]),dn=Ur().rotate([157,0]).center([-3,19.9]).parallels([8,18]),fn={point:function(mn,En){Nr=[mn,En]}};function _n(mn){var En=mn[0],Nn=mn[1];return Nr=null,hr.point(En,Nn),Nr||(Yt.point(En,Nn),Nr)||(pr.point(En,Nn),Nr)}function Sn(){return dt=Ft=null,_n}return _n.invert=function(mn){var En=qr.scale(),Nn=qr.translate(),Gn=(mn[0]-Nn[0])/En,si=(mn[1]-Nn[1])/En;return(si>=.12&&si<.234&&Gn>=-.425&&Gn<-.214?$r:si>=.166&&si<.234&&Gn>=-.214&&Gn<-.115?dn:qr).invert(mn)},_n.stream=function(mn){return dt&&Ft===mn?dt:(En=[qr.stream(Ft=mn),$r.stream(mn),dn.stream(mn)],Nn=En.length,dt={point:function(Gn,si){for(var Qr=-1;++Qr<Nn;)En[Qr].point(Gn,si)},sphere:function(){for(var Gn=-1;++Gn<Nn;)En[Gn].sphere()},lineStart:function(){for(var Gn=-1;++Gn<Nn;)En[Gn].lineStart()},lineEnd:function(){for(var Gn=-1;++Gn<Nn;)En[Gn].lineEnd()},polygonStart:function(){for(var Gn=-1;++Gn<Nn;)En[Gn].polygonStart()},polygonEnd:function(){for(var Gn=-1;++Gn<Nn;)En[Gn].polygonEnd()}});var En,Nn},_n.precision=function(mn){return arguments.length?(qr.precision(mn),$r.precision(mn),dn.precision(mn),Sn()):qr.precision()},_n.scale=function(mn){return arguments.length?(qr.scale(mn),$r.scale(.35*mn),dn.scale(mn),_n.translate(qr.translate())):qr.scale()},_n.translate=function(mn){if(!arguments.length)return qr.translate();var En=qr.scale(),Nn=+mn[0],Gn=+mn[1];return hr=qr.translate(mn).clipExtent([[Nn-.455*En,Gn-.238*En],[Nn+.455*En,Gn+.238*En]]).stream(fn),Yt=$r.translate([Nn-.307*En,Gn+.201*En]).clipExtent([[Nn-.425*En+n,Gn+.12*En+n],[Nn-.214*En-n,Gn+.234*En-n]]).stream(fn),pr=dn.translate([Nn-.205*En,Gn+.212*En]).clipExtent([[Nn-.214*En+n,Gn+.166*En+n],[Nn-.115*En-n,Gn+.234*En-n]]).stream(fn),Sn()},_n.fitExtent=function(mn,En){return Ke(_n,mn,En)},_n.fitSize=function(mn,En){return rt(_n,mn,En)},_n.fitWidth=function(mn,En){return ut(_n,mn,En)},_n.fitHeight=function(mn,En){return _t(_n,mn,En)},_n.scale(1070)},d.geoArea=function(dt){return U.reset(),Z(dt,te),2*U},d.geoAzimuthalEqualArea=function(){return ur(Fn).scale(124.75).clipAngle(179.999)},d.geoAzimuthalEqualAreaRaw=Fn,d.geoAzimuthalEquidistant=function(){return ur(Yn).scale(79.4188).clipAngle(179.999)},d.geoAzimuthalEquidistantRaw=Yn,d.geoBounds=function(dt){var Ft,hr,Yt,pr,Nr,qr,$r;if(le=Te=-(fe=ge=1/0),Ie=[],Z(dt,Zt),hr=Ie.length){for(Ie.sort(Je),Ft=1,Nr=[Yt=Ie[0]];Ft<hr;++Ft)Ze(Yt,(pr=Ie[Ft])[0])||Ze(Yt,pr[1])?(He(Yt[0],pr[1])>He(Yt[0],Yt[1])&&(Yt[1]=pr[1]),He(pr[0],Yt[1])>He(Yt[0],Yt[1])&&(Yt[0]=pr[0])):Nr.push(Yt=pr);for(qr=-1/0,Ft=0,Yt=Nr[hr=Nr.length-1];Ft<=hr;Yt=pr,++Ft)pr=Nr[Ft],($r=He(Yt[1],pr[0]))>qr&&(qr=$r,fe=pr[0],Te=Yt[1])}return Ie=De=null,fe===1/0||ge===1/0?[[NaN,NaN],[NaN,NaN]]:[[fe,ge],[Te,le]]},d.geoCentroid=function(dt){Oe=Ve=Fe=ze=Re=We=$e=at=gt=xt=mt=0,Z(dt,ct);var Ft=gt,hr=xt,Yt=mt,pr=Ft*Ft+hr*hr+Yt*Yt;return pr<1e-12&&(Ft=We,hr=$e,Yt=at,Ve<n&&(Ft=Fe,hr=ze,Yt=Re),(pr=Ft*Ft+hr*hr+Yt*Yt)<1e-12)?[NaN,NaN]:[p(hr,Ft)*a,I(Yt/k(pr))*a]},d.geoCircle=function(){var dt,Ft,hr=ot([0,0]),Yt=ot(90),pr=ot(6),Nr={point:function($r,dn){dt.push($r=Ft($r,dn)),$r[0]*=a,$r[1]*=a}};function qr(){var $r=hr.apply(this,arguments),dn=Yt.apply(this,arguments)*h,fn=pr.apply(this,arguments)*h;return dt=[],Ft=Vt(-$r[0]*h,-$r[1]*h,0).invert,mr(Nr,dn,fn,1),$r={type:"Polygon",coordinates:[dt]},dt=Ft=null,$r}return qr.center=function($r){return arguments.length?(hr=typeof $r=="function"?$r:ot([+$r[0],+$r[1]]),qr):hr},qr.radius=function($r){return arguments.length?(Yt=typeof $r=="function"?$r:ot(+$r),qr):Yt},qr.precision=function($r){return arguments.length?(pr=typeof $r=="function"?$r:ot(+$r),qr):pr},qr},d.geoClipAntimeridian=on,d.geoClipCircle=Tn,d.geoClipExtent=function(){var dt,Ft,hr,Yt=0,pr=0,Nr=960,qr=500;return hr={stream:function($r){return dt&&Ft===$r?dt:dt=Mn(Yt,pr,Nr,qr)(Ft=$r)},extent:function($r){return arguments.length?(Yt=+$r[0][0],pr=+$r[0][1],Nr=+$r[1][0],qr=+$r[1][1],dt=Ft=null,hr):[[Yt,pr],[Nr,qr]]}}},d.geoClipRectangle=Mn,d.geoConicConformal=function(){return kr(Ui).scale(109.5).parallels([30,30])},d.geoConicConformalRaw=Ui,d.geoConicEqualArea=Ur,d.geoConicEqualAreaRaw=Sr,d.geoConicEquidistant=function(){return kr(Vi).scale(131.154).center([0,13.9389])},d.geoConicEquidistantRaw=Vi,d.geoContains=function(dt,Ft){return(dt&&wt.hasOwnProperty(dt.type)?wt[dt.type]:ar)(dt,Ft)},d.geoDistance=or,d.geoEqualEarth=function(){return ur(Ga).scale(177.158)},d.geoEqualEarthRaw=Ga,d.geoEquirectangular=function(){return ur(ji).scale(152.63)},d.geoEquirectangularRaw=ji,d.geoGnomonic=function(){return ur(ao).scale(144.049).clipAngle(60)},d.geoGnomonicRaw=ao,d.geoGraticule=Lr,d.geoGraticule10=function(){return Lr()()},d.geoIdentity=function(){var dt,Ft,hr,Yt,pr,Nr,qr,$r=1,dn=0,fn=0,_n=1,Sn=1,mn=0,En=null,Nn=1,Gn=1,si=Bo({point:function(Vn,ni){var ki=Dn([Vn,ni]);this.stream.point(ki[0],ki[1])}}),Qr=Zr;function ii(){return Nn=$r*_n,Gn=$r*Sn,Nr=qr=null,Dn}function Dn(Vn){var ni=Vn[0]*Nn,ki=Vn[1]*Gn;if(mn){var Pi=ki*dt-ni*Ft;ni=ni*dt+ki*Ft,ki=Pi}return[ni+dn,ki+fn]}return Dn.invert=function(Vn){var ni=Vn[0]-dn,ki=Vn[1]-fn;if(mn){var Pi=ki*dt+ni*Ft;ni=ni*dt-ki*Ft,ki=Pi}return[ni/Nn,ki/Gn]},Dn.stream=function(Vn){return Nr&&qr===Vn?Nr:Nr=si(Qr(qr=Vn))},Dn.postclip=function(Vn){return arguments.length?(Qr=Vn,En=hr=Yt=pr=null,ii()):Qr},Dn.clipExtent=function(Vn){return arguments.length?(Qr=Vn==null?(En=hr=Yt=pr=null,Zr):Mn(En=+Vn[0][0],hr=+Vn[0][1],Yt=+Vn[1][0],pr=+Vn[1][1]),ii()):En==null?null:[[En,hr],[Yt,pr]]},Dn.scale=function(Vn){return arguments.length?($r=+Vn,ii()):$r},Dn.translate=function(Vn){return arguments.length?(dn=+Vn[0],fn=+Vn[1],ii()):[dn,fn]},Dn.angle=function(Vn){return arguments.length?(Ft=b(mn=Vn%360*h),dt=u(mn),ii()):mn*a},Dn.reflectX=function(Vn){return arguments.length?(_n=Vn?-1:1,ii()):_n<0},Dn.reflectY=function(Vn){return arguments.length?(Sn=Vn?-1:1,ii()):Sn<0},Dn.fitExtent=function(Vn,ni){return Ke(Dn,Vn,ni)},Dn.fitSize=function(Vn,ni){return rt(Dn,Vn,ni)},Dn.fitWidth=function(Vn,ni){return ut(Dn,Vn,ni)},Dn.fitHeight=function(Vn,ni){return _t(Dn,Vn,ni)},Dn},d.geoInterpolate=function(dt,Ft){var hr=dt[0]*h,Yt=dt[1]*h,pr=Ft[0]*h,Nr=Ft[1]*h,qr=u(Yt),$r=b(Yt),dn=u(Nr),fn=b(Nr),_n=qr*u(hr),Sn=qr*b(hr),mn=dn*u(pr),En=dn*b(pr),Nn=2*I(k(P(Nr-Yt)+qr*dn*P(pr-hr))),Gn=b(Nn),si=Nn?function(Qr){var ii=b(Qr*=Nn)/Gn,Dn=b(Nn-Qr)/Gn,Vn=Dn*_n+ii*mn,ni=Dn*Sn+ii*En,ki=Dn*$r+ii*fn;return[p(ni,Vn)*a,p(ki,k(Vn*Vn+ni*ni))*a]}:function(){return[hr*a,Yt*a]};return si.distance=Nn,si},d.geoLength=xr,d.geoMercator=function(){return vi(Bn).scale(961/c)},d.geoMercatorRaw=Bn,d.geoNaturalEarth1=function(){return ur(oo).scale(175.295)},d.geoNaturalEarth1Raw=oo,d.geoOrthographic=function(){return ur(so).scale(249.5).clipAngle(90+n)},d.geoOrthographicRaw=so,d.geoPath=function(dt,Ft){var hr,Yt,pr=4.5;function Nr(qr){return qr&&(typeof pr=="function"&&Yt.pointRadius(+pr.apply(this,arguments)),Z(qr,hr(Yt))),Yt.result()}return Nr.area=function(qr){return Z(qr,hr(Pn)),Pn.result()},Nr.measure=function(qr){return Z(qr,hr(ko)),ko.result()},Nr.bounds=function(qr){return Z(qr,hr(va)),va.result()},Nr.centroid=function(qr){return Z(qr,hr(ya)),ya.result()},Nr.projection=function(qr){return arguments.length?(hr=qr==null?(dt=null,Zr):(dt=qr).stream,Nr):dt},Nr.context=function(qr){return arguments.length?(Yt=qr==null?(Ft=null,new $o):new Hs(Ft=qr),typeof pr!="function"&&Yt.pointRadius(pr),Nr):Ft},Nr.pointRadius=function(qr){return arguments.length?(pr=typeof qr=="function"?qr:(Yt.pointRadius(+qr),+qr),Nr):pr},Nr.projection(dt).context(Ft)},d.geoProjection=ur,d.geoProjectionMutator=yr,d.geoRotation=Cr,d.geoStereographic=function(){return ur(lo).scale(250).clipAngle(142)},d.geoStereographicRaw=lo,d.geoStream=Z,d.geoTransform=function(dt){return{stream:Bo(dt)}},d.geoTransverseMercator=function(){var dt=vi(zi),Ft=dt.center,hr=dt.rotate;return dt.center=function(Yt){return arguments.length?Ft([-Yt[1],Yt[0]]):[(Yt=Ft())[1],-Yt[0]]},dt.rotate=function(Yt){return arguments.length?hr([Yt[0],Yt[1],Yt.length>2?Yt[2]+90:90]):[(Yt=hr())[0],Yt[1],Yt[2]-90]},hr([0,0,90]).scale(159.155)},d.geoTransverseMercatorRaw=zi,Object.defineProperty(d,"__esModule",{value:!0})})},{"d3-array":107}],115:[function(m,G,Y){(function(d,v){v(typeof Y=="object"&&G!==void 0?Y:(d=d||self).d3=d.d3||{})})(this,function(d){function v(oe,me){return oe.parent===me.parent?1:2}function w(oe,me){return oe+me.x}function y(oe,me){return Math.max(oe,me.y)}function e(oe){var me=0,ce=oe.children,ye=ce&&ce.length;if(ye)for(;--ye>=0;)me+=ce[ye].value;else me=1;oe.value=me}function t(oe,me){var ce,ye,Se,fe,ge,Te=new g(oe),le=+oe.value&&(Te.value=oe.value),ve=[Te];for(me==null&&(me=n);ce=ve.pop();)if(le&&(ce.value=+ce.data.value),(Se=me(ce.data))&&(ge=Se.length))for(ce.children=new Array(ge),fe=ge-1;fe>=0;--fe)ve.push(ye=ce.children[fe]=new g(Se[fe])),ye.parent=ce,ye.depth=ce.depth+1;return Te.eachBefore(r)}function n(oe){return oe.children}function o(oe){oe.data=oe.data.data}function r(oe){var me=0;do oe.height=me;while((oe=oe.parent)&&oe.height<++me)}function g(oe){this.data=oe,this.depth=this.height=0,this.parent=null}g.prototype=t.prototype={constructor:g,count:function(){return this.eachAfter(e)},each:function(oe){var me,ce,ye,Se,fe=this,ge=[fe];do for(me=ge.reverse(),ge=[];fe=me.pop();)if(oe(fe),ce=fe.children)for(ye=0,Se=ce.length;ye<Se;++ye)ge.push(ce[ye]);while(ge.length);return this},eachAfter:function(oe){for(var me,ce,ye,Se=this,fe=[Se],ge=[];Se=fe.pop();)if(ge.push(Se),me=Se.children)for(ce=0,ye=me.length;ce<ye;++ce)fe.push(me[ce]);for(;Se=ge.pop();)oe(Se);return this},eachBefore:function(oe){for(var me,ce,ye=this,Se=[ye];ye=Se.pop();)if(oe(ye),me=ye.children)for(ce=me.length-1;ce>=0;--ce)Se.push(me[ce]);return this},sum:function(oe){return this.eachAfter(function(me){for(var ce=+oe(me.data)||0,ye=me.children,Se=ye&&ye.length;--Se>=0;)ce+=ye[Se].value;me.value=ce})},sort:function(oe){return this.eachBefore(function(me){me.children&&me.children.sort(oe)})},path:function(oe){for(var me=this,ce=function(fe,ge){if(fe===ge)return fe;var Te=fe.ancestors(),le=ge.ancestors(),ve=null;for(fe=Te.pop(),ge=le.pop();fe===ge;)ve=fe,fe=Te.pop(),ge=le.pop();return ve}(me,oe),ye=[me];me!==ce;)me=me.parent,ye.push(me);for(var Se=ye.length;oe!==ce;)ye.splice(Se,0,oe),oe=oe.parent;return ye},ancestors:function(){for(var oe=this,me=[oe];oe=oe.parent;)me.push(oe);return me},descendants:function(){var oe=[];return this.each(function(me){oe.push(me)}),oe},leaves:function(){var oe=[];return this.eachBefore(function(me){me.children||oe.push(me)}),oe},links:function(){var oe=this,me=[];return oe.each(function(ce){ce!==oe&&me.push({source:ce.parent,target:ce})}),me},copy:function(){return t(this).eachBefore(o)}};var c=Array.prototype.slice;function a(oe){for(var me,ce,ye=0,Se=(oe=function(ge){for(var Te,le,ve=ge.length;ve;)le=Math.random()*ve--|0,Te=ge[ve],ge[ve]=ge[le],ge[le]=Te;return ge}(c.call(oe))).length,fe=[];ye<Se;)me=oe[ye],ce&&s(ce,me)?++ye:(ce=u(fe=h(fe,me)),ye=0);return ce}function h(oe,me){var ce,ye;if(p(me,oe))return[me];for(ce=0;ce<oe.length;++ce)if(l(me,oe[ce])&&p(i(oe[ce],me),oe))return[oe[ce],me];for(ce=0;ce<oe.length-1;++ce)for(ye=ce+1;ye<oe.length;++ye)if(l(i(oe[ce],oe[ye]),me)&&l(i(oe[ce],me),oe[ye])&&l(i(oe[ye],me),oe[ce])&&p(x(oe[ce],oe[ye],me),oe))return[oe[ce],oe[ye],me];throw new Error}function l(oe,me){var ce=oe.r-me.r,ye=me.x-oe.x,Se=me.y-oe.y;return ce<0||ce*ce<ye*ye+Se*Se}function s(oe,me){var ce=oe.r-me.r+1e-6,ye=me.x-oe.x,Se=me.y-oe.y;return ce>0&&ce*ce>ye*ye+Se*Se}function p(oe,me){for(var ce=0;ce<me.length;++ce)if(!s(oe,me[ce]))return!1;return!0}function u(oe){switch(oe.length){case 1:return{x:(me=oe[0]).x,y:me.y,r:me.r};case 2:return i(oe[0],oe[1]);case 3:return x(oe[0],oe[1],oe[2])}var me}function i(oe,me){var ce=oe.x,ye=oe.y,Se=oe.r,fe=me.x,ge=me.y,Te=me.r,le=fe-ce,ve=ge-ye,Me=Te-Se,we=Math.sqrt(le*le+ve*ve);return{x:(ce+fe+le/we*Me)/2,y:(ye+ge+ve/we*Me)/2,r:(we+Se+Te)/2}}function x(oe,me,ce){var ye=oe.x,Se=oe.y,fe=oe.r,ge=me.x,Te=me.y,le=me.r,ve=ce.x,Me=ce.y,we=ce.r,de=ye-ge,Ie=ye-ve,De=Se-Te,Oe=Se-Me,Ve=le-fe,Fe=we-fe,ze=ye*ye+Se*Se-fe*fe,Re=ze-ge*ge-Te*Te+le*le,We=ze-ve*ve-Me*Me+we*we,$e=Ie*De-de*Oe,at=(De*We-Oe*Re)/(2*$e)-ye,gt=(Oe*Ve-De*Fe)/$e,xt=(Ie*Re-de*We)/(2*$e)-Se,mt=(de*Fe-Ie*Ve)/$e,nt=gt*gt+mt*mt-1,Qe=2*(fe+at*gt+xt*mt),vt=at*at+xt*xt-fe*fe,jt=-(nt?(Qe+Math.sqrt(Qe*Qe-4*nt*vt))/(2*nt):vt/Qe);return{x:ye+at+gt*jt,y:Se+xt+mt*jt,r:jt}}function f(oe,me,ce){var ye,Se,fe,ge,Te=oe.x-me.x,le=oe.y-me.y,ve=Te*Te+le*le;ve?(Se=me.r+ce.r,Se*=Se,ge=oe.r+ce.r,Se>(ge*=ge)?(ye=(ve+ge-Se)/(2*ve),fe=Math.sqrt(Math.max(0,ge/ve-ye*ye)),ce.x=oe.x-ye*Te-fe*le,ce.y=oe.y-ye*le+fe*Te):(ye=(ve+Se-ge)/(2*ve),fe=Math.sqrt(Math.max(0,Se/ve-ye*ye)),ce.x=me.x+ye*Te-fe*le,ce.y=me.y+ye*le+fe*Te)):(ce.x=me.x+ce.r,ce.y=me.y)}function _(oe,me){var ce=oe.r+me.r-1e-6,ye=me.x-oe.x,Se=me.y-oe.y;return ce>0&&ce*ce>ye*ye+Se*Se}function b(oe){var me=oe._,ce=oe.next._,ye=me.r+ce.r,Se=(me.x*ce.r+ce.x*me.r)/ye,fe=(me.y*ce.r+ce.y*me.r)/ye;return Se*Se+fe*fe}function T(oe){this._=oe,this.next=null,this.previous=null}function k(oe){if(!(Se=oe.length))return 0;var me,ce,ye,Se,fe,ge,Te,le,ve,Me,we;if((me=oe[0]).x=0,me.y=0,!(Se>1))return me.r;if(ce=oe[1],me.x=-ce.r,ce.x=me.r,ce.y=0,!(Se>2))return me.r+ce.r;f(ce,me,ye=oe[2]),me=new T(me),ce=new T(ce),ye=new T(ye),me.next=ye.previous=ce,ce.next=me.previous=ye,ye.next=ce.previous=me;e:for(Te=3;Te<Se;++Te){f(me._,ce._,ye=oe[Te]),ye=new T(ye),le=ce.next,ve=me.previous,Me=ce._.r,we=me._.r;do if(Me<=we){if(_(le._,ye._)){ce=le,me.next=ce,ce.previous=me,--Te;continue e}Me+=le._.r,le=le.next}else{if(_(ve._,ye._)){(me=ve).next=ce,ce.previous=me,--Te;continue e}we+=ve._.r,ve=ve.previous}while(le!==ve.next);for(ye.previous=me,ye.next=ce,me.next=ce.previous=ce=ye,fe=b(me);(ye=ye.next)!==ce;)(ge=b(ye))<fe&&(me=ye,fe=ge);ce=me.next}for(me=[ce._],ye=ce;(ye=ye.next)!==ce;)me.push(ye._);for(ye=a(me),Te=0;Te<Se;++Te)(me=oe[Te]).x-=ye.x,me.y-=ye.y;return ye.r}function L(oe){return oe==null?null:A(oe)}function A(oe){if(typeof oe!="function")throw new Error;return oe}function I(){return 0}function P(oe){return function(){return oe}}function S(oe){return Math.sqrt(oe.value)}function E(oe){return function(me){me.children||(me.r=Math.max(0,+oe(me)||0))}}function z(oe,me){return function(ce){if(ye=ce.children){var ye,Se,fe,ge=ye.length,Te=oe(ce)*me||0;if(Te)for(Se=0;Se<ge;++Se)ye[Se].r+=Te;if(fe=k(ye),Te)for(Se=0;Se<ge;++Se)ye[Se].r-=Te;ce.r=fe+Te}}}function D(oe){return function(me){var ce=me.parent;me.r*=oe,ce&&(me.x=ce.x+oe*me.x,me.y=ce.y+oe*me.y)}}function j(oe){oe.x0=Math.round(oe.x0),oe.y0=Math.round(oe.y0),oe.x1=Math.round(oe.x1),oe.y1=Math.round(oe.y1)}function V(oe,me,ce,ye,Se){for(var fe,ge=oe.children,Te=-1,le=ge.length,ve=oe.value&&(ye-me)/oe.value;++Te<le;)(fe=ge[Te]).y0=ce,fe.y1=Se,fe.x0=me,fe.x1=me+=fe.value*ve}var Z={depth:-1},Q={};function X(oe){return oe.id}function $(oe){return oe.parentId}function re(oe,me){return oe.parent===me.parent?1:2}function H(oe){var me=oe.children;return me?me[0]:oe.t}function N(oe){var me=oe.children;return me?me[me.length-1]:oe.t}function U(oe,me,ce){var ye=ce/(me.i-oe.i);me.c-=ye,me.s+=ce,oe.c+=ye,me.z+=ce,me.m+=ce}function te(oe,me,ce){return oe.a.parent===me.parent?oe.a:ce}function B(oe,me){this._=oe,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=me}function K(oe,me,ce,ye,Se){for(var fe,ge=oe.children,Te=-1,le=ge.length,ve=oe.value&&(Se-ce)/oe.value;++Te<le;)(fe=ge[Te]).x0=me,fe.x1=ye,fe.y0=ce,fe.y1=ce+=fe.value*ve}B.prototype=Object.create(g.prototype);var J=(1+Math.sqrt(5))/2;function ee(oe,me,ce,ye,Se,fe){for(var ge,Te,le,ve,Me,we,de,Ie,De,Oe,Ve,Fe=[],ze=me.children,Re=0,We=0,$e=ze.length,at=me.value;Re<$e;){le=Se-ce,ve=fe-ye;do Me=ze[We++].value;while(!Me&&We<$e);for(we=de=Me,Ve=Me*Me*(Oe=Math.max(ve/le,le/ve)/(at*oe)),De=Math.max(de/Ve,Ve/we);We<$e;++We){if(Me+=Te=ze[We].value,Te<we&&(we=Te),Te>de&&(de=Te),Ve=Me*Me*Oe,(Ie=Math.max(de/Ve,Ve/we))>De){Me-=Te;break}De=Ie}Fe.push(ge={value:Me,dice:le<ve,children:ze.slice(Re,We)}),ge.dice?V(ge,ce,ye,Se,at?ye+=ve*Me/at:fe):K(ge,ce,ye,at?ce+=le*Me/at:Se,fe),at-=Me,Re=We}return Fe}var ne=function oe(me){function ce(ye,Se,fe,ge,Te){ee(me,ye,Se,fe,ge,Te)}return ce.ratio=function(ye){return oe((ye=+ye)>1?ye:1)},ce}(J),se=function oe(me){function ce(ye,Se,fe,ge,Te){if((le=ye._squarify)&&le.ratio===me)for(var le,ve,Me,we,de,Ie=-1,De=le.length,Oe=ye.value;++Ie<De;){for(Me=(ve=le[Ie]).children,we=ve.value=0,de=Me.length;we<de;++we)ve.value+=Me[we].value;ve.dice?V(ve,Se,fe,ge,fe+=(Te-fe)*ve.value/Oe):K(ve,Se,fe,Se+=(ge-Se)*ve.value/Oe,Te),Oe-=ve.value}else ye._squarify=le=ee(me,ye,Se,fe,ge,Te),le.ratio=me}return ce.ratio=function(ye){return oe((ye=+ye)>1?ye:1)},ce}(J);d.cluster=function(){var oe=v,me=1,ce=1,ye=!1;function Se(fe){var ge,Te=0;fe.eachAfter(function(de){var Ie=de.children;Ie?(de.x=function(De){return De.reduce(w,0)/De.length}(Ie),de.y=function(De){return 1+De.reduce(y,0)}(Ie)):(de.x=ge?Te+=oe(de,ge):0,de.y=0,ge=de)});var le=function(de){for(var Ie;Ie=de.children;)de=Ie[0];return de}(fe),ve=function(de){for(var Ie;Ie=de.children;)de=Ie[Ie.length-1];return de}(fe),Me=le.x-oe(le,ve)/2,we=ve.x+oe(ve,le)/2;return fe.eachAfter(ye?function(de){de.x=(de.x-fe.x)*me,de.y=(fe.y-de.y)*ce}:function(de){de.x=(de.x-Me)/(we-Me)*me,de.y=(1-(fe.y?de.y/fe.y:1))*ce})}return Se.separation=function(fe){return arguments.length?(oe=fe,Se):oe},Se.size=function(fe){return arguments.length?(ye=!1,me=+fe[0],ce=+fe[1],Se):ye?null:[me,ce]},Se.nodeSize=function(fe){return arguments.length?(ye=!0,me=+fe[0],ce=+fe[1],Se):ye?[me,ce]:null},Se},d.hierarchy=t,d.pack=function(){var oe=null,me=1,ce=1,ye=I;function Se(fe){return fe.x=me/2,fe.y=ce/2,oe?fe.eachBefore(E(oe)).eachAfter(z(ye,.5)).eachBefore(D(1)):fe.eachBefore(E(S)).eachAfter(z(I,1)).eachAfter(z(ye,fe.r/Math.min(me,ce))).eachBefore(D(Math.min(me,ce)/(2*fe.r))),fe}return Se.radius=function(fe){return arguments.length?(oe=L(fe),Se):oe},Se.size=function(fe){return arguments.length?(me=+fe[0],ce=+fe[1],Se):[me,ce]},Se.padding=function(fe){return arguments.length?(ye=typeof fe=="function"?fe:P(+fe),Se):ye},Se},d.packEnclose=a,d.packSiblings=function(oe){return k(oe),oe},d.partition=function(){var oe=1,me=1,ce=0,ye=!1;function Se(fe){var ge=fe.height+1;return fe.x0=fe.y0=ce,fe.x1=oe,fe.y1=me/ge,fe.eachBefore(function(Te,le){return function(ve){ve.children&&V(ve,ve.x0,Te*(ve.depth+1)/le,ve.x1,Te*(ve.depth+2)/le);var Me=ve.x0,we=ve.y0,de=ve.x1-ce,Ie=ve.y1-ce;de<Me&&(Me=de=(Me+de)/2),Ie<we&&(we=Ie=(we+Ie)/2),ve.x0=Me,ve.y0=we,ve.x1=de,ve.y1=Ie}}(me,ge)),ye&&fe.eachBefore(j),fe}return Se.round=function(fe){return arguments.length?(ye=!!fe,Se):ye},Se.size=function(fe){return arguments.length?(oe=+fe[0],me=+fe[1],Se):[oe,me]},Se.padding=function(fe){return arguments.length?(ce=+fe,Se):ce},Se},d.stratify=function(){var oe=X,me=$;function ce(ye){var Se,fe,ge,Te,le,ve,Me,we=ye.length,de=new Array(we),Ie={};for(fe=0;fe<we;++fe)Se=ye[fe],le=de[fe]=new g(Se),(ve=oe(Se,fe,ye))!=null&&(ve+="")&&(Ie[Me="$"+(le.id=ve)]=Me in Ie?Q:le);for(fe=0;fe<we;++fe)if(le=de[fe],(ve=me(ye[fe],fe,ye))!=null&&(ve+="")){if(!(Te=Ie["$"+ve]))throw new Error("missing: "+ve);if(Te===Q)throw new Error("ambiguous: "+ve);Te.children?Te.children.push(le):Te.children=[le],le.parent=Te}else{if(ge)throw new Error("multiple roots");ge=le}if(!ge)throw new Error("no root");if(ge.parent=Z,ge.eachBefore(function(De){De.depth=De.parent.depth+1,--we}).eachBefore(r),ge.parent=null,we>0)throw new Error("cycle");return ge}return ce.id=function(ye){return arguments.length?(oe=A(ye),ce):oe},ce.parentId=function(ye){return arguments.length?(me=A(ye),ce):me},ce},d.tree=function(){var oe=re,me=1,ce=1,ye=null;function Se(le){var ve=function(Fe){for(var ze,Re,We,$e,at,gt=new B(Fe,0),xt=[gt];ze=xt.pop();)if(We=ze._.children)for(ze.children=new Array(at=We.length),$e=at-1;$e>=0;--$e)xt.push(Re=ze.children[$e]=new B(We[$e],$e)),Re.parent=ze;return(gt.parent=new B(null,0)).children=[gt],gt}(le);if(ve.eachAfter(fe),ve.parent.m=-ve.z,ve.eachBefore(ge),ye)le.eachBefore(Te);else{var Me=le,we=le,de=le;le.eachBefore(function(Fe){Fe.x<Me.x&&(Me=Fe),Fe.x>we.x&&(we=Fe),Fe.depth>de.depth&&(de=Fe)});var Ie=Me===we?1:oe(Me,we)/2,De=Ie-Me.x,Oe=me/(we.x+Ie+De),Ve=ce/(de.depth||1);le.eachBefore(function(Fe){Fe.x=(Fe.x+De)*Oe,Fe.y=Fe.depth*Ve})}return le}function fe(le){var ve=le.children,Me=le.parent.children,we=le.i?Me[le.i-1]:null;if(ve){(function(Ie){for(var De,Oe=0,Ve=0,Fe=Ie.children,ze=Fe.length;--ze>=0;)(De=Fe[ze]).z+=Oe,De.m+=Oe,Oe+=De.s+(Ve+=De.c)})(le);var de=(ve[0].z+ve[ve.length-1].z)/2;we?(le.z=we.z+oe(le._,we._),le.m=le.z-de):le.z=de}else we&&(le.z=we.z+oe(le._,we._));le.parent.A=function(Ie,De,Oe){if(De){for(var Ve,Fe=Ie,ze=Ie,Re=De,We=Fe.parent.children[0],$e=Fe.m,at=ze.m,gt=Re.m,xt=We.m;Re=N(Re),Fe=H(Fe),Re&&Fe;)We=H(We),(ze=N(ze)).a=Ie,(Ve=Re.z+gt-Fe.z-$e+oe(Re._,Fe._))>0&&(U(te(Re,Ie,Oe),Ie,Ve),$e+=Ve,at+=Ve),gt+=Re.m,$e+=Fe.m,xt+=We.m,at+=ze.m;Re&&!N(ze)&&(ze.t=Re,ze.m+=gt-at),Fe&&!H(We)&&(We.t=Fe,We.m+=$e-xt,Oe=Ie)}return Oe}(le,we,le.parent.A||Me[0])}function ge(le){le._.x=le.z+le.parent.m,le.m+=le.parent.m}function Te(le){le.x*=me,le.y=le.depth*ce}return Se.separation=function(le){return arguments.length?(oe=le,Se):oe},Se.size=function(le){return arguments.length?(ye=!1,me=+le[0],ce=+le[1],Se):ye?null:[me,ce]},Se.nodeSize=function(le){return arguments.length?(ye=!0,me=+le[0],ce=+le[1],Se):ye?[me,ce]:null},Se},d.treemap=function(){var oe=ne,me=!1,ce=1,ye=1,Se=[0],fe=I,ge=I,Te=I,le=I,ve=I;function Me(de){return de.x0=de.y0=0,de.x1=ce,de.y1=ye,de.eachBefore(we),Se=[0],me&&de.eachBefore(j),de}function we(de){var Ie=Se[de.depth],De=de.x0+Ie,Oe=de.y0+Ie,Ve=de.x1-Ie,Fe=de.y1-Ie;Ve<De&&(De=Ve=(De+Ve)/2),Fe<Oe&&(Oe=Fe=(Oe+Fe)/2),de.x0=De,de.y0=Oe,de.x1=Ve,de.y1=Fe,de.children&&(Ie=Se[de.depth+1]=fe(de)/2,De+=ve(de)-Ie,Oe+=ge(de)-Ie,(Ve-=Te(de)-Ie)<De&&(De=Ve=(De+Ve)/2),(Fe-=le(de)-Ie)<Oe&&(Oe=Fe=(Oe+Fe)/2),oe(de,De,Oe,Ve,Fe))}return Me.round=function(de){return arguments.length?(me=!!de,Me):me},Me.size=function(de){return arguments.length?(ce=+de[0],ye=+de[1],Me):[ce,ye]},Me.tile=function(de){return arguments.length?(oe=A(de),Me):oe},Me.padding=function(de){return arguments.length?Me.paddingInner(de).paddingOuter(de):Me.paddingInner()},Me.paddingInner=function(de){return arguments.length?(fe=typeof de=="function"?de:P(+de),Me):fe},Me.paddingOuter=function(de){return arguments.length?Me.paddingTop(de).paddingRight(de).paddingBottom(de).paddingLeft(de):Me.paddingTop()},Me.paddingTop=function(de){return arguments.length?(ge=typeof de=="function"?de:P(+de),Me):ge},Me.paddingRight=function(de){return arguments.length?(Te=typeof de=="function"?de:P(+de),Me):Te},Me.paddingBottom=function(de){return arguments.length?(le=typeof de=="function"?de:P(+de),Me):le},Me.paddingLeft=function(de){return arguments.length?(ve=typeof de=="function"?de:P(+de),Me):ve},Me},d.treemapBinary=function(oe,me,ce,ye,Se){var fe,ge,Te=oe.children,le=Te.length,ve=new Array(le+1);for(ve[0]=ge=fe=0;fe<le;++fe)ve[fe+1]=ge+=Te[fe].value;(function Me(we,de,Ie,De,Oe,Ve,Fe){if(we>=de-1){var ze=Te[we];return ze.x0=De,ze.y0=Oe,ze.x1=Ve,void(ze.y1=Fe)}for(var Re=ve[we],We=Ie/2+Re,$e=we+1,at=de-1;$e<at;){var gt=$e+at>>>1;ve[gt]<We?$e=gt+1:at=gt}We-ve[$e-1]<ve[$e]-We&&we+1<$e&&--$e;var xt=ve[$e]-Re,mt=Ie-xt;if(Ve-De>Fe-Oe){var nt=(De*mt+Ve*xt)/Ie;Me(we,$e,xt,De,Oe,nt,Fe),Me($e,de,mt,nt,Oe,Ve,Fe)}else{var Qe=(Oe*mt+Fe*xt)/Ie;Me(we,$e,xt,De,Oe,Ve,Qe),Me($e,de,mt,De,Qe,Ve,Fe)}})(0,le,oe.value,me,ce,ye,Se)},d.treemapDice=V,d.treemapResquarify=se,d.treemapSlice=K,d.treemapSliceDice=function(oe,me,ce,ye,Se){(1&oe.depth?K:V)(oe,me,ce,ye,Se)},d.treemapSquarify=ne,Object.defineProperty(d,"__esModule",{value:!0})})},{}],116:[function(m,G,Y){(function(d,v){typeof Y=="object"&&G!==void 0?v(Y,m("d3-color")):v((d=d||self).d3=d.d3||{},d.d3)})(this,function(d,v){function w(J,ee,ne,se,oe){var me=J*J,ce=me*J;return((1-3*J+3*me-ce)*ee+(4-6*me+3*ce)*ne+(1+3*J+3*me-3*ce)*se+ce*oe)/6}function y(J){var ee=J.length-1;return function(ne){var se=ne<=0?ne=0:ne>=1?(ne=1,ee-1):Math.floor(ne*ee),oe=J[se],me=J[se+1],ce=se>0?J[se-1]:2*oe-me,ye=se<ee-1?J[se+2]:2*me-oe;return w((ne-se/ee)*ee,ce,oe,me,ye)}}function e(J){var ee=J.length;return function(ne){var se=Math.floor(((ne%=1)<0?++ne:ne)*ee),oe=J[(se+ee-1)%ee],me=J[se%ee],ce=J[(se+1)%ee],ye=J[(se+2)%ee];return w((ne-se/ee)*ee,oe,me,ce,ye)}}function t(J){return function(){return J}}function n(J,ee){return function(ne){return J+ne*ee}}function o(J,ee){var ne=ee-J;return ne?n(J,ne>180||ne<-180?ne-360*Math.round(ne/360):ne):t(isNaN(J)?ee:J)}function r(J){return(J=+J)==1?g:function(ee,ne){return ne-ee?function(se,oe,me){return se=Math.pow(se,me),oe=Math.pow(oe,me)-se,me=1/me,function(ce){return Math.pow(se+ce*oe,me)}}(ee,ne,J):t(isNaN(ee)?ne:ee)}}function g(J,ee){var ne=ee-J;return ne?n(J,ne):t(isNaN(J)?ee:J)}var c=function J(ee){var ne=r(ee);function se(oe,me){var ce=ne((oe=v.rgb(oe)).r,(me=v.rgb(me)).r),ye=ne(oe.g,me.g),Se=ne(oe.b,me.b),fe=g(oe.opacity,me.opacity);return function(ge){return oe.r=ce(ge),oe.g=ye(ge),oe.b=Se(ge),oe.opacity=fe(ge),oe+""}}return se.gamma=J,se}(1);function a(J){return function(ee){var ne,se,oe=ee.length,me=new Array(oe),ce=new Array(oe),ye=new Array(oe);for(ne=0;ne<oe;++ne)se=v.rgb(ee[ne]),me[ne]=se.r||0,ce[ne]=se.g||0,ye[ne]=se.b||0;return me=J(me),ce=J(ce),ye=J(ye),se.opacity=1,function(Se){return se.r=me(Se),se.g=ce(Se),se.b=ye(Se),se+""}}}var h=a(y),l=a(e);function s(J,ee){ee||(ee=[]);var ne,se=J?Math.min(ee.length,J.length):0,oe=ee.slice();return function(me){for(ne=0;ne<se;++ne)oe[ne]=J[ne]*(1-me)+ee[ne]*me;return oe}}function p(J){return ArrayBuffer.isView(J)&&!(J instanceof DataView)}function u(J,ee){var ne,se=ee?ee.length:0,oe=J?Math.min(se,J.length):0,me=new Array(oe),ce=new Array(se);for(ne=0;ne<oe;++ne)me[ne]=k(J[ne],ee[ne]);for(;ne<se;++ne)ce[ne]=ee[ne];return function(ye){for(ne=0;ne<oe;++ne)ce[ne]=me[ne](ye);return ce}}function i(J,ee){var ne=new Date;return J=+J,ee=+ee,function(se){return ne.setTime(J*(1-se)+ee*se),ne}}function x(J,ee){return J=+J,ee=+ee,function(ne){return J*(1-ne)+ee*ne}}function f(J,ee){var ne,se={},oe={};for(ne in J!==null&&typeof J=="object"||(J={}),ee!==null&&typeof ee=="object"||(ee={}),ee)ne in J?se[ne]=k(J[ne],ee[ne]):oe[ne]=ee[ne];return function(me){for(ne in se)oe[ne]=se[ne](me);return oe}}var _=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,b=new RegExp(_.source,"g");function T(J,ee){var ne,se,oe,me=_.lastIndex=b.lastIndex=0,ce=-1,ye=[],Se=[];for(J+="",ee+="";(ne=_.exec(J))&&(se=b.exec(ee));)(oe=se.index)>me&&(oe=ee.slice(me,oe),ye[ce]?ye[ce]+=oe:ye[++ce]=oe),(ne=ne[0])===(se=se[0])?ye[ce]?ye[ce]+=se:ye[++ce]=se:(ye[++ce]=null,Se.push({i:ce,x:x(ne,se)})),me=b.lastIndex;return me<ee.length&&(oe=ee.slice(me),ye[ce]?ye[ce]+=oe:ye[++ce]=oe),ye.length<2?Se[0]?function(fe){return function(ge){return fe(ge)+""}}(Se[0].x):function(fe){return function(){return fe}}(ee):(ee=Se.length,function(fe){for(var ge,Te=0;Te<ee;++Te)ye[(ge=Se[Te]).i]=ge.x(fe);return ye.join("")})}function k(J,ee){var ne,se=typeof ee;return ee==null||se==="boolean"?t(ee):(se==="number"?x:se==="string"?(ne=v.color(ee))?(ee=ne,c):T:ee instanceof v.color?c:ee instanceof Date?i:p(ee)?s:Array.isArray(ee)?u:typeof ee.valueOf!="function"&&typeof ee.toString!="function"||isNaN(ee)?f:x)(J,ee)}var L,A,I,P,S=180/Math.PI,E={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function z(J,ee,ne,se,oe,me){var ce,ye,Se;return(ce=Math.sqrt(J*J+ee*ee))&&(J/=ce,ee/=ce),(Se=J*ne+ee*se)&&(ne-=J*Se,se-=ee*Se),(ye=Math.sqrt(ne*ne+se*se))&&(ne/=ye,se/=ye,Se/=ye),J*se<ee*ne&&(J=-J,ee=-ee,Se=-Se,ce=-ce),{translateX:oe,translateY:me,rotate:Math.atan2(ee,J)*S,skewX:Math.atan(Se)*S,scaleX:ce,scaleY:ye}}function D(J,ee,ne,se){function oe(me){return me.length?me.pop()+" ":""}return function(me,ce){var ye=[],Se=[];return me=J(me),ce=J(ce),function(fe,ge,Te,le,ve,Me){if(fe!==Te||ge!==le){var we=ve.push("translate(",null,ee,null,ne);Me.push({i:we-4,x:x(fe,Te)},{i:we-2,x:x(ge,le)})}else(Te||le)&&ve.push("translate("+Te+ee+le+ne)}(me.translateX,me.translateY,ce.translateX,ce.translateY,ye,Se),function(fe,ge,Te,le){fe!==ge?(fe-ge>180?ge+=360:ge-fe>180&&(fe+=360),le.push({i:Te.push(oe(Te)+"rotate(",null,se)-2,x:x(fe,ge)})):ge&&Te.push(oe(Te)+"rotate("+ge+se)}(me.rotate,ce.rotate,ye,Se),function(fe,ge,Te,le){fe!==ge?le.push({i:Te.push(oe(Te)+"skewX(",null,se)-2,x:x(fe,ge)}):ge&&Te.push(oe(Te)+"skewX("+ge+se)}(me.skewX,ce.skewX,ye,Se),function(fe,ge,Te,le,ve,Me){if(fe!==Te||ge!==le){var we=ve.push(oe(ve)+"scale(",null,",",null,")");Me.push({i:we-4,x:x(fe,Te)},{i:we-2,x:x(ge,le)})}else Te===1&&le===1||ve.push(oe(ve)+"scale("+Te+","+le+")")}(me.scaleX,me.scaleY,ce.scaleX,ce.scaleY,ye,Se),me=ce=null,function(fe){for(var ge,Te=-1,le=Se.length;++Te<le;)ye[(ge=Se[Te]).i]=ge.x(fe);return ye.join("")}}}var j=D(function(J){return J==="none"?E:(L||(L=document.createElement("DIV"),A=document.documentElement,I=document.defaultView),L.style.transform=J,J=I.getComputedStyle(A.appendChild(L),null).getPropertyValue("transform"),A.removeChild(L),z(+(J=J.slice(7,-1).split(","))[0],+J[1],+J[2],+J[3],+J[4],+J[5]))},"px, ","px)","deg)"),V=D(function(J){return J==null?E:(P||(P=document.createElementNS("http://www.w3.org/2000/svg","g")),P.setAttribute("transform",J),(J=P.transform.baseVal.consolidate())?z((J=J.matrix).a,J.b,J.c,J.d,J.e,J.f):E)},", ",")",")"),Z=Math.SQRT2;function Q(J){return((J=Math.exp(J))+1/J)/2}function X(J){return function(ee,ne){var se=J((ee=v.hsl(ee)).h,(ne=v.hsl(ne)).h),oe=g(ee.s,ne.s),me=g(ee.l,ne.l),ce=g(ee.opacity,ne.opacity);return function(ye){return ee.h=se(ye),ee.s=oe(ye),ee.l=me(ye),ee.opacity=ce(ye),ee+""}}}var $=X(o),re=X(g);function H(J){return function(ee,ne){var se=J((ee=v.hcl(ee)).h,(ne=v.hcl(ne)).h),oe=g(ee.c,ne.c),me=g(ee.l,ne.l),ce=g(ee.opacity,ne.opacity);return function(ye){return ee.h=se(ye),ee.c=oe(ye),ee.l=me(ye),ee.opacity=ce(ye),ee+""}}}var N=H(o),U=H(g);function te(J){return function ee(ne){function se(oe,me){var ce=J((oe=v.cubehelix(oe)).h,(me=v.cubehelix(me)).h),ye=g(oe.s,me.s),Se=g(oe.l,me.l),fe=g(oe.opacity,me.opacity);return function(ge){return oe.h=ce(ge),oe.s=ye(ge),oe.l=Se(Math.pow(ge,ne)),oe.opacity=fe(ge),oe+""}}return ne=+ne,se.gamma=ee,se}(1)}var B=te(o),K=te(g);d.interpolate=k,d.interpolateArray=function(J,ee){return(p(ee)?s:u)(J,ee)},d.interpolateBasis=y,d.interpolateBasisClosed=e,d.interpolateCubehelix=B,d.interpolateCubehelixLong=K,d.interpolateDate=i,d.interpolateDiscrete=function(J){var ee=J.length;return function(ne){return J[Math.max(0,Math.min(ee-1,Math.floor(ne*ee)))]}},d.interpolateHcl=N,d.interpolateHclLong=U,d.interpolateHsl=$,d.interpolateHslLong=re,d.interpolateHue=function(J,ee){var ne=o(+J,+ee);return function(se){var oe=ne(se);return oe-360*Math.floor(oe/360)}},d.interpolateLab=function(J,ee){var ne=g((J=v.lab(J)).l,(ee=v.lab(ee)).l),se=g(J.a,ee.a),oe=g(J.b,ee.b),me=g(J.opacity,ee.opacity);return function(ce){return J.l=ne(ce),J.a=se(ce),J.b=oe(ce),J.opacity=me(ce),J+""}},d.interpolateNumber=x,d.interpolateNumberArray=s,d.interpolateObject=f,d.interpolateRgb=c,d.interpolateRgbBasis=h,d.interpolateRgbBasisClosed=l,d.interpolateRound=function(J,ee){return J=+J,ee=+ee,function(ne){return Math.round(J*(1-ne)+ee*ne)}},d.interpolateString=T,d.interpolateTransformCss=j,d.interpolateTransformSvg=V,d.interpolateZoom=function(J,ee){var ne,se,oe=J[0],me=J[1],ce=J[2],ye=ee[0],Se=ee[1],fe=ee[2],ge=ye-oe,Te=Se-me,le=ge*ge+Te*Te;if(le<1e-12)se=Math.log(fe/ce)/Z,ne=function(De){return[oe+De*ge,me+De*Te,ce*Math.exp(Z*De*se)]};else{var ve=Math.sqrt(le),Me=(fe*fe-ce*ce+4*le)/(2*ce*2*ve),we=(fe*fe-ce*ce-4*le)/(2*fe*2*ve),de=Math.log(Math.sqrt(Me*Me+1)-Me),Ie=Math.log(Math.sqrt(we*we+1)-we);se=(Ie-de)/Z,ne=function(De){var Oe,Ve=De*se,Fe=Q(de),ze=ce/(2*ve)*(Fe*(Oe=Z*Ve+de,((Oe=Math.exp(2*Oe))-1)/(Oe+1))-function(Re){return((Re=Math.exp(Re))-1/Re)/2}(de));return[oe+ze*ge,me+ze*Te,ce*Fe/Q(Z*Ve+de)]}}return ne.duration=1e3*se,ne},d.piecewise=function(J,ee){for(var ne=0,se=ee.length-1,oe=ee[0],me=new Array(se<0?0:se);ne<se;)me[ne]=J(oe,oe=ee[++ne]);return function(ce){var ye=Math.max(0,Math.min(se-1,Math.floor(ce*=se)));return me[ye](ce-ye)}},d.quantize=function(J,ee){for(var ne=new Array(ee),se=0;se<ee;++se)ne[se]=J(se/(ee-1));return ne},Object.defineProperty(d,"__esModule",{value:!0})})},{"d3-color":109}],117:[function(m,G,Y){(function(d,v){v(typeof Y=="object"&&G!==void 0?Y:(d=d||self).d3=d.d3||{})})(this,function(d){var v=Math.PI,w=2*v,y=w-1e-6;function e(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function t(){return new e}e.prototype=t.prototype={constructor:e,moveTo:function(n,o){this._+="M"+(this._x0=this._x1=+n)+","+(this._y0=this._y1=+o)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(n,o){this._+="L"+(this._x1=+n)+","+(this._y1=+o)},quadraticCurveTo:function(n,o,r,g){this._+="Q"+ +n+","+ +o+","+(this._x1=+r)+","+(this._y1=+g)},bezierCurveTo:function(n,o,r,g,c,a){this._+="C"+ +n+","+ +o+","+ +r+","+ +g+","+(this._x1=+c)+","+(this._y1=+a)},arcTo:function(n,o,r,g,c){n=+n,o=+o,r=+r,g=+g,c=+c;var a=this._x1,h=this._y1,l=r-n,s=g-o,p=a-n,u=h-o,i=p*p+u*u;if(c<0)throw new Error("negative radius: "+c);if(this._x1===null)this._+="M"+(this._x1=n)+","+(this._y1=o);else if(i>1e-6)if(Math.abs(u*l-s*p)>1e-6&&c){var x=r-a,f=g-h,_=l*l+s*s,b=x*x+f*f,T=Math.sqrt(_),k=Math.sqrt(i),L=c*Math.tan((v-Math.acos((_+i-b)/(2*T*k)))/2),A=L/k,I=L/T;Math.abs(A-1)>1e-6&&(this._+="L"+(n+A*p)+","+(o+A*u)),this._+="A"+c+","+c+",0,0,"+ +(u*x>p*f)+","+(this._x1=n+I*l)+","+(this._y1=o+I*s)}else this._+="L"+(this._x1=n)+","+(this._y1=o)},arc:function(n,o,r,g,c,a){n=+n,o=+o,a=!!a;var h=(r=+r)*Math.cos(g),l=r*Math.sin(g),s=n+h,p=o+l,u=1^a,i=a?g-c:c-g;if(r<0)throw new Error("negative radius: "+r);this._x1===null?this._+="M"+s+","+p:(Math.abs(this._x1-s)>1e-6||Math.abs(this._y1-p)>1e-6)&&(this._+="L"+s+","+p),r&&(i<0&&(i=i%w+w),i>y?this._+="A"+r+","+r+",0,1,"+u+","+(n-h)+","+(o-l)+"A"+r+","+r+",0,1,"+u+","+(this._x1=s)+","+(this._y1=p):i>1e-6&&(this._+="A"+r+","+r+",0,"+ +(i>=v)+","+u+","+(this._x1=n+r*Math.cos(c))+","+(this._y1=o+r*Math.sin(c))))},rect:function(n,o,r,g){this._+="M"+(this._x0=this._x1=+n)+","+(this._y0=this._y1=+o)+"h"+ +r+"v"+ +g+"h"+-r+"Z"},toString:function(){return this._}},d.path=t,Object.defineProperty(d,"__esModule",{value:!0})})},{}],118:[function(m,G,Y){(function(d,v){v(typeof Y=="object"&&G!==void 0?Y:(d=d||self).d3=d.d3||{})})(this,function(d){function v(g,c,a,h){if(isNaN(c)||isNaN(a))return g;var l,s,p,u,i,x,f,_,b,T=g._root,k={data:h},L=g._x0,A=g._y0,I=g._x1,P=g._y1;if(!T)return g._root=k,g;for(;T.length;)if((x=c>=(s=(L+I)/2))?L=s:I=s,(f=a>=(p=(A+P)/2))?A=p:P=p,l=T,!(T=T[_=f<<1|x]))return l[_]=k,g;if(u=+g._x.call(null,T.data),i=+g._y.call(null,T.data),c===u&&a===i)return k.next=T,l?l[_]=k:g._root=k,g;do l=l?l[_]=new Array(4):g._root=new Array(4),(x=c>=(s=(L+I)/2))?L=s:I=s,(f=a>=(p=(A+P)/2))?A=p:P=p;while((_=f<<1|x)==(b=(i>=p)<<1|u>=s));return l[b]=T,l[_]=k,g}function w(g,c,a,h,l){this.node=g,this.x0=c,this.y0=a,this.x1=h,this.y1=l}function y(g){return g[0]}function e(g){return g[1]}function t(g,c,a){var h=new n(c==null?y:c,a==null?e:a,NaN,NaN,NaN,NaN);return g==null?h:h.addAll(g)}function n(g,c,a,h,l,s){this._x=g,this._y=c,this._x0=a,this._y0=h,this._x1=l,this._y1=s,this._root=void 0}function o(g){for(var c={data:g.data},a=c;g=g.next;)a=a.next={data:g.data};return c}var r=t.prototype=n.prototype;r.copy=function(){var g,c,a=new n(this._x,this._y,this._x0,this._y0,this._x1,this._y1),h=this._root;if(!h)return a;if(!h.length)return a._root=o(h),a;for(g=[{source:h,target:a._root=new Array(4)}];h=g.pop();)for(var l=0;l<4;++l)(c=h.source[l])&&(c.length?g.push({source:c,target:h.target[l]=new Array(4)}):h.target[l]=o(c));return a},r.add=function(g){var c=+this._x.call(null,g),a=+this._y.call(null,g);return v(this.cover(c,a),c,a,g)},r.addAll=function(g){var c,a,h,l,s=g.length,p=new Array(s),u=new Array(s),i=1/0,x=1/0,f=-1/0,_=-1/0;for(a=0;a<s;++a)isNaN(h=+this._x.call(null,c=g[a]))||isNaN(l=+this._y.call(null,c))||(p[a]=h,u[a]=l,h<i&&(i=h),h>f&&(f=h),l<x&&(x=l),l>_&&(_=l));if(i>f||x>_)return this;for(this.cover(i,x).cover(f,_),a=0;a<s;++a)v(this,p[a],u[a],g[a]);return this},r.cover=function(g,c){if(isNaN(g=+g)||isNaN(c=+c))return this;var a=this._x0,h=this._y0,l=this._x1,s=this._y1;if(isNaN(a))l=(a=Math.floor(g))+1,s=(h=Math.floor(c))+1;else{for(var p,u,i=l-a,x=this._root;a>g||g>=l||h>c||c>=s;)switch(u=(c<h)<<1|g<a,(p=new Array(4))[u]=x,x=p,i*=2,u){case 0:l=a+i,s=h+i;break;case 1:a=l-i,s=h+i;break;case 2:l=a+i,h=s-i;break;case 3:a=l-i,h=s-i}this._root&&this._root.length&&(this._root=x)}return this._x0=a,this._y0=h,this._x1=l,this._y1=s,this},r.data=function(){var g=[];return this.visit(function(c){if(!c.length)do g.push(c.data);while(c=c.next)}),g},r.extent=function(g){return arguments.length?this.cover(+g[0][0],+g[0][1]).cover(+g[1][0],+g[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},r.find=function(g,c,a){var h,l,s,p,u,i,x,f=this._x0,_=this._y0,b=this._x1,T=this._y1,k=[],L=this._root;for(L&&k.push(new w(L,f,_,b,T)),a==null?a=1/0:(f=g-a,_=c-a,b=g+a,T=c+a,a*=a);i=k.pop();)if(!(!(L=i.node)||(l=i.x0)>b||(s=i.y0)>T||(p=i.x1)<f||(u=i.y1)<_))if(L.length){var A=(l+p)/2,I=(s+u)/2;k.push(new w(L[3],A,I,p,u),new w(L[2],l,I,A,u),new w(L[1],A,s,p,I),new w(L[0],l,s,A,I)),(x=(c>=I)<<1|g>=A)&&(i=k[k.length-1],k[k.length-1]=k[k.length-1-x],k[k.length-1-x]=i)}else{var P=g-+this._x.call(null,L.data),S=c-+this._y.call(null,L.data),E=P*P+S*S;if(E<a){var z=Math.sqrt(a=E);f=g-z,_=c-z,b=g+z,T=c+z,h=L.data}}return h},r.remove=function(g){if(isNaN(s=+this._x.call(null,g))||isNaN(p=+this._y.call(null,g)))return this;var c,a,h,l,s,p,u,i,x,f,_,b,T=this._root,k=this._x0,L=this._y0,A=this._x1,I=this._y1;if(!T)return this;if(T.length)for(;;){if((x=s>=(u=(k+A)/2))?k=u:A=u,(f=p>=(i=(L+I)/2))?L=i:I=i,c=T,!(T=T[_=f<<1|x]))return this;if(!T.length)break;(c[_+1&3]||c[_+2&3]||c[_+3&3])&&(a=c,b=_)}for(;T.data!==g;)if(h=T,!(T=T.next))return this;return(l=T.next)&&delete T.next,h?(l?h.next=l:delete h.next,this):c?(l?c[_]=l:delete c[_],(T=c[0]||c[1]||c[2]||c[3])&&T===(c[3]||c[2]||c[1]||c[0])&&!T.length&&(a?a[b]=T:this._root=T),this):(this._root=l,this)},r.removeAll=function(g){for(var c=0,a=g.length;c<a;++c)this.remove(g[c]);return this},r.root=function(){return this._root},r.size=function(){var g=0;return this.visit(function(c){if(!c.length)do++g;while(c=c.next)}),g},r.visit=function(g){var c,a,h,l,s,p,u=[],i=this._root;for(i&&u.push(new w(i,this._x0,this._y0,this._x1,this._y1));c=u.pop();)if(!g(i=c.node,h=c.x0,l=c.y0,s=c.x1,p=c.y1)&&i.length){var x=(h+s)/2,f=(l+p)/2;(a=i[3])&&u.push(new w(a,x,f,s,p)),(a=i[2])&&u.push(new w(a,h,f,x,p)),(a=i[1])&&u.push(new w(a,x,l,s,f)),(a=i[0])&&u.push(new w(a,h,l,x,f))}return this},r.visitAfter=function(g){var c,a=[],h=[];for(this._root&&a.push(new w(this._root,this._x0,this._y0,this._x1,this._y1));c=a.pop();){var l=c.node;if(l.length){var s,p=c.x0,u=c.y0,i=c.x1,x=c.y1,f=(p+i)/2,_=(u+x)/2;(s=l[0])&&a.push(new w(s,p,u,f,_)),(s=l[1])&&a.push(new w(s,f,u,i,_)),(s=l[2])&&a.push(new w(s,p,_,f,x)),(s=l[3])&&a.push(new w(s,f,_,i,x))}h.push(c)}for(;c=h.pop();)g(c.node,c.x0,c.y0,c.x1,c.y1);return this},r.x=function(g){return arguments.length?(this._x=g,this):this._x},r.y=function(g){return arguments.length?(this._y=g,this):this._y},d.quadtree=t,Object.defineProperty(d,"__esModule",{value:!0})})},{}],119:[function(m,G,Y){(function(d,v){typeof Y=="object"&&G!==void 0?v(Y,m("d3-path")):v((d=d||self).d3=d.d3||{},d.d3)})(this,function(d,v){function w(Le){return function(){return Le}}var y=Math.abs,e=Math.atan2,t=Math.cos,n=Math.max,o=Math.min,r=Math.sin,g=Math.sqrt,c=Math.PI,a=c/2,h=2*c;function l(Le){return Le>1?0:Le<-1?c:Math.acos(Le)}function s(Le){return Le>=1?a:Le<=-1?-a:Math.asin(Le)}function p(Le){return Le.innerRadius}function u(Le){return Le.outerRadius}function i(Le){return Le.startAngle}function x(Le){return Le.endAngle}function f(Le){return Le&&Le.padAngle}function _(Le,Xe,ot,pt,St,Vt,Jt,qt){var gr=ot-Le,Cr=pt-Xe,mr=Jt-St,tr=qt-Vt,nr=tr*gr-mr*Cr;if(!(nr*nr<1e-12))return[Le+(nr=(mr*(Xe-Vt)-tr*(Le-St))/nr)*gr,Xe+nr*Cr]}function b(Le,Xe,ot,pt,St,Vt,Jt){var qt=Le-ot,gr=Xe-pt,Cr=(Jt?Vt:-Vt)/g(qt*qt+gr*gr),mr=Cr*gr,tr=-Cr*qt,nr=Le+mr,Qt=Xe+tr,dr=ot+mr,_r=pt+tr,Ir=(nr+dr)/2,Rr=(Qt+_r)/2,Vr=dr-nr,Xr=_r-Qt,cn=Vr*Vr+Xr*Xr,an=St-Vt,zn=nr*_r-dr*Qt,on=(Xr<0?-1:1)*g(n(0,an*an*cn-zn*zn)),Tn=(zn*Xr-Vr*on)/cn,Mn=(-zn*Vr-Xr*on)/cn,ei=(zn*Xr+Vr*on)/cn,Hr=(-zn*Vr+Xr*on)/cn,ln=Tn-Ir,bn=Mn-Rr,nn=ei-Ir,pn=Hr-Rr;return ln*ln+bn*bn>nn*nn+pn*pn&&(Tn=ei,Mn=Hr),{cx:Tn,cy:Mn,x01:-mr,y01:-tr,x11:Tn*(St/an-1),y11:Mn*(St/an-1)}}function T(Le){this._context=Le}function k(Le){return new T(Le)}function L(Le){return Le[0]}function A(Le){return Le[1]}function I(){var Le=L,Xe=A,ot=w(!0),pt=null,St=k,Vt=null;function Jt(qt){var gr,Cr,mr,tr=qt.length,nr=!1;for(pt==null&&(Vt=St(mr=v.path())),gr=0;gr<=tr;++gr)!(gr<tr&&ot(Cr=qt[gr],gr,qt))===nr&&((nr=!nr)?Vt.lineStart():Vt.lineEnd()),nr&&Vt.point(+Le(Cr,gr,qt),+Xe(Cr,gr,qt));if(mr)return Vt=null,mr+""||null}return Jt.x=function(qt){return arguments.length?(Le=typeof qt=="function"?qt:w(+qt),Jt):Le},Jt.y=function(qt){return arguments.length?(Xe=typeof qt=="function"?qt:w(+qt),Jt):Xe},Jt.defined=function(qt){return arguments.length?(ot=typeof qt=="function"?qt:w(!!qt),Jt):ot},Jt.curve=function(qt){return arguments.length?(St=qt,pt!=null&&(Vt=St(pt)),Jt):St},Jt.context=function(qt){return arguments.length?(qt==null?pt=Vt=null:Vt=St(pt=qt),Jt):pt},Jt}function P(){var Le=L,Xe=null,ot=w(0),pt=A,St=w(!0),Vt=null,Jt=k,qt=null;function gr(mr){var tr,nr,Qt,dr,_r,Ir=mr.length,Rr=!1,Vr=new Array(Ir),Xr=new Array(Ir);for(Vt==null&&(qt=Jt(_r=v.path())),tr=0;tr<=Ir;++tr){if(!(tr<Ir&&St(dr=mr[tr],tr,mr))===Rr)if(Rr=!Rr)nr=tr,qt.areaStart(),qt.lineStart();else{for(qt.lineEnd(),qt.lineStart(),Qt=tr-1;Qt>=nr;--Qt)qt.point(Vr[Qt],Xr[Qt]);qt.lineEnd(),qt.areaEnd()}Rr&&(Vr[tr]=+Le(dr,tr,mr),Xr[tr]=+ot(dr,tr,mr),qt.point(Xe?+Xe(dr,tr,mr):Vr[tr],pt?+pt(dr,tr,mr):Xr[tr]))}if(_r)return qt=null,_r+""||null}function Cr(){return I().defined(St).curve(Jt).context(Vt)}return gr.x=function(mr){return arguments.length?(Le=typeof mr=="function"?mr:w(+mr),Xe=null,gr):Le},gr.x0=function(mr){return arguments.length?(Le=typeof mr=="function"?mr:w(+mr),gr):Le},gr.x1=function(mr){return arguments.length?(Xe=mr==null?null:typeof mr=="function"?mr:w(+mr),gr):Xe},gr.y=function(mr){return arguments.length?(ot=typeof mr=="function"?mr:w(+mr),pt=null,gr):ot},gr.y0=function(mr){return arguments.length?(ot=typeof mr=="function"?mr:w(+mr),gr):ot},gr.y1=function(mr){return arguments.length?(pt=mr==null?null:typeof mr=="function"?mr:w(+mr),gr):pt},gr.lineX0=gr.lineY0=function(){return Cr().x(Le).y(ot)},gr.lineY1=function(){return Cr().x(Le).y(pt)},gr.lineX1=function(){return Cr().x(Xe).y(ot)},gr.defined=function(mr){return arguments.length?(St=typeof mr=="function"?mr:w(!!mr),gr):St},gr.curve=function(mr){return arguments.length?(Jt=mr,Vt!=null&&(qt=Jt(Vt)),gr):Jt},gr.context=function(mr){return arguments.length?(mr==null?Vt=qt=null:qt=Jt(Vt=mr),gr):Vt},gr}function S(Le,Xe){return Xe<Le?-1:Xe>Le?1:Xe>=Le?0:NaN}function E(Le){return Le}T.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Le,Xe){switch(Le=+Le,Xe=+Xe,this._point){case 0:this._point=1,this._line?this._context.lineTo(Le,Xe):this._context.moveTo(Le,Xe);break;case 1:this._point=2;default:this._context.lineTo(Le,Xe)}}};var z=j(k);function D(Le){this._curve=Le}function j(Le){function Xe(ot){return new D(Le(ot))}return Xe._curve=Le,Xe}function V(Le){var Xe=Le.curve;return Le.angle=Le.x,delete Le.x,Le.radius=Le.y,delete Le.y,Le.curve=function(ot){return arguments.length?Xe(j(ot)):Xe()._curve},Le}function Z(){return V(I().curve(z))}function Q(){var Le=P().curve(z),Xe=Le.curve,ot=Le.lineX0,pt=Le.lineX1,St=Le.lineY0,Vt=Le.lineY1;return Le.angle=Le.x,delete Le.x,Le.startAngle=Le.x0,delete Le.x0,Le.endAngle=Le.x1,delete Le.x1,Le.radius=Le.y,delete Le.y,Le.innerRadius=Le.y0,delete Le.y0,Le.outerRadius=Le.y1,delete Le.y1,Le.lineStartAngle=function(){return V(ot())},delete Le.lineX0,Le.lineEndAngle=function(){return V(pt())},delete Le.lineX1,Le.lineInnerRadius=function(){return V(St())},delete Le.lineY0,Le.lineOuterRadius=function(){return V(Vt())},delete Le.lineY1,Le.curve=function(Jt){return arguments.length?Xe(j(Jt)):Xe()._curve},Le}function X(Le,Xe){return[(Xe=+Xe)*Math.cos(Le-=Math.PI/2),Xe*Math.sin(Le)]}D.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(Le,Xe){this._curve.point(Xe*Math.sin(Le),Xe*-Math.cos(Le))}};var $=Array.prototype.slice;function re(Le){return Le.source}function H(Le){return Le.target}function N(Le){var Xe=re,ot=H,pt=L,St=A,Vt=null;function Jt(){var qt,gr=$.call(arguments),Cr=Xe.apply(this,gr),mr=ot.apply(this,gr);if(Vt||(Vt=qt=v.path()),Le(Vt,+pt.apply(this,(gr[0]=Cr,gr)),+St.apply(this,gr),+pt.apply(this,(gr[0]=mr,gr)),+St.apply(this,gr)),qt)return Vt=null,qt+""||null}return Jt.source=function(qt){return arguments.length?(Xe=qt,Jt):Xe},Jt.target=function(qt){return arguments.length?(ot=qt,Jt):ot},Jt.x=function(qt){return arguments.length?(pt=typeof qt=="function"?qt:w(+qt),Jt):pt},Jt.y=function(qt){return arguments.length?(St=typeof qt=="function"?qt:w(+qt),Jt):St},Jt.context=function(qt){return arguments.length?(Vt=qt==null?null:qt,Jt):Vt},Jt}function U(Le,Xe,ot,pt,St){Le.moveTo(Xe,ot),Le.bezierCurveTo(Xe=(Xe+pt)/2,ot,Xe,St,pt,St)}function te(Le,Xe,ot,pt,St){Le.moveTo(Xe,ot),Le.bezierCurveTo(Xe,ot=(ot+St)/2,pt,ot,pt,St)}function B(Le,Xe,ot,pt,St){var Vt=X(Xe,ot),Jt=X(Xe,ot=(ot+St)/2),qt=X(pt,ot),gr=X(pt,St);Le.moveTo(Vt[0],Vt[1]),Le.bezierCurveTo(Jt[0],Jt[1],qt[0],qt[1],gr[0],gr[1])}var K={draw:function(Le,Xe){var ot=Math.sqrt(Xe/c);Le.moveTo(ot,0),Le.arc(0,0,ot,0,h)}},J={draw:function(Le,Xe){var ot=Math.sqrt(Xe/5)/2;Le.moveTo(-3*ot,-ot),Le.lineTo(-ot,-ot),Le.lineTo(-ot,-3*ot),Le.lineTo(ot,-3*ot),Le.lineTo(ot,-ot),Le.lineTo(3*ot,-ot),Le.lineTo(3*ot,ot),Le.lineTo(ot,ot),Le.lineTo(ot,3*ot),Le.lineTo(-ot,3*ot),Le.lineTo(-ot,ot),Le.lineTo(-3*ot,ot),Le.closePath()}},ee=Math.sqrt(1/3),ne=2*ee,se={draw:function(Le,Xe){var ot=Math.sqrt(Xe/ne),pt=ot*ee;Le.moveTo(0,-ot),Le.lineTo(pt,0),Le.lineTo(0,ot),Le.lineTo(-pt,0),Le.closePath()}},oe=Math.sin(c/10)/Math.sin(7*c/10),me=Math.sin(h/10)*oe,ce=-Math.cos(h/10)*oe,ye={draw:function(Le,Xe){var ot=Math.sqrt(.8908130915292852*Xe),pt=me*ot,St=ce*ot;Le.moveTo(0,-ot),Le.lineTo(pt,St);for(var Vt=1;Vt<5;++Vt){var Jt=h*Vt/5,qt=Math.cos(Jt),gr=Math.sin(Jt);Le.lineTo(gr*ot,-qt*ot),Le.lineTo(qt*pt-gr*St,gr*pt+qt*St)}Le.closePath()}},Se={draw:function(Le,Xe){var ot=Math.sqrt(Xe),pt=-ot/2;Le.rect(pt,pt,ot,ot)}},fe=Math.sqrt(3),ge={draw:function(Le,Xe){var ot=-Math.sqrt(Xe/(3*fe));Le.moveTo(0,2*ot),Le.lineTo(-fe*ot,-ot),Le.lineTo(fe*ot,-ot),Le.closePath()}},Te=-.5,le=Math.sqrt(3)/2,ve=1/Math.sqrt(12),Me=3*(ve/2+1),we={draw:function(Le,Xe){var ot=Math.sqrt(Xe/Me),pt=ot/2,St=ot*ve,Vt=pt,Jt=ot*ve+ot,qt=-Vt,gr=Jt;Le.moveTo(pt,St),Le.lineTo(Vt,Jt),Le.lineTo(qt,gr),Le.lineTo(Te*pt-le*St,le*pt+Te*St),Le.lineTo(Te*Vt-le*Jt,le*Vt+Te*Jt),Le.lineTo(Te*qt-le*gr,le*qt+Te*gr),Le.lineTo(Te*pt+le*St,Te*St-le*pt),Le.lineTo(Te*Vt+le*Jt,Te*Jt-le*Vt),Le.lineTo(Te*qt+le*gr,Te*gr-le*qt),Le.closePath()}},de=[K,J,se,Se,ye,ge,we];function Ie(){}function De(Le,Xe,ot){Le._context.bezierCurveTo((2*Le._x0+Le._x1)/3,(2*Le._y0+Le._y1)/3,(Le._x0+2*Le._x1)/3,(Le._y0+2*Le._y1)/3,(Le._x0+4*Le._x1+Xe)/6,(Le._y0+4*Le._y1+ot)/6)}function Oe(Le){this._context=Le}function Ve(Le){this._context=Le}function Fe(Le){this._context=Le}function ze(Le,Xe){this._basis=new Oe(Le),this._beta=Xe}Oe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:De(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Le,Xe){switch(Le=+Le,Xe=+Xe,this._point){case 0:this._point=1,this._line?this._context.lineTo(Le,Xe):this._context.moveTo(Le,Xe);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:De(this,Le,Xe)}this._x0=this._x1,this._x1=Le,this._y0=this._y1,this._y1=Xe}},Ve.prototype={areaStart:Ie,areaEnd:Ie,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(Le,Xe){switch(Le=+Le,Xe=+Xe,this._point){case 0:this._point=1,this._x2=Le,this._y2=Xe;break;case 1:this._point=2,this._x3=Le,this._y3=Xe;break;case 2:this._point=3,this._x4=Le,this._y4=Xe,this._context.moveTo((this._x0+4*this._x1+Le)/6,(this._y0+4*this._y1+Xe)/6);break;default:De(this,Le,Xe)}this._x0=this._x1,this._x1=Le,this._y0=this._y1,this._y1=Xe}},Fe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Le,Xe){switch(Le=+Le,Xe=+Xe,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var ot=(this._x0+4*this._x1+Le)/6,pt=(this._y0+4*this._y1+Xe)/6;this._line?this._context.lineTo(ot,pt):this._context.moveTo(ot,pt);break;case 3:this._point=4;default:De(this,Le,Xe)}this._x0=this._x1,this._x1=Le,this._y0=this._y1,this._y1=Xe}},ze.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var Le=this._x,Xe=this._y,ot=Le.length-1;if(ot>0)for(var pt,St=Le[0],Vt=Xe[0],Jt=Le[ot]-St,qt=Xe[ot]-Vt,gr=-1;++gr<=ot;)pt=gr/ot,this._basis.point(this._beta*Le[gr]+(1-this._beta)*(St+pt*Jt),this._beta*Xe[gr]+(1-this._beta)*(Vt+pt*qt));this._x=this._y=null,this._basis.lineEnd()},point:function(Le,Xe){this._x.push(+Le),this._y.push(+Xe)}};var Re=function Le(Xe){function ot(pt){return Xe===1?new Oe(pt):new ze(pt,Xe)}return ot.beta=function(pt){return Le(+pt)},ot}(.85);function We(Le,Xe,ot){Le._context.bezierCurveTo(Le._x1+Le._k*(Le._x2-Le._x0),Le._y1+Le._k*(Le._y2-Le._y0),Le._x2+Le._k*(Le._x1-Xe),Le._y2+Le._k*(Le._y1-ot),Le._x2,Le._y2)}function $e(Le,Xe){this._context=Le,this._k=(1-Xe)/6}$e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:We(this,this._x1,this._y1)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Le,Xe){switch(Le=+Le,Xe=+Xe,this._point){case 0:this._point=1,this._line?this._context.lineTo(Le,Xe):this._context.moveTo(Le,Xe);break;case 1:this._point=2,this._x1=Le,this._y1=Xe;break;case 2:this._point=3;default:We(this,Le,Xe)}this._x0=this._x1,this._x1=this._x2,this._x2=Le,this._y0=this._y1,this._y1=this._y2,this._y2=Xe}};var at=function Le(Xe){function ot(pt){return new $e(pt,Xe)}return ot.tension=function(pt){return Le(+pt)},ot}(0);function gt(Le,Xe){this._context=Le,this._k=(1-Xe)/6}gt.prototype={areaStart:Ie,areaEnd:Ie,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Le,Xe){switch(Le=+Le,Xe=+Xe,this._point){case 0:this._point=1,this._x3=Le,this._y3=Xe;break;case 1:this._point=2,this._context.moveTo(this._x4=Le,this._y4=Xe);break;case 2:this._point=3,this._x5=Le,this._y5=Xe;break;default:We(this,Le,Xe)}this._x0=this._x1,this._x1=this._x2,this._x2=Le,this._y0=this._y1,this._y1=this._y2,this._y2=Xe}};var xt=function Le(Xe){function ot(pt){return new gt(pt,Xe)}return ot.tension=function(pt){return Le(+pt)},ot}(0);function mt(Le,Xe){this._context=Le,this._k=(1-Xe)/6}mt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Le,Xe){switch(Le=+Le,Xe=+Xe,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:We(this,Le,Xe)}this._x0=this._x1,this._x1=this._x2,this._x2=Le,this._y0=this._y1,this._y1=this._y2,this._y2=Xe}};var nt=function Le(Xe){function ot(pt){return new mt(pt,Xe)}return ot.tension=function(pt){return Le(+pt)},ot}(0);function Qe(Le,Xe,ot){var pt=Le._x1,St=Le._y1,Vt=Le._x2,Jt=Le._y2;if(Le._l01_a>1e-12){var qt=2*Le._l01_2a+3*Le._l01_a*Le._l12_a+Le._l12_2a,gr=3*Le._l01_a*(Le._l01_a+Le._l12_a);pt=(pt*qt-Le._x0*Le._l12_2a+Le._x2*Le._l01_2a)/gr,St=(St*qt-Le._y0*Le._l12_2a+Le._y2*Le._l01_2a)/gr}if(Le._l23_a>1e-12){var Cr=2*Le._l23_2a+3*Le._l23_a*Le._l12_a+Le._l12_2a,mr=3*Le._l23_a*(Le._l23_a+Le._l12_a);Vt=(Vt*Cr+Le._x1*Le._l23_2a-Xe*Le._l12_2a)/mr,Jt=(Jt*Cr+Le._y1*Le._l23_2a-ot*Le._l12_2a)/mr}Le._context.bezierCurveTo(pt,St,Vt,Jt,Le._x2,Le._y2)}function vt(Le,Xe){this._context=Le,this._alpha=Xe}vt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Le,Xe){if(Le=+Le,Xe=+Xe,this._point){var ot=this._x2-Le,pt=this._y2-Xe;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(ot*ot+pt*pt,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Le,Xe):this._context.moveTo(Le,Xe);break;case 1:this._point=2;break;case 2:this._point=3;default:Qe(this,Le,Xe)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Le,this._y0=this._y1,this._y1=this._y2,this._y2=Xe}};var jt=function Le(Xe){function ot(pt){return Xe?new vt(pt,Xe):new $e(pt,0)}return ot.alpha=function(pt){return Le(+pt)},ot}(.5);function Gt(Le,Xe){this._context=Le,this._alpha=Xe}Gt.prototype={areaStart:Ie,areaEnd:Ie,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Le,Xe){if(Le=+Le,Xe=+Xe,this._point){var ot=this._x2-Le,pt=this._y2-Xe;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(ot*ot+pt*pt,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=Le,this._y3=Xe;break;case 1:this._point=2,this._context.moveTo(this._x4=Le,this._y4=Xe);break;case 2:this._point=3,this._x5=Le,this._y5=Xe;break;default:Qe(this,Le,Xe)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Le,this._y0=this._y1,this._y1=this._y2,this._y2=Xe}};var $t=function Le(Xe){function ot(pt){return Xe?new Gt(pt,Xe):new gt(pt,0)}return ot.alpha=function(pt){return Le(+pt)},ot}(.5);function Zt(Le,Xe){this._context=Le,this._alpha=Xe}Zt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(Le,Xe){if(Le=+Le,Xe=+Xe,this._point){var ot=this._x2-Le,pt=this._y2-Xe;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(ot*ot+pt*pt,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Qe(this,Le,Xe)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Le,this._y0=this._y1,this._y1=this._y2,this._y2=Xe}};var cr=function Le(Xe){function ot(pt){return Xe?new Zt(pt,Xe):new mt(pt,0)}return ot.alpha=function(pt){return Le(+pt)},ot}(.5);function Dt(Le){this._context=Le}function Ne(Le){return Le<0?-1:1}function Ye(Le,Xe,ot){var pt=Le._x1-Le._x0,St=Xe-Le._x1,Vt=(Le._y1-Le._y0)/(pt||St<0&&-0),Jt=(ot-Le._y1)/(St||pt<0&&-0),qt=(Vt*St+Jt*pt)/(pt+St);return(Ne(Vt)+Ne(Jt))*Math.min(Math.abs(Vt),Math.abs(Jt),.5*Math.abs(qt))||0}function pe(Le,Xe){var ot=Le._x1-Le._x0;return ot?(3*(Le._y1-Le._y0)/ot-Xe)/2:Xe}function _e(Le,Xe,ot){var pt=Le._x0,St=Le._y0,Vt=Le._x1,Jt=Le._y1,qt=(Vt-pt)/3;Le._context.bezierCurveTo(pt+qt,St+qt*Xe,Vt-qt,Jt-qt*ot,Vt,Jt)}function Be(Le){this._context=Le}function He(Le){this._context=new Je(Le)}function Je(Le){this._context=Le}function Ze(Le){this._context=Le}function ct(Le){var Xe,ot,pt=Le.length-1,St=new Array(pt),Vt=new Array(pt),Jt=new Array(pt);for(St[0]=0,Vt[0]=2,Jt[0]=Le[0]+2*Le[1],Xe=1;Xe<pt-1;++Xe)St[Xe]=1,Vt[Xe]=4,Jt[Xe]=4*Le[Xe]+2*Le[Xe+1];for(St[pt-1]=2,Vt[pt-1]=7,Jt[pt-1]=8*Le[pt-1]+Le[pt],Xe=1;Xe<pt;++Xe)ot=St[Xe]/Vt[Xe-1],Vt[Xe]-=ot,Jt[Xe]-=ot*Jt[Xe-1];for(St[pt-1]=Jt[pt-1]/Vt[pt-1],Xe=pt-2;Xe>=0;--Xe)St[Xe]=(Jt[Xe]-St[Xe+1])/Vt[Xe];for(Vt[pt-1]=(Le[pt]+St[pt-1])/2,Xe=0;Xe<pt-1;++Xe)Vt[Xe]=2*Le[Xe+1]-St[Xe+1];return[St,Vt]}function lt(Le,Xe){this._context=Le,this._t=Xe}function At(Le,Xe){if((St=Le.length)>1)for(var ot,pt,St,Vt=1,Jt=Le[Xe[0]],qt=Jt.length;Vt<St;++Vt)for(pt=Jt,Jt=Le[Xe[Vt]],ot=0;ot<qt;++ot)Jt[ot][1]+=Jt[ot][0]=isNaN(pt[ot][1])?pt[ot][0]:pt[ot][1]}function Ot(Le){for(var Xe=Le.length,ot=new Array(Xe);--Xe>=0;)ot[Xe]=Xe;return ot}function it(Le,Xe){return Le[Xe]}function ht(Le){var Xe=Le.map(Ut);return Ot(Le).sort(function(ot,pt){return Xe[ot]-Xe[pt]})}function Ut(Le){for(var Xe,ot=-1,pt=0,St=Le.length,Vt=-1/0;++ot<St;)(Xe=+Le[ot][1])>Vt&&(Vt=Xe,pt=ot);return pt}function Mt(Le){var Xe=Le.map(It);return Ot(Le).sort(function(ot,pt){return Xe[ot]-Xe[pt]})}function It(Le){for(var Xe,ot=0,pt=-1,St=Le.length;++pt<St;)(Xe=+Le[pt][1])&&(ot+=Xe);return ot}Dt.prototype={areaStart:Ie,areaEnd:Ie,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(Le,Xe){Le=+Le,Xe=+Xe,this._point?this._context.lineTo(Le,Xe):(this._point=1,this._context.moveTo(Le,Xe))}},Be.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:_e(this,this._t0,pe(this,this._t0))}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(Le,Xe){var ot=NaN;if(Xe=+Xe,(Le=+Le)!==this._x1||Xe!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Le,Xe):this._context.moveTo(Le,Xe);break;case 1:this._point=2;break;case 2:this._point=3,_e(this,pe(this,ot=Ye(this,Le,Xe)),ot);break;default:_e(this,this._t0,ot=Ye(this,Le,Xe))}this._x0=this._x1,this._x1=Le,this._y0=this._y1,this._y1=Xe,this._t0=ot}}},(He.prototype=Object.create(Be.prototype)).point=function(Le,Xe){Be.prototype.point.call(this,Xe,Le)},Je.prototype={moveTo:function(Le,Xe){this._context.moveTo(Xe,Le)},closePath:function(){this._context.closePath()},lineTo:function(Le,Xe){this._context.lineTo(Xe,Le)},bezierCurveTo:function(Le,Xe,ot,pt,St,Vt){this._context.bezierCurveTo(Xe,Le,pt,ot,Vt,St)}},Ze.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var Le=this._x,Xe=this._y,ot=Le.length;if(ot)if(this._line?this._context.lineTo(Le[0],Xe[0]):this._context.moveTo(Le[0],Xe[0]),ot===2)this._context.lineTo(Le[1],Xe[1]);else for(var pt=ct(Le),St=ct(Xe),Vt=0,Jt=1;Jt<ot;++Vt,++Jt)this._context.bezierCurveTo(pt[0][Vt],St[0][Vt],pt[1][Vt],St[1][Vt],Le[Jt],Xe[Jt]);(this._line||this._line!==0&&ot===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(Le,Xe){this._x.push(+Le),this._y.push(+Xe)}},lt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(Le,Xe){switch(Le=+Le,Xe=+Xe,this._point){case 0:this._point=1,this._line?this._context.lineTo(Le,Xe):this._context.moveTo(Le,Xe);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,Xe),this._context.lineTo(Le,Xe);else{var ot=this._x*(1-this._t)+Le*this._t;this._context.lineTo(ot,this._y),this._context.lineTo(ot,Xe)}}this._x=Le,this._y=Xe}},d.arc=function(){var Le=p,Xe=u,ot=w(0),pt=null,St=i,Vt=x,Jt=f,qt=null;function gr(){var Cr,mr,tr=+Le.apply(this,arguments),nr=+Xe.apply(this,arguments),Qt=St.apply(this,arguments)-a,dr=Vt.apply(this,arguments)-a,_r=y(dr-Qt),Ir=dr>Qt;if(qt||(qt=Cr=v.path()),nr<tr&&(mr=nr,nr=tr,tr=mr),nr>1e-12)if(_r>h-1e-12)qt.moveTo(nr*t(Qt),nr*r(Qt)),qt.arc(0,0,nr,Qt,dr,!Ir),tr>1e-12&&(qt.moveTo(tr*t(dr),tr*r(dr)),qt.arc(0,0,tr,dr,Qt,Ir));else{var Rr,Vr,Xr=Qt,cn=dr,an=Qt,zn=dr,on=_r,Tn=_r,Mn=Jt.apply(this,arguments)/2,ei=Mn>1e-12&&(pt?+pt.apply(this,arguments):g(tr*tr+nr*nr)),Hr=o(y(nr-tr)/2,+ot.apply(this,arguments)),ln=Hr,bn=Hr;if(ei>1e-12){var nn=s(ei/tr*r(Mn)),pn=s(ei/nr*r(Mn));(on-=2*nn)>1e-12?(an+=nn*=Ir?1:-1,zn-=nn):(on=0,an=zn=(Qt+dr)/2),(Tn-=2*pn)>1e-12?(Xr+=pn*=Ir?1:-1,cn-=pn):(Tn=0,Xr=cn=(Qt+dr)/2)}var qn=nr*t(Xr),sr=nr*r(Xr),xr=tr*t(zn),jr=tr*r(zn);if(Hr>1e-12){var Rt,or=nr*t(cn),wt=nr*r(cn),ir=tr*t(an),ar=tr*r(an);if(_r<c&&(Rt=_(qn,sr,ir,ar,or,wt,xr,jr))){var Dr=qn-Rt[0],Pr=sr-Rt[1],Er=or-Rt[0],Ar=wt-Rt[1],vr=1/r(l((Dr*Er+Pr*Ar)/(g(Dr*Dr+Pr*Pr)*g(Er*Er+Ar*Ar)))/2),wr=g(Rt[0]*Rt[0]+Rt[1]*Rt[1]);ln=o(Hr,(tr-wr)/(vr-1)),bn=o(Hr,(nr-wr)/(vr+1))}}Tn>1e-12?bn>1e-12?(Rr=b(ir,ar,qn,sr,nr,bn,Ir),Vr=b(or,wt,xr,jr,nr,bn,Ir),qt.moveTo(Rr.cx+Rr.x01,Rr.cy+Rr.y01),bn<Hr?qt.arc(Rr.cx,Rr.cy,bn,e(Rr.y01,Rr.x01),e(Vr.y01,Vr.x01),!Ir):(qt.arc(Rr.cx,Rr.cy,bn,e(Rr.y01,Rr.x01),e(Rr.y11,Rr.x11),!Ir),qt.arc(0,0,nr,e(Rr.cy+Rr.y11,Rr.cx+Rr.x11),e(Vr.cy+Vr.y11,Vr.cx+Vr.x11),!Ir),qt.arc(Vr.cx,Vr.cy,bn,e(Vr.y11,Vr.x11),e(Vr.y01,Vr.x01),!Ir))):(qt.moveTo(qn,sr),qt.arc(0,0,nr,Xr,cn,!Ir)):qt.moveTo(qn,sr),tr>1e-12&&on>1e-12?ln>1e-12?(Rr=b(xr,jr,or,wt,tr,-ln,Ir),Vr=b(qn,sr,ir,ar,tr,-ln,Ir),qt.lineTo(Rr.cx+Rr.x01,Rr.cy+Rr.y01),ln<Hr?qt.arc(Rr.cx,Rr.cy,ln,e(Rr.y01,Rr.x01),e(Vr.y01,Vr.x01),!Ir):(qt.arc(Rr.cx,Rr.cy,ln,e(Rr.y01,Rr.x01),e(Rr.y11,Rr.x11),!Ir),qt.arc(0,0,tr,e(Rr.cy+Rr.y11,Rr.cx+Rr.x11),e(Vr.cy+Vr.y11,Vr.cx+Vr.x11),Ir),qt.arc(Vr.cx,Vr.cy,ln,e(Vr.y11,Vr.x11),e(Vr.y01,Vr.x01),!Ir))):qt.arc(0,0,tr,zn,an,Ir):qt.lineTo(xr,jr)}else qt.moveTo(0,0);if(qt.closePath(),Cr)return qt=null,Cr+""||null}return gr.centroid=function(){var Cr=(+Le.apply(this,arguments)+ +Xe.apply(this,arguments))/2,mr=(+St.apply(this,arguments)+ +Vt.apply(this,arguments))/2-c/2;return[t(mr)*Cr,r(mr)*Cr]},gr.innerRadius=function(Cr){return arguments.length?(Le=typeof Cr=="function"?Cr:w(+Cr),gr):Le},gr.outerRadius=function(Cr){return arguments.length?(Xe=typeof Cr=="function"?Cr:w(+Cr),gr):Xe},gr.cornerRadius=function(Cr){return arguments.length?(ot=typeof Cr=="function"?Cr:w(+Cr),gr):ot},gr.padRadius=function(Cr){return arguments.length?(pt=Cr==null?null:typeof Cr=="function"?Cr:w(+Cr),gr):pt},gr.startAngle=function(Cr){return arguments.length?(St=typeof Cr=="function"?Cr:w(+Cr),gr):St},gr.endAngle=function(Cr){return arguments.length?(Vt=typeof Cr=="function"?Cr:w(+Cr),gr):Vt},gr.padAngle=function(Cr){return arguments.length?(Jt=typeof Cr=="function"?Cr:w(+Cr),gr):Jt},gr.context=function(Cr){return arguments.length?(qt=Cr==null?null:Cr,gr):qt},gr},d.area=P,d.areaRadial=Q,d.curveBasis=function(Le){return new Oe(Le)},d.curveBasisClosed=function(Le){return new Ve(Le)},d.curveBasisOpen=function(Le){return new Fe(Le)},d.curveBundle=Re,d.curveCardinal=at,d.curveCardinalClosed=xt,d.curveCardinalOpen=nt,d.curveCatmullRom=jt,d.curveCatmullRomClosed=$t,d.curveCatmullRomOpen=cr,d.curveLinear=k,d.curveLinearClosed=function(Le){return new Dt(Le)},d.curveMonotoneX=function(Le){return new Be(Le)},d.curveMonotoneY=function(Le){return new He(Le)},d.curveNatural=function(Le){return new Ze(Le)},d.curveStep=function(Le){return new lt(Le,.5)},d.curveStepAfter=function(Le){return new lt(Le,1)},d.curveStepBefore=function(Le){return new lt(Le,0)},d.line=I,d.lineRadial=Z,d.linkHorizontal=function(){return N(U)},d.linkRadial=function(){var Le=N(B);return Le.angle=Le.x,delete Le.x,Le.radius=Le.y,delete Le.y,Le},d.linkVertical=function(){return N(te)},d.pie=function(){var Le=E,Xe=S,ot=null,pt=w(0),St=w(h),Vt=w(0);function Jt(qt){var gr,Cr,mr,tr,nr,Qt=qt.length,dr=0,_r=new Array(Qt),Ir=new Array(Qt),Rr=+pt.apply(this,arguments),Vr=Math.min(h,Math.max(-h,St.apply(this,arguments)-Rr)),Xr=Math.min(Math.abs(Vr)/Qt,Vt.apply(this,arguments)),cn=Xr*(Vr<0?-1:1);for(gr=0;gr<Qt;++gr)(nr=Ir[_r[gr]=gr]=+Le(qt[gr],gr,qt))>0&&(dr+=nr);for(Xe!=null?_r.sort(function(an,zn){return Xe(Ir[an],Ir[zn])}):ot!=null&&_r.sort(function(an,zn){return ot(qt[an],qt[zn])}),gr=0,mr=dr?(Vr-Qt*cn)/dr:0;gr<Qt;++gr,Rr=tr)Cr=_r[gr],tr=Rr+((nr=Ir[Cr])>0?nr*mr:0)+cn,Ir[Cr]={data:qt[Cr],index:gr,value:nr,startAngle:Rr,endAngle:tr,padAngle:Xr};return Ir}return Jt.value=function(qt){return arguments.length?(Le=typeof qt=="function"?qt:w(+qt),Jt):Le},Jt.sortValues=function(qt){return arguments.length?(Xe=qt,ot=null,Jt):Xe},Jt.sort=function(qt){return arguments.length?(ot=qt,Xe=null,Jt):ot},Jt.startAngle=function(qt){return arguments.length?(pt=typeof qt=="function"?qt:w(+qt),Jt):pt},Jt.endAngle=function(qt){return arguments.length?(St=typeof qt=="function"?qt:w(+qt),Jt):St},Jt.padAngle=function(qt){return arguments.length?(Vt=typeof qt=="function"?qt:w(+qt),Jt):Vt},Jt},d.pointRadial=X,d.radialArea=Q,d.radialLine=Z,d.stack=function(){var Le=w([]),Xe=Ot,ot=At,pt=it;function St(Vt){var Jt,qt,gr=Le.apply(this,arguments),Cr=Vt.length,mr=gr.length,tr=new Array(mr);for(Jt=0;Jt<mr;++Jt){for(var nr,Qt=gr[Jt],dr=tr[Jt]=new Array(Cr),_r=0;_r<Cr;++_r)dr[_r]=nr=[0,+pt(Vt[_r],Qt,_r,Vt)],nr.data=Vt[_r];dr.key=Qt}for(Jt=0,qt=Xe(tr);Jt<mr;++Jt)tr[qt[Jt]].index=Jt;return ot(tr,qt),tr}return St.keys=function(Vt){return arguments.length?(Le=typeof Vt=="function"?Vt:w($.call(Vt)),St):Le},St.value=function(Vt){return arguments.length?(pt=typeof Vt=="function"?Vt:w(+Vt),St):pt},St.order=function(Vt){return arguments.length?(Xe=Vt==null?Ot:typeof Vt=="function"?Vt:w($.call(Vt)),St):Xe},St.offset=function(Vt){return arguments.length?(ot=Vt==null?At:Vt,St):ot},St},d.stackOffsetDiverging=function(Le,Xe){if((qt=Le.length)>0)for(var ot,pt,St,Vt,Jt,qt,gr=0,Cr=Le[Xe[0]].length;gr<Cr;++gr)for(Vt=Jt=0,ot=0;ot<qt;++ot)(St=(pt=Le[Xe[ot]][gr])[1]-pt[0])>0?(pt[0]=Vt,pt[1]=Vt+=St):St<0?(pt[1]=Jt,pt[0]=Jt+=St):(pt[0]=0,pt[1]=St)},d.stackOffsetExpand=function(Le,Xe){if((pt=Le.length)>0){for(var ot,pt,St,Vt=0,Jt=Le[0].length;Vt<Jt;++Vt){for(St=ot=0;ot<pt;++ot)St+=Le[ot][Vt][1]||0;if(St)for(ot=0;ot<pt;++ot)Le[ot][Vt][1]/=St}At(Le,Xe)}},d.stackOffsetNone=At,d.stackOffsetSilhouette=function(Le,Xe){if((ot=Le.length)>0){for(var ot,pt=0,St=Le[Xe[0]],Vt=St.length;pt<Vt;++pt){for(var Jt=0,qt=0;Jt<ot;++Jt)qt+=Le[Jt][pt][1]||0;St[pt][1]+=St[pt][0]=-qt/2}At(Le,Xe)}},d.stackOffsetWiggle=function(Le,Xe){if((St=Le.length)>0&&(pt=(ot=Le[Xe[0]]).length)>0){for(var ot,pt,St,Vt=0,Jt=1;Jt<pt;++Jt){for(var qt=0,gr=0,Cr=0;qt<St;++qt){for(var mr=Le[Xe[qt]],tr=mr[Jt][1]||0,nr=(tr-(mr[Jt-1][1]||0))/2,Qt=0;Qt<qt;++Qt){var dr=Le[Xe[Qt]];nr+=(dr[Jt][1]||0)-(dr[Jt-1][1]||0)}gr+=tr,Cr+=nr*tr}ot[Jt-1][1]+=ot[Jt-1][0]=Vt,gr&&(Vt-=Cr/gr)}ot[Jt-1][1]+=ot[Jt-1][0]=Vt,At(Le,Xe)}},d.stackOrderAppearance=ht,d.stackOrderAscending=Mt,d.stackOrderDescending=function(Le){return Mt(Le).reverse()},d.stackOrderInsideOut=function(Le){var Xe,ot,pt=Le.length,St=Le.map(It),Vt=ht(Le),Jt=0,qt=0,gr=[],Cr=[];for(Xe=0;Xe<pt;++Xe)ot=Vt[Xe],Jt<qt?(Jt+=St[ot],gr.push(ot)):(qt+=St[ot],Cr.push(ot));return Cr.reverse().concat(gr)},d.stackOrderNone=Ot,d.stackOrderReverse=function(Le){return Ot(Le).reverse()},d.symbol=function(){var Le=w(K),Xe=w(64),ot=null;function pt(){var St;if(ot||(ot=St=v.path()),Le.apply(this,arguments).draw(ot,+Xe.apply(this,arguments)),St)return ot=null,St+""||null}return pt.type=function(St){return arguments.length?(Le=typeof St=="function"?St:w(St),pt):Le},pt.size=function(St){return arguments.length?(Xe=typeof St=="function"?St:w(+St),pt):Xe},pt.context=function(St){return arguments.length?(ot=St==null?null:St,pt):ot},pt},d.symbolCircle=K,d.symbolCross=J,d.symbolDiamond=se,d.symbolSquare=Se,d.symbolStar=ye,d.symbolTriangle=ge,d.symbolWye=we,d.symbols=de,Object.defineProperty(d,"__esModule",{value:!0})})},{"d3-path":117}],120:[function(m,G,Y){(function(d,v){typeof Y=="object"&&G!==void 0?v(Y,m("d3-time")):v((d=d||self).d3=d.d3||{},d.d3)})(this,function(d,v){function w(nt){if(0<=nt.y&&nt.y<100){var Qe=new Date(-1,nt.m,nt.d,nt.H,nt.M,nt.S,nt.L);return Qe.setFullYear(nt.y),Qe}return new Date(nt.y,nt.m,nt.d,nt.H,nt.M,nt.S,nt.L)}function y(nt){if(0<=nt.y&&nt.y<100){var Qe=new Date(Date.UTC(-1,nt.m,nt.d,nt.H,nt.M,nt.S,nt.L));return Qe.setUTCFullYear(nt.y),Qe}return new Date(Date.UTC(nt.y,nt.m,nt.d,nt.H,nt.M,nt.S,nt.L))}function e(nt,Qe,vt){return{y:nt,m:Qe,d:vt,H:0,M:0,S:0,L:0}}function t(nt){var Qe=nt.dateTime,vt=nt.date,jt=nt.time,Gt=nt.periods,$t=nt.days,Zt=nt.shortDays,cr=nt.months,Dt=nt.shortMonths,Ne=l(Gt),Ye=s(Gt),pe=l($t),_e=s($t),Be=l(Zt),He=s(Zt),Je=l(cr),Ze=s(cr),ct=l(Dt),lt=s(Dt),At={a:function(It){return Zt[It.getDay()]},A:function(It){return $t[It.getDay()]},b:function(It){return Dt[It.getMonth()]},B:function(It){return cr[It.getMonth()]},c:null,d:Q,e:Q,f:N,H:X,I:$,j:re,L:H,m:U,M:te,p:function(It){return Gt[+(It.getHours()>=12)]},q:function(It){return 1+~~(It.getMonth()/3)},Q:$e,s:at,S:B,u:K,U:J,V:ee,w:ne,W:se,x:null,X:null,y:oe,Y:me,Z:ce,"%":We},Ot={a:function(It){return Zt[It.getUTCDay()]},A:function(It){return $t[It.getUTCDay()]},b:function(It){return Dt[It.getUTCMonth()]},B:function(It){return cr[It.getUTCMonth()]},c:null,d:ye,e:ye,f:le,H:Se,I:fe,j:ge,L:Te,m:ve,M:Me,p:function(It){return Gt[+(It.getUTCHours()>=12)]},q:function(It){return 1+~~(It.getUTCMonth()/3)},Q:$e,s:at,S:we,u:de,U:Ie,V:De,w:Oe,W:Ve,x:null,X:null,y:Fe,Y:ze,Z:Re,"%":We},it={a:function(It,Le,Xe){var ot=Be.exec(Le.slice(Xe));return ot?(It.w=He[ot[0].toLowerCase()],Xe+ot[0].length):-1},A:function(It,Le,Xe){var ot=pe.exec(Le.slice(Xe));return ot?(It.w=_e[ot[0].toLowerCase()],Xe+ot[0].length):-1},b:function(It,Le,Xe){var ot=ct.exec(Le.slice(Xe));return ot?(It.m=lt[ot[0].toLowerCase()],Xe+ot[0].length):-1},B:function(It,Le,Xe){var ot=Je.exec(Le.slice(Xe));return ot?(It.m=Ze[ot[0].toLowerCase()],Xe+ot[0].length):-1},c:function(It,Le,Xe){return Mt(It,Qe,Le,Xe)},d:A,e:A,f:D,H:P,I:P,j:I,L:z,m:L,M:S,p:function(It,Le,Xe){var ot=Ne.exec(Le.slice(Xe));return ot?(It.p=Ye[ot[0].toLowerCase()],Xe+ot[0].length):-1},q:k,Q:V,s:Z,S:E,u,U:i,V:x,w:p,W:f,x:function(It,Le,Xe){return Mt(It,vt,Le,Xe)},X:function(It,Le,Xe){return Mt(It,jt,Le,Xe)},y:b,Y:_,Z:T,"%":j};function ht(It,Le){return function(Xe){var ot,pt,St,Vt=[],Jt=-1,qt=0,gr=It.length;for(Xe instanceof Date||(Xe=new Date(+Xe));++Jt<gr;)It.charCodeAt(Jt)===37&&(Vt.push(It.slice(qt,Jt)),(pt=o[ot=It.charAt(++Jt)])!=null?ot=It.charAt(++Jt):pt=ot==="e"?" ":"0",(St=Le[ot])&&(ot=St(Xe,pt)),Vt.push(ot),qt=Jt+1);return Vt.push(It.slice(qt,Jt)),Vt.join("")}}function Ut(It,Le){return function(Xe){var ot,pt,St=e(1900,void 0,1);if(Mt(St,It,Xe+="",0)!=Xe.length)return null;if("Q"in St)return new Date(St.Q);if("s"in St)return new Date(1e3*St.s+("L"in St?St.L:0));if(Le&&!("Z"in St)&&(St.Z=0),"p"in St&&(St.H=St.H%12+12*St.p),St.m===void 0&&(St.m="q"in St?St.q:0),"V"in St){if(St.V<1||St.V>53)return null;"w"in St||(St.w=1),"Z"in St?(pt=(ot=y(e(St.y,0,1))).getUTCDay(),ot=pt>4||pt===0?v.utcMonday.ceil(ot):v.utcMonday(ot),ot=v.utcDay.offset(ot,7*(St.V-1)),St.y=ot.getUTCFullYear(),St.m=ot.getUTCMonth(),St.d=ot.getUTCDate()+(St.w+6)%7):(pt=(ot=w(e(St.y,0,1))).getDay(),ot=pt>4||pt===0?v.timeMonday.ceil(ot):v.timeMonday(ot),ot=v.timeDay.offset(ot,7*(St.V-1)),St.y=ot.getFullYear(),St.m=ot.getMonth(),St.d=ot.getDate()+(St.w+6)%7)}else("W"in St||"U"in St)&&("w"in St||(St.w="u"in St?St.u%7:"W"in St?1:0),pt="Z"in St?y(e(St.y,0,1)).getUTCDay():w(e(St.y,0,1)).getDay(),St.m=0,St.d="W"in St?(St.w+6)%7+7*St.W-(pt+5)%7:St.w+7*St.U-(pt+6)%7);return"Z"in St?(St.H+=St.Z/100|0,St.M+=St.Z%100,y(St)):w(St)}}function Mt(It,Le,Xe,ot){for(var pt,St,Vt=0,Jt=Le.length,qt=Xe.length;Vt<Jt;){if(ot>=qt)return-1;if((pt=Le.charCodeAt(Vt++))===37){if(pt=Le.charAt(Vt++),!(St=it[pt in o?Le.charAt(Vt++):pt])||(ot=St(It,Xe,ot))<0)return-1}else if(pt!=Xe.charCodeAt(ot++))return-1}return ot}return At.x=ht(vt,At),At.X=ht(jt,At),At.c=ht(Qe,At),Ot.x=ht(vt,Ot),Ot.X=ht(jt,Ot),Ot.c=ht(Qe,Ot),{format:function(It){var Le=ht(It+="",At);return Le.toString=function(){return It},Le},parse:function(It){var Le=Ut(It+="",!1);return Le.toString=function(){return It},Le},utcFormat:function(It){var Le=ht(It+="",Ot);return Le.toString=function(){return It},Le},utcParse:function(It){var Le=Ut(It+="",!0);return Le.toString=function(){return It},Le}}}var n,o={"-":"",_:" ",0:"0"},r=/^\s*\d+/,g=/^%/,c=/[\\^$*+?|[\]().{}]/g;function a(nt,Qe,vt){var jt=nt<0?"-":"",Gt=(jt?-nt:nt)+"",$t=Gt.length;return jt+($t<vt?new Array(vt-$t+1).join(Qe)+Gt:Gt)}function h(nt){return nt.replace(c,"\\$&")}function l(nt){return new RegExp("^(?:"+nt.map(h).join("|")+")","i")}function s(nt){for(var Qe={},vt=-1,jt=nt.length;++vt<jt;)Qe[nt[vt].toLowerCase()]=vt;return Qe}function p(nt,Qe,vt){var jt=r.exec(Qe.slice(vt,vt+1));return jt?(nt.w=+jt[0],vt+jt[0].length):-1}function u(nt,Qe,vt){var jt=r.exec(Qe.slice(vt,vt+1));return jt?(nt.u=+jt[0],vt+jt[0].length):-1}function i(nt,Qe,vt){var jt=r.exec(Qe.slice(vt,vt+2));return jt?(nt.U=+jt[0],vt+jt[0].length):-1}function x(nt,Qe,vt){var jt=r.exec(Qe.slice(vt,vt+2));return jt?(nt.V=+jt[0],vt+jt[0].length):-1}function f(nt,Qe,vt){var jt=r.exec(Qe.slice(vt,vt+2));return jt?(nt.W=+jt[0],vt+jt[0].length):-1}function _(nt,Qe,vt){var jt=r.exec(Qe.slice(vt,vt+4));return jt?(nt.y=+jt[0],vt+jt[0].length):-1}function b(nt,Qe,vt){var jt=r.exec(Qe.slice(vt,vt+2));return jt?(nt.y=+jt[0]+(+jt[0]>68?1900:2e3),vt+jt[0].length):-1}function T(nt,Qe,vt){var jt=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(Qe.slice(vt,vt+6));return jt?(nt.Z=jt[1]?0:-(jt[2]+(jt[3]||"00")),vt+jt[0].length):-1}function k(nt,Qe,vt){var jt=r.exec(Qe.slice(vt,vt+1));return jt?(nt.q=3*jt[0]-3,vt+jt[0].length):-1}function L(nt,Qe,vt){var jt=r.exec(Qe.slice(vt,vt+2));return jt?(nt.m=jt[0]-1,vt+jt[0].length):-1}function A(nt,Qe,vt){var jt=r.exec(Qe.slice(vt,vt+2));return jt?(nt.d=+jt[0],vt+jt[0].length):-1}function I(nt,Qe,vt){var jt=r.exec(Qe.slice(vt,vt+3));return jt?(nt.m=0,nt.d=+jt[0],vt+jt[0].length):-1}function P(nt,Qe,vt){var jt=r.exec(Qe.slice(vt,vt+2));return jt?(nt.H=+jt[0],vt+jt[0].length):-1}function S(nt,Qe,vt){var jt=r.exec(Qe.slice(vt,vt+2));return jt?(nt.M=+jt[0],vt+jt[0].length):-1}function E(nt,Qe,vt){var jt=r.exec(Qe.slice(vt,vt+2));return jt?(nt.S=+jt[0],vt+jt[0].length):-1}function z(nt,Qe,vt){var jt=r.exec(Qe.slice(vt,vt+3));return jt?(nt.L=+jt[0],vt+jt[0].length):-1}function D(nt,Qe,vt){var jt=r.exec(Qe.slice(vt,vt+6));return jt?(nt.L=Math.floor(jt[0]/1e3),vt+jt[0].length):-1}function j(nt,Qe,vt){var jt=g.exec(Qe.slice(vt,vt+1));return jt?vt+jt[0].length:-1}function V(nt,Qe,vt){var jt=r.exec(Qe.slice(vt));return jt?(nt.Q=+jt[0],vt+jt[0].length):-1}function Z(nt,Qe,vt){var jt=r.exec(Qe.slice(vt));return jt?(nt.s=+jt[0],vt+jt[0].length):-1}function Q(nt,Qe){return a(nt.getDate(),Qe,2)}function X(nt,Qe){return a(nt.getHours(),Qe,2)}function $(nt,Qe){return a(nt.getHours()%12||12,Qe,2)}function re(nt,Qe){return a(1+v.timeDay.count(v.timeYear(nt),nt),Qe,3)}function H(nt,Qe){return a(nt.getMilliseconds(),Qe,3)}function N(nt,Qe){return H(nt,Qe)+"000"}function U(nt,Qe){return a(nt.getMonth()+1,Qe,2)}function te(nt,Qe){return a(nt.getMinutes(),Qe,2)}function B(nt,Qe){return a(nt.getSeconds(),Qe,2)}function K(nt){var Qe=nt.getDay();return Qe===0?7:Qe}function J(nt,Qe){return a(v.timeSunday.count(v.timeYear(nt)-1,nt),Qe,2)}function ee(nt,Qe){var vt=nt.getDay();return nt=vt>=4||vt===0?v.timeThursday(nt):v.timeThursday.ceil(nt),a(v.timeThursday.count(v.timeYear(nt),nt)+(v.timeYear(nt).getDay()===4),Qe,2)}function ne(nt){return nt.getDay()}function se(nt,Qe){return a(v.timeMonday.count(v.timeYear(nt)-1,nt),Qe,2)}function oe(nt,Qe){return a(nt.getFullYear()%100,Qe,2)}function me(nt,Qe){return a(nt.getFullYear()%1e4,Qe,4)}function ce(nt){var Qe=nt.getTimezoneOffset();return(Qe>0?"-":(Qe*=-1,"+"))+a(Qe/60|0,"0",2)+a(Qe%60,"0",2)}function ye(nt,Qe){return a(nt.getUTCDate(),Qe,2)}function Se(nt,Qe){return a(nt.getUTCHours(),Qe,2)}function fe(nt,Qe){return a(nt.getUTCHours()%12||12,Qe,2)}function ge(nt,Qe){return a(1+v.utcDay.count(v.utcYear(nt),nt),Qe,3)}function Te(nt,Qe){return a(nt.getUTCMilliseconds(),Qe,3)}function le(nt,Qe){return Te(nt,Qe)+"000"}function ve(nt,Qe){return a(nt.getUTCMonth()+1,Qe,2)}function Me(nt,Qe){return a(nt.getUTCMinutes(),Qe,2)}function we(nt,Qe){return a(nt.getUTCSeconds(),Qe,2)}function de(nt){var Qe=nt.getUTCDay();return Qe===0?7:Qe}function Ie(nt,Qe){return a(v.utcSunday.count(v.utcYear(nt)-1,nt),Qe,2)}function De(nt,Qe){var vt=nt.getUTCDay();return nt=vt>=4||vt===0?v.utcThursday(nt):v.utcThursday.ceil(nt),a(v.utcThursday.count(v.utcYear(nt),nt)+(v.utcYear(nt).getUTCDay()===4),Qe,2)}function Oe(nt){return nt.getUTCDay()}function Ve(nt,Qe){return a(v.utcMonday.count(v.utcYear(nt)-1,nt),Qe,2)}function Fe(nt,Qe){return a(nt.getUTCFullYear()%100,Qe,2)}function ze(nt,Qe){return a(nt.getUTCFullYear()%1e4,Qe,4)}function Re(){return"+0000"}function We(){return"%"}function $e(nt){return+nt}function at(nt){return Math.floor(+nt/1e3)}function gt(nt){return n=t(nt),d.timeFormat=n.format,d.timeParse=n.parse,d.utcFormat=n.utcFormat,d.utcParse=n.utcParse,n}gt({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var xt=Date.prototype.toISOString?function(nt){return nt.toISOString()}:d.utcFormat("%Y-%m-%dT%H:%M:%S.%LZ"),mt=+new Date("2000-01-01T00:00:00.000Z")?function(nt){var Qe=new Date(nt);return isNaN(Qe)?null:Qe}:d.utcParse("%Y-%m-%dT%H:%M:%S.%LZ");d.isoFormat=xt,d.isoParse=mt,d.timeFormatDefaultLocale=gt,d.timeFormatLocale=t,Object.defineProperty(d,"__esModule",{value:!0})})},{"d3-time":121}],121:[function(m,G,Y){(function(d,v){v(typeof Y=="object"&&G!==void 0?Y:(d=d||self).d3=d.d3||{})})(this,function(d){var v=new Date,w=new Date;function y(ve,Me,we,de){function Ie(De){return ve(De=arguments.length===0?new Date:new Date(+De)),De}return Ie.floor=function(De){return ve(De=new Date(+De)),De},Ie.ceil=function(De){return ve(De=new Date(De-1)),Me(De,1),ve(De),De},Ie.round=function(De){var Oe=Ie(De),Ve=Ie.ceil(De);return De-Oe<Ve-De?Oe:Ve},Ie.offset=function(De,Oe){return Me(De=new Date(+De),Oe==null?1:Math.floor(Oe)),De},Ie.range=function(De,Oe,Ve){var Fe,ze=[];if(De=Ie.ceil(De),Ve=Ve==null?1:Math.floor(Ve),!(De<Oe&&Ve>0))return ze;do ze.push(Fe=new Date(+De)),Me(De,Ve),ve(De);while(Fe<De&&De<Oe);return ze},Ie.filter=function(De){return y(function(Oe){if(Oe>=Oe)for(;ve(Oe),!De(Oe);)Oe.setTime(Oe-1)},function(Oe,Ve){if(Oe>=Oe)if(Ve<0)for(;++Ve<=0;)for(;Me(Oe,-1),!De(Oe););else for(;--Ve>=0;)for(;Me(Oe,1),!De(Oe););})},we&&(Ie.count=function(De,Oe){return v.setTime(+De),w.setTime(+Oe),ve(v),ve(w),Math.floor(we(v,w))},Ie.every=function(De){return De=Math.floor(De),isFinite(De)&&De>0?De>1?Ie.filter(de?function(Oe){return de(Oe)%De==0}:function(Oe){return Ie.count(0,Oe)%De==0}):Ie:null}),Ie}var e=y(function(){},function(ve,Me){ve.setTime(+ve+Me)},function(ve,Me){return Me-ve});e.every=function(ve){return ve=Math.floor(ve),isFinite(ve)&&ve>0?ve>1?y(function(Me){Me.setTime(Math.floor(Me/ve)*ve)},function(Me,we){Me.setTime(+Me+we*ve)},function(Me,we){return(we-Me)/ve}):e:null};var t=e.range,n=y(function(ve){ve.setTime(ve-ve.getMilliseconds())},function(ve,Me){ve.setTime(+ve+1e3*Me)},function(ve,Me){return(Me-ve)/1e3},function(ve){return ve.getUTCSeconds()}),o=n.range,r=y(function(ve){ve.setTime(ve-ve.getMilliseconds()-1e3*ve.getSeconds())},function(ve,Me){ve.setTime(+ve+6e4*Me)},function(ve,Me){return(Me-ve)/6e4},function(ve){return ve.getMinutes()}),g=r.range,c=y(function(ve){ve.setTime(ve-ve.getMilliseconds()-1e3*ve.getSeconds()-6e4*ve.getMinutes())},function(ve,Me){ve.setTime(+ve+36e5*Me)},function(ve,Me){return(Me-ve)/36e5},function(ve){return ve.getHours()}),a=c.range,h=y(function(ve){ve.setHours(0,0,0,0)},function(ve,Me){ve.setDate(ve.getDate()+Me)},function(ve,Me){return(Me-ve-6e4*(Me.getTimezoneOffset()-ve.getTimezoneOffset()))/864e5},function(ve){return ve.getDate()-1}),l=h.range;function s(ve){return y(function(Me){Me.setDate(Me.getDate()-(Me.getDay()+7-ve)%7),Me.setHours(0,0,0,0)},function(Me,we){Me.setDate(Me.getDate()+7*we)},function(Me,we){return(we-Me-6e4*(we.getTimezoneOffset()-Me.getTimezoneOffset()))/6048e5})}var p=s(0),u=s(1),i=s(2),x=s(3),f=s(4),_=s(5),b=s(6),T=p.range,k=u.range,L=i.range,A=x.range,I=f.range,P=_.range,S=b.range,E=y(function(ve){ve.setDate(1),ve.setHours(0,0,0,0)},function(ve,Me){ve.setMonth(ve.getMonth()+Me)},function(ve,Me){return Me.getMonth()-ve.getMonth()+12*(Me.getFullYear()-ve.getFullYear())},function(ve){return ve.getMonth()}),z=E.range,D=y(function(ve){ve.setMonth(0,1),ve.setHours(0,0,0,0)},function(ve,Me){ve.setFullYear(ve.getFullYear()+Me)},function(ve,Me){return Me.getFullYear()-ve.getFullYear()},function(ve){return ve.getFullYear()});D.every=function(ve){return isFinite(ve=Math.floor(ve))&&ve>0?y(function(Me){Me.setFullYear(Math.floor(Me.getFullYear()/ve)*ve),Me.setMonth(0,1),Me.setHours(0,0,0,0)},function(Me,we){Me.setFullYear(Me.getFullYear()+we*ve)}):null};var j=D.range,V=y(function(ve){ve.setUTCSeconds(0,0)},function(ve,Me){ve.setTime(+ve+6e4*Me)},function(ve,Me){return(Me-ve)/6e4},function(ve){return ve.getUTCMinutes()}),Z=V.range,Q=y(function(ve){ve.setUTCMinutes(0,0,0)},function(ve,Me){ve.setTime(+ve+36e5*Me)},function(ve,Me){return(Me-ve)/36e5},function(ve){return ve.getUTCHours()}),X=Q.range,$=y(function(ve){ve.setUTCHours(0,0,0,0)},function(ve,Me){ve.setUTCDate(ve.getUTCDate()+Me)},function(ve,Me){return(Me-ve)/864e5},function(ve){return ve.getUTCDate()-1}),re=$.range;function H(ve){return y(function(Me){Me.setUTCDate(Me.getUTCDate()-(Me.getUTCDay()+7-ve)%7),Me.setUTCHours(0,0,0,0)},function(Me,we){Me.setUTCDate(Me.getUTCDate()+7*we)},function(Me,we){return(we-Me)/6048e5})}var N=H(0),U=H(1),te=H(2),B=H(3),K=H(4),J=H(5),ee=H(6),ne=N.range,se=U.range,oe=te.range,me=B.range,ce=K.range,ye=J.range,Se=ee.range,fe=y(function(ve){ve.setUTCDate(1),ve.setUTCHours(0,0,0,0)},function(ve,Me){ve.setUTCMonth(ve.getUTCMonth()+Me)},function(ve,Me){return Me.getUTCMonth()-ve.getUTCMonth()+12*(Me.getUTCFullYear()-ve.getUTCFullYear())},function(ve){return ve.getUTCMonth()}),ge=fe.range,Te=y(function(ve){ve.setUTCMonth(0,1),ve.setUTCHours(0,0,0,0)},function(ve,Me){ve.setUTCFullYear(ve.getUTCFullYear()+Me)},function(ve,Me){return Me.getUTCFullYear()-ve.getUTCFullYear()},function(ve){return ve.getUTCFullYear()});Te.every=function(ve){return isFinite(ve=Math.floor(ve))&&ve>0?y(function(Me){Me.setUTCFullYear(Math.floor(Me.getUTCFullYear()/ve)*ve),Me.setUTCMonth(0,1),Me.setUTCHours(0,0,0,0)},function(Me,we){Me.setUTCFullYear(Me.getUTCFullYear()+we*ve)}):null};var le=Te.range;d.timeDay=h,d.timeDays=l,d.timeFriday=_,d.timeFridays=P,d.timeHour=c,d.timeHours=a,d.timeInterval=y,d.timeMillisecond=e,d.timeMilliseconds=t,d.timeMinute=r,d.timeMinutes=g,d.timeMonday=u,d.timeMondays=k,d.timeMonth=E,d.timeMonths=z,d.timeSaturday=b,d.timeSaturdays=S,d.timeSecond=n,d.timeSeconds=o,d.timeSunday=p,d.timeSundays=T,d.timeThursday=f,d.timeThursdays=I,d.timeTuesday=i,d.timeTuesdays=L,d.timeWednesday=x,d.timeWednesdays=A,d.timeWeek=p,d.timeWeeks=T,d.timeYear=D,d.timeYears=j,d.utcDay=$,d.utcDays=re,d.utcFriday=J,d.utcFridays=ye,d.utcHour=Q,d.utcHours=X,d.utcMillisecond=e,d.utcMilliseconds=t,d.utcMinute=V,d.utcMinutes=Z,d.utcMonday=U,d.utcMondays=se,d.utcMonth=fe,d.utcMonths=ge,d.utcSaturday=ee,d.utcSaturdays=Se,d.utcSecond=n,d.utcSeconds=o,d.utcSunday=N,d.utcSundays=ne,d.utcThursday=K,d.utcThursdays=ce,d.utcTuesday=te,d.utcTuesdays=oe,d.utcWednesday=B,d.utcWednesdays=me,d.utcWeek=N,d.utcWeeks=ne,d.utcYear=Te,d.utcYears=le,Object.defineProperty(d,"__esModule",{value:!0})})},{}],122:[function(m,G,Y){arguments[4][121][0].apply(Y,arguments)},{dup:121}],123:[function(m,G,Y){(function(d,v){v(typeof Y=="object"&&G!==void 0?Y:(d=d||self).d3=d.d3||{})})(this,function(d){var v,w,y=0,e=0,t=0,n=0,o=0,r=0,g=typeof performance=="object"&&performance.now?performance:Date,c=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(f){setTimeout(f,17)};function a(){return o||(c(h),o=g.now()+r)}function h(){o=0}function l(){this._call=this._time=this._next=null}function s(f,_,b){var T=new l;return T.restart(f,_,b),T}function p(){a(),++y;for(var f,_=v;_;)(f=o-_._time)>=0&&_._call.call(null,f),_=_._next;--y}function u(){o=(n=g.now())+r,y=e=0;try{p()}finally{y=0,function(){for(var f,_,b=v,T=1/0;b;)b._call?(T>b._time&&(T=b._time),f=b,b=b._next):(_=b._next,b._next=null,b=f?f._next=_:v=_);w=f,x(T)}(),o=0}}function i(){var f=g.now(),_=f-n;_>1e3&&(r-=_,n=f)}function x(f){y||(e&&(e=clearTimeout(e)),f-o>24?(f<1/0&&(e=setTimeout(u,f-g.now()-r)),t&&(t=clearInterval(t))):(t||(n=g.now(),t=setInterval(i,1e3)),y=1,c(u)))}l.prototype=s.prototype={constructor:l,restart:function(f,_,b){if(typeof f!="function")throw new TypeError("callback is not a function");b=(b==null?a():+b)+(_==null?0:+_),this._next||w===this||(w?w._next=this:v=this,w=this),this._call=f,this._time=b,x()},stop:function(){this._call&&(this._call=null,this._time=1/0,x())}},d.interval=function(f,_,b){var T=new l,k=_;return _==null?(T.restart(f,_,b),T):(_=+_,b=b==null?a():+b,T.restart(function L(A){A+=k,T.restart(L,k+=_,b),f(A)},_,b),T)},d.now=a,d.timeout=function(f,_,b){var T=new l;return _=_==null?0:+_,T.restart(function(k){T.stop(),f(k+_)},_,b),T},d.timer=s,d.timerFlush=p,Object.defineProperty(d,"__esModule",{value:!0})})},{}],124:[function(m,G,Y){G.exports=function(){for(var d=0;d<arguments.length;d++)if(arguments[d]!==void 0)return arguments[d]}},{}],125:[function(m,G,Y){G.exports=w;var d=(w.canvas=document.createElement("canvas")).getContext("2d"),v=y([32,126]);function w(e,t){Array.isArray(e)&&(e=e.join(", "));var n,o={},r=16,g=.05;t&&(t.length===2&&typeof t[0]=="number"?n=y(t):Array.isArray(t)?n=t:(t.o?n=y(t.o):t.pairs&&(n=t.pairs),t.fontSize&&(r=t.fontSize),t.threshold!=null&&(g=t.threshold))),n||(n=v),d.font=r+"px "+e;for(var c=0;c<n.length;c++){var a=n[c],h=d.measureText(a[0]).width+d.measureText(a[1]).width,l=d.measureText(a).width;if(Math.abs(h-l)>r*g){var s=(l-h)/r;o[a]=1e3*s}}return o}function y(e){for(var t=[],n=e[0];n<=e[1];n++)for(var o=String.fromCharCode(n),r=e[0];r<e[1];r++){var g=o+String.fromCharCode(r);t.push(g)}return t}w.createPairs=y,w.ascii=v},{}],126:[function(m,G,Y){var d=m("abs-svg-path"),v=m("normalize-svg-path"),w={M:"moveTo",C:"bezierCurveTo"};G.exports=function(y,e){y.beginPath(),v(d(e)).forEach(function(t){var n=t[0],o=t.slice(1);y[w[n]].apply(y,o)}),y.closePath()}},{"abs-svg-path":70,"normalize-svg-path":246}],127:[function(m,G,Y){G.exports=function(d){switch(d){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],128:[function(m,G,Y){G.exports=function(d,v){switch(v===void 0&&(v=0),typeof d){case"number":if(d>0)return function(w,y){var e,t;for(e=new Array(w),t=0;t<w;++t)e[t]=y;return e}(0|d,v);break;case"object":if(typeof d.length=="number")return function w(y,e,t){var n=0|y[t];if(n<=0)return[];var o,r=new Array(n);if(t===y.length-1)for(o=0;o<n;++o)r[o]=e;else for(o=0;o<n;++o)r[o]=w(y,e,t+1);return r}(d,v,0)}return[]}},{}],129:[function(m,G,Y){function d(I,P,S){S=S||2;var E,z,D,j,V,Z,Q,X=P&&P.length,$=X?P[0]*S:I.length,re=v(I,0,$,S,!0),H=[];if(!re||re.next===re.prev)return H;if(X&&(re=function(U,te,B,K){var J,ee,ne,se,oe,me=[];for(J=0,ee=te.length;J<ee;J++)ne=te[J]*K,se=J<ee-1?te[J+1]*K:U.length,(oe=v(U,ne,se,K,!1))===oe.next&&(oe.steiner=!0),me.push(h(oe));for(me.sort(r),J=0;J<me.length;J++)g(me[J],B),B=w(B,B.next);return B}(I,P,re,S)),I.length>80*S){E=D=I[0],z=j=I[1];for(var N=S;N<$;N+=S)(V=I[N])<E&&(E=V),(Z=I[N+1])<z&&(z=Z),V>D&&(D=V),Z>j&&(j=Z);Q=(Q=Math.max(D-E,j-z))!==0?1/Q:0}return y(re,H,S,E,z,Q),H}function v(I,P,S,E,z){var D,j;if(z===A(I,P,S,E)>0)for(D=P;D<S;D+=E)j=T(D,I[D],I[D+1],j);else for(D=S-E;D>=P;D-=E)j=T(D,I[D],I[D+1],j);return j&&u(j,j.next)&&(k(j),j=j.next),j}function w(I,P){if(!I)return I;P||(P=I);var S,E=I;do if(S=!1,E.steiner||!u(E,E.next)&&p(E.prev,E,E.next)!==0)E=E.next;else{if(k(E),(E=P=E.prev)===E.next)break;S=!0}while(S||E!==P);return P}function y(I,P,S,E,z,D,j){if(I){!j&&D&&function(X,$,re,H){var N=X;do N.z===null&&(N.z=a(N.x,N.y,$,re,H)),N.prevZ=N.prev,N.nextZ=N.next,N=N.next;while(N!==X);N.prevZ.nextZ=null,N.prevZ=null,function(U){var te,B,K,J,ee,ne,se,oe,me=1;do{for(B=U,U=null,ee=null,ne=0;B;){for(ne++,K=B,se=0,te=0;te<me&&(se++,K=K.nextZ);te++);for(oe=me;se>0||oe>0&&K;)se!==0&&(oe===0||!K||B.z<=K.z)?(J=B,B=B.nextZ,se--):(J=K,K=K.nextZ,oe--),ee?ee.nextZ=J:U=J,J.prevZ=ee,ee=J;B=K}ee.nextZ=null,me*=2}while(ne>1)}(N)}(I,E,z,D);for(var V,Z,Q=I;I.prev!==I.next;)if(V=I.prev,Z=I.next,D?t(I,E,z,D):e(I))P.push(V.i/S),P.push(I.i/S),P.push(Z.i/S),k(I),I=Z.next,Q=Z.next;else if((I=Z)===Q){j?j===1?y(I=n(w(I),P,S),P,S,E,z,D,2):j===2&&o(I,P,S,E,z,D):y(w(I),P,S,E,z,D,1);break}}}function e(I){var P=I.prev,S=I,E=I.next;if(p(P,S,E)>=0)return!1;for(var z=I.next.next;z!==I.prev;){if(l(P.x,P.y,S.x,S.y,E.x,E.y,z.x,z.y)&&p(z.prev,z,z.next)>=0)return!1;z=z.next}return!0}function t(I,P,S,E){var z=I.prev,D=I,j=I.next;if(p(z,D,j)>=0)return!1;for(var V=z.x<D.x?z.x<j.x?z.x:j.x:D.x<j.x?D.x:j.x,Z=z.y<D.y?z.y<j.y?z.y:j.y:D.y<j.y?D.y:j.y,Q=z.x>D.x?z.x>j.x?z.x:j.x:D.x>j.x?D.x:j.x,X=z.y>D.y?z.y>j.y?z.y:j.y:D.y>j.y?D.y:j.y,$=a(V,Z,P,S,E),re=a(Q,X,P,S,E),H=I.prevZ,N=I.nextZ;H&&H.z>=$&&N&&N.z<=re;){if(H!==I.prev&&H!==I.next&&l(z.x,z.y,D.x,D.y,j.x,j.y,H.x,H.y)&&p(H.prev,H,H.next)>=0||(H=H.prevZ,N!==I.prev&&N!==I.next&&l(z.x,z.y,D.x,D.y,j.x,j.y,N.x,N.y)&&p(N.prev,N,N.next)>=0))return!1;N=N.nextZ}for(;H&&H.z>=$;){if(H!==I.prev&&H!==I.next&&l(z.x,z.y,D.x,D.y,j.x,j.y,H.x,H.y)&&p(H.prev,H,H.next)>=0)return!1;H=H.prevZ}for(;N&&N.z<=re;){if(N!==I.prev&&N!==I.next&&l(z.x,z.y,D.x,D.y,j.x,j.y,N.x,N.y)&&p(N.prev,N,N.next)>=0)return!1;N=N.nextZ}return!0}function n(I,P,S){var E=I;do{var z=E.prev,D=E.next.next;!u(z,D)&&i(z,E,E.next,D)&&_(z,D)&&_(D,z)&&(P.push(z.i/S),P.push(E.i/S),P.push(D.i/S),k(E),k(E.next),E=I=D),E=E.next}while(E!==I);return w(E)}function o(I,P,S,E,z,D){var j=I;do{for(var V=j.next.next;V!==j.prev;){if(j.i!==V.i&&s(j,V)){var Z=b(j,V);return j=w(j,j.next),Z=w(Z,Z.next),y(j,P,S,E,z,D),void y(Z,P,S,E,z,D)}V=V.next}j=j.next}while(j!==I)}function r(I,P){return I.x-P.x}function g(I,P){if(P=function(E,z){var D,j=z,V=E.x,Z=E.y,Q=-1/0;do{if(Z<=j.y&&Z>=j.next.y&&j.next.y!==j.y){var X=j.x+(Z-j.y)*(j.next.x-j.x)/(j.next.y-j.y);if(X<=V&&X>Q){if(Q=X,X===V){if(Z===j.y)return j;if(Z===j.next.y)return j.next}D=j.x<j.next.x?j:j.next}}j=j.next}while(j!==z);if(!D)return null;if(V===Q)return D;var $,re=D,H=D.x,N=D.y,U=1/0;j=D;do V>=j.x&&j.x>=H&&V!==j.x&&l(Z<N?V:Q,Z,H,N,Z<N?Q:V,Z,j.x,j.y)&&($=Math.abs(Z-j.y)/(V-j.x),_(j,E)&&($<U||$===U&&(j.x>D.x||j.x===D.x&&c(D,j)))&&(D=j,U=$)),j=j.next;while(j!==re);return D}(I,P)){var S=b(P,I);w(P,P.next),w(S,S.next)}}function c(I,P){return p(I.prev,I,P.prev)<0&&p(P.next,I,I.next)<0}function a(I,P,S,E,z){return(I=1431655765&((I=858993459&((I=252645135&((I=16711935&((I=32767*(I-S)*z)|I<<8))|I<<4))|I<<2))|I<<1))|(P=1431655765&((P=858993459&((P=252645135&((P=16711935&((P=32767*(P-E)*z)|P<<8))|P<<4))|P<<2))|P<<1))<<1}function h(I){var P=I,S=I;do(P.x<S.x||P.x===S.x&&P.y<S.y)&&(S=P),P=P.next;while(P!==I);return S}function l(I,P,S,E,z,D,j,V){return(z-j)*(P-V)-(I-j)*(D-V)>=0&&(I-j)*(E-V)-(S-j)*(P-V)>=0&&(S-j)*(D-V)-(z-j)*(E-V)>=0}function s(I,P){return I.next.i!==P.i&&I.prev.i!==P.i&&!function(S,E){var z=S;do{if(z.i!==S.i&&z.next.i!==S.i&&z.i!==E.i&&z.next.i!==E.i&&i(z,z.next,S,E))return!0;z=z.next}while(z!==S);return!1}(I,P)&&(_(I,P)&&_(P,I)&&function(S,E){var z=S,D=!1,j=(S.x+E.x)/2,V=(S.y+E.y)/2;do z.y>V!=z.next.y>V&&z.next.y!==z.y&&j<(z.next.x-z.x)*(V-z.y)/(z.next.y-z.y)+z.x&&(D=!D),z=z.next;while(z!==S);return D}(I,P)&&(p(I.prev,I,P.prev)||p(I,P.prev,P))||u(I,P)&&p(I.prev,I,I.next)>0&&p(P.prev,P,P.next)>0)}function p(I,P,S){return(P.y-I.y)*(S.x-P.x)-(P.x-I.x)*(S.y-P.y)}function u(I,P){return I.x===P.x&&I.y===P.y}function i(I,P,S,E){var z=f(p(I,P,S)),D=f(p(I,P,E)),j=f(p(S,E,I)),V=f(p(S,E,P));return z!==D&&j!==V||!(z!==0||!x(I,S,P))||!(D!==0||!x(I,E,P))||!(j!==0||!x(S,I,E))||!(V!==0||!x(S,P,E))}function x(I,P,S){return P.x<=Math.max(I.x,S.x)&&P.x>=Math.min(I.x,S.x)&&P.y<=Math.max(I.y,S.y)&&P.y>=Math.min(I.y,S.y)}function f(I){return I>0?1:I<0?-1:0}function _(I,P){return p(I.prev,I,I.next)<0?p(I,P,I.next)>=0&&p(I,I.prev,P)>=0:p(I,P,I.prev)<0||p(I,I.next,P)<0}function b(I,P){var S=new L(I.i,I.x,I.y),E=new L(P.i,P.x,P.y),z=I.next,D=P.prev;return I.next=P,P.prev=I,S.next=z,z.prev=S,E.next=S,S.prev=E,D.next=E,E.prev=D,E}function T(I,P,S,E){var z=new L(I,P,S);return E?(z.next=E.next,z.prev=E,E.next.prev=z,E.next=z):(z.prev=z,z.next=z),z}function k(I){I.next.prev=I.prev,I.prev.next=I.next,I.prevZ&&(I.prevZ.nextZ=I.nextZ),I.nextZ&&(I.nextZ.prevZ=I.prevZ)}function L(I,P,S){this.i=I,this.x=P,this.y=S,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function A(I,P,S,E){for(var z=0,D=P,j=S-E;D<S;D+=E)z+=(I[j]-I[D])*(I[D+1]+I[j+1]),j=D;return z}G.exports=d,G.exports.default=d,d.deviation=function(I,P,S,E){var z=P&&P.length,D=z?P[0]*S:I.length,j=Math.abs(A(I,0,D,S));if(z)for(var V=0,Z=P.length;V<Z;V++){var Q=P[V]*S,X=V<Z-1?P[V+1]*S:I.length;j-=Math.abs(A(I,Q,X,S))}var $=0;for(V=0;V<E.length;V+=3){var re=E[V]*S,H=E[V+1]*S,N=E[V+2]*S;$+=Math.abs((I[re]-I[N])*(I[H+1]-I[re+1])-(I[re]-I[H])*(I[N+1]-I[re+1]))}return j===0&&$===0?0:Math.abs(($-j)/j)},d.flatten=function(I){for(var P=I[0][0].length,S={vertices:[],holes:[],dimensions:P},E=0,z=0;z<I.length;z++){for(var D=0;D<I[z].length;D++)for(var j=0;j<P;j++)S.vertices.push(I[z][D][j]);z>0&&(E+=I[z-1].length,S.holes.push(E))}return S}},{}],130:[function(m,G,Y){var d=m("strongly-connected-components");G.exports=function(v,w){var y,e=[],t=[],n=[],o={},r=[];function g(i){var x,f,_=!1;for(t.push(i),n[i]=!0,x=0;x<r[i].length;x++)(f=r[i][x])===y?(c(y,t),_=!0):n[f]||(_=g(f));if(_)(function T(k){n[k]=!1,o.hasOwnProperty(k)&&Object.keys(o[k]).forEach(function(L){delete o[k][L],n[L]&&T(L)})})(i);else for(x=0;x<r[i].length;x++){f=r[i][x];var b=o[f];b||(b={},o[f]=b),b[f]=!0}return t.pop(),_}function c(i,x){var f=[].concat(x).concat(i);w?w(g):e.push(f)}function a(i){(function(L){for(var A=0;A<v.length;A++)A<L&&(v[A]=[]),v[A]=v[A].filter(function(I){return I>=L})})(i);for(var x,f=d(v).components.filter(function(L){return L.length>1}),_=1/0,b=0;b<f.length;b++)for(var T=0;T<f[b].length;T++)f[b][T]<_&&(_=f[b][T],x=b);var k=f[x];return!!k&&{leastVertex:_,adjList:v.map(function(L,A){return k.indexOf(A)===-1?[]:L.filter(function(I){return k.indexOf(I)!==-1})})}}y=0;for(var h=v.length;y<h;){var l=a(y);if(y=l.leastVertex,r=l.adjList){for(var s=0;s<r.length;s++)for(var p=0;p<r[s].length;p++){var u=r[s][p];n[+u]=!1,o[u]={}}g(y),y+=1}else y=h}return w?void 0:e}},{"strongly-connected-components":307}],131:[function(m,G,Y){var d=m("../../object/valid-value");G.exports=function(){return d(this).length=0,this}},{"../../object/valid-value":162}],132:[function(m,G,Y){G.exports=m("./is-implemented")()?Array.from:m("./shim")},{"./is-implemented":133,"./shim":134}],133:[function(m,G,Y){G.exports=function(){var d,v,w=Array.from;return typeof w=="function"&&(v=w(d=["raz","dwa"]),Boolean(v&&v!==d&&v[1]==="dwa"))}},{}],134:[function(m,G,Y){var d=m("es6-symbol").iterator,v=m("../../function/is-arguments"),w=m("../../function/is-function"),y=m("../../number/to-pos-integer"),e=m("../../object/valid-callable"),t=m("../../object/valid-value"),n=m("../../object/is-value"),o=m("../../string/is-string"),r=Array.isArray,g=Function.prototype.call,c={configurable:!0,enumerable:!0,writable:!0,value:null},a=Object.defineProperty;G.exports=function(h){var l,s,p,u,i,x,f,_,b,T,k=arguments[1],L=arguments[2];if(h=Object(t(h)),n(k)&&e(k),this&&this!==Array&&w(this))l=this;else{if(!k){if(v(h))return(i=h.length)!==1?Array.apply(null,h):((u=new Array(1))[0]=h[0],u);if(r(h)){for(u=new Array(i=h.length),s=0;s<i;++s)u[s]=h[s];return u}}u=[]}if(!r(h)){if((b=h[d])!==void 0){for(f=e(b).call(h),l&&(u=new l),_=f.next(),s=0;!_.done;)T=k?g.call(k,L,_.value,s):_.value,l?(c.value=T,a(u,s,c)):u[s]=T,_=f.next(),++s;i=s}else if(o(h)){for(i=h.length,l&&(u=new l),s=0,p=0;s<i;++s)T=h[s],s+1<i&&(x=T.charCodeAt(0))>=55296&&x<=56319&&(T+=h[++s]),T=k?g.call(k,L,T,p):T,l?(c.value=T,a(u,p,c)):u[p]=T,++p;i=p}}if(i===void 0)for(i=y(h.length),l&&(u=new l(i)),s=0;s<i;++s)T=k?g.call(k,L,h[s],s):h[s],l?(c.value=T,a(u,s,c)):u[s]=T;return l&&(c.value=null,u.length=i),u}},{"../../function/is-arguments":135,"../../function/is-function":136,"../../number/to-pos-integer":142,"../../object/is-value":151,"../../object/valid-callable":160,"../../object/valid-value":162,"../../string/is-string":166,"es6-symbol":175}],135:[function(m,G,Y){var d=Object.prototype.toString,v=d.call(function(){return arguments}());G.exports=function(w){return d.call(w)===v}},{}],136:[function(m,G,Y){var d=Object.prototype.toString,v=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);G.exports=function(w){return typeof w=="function"&&v(d.call(w))}},{}],137:[function(m,G,Y){G.exports=function(){}},{}],138:[function(m,G,Y){G.exports=m("./is-implemented")()?Math.sign:m("./shim")},{"./is-implemented":139,"./shim":140}],139:[function(m,G,Y){G.exports=function(){var d=Math.sign;return typeof d=="function"&&d(10)===1&&d(-20)===-1}},{}],140:[function(m,G,Y){G.exports=function(d){return d=Number(d),isNaN(d)||d===0?d:d>0?1:-1}},{}],141:[function(m,G,Y){var d=m("../math/sign"),v=Math.abs,w=Math.floor;G.exports=function(y){return isNaN(y)?0:(y=Number(y))!==0&&isFinite(y)?d(y)*w(v(y)):y}},{"../math/sign":138}],142:[function(m,G,Y){var d=m("./to-integer"),v=Math.max;G.exports=function(w){return v(0,d(w))}},{"./to-integer":141}],143:[function(m,G,Y){var d=m("./valid-callable"),v=m("./valid-value"),w=Function.prototype.bind,y=Function.prototype.call,e=Object.keys,t=Object.prototype.propertyIsEnumerable;G.exports=function(n,o){return function(r,g){var c,a=arguments[2],h=arguments[3];return r=Object(v(r)),d(g),c=e(r),h&&c.sort(typeof h=="function"?w.call(h,r):void 0),typeof n!="function"&&(n=c[n]),y.call(n,c,function(l,s){return t.call(r,l)?y.call(g,a,r[l],l,r,s):o})}}},{"./valid-callable":160,"./valid-value":162}],144:[function(m,G,Y){G.exports=m("./is-implemented")()?Object.assign:m("./shim")},{"./is-implemented":145,"./shim":146}],145:[function(m,G,Y){G.exports=function(){var d,v=Object.assign;return typeof v=="function"&&(v(d={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),d.foo+d.bar+d.trzy==="razdwatrzy")}},{}],146:[function(m,G,Y){var d=m("../keys"),v=m("../valid-value"),w=Math.max;G.exports=function(y,e){var t,n,o,r=w(arguments.length,2);for(y=Object(v(y)),o=function(g){try{y[g]=e[g]}catch(c){t||(t=c)}},n=1;n<r;++n)d(e=arguments[n]).forEach(o);if(t!==void 0)throw t;return y}},{"../keys":152,"../valid-value":162}],147:[function(m,G,Y){var d=m("../array/from"),v=m("./assign"),w=m("./valid-value");G.exports=function(y){var e=Object(w(y)),t=arguments[1],n=Object(arguments[2]);if(e!==y&&!t)return e;var o={};return t?d(t,function(r){(n.ensure||r in y)&&(o[r]=y[r])}):v(o,y),o}},{"../array/from":132,"./assign":144,"./valid-value":162}],148:[function(m,G,Y){var d,v,w,y,e=Object.create;m("./set-prototype-of/is-implemented")()||(d=m("./set-prototype-of/shim")),G.exports=d?d.level!==1?e:(v={},w={},y={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(t){w[t]=t!=="__proto__"?y:{configurable:!0,enumerable:!1,writable:!0,value:void 0}}),Object.defineProperties(v,w),Object.defineProperty(d,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:v}),function(t,n){return e(t===null?v:t,n)}):e},{"./set-prototype-of/is-implemented":158,"./set-prototype-of/shim":159}],149:[function(m,G,Y){G.exports=m("./_iterate")("forEach")},{"./_iterate":143}],150:[function(m,G,Y){var d=m("./is-value"),v={function:!0,object:!0};G.exports=function(w){return d(w)&&v[typeof w]||!1}},{"./is-value":151}],151:[function(m,G,Y){var d=m("../function/noop")();G.exports=function(v){return v!==d&&v!==null}},{"../function/noop":137}],152:[function(m,G,Y){G.exports=m("./is-implemented")()?Object.keys:m("./shim")},{"./is-implemented":153,"./shim":154}],153:[function(m,G,Y){G.exports=function(){try{return Object.keys("primitive"),!0}catch{return!1}}},{}],154:[function(m,G,Y){var d=m("../is-value"),v=Object.keys;G.exports=function(w){return v(d(w)?Object(w):w)}},{"../is-value":151}],155:[function(m,G,Y){var d=m("./valid-callable"),v=m("./for-each"),w=Function.prototype.call;G.exports=function(y,e){var t={},n=arguments[2];return d(e),v(y,function(o,r,g,c){t[r]=w.call(e,n,o,r,g,c)}),t}},{"./for-each":149,"./valid-callable":160}],156:[function(m,G,Y){var d=m("./is-value"),v=Array.prototype.forEach,w=Object.create,y=function(e,t){var n;for(n in e)t[n]=e[n]};G.exports=function(e){var t=w(null);return v.call(arguments,function(n){d(n)&&y(Object(n),t)}),t}},{"./is-value":151}],157:[function(m,G,Y){G.exports=m("./is-implemented")()?Object.setPrototypeOf:m("./shim")},{"./is-implemented":158,"./shim":159}],158:[function(m,G,Y){var d=Object.create,v=Object.getPrototypeOf,w={};G.exports=function(){var y=Object.setPrototypeOf,e=arguments[0]||d;return typeof y=="function"&&v(y(e(null),w))===w}},{}],159:[function(m,G,Y){var d,v=m("../is-object"),w=m("../valid-value"),y=Object.prototype.isPrototypeOf,e=Object.defineProperty,t={configurable:!0,enumerable:!1,writable:!0,value:void 0};d=function(n,o){if(w(n),o===null||v(o))return n;throw new TypeError("Prototype must be null or an object")},G.exports=function(n){var o,r;return n?(n.level===2?n.set?(r=n.set,o=function(g,c){return r.call(d(g,c),c),g}):o=function(g,c){return d(g,c).__proto__=c,g}:o=function g(c,a){var h;return d(c,a),(h=y.call(g.nullPolyfill,c))&&delete g.nullPolyfill.__proto__,a===null&&(a=g.nullPolyfill),c.__proto__=a,h&&e(g.nullPolyfill,"__proto__",t),c},Object.defineProperty(o,"level",{configurable:!1,enumerable:!1,writable:!1,value:n.level})):null}(function(){var n,o=Object.create(null),r={},g=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(g){try{(n=g.set).call(o,r)}catch{}if(Object.getPrototypeOf(o)===r)return{set:n,level:2}}return o.__proto__=r,Object.getPrototypeOf(o)===r?{level:2}:((o={}).__proto__=r,Object.getPrototypeOf(o)===r&&{level:1})}()),m("../create")},{"../create":148,"../is-object":150,"../valid-value":162}],160:[function(m,G,Y){G.exports=function(d){if(typeof d!="function")throw new TypeError(d+" is not a function");return d}},{}],161:[function(m,G,Y){var d=m("./is-object");G.exports=function(v){if(!d(v))throw new TypeError(v+" is not an Object");return v}},{"./is-object":150}],162:[function(m,G,Y){var d=m("./is-value");G.exports=function(v){if(!d(v))throw new TypeError("Cannot use null or undefined");return v}},{"./is-value":151}],163:[function(m,G,Y){G.exports=m("./is-implemented")()?String.prototype.contains:m("./shim")},{"./is-implemented":164,"./shim":165}],164:[function(m,G,Y){var d="razdwatrzy";G.exports=function(){return typeof d.contains=="function"&&d.contains("dwa")===!0&&d.contains("foo")===!1}},{}],165:[function(m,G,Y){var d=String.prototype.indexOf;G.exports=function(v){return d.call(this,v,arguments[1])>-1}},{}],166:[function(m,G,Y){var d=Object.prototype.toString,v=d.call("");G.exports=function(w){return typeof w=="string"||w&&typeof w=="object"&&(w instanceof String||d.call(w)===v)||!1}},{}],167:[function(m,G,Y){var d=Object.create(null),v=Math.random;G.exports=function(){var w;do w=v().toString(36).slice(2);while(d[w]);return w}},{}],168:[function(m,G,Y){var d,v=m("es5-ext/object/set-prototype-of"),w=m("es5-ext/string/#/contains"),y=m("d"),e=m("es6-symbol"),t=m("./"),n=Object.defineProperty;d=G.exports=function(o,r){if(!(this instanceof d))throw new TypeError("Constructor requires 'new'");t.call(this,o),r=r?w.call(r,"key+value")?"key+value":w.call(r,"key")?"key":"value":"value",n(this,"__kind__",y("",r))},v&&v(d,t),delete d.prototype.constructor,d.prototype=Object.create(t.prototype,{_resolve:y(function(o){return this.__kind__==="value"?this.__list__[o]:this.__kind__==="key+value"?[o,this.__list__[o]]:o})}),n(d.prototype,e.toStringTag,y("c","Array Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es5-ext/string/#/contains":163,"es6-symbol":175}],169:[function(m,G,Y){var d=m("es5-ext/function/is-arguments"),v=m("es5-ext/object/valid-callable"),w=m("es5-ext/string/is-string"),y=m("./get"),e=Array.isArray,t=Function.prototype.call,n=Array.prototype.some;G.exports=function(o,r){var g,c,a,h,l,s,p,u,i=arguments[2];if(e(o)||d(o)?g="array":w(o)?g="string":o=y(o),v(r),a=function(){h=!0},g!=="array")if(g!=="string")for(c=o.next();!c.done;){if(t.call(r,i,c.value,a),h)return;c=o.next()}else for(s=o.length,l=0;l<s&&(p=o[l],l+1<s&&(u=p.charCodeAt(0))>=55296&&u<=56319&&(p+=o[++l]),t.call(r,i,p,a),!h);++l);else n.call(o,function(x){return t.call(r,i,x,a),h})}},{"./get":170,"es5-ext/function/is-arguments":135,"es5-ext/object/valid-callable":160,"es5-ext/string/is-string":166}],170:[function(m,G,Y){var d=m("es5-ext/function/is-arguments"),v=m("es5-ext/string/is-string"),w=m("./array"),y=m("./string"),e=m("./valid-iterable"),t=m("es6-symbol").iterator;G.exports=function(n){return typeof e(n)[t]=="function"?n[t]():d(n)?new w(n):v(n)?new y(n):new w(n)}},{"./array":168,"./string":173,"./valid-iterable":174,"es5-ext/function/is-arguments":135,"es5-ext/string/is-string":166,"es6-symbol":175}],171:[function(m,G,Y){var d,v=m("es5-ext/array/#/clear"),w=m("es5-ext/object/assign"),y=m("es5-ext/object/valid-callable"),e=m("es5-ext/object/valid-value"),t=m("d"),n=m("d/auto-bind"),o=m("es6-symbol"),r=Object.defineProperty,g=Object.defineProperties;G.exports=d=function(c,a){if(!(this instanceof d))throw new TypeError("Constructor requires 'new'");g(this,{__list__:t("w",e(c)),__context__:t("w",a),__nextIndex__:t("w",0)}),a&&(y(a.on),a.on("_add",this._onAdd),a.on("_delete",this._onDelete),a.on("_clear",this._onClear))},delete d.prototype.constructor,g(d.prototype,w({_next:t(function(){var c;if(this.__list__)return this.__redo__&&(c=this.__redo__.shift())!==void 0?c:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()}),next:t(function(){return this._createResult(this._next())}),_createResult:t(function(c){return c===void 0?{done:!0,value:void 0}:{done:!1,value:this._resolve(c)}}),_resolve:t(function(c){return this.__list__[c]}),_unBind:t(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:t(function(){return"[object "+(this[o.toStringTag]||"Object")+"]"})},n({_onAdd:t(function(c){c>=this.__nextIndex__||(++this.__nextIndex__,this.__redo__?(this.__redo__.forEach(function(a,h){a>=c&&(this.__redo__[h]=++a)},this),this.__redo__.push(c)):r(this,"__redo__",t("c",[c])))}),_onDelete:t(function(c){var a;c>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&((a=this.__redo__.indexOf(c))!==-1&&this.__redo__.splice(a,1),this.__redo__.forEach(function(h,l){h>c&&(this.__redo__[l]=--h)},this)))}),_onClear:t(function(){this.__redo__&&v.call(this.__redo__),this.__nextIndex__=0})}))),r(d.prototype,o.iterator,t(function(){return this}))},{d:106,"d/auto-bind":105,"es5-ext/array/#/clear":131,"es5-ext/object/assign":144,"es5-ext/object/valid-callable":160,"es5-ext/object/valid-value":162,"es6-symbol":175}],172:[function(m,G,Y){var d=m("es5-ext/function/is-arguments"),v=m("es5-ext/object/is-value"),w=m("es5-ext/string/is-string"),y=m("es6-symbol").iterator,e=Array.isArray;G.exports=function(t){return!!v(t)&&(!!e(t)||!!w(t)||!!d(t)||typeof t[y]=="function")}},{"es5-ext/function/is-arguments":135,"es5-ext/object/is-value":151,"es5-ext/string/is-string":166,"es6-symbol":175}],173:[function(m,G,Y){var d,v=m("es5-ext/object/set-prototype-of"),w=m("d"),y=m("es6-symbol"),e=m("./"),t=Object.defineProperty;d=G.exports=function(n){if(!(this instanceof d))throw new TypeError("Constructor requires 'new'");n=String(n),e.call(this,n),t(this,"__length__",w("",n.length))},v&&v(d,e),delete d.prototype.constructor,d.prototype=Object.create(e.prototype,{_next:w(function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()}),_resolve:w(function(n){var o,r=this.__list__[n];return this.__nextIndex__===this.__length__?r:(o=r.charCodeAt(0))>=55296&&o<=56319?r+this.__list__[this.__nextIndex__++]:r})}),t(d.prototype,y.toStringTag,w("c","String Iterator"))},{"./":171,d:106,"es5-ext/object/set-prototype-of":157,"es6-symbol":175}],174:[function(m,G,Y){var d=m("./is-iterable");G.exports=function(v){if(!d(v))throw new TypeError(v+" is not iterable");return v}},{"./is-iterable":172}],175:[function(m,G,Y){G.exports=m("./is-implemented")()?m("ext/global-this").Symbol:m("./polyfill")},{"./is-implemented":176,"./polyfill":181,"ext/global-this":188}],176:[function(m,G,Y){var d=m("ext/global-this"),v={object:!0,symbol:!0};G.exports=function(){var w,y=d.Symbol;if(typeof y!="function")return!1;w=y("test symbol");try{String(w)}catch{return!1}return!!v[typeof y.iterator]&&!!v[typeof y.toPrimitive]&&!!v[typeof y.toStringTag]}},{"ext/global-this":188}],177:[function(m,G,Y){G.exports=function(d){return!!d&&(typeof d=="symbol"||!!d.constructor&&d.constructor.name==="Symbol"&&d[d.constructor.toStringTag]==="Symbol")}},{}],178:[function(m,G,Y){var d=m("d"),v=Object.create,w=Object.defineProperty,y=Object.prototype,e=v(null);G.exports=function(t){for(var n,o,r=0;e[t+(r||"")];)++r;return e[t+=r||""]=!0,w(y,n="@@"+t,d.gs(null,function(g){o||(o=!0,w(this,n,d(g)),o=!1)})),n}},{d:106}],179:[function(m,G,Y){var d=m("d"),v=m("ext/global-this").Symbol;G.exports=function(w){return Object.defineProperties(w,{hasInstance:d("",v&&v.hasInstance||w("hasInstance")),isConcatSpreadable:d("",v&&v.isConcatSpreadable||w("isConcatSpreadable")),iterator:d("",v&&v.iterator||w("iterator")),match:d("",v&&v.match||w("match")),replace:d("",v&&v.replace||w("replace")),search:d("",v&&v.search||w("search")),species:d("",v&&v.species||w("species")),split:d("",v&&v.split||w("split")),toPrimitive:d("",v&&v.toPrimitive||w("toPrimitive")),toStringTag:d("",v&&v.toStringTag||w("toStringTag")),unscopables:d("",v&&v.unscopables||w("unscopables"))})}},{d:106,"ext/global-this":188}],180:[function(m,G,Y){var d=m("d"),v=m("../../../validate-symbol"),w=Object.create(null);G.exports=function(y){return Object.defineProperties(y,{for:d(function(e){return w[e]?w[e]:w[e]=y(String(e))}),keyFor:d(function(e){var t;for(t in v(e),w)if(w[t]===e)return t})})}},{"../../../validate-symbol":182,d:106}],181:[function(m,G,Y){var d,v,w,y=m("d"),e=m("./validate-symbol"),t=m("ext/global-this").Symbol,n=m("./lib/private/generate-name"),o=m("./lib/private/setup/standard-symbols"),r=m("./lib/private/setup/symbol-registry"),g=Object.create,c=Object.defineProperties,a=Object.defineProperty;if(typeof t=="function")try{String(t()),w=!0}catch{}else t=null;v=function(h){if(this instanceof v)throw new TypeError("Symbol is not a constructor");return d(h)},G.exports=d=function h(l){var s;if(this instanceof h)throw new TypeError("Symbol is not a constructor");return w?t(l):(s=g(v.prototype),l=l===void 0?"":String(l),c(s,{__description__:y("",l),__name__:y("",n(l))}))},o(d),r(d),c(v.prototype,{constructor:y(d),toString:y("",function(){return this.__name__})}),c(d.prototype,{toString:y(function(){return"Symbol ("+e(this).__description__+")"}),valueOf:y(function(){return e(this)})}),a(d.prototype,d.toPrimitive,y("",function(){var h=e(this);return typeof h=="symbol"?h:h.toString()})),a(d.prototype,d.toStringTag,y("c","Symbol")),a(v.prototype,d.toStringTag,y("c",d.prototype[d.toStringTag])),a(v.prototype,d.toPrimitive,y("c",d.prototype[d.toPrimitive]))},{"./lib/private/generate-name":178,"./lib/private/setup/standard-symbols":179,"./lib/private/setup/symbol-registry":180,"./validate-symbol":182,d:106,"ext/global-this":188}],182:[function(m,G,Y){var d=m("./is-symbol");G.exports=function(v){if(!d(v))throw new TypeError(v+" is not a symbol");return v}},{"./is-symbol":177}],183:[function(m,G,Y){G.exports=m("./is-implemented")()?WeakMap:m("./polyfill")},{"./is-implemented":184,"./polyfill":186}],184:[function(m,G,Y){G.exports=function(){var d,v;if(typeof WeakMap!="function")return!1;try{d=new WeakMap([[v={},"one"],[{},"two"],[{},"three"]])}catch{return!1}return String(d)==="[object WeakMap]"&&typeof d.set=="function"&&d.set({},1)===d&&typeof d.delete=="function"&&typeof d.has=="function"&&d.get(v)==="one"}},{}],185:[function(m,G,Y){G.exports=typeof WeakMap=="function"&&Object.prototype.toString.call(new WeakMap)==="[object WeakMap]"},{}],186:[function(m,G,Y){var d,v=m("es5-ext/object/is-value"),w=m("es5-ext/object/set-prototype-of"),y=m("es5-ext/object/valid-object"),e=m("es5-ext/object/valid-value"),t=m("es5-ext/string/random-uniq"),n=m("d"),o=m("es6-iterator/get"),r=m("es6-iterator/for-of"),g=m("es6-symbol").toStringTag,c=m("./is-native-implemented"),a=Array.isArray,h=Object.defineProperty,l=Object.prototype.hasOwnProperty,s=Object.getPrototypeOf;G.exports=d=function(){var p,u=arguments[0];if(!(this instanceof d))throw new TypeError("Constructor requires 'new'");return p=c&&w&&WeakMap!==d?w(new WeakMap,s(this)):this,v(u)&&(a(u)||(u=o(u))),h(p,"__weakMapData__",n("c","$weakMap$"+t())),u&&r(u,function(i){e(i),p.set(i[0],i[1])}),p},c&&(w&&w(d,WeakMap),d.prototype=Object.create(WeakMap.prototype,{constructor:n(d)})),Object.defineProperties(d.prototype,{delete:n(function(p){return!!l.call(y(p),this.__weakMapData__)&&(delete p[this.__weakMapData__],!0)}),get:n(function(p){if(l.call(y(p),this.__weakMapData__))return p[this.__weakMapData__]}),has:n(function(p){return l.call(y(p),this.__weakMapData__)}),set:n(function(p,u){return h(y(p),this.__weakMapData__,n("c",u)),this}),toString:n(function(){return"[object WeakMap]"})}),h(d.prototype,g,n("c","WeakMap"))},{"./is-native-implemented":185,d:106,"es5-ext/object/is-value":151,"es5-ext/object/set-prototype-of":157,"es5-ext/object/valid-object":161,"es5-ext/object/valid-value":162,"es5-ext/string/random-uniq":167,"es6-iterator/for-of":169,"es6-iterator/get":170,"es6-symbol":175}],187:[function(m,G,Y){var d=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};G.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return d()}try{return __global__||d()}finally{delete Object.prototype.__global__}}()},{}],188:[function(m,G,Y){G.exports=m("./is-implemented")()?globalThis:m("./implementation")},{"./implementation":187,"./is-implemented":189}],189:[function(m,G,Y){G.exports=function(){return typeof globalThis=="object"&&!!globalThis&&globalThis.Array===Array}},{}],190:[function(m,G,Y){var d=m("is-string-blank");G.exports=function(v){var w=typeof v;if(w==="string"){var y=v;if((v=+v)==0&&d(y))return!1}else if(w!=="number")return!1;return v-v<1}},{"is-string-blank":237}],191:[function(m,G,Y){var d=m("dtype");G.exports=function(v,w,y){if(!v)throw new TypeError("must specify data as first parameter");if(y=0|+(y||0),Array.isArray(v)&&v[0]&&typeof v[0][0]=="number"){var e,t,n,o,r=v[0].length,g=v.length*r;w&&typeof w!="string"||(w=new(d(w||"float32"))(g+y));var c=w.length-y;if(g!==c)throw new Error("source length "+g+" ("+r+"x"+v.length+") does not match destination length "+c);for(e=0,n=y;e<v.length;e++)for(t=0;t<r;t++)w[n++]=v[e][t]===null?NaN:v[e][t]}else if(w&&typeof w!="string")w.set(v,y);else{var a=d(w||"float32");if(Array.isArray(v)||w==="array")for(w=new a(v.length+y),e=0,n=y,o=w.length;n<o;n++,e++)w[n]=v[e]===null?NaN:v[e];else y===0?w=new a(v):(w=new a(v.length+y)).set(v,y)}return w}},{dtype:127}],192:[function(m,G,Y){var d=m("css-font/stringify"),v=[32,126];G.exports=function(w){var y=(w=w||{}).shape?w.shape:w.canvas?[w.canvas.width,w.canvas.height]:[512,512],e=w.canvas||document.createElement("canvas"),t=w.font,n=typeof w.step=="number"?[w.step,w.step]:w.step||[32,32],o=w.chars||v;if(t&&typeof t!="string"&&(t=d(t)),Array.isArray(o)){if(o.length===2&&typeof o[0]=="number"&&typeof o[1]=="number"){for(var r=[],g=o[0],c=0;g<=o[1];g++)r[c++]=String.fromCharCode(g);o=r}}else o=String(o).split("");y=y.slice(),e.width=y[0],e.height=y[1];var a=e.getContext("2d");a.fillStyle="#000",a.fillRect(0,0,e.width,e.height),a.font=t,a.textAlign="center",a.textBaseline="middle",a.fillStyle="#fff";var h=n[0]/2,l=n[1]/2;for(g=0;g<o.length;g++)a.fillText(o[g],h,l),(h+=n[0])>y[0]-n[0]/2&&(h=n[0]/2,l+=n[1]);return e}},{"css-font/stringify":102}],193:[function(m,G,Y){function d(e,t){t||(t={}),(typeof e=="string"||Array.isArray(e))&&(t.family=e);var n=Array.isArray(t.family)?t.family.join(", "):t.family;if(!n)throw Error("`family` must be defined");var o=t.size||t.fontSize||t.em||48,r=t.weight||t.fontWeight||"",g=(e=[t.style||t.fontStyle||"",r,o].join(" ")+"px "+n,t.origin||"top");if(d.cache[n]&&o<=d.cache[n].em)return v(d.cache[n],g);var c=t.canvas||d.canvas,a=c.getContext("2d"),h={upper:t.upper!==void 0?t.upper:"H",lower:t.lower!==void 0?t.lower:"x",descent:t.descent!==void 0?t.descent:"p",ascent:t.ascent!==void 0?t.ascent:"h",tittle:t.tittle!==void 0?t.tittle:"i",overshoot:t.overshoot!==void 0?t.overshoot:"O"},l=Math.ceil(1.5*o);c.height=l,c.width=.5*l,a.font=e;var s={top:0};a.clearRect(0,0,l,l),a.textBaseline="top",a.fillStyle="black",a.fillText("H",0,0);var p=w(a.getImageData(0,0,l,l));a.clearRect(0,0,l,l),a.textBaseline="bottom",a.fillText("H",0,l);var u=w(a.getImageData(0,0,l,l));s.lineHeight=s.bottom=l-u+p,a.clearRect(0,0,l,l),a.textBaseline="alphabetic",a.fillText("H",0,l);var i=l-w(a.getImageData(0,0,l,l))-1+p;s.baseline=s.alphabetic=i,a.clearRect(0,0,l,l),a.textBaseline="middle",a.fillText("H",0,.5*l);var x=w(a.getImageData(0,0,l,l));s.median=s.middle=l-x-1+p-.5*l,a.clearRect(0,0,l,l),a.textBaseline="hanging",a.fillText("H",0,.5*l);var f=w(a.getImageData(0,0,l,l));s.hanging=l-f-1+p-.5*l,a.clearRect(0,0,l,l),a.textBaseline="ideographic",a.fillText("H",0,l);var _=w(a.getImageData(0,0,l,l));if(s.ideographic=l-_-1+p,h.upper&&(a.clearRect(0,0,l,l),a.textBaseline="top",a.fillText(h.upper,0,0),s.upper=w(a.getImageData(0,0,l,l)),s.capHeight=s.baseline-s.upper),h.lower&&(a.clearRect(0,0,l,l),a.textBaseline="top",a.fillText(h.lower,0,0),s.lower=w(a.getImageData(0,0,l,l)),s.xHeight=s.baseline-s.lower),h.tittle&&(a.clearRect(0,0,l,l),a.textBaseline="top",a.fillText(h.tittle,0,0),s.tittle=w(a.getImageData(0,0,l,l))),h.ascent&&(a.clearRect(0,0,l,l),a.textBaseline="top",a.fillText(h.ascent,0,0),s.ascent=w(a.getImageData(0,0,l,l))),h.descent&&(a.clearRect(0,0,l,l),a.textBaseline="top",a.fillText(h.descent,0,0),s.descent=y(a.getImageData(0,0,l,l))),h.overshoot){a.clearRect(0,0,l,l),a.textBaseline="top",a.fillText(h.overshoot,0,0);var b=y(a.getImageData(0,0,l,l));s.overshoot=b-i}for(var T in s)s[T]/=o;return s.em=o,d.cache[n]=s,v(s,g)}function v(e,t){var n={};for(var o in typeof t=="string"&&(t=e[t]),e)o!=="em"&&(n[o]=e[o]-t);return n}function w(e){for(var t=e.height,n=e.data,o=3;o<n.length;o+=4)if(n[o]!==0)return Math.floor(.25*(o-3)/t)}function y(e){for(var t=e.height,n=e.data,o=n.length-1;o>0;o-=4)if(n[o]!==0)return Math.floor(.25*(o-3)/t)}G.exports=d,d.canvas=document.createElement("canvas"),d.cache={}},{}],194:[function(m,G,Y){G.exports=function(d,v){if(typeof d!="string")throw new TypeError("must specify type string");if(v=v||{},typeof document>"u"&&!v.canvas)return null;var w=v.canvas||document.createElement("canvas");typeof v.width=="number"&&(w.width=v.width),typeof v.height=="number"&&(w.height=v.height);var y,e=v;try{var t=[d];d.indexOf("webgl")===0&&t.push("experimental-"+d);for(var n=0;n<t.length;n++)if(y=w.getContext(t[n],e))return y}catch{y=null}return y||null}},{}],195:[function(m,G,Y){G.exports=function(d,v){var w=v[0],y=v[1],e=v[2],t=v[3],n=v[4],o=v[5],r=v[6],g=v[7],c=v[8],a=v[9],h=v[10],l=v[11],s=v[12],p=v[13],u=v[14],i=v[15];return d[0]=o*(h*i-l*u)-a*(r*i-g*u)+p*(r*l-g*h),d[1]=-(y*(h*i-l*u)-a*(e*i-t*u)+p*(e*l-t*h)),d[2]=y*(r*i-g*u)-o*(e*i-t*u)+p*(e*g-t*r),d[3]=-(y*(r*l-g*h)-o*(e*l-t*h)+a*(e*g-t*r)),d[4]=-(n*(h*i-l*u)-c*(r*i-g*u)+s*(r*l-g*h)),d[5]=w*(h*i-l*u)-c*(e*i-t*u)+s*(e*l-t*h),d[6]=-(w*(r*i-g*u)-n*(e*i-t*u)+s*(e*g-t*r)),d[7]=w*(r*l-g*h)-n*(e*l-t*h)+c*(e*g-t*r),d[8]=n*(a*i-l*p)-c*(o*i-g*p)+s*(o*l-g*a),d[9]=-(w*(a*i-l*p)-c*(y*i-t*p)+s*(y*l-t*a)),d[10]=w*(o*i-g*p)-n*(y*i-t*p)+s*(y*g-t*o),d[11]=-(w*(o*l-g*a)-n*(y*l-t*a)+c*(y*g-t*o)),d[12]=-(n*(a*u-h*p)-c*(o*u-r*p)+s*(o*h-r*a)),d[13]=w*(a*u-h*p)-c*(y*u-e*p)+s*(y*h-e*a),d[14]=-(w*(o*u-r*p)-n*(y*u-e*p)+s*(y*r-e*o)),d[15]=w*(o*h-r*a)-n*(y*h-e*a)+c*(y*r-e*o),d}},{}],196:[function(m,G,Y){G.exports=function(d){var v=new Float32Array(16);return v[0]=d[0],v[1]=d[1],v[2]=d[2],v[3]=d[3],v[4]=d[4],v[5]=d[5],v[6]=d[6],v[7]=d[7],v[8]=d[8],v[9]=d[9],v[10]=d[10],v[11]=d[11],v[12]=d[12],v[13]=d[13],v[14]=d[14],v[15]=d[15],v}},{}],197:[function(m,G,Y){G.exports=function(d,v){return d[0]=v[0],d[1]=v[1],d[2]=v[2],d[3]=v[3],d[4]=v[4],d[5]=v[5],d[6]=v[6],d[7]=v[7],d[8]=v[8],d[9]=v[9],d[10]=v[10],d[11]=v[11],d[12]=v[12],d[13]=v[13],d[14]=v[14],d[15]=v[15],d}},{}],198:[function(m,G,Y){G.exports=function(){var d=new Float32Array(16);return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=1,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=1,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d}},{}],199:[function(m,G,Y){G.exports=function(d){var v=d[0],w=d[1],y=d[2],e=d[3],t=d[4],n=d[5],o=d[6],r=d[7],g=d[8],c=d[9],a=d[10],h=d[11],l=d[12],s=d[13],p=d[14],u=d[15];return(v*n-w*t)*(a*u-h*p)-(v*o-y*t)*(c*u-h*s)+(v*r-e*t)*(c*p-a*s)+(w*o-y*n)*(g*u-h*l)-(w*r-e*n)*(g*p-a*l)+(y*r-e*o)*(g*s-c*l)}},{}],200:[function(m,G,Y){G.exports=function(d,v){var w=v[0],y=v[1],e=v[2],t=v[3],n=w+w,o=y+y,r=e+e,g=w*n,c=y*n,a=y*o,h=e*n,l=e*o,s=e*r,p=t*n,u=t*o,i=t*r;return d[0]=1-a-s,d[1]=c+i,d[2]=h-u,d[3]=0,d[4]=c-i,d[5]=1-g-s,d[6]=l+p,d[7]=0,d[8]=h+u,d[9]=l-p,d[10]=1-g-a,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d}},{}],201:[function(m,G,Y){G.exports=function(d,v,w){var y,e,t,n=w[0],o=w[1],r=w[2],g=Math.sqrt(n*n+o*o+r*r);return Math.abs(g)<1e-6?null:(n*=g=1/g,o*=g,r*=g,y=Math.sin(v),e=Math.cos(v),t=1-e,d[0]=n*n*t+e,d[1]=o*n*t+r*y,d[2]=r*n*t-o*y,d[3]=0,d[4]=n*o*t-r*y,d[5]=o*o*t+e,d[6]=r*o*t+n*y,d[7]=0,d[8]=n*r*t+o*y,d[9]=o*r*t-n*y,d[10]=r*r*t+e,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d)}},{}],202:[function(m,G,Y){G.exports=function(d,v,w){var y=v[0],e=v[1],t=v[2],n=v[3],o=y+y,r=e+e,g=t+t,c=y*o,a=y*r,h=y*g,l=e*r,s=e*g,p=t*g,u=n*o,i=n*r,x=n*g;return d[0]=1-(l+p),d[1]=a+x,d[2]=h-i,d[3]=0,d[4]=a-x,d[5]=1-(c+p),d[6]=s+u,d[7]=0,d[8]=h+i,d[9]=s-u,d[10]=1-(c+l),d[11]=0,d[12]=w[0],d[13]=w[1],d[14]=w[2],d[15]=1,d}},{}],203:[function(m,G,Y){G.exports=function(d,v){return d[0]=v[0],d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=v[1],d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=v[2],d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d}},{}],204:[function(m,G,Y){G.exports=function(d,v){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=1,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=1,d[11]=0,d[12]=v[0],d[13]=v[1],d[14]=v[2],d[15]=1,d}},{}],205:[function(m,G,Y){G.exports=function(d,v){var w=Math.sin(v),y=Math.cos(v);return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=y,d[6]=w,d[7]=0,d[8]=0,d[9]=-w,d[10]=y,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d}},{}],206:[function(m,G,Y){G.exports=function(d,v){var w=Math.sin(v),y=Math.cos(v);return d[0]=y,d[1]=0,d[2]=-w,d[3]=0,d[4]=0,d[5]=1,d[6]=0,d[7]=0,d[8]=w,d[9]=0,d[10]=y,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d}},{}],207:[function(m,G,Y){G.exports=function(d,v){var w=Math.sin(v),y=Math.cos(v);return d[0]=y,d[1]=w,d[2]=0,d[3]=0,d[4]=-w,d[5]=y,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=1,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d}},{}],208:[function(m,G,Y){G.exports=function(d,v,w,y,e,t,n){var o=1/(w-v),r=1/(e-y),g=1/(t-n);return d[0]=2*t*o,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=2*t*r,d[6]=0,d[7]=0,d[8]=(w+v)*o,d[9]=(e+y)*r,d[10]=(n+t)*g,d[11]=-1,d[12]=0,d[13]=0,d[14]=n*t*2*g,d[15]=0,d}},{}],209:[function(m,G,Y){G.exports=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=1,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=1,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,d}},{}],210:[function(m,G,Y){G.exports={create:m("./create"),clone:m("./clone"),copy:m("./copy"),identity:m("./identity"),transpose:m("./transpose"),invert:m("./invert"),adjoint:m("./adjoint"),determinant:m("./determinant"),multiply:m("./multiply"),translate:m("./translate"),scale:m("./scale"),rotate:m("./rotate"),rotateX:m("./rotateX"),rotateY:m("./rotateY"),rotateZ:m("./rotateZ"),fromRotation:m("./fromRotation"),fromRotationTranslation:m("./fromRotationTranslation"),fromScaling:m("./fromScaling"),fromTranslation:m("./fromTranslation"),fromXRotation:m("./fromXRotation"),fromYRotation:m("./fromYRotation"),fromZRotation:m("./fromZRotation"),fromQuat:m("./fromQuat"),frustum:m("./frustum"),perspective:m("./perspective"),perspectiveFromFieldOfView:m("./perspectiveFromFieldOfView"),ortho:m("./ortho"),lookAt:m("./lookAt"),str:m("./str")}},{"./adjoint":195,"./clone":196,"./copy":197,"./create":198,"./determinant":199,"./fromQuat":200,"./fromRotation":201,"./fromRotationTranslation":202,"./fromScaling":203,"./fromTranslation":204,"./fromXRotation":205,"./fromYRotation":206,"./fromZRotation":207,"./frustum":208,"./identity":209,"./invert":211,"./lookAt":212,"./multiply":213,"./ortho":214,"./perspective":215,"./perspectiveFromFieldOfView":216,"./rotate":217,"./rotateX":218,"./rotateY":219,"./rotateZ":220,"./scale":221,"./str":222,"./translate":223,"./transpose":224}],211:[function(m,G,Y){G.exports=function(d,v){var w=v[0],y=v[1],e=v[2],t=v[3],n=v[4],o=v[5],r=v[6],g=v[7],c=v[8],a=v[9],h=v[10],l=v[11],s=v[12],p=v[13],u=v[14],i=v[15],x=w*o-y*n,f=w*r-e*n,_=w*g-t*n,b=y*r-e*o,T=y*g-t*o,k=e*g-t*r,L=c*p-a*s,A=c*u-h*s,I=c*i-l*s,P=a*u-h*p,S=a*i-l*p,E=h*i-l*u,z=x*E-f*S+_*P+b*I-T*A+k*L;return z?(z=1/z,d[0]=(o*E-r*S+g*P)*z,d[1]=(e*S-y*E-t*P)*z,d[2]=(p*k-u*T+i*b)*z,d[3]=(h*T-a*k-l*b)*z,d[4]=(r*I-n*E-g*A)*z,d[5]=(w*E-e*I+t*A)*z,d[6]=(u*_-s*k-i*f)*z,d[7]=(c*k-h*_+l*f)*z,d[8]=(n*S-o*I+g*L)*z,d[9]=(y*I-w*S-t*L)*z,d[10]=(s*T-p*_+i*x)*z,d[11]=(a*_-c*T-l*x)*z,d[12]=(o*A-n*P-r*L)*z,d[13]=(w*P-y*A+e*L)*z,d[14]=(p*f-s*b-u*x)*z,d[15]=(c*b-a*f+h*x)*z,d):null}},{}],212:[function(m,G,Y){var d=m("./identity");G.exports=function(v,w,y,e){var t,n,o,r,g,c,a,h,l,s,p=w[0],u=w[1],i=w[2],x=e[0],f=e[1],_=e[2],b=y[0],T=y[1],k=y[2];return Math.abs(p-b)<1e-6&&Math.abs(u-T)<1e-6&&Math.abs(i-k)<1e-6?d(v):(a=p-b,h=u-T,l=i-k,s=1/Math.sqrt(a*a+h*h+l*l),t=f*(l*=s)-_*(h*=s),n=_*(a*=s)-x*l,o=x*h-f*a,(s=Math.sqrt(t*t+n*n+o*o))?(t*=s=1/s,n*=s,o*=s):(t=0,n=0,o=0),r=h*o-l*n,g=l*t-a*o,c=a*n-h*t,(s=Math.sqrt(r*r+g*g+c*c))?(r*=s=1/s,g*=s,c*=s):(r=0,g=0,c=0),v[0]=t,v[1]=r,v[2]=a,v[3]=0,v[4]=n,v[5]=g,v[6]=h,v[7]=0,v[8]=o,v[9]=c,v[10]=l,v[11]=0,v[12]=-(t*p+n*u+o*i),v[13]=-(r*p+g*u+c*i),v[14]=-(a*p+h*u+l*i),v[15]=1,v)}},{"./identity":209}],213:[function(m,G,Y){G.exports=function(d,v,w){var y=v[0],e=v[1],t=v[2],n=v[3],o=v[4],r=v[5],g=v[6],c=v[7],a=v[8],h=v[9],l=v[10],s=v[11],p=v[12],u=v[13],i=v[14],x=v[15],f=w[0],_=w[1],b=w[2],T=w[3];return d[0]=f*y+_*o+b*a+T*p,d[1]=f*e+_*r+b*h+T*u,d[2]=f*t+_*g+b*l+T*i,d[3]=f*n+_*c+b*s+T*x,f=w[4],_=w[5],b=w[6],T=w[7],d[4]=f*y+_*o+b*a+T*p,d[5]=f*e+_*r+b*h+T*u,d[6]=f*t+_*g+b*l+T*i,d[7]=f*n+_*c+b*s+T*x,f=w[8],_=w[9],b=w[10],T=w[11],d[8]=f*y+_*o+b*a+T*p,d[9]=f*e+_*r+b*h+T*u,d[10]=f*t+_*g+b*l+T*i,d[11]=f*n+_*c+b*s+T*x,f=w[12],_=w[13],b=w[14],T=w[15],d[12]=f*y+_*o+b*a+T*p,d[13]=f*e+_*r+b*h+T*u,d[14]=f*t+_*g+b*l+T*i,d[15]=f*n+_*c+b*s+T*x,d}},{}],214:[function(m,G,Y){G.exports=function(d,v,w,y,e,t,n){var o=1/(v-w),r=1/(y-e),g=1/(t-n);return d[0]=-2*o,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=-2*r,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=2*g,d[11]=0,d[12]=(v+w)*o,d[13]=(e+y)*r,d[14]=(n+t)*g,d[15]=1,d}},{}],215:[function(m,G,Y){G.exports=function(d,v,w,y,e){var t=1/Math.tan(v/2),n=1/(y-e);return d[0]=t/w,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=t,d[6]=0,d[7]=0,d[8]=0,d[9]=0,d[10]=(e+y)*n,d[11]=-1,d[12]=0,d[13]=0,d[14]=2*e*y*n,d[15]=0,d}},{}],216:[function(m,G,Y){G.exports=function(d,v,w,y){var e=Math.tan(v.upDegrees*Math.PI/180),t=Math.tan(v.downDegrees*Math.PI/180),n=Math.tan(v.leftDegrees*Math.PI/180),o=Math.tan(v.rightDegrees*Math.PI/180),r=2/(n+o),g=2/(e+t);return d[0]=r,d[1]=0,d[2]=0,d[3]=0,d[4]=0,d[5]=g,d[6]=0,d[7]=0,d[8]=-(n-o)*r*.5,d[9]=(e-t)*g*.5,d[10]=y/(w-y),d[11]=-1,d[12]=0,d[13]=0,d[14]=y*w/(w-y),d[15]=0,d}},{}],217:[function(m,G,Y){G.exports=function(d,v,w,y){var e,t,n,o,r,g,c,a,h,l,s,p,u,i,x,f,_,b,T,k,L,A,I,P,S=y[0],E=y[1],z=y[2],D=Math.sqrt(S*S+E*E+z*z);return Math.abs(D)<1e-6?null:(S*=D=1/D,E*=D,z*=D,e=Math.sin(w),t=Math.cos(w),n=1-t,o=v[0],r=v[1],g=v[2],c=v[3],a=v[4],h=v[5],l=v[6],s=v[7],p=v[8],u=v[9],i=v[10],x=v[11],f=S*S*n+t,_=E*S*n+z*e,b=z*S*n-E*e,T=S*E*n-z*e,k=E*E*n+t,L=z*E*n+S*e,A=S*z*n+E*e,I=E*z*n-S*e,P=z*z*n+t,d[0]=o*f+a*_+p*b,d[1]=r*f+h*_+u*b,d[2]=g*f+l*_+i*b,d[3]=c*f+s*_+x*b,d[4]=o*T+a*k+p*L,d[5]=r*T+h*k+u*L,d[6]=g*T+l*k+i*L,d[7]=c*T+s*k+x*L,d[8]=o*A+a*I+p*P,d[9]=r*A+h*I+u*P,d[10]=g*A+l*I+i*P,d[11]=c*A+s*I+x*P,v!==d&&(d[12]=v[12],d[13]=v[13],d[14]=v[14],d[15]=v[15]),d)}},{}],218:[function(m,G,Y){G.exports=function(d,v,w){var y=Math.sin(w),e=Math.cos(w),t=v[4],n=v[5],o=v[6],r=v[7],g=v[8],c=v[9],a=v[10],h=v[11];return v!==d&&(d[0]=v[0],d[1]=v[1],d[2]=v[2],d[3]=v[3],d[12]=v[12],d[13]=v[13],d[14]=v[14],d[15]=v[15]),d[4]=t*e+g*y,d[5]=n*e+c*y,d[6]=o*e+a*y,d[7]=r*e+h*y,d[8]=g*e-t*y,d[9]=c*e-n*y,d[10]=a*e-o*y,d[11]=h*e-r*y,d}},{}],219:[function(m,G,Y){G.exports=function(d,v,w){var y=Math.sin(w),e=Math.cos(w),t=v[0],n=v[1],o=v[2],r=v[3],g=v[8],c=v[9],a=v[10],h=v[11];return v!==d&&(d[4]=v[4],d[5]=v[5],d[6]=v[6],d[7]=v[7],d[12]=v[12],d[13]=v[13],d[14]=v[14],d[15]=v[15]),d[0]=t*e-g*y,d[1]=n*e-c*y,d[2]=o*e-a*y,d[3]=r*e-h*y,d[8]=t*y+g*e,d[9]=n*y+c*e,d[10]=o*y+a*e,d[11]=r*y+h*e,d}},{}],220:[function(m,G,Y){G.exports=function(d,v,w){var y=Math.sin(w),e=Math.cos(w),t=v[0],n=v[1],o=v[2],r=v[3],g=v[4],c=v[5],a=v[6],h=v[7];return v!==d&&(d[8]=v[8],d[9]=v[9],d[10]=v[10],d[11]=v[11],d[12]=v[12],d[13]=v[13],d[14]=v[14],d[15]=v[15]),d[0]=t*e+g*y,d[1]=n*e+c*y,d[2]=o*e+a*y,d[3]=r*e+h*y,d[4]=g*e-t*y,d[5]=c*e-n*y,d[6]=a*e-o*y,d[7]=h*e-r*y,d}},{}],221:[function(m,G,Y){G.exports=function(d,v,w){var y=w[0],e=w[1],t=w[2];return d[0]=v[0]*y,d[1]=v[1]*y,d[2]=v[2]*y,d[3]=v[3]*y,d[4]=v[4]*e,d[5]=v[5]*e,d[6]=v[6]*e,d[7]=v[7]*e,d[8]=v[8]*t,d[9]=v[9]*t,d[10]=v[10]*t,d[11]=v[11]*t,d[12]=v[12],d[13]=v[13],d[14]=v[14],d[15]=v[15],d}},{}],222:[function(m,G,Y){G.exports=function(d){return"mat4("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+", "+d[6]+", "+d[7]+", "+d[8]+", "+d[9]+", "+d[10]+", "+d[11]+", "+d[12]+", "+d[13]+", "+d[14]+", "+d[15]+")"}},{}],223:[function(m,G,Y){G.exports=function(d,v,w){var y,e,t,n,o,r,g,c,a,h,l,s,p=w[0],u=w[1],i=w[2];return v===d?(d[12]=v[0]*p+v[4]*u+v[8]*i+v[12],d[13]=v[1]*p+v[5]*u+v[9]*i+v[13],d[14]=v[2]*p+v[6]*u+v[10]*i+v[14],d[15]=v[3]*p+v[7]*u+v[11]*i+v[15]):(y=v[0],e=v[1],t=v[2],n=v[3],o=v[4],r=v[5],g=v[6],c=v[7],a=v[8],h=v[9],l=v[10],s=v[11],d[0]=y,d[1]=e,d[2]=t,d[3]=n,d[4]=o,d[5]=r,d[6]=g,d[7]=c,d[8]=a,d[9]=h,d[10]=l,d[11]=s,d[12]=y*p+o*u+a*i+v[12],d[13]=e*p+r*u+h*i+v[13],d[14]=t*p+g*u+l*i+v[14],d[15]=n*p+c*u+s*i+v[15]),d}},{}],224:[function(m,G,Y){G.exports=function(d,v){if(d===v){var w=v[1],y=v[2],e=v[3],t=v[6],n=v[7],o=v[11];d[1]=v[4],d[2]=v[8],d[3]=v[12],d[4]=w,d[6]=v[9],d[7]=v[13],d[8]=y,d[9]=t,d[11]=v[14],d[12]=e,d[13]=n,d[14]=o}else d[0]=v[0],d[1]=v[4],d[2]=v[8],d[3]=v[12],d[4]=v[1],d[5]=v[5],d[6]=v[9],d[7]=v[13],d[8]=v[2],d[9]=v[6],d[10]=v[10],d[11]=v[14],d[12]=v[3],d[13]=v[7],d[14]=v[11],d[15]=v[15];return d}},{}],225:[function(m,G,Y){var d=m("css-font"),v=m("pick-by-alias"),w=m("regl"),y=m("gl-util/context"),e=m("es6-weak-map"),t=m("color-normalize"),n=m("font-atlas"),o=m("typedarray-pool"),r=m("parse-rect"),g=m("is-plain-obj"),c=m("parse-unit"),a=m("to-px"),h=m("detect-kerning"),l=m("object-assign"),s=m("font-measure"),p=m("flatten-vertex-data"),u=m("bit-twiddle").nextPow2,i=new e,x=!1;if(document.body){var f=document.body.appendChild(document.createElement("div"));f.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(f).fontStretch&&(x=!0),document.body.removeChild(f)}var _=function(b){(function(T){return typeof T=="function"&&T._gl&&T.prop&&T.texture&&T.buffer})(b)?(b={regl:b},this.gl=b.regl._gl):this.gl=y(b),this.shader=i.get(this.gl),this.shader?this.regl=this.shader.regl:this.regl=b.regl||w({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),i.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(g(b)?b:{})};_.prototype.createShader=function(){var b=this.regl,T=b({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:b.prop("count"),offset:b.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:b.this("sizeBuffer")},width:{offset:0,stride:8,buffer:b.this("sizeBuffer")},char:b.this("charBuffer"),position:b.this("position")},uniforms:{atlasSize:function(k,L){return[L.atlas.width,L.atlas.height]},atlasDim:function(k,L){return[L.atlas.cols,L.atlas.rows]},atlas:function(k,L){return L.atlas.texture},charStep:function(k,L){return L.atlas.step},em:function(k,L){return L.atlas.em},color:b.prop("color"),opacity:b.prop("opacity"),viewport:b.this("viewportArray"),scale:b.this("scale"),align:b.prop("align"),baseline:b.prop("baseline"),translate:b.this("translate"),positionOffset:b.prop("positionOffset")},primitive:"points",viewport:b.this("viewport"),vert:`
			precision highp float;
			attribute float width, charOffset, char;
			attribute vec2 position;
			uniform float fontSize, charStep, em, align, baseline;
			uniform vec4 viewport;
			uniform vec4 color;
			uniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;
			varying vec2 charCoord, charId;
			varying float charWidth;
			varying vec4 fontColor;
			void main () {
				vec2 offset = floor(em * (vec2(align + charOffset, baseline)
					+ vec2(positionOffset.x, -positionOffset.y)))
					/ (viewport.zw * scale.xy);

				vec2 position = (position + translate) * scale;
				position += offset * scale;

				charCoord = position * viewport.zw + viewport.xy;

				gl_Position = vec4(position * 2. - 1., 0, 1);

				gl_PointSize = charStep;

				charId.x = mod(char, atlasDim.x);
				charId.y = floor(char / atlasDim.x);

				charWidth = width * em;

				fontColor = color / 255.;
			}`,frag:`
			precision highp float;
			uniform float fontSize, charStep, opacity;
			uniform vec2 atlasSize;
			uniform vec4 viewport;
			uniform sampler2D atlas;
			varying vec4 fontColor;
			varying vec2 charCoord, charId;
			varying float charWidth;

			float lightness(vec4 color) {
				return color.r * 0.299 + color.g * 0.587 + color.b * 0.114;
			}

			void main () {
				vec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;
				float halfCharStep = floor(charStep * .5 + .5);

				// invert y and shift by 1px (FF expecially needs that)
				uv.y = charStep - uv.y;

				// ignore points outside of character bounding box
				float halfCharWidth = ceil(charWidth * .5);
				if (floor(uv.x) > halfCharStep + halfCharWidth ||
					floor(uv.x) < halfCharStep - halfCharWidth) return;

				uv += charId * charStep;
				uv = uv / atlasSize;

				vec4 color = fontColor;
				vec4 mask = texture2D(atlas, uv);

				float maskY = lightness(mask);
				// float colorY = lightness(color);
				color.a *= maskY;
				color.a *= opacity;

				// color.a += .1;

				// antialiasing, see yiq color space y-channel formula
				// color.rgb += (1. - color.rgb) * (1. - mask.rgb);

				gl_FragColor = color;
			}`});return{regl:b,draw:T,atlas:{}}},_.prototype.update=function(b){var T=this;if(typeof b=="string")b={text:b};else if(!b)return;(b=v(b,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0)).opacity!=null&&(Array.isArray(b.opacity)?this.opacity=b.opacity.map(function(ve){return parseFloat(ve)}):this.opacity=parseFloat(b.opacity)),b.viewport!=null&&(this.viewport=r(b.viewport),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),this.viewport==null&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),b.kerning!=null&&(this.kerning=b.kerning),b.offset!=null&&(typeof b.offset=="number"&&(b.offset=[b.offset,0]),this.positionOffset=p(b.offset)),b.direction&&(this.direction=b.direction),b.range&&(this.range=b.range,this.scale=[1/(b.range[2]-b.range[0]),1/(b.range[3]-b.range[1])],this.translate=[-b.range[0],-b.range[1]]),b.scale&&(this.scale=b.scale),b.translate&&(this.translate=b.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),this.font.length||b.font||(b.font=_.baseFontSize+"px sans-serif");var k,L=!1,A=!1;if(b.font&&(Array.isArray(b.font)?b.font:[b.font]).forEach(function(ve,Me){if(typeof ve=="string")try{ve=d.parse(ve)}catch{ve=d.parse(_.baseFontSize+"px "+ve)}else ve=d.parse(d.stringify(ve));var we=d.stringify({size:_.baseFontSize,family:ve.family,stretch:x?ve.stretch:void 0,variant:ve.variant,weight:ve.weight,style:ve.style}),de=c(ve.size),Ie=Math.round(de[0]*a(de[1]));if(Ie!==T.fontSize[Me]&&(A=!0,T.fontSize[Me]=Ie),!(T.font[Me]&&we==T.font[Me].baseString||(L=!0,T.font[Me]=_.fonts[we],T.font[Me]))){var De=ve.family.join(", "),Oe=[ve.style];ve.style!=ve.variant&&Oe.push(ve.variant),ve.variant!=ve.weight&&Oe.push(ve.weight),x&&ve.weight!=ve.stretch&&Oe.push(ve.stretch),T.font[Me]={baseString:we,family:De,weight:ve.weight,stretch:ve.stretch,style:ve.style,variant:ve.variant,width:{},kerning:{},metrics:s(De,{origin:"top",fontSize:_.baseFontSize,fontStyle:Oe.join(" ")})},_.fonts[we]=T.font[Me]}}),(L||A)&&this.font.forEach(function(ve,Me){var we=d.stringify({size:T.fontSize[Me],family:ve.family,stretch:x?ve.stretch:void 0,variant:ve.variant,weight:ve.weight,style:ve.style});if(T.fontAtlas[Me]=T.shader.atlas[we],!T.fontAtlas[Me]){var de=ve.metrics;T.shader.atlas[we]=T.fontAtlas[Me]={fontString:we,step:2*Math.ceil(T.fontSize[Me]*de.bottom*.5),em:T.fontSize[Me],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:T.regl.texture()}}b.text==null&&(b.text=T.text)}),typeof b.text=="string"&&b.position&&b.position.length>2){for(var I=Array(.5*b.position.length),P=0;P<I.length;P++)I[P]=b.text;b.text=I}if(b.text!=null||L){if(this.textOffsets=[0],Array.isArray(b.text)){this.count=b.text[0].length,this.counts=[this.count];for(var S=1;S<b.text.length;S++)this.textOffsets[S]=this.textOffsets[S-1]+b.text[S-1].length,this.count+=b.text[S].length,this.counts.push(b.text[S].length);this.text=b.text.join("")}else this.text=b.text,this.count=this.text.length,this.counts=[this.count];k=[],this.font.forEach(function(ve,Me){_.atlasContext.font=ve.baseString;for(var we=T.fontAtlas[Me],de=0;de<T.text.length;de++){var Ie=T.text.charAt(de);if(we.ids[Ie]==null&&(we.ids[Ie]=we.chars.length,we.chars.push(Ie),k.push(Ie)),ve.width[Ie]==null&&(ve.width[Ie]=_.atlasContext.measureText(Ie).width/_.baseFontSize,T.kerning)){var De=[];for(var Oe in ve.width)De.push(Oe+Ie,Ie+Oe);l(ve.kerning,h(ve.family,{pairs:De}))}}})}if(b.position)if(b.position.length>2){for(var E=!b.position[0].length,z=o.mallocFloat(2*this.count),D=0,j=0;D<this.counts.length;D++){var V=this.counts[D];if(E)for(var Z=0;Z<V;Z++)z[j++]=b.position[2*D],z[j++]=b.position[2*D+1];else for(var Q=0;Q<V;Q++)z[j++]=b.position[D][0],z[j++]=b.position[D][1]}this.position.call?this.position({type:"float",data:z}):this.position=this.regl.buffer({type:"float",data:z}),o.freeFloat(z)}else this.position.destroy&&this.position.destroy(),this.position={constant:b.position};if(b.text||L){var X=o.mallocUint8(this.count),$=o.mallocFloat(2*this.count);this.textWidth=[];for(var re=0,H=0;re<this.counts.length;re++){for(var N=this.counts[re],U=this.font[re]||this.font[0],te=this.fontAtlas[re]||this.fontAtlas[0],B=0;B<N;B++){var K=this.text.charAt(H),J=this.text.charAt(H-1);if(X[H]=te.ids[K],$[2*H]=U.width[K],B){var ee=$[2*H-2],ne=$[2*H],se=$[2*H-1]+.5*ee+.5*ne;if(this.kerning){var oe=U.kerning[J+K];oe&&(se+=.001*oe)}$[2*H+1]=se}else $[2*H+1]=.5*$[2*H];H++}this.textWidth.push($.length?.5*$[2*H-2]+$[2*H-1]:0)}b.align||(b.align=this.align),this.charBuffer({data:X,type:"uint8",usage:"stream"}),this.sizeBuffer({data:$,type:"float",usage:"stream"}),o.freeUint8(X),o.freeFloat($),k.length&&this.font.forEach(function(ve,Me){var we=T.fontAtlas[Me],de=we.step,Ie=Math.floor(_.maxAtlasSize/de),De=Math.min(Ie,we.chars.length),Oe=Math.ceil(we.chars.length/De),Ve=u(De*de),Fe=u(Oe*de);we.width=Ve,we.height=Fe,we.rows=Oe,we.cols=De,we.em&&we.texture({data:n({canvas:_.atlasCanvas,font:we.fontString,chars:we.chars,shape:[Ve,Fe],step:[de,de]})})})}if(b.align&&(this.align=b.align,this.alignOffset=this.textWidth.map(function(ve,Me){var we=Array.isArray(T.align)?T.align.length>1?T.align[Me]:T.align[0]:T.align;if(typeof we=="number")return we;switch(we){case"right":case"end":return-ve;case"center":case"centre":case"middle":return .5*-ve}return 0})),this.baseline==null&&b.baseline==null&&(b.baseline=0),b.baseline!=null&&(this.baseline=b.baseline,Array.isArray(this.baseline)||(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map(function(ve,Me){var we=(T.font[Me]||T.font[0]).metrics,de=0;return de+=.5*we.bottom,de+=typeof ve=="number"?ve-we.baseline:-we[ve],de*=-1})),b.color!=null)if(b.color||(b.color="transparent"),typeof b.color!="string"&&isNaN(b.color)){var me;if(typeof b.color[0]=="number"&&b.color.length>this.counts.length){var ce=b.color.length;me=o.mallocUint8(ce);for(var ye=(b.color.subarray||b.color.slice).bind(b.color),Se=0;Se<ce;Se+=4)me.set(t(ye(Se,Se+4),"uint8"),Se)}else{var fe=b.color.length;me=o.mallocUint8(4*fe);for(var ge=0;ge<fe;ge++)me.set(t(b.color[ge]||0,"uint8"),4*ge)}this.color=me}else this.color=t(b.color,"uint8");if(b.position||b.text||b.color||b.baseline||b.align||b.font||b.offset||b.opacity)if(this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2){var Te=Math.max(.5*this.position.length||0,.25*this.color.length||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,.5*this.positionOffset.length||0);this.batch=Array(Te);for(var le=0;le<this.batch.length;le++)this.batch[le]={count:this.counts.length>1?this.counts[le]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[le]:this.textOffsets[0],color:this.color?this.color.length<=4?this.color:this.color.subarray(4*le,4*le+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[le]:this.opacity,baseline:this.baselineOffset[le]!=null?this.baselineOffset[le]:this.baselineOffset[0],align:this.align?this.alignOffset[le]!=null?this.alignOffset[le]:this.alignOffset[0]:0,atlas:this.fontAtlas[le]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(2*le,2*le+2):this.positionOffset}}else this.count?this.batch=[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:this.batch=[]},_.prototype.destroy=function(){},_.prototype.kerning=!0,_.prototype.position={constant:new Float32Array(2)},_.prototype.translate=null,_.prototype.scale=null,_.prototype.font=null,_.prototype.text="",_.prototype.positionOffset=[0,0],_.prototype.opacity=1,_.prototype.color=new Uint8Array([0,0,0,255]),_.prototype.alignOffset=[0,0],_.maxAtlasSize=1024,_.atlasCanvas=document.createElement("canvas"),_.atlasContext=_.atlasCanvas.getContext("2d",{alpha:!1}),_.baseFontSize=64,_.fonts={},G.exports=_},{"bit-twiddle":81,"color-normalize":89,"css-font":99,"detect-kerning":125,"es6-weak-map":183,"flatten-vertex-data":191,"font-atlas":192,"font-measure":193,"gl-util/context":226,"is-plain-obj":236,"object-assign":247,"parse-rect":249,"parse-unit":251,"pick-by-alias":253,regl:284,"to-px":315,"typedarray-pool":328}],226:[function(m,G,Y){(function(d){(function(){var v=m("pick-by-alias");function w(t){if(t.container)if(t.container==document.body)document.body.style.width||(t.canvas.width=t.width||t.pixelRatio*d.innerWidth),document.body.style.height||(t.canvas.height=t.height||t.pixelRatio*d.innerHeight);else{var n=t.container.getBoundingClientRect();t.canvas.width=t.width||n.right-n.left,t.canvas.height=t.height||n.bottom-n.top}}function y(t){return typeof t.getContext=="function"&&"width"in t&&"height"in t}function e(){var t=document.createElement("canvas");return t.style.position="absolute",t.style.top=0,t.style.left=0,t}G.exports=function(t){var n;if(t?typeof t=="string"&&(t={container:t}):t={},y(t)?t={container:t}:t=typeof(n=t).nodeName=="string"&&typeof n.appendChild=="function"&&typeof n.getBoundingClientRect=="function"?{container:t}:function(r){return typeof r.drawArrays=="function"||typeof r.drawElements=="function"}(t)?{gl:t}:v(t,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0),t.pixelRatio||(t.pixelRatio=d.pixelRatio||1),t.gl)return t.gl;if(t.canvas&&(t.container=t.canvas.parentNode),t.container){if(typeof t.container=="string"){var o=document.querySelector(t.container);if(!o)throw Error("Element "+t.container+" is not found");t.container=o}y(t.container)?(t.canvas=t.container,t.container=t.canvas.parentNode):t.canvas||(t.canvas=e(),t.container.appendChild(t.canvas),w(t))}else if(!t.canvas){if(typeof document>"u")throw Error("Not DOM environment. Use headless-gl.");t.container=document.body||document.documentElement,t.canvas=e(),t.container.appendChild(t.canvas),w(t)}return t.gl||["webgl","experimental-webgl","webgl-experimental"].some(function(r){try{t.gl=t.canvas.getContext(r,t.attrs)}catch{}return t.gl}),t.gl}}).call(this)}).call(this,typeof Ka<"u"?Ka:typeof self<"u"?self:typeof window<"u"?window:{})},{"pick-by-alias":253}],227:[function(m,G,Y){G.exports=function(d){typeof d=="string"&&(d=[d]);for(var v=[].slice.call(arguments,1),w=[],y=0;y<d.length-1;y++)w.push(d[y],v[y]||"");return w.push(d[y]),w.join("")}},{}],228:[function(m,G,Y){(function(d){(function(){var v,w=m("is-browser");v=typeof d.matchMedia=="function"?!d.matchMedia("(hover: none)").matches:w,G.exports=v}).call(this)}).call(this,typeof Ka<"u"?Ka:typeof self<"u"?self:typeof window<"u"?window:{})},{"is-browser":232}],229:[function(m,G,Y){var d=m("is-browser");G.exports=d&&function(){var v=!1;try{var w=Object.defineProperty({},"passive",{get:function(){v=!0}});window.addEventListener("test",null,w),window.removeEventListener("test",null,w)}catch{v=!1}return v}()},{"is-browser":232}],230:[function(m,G,Y){Y.read=function(d,v,w,y,e){var t,n,o=8*e-y-1,r=(1<<o)-1,g=r>>1,c=-7,a=w?e-1:0,h=w?-1:1,l=d[v+a];for(a+=h,t=l&(1<<-c)-1,l>>=-c,c+=o;c>0;t=256*t+d[v+a],a+=h,c-=8);for(n=t&(1<<-c)-1,t>>=-c,c+=y;c>0;n=256*n+d[v+a],a+=h,c-=8);if(t===0)t=1-g;else{if(t===r)return n?NaN:1/0*(l?-1:1);n+=Math.pow(2,y),t-=g}return(l?-1:1)*n*Math.pow(2,t-y)},Y.write=function(d,v,w,y,e,t){var n,o,r,g=8*t-e-1,c=(1<<g)-1,a=c>>1,h=e===23?Math.pow(2,-24)-Math.pow(2,-77):0,l=y?0:t-1,s=y?1:-1,p=v<0||v===0&&1/v<0?1:0;for(v=Math.abs(v),isNaN(v)||v===1/0?(o=isNaN(v)?1:0,n=c):(n=Math.floor(Math.log(v)/Math.LN2),v*(r=Math.pow(2,-n))<1&&(n--,r*=2),(v+=n+a>=1?h/r:h*Math.pow(2,1-a))*r>=2&&(n++,r/=2),n+a>=c?(o=0,n=c):n+a>=1?(o=(v*r-1)*Math.pow(2,e),n+=a):(o=v*Math.pow(2,a-1)*Math.pow(2,e),n=0));e>=8;d[w+l]=255&o,l+=s,o/=256,e-=8);for(n=n<<e|o,g+=e;g>0;d[w+l]=255&n,l+=s,n/=256,g-=8);d[w+l-s]|=128*p}},{}],231:[function(m,G,Y){typeof Object.create=="function"?G.exports=function(d,v){v&&(d.super_=v,d.prototype=Object.create(v.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}))}:G.exports=function(d,v){if(v){d.super_=v;var w=function(){};w.prototype=v.prototype,d.prototype=new w,d.prototype.constructor=d}}},{}],232:[function(m,G,Y){G.exports=!0},{}],233:[function(m,G,Y){G.exports=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],234:[function(m,G,Y){G.exports=w,G.exports.isMobile=w,G.exports.default=w;var d=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,v=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function w(y){y||(y={});var e=y.ua;if(e||typeof navigator>"u"||(e=navigator.userAgent),e&&e.headers&&typeof e.headers["user-agent"]=="string"&&(e=e.headers["user-agent"]),typeof e!="string")return!1;var t=y.tablet?v.test(e):d.test(e);return!t&&y.tablet&&y.featureDetect&&navigator&&navigator.maxTouchPoints>1&&e.indexOf("Macintosh")!==-1&&e.indexOf("Safari")!==-1&&(t=!0),t}},{}],235:[function(m,G,Y){G.exports=function(d){var v=typeof d;return d!==null&&(v==="object"||v==="function")}},{}],236:[function(m,G,Y){var d=Object.prototype.toString;G.exports=function(v){var w;return d.call(v)==="[object Object]"&&((w=Object.getPrototypeOf(v))===null||w===Object.getPrototypeOf({}))}},{}],237:[function(m,G,Y){G.exports=function(d){for(var v,w=d.length,y=0;y<w;y++)if(((v=d.charCodeAt(y))<9||v>13)&&v!==32&&v!==133&&v!==160&&v!==5760&&v!==6158&&(v<8192||v>8205)&&v!==8232&&v!==8233&&v!==8239&&v!==8287&&v!==8288&&v!==12288&&v!==65279)return!1;return!0}},{}],238:[function(m,G,Y){G.exports=function(d){return typeof d=="string"&&(d=d.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(d)&&/[\dz]$/i.test(d)&&d.length>4))}},{}],239:[function(m,G,Y){(function(d,v){typeof Y=="object"&&G!==void 0?G.exports=v():(d=d||self).mapboxgl=v()})(this,function(){var d,v,w;function y(e,t){if(d)if(v){var n="var sharedChunk = {}; ("+d+")(sharedChunk); ("+v+")(sharedChunk);",o={};d(o),(w=t(o)).workerUrl=window.URL.createObjectURL(new Blob([n],{type:"text/javascript"}))}else v=t;else d=t}return y(0,function(e){function t(M,O){return M(O={exports:{}},O.exports),O.exports}var n=o;function o(M,O,W,ie){this.cx=3*M,this.bx=3*(W-M)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*O,this.by=3*(ie-O)-this.cy,this.ay=1-this.cy-this.by,this.p1x=M,this.p1y=ie,this.p2x=W,this.p2y=ie}o.prototype.sampleCurveX=function(M){return((this.ax*M+this.bx)*M+this.cx)*M},o.prototype.sampleCurveY=function(M){return((this.ay*M+this.by)*M+this.cy)*M},o.prototype.sampleCurveDerivativeX=function(M){return(3*this.ax*M+2*this.bx)*M+this.cx},o.prototype.solveCurveX=function(M,O){var W,ie,xe,ke,Pe;for(O===void 0&&(O=1e-6),xe=M,Pe=0;Pe<8;Pe++){if(ke=this.sampleCurveX(xe)-M,Math.abs(ke)<O)return xe;var je=this.sampleCurveDerivativeX(xe);if(Math.abs(je)<1e-6)break;xe-=ke/je}if((xe=M)<(W=0))return W;if(xe>(ie=1))return ie;for(;W<ie;){if(ke=this.sampleCurveX(xe),Math.abs(ke-M)<O)return xe;M>ke?W=xe:ie=xe,xe=.5*(ie-W)+W}return xe},o.prototype.solve=function(M,O){return this.sampleCurveY(this.solveCurveX(M,O))};var r=g;function g(M,O){this.x=M,this.y=O}function c(M,O,W,ie){var xe=new n(M,O,W,ie);return function(ke){return xe.solve(ke)}}g.prototype={clone:function(){return new g(this.x,this.y)},add:function(M){return this.clone()._add(M)},sub:function(M){return this.clone()._sub(M)},multByPoint:function(M){return this.clone()._multByPoint(M)},divByPoint:function(M){return this.clone()._divByPoint(M)},mult:function(M){return this.clone()._mult(M)},div:function(M){return this.clone()._div(M)},rotate:function(M){return this.clone()._rotate(M)},rotateAround:function(M,O){return this.clone()._rotateAround(M,O)},matMult:function(M){return this.clone()._matMult(M)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(M){return this.x===M.x&&this.y===M.y},dist:function(M){return Math.sqrt(this.distSqr(M))},distSqr:function(M){var O=M.x-this.x,W=M.y-this.y;return O*O+W*W},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(M){return Math.atan2(this.y-M.y,this.x-M.x)},angleWith:function(M){return this.angleWithSep(M.x,M.y)},angleWithSep:function(M,O){return Math.atan2(this.x*O-this.y*M,this.x*M+this.y*O)},_matMult:function(M){var O=M[0]*this.x+M[1]*this.y,W=M[2]*this.x+M[3]*this.y;return this.x=O,this.y=W,this},_add:function(M){return this.x+=M.x,this.y+=M.y,this},_sub:function(M){return this.x-=M.x,this.y-=M.y,this},_mult:function(M){return this.x*=M,this.y*=M,this},_div:function(M){return this.x/=M,this.y/=M,this},_multByPoint:function(M){return this.x*=M.x,this.y*=M.y,this},_divByPoint:function(M){return this.x/=M.x,this.y/=M.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var M=this.y;return this.y=this.x,this.x=-M,this},_rotate:function(M){var O=Math.cos(M),W=Math.sin(M),ie=O*this.x-W*this.y,xe=W*this.x+O*this.y;return this.x=ie,this.y=xe,this},_rotateAround:function(M,O){var W=Math.cos(M),ie=Math.sin(M),xe=O.x+W*(this.x-O.x)-ie*(this.y-O.y),ke=O.y+ie*(this.x-O.x)+W*(this.y-O.y);return this.x=xe,this.y=ke,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},g.convert=function(M){return M instanceof g?M:Array.isArray(M)?new g(M[0],M[1]):M};var a=c(.25,.1,.25,1);function h(M,O,W){return Math.min(W,Math.max(O,M))}function l(M,O,W){var ie=W-O,xe=((M-O)%ie+ie)%ie+O;return xe===O?W:xe}function s(M){for(var O=[],W=arguments.length-1;W-- >0;)O[W]=arguments[W+1];for(var ie=0,xe=O;ie<xe.length;ie+=1){var ke=xe[ie];for(var Pe in ke)M[Pe]=ke[Pe]}return M}var p=1;function u(){return p++}function i(){return function M(O){return O?(O^16*Math.random()>>O/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,M)}()}function x(M){return!!M&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(M)}function f(M,O){M.forEach(function(W){O[W]&&(O[W]=O[W].bind(O))})}function _(M,O){return M.indexOf(O,M.length-O.length)!==-1}function b(M,O,W){var ie={};for(var xe in M)ie[xe]=O.call(W||this,M[xe],xe,M);return ie}function T(M,O,W){var ie={};for(var xe in M)O.call(W||this,M[xe],xe,M)&&(ie[xe]=M[xe]);return ie}function k(M){return Array.isArray(M)?M.map(k):typeof M=="object"&&M?b(M,k):M}var L={};function A(M){L[M]||(typeof console<"u"&&console.warn(M),L[M]=!0)}function I(M,O,W){return(W.y-M.y)*(O.x-M.x)>(O.y-M.y)*(W.x-M.x)}function P(M){for(var O=0,W=0,ie=M.length,xe=ie-1,ke=void 0,Pe=void 0;W<ie;xe=W++)ke=M[W],O+=((Pe=M[xe]).x-ke.x)*(ke.y+Pe.y);return O}function S(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function E(M){var O={};if(M.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(ie,xe,ke,Pe){var je=ke||Pe;return O[xe]=!je||je.toLowerCase(),""}),O["max-age"]){var W=parseInt(O["max-age"],10);isNaN(W)?delete O["max-age"]:O["max-age"]=W}return O}var z=null;function D(M){if(z==null){var O=M.navigator?M.navigator.userAgent:null;z=!!M.safari||!(!O||!(/\b(iPad|iPhone|iPod)\b/.test(O)||O.match("Safari")&&!O.match("Chrome")))}return z}function j(M){try{var O=self[M];return O.setItem("_mapbox_test_",1),O.removeItem("_mapbox_test_"),!0}catch{return!1}}var V,Z,Q,X,$=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),re=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,H=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,N={now:$,frame:function(M){var O=re(M);return{cancel:function(){return H(O)}}},getImageData:function(M,O){O===void 0&&(O=0);var W=self.document.createElement("canvas"),ie=W.getContext("2d");if(!ie)throw new Error("failed to create canvas 2d context");return W.width=M.width,W.height=M.height,ie.drawImage(M,0,0,M.width,M.height),ie.getImageData(-O,-O,M.width+2*O,M.height+2*O)},resolveURL:function(M){return V||(V=self.document.createElement("a")),V.href=M,V.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return!!self.matchMedia&&(Z==null&&(Z=self.matchMedia("(prefers-reduced-motion: reduce)")),Z.matches)}},U={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},te={supported:!1,testSupport:function(M){B||!X||(K?J(M):Q=M)}},B=!1,K=!1;function J(M){var O=M.createTexture();M.bindTexture(M.TEXTURE_2D,O);try{if(M.texImage2D(M.TEXTURE_2D,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,X),M.isContextLost())return;te.supported=!0}catch{}M.deleteTexture(O),B=!0}self.document&&((X=self.document.createElement("img")).onload=function(){Q&&J(Q),Q=null,K=!0},X.onerror=function(){B=!0,Q=null},X.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var ee="01",ne=function(M,O){this._transformRequestFn=M,this._customAccessToken=O,this._createSkuToken()};function se(M){return M.indexOf("mapbox:")===0}ne.prototype._createSkuToken=function(){var M=function(){for(var O="",W=0;W<10;W++)O+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ee,O].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=M.token,this._skuTokenExpiresAt=M.tokenExpiresAt},ne.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},ne.prototype.transformRequest=function(M,O){return this._transformRequestFn&&this._transformRequestFn(M,O)||{url:M}},ne.prototype.normalizeStyleURL=function(M,O){if(!se(M))return M;var W=ye(M);return W.path="/styles/v1"+W.path,this._makeAPIURL(W,this._customAccessToken||O)},ne.prototype.normalizeGlyphsURL=function(M,O){if(!se(M))return M;var W=ye(M);return W.path="/fonts/v1"+W.path,this._makeAPIURL(W,this._customAccessToken||O)},ne.prototype.normalizeSourceURL=function(M,O){if(!se(M))return M;var W=ye(M);return W.path="/v4/"+W.authority+".json",W.params.push("secure"),this._makeAPIURL(W,this._customAccessToken||O)},ne.prototype.normalizeSpriteURL=function(M,O,W,ie){var xe=ye(M);return se(M)?(xe.path="/styles/v1"+xe.path+"/sprite"+O+W,this._makeAPIURL(xe,this._customAccessToken||ie)):(xe.path+=""+O+W,Se(xe))},ne.prototype.normalizeTileURL=function(M,O){if(this._isSkuTokenExpired()&&this._createSkuToken(),M&&!se(M))return M;var W=ye(M),ie=N.devicePixelRatio>=2||O===512?"@2x":"",xe=te.supported?".webp":"$1";W.path=W.path.replace(/(\.(png|jpg)\d*)(?=$)/,""+ie+xe),W.path=W.path.replace(/^.+\/v4\//,"/"),W.path="/v4"+W.path;var ke=this._customAccessToken||function(Pe){for(var je=0,tt=Pe;je<tt.length;je+=1){var ft=tt[je].match(/^access_token=(.*)$/);if(ft)return ft[1]}return null}(W.params)||U.ACCESS_TOKEN;return U.REQUIRE_ACCESS_TOKEN&&ke&&this._skuToken&&W.params.push("sku="+this._skuToken),this._makeAPIURL(W,ke)},ne.prototype.canonicalizeTileURL=function(M,O){var W=ye(M);if(!W.path.match(/(^\/v4\/)/)||!W.path.match(/\.[\w]+$/))return M;var ie="mapbox://tiles/";ie+=W.path.replace("/v4/","");var xe=W.params;return O&&(xe=xe.filter(function(ke){return!ke.match(/^access_token=/)})),xe.length&&(ie+="?"+xe.join("&")),ie},ne.prototype.canonicalizeTileset=function(M,O){for(var W=!!O&&se(O),ie=[],xe=0,ke=M.tiles||[];xe<ke.length;xe+=1){var Pe=ke[xe];me(Pe)?ie.push(this.canonicalizeTileURL(Pe,W)):ie.push(Pe)}return ie},ne.prototype._makeAPIURL=function(M,O){var W="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",ie=ye(U.API_URL);if(M.protocol=ie.protocol,M.authority=ie.authority,ie.path!=="/"&&(M.path=""+ie.path+M.path),!U.REQUIRE_ACCESS_TOKEN)return Se(M);if(!(O=O||U.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+W);if(O[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+W);return M.params=M.params.filter(function(xe){return xe.indexOf("access_token")===-1}),M.params.push("access_token="+O),Se(M)};var oe=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function me(M){return oe.test(M)}var ce=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ye(M){var O=M.match(ce);if(!O)throw new Error("Unable to parse URL object");return{protocol:O[1],authority:O[2],path:O[3]||"/",params:O[4]?O[4].split("&"):[]}}function Se(M){var O=M.params.length?"?"+M.params.join("&"):"";return M.protocol+"://"+M.authority+M.path+O}function fe(M){if(!M)return null;var O,W=M.split(".");if(!W||W.length!==3)return null;try{return JSON.parse((O=W[1],decodeURIComponent(self.atob(O).split("").map(function(ie){return"%"+("00"+ie.charCodeAt(0).toString(16)).slice(-2)}).join(""))))}catch{return null}}var ge=function(M){this.type=M,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};ge.prototype.getStorageKey=function(M){var O,W=fe(U.ACCESS_TOKEN),ie="";return W&&W.u?(O=W.u,ie=self.btoa(encodeURIComponent(O).replace(/%([0-9A-F]{2})/g,function(xe,ke){return String.fromCharCode(Number("0x"+ke))}))):ie=U.ACCESS_TOKEN||"",M?"mapbox.eventData."+M+":"+ie:"mapbox.eventData:"+ie},ge.prototype.fetchEventData=function(){var M=j("localStorage"),O=this.getStorageKey(),W=this.getStorageKey("uuid");if(M)try{var ie=self.localStorage.getItem(O);ie&&(this.eventData=JSON.parse(ie));var xe=self.localStorage.getItem(W);xe&&(this.anonId=xe)}catch{A("Unable to read from LocalStorage")}},ge.prototype.saveEventData=function(){var M=j("localStorage"),O=this.getStorageKey(),W=this.getStorageKey("uuid");if(M)try{self.localStorage.setItem(W,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(O,JSON.stringify(this.eventData))}catch{A("Unable to write to LocalStorage")}},ge.prototype.processRequests=function(M){},ge.prototype.postEvent=function(M,O,W,ie){var xe=this;if(U.EVENTS_URL){var ke=ye(U.EVENTS_URL);ke.params.push("access_token="+(ie||U.ACCESS_TOKEN||""));var Pe={event:this.type,created:new Date(M).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.10.1",skuId:ee,userId:this.anonId},je=O?s(Pe,O):Pe,tt={url:Se(ke),headers:{"Content-Type":"text/plain"},body:JSON.stringify([je])};this.pendingRequest=jt(tt,function(ft){xe.pendingRequest=null,W(ft),xe.saveEventData(),xe.processRequests(ie)})}},ge.prototype.queueRequest=function(M,O){this.queue.push(M),this.processRequests(O)};var Te,le,ve=function(M){function O(){M.call(this,"map.load"),this.success={},this.skuToken=""}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.postMapLoadEvent=function(W,ie,xe,ke){this.skuToken=xe,(U.EVENTS_URL&&ke||U.ACCESS_TOKEN&&Array.isArray(W)&&W.some(function(Pe){return se(Pe)||me(Pe)}))&&this.queueRequest({id:ie,timestamp:Date.now()},ke)},O.prototype.processRequests=function(W){var ie=this;if(!this.pendingRequest&&this.queue.length!==0){var xe=this.queue.shift(),ke=xe.id,Pe=xe.timestamp;ke&&this.success[ke]||(this.anonId||this.fetchEventData(),x(this.anonId)||(this.anonId=i()),this.postEvent(Pe,{skuToken:this.skuToken},function(je){je||ke&&(ie.success[ke]=!0)},W))}},O}(ge),Me=new(function(M){function O(W){M.call(this,"appUserTurnstile"),this._customAccessToken=W}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.postTurnstileEvent=function(W,ie){U.EVENTS_URL&&U.ACCESS_TOKEN&&Array.isArray(W)&&W.some(function(xe){return se(xe)||me(xe)})&&this.queueRequest(Date.now(),ie)},O.prototype.processRequests=function(W){var ie=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var xe=fe(U.ACCESS_TOKEN),ke=xe?xe.u:U.ACCESS_TOKEN,Pe=ke!==this.eventData.tokenU;x(this.anonId)||(this.anonId=i(),Pe=!0);var je=this.queue.shift();if(this.eventData.lastSuccess){var tt=new Date(this.eventData.lastSuccess),ft=new Date(je),bt=(je-this.eventData.lastSuccess)/864e5;Pe=Pe||bt>=1||bt<-1||tt.getDate()!==ft.getDate()}else Pe=!0;if(!Pe)return this.processRequests();this.postEvent(je,{"enabled.telemetry":!1},function(Nt){Nt||(ie.eventData.lastSuccess=je,ie.eventData.tokenU=ke)},W)}},O}(ge)),we=Me.postTurnstileEvent.bind(Me),de=new ve,Ie=de.postMapLoadEvent.bind(de),De=500,Oe=50;function Ve(){self.caches&&!Te&&(Te=self.caches.open("mapbox-tiles"))}function Fe(M,O,W){if(Ve(),Te){var ie={status:O.status,statusText:O.statusText,headers:new self.Headers};O.headers.forEach(function(ke,Pe){return ie.headers.set(Pe,ke)});var xe=E(O.headers.get("Cache-Control")||"");xe["no-store"]||(xe["max-age"]&&ie.headers.set("Expires",new Date(W+1e3*xe["max-age"]).toUTCString()),new Date(ie.headers.get("Expires")).getTime()-W<42e4||function(ke,Pe){if(le===void 0)try{new Response(new ReadableStream),le=!0}catch{le=!1}le?Pe(ke.body):ke.blob().then(Pe)}(O,function(ke){var Pe=new self.Response(ke,ie);Ve(),Te&&Te.then(function(je){return je.put(ze(M.url),Pe)}).catch(function(je){return A(je.message)})}))}}function ze(M){var O=M.indexOf("?");return O<0?M:M.slice(0,O)}function Re(M,O){if(Ve(),!Te)return O(null);var W=ze(M.url);Te.then(function(ie){ie.match(W).then(function(xe){var ke=function(Pe){if(!Pe)return!1;var je=new Date(Pe.headers.get("Expires")||0),tt=E(Pe.headers.get("Cache-Control")||"");return je>Date.now()&&!tt["no-cache"]}(xe);ie.delete(W),ke&&ie.put(W,xe.clone()),O(null,xe,ke)}).catch(O)}).catch(O)}var We,$e=1/0;function at(){return We==null&&(We=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),We}var gt={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(gt);var xt=function(M){function O(W,ie,xe){ie===401&&me(xe)&&(W+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),M.call(this,W),this.status=ie,this.url=xe,this.name=this.constructor.name,this.message=W}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},O}(Error),mt=S()?function(){return self.worker&&self.worker.referrer}:function(){return(self.location.protocol==="blob:"?self.parent:self).location.href};function nt(M,O){var W,ie=new self.AbortController,xe=new self.Request(M.url,{method:M.method||"GET",body:M.body,credentials:M.credentials,headers:M.headers,referrer:mt(),signal:ie.signal}),ke=!1,Pe=!1,je=(W=xe.url).indexOf("sku=")>0&&me(W);M.type==="json"&&xe.headers.set("Accept","application/json");var tt=function(bt,Nt,Kt){if(!Pe){if(bt&&bt.message!=="SecurityError"&&A(bt),Nt&&Kt)return ft(Nt);var Wt=Date.now();self.fetch(xe).then(function(fr){if(fr.ok){var Tr=je?fr.clone():null;return ft(fr,Tr,Wt)}return O(new xt(fr.statusText,fr.status,M.url))}).catch(function(fr){fr.code!==20&&O(new Error(fr.message))})}},ft=function(bt,Nt,Kt){(M.type==="arrayBuffer"?bt.arrayBuffer():M.type==="json"?bt.json():bt.text()).then(function(Wt){Pe||(Nt&&Kt&&Fe(xe,Nt,Kt),ke=!0,O(null,Wt,bt.headers.get("Cache-Control"),bt.headers.get("Expires")))}).catch(function(Wt){Pe||O(new Error(Wt.message))})};return je?Re(xe,tt):tt(null,null),{cancel:function(){Pe=!0,ke||ie.abort()}}}var Qe=function(M,O){if(W=M.url,!(/^file:/.test(W)||/^file:/.test(mt())&&!/^\w+:/.test(W))){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return nt(M,O);if(S()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",M,O,void 0,!0)}var W;return function(ie,xe){var ke=new self.XMLHttpRequest;for(var Pe in ke.open(ie.method||"GET",ie.url,!0),ie.type==="arrayBuffer"&&(ke.responseType="arraybuffer"),ie.headers)ke.setRequestHeader(Pe,ie.headers[Pe]);return ie.type==="json"&&(ke.responseType="text",ke.setRequestHeader("Accept","application/json")),ke.withCredentials=ie.credentials==="include",ke.onerror=function(){xe(new Error(ke.statusText))},ke.onload=function(){if((ke.status>=200&&ke.status<300||ke.status===0)&&ke.response!==null){var je=ke.response;if(ie.type==="json")try{je=JSON.parse(ke.response)}catch(tt){return xe(tt)}xe(null,je,ke.getResponseHeader("Cache-Control"),ke.getResponseHeader("Expires"))}else xe(new xt(ke.statusText,ke.status,ie.url))},ke.send(ie.body),{cancel:function(){return ke.abort()}}}(M,O)},vt=function(M,O){return Qe(s(M,{type:"arrayBuffer"}),O)},jt=function(M,O){return Qe(s(M,{method:"POST"}),O)},Gt,$t;Gt=[],$t=0;var Zt=function(M,O){if(te.supported&&(M.headers||(M.headers={}),M.headers.accept="image/webp,*/*"),$t>=U.MAX_PARALLEL_IMAGE_REQUESTS){var W={requestParameters:M,callback:O,cancelled:!1,cancel:function(){this.cancelled=!0}};return Gt.push(W),W}$t++;var ie=!1,xe=function(){if(!ie)for(ie=!0,$t--;Gt.length&&$t<U.MAX_PARALLEL_IMAGE_REQUESTS;){var Pe=Gt.shift(),je=Pe.requestParameters,tt=Pe.callback;Pe.cancelled||(Pe.cancel=Zt(je,tt).cancel)}},ke=vt(M,function(Pe,je,tt,ft){xe(),Pe?O(Pe):je&&(at()?function(bt,Nt){var Kt=new self.Blob([new Uint8Array(bt)],{type:"image/png"});self.createImageBitmap(Kt).then(function(Wt){Nt(null,Wt)}).catch(function(Wt){Nt(new Error("Could not load image because of "+Wt.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(je,O):function(bt,Nt,Kt,Wt){var fr=new self.Image,Tr=self.URL;fr.onload=function(){Nt(null,fr),Tr.revokeObjectURL(fr.src)},fr.onerror=function(){return Nt(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var Br=new self.Blob([new Uint8Array(bt)],{type:"image/png"});fr.cacheControl=Kt,fr.expires=Wt,fr.src=bt.byteLength?Tr.createObjectURL(Br):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(je,O,tt,ft))});return{cancel:function(){ke.cancel(),xe()}}};function cr(M,O,W){W[M]&&W[M].indexOf(O)!==-1||(W[M]=W[M]||[],W[M].push(O))}function Dt(M,O,W){if(W&&W[M]){var ie=W[M].indexOf(O);ie!==-1&&W[M].splice(ie,1)}}var Ne=function(M,O){O===void 0&&(O={}),s(this,O),this.type=M},Ye=function(M){function O(W,ie){ie===void 0&&(ie={}),M.call(this,"error",s({error:W},ie))}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O}(Ne),pe=function(){};pe.prototype.on=function(M,O){return this._listeners=this._listeners||{},cr(M,O,this._listeners),this},pe.prototype.off=function(M,O){return Dt(M,O,this._listeners),Dt(M,O,this._oneTimeListeners),this},pe.prototype.once=function(M,O){return this._oneTimeListeners=this._oneTimeListeners||{},cr(M,O,this._oneTimeListeners),this},pe.prototype.fire=function(M,O){typeof M=="string"&&(M=new Ne(M,O||{}));var W=M.type;if(this.listens(W)){M.target=this;for(var ie=0,xe=this._listeners&&this._listeners[W]?this._listeners[W].slice():[];ie<xe.length;ie+=1)xe[ie].call(this,M);for(var ke=0,Pe=this._oneTimeListeners&&this._oneTimeListeners[W]?this._oneTimeListeners[W].slice():[];ke<Pe.length;ke+=1){var je=Pe[ke];Dt(W,je,this._oneTimeListeners),je.call(this,M)}var tt=this._eventedParent;tt&&(s(M,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),tt.fire(M))}else M instanceof Ye&&console.error(M.error);return this},pe.prototype.listens=function(M){return this._listeners&&this._listeners[M]&&this._listeners[M].length>0||this._oneTimeListeners&&this._oneTimeListeners[M]&&this._oneTimeListeners[M].length>0||this._eventedParent&&this._eventedParent.listens(M)},pe.prototype.setEventedParent=function(M,O){return this._eventedParent=M,this._eventedParentData=O,this};var _e={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Be=function(M,O,W,ie){this.message=(M?M+": ":"")+W,ie&&(this.identifier=ie),O!=null&&O.__line__&&(this.line=O.__line__)};function He(M){var O=M.key,W=M.value;return W?[new Be(O,W,"constants have been deprecated as of v8")]:[]}function Je(M){for(var O=[],W=arguments.length-1;W-- >0;)O[W]=arguments[W+1];for(var ie=0,xe=O;ie<xe.length;ie+=1){var ke=xe[ie];for(var Pe in ke)M[Pe]=ke[Pe]}return M}function Ze(M){return M instanceof Number||M instanceof String||M instanceof Boolean?M.valueOf():M}function ct(M){if(Array.isArray(M))return M.map(ct);if(M instanceof Object&&!(M instanceof Number||M instanceof String||M instanceof Boolean)){var O={};for(var W in M)O[W]=ct(M[W]);return O}return Ze(M)}var lt=function(M){function O(W,ie){M.call(this,ie),this.message=ie,this.key=W}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O}(Error),At=function(M,O){O===void 0&&(O=[]),this.parent=M,this.bindings={};for(var W=0,ie=O;W<ie.length;W+=1){var xe=ie[W],ke=xe[0],Pe=xe[1];this.bindings[ke]=Pe}};At.prototype.concat=function(M){return new At(this,M)},At.prototype.get=function(M){if(this.bindings[M])return this.bindings[M];if(this.parent)return this.parent.get(M);throw new Error(M+" not found in scope.")},At.prototype.has=function(M){return!!this.bindings[M]||!!this.parent&&this.parent.has(M)};var Ot={kind:"null"},it={kind:"number"},ht={kind:"string"},Ut={kind:"boolean"},Mt={kind:"color"},It={kind:"object"},Le={kind:"value"},Xe={kind:"collator"},ot={kind:"formatted"},pt={kind:"resolvedImage"};function St(M,O){return{kind:"array",itemType:M,N:O}}function Vt(M){if(M.kind==="array"){var O=Vt(M.itemType);return typeof M.N=="number"?"array<"+O+", "+M.N+">":M.itemType.kind==="value"?"array":"array<"+O+">"}return M.kind}var Jt=[Ot,it,ht,Ut,Mt,ot,It,St(Le),pt];function qt(M,O){if(O.kind==="error")return null;if(M.kind==="array"){if(O.kind==="array"&&(O.N===0&&O.itemType.kind==="value"||!qt(M.itemType,O.itemType))&&(typeof M.N!="number"||M.N===O.N))return null}else{if(M.kind===O.kind)return null;if(M.kind==="value"){for(var W=0,ie=Jt;W<ie.length;W+=1)if(!qt(ie[W],O))return null}}return"Expected "+Vt(M)+" but found "+Vt(O)+" instead."}function gr(M,O){return O.some(function(W){return W.kind===M.kind})}function Cr(M,O){return O.some(function(W){return W==="null"?M===null:W==="array"?Array.isArray(M):W==="object"?M&&!Array.isArray(M)&&typeof M=="object":W===typeof M})}var mr=t(function(M,O){var W={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function ie(tt){return(tt=Math.round(tt))<0?0:tt>255?255:tt}function xe(tt){return tt<0?0:tt>1?1:tt}function ke(tt){return tt[tt.length-1]==="%"?ie(parseFloat(tt)/100*255):ie(parseInt(tt))}function Pe(tt){return tt[tt.length-1]==="%"?xe(parseFloat(tt)/100):xe(parseFloat(tt))}function je(tt,ft,bt){return bt<0?bt+=1:bt>1&&(bt-=1),6*bt<1?tt+(ft-tt)*bt*6:2*bt<1?ft:3*bt<2?tt+(ft-tt)*(2/3-bt)*6:tt}try{O.parseCSSColor=function(tt){var ft,bt=tt.replace(/ /g,"").toLowerCase();if(bt in W)return W[bt].slice();if(bt[0]==="#")return bt.length===4?(ft=parseInt(bt.substr(1),16))>=0&&ft<=4095?[(3840&ft)>>4|(3840&ft)>>8,240&ft|(240&ft)>>4,15&ft|(15&ft)<<4,1]:null:bt.length===7&&(ft=parseInt(bt.substr(1),16))>=0&&ft<=16777215?[(16711680&ft)>>16,(65280&ft)>>8,255&ft,1]:null;var Nt=bt.indexOf("("),Kt=bt.indexOf(")");if(Nt!==-1&&Kt+1===bt.length){var Wt=bt.substr(0,Nt),fr=bt.substr(Nt+1,Kt-(Nt+1)).split(","),Tr=1;switch(Wt){case"rgba":if(fr.length!==4)return null;Tr=Pe(fr.pop());case"rgb":return fr.length!==3?null:[ke(fr[0]),ke(fr[1]),ke(fr[2]),Tr];case"hsla":if(fr.length!==4)return null;Tr=Pe(fr.pop());case"hsl":if(fr.length!==3)return null;var Br=(parseFloat(fr[0])%360+360)%360/360,Fr=Pe(fr[1]),Gr=Pe(fr[2]),Wr=Gr<=.5?Gr*(Fr+1):Gr+Fr-Gr*Fr,Jr=2*Gr-Wr;return[ie(255*je(Jr,Wr,Br+1/3)),ie(255*je(Jr,Wr,Br)),ie(255*je(Jr,Wr,Br-1/3)),Tr];default:return null}}return null}}catch{}}).parseCSSColor,tr=function(M,O,W,ie){ie===void 0&&(ie=1),this.r=M,this.g=O,this.b=W,this.a=ie};tr.parse=function(M){if(M){if(M instanceof tr)return M;if(typeof M=="string"){var O=mr(M);if(O)return new tr(O[0]/255*O[3],O[1]/255*O[3],O[2]/255*O[3],O[3])}}},tr.prototype.toString=function(){var M=this.toArray(),O=M[0],W=M[1],ie=M[2],xe=M[3];return"rgba("+Math.round(O)+","+Math.round(W)+","+Math.round(ie)+","+xe+")"},tr.prototype.toArray=function(){var M=this.r,O=this.g,W=this.b,ie=this.a;return ie===0?[0,0,0,0]:[255*M/ie,255*O/ie,255*W/ie,ie]},tr.black=new tr(0,0,0,1),tr.white=new tr(1,1,1,1),tr.transparent=new tr(0,0,0,0),tr.red=new tr(1,0,0,1);var nr=function(M,O,W){this.sensitivity=M?O?"variant":"case":O?"accent":"base",this.locale=W,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};nr.prototype.compare=function(M,O){return this.collator.compare(M,O)},nr.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Qt=function(M,O,W,ie,xe){this.text=M,this.image=O,this.scale=W,this.fontStack=ie,this.textColor=xe},dr=function(M){this.sections=M};dr.fromString=function(M){return new dr([new Qt(M,null,null,null,null)])},dr.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(M){return M.text.length!==0||M.image&&M.image.name.length!==0})},dr.factory=function(M){return M instanceof dr?M:dr.fromString(M)},dr.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(M){return M.text}).join("")},dr.prototype.serialize=function(){for(var M=["format"],O=0,W=this.sections;O<W.length;O+=1){var ie=W[O];if(ie.image)M.push(["image",ie.image.name]);else{M.push(ie.text);var xe={};ie.fontStack&&(xe["text-font"]=["literal",ie.fontStack.split(",")]),ie.scale&&(xe["font-scale"]=ie.scale),ie.textColor&&(xe["text-color"]=["rgba"].concat(ie.textColor.toArray())),M.push(xe)}}return M};var _r=function(M){this.name=M.name,this.available=M.available};function Ir(M,O,W,ie){return typeof M=="number"&&M>=0&&M<=255&&typeof O=="number"&&O>=0&&O<=255&&typeof W=="number"&&W>=0&&W<=255?ie===void 0||typeof ie=="number"&&ie>=0&&ie<=1?null:"Invalid rgba value ["+[M,O,W,ie].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof ie=="number"?[M,O,W,ie]:[M,O,W]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Rr(M){if(M===null||typeof M=="string"||typeof M=="boolean"||typeof M=="number"||M instanceof tr||M instanceof nr||M instanceof dr||M instanceof _r)return!0;if(Array.isArray(M)){for(var O=0,W=M;O<W.length;O+=1)if(!Rr(W[O]))return!1;return!0}if(typeof M=="object"){for(var ie in M)if(!Rr(M[ie]))return!1;return!0}return!1}function Vr(M){if(M===null)return Ot;if(typeof M=="string")return ht;if(typeof M=="boolean")return Ut;if(typeof M=="number")return it;if(M instanceof tr)return Mt;if(M instanceof nr)return Xe;if(M instanceof dr)return ot;if(M instanceof _r)return pt;if(Array.isArray(M)){for(var O,W=M.length,ie=0,xe=M;ie<xe.length;ie+=1){var ke=Vr(xe[ie]);if(O){if(O===ke)continue;O=Le;break}O=ke}return St(O||Le,W)}return It}function Xr(M){var O=typeof M;return M===null?"":O==="string"||O==="number"||O==="boolean"?String(M):M instanceof tr||M instanceof dr||M instanceof _r?M.toString():JSON.stringify(M)}_r.prototype.toString=function(){return this.name},_r.fromString=function(M){return M?new _r({name:M,available:!1}):null},_r.prototype.serialize=function(){return["image",this.name]};var cn=function(M,O){this.type=M,this.value=O};cn.parse=function(M,O){if(M.length!==2)return O.error("'literal' expression requires exactly one argument, but found "+(M.length-1)+" instead.");if(!Rr(M[1]))return O.error("invalid value");var W=M[1],ie=Vr(W),xe=O.expectedType;return ie.kind!=="array"||ie.N!==0||!xe||xe.kind!=="array"||typeof xe.N=="number"&&xe.N!==0||(ie=xe),new cn(ie,W)},cn.prototype.evaluate=function(){return this.value},cn.prototype.eachChild=function(){},cn.prototype.outputDefined=function(){return!0},cn.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof tr?["rgba"].concat(this.value.toArray()):this.value instanceof dr?this.value.serialize():this.value};var an=function(M){this.name="ExpressionEvaluationError",this.message=M};an.prototype.toJSON=function(){return this.message};var zn={string:ht,number:it,boolean:Ut,object:It},on=function(M,O){this.type=M,this.args=O};on.parse=function(M,O){if(M.length<2)return O.error("Expected at least one argument.");var W,ie=1,xe=M[0];if(xe==="array"){var ke,Pe;if(M.length>2){var je=M[1];if(typeof je!="string"||!(je in zn)||je==="object")return O.error('The item type argument of "array" must be one of string, number, boolean',1);ke=zn[je],ie++}else ke=Le;if(M.length>3){if(M[2]!==null&&(typeof M[2]!="number"||M[2]<0||M[2]!==Math.floor(M[2])))return O.error('The length argument to "array" must be a positive integer literal',2);Pe=M[2],ie++}W=St(ke,Pe)}else W=zn[xe];for(var tt=[];ie<M.length;ie++){var ft=O.parse(M[ie],ie,Le);if(!ft)return null;tt.push(ft)}return new on(W,tt)},on.prototype.evaluate=function(M){for(var O=0;O<this.args.length;O++){var W=this.args[O].evaluate(M);if(!qt(this.type,Vr(W)))return W;if(O===this.args.length-1)throw new an("Expected value to be of type "+Vt(this.type)+", but found "+Vt(Vr(W))+" instead.")}return null},on.prototype.eachChild=function(M){this.args.forEach(M)},on.prototype.outputDefined=function(){return this.args.every(function(M){return M.outputDefined()})},on.prototype.serialize=function(){var M=this.type,O=[M.kind];if(M.kind==="array"){var W=M.itemType;if(W.kind==="string"||W.kind==="number"||W.kind==="boolean"){O.push(W.kind);var ie=M.N;(typeof ie=="number"||this.args.length>1)&&O.push(ie)}}return O.concat(this.args.map(function(xe){return xe.serialize()}))};var Tn=function(M){this.type=ot,this.sections=M};Tn.parse=function(M,O){if(M.length<2)return O.error("Expected at least one argument.");var W=M[1];if(!Array.isArray(W)&&typeof W=="object")return O.error("First argument must be an image or text section.");for(var ie=[],xe=!1,ke=1;ke<=M.length-1;++ke){var Pe=M[ke];if(xe&&typeof Pe=="object"&&!Array.isArray(Pe)){xe=!1;var je=null;if(Pe["font-scale"]&&!(je=O.parse(Pe["font-scale"],1,it)))return null;var tt=null;if(Pe["text-font"]&&!(tt=O.parse(Pe["text-font"],1,St(ht))))return null;var ft=null;if(Pe["text-color"]&&!(ft=O.parse(Pe["text-color"],1,Mt)))return null;var bt=ie[ie.length-1];bt.scale=je,bt.font=tt,bt.textColor=ft}else{var Nt=O.parse(M[ke],1,Le);if(!Nt)return null;var Kt=Nt.type.kind;if(Kt!=="string"&&Kt!=="value"&&Kt!=="null"&&Kt!=="resolvedImage")return O.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");xe=!0,ie.push({content:Nt,scale:null,font:null,textColor:null})}}return new Tn(ie)},Tn.prototype.evaluate=function(M){return new dr(this.sections.map(function(O){var W=O.content.evaluate(M);return Vr(W)===pt?new Qt("",W,null,null,null):new Qt(Xr(W),null,O.scale?O.scale.evaluate(M):null,O.font?O.font.evaluate(M).join(","):null,O.textColor?O.textColor.evaluate(M):null)}))},Tn.prototype.eachChild=function(M){for(var O=0,W=this.sections;O<W.length;O+=1){var ie=W[O];M(ie.content),ie.scale&&M(ie.scale),ie.font&&M(ie.font),ie.textColor&&M(ie.textColor)}},Tn.prototype.outputDefined=function(){return!1},Tn.prototype.serialize=function(){for(var M=["format"],O=0,W=this.sections;O<W.length;O+=1){var ie=W[O];M.push(ie.content.serialize());var xe={};ie.scale&&(xe["font-scale"]=ie.scale.serialize()),ie.font&&(xe["text-font"]=ie.font.serialize()),ie.textColor&&(xe["text-color"]=ie.textColor.serialize()),M.push(xe)}return M};var Mn=function(M){this.type=pt,this.input=M};Mn.parse=function(M,O){if(M.length!==2)return O.error("Expected two arguments.");var W=O.parse(M[1],1,ht);return W?new Mn(W):O.error("No image name provided.")},Mn.prototype.evaluate=function(M){var O=this.input.evaluate(M),W=_r.fromString(O);return W&&M.availableImages&&(W.available=M.availableImages.indexOf(O)>-1),W},Mn.prototype.eachChild=function(M){M(this.input)},Mn.prototype.outputDefined=function(){return!1},Mn.prototype.serialize=function(){return["image",this.input.serialize()]};var ei={"to-boolean":Ut,"to-color":Mt,"to-number":it,"to-string":ht},Hr=function(M,O){this.type=M,this.args=O};Hr.parse=function(M,O){if(M.length<2)return O.error("Expected at least one argument.");var W=M[0];if((W==="to-boolean"||W==="to-string")&&M.length!==2)return O.error("Expected one argument.");for(var ie=ei[W],xe=[],ke=1;ke<M.length;ke++){var Pe=O.parse(M[ke],ke,Le);if(!Pe)return null;xe.push(Pe)}return new Hr(ie,xe)},Hr.prototype.evaluate=function(M){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(M));if(this.type.kind==="color"){for(var O,W,ie=0,xe=this.args;ie<xe.length;ie+=1){if(W=null,(O=xe[ie].evaluate(M))instanceof tr)return O;if(typeof O=="string"){var ke=M.parseColor(O);if(ke)return ke}else if(Array.isArray(O)&&!(W=O.length<3||O.length>4?"Invalid rbga value "+JSON.stringify(O)+": expected an array containing either three or four numeric values.":Ir(O[0],O[1],O[2],O[3])))return new tr(O[0]/255,O[1]/255,O[2]/255,O[3])}throw new an(W||"Could not parse color from value '"+(typeof O=="string"?O:String(JSON.stringify(O)))+"'")}if(this.type.kind==="number"){for(var Pe=null,je=0,tt=this.args;je<tt.length;je+=1){if((Pe=tt[je].evaluate(M))===null)return 0;var ft=Number(Pe);if(!isNaN(ft))return ft}throw new an("Could not convert "+JSON.stringify(Pe)+" to number.")}return this.type.kind==="formatted"?dr.fromString(Xr(this.args[0].evaluate(M))):this.type.kind==="resolvedImage"?_r.fromString(Xr(this.args[0].evaluate(M))):Xr(this.args[0].evaluate(M))},Hr.prototype.eachChild=function(M){this.args.forEach(M)},Hr.prototype.outputDefined=function(){return this.args.every(function(M){return M.outputDefined()})},Hr.prototype.serialize=function(){if(this.type.kind==="formatted")return new Tn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Mn(this.args[0]).serialize();var M=["to-"+this.type.kind];return this.eachChild(function(O){M.push(O.serialize())}),M};var ln=["Unknown","Point","LineString","Polygon"],bn=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};bn.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},bn.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?ln[this.feature.type]:this.feature.type:null},bn.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},bn.prototype.canonicalID=function(){return this.canonical},bn.prototype.properties=function(){return this.feature&&this.feature.properties||{}},bn.prototype.parseColor=function(M){var O=this._parseColorCache[M];return O||(O=this._parseColorCache[M]=tr.parse(M)),O};var nn=function(M,O,W,ie){this.name=M,this.type=O,this._evaluate=W,this.args=ie};nn.prototype.evaluate=function(M){return this._evaluate(M,this.args)},nn.prototype.eachChild=function(M){this.args.forEach(M)},nn.prototype.outputDefined=function(){return!1},nn.prototype.serialize=function(){return[this.name].concat(this.args.map(function(M){return M.serialize()}))},nn.parse=function(M,O){var W,ie=M[0],xe=nn.definitions[ie];if(!xe)return O.error('Unknown expression "'+ie+'". If you wanted a literal array, use ["literal", [...]].',0);for(var ke=Array.isArray(xe)?xe[0]:xe.type,Pe=Array.isArray(xe)?[[xe[1],xe[2]]]:xe.overloads,je=Pe.filter(function(ci){var Qn=ci[0];return!Array.isArray(Qn)||Qn.length===M.length-1}),tt=null,ft=0,bt=je;ft<bt.length;ft+=1){var Nt=bt[ft],Kt=Nt[0],Wt=Nt[1];tt=new sn(O.registry,O.path,null,O.scope);for(var fr=[],Tr=!1,Br=1;Br<M.length;Br++){var Fr=M[Br],Gr=Array.isArray(Kt)?Kt[Br-1]:Kt.type,Wr=tt.parse(Fr,1+fr.length,Gr);if(!Wr){Tr=!0;break}fr.push(Wr)}if(!Tr)if(Array.isArray(Kt)&&Kt.length!==fr.length)tt.error("Expected "+Kt.length+" arguments, but found "+fr.length+" instead.");else{for(var Jr=0;Jr<fr.length;Jr++){var gn=Array.isArray(Kt)?Kt[Jr]:Kt.type,An=fr[Jr];tt.concat(Jr+1).checkSubtype(gn,An.type)}if(tt.errors.length===0)return new nn(ie,ke,Wt,fr)}}if(je.length===1)(W=O.errors).push.apply(W,tt.errors);else{for(var Un=(je.length?je:Pe).map(function(ci){var Qn,mi=ci[0];return Qn=mi,Array.isArray(Qn)?"("+Qn.map(Vt).join(", ")+")":"("+Vt(Qn.type)+"...)"}).join(" | "),jn=[],Zn=1;Zn<M.length;Zn++){var li=O.parse(M[Zn],1+jn.length);if(!li)return null;jn.push(Vt(li.type))}O.error("Expected arguments of type "+Un+", but found ("+jn.join(", ")+") instead.")}return null},nn.register=function(M,O){for(var W in nn.definitions=O,O)M[W]=nn};var pn=function(M,O,W){this.type=Xe,this.locale=W,this.caseSensitive=M,this.diacriticSensitive=O};pn.parse=function(M,O){if(M.length!==2)return O.error("Expected one argument.");var W=M[1];if(typeof W!="object"||Array.isArray(W))return O.error("Collator options argument must be an object.");var ie=O.parse(W["case-sensitive"]!==void 0&&W["case-sensitive"],1,Ut);if(!ie)return null;var xe=O.parse(W["diacritic-sensitive"]!==void 0&&W["diacritic-sensitive"],1,Ut);if(!xe)return null;var ke=null;return W.locale&&!(ke=O.parse(W.locale,1,ht))?null:new pn(ie,xe,ke)},pn.prototype.evaluate=function(M){return new nr(this.caseSensitive.evaluate(M),this.diacriticSensitive.evaluate(M),this.locale?this.locale.evaluate(M):null)},pn.prototype.eachChild=function(M){M(this.caseSensitive),M(this.diacriticSensitive),this.locale&&M(this.locale)},pn.prototype.outputDefined=function(){return!1},pn.prototype.serialize=function(){var M={};return M["case-sensitive"]=this.caseSensitive.serialize(),M["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(M.locale=this.locale.serialize()),["collator",M]};function qn(M,O){M[0]=Math.min(M[0],O[0]),M[1]=Math.min(M[1],O[1]),M[2]=Math.max(M[2],O[0]),M[3]=Math.max(M[3],O[1])}function sr(M,O){return!(M[0]<=O[0])&&!(M[2]>=O[2])&&!(M[1]<=O[1])&&!(M[3]>=O[3])}function xr(M,O){var W,ie=(180+M[0])/360,xe=(W=M[1],(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+W*Math.PI/360)))/360),ke=Math.pow(2,O.z);return[Math.round(ie*ke*8192),Math.round(xe*ke*8192)]}function jr(M,O,W){return O[1]>M[1]!=W[1]>M[1]&&M[0]<(W[0]-O[0])*(M[1]-O[1])/(W[1]-O[1])+O[0]}function Rt(M,O){for(var W,ie,xe,ke,Pe,je,tt,ft=!1,bt=0,Nt=O.length;bt<Nt;bt++)for(var Kt=O[bt],Wt=0,fr=Kt.length;Wt<fr-1;Wt++){if(W=M,ie=Kt[Wt],xe=Kt[Wt+1],ke=void 0,Pe=void 0,je=void 0,tt=void 0,ke=W[0]-ie[0],Pe=W[1]-ie[1],je=W[0]-xe[0],tt=W[1]-xe[1],ke*tt-je*Pe==0&&ke*je<=0&&Pe*tt<=0)return!1;jr(M,Kt[Wt],Kt[Wt+1])&&(ft=!ft)}return ft}function or(M,O){for(var W=0;W<O.length;W++)if(Rt(M,O[W]))return!0;return!1}function wt(M,O,W,ie){var xe=M[0]-W[0],ke=M[1]-W[1],Pe=O[0]-W[0],je=O[1]-W[1],tt=ie[0]-W[0],ft=ie[1]-W[1],bt=xe*ft-tt*ke,Nt=Pe*ft-tt*je;return bt>0&&Nt<0||bt<0&&Nt>0}function ir(M,O,W){for(var ie=0,xe=W;ie<xe.length;ie+=1)for(var ke=xe[ie],Pe=0;Pe<ke.length-1;++Pe)if(je=M,tt=O,ft=ke[Pe],bt=ke[Pe+1],Nt=void 0,Kt=void 0,Wt=void 0,fr=void 0,Wt=[tt[0]-je[0],tt[1]-je[1]],fr=[bt[0]-ft[0],bt[1]-ft[1]],(Nt=fr)[0]*(Kt=Wt)[1]-Nt[1]*Kt[0]!=0&&wt(je,tt,ft,bt)&&wt(ft,bt,je,tt))return!0;var je,tt,ft,bt,Nt,Kt,Wt,fr;return!1}function ar(M,O){for(var W=0;W<M.length;++W)if(!Rt(M[W],O))return!1;for(var ie=0;ie<M.length-1;++ie)if(ir(M[ie],M[ie+1],O))return!1;return!0}function Dr(M,O){for(var W=0;W<O.length;W++)if(ar(M,O[W]))return!0;return!1}function Pr(M,O,W){for(var ie=[],xe=0;xe<M.length;xe++){for(var ke=[],Pe=0;Pe<M[xe].length;Pe++){var je=xr(M[xe][Pe],W);qn(O,je),ke.push(je)}ie.push(ke)}return ie}function Er(M,O,W){for(var ie=[],xe=0;xe<M.length;xe++){var ke=Pr(M[xe],O,W);ie.push(ke)}return ie}function Ar(M,O,W,ie){if(M[0]<W[0]||M[0]>W[2]){var xe=.5*ie,ke=M[0]-W[0]>xe?-ie:W[0]-M[0]>xe?ie:0;ke===0&&(ke=M[0]-W[2]>xe?-ie:W[2]-M[0]>xe?ie:0),M[0]+=ke}qn(O,M)}function vr(M,O,W,ie){for(var xe=8192*Math.pow(2,ie.z),ke=[8192*ie.x,8192*ie.y],Pe=[],je=0,tt=M;je<tt.length;je+=1)for(var ft=0,bt=tt[je];ft<bt.length;ft+=1){var Nt=bt[ft],Kt=[Nt.x+ke[0],Nt.y+ke[1]];Ar(Kt,O,W,xe),Pe.push(Kt)}return Pe}function wr(M,O,W,ie){for(var xe,ke=8192*Math.pow(2,ie.z),Pe=[8192*ie.x,8192*ie.y],je=[],tt=0,ft=M;tt<ft.length;tt+=1){for(var bt=[],Nt=0,Kt=ft[tt];Nt<Kt.length;Nt+=1){var Wt=Kt[Nt],fr=[Wt.x+Pe[0],Wt.y+Pe[1]];qn(O,fr),bt.push(fr)}je.push(bt)}if(O[2]-O[0]<=ke/2){(xe=O)[0]=xe[1]=1/0,xe[2]=xe[3]=-1/0;for(var Tr=0,Br=je;Tr<Br.length;Tr+=1)for(var Fr=0,Gr=Br[Tr];Fr<Gr.length;Fr+=1)Ar(Gr[Fr],O,W,ke)}return je}var Mr=function(M,O){this.type=Ut,this.geojson=M,this.geometries=O};function Lr(M){if(M instanceof nn&&(M.name==="get"&&M.args.length===1||M.name==="feature-state"||M.name==="has"&&M.args.length===1||M.name==="properties"||M.name==="geometry-type"||M.name==="id"||/^filter-/.test(M.name))||M instanceof Mr)return!1;var O=!0;return M.eachChild(function(W){O&&!Lr(W)&&(O=!1)}),O}function Zr(M){if(M instanceof nn&&M.name==="feature-state")return!1;var O=!0;return M.eachChild(function(W){O&&!Zr(W)&&(O=!1)}),O}function Yr(M,O){if(M instanceof nn&&O.indexOf(M.name)>=0)return!1;var W=!0;return M.eachChild(function(ie){W&&!Yr(ie,O)&&(W=!1)}),W}Mr.parse=function(M,O){if(M.length!==2)return O.error("'within' expression requires exactly one argument, but found "+(M.length-1)+" instead.");if(Rr(M[1])){var W=M[1];if(W.type==="FeatureCollection")for(var ie=0;ie<W.features.length;++ie){var xe=W.features[ie].geometry.type;if(xe==="Polygon"||xe==="MultiPolygon")return new Mr(W,W.features[ie].geometry)}else if(W.type==="Feature"){var ke=W.geometry.type;if(ke==="Polygon"||ke==="MultiPolygon")return new Mr(W,W.geometry)}else if(W.type==="Polygon"||W.type==="MultiPolygon")return new Mr(W,W)}return O.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Mr.prototype.evaluate=function(M){if(M.geometry()!=null&&M.canonicalID()!=null){if(M.geometryType()==="Point")return function(O,W){var ie=[1/0,1/0,-1/0,-1/0],xe=[1/0,1/0,-1/0,-1/0],ke=O.canonicalID();if(W.type==="Polygon"){var Pe=Pr(W.coordinates,xe,ke),je=vr(O.geometry(),ie,xe,ke);if(!sr(ie,xe))return!1;for(var tt=0,ft=je;tt<ft.length;tt+=1)if(!Rt(ft[tt],Pe))return!1}if(W.type==="MultiPolygon"){var bt=Er(W.coordinates,xe,ke),Nt=vr(O.geometry(),ie,xe,ke);if(!sr(ie,xe))return!1;for(var Kt=0,Wt=Nt;Kt<Wt.length;Kt+=1)if(!or(Wt[Kt],bt))return!1}return!0}(M,this.geometries);if(M.geometryType()==="LineString")return function(O,W){var ie=[1/0,1/0,-1/0,-1/0],xe=[1/0,1/0,-1/0,-1/0],ke=O.canonicalID();if(W.type==="Polygon"){var Pe=Pr(W.coordinates,xe,ke),je=wr(O.geometry(),ie,xe,ke);if(!sr(ie,xe))return!1;for(var tt=0,ft=je;tt<ft.length;tt+=1)if(!ar(ft[tt],Pe))return!1}if(W.type==="MultiPolygon"){var bt=Er(W.coordinates,xe,ke),Nt=wr(O.geometry(),ie,xe,ke);if(!sr(ie,xe))return!1;for(var Kt=0,Wt=Nt;Kt<Wt.length;Kt+=1)if(!Dr(Wt[Kt],bt))return!1}return!0}(M,this.geometries)}return!1},Mr.prototype.eachChild=function(){},Mr.prototype.outputDefined=function(){return!0},Mr.prototype.serialize=function(){return["within",this.geojson]};var rn=function(M,O){this.type=O.type,this.name=M,this.boundExpression=O};rn.parse=function(M,O){if(M.length!==2||typeof M[1]!="string")return O.error("'var' expression requires exactly one string literal argument.");var W=M[1];return O.scope.has(W)?new rn(W,O.scope.get(W)):O.error('Unknown variable "'+W+'". Make sure "'+W+'" has been bound in an enclosing "let" expression before using it.',1)},rn.prototype.evaluate=function(M){return this.boundExpression.evaluate(M)},rn.prototype.eachChild=function(){},rn.prototype.outputDefined=function(){return!1},rn.prototype.serialize=function(){return["var",this.name]};var sn=function(M,O,W,ie,xe){O===void 0&&(O=[]),ie===void 0&&(ie=new At),xe===void 0&&(xe=[]),this.registry=M,this.path=O,this.key=O.map(function(ke){return"["+ke+"]"}).join(""),this.scope=ie,this.errors=xe,this.expectedType=W};function yn(M,O){for(var W,ie,xe=M.length-1,ke=0,Pe=xe,je=0;ke<=Pe;)if(W=M[je=Math.floor((ke+Pe)/2)],ie=M[je+1],W<=O){if(je===xe||O<ie)return je;ke=je+1}else{if(!(W>O))throw new an("Input is not a number.");Pe=je-1}return 0}sn.prototype.parse=function(M,O,W,ie,xe){return xe===void 0&&(xe={}),O?this.concat(O,W,ie)._parse(M,xe):this._parse(M,xe)},sn.prototype._parse=function(M,O){function W(ft,bt,Nt){return Nt==="assert"?new on(bt,[ft]):Nt==="coerce"?new Hr(bt,[ft]):ft}if(M!==null&&typeof M!="string"&&typeof M!="boolean"&&typeof M!="number"||(M=["literal",M]),Array.isArray(M)){if(M.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var ie=M[0];if(typeof ie!="string")return this.error("Expression name must be a string, but found "+typeof ie+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var xe=this.registry[ie];if(xe){var ke=xe.parse(M,this);if(!ke)return null;if(this.expectedType){var Pe=this.expectedType,je=ke.type;if(Pe.kind!=="string"&&Pe.kind!=="number"&&Pe.kind!=="boolean"&&Pe.kind!=="object"&&Pe.kind!=="array"||je.kind!=="value")if(Pe.kind!=="color"&&Pe.kind!=="formatted"&&Pe.kind!=="resolvedImage"||je.kind!=="value"&&je.kind!=="string"){if(this.checkSubtype(Pe,je))return null}else ke=W(ke,Pe,O.typeAnnotation||"coerce");else ke=W(ke,Pe,O.typeAnnotation||"assert")}if(!(ke instanceof cn)&&ke.type.kind!=="resolvedImage"&&function ft(bt){if(bt instanceof rn)return ft(bt.boundExpression);if(bt instanceof nn&&bt.name==="error"||bt instanceof pn||bt instanceof Mr)return!1;var Nt=bt instanceof Hr||bt instanceof on,Kt=!0;return bt.eachChild(function(Wt){Kt=Nt?Kt&&ft(Wt):Kt&&Wt instanceof cn}),Kt?Lr(bt)&&Yr(bt,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"]):!1}(ke)){var tt=new bn;try{ke=new cn(ke.type,ke.evaluate(tt))}catch(ft){return this.error(ft.message),null}}return ke}return this.error('Unknown expression "'+ie+'". If you wanted a literal array, use ["literal", [...]].',0)}return M===void 0?this.error("'undefined' value invalid. Use null instead."):typeof M=="object"?this.error('Bare objects invalid. Use ["literal", {...}] instead.'):this.error("Expected an array, but found "+typeof M+" instead.")},sn.prototype.concat=function(M,O,W){var ie=typeof M=="number"?this.path.concat(M):this.path,xe=W?this.scope.concat(W):this.scope;return new sn(this.registry,ie,O||null,xe,this.errors)},sn.prototype.error=function(M){for(var O=[],W=arguments.length-1;W-- >0;)O[W]=arguments[W+1];var ie=""+this.key+O.map(function(xe){return"["+xe+"]"}).join("");this.errors.push(new lt(ie,M))},sn.prototype.checkSubtype=function(M,O){var W=qt(M,O);return W&&this.error(W),W};var kn=function(M,O,W){this.type=M,this.input=O,this.labels=[],this.outputs=[];for(var ie=0,xe=W;ie<xe.length;ie+=1){var ke=xe[ie],Pe=ke[0],je=ke[1];this.labels.push(Pe),this.outputs.push(je)}};function wn(M,O,W){return M*(1-W)+O*W}kn.parse=function(M,O){if(M.length-1<4)return O.error("Expected at least 4 arguments, but found only "+(M.length-1)+".");if((M.length-1)%2!=0)return O.error("Expected an even number of arguments.");var W=O.parse(M[1],1,it);if(!W)return null;var ie=[],xe=null;O.expectedType&&O.expectedType.kind!=="value"&&(xe=O.expectedType);for(var ke=1;ke<M.length;ke+=2){var Pe=ke===1?-1/0:M[ke],je=M[ke+1],tt=ke,ft=ke+1;if(typeof Pe!="number")return O.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',tt);if(ie.length&&ie[ie.length-1][0]>=Pe)return O.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',tt);var bt=O.parse(je,ft,xe);if(!bt)return null;xe=xe||bt.type,ie.push([Pe,bt])}return new kn(xe,W,ie)},kn.prototype.evaluate=function(M){var O=this.labels,W=this.outputs;if(O.length===1)return W[0].evaluate(M);var ie=this.input.evaluate(M);if(ie<=O[0])return W[0].evaluate(M);var xe=O.length;return ie>=O[xe-1]?W[xe-1].evaluate(M):W[yn(O,ie)].evaluate(M)},kn.prototype.eachChild=function(M){M(this.input);for(var O=0,W=this.outputs;O<W.length;O+=1)M(W[O])},kn.prototype.outputDefined=function(){return this.outputs.every(function(M){return M.outputDefined()})},kn.prototype.serialize=function(){for(var M=["step",this.input.serialize()],O=0;O<this.labels.length;O++)O>0&&M.push(this.labels[O]),M.push(this.outputs[O].serialize());return M};var Pn=Object.freeze({__proto__:null,number:wn,color:function(M,O,W){return new tr(wn(M.r,O.r,W),wn(M.g,O.g,W),wn(M.b,O.b,W),wn(M.a,O.a,W))},array:function(M,O,W){return M.map(function(ie,xe){return wn(ie,O[xe],W)})}}),Rn=6/29,Xn=3*Rn*Rn,Ai=Math.PI/180,Mi=180/Math.PI;function Cn(M){return M>.008856451679035631?Math.pow(M,1/3):M/Xn+4/29}function ti(M){return M>Rn?M*M*M:Xn*(M-4/29)}function $n(M){return 255*(M<=.0031308?12.92*M:1.055*Math.pow(M,1/2.4)-.055)}function Di(M){return(M/=255)<=.04045?M/12.92:Math.pow((M+.055)/1.055,2.4)}function va(M){var O=Di(M.r),W=Di(M.g),ie=Di(M.b),xe=Cn((.4124564*O+.3575761*W+.1804375*ie)/.95047),ke=Cn((.2126729*O+.7151522*W+.072175*ie)/1);return{l:116*ke-16,a:500*(xe-ke),b:200*(ke-Cn((.0193339*O+.119192*W+.9503041*ie)/1.08883)),alpha:M.a}}function ja(M){var O=(M.l+16)/116,W=isNaN(M.a)?O:O+M.a/500,ie=isNaN(M.b)?O:O-M.b/200;return O=1*ti(O),W=.95047*ti(W),ie=1.08883*ti(ie),new tr($n(3.2404542*W-1.5371385*O-.4985314*ie),$n(-.969266*W+1.8760108*O+.041556*ie),$n(.0556434*W-.2040259*O+1.0572252*ie),M.alpha)}function vo(M,O,W){var ie=O-M;return M+W*(ie>180||ie<-180?ie-360*Math.round(ie/360):ie)}var Wi={forward:va,reverse:ja,interpolate:function(M,O,W){return{l:wn(M.l,O.l,W),a:wn(M.a,O.a,W),b:wn(M.b,O.b,W),alpha:wn(M.alpha,O.alpha,W)}}},Zi={forward:function(M){var O=va(M),W=O.l,ie=O.a,xe=O.b,ke=Math.atan2(xe,ie)*Mi;return{h:ke<0?ke+360:ke,c:Math.sqrt(ie*ie+xe*xe),l:W,alpha:M.a}},reverse:function(M){var O=M.h*Ai,W=M.c;return ja({l:M.l,a:Math.cos(O)*W,b:Math.sin(O)*W,alpha:M.alpha})},interpolate:function(M,O,W){return{h:vo(M.h,O.h,W),c:wn(M.c,O.c,W),l:wn(M.l,O.l,W),alpha:wn(M.alpha,O.alpha,W)}}},no=Object.freeze({__proto__:null,lab:Wi,hcl:Zi}),Ni=function(M,O,W,ie,xe){this.type=M,this.operator=O,this.interpolation=W,this.input=ie,this.labels=[],this.outputs=[];for(var ke=0,Pe=xe;ke<Pe.length;ke+=1){var je=Pe[ke],tt=je[0],ft=je[1];this.labels.push(tt),this.outputs.push(ft)}};function yo(M,O,W,ie){var xe=ie-W,ke=M-W;return xe===0?0:O===1?ke/xe:(Math.pow(O,ke)-1)/(Math.pow(O,xe)-1)}Ni.interpolationFactor=function(M,O,W,ie){var xe=0;if(M.name==="exponential")xe=yo(O,M.base,W,ie);else if(M.name==="linear")xe=yo(O,1,W,ie);else if(M.name==="cubic-bezier"){var ke=M.controlPoints;xe=new n(ke[0],ke[1],ke[2],ke[3]).solve(yo(O,1,W,ie))}return xe},Ni.parse=function(M,O){var W=M[0],ie=M[1],xe=M[2],ke=M.slice(3);if(!Array.isArray(ie)||ie.length===0)return O.error("Expected an interpolation type expression.",1);if(ie[0]==="linear")ie={name:"linear"};else if(ie[0]==="exponential"){var Pe=ie[1];if(typeof Pe!="number")return O.error("Exponential interpolation requires a numeric base.",1,1);ie={name:"exponential",base:Pe}}else{if(ie[0]!=="cubic-bezier")return O.error("Unknown interpolation type "+String(ie[0]),1,0);var je=ie.slice(1);if(je.length!==4||je.some(function(Br){return typeof Br!="number"||Br<0||Br>1}))return O.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);ie={name:"cubic-bezier",controlPoints:je}}if(M.length-1<4)return O.error("Expected at least 4 arguments, but found only "+(M.length-1)+".");if((M.length-1)%2!=0)return O.error("Expected an even number of arguments.");if(!(xe=O.parse(xe,2,it)))return null;var tt=[],ft=null;W==="interpolate-hcl"||W==="interpolate-lab"?ft=Mt:O.expectedType&&O.expectedType.kind!=="value"&&(ft=O.expectedType);for(var bt=0;bt<ke.length;bt+=2){var Nt=ke[bt],Kt=ke[bt+1],Wt=bt+3,fr=bt+4;if(typeof Nt!="number")return O.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Wt);if(tt.length&&tt[tt.length-1][0]>=Nt)return O.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Wt);var Tr=O.parse(Kt,fr,ft);if(!Tr)return null;ft=ft||Tr.type,tt.push([Nt,Tr])}return ft.kind==="number"||ft.kind==="color"||ft.kind==="array"&&ft.itemType.kind==="number"&&typeof ft.N=="number"?new Ni(ft,W,ie,xe,tt):O.error("Type "+Vt(ft)+" is not interpolatable.")},Ni.prototype.evaluate=function(M){var O=this.labels,W=this.outputs;if(O.length===1)return W[0].evaluate(M);var ie=this.input.evaluate(M);if(ie<=O[0])return W[0].evaluate(M);var xe=O.length;if(ie>=O[xe-1])return W[xe-1].evaluate(M);var ke=yn(O,ie),Pe=O[ke],je=O[ke+1],tt=Ni.interpolationFactor(this.interpolation,ie,Pe,je),ft=W[ke].evaluate(M),bt=W[ke+1].evaluate(M);return this.operator==="interpolate"?Pn[this.type.kind.toLowerCase()](ft,bt,tt):this.operator==="interpolate-hcl"?Zi.reverse(Zi.interpolate(Zi.forward(ft),Zi.forward(bt),tt)):Wi.reverse(Wi.interpolate(Wi.forward(ft),Wi.forward(bt),tt))},Ni.prototype.eachChild=function(M){M(this.input);for(var O=0,W=this.outputs;O<W.length;O+=1)M(W[O])},Ni.prototype.outputDefined=function(){return this.outputs.every(function(M){return M.outputDefined()})},Ni.prototype.serialize=function(){var M;M=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var O=[this.operator,M,this.input.serialize()],W=0;W<this.labels.length;W++)O.push(this.labels[W],this.outputs[W].serialize());return O};var wo=function(M,O){this.type=M,this.args=O};wo.parse=function(M,O){if(M.length<2)return O.error("Expectected at least one argument.");var W=null,ie=O.expectedType;ie&&ie.kind!=="value"&&(W=ie);for(var xe=[],ke=0,Pe=M.slice(1);ke<Pe.length;ke+=1){var je=Pe[ke],tt=O.parse(je,1+xe.length,W,void 0,{typeAnnotation:"omit"});if(!tt)return null;W=W||tt.type,xe.push(tt)}var ft=ie&&xe.some(function(bt){return qt(ie,bt.type)});return new wo(ft?Le:W,xe)},wo.prototype.evaluate=function(M){for(var O,W=null,ie=0,xe=0,ke=this.args;xe<ke.length&&(ie++,(W=ke[xe].evaluate(M))&&W instanceof _r&&!W.available&&(O||(O=W.name),W=null,ie===this.args.length&&(W=O)),W===null);xe+=1);return W},wo.prototype.eachChild=function(M){this.args.forEach(M)},wo.prototype.outputDefined=function(){return this.args.every(function(M){return M.outputDefined()})},wo.prototype.serialize=function(){var M=["coalesce"];return this.eachChild(function(O){M.push(O.serialize())}),M};var Sa=function(M,O){this.type=O.type,this.bindings=[].concat(M),this.result=O};Sa.prototype.evaluate=function(M){return this.result.evaluate(M)},Sa.prototype.eachChild=function(M){for(var O=0,W=this.bindings;O<W.length;O+=1)M(W[O][1]);M(this.result)},Sa.parse=function(M,O){if(M.length<4)return O.error("Expected at least 3 arguments, but found "+(M.length-1)+" instead.");for(var W=[],ie=1;ie<M.length-1;ie+=2){var xe=M[ie];if(typeof xe!="string")return O.error("Expected string, but found "+typeof xe+" instead.",ie);if(/[^a-zA-Z0-9_]/.test(xe))return O.error("Variable names must contain only alphanumeric characters or '_'.",ie);var ke=O.parse(M[ie+1],ie+1);if(!ke)return null;W.push([xe,ke])}var Pe=O.parse(M[M.length-1],M.length-1,O.expectedType,W);return Pe?new Sa(W,Pe):null},Sa.prototype.outputDefined=function(){return this.result.outputDefined()},Sa.prototype.serialize=function(){for(var M=["let"],O=0,W=this.bindings;O<W.length;O+=1){var ie=W[O],xe=ie[0],ke=ie[1];M.push(xe,ke.serialize())}return M.push(this.result.serialize()),M};var io=function(M,O,W){this.type=M,this.index=O,this.input=W};io.parse=function(M,O){if(M.length!==3)return O.error("Expected 2 arguments, but found "+(M.length-1)+" instead.");var W=O.parse(M[1],1,it),ie=O.parse(M[2],2,St(O.expectedType||Le));if(!W||!ie)return null;var xe=ie.type;return new io(xe.itemType,W,ie)},io.prototype.evaluate=function(M){var O=this.index.evaluate(M),W=this.input.evaluate(M);if(O<0)throw new an("Array index out of bounds: "+O+" < 0.");if(O>=W.length)throw new an("Array index out of bounds: "+O+" > "+(W.length-1)+".");if(O!==Math.floor(O))throw new an("Array index must be an integer, but found "+O+" instead.");return W[O]},io.prototype.eachChild=function(M){M(this.index),M(this.input)},io.prototype.outputDefined=function(){return!1},io.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var To=function(M,O){this.type=Ut,this.needle=M,this.haystack=O};To.parse=function(M,O){if(M.length!==3)return O.error("Expected 2 arguments, but found "+(M.length-1)+" instead.");var W=O.parse(M[1],1,Le),ie=O.parse(M[2],2,Le);return W&&ie?gr(W.type,[Ut,ht,it,Ot,Le])?new To(W,ie):O.error("Expected first argument to be of type boolean, string, number or null, but found "+Vt(W.type)+" instead"):null},To.prototype.evaluate=function(M){var O=this.needle.evaluate(M),W=this.haystack.evaluate(M);if(!W)return!1;if(!Cr(O,["boolean","string","number","null"]))throw new an("Expected first argument to be of type boolean, string, number or null, but found "+Vt(Vr(O))+" instead.");if(!Cr(W,["string","array"]))throw new an("Expected second argument to be of type array or string, but found "+Vt(Vr(W))+" instead.");return W.indexOf(O)>=0},To.prototype.eachChild=function(M){M(this.needle),M(this.haystack)},To.prototype.outputDefined=function(){return!0},To.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Io=function(M,O,W){this.type=it,this.needle=M,this.haystack=O,this.fromIndex=W};Io.parse=function(M,O){if(M.length<=2||M.length>=5)return O.error("Expected 3 or 4 arguments, but found "+(M.length-1)+" instead.");var W=O.parse(M[1],1,Le),ie=O.parse(M[2],2,Le);if(!W||!ie)return null;if(!gr(W.type,[Ut,ht,it,Ot,Le]))return O.error("Expected first argument to be of type boolean, string, number or null, but found "+Vt(W.type)+" instead");if(M.length===4){var xe=O.parse(M[3],3,it);return xe?new Io(W,ie,xe):null}return new Io(W,ie)},Io.prototype.evaluate=function(M){var O=this.needle.evaluate(M),W=this.haystack.evaluate(M);if(!Cr(O,["boolean","string","number","null"]))throw new an("Expected first argument to be of type boolean, string, number or null, but found "+Vt(Vr(O))+" instead.");if(!Cr(W,["string","array"]))throw new an("Expected second argument to be of type array or string, but found "+Vt(Vr(W))+" instead.");if(this.fromIndex){var ie=this.fromIndex.evaluate(M);return W.indexOf(O,ie)}return W.indexOf(O)},Io.prototype.eachChild=function(M){M(this.needle),M(this.haystack),this.fromIndex&&M(this.fromIndex)},Io.prototype.outputDefined=function(){return!1},Io.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var M=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),M]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var qa=function(M,O,W,ie,xe,ke){this.inputType=M,this.type=O,this.input=W,this.cases=ie,this.outputs=xe,this.otherwise=ke};qa.parse=function(M,O){if(M.length<5)return O.error("Expected at least 4 arguments, but found only "+(M.length-1)+".");if(M.length%2!=1)return O.error("Expected an even number of arguments.");var W,ie;O.expectedType&&O.expectedType.kind!=="value"&&(ie=O.expectedType);for(var xe={},ke=[],Pe=2;Pe<M.length-1;Pe+=2){var je=M[Pe],tt=M[Pe+1];Array.isArray(je)||(je=[je]);var ft=O.concat(Pe);if(je.length===0)return ft.error("Expected at least one branch label.");for(var bt=0,Nt=je;bt<Nt.length;bt+=1){var Kt=Nt[bt];if(typeof Kt!="number"&&typeof Kt!="string")return ft.error("Branch labels must be numbers or strings.");if(typeof Kt=="number"&&Math.abs(Kt)>Number.MAX_SAFE_INTEGER)return ft.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof Kt=="number"&&Math.floor(Kt)!==Kt)return ft.error("Numeric branch labels must be integer values.");if(W){if(ft.checkSubtype(W,Vr(Kt)))return null}else W=Vr(Kt);if(xe[String(Kt)]!==void 0)return ft.error("Branch labels must be unique.");xe[String(Kt)]=ke.length}var Wt=O.parse(tt,Pe,ie);if(!Wt)return null;ie=ie||Wt.type,ke.push(Wt)}var fr=O.parse(M[1],1,Le);if(!fr)return null;var Tr=O.parse(M[M.length-1],M.length-1,ie);return Tr?fr.type.kind!=="value"&&O.concat(1).checkSubtype(W,fr.type)?null:new qa(W,ie,fr,xe,ke,Tr):null},qa.prototype.evaluate=function(M){var O=this.input.evaluate(M);return(Vr(O)===this.inputType&&this.outputs[this.cases[O]]||this.otherwise).evaluate(M)},qa.prototype.eachChild=function(M){M(this.input),this.outputs.forEach(M),M(this.otherwise)},qa.prototype.outputDefined=function(){return this.outputs.every(function(M){return M.outputDefined()})&&this.otherwise.outputDefined()},qa.prototype.serialize=function(){for(var M=this,O=["match",this.input.serialize()],W=[],ie={},xe=0,ke=Object.keys(this.cases).sort();xe<ke.length;xe+=1){var Pe=ke[xe];(Nt=ie[this.cases[Pe]])===void 0?(ie[this.cases[Pe]]=W.length,W.push([this.cases[Pe],[Pe]])):W[Nt][1].push(Pe)}for(var je=function(Wt){return M.inputType.kind==="number"?Number(Wt):Wt},tt=0,ft=W;tt<ft.length;tt+=1){var bt=ft[tt],Nt=bt[0],Kt=bt[1];Kt.length===1?O.push(je(Kt[0])):O.push(Kt.map(je)),O.push(this.outputs[outputIndex$1].serialize())}return O.push(this.otherwise.serialize()),O};var ya=function(M,O,W){this.type=M,this.branches=O,this.otherwise=W};ya.parse=function(M,O){if(M.length<4)return O.error("Expected at least 3 arguments, but found only "+(M.length-1)+".");if(M.length%2!=0)return O.error("Expected an odd number of arguments.");var W;O.expectedType&&O.expectedType.kind!=="value"&&(W=O.expectedType);for(var ie=[],xe=1;xe<M.length-1;xe+=2){var ke=O.parse(M[xe],xe,Ut);if(!ke)return null;var Pe=O.parse(M[xe+1],xe+1,W);if(!Pe)return null;ie.push([ke,Pe]),W=W||Pe.type}var je=O.parse(M[M.length-1],M.length-1,W);return je?new ya(W,ie,je):null},ya.prototype.evaluate=function(M){for(var O=0,W=this.branches;O<W.length;O+=1){var ie=W[O],xe=ie[0],ke=ie[1];if(xe.evaluate(M))return ke.evaluate(M)}return this.otherwise.evaluate(M)},ya.prototype.eachChild=function(M){for(var O=0,W=this.branches;O<W.length;O+=1){var ie=W[O],xe=ie[0],ke=ie[1];M(xe),M(ke)}M(this.otherwise)},ya.prototype.outputDefined=function(){return this.branches.every(function(M){return M[0],M[1].outputDefined()})&&this.otherwise.outputDefined()},ya.prototype.serialize=function(){var M=["case"];return this.eachChild(function(O){M.push(O.serialize())}),M};var to=function(M,O,W,ie){this.type=M,this.input=O,this.beginIndex=W,this.endIndex=ie};function Ds(M,O){return M==="=="||M==="!="?O.kind==="boolean"||O.kind==="string"||O.kind==="number"||O.kind==="null"||O.kind==="value":O.kind==="string"||O.kind==="number"||O.kind==="value"}function js(M,O,W,ie){return ie.compare(O,W)===0}function Xi(M,O,W){var ie=M!=="=="&&M!=="!=";return function(){function xe(ke,Pe,je){this.type=Ut,this.lhs=ke,this.rhs=Pe,this.collator=je,this.hasUntypedArgument=ke.type.kind==="value"||Pe.type.kind==="value"}return xe.parse=function(ke,Pe){if(ke.length!==3&&ke.length!==4)return Pe.error("Expected two or three arguments.");var je=ke[0],tt=Pe.parse(ke[1],1,Le);if(!tt)return null;if(!Ds(je,tt.type))return Pe.concat(1).error('"'+je+`" comparisons are not supported for type '`+Vt(tt.type)+"'.");var ft=Pe.parse(ke[2],2,Le);if(!ft)return null;if(!Ds(je,ft.type))return Pe.concat(2).error('"'+je+`" comparisons are not supported for type '`+Vt(ft.type)+"'.");if(tt.type.kind!==ft.type.kind&&tt.type.kind!=="value"&&ft.type.kind!=="value")return Pe.error("Cannot compare types '"+Vt(tt.type)+"' and '"+Vt(ft.type)+"'.");ie&&(tt.type.kind==="value"&&ft.type.kind!=="value"?tt=new on(ft.type,[tt]):tt.type.kind!=="value"&&ft.type.kind==="value"&&(ft=new on(tt.type,[ft])));var bt=null;if(ke.length===4){if(tt.type.kind!=="string"&&ft.type.kind!=="string"&&tt.type.kind!=="value"&&ft.type.kind!=="value")return Pe.error("Cannot use collator to compare non-string types.");if(!(bt=Pe.parse(ke[3],3,Xe)))return null}return new xe(tt,ft,bt)},xe.prototype.evaluate=function(ke){var Pe=this.lhs.evaluate(ke),je=this.rhs.evaluate(ke);if(ie&&this.hasUntypedArgument){var tt=Vr(Pe),ft=Vr(je);if(tt.kind!==ft.kind||tt.kind!=="string"&&tt.kind!=="number")throw new an('Expected arguments for "'+M+'" to be (string, string) or (number, number), but found ('+tt.kind+", "+ft.kind+") instead.")}if(this.collator&&!ie&&this.hasUntypedArgument){var bt=Vr(Pe),Nt=Vr(je);if(bt.kind!=="string"||Nt.kind!=="string")return O(ke,Pe,je)}return this.collator?W(ke,Pe,je,this.collator.evaluate(ke)):O(ke,Pe,je)},xe.prototype.eachChild=function(ke){ke(this.lhs),ke(this.rhs),this.collator&&ke(this.collator)},xe.prototype.outputDefined=function(){return!0},xe.prototype.serialize=function(){var ke=[M];return this.eachChild(function(Pe){ke.push(Pe.serialize())}),ke},xe}()}to.parse=function(M,O){if(M.length<=2||M.length>=5)return O.error("Expected 3 or 4 arguments, but found "+(M.length-1)+" instead.");var W=O.parse(M[1],1,Le),ie=O.parse(M[2],2,it);if(!W||!ie)return null;if(!gr(W.type,[St(Le),ht,Le]))return O.error("Expected first argument to be of type array or string, but found "+Vt(W.type)+" instead");if(M.length===4){var xe=O.parse(M[3],3,it);return xe?new to(W.type,W,ie,xe):null}return new to(W.type,W,ie)},to.prototype.evaluate=function(M){var O=this.input.evaluate(M),W=this.beginIndex.evaluate(M);if(!Cr(O,["string","array"]))throw new an("Expected first argument to be of type array or string, but found "+Vt(Vr(O))+" instead.");if(this.endIndex){var ie=this.endIndex.evaluate(M);return O.slice(W,ie)}return O.slice(W)},to.prototype.eachChild=function(M){M(this.input),M(this.beginIndex),this.endIndex&&M(this.endIndex)},to.prototype.outputDefined=function(){return!1},to.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var M=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),M]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var As=Xi("==",function(M,O,W){return O===W},js),fs=Xi("!=",function(M,O,W){return O!==W},function(M,O,W,ie){return!js(0,O,W,ie)}),Us=Xi("<",function(M,O,W){return O<W},function(M,O,W,ie){return ie.compare(O,W)<0}),Vs=Xi(">",function(M,O,W){return O>W},function(M,O,W,ie){return ie.compare(O,W)>0}),zs=Xi("<=",function(M,O,W){return O<=W},function(M,O,W,ie){return ie.compare(O,W)<=0}),Hs=Xi(">=",function(M,O,W){return O>=W},function(M,O,W,ie){return ie.compare(O,W)>=0}),Ro=function(M,O,W,ie,xe){this.type=ht,this.number=M,this.locale=O,this.currency=W,this.minFractionDigits=ie,this.maxFractionDigits=xe};Ro.parse=function(M,O){if(M.length!==3)return O.error("Expected two arguments.");var W=O.parse(M[1],1,it);if(!W)return null;var ie=M[2];if(typeof ie!="object"||Array.isArray(ie))return O.error("NumberFormat options argument must be an object.");var xe=null;if(ie.locale&&!(xe=O.parse(ie.locale,1,ht)))return null;var ke=null;if(ie.currency&&!(ke=O.parse(ie.currency,1,ht)))return null;var Pe=null;if(ie["min-fraction-digits"]&&!(Pe=O.parse(ie["min-fraction-digits"],1,it)))return null;var je=null;return ie["max-fraction-digits"]&&!(je=O.parse(ie["max-fraction-digits"],1,it))?null:new Ro(W,xe,ke,Pe,je)},Ro.prototype.evaluate=function(M){return new Intl.NumberFormat(this.locale?this.locale.evaluate(M):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(M):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(M):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(M):void 0}).format(this.number.evaluate(M))},Ro.prototype.eachChild=function(M){M(this.number),this.locale&&M(this.locale),this.currency&&M(this.currency),this.minFractionDigits&&M(this.minFractionDigits),this.maxFractionDigits&&M(this.maxFractionDigits)},Ro.prototype.outputDefined=function(){return!1},Ro.prototype.serialize=function(){var M={};return this.locale&&(M.locale=this.locale.serialize()),this.currency&&(M.currency=this.currency.serialize()),this.minFractionDigits&&(M["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(M["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),M]};var Fo=function(M){this.type=it,this.input=M};Fo.parse=function(M,O){if(M.length!==2)return O.error("Expected 1 argument, but found "+(M.length-1)+" instead.");var W=O.parse(M[1],1);return W?W.type.kind!=="array"&&W.type.kind!=="string"&&W.type.kind!=="value"?O.error("Expected argument of type string or array, but found "+Vt(W.type)+" instead."):new Fo(W):null},Fo.prototype.evaluate=function(M){var O=this.input.evaluate(M);if(typeof O=="string"||Array.isArray(O))return O.length;throw new an("Expected value to be of type string or array, but found "+Vt(Vr(O))+" instead.")},Fo.prototype.eachChild=function(M){M(this.input)},Fo.prototype.outputDefined=function(){return!1},Fo.prototype.serialize=function(){var M=["length"];return this.eachChild(function(O){M.push(O.serialize())}),M};var Xo={"==":As,"!=":fs,">":Vs,"<":Us,">=":Hs,"<=":zs,array:on,at:io,boolean:on,case:ya,coalesce:wo,collator:pn,format:Tn,image:Mn,in:To,"index-of":Io,interpolate:Ni,"interpolate-hcl":Ni,"interpolate-lab":Ni,length:Fo,let:Sa,literal:cn,match:qa,number:on,"number-format":Ro,object:on,slice:to,step:kn,string:on,"to-boolean":Hr,"to-color":Hr,"to-number":Hr,"to-string":Hr,var:rn,within:Mr};function Ko(M,O){var W=O[0],ie=O[1],xe=O[2],ke=O[3];W=W.evaluate(M),ie=ie.evaluate(M),xe=xe.evaluate(M);var Pe=ke?ke.evaluate(M):1,je=Ir(W,ie,xe,Pe);if(je)throw new an(je);return new tr(W/255*Pe,ie/255*Pe,xe/255*Pe,Pe)}function Jo(M,O){return M in O}function hs(M,O){var W=O[M];return W===void 0?null:W}function ko(M){return{type:M}}function Ss(M){return{result:"success",value:M}}function xo(M){return{result:"error",value:M}}function $o(M){return M["property-type"]==="data-driven"||M["property-type"]==="cross-faded-data-driven"}function Es(M){return!!M.expression&&M.expression.parameters.indexOf("zoom")>-1}function Bo(M){return!!M.expression&&M.expression.interpolated}function Gi(M){return M instanceof Number?"number":M instanceof String?"string":M instanceof Boolean?"boolean":Array.isArray(M)?"array":M===null?"null":typeof M}function Ue(M){return typeof M=="object"&&M!==null&&!Array.isArray(M)}function Ke(M){return M}function rt(M,O,W){return M!==void 0?M:O!==void 0?O:W!==void 0?W:void 0}function ut(M,O,W,ie,xe){return rt(typeof W===xe?ie[W]:void 0,M.default,O.default)}function _t(M,O,W){if(Gi(W)!=="number")return rt(M.default,O.default);var ie=M.stops.length;if(ie===1||W<=M.stops[0][0])return M.stops[0][1];if(W>=M.stops[ie-1][0])return M.stops[ie-1][1];var xe=yn(M.stops.map(function(ke){return ke[0]}),W);return M.stops[xe][1]}function yt(M,O,W){var ie=M.base!==void 0?M.base:1;if(Gi(W)!=="number")return rt(M.default,O.default);var xe=M.stops.length;if(xe===1||W<=M.stops[0][0])return M.stops[0][1];if(W>=M.stops[xe-1][0])return M.stops[xe-1][1];var ke=yn(M.stops.map(function(Nt){return Nt[0]}),W),Pe=function(Nt,Kt,Wt,fr){var Tr=fr-Wt,Br=Nt-Wt;return Tr===0?0:Kt===1?Br/Tr:(Math.pow(Kt,Br)-1)/(Math.pow(Kt,Tr)-1)}(W,ie,M.stops[ke][0],M.stops[ke+1][0]),je=M.stops[ke][1],tt=M.stops[ke+1][1],ft=Pn[O.type]||Ke;if(M.colorSpace&&M.colorSpace!=="rgb"){var bt=no[M.colorSpace];ft=function(Nt,Kt){return bt.reverse(bt.interpolate(bt.forward(Nt),bt.forward(Kt),Pe))}}return typeof je.evaluate=="function"?{evaluate:function(){for(var Nt=[],Kt=arguments.length;Kt--;)Nt[Kt]=arguments[Kt];var Wt=je.evaluate.apply(void 0,Nt),fr=tt.evaluate.apply(void 0,Nt);if(Wt!==void 0&&fr!==void 0)return ft(Wt,fr,Pe)}}:ft(je,tt,Pe)}function Ct(M,O,W){return O.type==="color"?W=tr.parse(W):O.type==="formatted"?W=dr.fromString(W.toString()):O.type==="resolvedImage"?W=_r.fromString(W.toString()):Gi(W)===O.type||O.type==="enum"&&O.values[W]||(W=void 0),rt(W,M.default,O.default)}nn.register(Xo,{error:[{kind:"error"},[ht],function(M,O){var W=O[0];throw new an(W.evaluate(M))}],typeof:[ht,[Le],function(M,O){return Vt(Vr(O[0].evaluate(M)))}],"to-rgba":[St(it,4),[Mt],function(M,O){return O[0].evaluate(M).toArray()}],rgb:[Mt,[it,it,it],Ko],rgba:[Mt,[it,it,it,it],Ko],has:{type:Ut,overloads:[[[ht],function(M,O){return Jo(O[0].evaluate(M),M.properties())}],[[ht,It],function(M,O){var W=O[0],ie=O[1];return Jo(W.evaluate(M),ie.evaluate(M))}]]},get:{type:Le,overloads:[[[ht],function(M,O){return hs(O[0].evaluate(M),M.properties())}],[[ht,It],function(M,O){var W=O[0],ie=O[1];return hs(W.evaluate(M),ie.evaluate(M))}]]},"feature-state":[Le,[ht],function(M,O){return hs(O[0].evaluate(M),M.featureState||{})}],properties:[It,[],function(M){return M.properties()}],"geometry-type":[ht,[],function(M){return M.geometryType()}],id:[Le,[],function(M){return M.id()}],zoom:[it,[],function(M){return M.globals.zoom}],"heatmap-density":[it,[],function(M){return M.globals.heatmapDensity||0}],"line-progress":[it,[],function(M){return M.globals.lineProgress||0}],accumulated:[Le,[],function(M){return M.globals.accumulated===void 0?null:M.globals.accumulated}],"+":[it,ko(it),function(M,O){for(var W=0,ie=0,xe=O;ie<xe.length;ie+=1)W+=xe[ie].evaluate(M);return W}],"*":[it,ko(it),function(M,O){for(var W=1,ie=0,xe=O;ie<xe.length;ie+=1)W*=xe[ie].evaluate(M);return W}],"-":{type:it,overloads:[[[it,it],function(M,O){var W=O[0],ie=O[1];return W.evaluate(M)-ie.evaluate(M)}],[[it],function(M,O){return-O[0].evaluate(M)}]]},"/":[it,[it,it],function(M,O){var W=O[0],ie=O[1];return W.evaluate(M)/ie.evaluate(M)}],"%":[it,[it,it],function(M,O){var W=O[0],ie=O[1];return W.evaluate(M)%ie.evaluate(M)}],ln2:[it,[],function(){return Math.LN2}],pi:[it,[],function(){return Math.PI}],e:[it,[],function(){return Math.E}],"^":[it,[it,it],function(M,O){var W=O[0],ie=O[1];return Math.pow(W.evaluate(M),ie.evaluate(M))}],sqrt:[it,[it],function(M,O){var W=O[0];return Math.sqrt(W.evaluate(M))}],log10:[it,[it],function(M,O){var W=O[0];return Math.log(W.evaluate(M))/Math.LN10}],ln:[it,[it],function(M,O){var W=O[0];return Math.log(W.evaluate(M))}],log2:[it,[it],function(M,O){var W=O[0];return Math.log(W.evaluate(M))/Math.LN2}],sin:[it,[it],function(M,O){var W=O[0];return Math.sin(W.evaluate(M))}],cos:[it,[it],function(M,O){var W=O[0];return Math.cos(W.evaluate(M))}],tan:[it,[it],function(M,O){var W=O[0];return Math.tan(W.evaluate(M))}],asin:[it,[it],function(M,O){var W=O[0];return Math.asin(W.evaluate(M))}],acos:[it,[it],function(M,O){var W=O[0];return Math.acos(W.evaluate(M))}],atan:[it,[it],function(M,O){var W=O[0];return Math.atan(W.evaluate(M))}],min:[it,ko(it),function(M,O){return Math.min.apply(Math,O.map(function(W){return W.evaluate(M)}))}],max:[it,ko(it),function(M,O){return Math.max.apply(Math,O.map(function(W){return W.evaluate(M)}))}],abs:[it,[it],function(M,O){var W=O[0];return Math.abs(W.evaluate(M))}],round:[it,[it],function(M,O){var W=O[0].evaluate(M);return W<0?-Math.round(-W):Math.round(W)}],floor:[it,[it],function(M,O){var W=O[0];return Math.floor(W.evaluate(M))}],ceil:[it,[it],function(M,O){var W=O[0];return Math.ceil(W.evaluate(M))}],"filter-==":[Ut,[ht,Le],function(M,O){var W=O[0],ie=O[1];return M.properties()[W.value]===ie.value}],"filter-id-==":[Ut,[Le],function(M,O){var W=O[0];return M.id()===W.value}],"filter-type-==":[Ut,[ht],function(M,O){var W=O[0];return M.geometryType()===W.value}],"filter-<":[Ut,[ht,Le],function(M,O){var W=O[0],ie=O[1],xe=M.properties()[W.value],ke=ie.value;return typeof xe==typeof ke&&xe<ke}],"filter-id-<":[Ut,[Le],function(M,O){var W=O[0],ie=M.id(),xe=W.value;return typeof ie==typeof xe&&ie<xe}],"filter->":[Ut,[ht,Le],function(M,O){var W=O[0],ie=O[1],xe=M.properties()[W.value],ke=ie.value;return typeof xe==typeof ke&&xe>ke}],"filter-id->":[Ut,[Le],function(M,O){var W=O[0],ie=M.id(),xe=W.value;return typeof ie==typeof xe&&ie>xe}],"filter-<=":[Ut,[ht,Le],function(M,O){var W=O[0],ie=O[1],xe=M.properties()[W.value],ke=ie.value;return typeof xe==typeof ke&&xe<=ke}],"filter-id-<=":[Ut,[Le],function(M,O){var W=O[0],ie=M.id(),xe=W.value;return typeof ie==typeof xe&&ie<=xe}],"filter->=":[Ut,[ht,Le],function(M,O){var W=O[0],ie=O[1],xe=M.properties()[W.value],ke=ie.value;return typeof xe==typeof ke&&xe>=ke}],"filter-id->=":[Ut,[Le],function(M,O){var W=O[0],ie=M.id(),xe=W.value;return typeof ie==typeof xe&&ie>=xe}],"filter-has":[Ut,[Le],function(M,O){return O[0].value in M.properties()}],"filter-has-id":[Ut,[],function(M){return M.id()!==null&&M.id()!==void 0}],"filter-type-in":[Ut,[St(ht)],function(M,O){return O[0].value.indexOf(M.geometryType())>=0}],"filter-id-in":[Ut,[St(Le)],function(M,O){return O[0].value.indexOf(M.id())>=0}],"filter-in-small":[Ut,[ht,St(Le)],function(M,O){var W=O[0];return O[1].value.indexOf(M.properties()[W.value])>=0}],"filter-in-large":[Ut,[ht,St(Le)],function(M,O){var W=O[0],ie=O[1];return function(xe,ke,Pe,je){for(;Pe<=je;){var tt=Pe+je>>1;if(ke[tt]===xe)return!0;ke[tt]>xe?je=tt-1:Pe=tt+1}return!1}(M.properties()[W.value],ie.value,0,ie.value.length-1)}],all:{type:Ut,overloads:[[[Ut,Ut],function(M,O){var W=O[0],ie=O[1];return W.evaluate(M)&&ie.evaluate(M)}],[ko(Ut),function(M,O){for(var W=0,ie=O;W<ie.length;W+=1)if(!ie[W].evaluate(M))return!1;return!0}]]},any:{type:Ut,overloads:[[[Ut,Ut],function(M,O){var W=O[0],ie=O[1];return W.evaluate(M)||ie.evaluate(M)}],[ko(Ut),function(M,O){for(var W=0,ie=O;W<ie.length;W+=1)if(ie[W].evaluate(M))return!0;return!1}]]},"!":[Ut,[Ut],function(M,O){return!O[0].evaluate(M)}],"is-supported-script":[Ut,[ht],function(M,O){var W=O[0],ie=M.globals&&M.globals.isSupportedScript;return!ie||ie(W.evaluate(M))}],upcase:[ht,[ht],function(M,O){return O[0].evaluate(M).toUpperCase()}],downcase:[ht,[ht],function(M,O){return O[0].evaluate(M).toLowerCase()}],concat:[ht,ko(Le),function(M,O){return O.map(function(W){return Xr(W.evaluate(M))}).join("")}],"resolved-locale":[ht,[Xe],function(M,O){return O[0].evaluate(M).resolvedLocale()}]});var er=function(M,O){this.expression=M,this._warningHistory={},this._evaluator=new bn,this._defaultValue=O?function(W){return W.type==="color"&&Ue(W.default)?new tr(0,0,0,0):W.type==="color"?tr.parse(W.default)||null:W.default===void 0?null:W.default}(O):null,this._enumValues=O&&O.type==="enum"?O.values:null};function rr(M){return Array.isArray(M)&&M.length>0&&typeof M[0]=="string"&&M[0]in Xo}function Xt(M,O){var W=new sn(Xo,[],O?function(xe){var ke={color:Mt,string:ht,number:it,enum:ht,boolean:Ut,formatted:ot,resolvedImage:pt};return xe.type==="array"?St(ke[xe.value]||Le,xe.length):ke[xe.type]}(O):void 0),ie=W.parse(M,void 0,void 0,void 0,O&&O.type==="string"?{typeAnnotation:"coerce"}:void 0);return ie?Ss(new er(ie,O)):xo(W.errors)}er.prototype.evaluateWithoutErrorHandling=function(M,O,W,ie,xe,ke){return this._evaluator.globals=M,this._evaluator.feature=O,this._evaluator.featureState=W,this._evaluator.canonical=ie,this._evaluator.availableImages=xe||null,this._evaluator.formattedSection=ke,this.expression.evaluate(this._evaluator)},er.prototype.evaluate=function(M,O,W,ie,xe,ke){this._evaluator.globals=M,this._evaluator.feature=O||null,this._evaluator.featureState=W||null,this._evaluator.canonical=ie,this._evaluator.availableImages=xe||null,this._evaluator.formattedSection=ke||null;try{var Pe=this.expression.evaluate(this._evaluator);if(Pe==null||typeof Pe=="number"&&Pe!=Pe)return this._defaultValue;if(this._enumValues&&!(Pe in this._enumValues))throw new an("Expected value to be one of "+Object.keys(this._enumValues).map(function(je){return JSON.stringify(je)}).join(", ")+", but found "+JSON.stringify(Pe)+" instead.");return Pe}catch(je){return this._warningHistory[je.message]||(this._warningHistory[je.message]=!0,typeof console<"u"&&console.warn(je.message)),this._defaultValue}};var ur=function(M,O){this.kind=M,this._styleExpression=O,this.isStateDependent=M!=="constant"&&!Zr(O.expression)};ur.prototype.evaluateWithoutErrorHandling=function(M,O,W,ie,xe,ke){return this._styleExpression.evaluateWithoutErrorHandling(M,O,W,ie,xe,ke)},ur.prototype.evaluate=function(M,O,W,ie,xe,ke){return this._styleExpression.evaluate(M,O,W,ie,xe,ke)};var yr=function(M,O,W,ie){this.kind=M,this.zoomStops=W,this._styleExpression=O,this.isStateDependent=M!=="camera"&&!Zr(O.expression),this.interpolationType=ie};function kr(M,O){if((M=Xt(M,O)).result==="error")return M;var W=M.value.expression,ie=Lr(W);if(!ie&&!$o(O))return xo([new lt("","data expressions not supported")]);var xe=Yr(W,["zoom"]);if(!xe&&!Es(O))return xo([new lt("","zoom expressions not supported")]);var ke=function je(tt){var ft=null;if(tt instanceof Sa)ft=je(tt.result);else if(tt instanceof wo)for(var bt=0,Nt=tt.args;bt<Nt.length;bt+=1){var Kt=Nt[bt];if(ft=je(Kt))break}else(tt instanceof kn||tt instanceof Ni)&&tt.input instanceof nn&&tt.input.name==="zoom"&&(ft=tt);return ft instanceof lt||tt.eachChild(function(Wt){var fr=je(Wt);fr instanceof lt?ft=fr:!ft&&fr?ft=new lt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):ft&&fr&&ft!==fr&&(ft=new lt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),ft}(W);if(!ke&&!xe)return xo([new lt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')]);if(ke instanceof lt)return xo([ke]);if(ke instanceof Ni&&!Bo(O))return xo([new lt("",'"interpolate" expressions cannot be used with this property')]);if(!ke)return Ss(new ur(ie?"constant":"source",M.value));var Pe=ke instanceof Ni?ke.interpolation:void 0;return Ss(new yr(ie?"camera":"composite",M.value,ke.labels,Pe))}yr.prototype.evaluateWithoutErrorHandling=function(M,O,W,ie,xe,ke){return this._styleExpression.evaluateWithoutErrorHandling(M,O,W,ie,xe,ke)},yr.prototype.evaluate=function(M,O,W,ie,xe,ke){return this._styleExpression.evaluate(M,O,W,ie,xe,ke)},yr.prototype.interpolationFactor=function(M,O,W){return this.interpolationType?Ni.interpolationFactor(this.interpolationType,M,O,W):0};var Sr=function(M,O){this._parameters=M,this._specification=O,Je(this,function W(ie,xe){var ke,Pe,je,tt=xe.type==="color",ft=ie.stops&&typeof ie.stops[0][0]=="object",bt=ft||ie.property!==void 0,Nt=ft||!bt,Kt=ie.type||(Bo(xe)?"exponential":"interval");if(tt&&((ie=Je({},ie)).stops&&(ie.stops=ie.stops.map(function(ci){return[ci[0],tr.parse(ci[1])]})),ie.default?ie.default=tr.parse(ie.default):ie.default=tr.parse(xe.default)),ie.colorSpace&&ie.colorSpace!=="rgb"&&!no[ie.colorSpace])throw new Error("Unknown color space: "+ie.colorSpace);if(Kt==="exponential")ke=yt;else if(Kt==="interval")ke=_t;else if(Kt==="categorical"){ke=ut,Pe=Object.create(null);for(var Wt=0,fr=ie.stops;Wt<fr.length;Wt+=1){var Tr=fr[Wt];Pe[Tr[0]]=Tr[1]}je=typeof ie.stops[0][0]}else{if(Kt!=="identity")throw new Error('Unknown function type "'+Kt+'"');ke=Ct}if(ft){for(var Br={},Fr=[],Gr=0;Gr<ie.stops.length;Gr++){var Wr=ie.stops[Gr],Jr=Wr[0].zoom;Br[Jr]===void 0&&(Br[Jr]={zoom:Jr,type:ie.type,property:ie.property,default:ie.default,stops:[]},Fr.push(Jr)),Br[Jr].stops.push([Wr[0].value,Wr[1]])}for(var gn=[],An=0,Un=Fr;An<Un.length;An+=1){var jn=Un[An];gn.push([Br[jn].zoom,W(Br[jn],xe)])}var Zn={name:"linear"};return{kind:"composite",interpolationType:Zn,interpolationFactor:Ni.interpolationFactor.bind(void 0,Zn),zoomStops:gn.map(function(ci){return ci[0]}),evaluate:function(ci,Qn){var mi=ci.zoom;return yt({stops:gn,base:ie.base},xe,mi).evaluate(mi,Qn)}}}if(Nt){var li=Kt==="exponential"?{name:"exponential",base:ie.base!==void 0?ie.base:1}:null;return{kind:"camera",interpolationType:li,interpolationFactor:Ni.interpolationFactor.bind(void 0,li),zoomStops:ie.stops.map(function(ci){return ci[0]}),evaluate:function(ci){var Qn=ci.zoom;return ke(ie,xe,Qn,Pe,je)}}}return{kind:"source",evaluate:function(ci,Qn){var mi=Qn&&Qn.properties?Qn.properties[ie.property]:void 0;return mi===void 0?rt(ie.default,xe.default):ke(ie,xe,mi,Pe,je)}}}(this._parameters,this._specification))};function Ur(M){var O=M.key,W=M.value,ie=M.valueSpec||{},xe=M.objectElementValidators||{},ke=M.style,Pe=M.styleSpec,je=[],tt=Gi(W);if(tt!=="object")return[new Be(O,W,"object expected, "+tt+" found")];for(var ft in W){var bt=ft.split(".")[0],Nt=ie[bt]||ie["*"],Kt=void 0;if(xe[bt])Kt=xe[bt];else if(ie[bt])Kt=hr;else if(xe["*"])Kt=xe["*"];else{if(!ie["*"]){je.push(new Be(O,W[ft],'unknown property "'+ft+'"'));continue}Kt=hr}je=je.concat(Kt({key:(O&&O+".")+ft,value:W[ft],valueSpec:Nt,style:ke,styleSpec:Pe,object:W,objectKey:ft},W))}for(var Wt in ie)xe[Wt]||ie[Wt].required&&ie[Wt].default===void 0&&W[Wt]===void 0&&je.push(new Be(O,W,'missing required property "'+Wt+'"'));return je}function un(M){var O=M.value,W=M.valueSpec,ie=M.style,xe=M.styleSpec,ke=M.key,Pe=M.arrayElementValidator||hr;if(Gi(O)!=="array")return[new Be(ke,O,"array expected, "+Gi(O)+" found")];if(W.length&&O.length!==W.length)return[new Be(ke,O,"array length "+W.length+" expected, length "+O.length+" found")];if(W["min-length"]&&O.length<W["min-length"])return[new Be(ke,O,"array length at least "+W["min-length"]+" expected, length "+O.length+" found")];var je={type:W.value,values:W.values};xe.$version<7&&(je.function=W.function),Gi(W.value)==="object"&&(je=W.value);for(var tt=[],ft=0;ft<O.length;ft++)tt=tt.concat(Pe({array:O,arrayIndex:ft,value:O[ft],valueSpec:je,style:ie,styleSpec:xe,key:ke+"["+ft+"]"}));return tt}function xn(M){var O=M.key,W=M.value,ie=M.valueSpec,xe=Gi(W);return xe==="number"&&W!=W&&(xe="NaN"),xe!=="number"?[new Be(O,W,"number expected, "+xe+" found")]:"minimum"in ie&&W<ie.minimum?[new Be(O,W,W+" is less than the minimum value "+ie.minimum)]:"maximum"in ie&&W>ie.maximum?[new Be(O,W,W+" is greater than the maximum value "+ie.maximum)]:[]}function On(M){var O,W,ie,xe=M.valueSpec,ke=Ze(M.value.type),Pe={},je=ke!=="categorical"&&M.value.property===void 0,tt=!je,ft=Gi(M.value.stops)==="array"&&Gi(M.value.stops[0])==="array"&&Gi(M.value.stops[0][0])==="object",bt=Ur({key:M.key,value:M.value,valueSpec:M.styleSpec.function,style:M.style,styleSpec:M.styleSpec,objectElementValidators:{stops:function(Wt){if(ke==="identity")return[new Be(Wt.key,Wt.value,'identity function may not have a "stops" property')];var fr=[],Tr=Wt.value;return fr=fr.concat(un({key:Wt.key,value:Tr,valueSpec:Wt.valueSpec,style:Wt.style,styleSpec:Wt.styleSpec,arrayElementValidator:Nt})),Gi(Tr)==="array"&&Tr.length===0&&fr.push(new Be(Wt.key,Tr,"array must have at least one stop")),fr},default:function(Wt){return hr({key:Wt.key,value:Wt.value,valueSpec:xe,style:Wt.style,styleSpec:Wt.styleSpec})}}});return ke==="identity"&&je&&bt.push(new Be(M.key,M.value,'missing required property "property"')),ke==="identity"||M.value.stops||bt.push(new Be(M.key,M.value,'missing required property "stops"')),ke==="exponential"&&M.valueSpec.expression&&!Bo(M.valueSpec)&&bt.push(new Be(M.key,M.value,"exponential functions not supported")),M.styleSpec.$version>=8&&(tt&&!$o(M.valueSpec)?bt.push(new Be(M.key,M.value,"property functions not supported")):je&&!Es(M.valueSpec)&&bt.push(new Be(M.key,M.value,"zoom functions not supported"))),ke!=="categorical"&&!ft||M.value.property!==void 0||bt.push(new Be(M.key,M.value,'"property" property is required')),bt;function Nt(Wt){var fr=[],Tr=Wt.value,Br=Wt.key;if(Gi(Tr)!=="array")return[new Be(Br,Tr,"array expected, "+Gi(Tr)+" found")];if(Tr.length!==2)return[new Be(Br,Tr,"array length 2 expected, length "+Tr.length+" found")];if(ft){if(Gi(Tr[0])!=="object")return[new Be(Br,Tr,"object expected, "+Gi(Tr[0])+" found")];if(Tr[0].zoom===void 0)return[new Be(Br,Tr,"object stop key must have zoom")];if(Tr[0].value===void 0)return[new Be(Br,Tr,"object stop key must have value")];if(ie&&ie>Ze(Tr[0].zoom))return[new Be(Br,Tr[0].zoom,"stop zoom values must appear in ascending order")];Ze(Tr[0].zoom)!==ie&&(ie=Ze(Tr[0].zoom),W=void 0,Pe={}),fr=fr.concat(Ur({key:Br+"[0]",value:Tr[0],valueSpec:{zoom:{}},style:Wt.style,styleSpec:Wt.styleSpec,objectElementValidators:{zoom:xn,value:Kt}}))}else fr=fr.concat(Kt({key:Br+"[0]",value:Tr[0],valueSpec:{},style:Wt.style,styleSpec:Wt.styleSpec},Tr));return rr(ct(Tr[1]))?fr.concat([new Be(Br+"[1]",Tr[1],"expressions are not allowed in function stops.")]):fr.concat(hr({key:Br+"[1]",value:Tr[1],valueSpec:xe,style:Wt.style,styleSpec:Wt.styleSpec}))}function Kt(Wt,fr){var Tr=Gi(Wt.value),Br=Ze(Wt.value),Fr=Wt.value!==null?Wt.value:fr;if(O){if(Tr!==O)return[new Be(Wt.key,Fr,Tr+" stop domain type must match previous stop domain type "+O)]}else O=Tr;if(Tr!=="number"&&Tr!=="string"&&Tr!=="boolean")return[new Be(Wt.key,Fr,"stop domain value must be a number, string, or boolean")];if(Tr!=="number"&&ke!=="categorical"){var Gr="number expected, "+Tr+" found";return $o(xe)&&ke===void 0&&(Gr+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Be(Wt.key,Fr,Gr)]}return ke!=="categorical"||Tr!=="number"||isFinite(Br)&&Math.floor(Br)===Br?ke!=="categorical"&&Tr==="number"&&W!==void 0&&Br<W?[new Be(Wt.key,Fr,"stop domain values must appear in ascending order")]:(W=Br,ke==="categorical"&&Br in Pe?[new Be(Wt.key,Fr,"stop domain values must be unique")]:(Pe[Br]=!0,[])):[new Be(Wt.key,Fr,"integer expected, found "+Br)]}}function Fn(M){var O=(M.expressionContext==="property"?kr:Xt)(ct(M.value),M.valueSpec);if(O.result==="error")return O.value.map(function(ie){return new Be(""+M.key+ie.key,M.value,ie.message)});var W=O.value.expression||O.value._styleExpression.expression;if(M.expressionContext==="property"&&M.propertyKey==="text-font"&&!W.outputDefined())return[new Be(M.key,M.value,'Invalid data expression for "'+M.propertyKey+'". Output values must be contained as literals within the expression.')];if(M.expressionContext==="property"&&M.propertyType==="layout"&&!Zr(W))return[new Be(M.key,M.value,'"feature-state" data expressions are not supported with layout properties.')];if(M.expressionContext==="filter"&&!Zr(W))return[new Be(M.key,M.value,'"feature-state" data expressions are not supported with filters.')];if(M.expressionContext&&M.expressionContext.indexOf("cluster")===0){if(!Yr(W,["zoom","feature-state"]))return[new Be(M.key,M.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(M.expressionContext==="cluster-initial"&&!Lr(W))return[new Be(M.key,M.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Yn(M){var O=M.key,W=M.value,ie=M.valueSpec,xe=[];return Array.isArray(ie.values)?ie.values.indexOf(Ze(W))===-1&&xe.push(new Be(O,W,"expected one of ["+ie.values.join(", ")+"], "+JSON.stringify(W)+" found")):Object.keys(ie.values).indexOf(Ze(W))===-1&&xe.push(new Be(O,W,"expected one of ["+Object.keys(ie.values).join(", ")+"], "+JSON.stringify(W)+" found")),xe}function Bn(M){if(M===!0||M===!1)return!0;if(!Array.isArray(M)||M.length===0)return!1;switch(M[0]){case"has":return M.length>=2&&M[1]!=="$id"&&M[1]!=="$type";case"in":return M.length>=3&&(typeof M[1]!="string"||Array.isArray(M[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return M.length!==3||Array.isArray(M[1])||Array.isArray(M[2]);case"any":case"all":for(var O=0,W=M.slice(1);O<W.length;O+=1){var ie=W[O];if(!Bn(ie)&&typeof ie!="boolean")return!1}return!0;default:return!0}}Sr.deserialize=function(M){return new Sr(M._parameters,M._specification)},Sr.serialize=function(M){return{_parameters:M._parameters,_specification:M._specification}};var vi={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Si(M){if(M==null)return{filter:function(){return!0},needGeometry:!1};Bn(M)||(M=ji(M));var O=Xt(M,vi);if(O.result==="error")throw new Error(O.value.map(function(W){return W.key+": "+W.message}).join(", "));return{filter:function(W,ie,xe){return O.value.evaluate(W,ie,{},xe)},needGeometry:function W(ie){if(!Array.isArray(ie))return!1;if(ie[0]==="within")return!0;for(var xe=1;xe<ie.length;xe++)if(W(ie[xe]))return!0;return!1}(M)}}function Ui(M,O){return M<O?-1:M>O?1:0}function ji(M){if(!M)return!0;var O,W=M[0];return M.length<=1?W!=="any":W==="=="?Vi(M[1],M[2],"=="):W==="!="?ca(Vi(M[1],M[2],"==")):W==="<"||W===">"||W==="<="||W===">="?Vi(M[1],M[2],W):W==="any"?(O=M.slice(1),["any"].concat(O.map(ji))):W==="all"?["all"].concat(M.slice(1).map(ji)):W==="none"?["all"].concat(M.slice(1).map(ji).map(ca)):W==="in"?Ea(M[1],M.slice(2)):W==="!in"?ca(Ea(M[1],M.slice(2))):W==="has"?ka(M[1]):W==="!has"?ca(ka(M[1])):W!=="within"||M}function Vi(M,O,W){switch(M){case"$type":return["filter-type-"+W,O];case"$id":return["filter-id-"+W,O];default:return["filter-"+W,M,O]}}function Ea(M,O){if(O.length===0)return!1;switch(M){case"$type":return["filter-type-in",["literal",O]];case"$id":return["filter-id-in",["literal",O]];default:return O.length>200&&!O.some(function(W){return typeof W!=typeof O[0]})?["filter-in-large",M,["literal",O.sort(Ui)]]:["filter-in-small",M,["literal",O]]}}function ka(M){switch(M){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",M]}}function ca(M){return["!",M]}function ua(M){return Bn(ct(M.value))?Fn(Je({},M,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function O(W){var ie=W.value,xe=W.key;if(Gi(ie)!=="array")return[new Be(xe,ie,"array expected, "+Gi(ie)+" found")];var ke,Pe=W.styleSpec,je=[];if(ie.length<1)return[new Be(xe,ie,"filter array must have at least 1 element")];switch(je=je.concat(Yn({key:xe+"[0]",value:ie[0],valueSpec:Pe.filter_operator,style:W.style,styleSpec:W.styleSpec})),Ze(ie[0])){case"<":case"<=":case">":case">=":ie.length>=2&&Ze(ie[1])==="$type"&&je.push(new Be(xe,ie,'"$type" cannot be use with operator "'+ie[0]+'"'));case"==":case"!=":ie.length!==3&&je.push(new Be(xe,ie,'filter array for operator "'+ie[0]+'" must have 3 elements'));case"in":case"!in":ie.length>=2&&(ke=Gi(ie[1]))!=="string"&&je.push(new Be(xe+"[1]",ie[1],"string expected, "+ke+" found"));for(var tt=2;tt<ie.length;tt++)ke=Gi(ie[tt]),Ze(ie[1])==="$type"?je=je.concat(Yn({key:xe+"["+tt+"]",value:ie[tt],valueSpec:Pe.geometry_type,style:W.style,styleSpec:W.styleSpec})):ke!=="string"&&ke!=="number"&&ke!=="boolean"&&je.push(new Be(xe+"["+tt+"]",ie[tt],"string, number, or boolean expected, "+ke+" found"));break;case"any":case"all":case"none":for(var ft=1;ft<ie.length;ft++)je=je.concat(O({key:xe+"["+ft+"]",value:ie[ft],style:W.style,styleSpec:W.styleSpec}));break;case"has":case"!has":ke=Gi(ie[1]),ie.length!==2?je.push(new Be(xe,ie,'filter array for "'+ie[0]+'" operator must have 2 elements')):ke!=="string"&&je.push(new Be(xe+"[1]",ie[1],"string expected, "+ke+" found"));break;case"within":ke=Gi(ie[1]),ie.length!==2?je.push(new Be(xe,ie,'filter array for "'+ie[0]+'" operator must have 2 elements')):ke!=="object"&&je.push(new Be(xe+"[1]",ie[1],"object expected, "+ke+" found"))}return je}(M)}function Ma(M,O){var W=M.key,ie=M.style,xe=M.styleSpec,ke=M.value,Pe=M.objectKey,je=xe[O+"_"+M.layerType];if(!je)return[];var tt=Pe.match(/^(.*)-transition$/);if(O==="paint"&&tt&&je[tt[1]]&&je[tt[1]].transition)return hr({key:W,value:ke,valueSpec:xe.transition,style:ie,styleSpec:xe});var ft,bt=M.valueSpec||je[Pe];if(!bt)return[new Be(W,ke,'unknown property "'+Pe+'"')];if(Gi(ke)==="string"&&$o(bt)&&!bt.tokens&&(ft=/^{([^}]+)}$/.exec(ke)))return[new Be(W,ke,'"'+Pe+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(ft[1])+" }`.")];var Nt=[];return M.layerType==="symbol"&&(Pe==="text-field"&&ie&&!ie.glyphs&&Nt.push(new Be(W,ke,'use of "text-field" requires a style "glyphs" property')),Pe==="text-font"&&Ue(ct(ke))&&Ze(ke.type)==="identity"&&Nt.push(new Be(W,ke,'"text-font" does not support identity functions'))),Nt.concat(hr({key:M.key,value:ke,valueSpec:bt,style:ie,styleSpec:xe,expressionContext:"property",propertyType:O,propertyKey:Pe}))}function Ga(M){return Ma(M,"paint")}function ao(M){return Ma(M,"layout")}function oo(M){var O=[],W=M.value,ie=M.key,xe=M.style,ke=M.styleSpec;W.type||W.ref||O.push(new Be(ie,W,'either "type" or "ref" is required'));var Pe,je=Ze(W.type),tt=Ze(W.ref);if(W.id)for(var ft=Ze(W.id),bt=0;bt<M.arrayIndex;bt++){var Nt=xe.layers[bt];Ze(Nt.id)===ft&&O.push(new Be(ie,W.id,'duplicate layer id "'+W.id+'", previously used at line '+Nt.id.__line__))}if("ref"in W)["type","source","source-layer","filter","layout"].forEach(function(fr){fr in W&&O.push(new Be(ie,W[fr],'"'+fr+'" is prohibited for ref layers'))}),xe.layers.forEach(function(fr){Ze(fr.id)===tt&&(Pe=fr)}),Pe?Pe.ref?O.push(new Be(ie,W.ref,"ref cannot reference another ref layer")):je=Ze(Pe.type):O.push(new Be(ie,W.ref,'ref layer "'+tt+'" not found'));else if(je!=="background")if(W.source){var Kt=xe.sources&&xe.sources[W.source],Wt=Kt&&Ze(Kt.type);Kt?Wt==="vector"&&je==="raster"?O.push(new Be(ie,W.source,'layer "'+W.id+'" requires a raster source')):Wt==="raster"&&je!=="raster"?O.push(new Be(ie,W.source,'layer "'+W.id+'" requires a vector source')):Wt!=="vector"||W["source-layer"]?Wt==="raster-dem"&&je!=="hillshade"?O.push(new Be(ie,W.source,"raster-dem source can only be used with layer type 'hillshade'.")):je!=="line"||!W.paint||!W.paint["line-gradient"]||Wt==="geojson"&&Kt.lineMetrics||O.push(new Be(ie,W,'layer "'+W.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):O.push(new Be(ie,W,'layer "'+W.id+'" must specify a "source-layer"')):O.push(new Be(ie,W.source,'source "'+W.source+'" not found'))}else O.push(new Be(ie,W,'missing required property "source"'));return O=O.concat(Ur({key:ie,value:W,valueSpec:ke.layer,style:M.style,styleSpec:M.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return hr({key:ie+".type",value:W.type,valueSpec:ke.layer.type,style:M.style,styleSpec:M.styleSpec,object:W,objectKey:"type"})},filter:ua,layout:function(fr){return Ur({layer:W,key:fr.key,value:fr.value,style:fr.style,styleSpec:fr.styleSpec,objectElementValidators:{"*":function(Tr){return ao(Je({layerType:je},Tr))}}})},paint:function(fr){return Ur({layer:W,key:fr.key,value:fr.value,style:fr.style,styleSpec:fr.styleSpec,objectElementValidators:{"*":function(Tr){return Ga(Je({layerType:je},Tr))}}})}}}))}function so(M){var O=M.value,W=M.key,ie=Gi(O);return ie!=="string"?[new Be(W,O,"string expected, "+ie+" found")]:[]}var lo={promoteId:function(M){var O=M.key,W=M.value;if(Gi(W)==="string")return so({key:O,value:W});var ie=[];for(var xe in W)ie.push.apply(ie,so({key:O+"."+xe,value:W[xe]}));return ie}};function zi(M){var O=M.value,W=M.key,ie=M.styleSpec,xe=M.style;if(!O.type)return[new Be(W,O,'"type" is required')];var ke,Pe=Ze(O.type);switch(Pe){case"vector":case"raster":case"raster-dem":return ke=Ur({key:W,value:O,valueSpec:ie["source_"+Pe.replace("-","_")],style:M.style,styleSpec:ie,objectElementValidators:lo});case"geojson":if(ke=Ur({key:W,value:O,valueSpec:ie.source_geojson,style:xe,styleSpec:ie,objectElementValidators:lo}),O.cluster)for(var je in O.clusterProperties){var tt=O.clusterProperties[je],ft=tt[0],bt=tt[1],Nt=typeof ft=="string"?[ft,["accumulated"],["get",je]]:ft;ke.push.apply(ke,Fn({key:W+"."+je+".map",value:bt,expressionContext:"cluster-map"})),ke.push.apply(ke,Fn({key:W+"."+je+".reduce",value:Nt,expressionContext:"cluster-reduce"}))}return ke;case"video":return Ur({key:W,value:O,valueSpec:ie.source_video,style:xe,styleSpec:ie});case"image":return Ur({key:W,value:O,valueSpec:ie.source_image,style:xe,styleSpec:ie});case"canvas":return[new Be(W,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Yn({key:W+".type",value:O.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:xe,styleSpec:ie})}}function dt(M){var O=M.value,W=M.styleSpec,ie=W.light,xe=M.style,ke=[],Pe=Gi(O);if(O===void 0)return ke;if(Pe!=="object")return ke=ke.concat([new Be("light",O,"object expected, "+Pe+" found")]);for(var je in O){var tt=je.match(/^(.*)-transition$/);ke=tt&&ie[tt[1]]&&ie[tt[1]].transition?ke.concat(hr({key:je,value:O[je],valueSpec:W.transition,style:xe,styleSpec:W})):ie[je]?ke.concat(hr({key:je,value:O[je],valueSpec:ie[je],style:xe,styleSpec:W})):ke.concat([new Be(je,O[je],'unknown property "'+je+'"')])}return ke}var Ft={"*":function(){return[]},array:un,boolean:function(M){var O=M.value,W=M.key,ie=Gi(O);return ie!=="boolean"?[new Be(W,O,"boolean expected, "+ie+" found")]:[]},number:xn,color:function(M){var O=M.key,W=M.value,ie=Gi(W);return ie!=="string"?[new Be(O,W,"color expected, "+ie+" found")]:mr(W)===null?[new Be(O,W,'color expected, "'+W+'" found')]:[]},constants:He,enum:Yn,filter:ua,function:On,layer:oo,object:Ur,source:zi,light:dt,string:so,formatted:function(M){return so(M).length===0?[]:Fn(M)},resolvedImage:function(M){return so(M).length===0?[]:Fn(M)}};function hr(M){var O=M.value,W=M.valueSpec,ie=M.styleSpec;return W.expression&&Ue(Ze(O))?On(M):W.expression&&rr(ct(O))?Fn(M):W.type&&Ft[W.type]?Ft[W.type](M):Ur(Je({},M,{valueSpec:W.type?ie[W.type]:W}))}function Yt(M){var O=M.value,W=M.key,ie=so(M);return ie.length||(O.indexOf("{fontstack}")===-1&&ie.push(new Be(W,O,'"glyphs" url must include a "{fontstack}" token')),O.indexOf("{range}")===-1&&ie.push(new Be(W,O,'"glyphs" url must include a "{range}" token'))),ie}function pr(M,O){O===void 0&&(O=_e);var W=[];return W=W.concat(hr({key:"",value:M,valueSpec:O.$root,styleSpec:O,style:M,objectElementValidators:{glyphs:Yt,"*":function(){return[]}}})),M.constants&&(W=W.concat(He({key:"constants",value:M.constants,style:M,styleSpec:O}))),Nr(W)}function Nr(M){return[].concat(M).sort(function(O,W){return O.line-W.line})}function qr(M){return function(){for(var O=[],W=arguments.length;W--;)O[W]=arguments[W];return Nr(M.apply(this,O))}}pr.source=qr(zi),pr.light=qr(dt),pr.layer=qr(oo),pr.filter=qr(ua),pr.paintProperty=qr(Ga),pr.layoutProperty=qr(ao);var $r=pr,dn=$r.light,fn=$r.paintProperty,_n=$r.layoutProperty;function Sn(M,O){var W=!1;if(O&&O.length)for(var ie=0,xe=O;ie<xe.length;ie+=1){var ke=xe[ie];M.fire(new Ye(new Error(ke.message))),W=!0}return W}var mn=En;function En(M,O,W){var ie=this.cells=[];if(M instanceof ArrayBuffer){this.arrayBuffer=M;var xe=new Int32Array(this.arrayBuffer);M=xe[0],O=xe[1],W=xe[2],this.d=O+2*W;for(var ke=0;ke<this.d*this.d;ke++){var Pe=xe[3+ke],je=xe[3+ke+1];ie.push(Pe===je?null:xe.subarray(Pe,je))}var tt=xe[3+ie.length],ft=xe[3+ie.length+1];this.keys=xe.subarray(tt,ft),this.bboxes=xe.subarray(ft),this.insert=this._insertReadonly}else{this.d=O+2*W;for(var bt=0;bt<this.d*this.d;bt++)ie.push([]);this.keys=[],this.bboxes=[]}this.n=O,this.extent=M,this.padding=W,this.scale=O/M,this.uid=0;var Nt=W/O*M;this.min=-Nt,this.max=M+Nt}En.prototype.insert=function(M,O,W,ie,xe){this._forEachCell(O,W,ie,xe,this._insertCell,this.uid++),this.keys.push(M),this.bboxes.push(O),this.bboxes.push(W),this.bboxes.push(ie),this.bboxes.push(xe)},En.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},En.prototype._insertCell=function(M,O,W,ie,xe,ke){this.cells[xe].push(ke)},En.prototype.query=function(M,O,W,ie,xe){var ke=this.min,Pe=this.max;if(M<=ke&&O<=ke&&Pe<=W&&Pe<=ie&&!xe)return Array.prototype.slice.call(this.keys);var je=[];return this._forEachCell(M,O,W,ie,this._queryCell,je,{},xe),je},En.prototype._queryCell=function(M,O,W,ie,xe,ke,Pe,je){var tt=this.cells[xe];if(tt!==null)for(var ft=this.keys,bt=this.bboxes,Nt=0;Nt<tt.length;Nt++){var Kt=tt[Nt];if(Pe[Kt]===void 0){var Wt=4*Kt;(je?je(bt[Wt+0],bt[Wt+1],bt[Wt+2],bt[Wt+3]):M<=bt[Wt+2]&&O<=bt[Wt+3]&&W>=bt[Wt+0]&&ie>=bt[Wt+1])?(Pe[Kt]=!0,ke.push(ft[Kt])):Pe[Kt]=!1}}},En.prototype._forEachCell=function(M,O,W,ie,xe,ke,Pe,je){for(var tt=this._convertToCellCoord(M),ft=this._convertToCellCoord(O),bt=this._convertToCellCoord(W),Nt=this._convertToCellCoord(ie),Kt=tt;Kt<=bt;Kt++)for(var Wt=ft;Wt<=Nt;Wt++){var fr=this.d*Wt+Kt;if((!je||je(this._convertFromCellCoord(Kt),this._convertFromCellCoord(Wt),this._convertFromCellCoord(Kt+1),this._convertFromCellCoord(Wt+1)))&&xe.call(this,M,O,W,ie,fr,ke,Pe,je))return}},En.prototype._convertFromCellCoord=function(M){return(M-this.padding)/this.scale},En.prototype._convertToCellCoord=function(M){return Math.max(0,Math.min(this.d-1,Math.floor(M*this.scale)+this.padding))},En.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var M=this.cells,O=3+this.cells.length+1+1,W=0,ie=0;ie<this.cells.length;ie++)W+=this.cells[ie].length;var xe=new Int32Array(O+W+this.keys.length+this.bboxes.length);xe[0]=this.extent,xe[1]=this.n,xe[2]=this.padding;for(var ke=O,Pe=0;Pe<M.length;Pe++){var je=M[Pe];xe[3+Pe]=ke,xe.set(je,ke),ke+=je.length}return xe[3+M.length]=ke,xe.set(this.keys,ke),ke+=this.keys.length,xe[3+M.length+1]=ke,xe.set(this.bboxes,ke),ke+=this.bboxes.length,xe.buffer};var Nn=self.ImageData,Gn=self.ImageBitmap,si={};function Qr(M,O,W){W===void 0&&(W={}),Object.defineProperty(O,"_classRegistryKey",{value:M,writeable:!1}),si[M]={klass:O,omit:W.omit||[],shallow:W.shallow||[]}}for(var ii in Qr("Object",Object),mn.serialize=function(M,O){var W=M.toArrayBuffer();return O&&O.push(W),{buffer:W}},mn.deserialize=function(M){return new mn(M.buffer)},Qr("Grid",mn),Qr("Color",tr),Qr("Error",Error),Qr("ResolvedImage",_r),Qr("StylePropertyFunction",Sr),Qr("StyleExpression",er,{omit:["_evaluator"]}),Qr("ZoomDependentExpression",yr),Qr("ZoomConstantExpression",ur),Qr("CompoundExpression",nn,{omit:["_evaluate"]}),Xo)Xo[ii]._classRegistryKey||Qr("Expression_"+ii,Xo[ii]);function Dn(M){return M&&typeof ArrayBuffer<"u"&&(M instanceof ArrayBuffer||M.constructor&&M.constructor.name==="ArrayBuffer")}function Vn(M){return Gn&&M instanceof Gn}function ni(M,O){if(M==null||typeof M=="boolean"||typeof M=="number"||typeof M=="string"||M instanceof Boolean||M instanceof Number||M instanceof String||M instanceof Date||M instanceof RegExp)return M;if(Dn(M)||Vn(M))return O&&O.push(M),M;if(ArrayBuffer.isView(M)){var W=M;return O&&O.push(W.buffer),W}if(M instanceof Nn)return O&&O.push(M.data.buffer),M;if(Array.isArray(M)){for(var ie=[],xe=0,ke=M;xe<ke.length;xe+=1){var Pe=ke[xe];ie.push(ni(Pe,O))}return ie}if(typeof M=="object"){var je=M.constructor,tt=je._classRegistryKey;if(!tt)throw new Error("can't serialize object of unregistered class");var ft=je.serialize?je.serialize(M,O):{};if(!je.serialize){for(var bt in M)if(M.hasOwnProperty(bt)&&!(si[tt].omit.indexOf(bt)>=0)){var Nt=M[bt];ft[bt]=si[tt].shallow.indexOf(bt)>=0?Nt:ni(Nt,O)}M instanceof Error&&(ft.message=M.message)}if(ft.$name)throw new Error("$name property is reserved for worker serialization logic.");return tt!=="Object"&&(ft.$name=tt),ft}throw new Error("can't serialize object of type "+typeof M)}function ki(M){if(M==null||typeof M=="boolean"||typeof M=="number"||typeof M=="string"||M instanceof Boolean||M instanceof Number||M instanceof String||M instanceof Date||M instanceof RegExp||Dn(M)||Vn(M)||ArrayBuffer.isView(M)||M instanceof Nn)return M;if(Array.isArray(M))return M.map(ki);if(typeof M=="object"){var O=M.$name||"Object",W=si[O].klass;if(!W)throw new Error("can't deserialize unregistered class "+O);if(W.deserialize)return W.deserialize(M);for(var ie=Object.create(W.prototype),xe=0,ke=Object.keys(M);xe<ke.length;xe+=1){var Pe=ke[xe];if(Pe!=="$name"){var je=M[Pe];ie[Pe]=si[O].shallow.indexOf(Pe)>=0?je:ki(je)}}return ie}throw new Error("can't deserialize object of type "+typeof M)}var Pi=function(){this.first=!0};Pi.prototype.update=function(M,O){var W=Math.floor(M);return this.first?(this.first=!1,this.lastIntegerZoom=W,this.lastIntegerZoomTime=0,this.lastZoom=M,this.lastFloorZoom=W,!0):(this.lastFloorZoom>W?(this.lastIntegerZoom=W+1,this.lastIntegerZoomTime=O):this.lastFloorZoom<W&&(this.lastIntegerZoom=W,this.lastIntegerZoomTime=O),M!==this.lastZoom&&(this.lastZoom=M,this.lastFloorZoom=W,!0))};var In={"Latin-1 Supplement":function(M){return M>=128&&M<=255},Arabic:function(M){return M>=1536&&M<=1791},"Arabic Supplement":function(M){return M>=1872&&M<=1919},"Arabic Extended-A":function(M){return M>=2208&&M<=2303},"Hangul Jamo":function(M){return M>=4352&&M<=4607},"Unified Canadian Aboriginal Syllabics":function(M){return M>=5120&&M<=5759},Khmer:function(M){return M>=6016&&M<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(M){return M>=6320&&M<=6399},"General Punctuation":function(M){return M>=8192&&M<=8303},"Letterlike Symbols":function(M){return M>=8448&&M<=8527},"Number Forms":function(M){return M>=8528&&M<=8591},"Miscellaneous Technical":function(M){return M>=8960&&M<=9215},"Control Pictures":function(M){return M>=9216&&M<=9279},"Optical Character Recognition":function(M){return M>=9280&&M<=9311},"Enclosed Alphanumerics":function(M){return M>=9312&&M<=9471},"Geometric Shapes":function(M){return M>=9632&&M<=9727},"Miscellaneous Symbols":function(M){return M>=9728&&M<=9983},"Miscellaneous Symbols and Arrows":function(M){return M>=11008&&M<=11263},"CJK Radicals Supplement":function(M){return M>=11904&&M<=12031},"Kangxi Radicals":function(M){return M>=12032&&M<=12255},"Ideographic Description Characters":function(M){return M>=12272&&M<=12287},"CJK Symbols and Punctuation":function(M){return M>=12288&&M<=12351},Hiragana:function(M){return M>=12352&&M<=12447},Katakana:function(M){return M>=12448&&M<=12543},Bopomofo:function(M){return M>=12544&&M<=12591},"Hangul Compatibility Jamo":function(M){return M>=12592&&M<=12687},Kanbun:function(M){return M>=12688&&M<=12703},"Bopomofo Extended":function(M){return M>=12704&&M<=12735},"CJK Strokes":function(M){return M>=12736&&M<=12783},"Katakana Phonetic Extensions":function(M){return M>=12784&&M<=12799},"Enclosed CJK Letters and Months":function(M){return M>=12800&&M<=13055},"CJK Compatibility":function(M){return M>=13056&&M<=13311},"CJK Unified Ideographs Extension A":function(M){return M>=13312&&M<=19903},"Yijing Hexagram Symbols":function(M){return M>=19904&&M<=19967},"CJK Unified Ideographs":function(M){return M>=19968&&M<=40959},"Yi Syllables":function(M){return M>=40960&&M<=42127},"Yi Radicals":function(M){return M>=42128&&M<=42191},"Hangul Jamo Extended-A":function(M){return M>=43360&&M<=43391},"Hangul Syllables":function(M){return M>=44032&&M<=55215},"Hangul Jamo Extended-B":function(M){return M>=55216&&M<=55295},"Private Use Area":function(M){return M>=57344&&M<=63743},"CJK Compatibility Ideographs":function(M){return M>=63744&&M<=64255},"Arabic Presentation Forms-A":function(M){return M>=64336&&M<=65023},"Vertical Forms":function(M){return M>=65040&&M<=65055},"CJK Compatibility Forms":function(M){return M>=65072&&M<=65103},"Small Form Variants":function(M){return M>=65104&&M<=65135},"Arabic Presentation Forms-B":function(M){return M>=65136&&M<=65279},"Halfwidth and Fullwidth Forms":function(M){return M>=65280&&M<=65519}};function Ri(M){for(var O=0,W=M;O<W.length;O+=1)if(gi(W[O].charCodeAt(0)))return!0;return!1}function Ci(M){return!In.Arabic(M)&&!In["Arabic Supplement"](M)&&!In["Arabic Extended-A"](M)&&!In["Arabic Presentation Forms-A"](M)&&!In["Arabic Presentation Forms-B"](M)}function gi(M){return M===746||M===747||!(M<4352)&&(!!In["Bopomofo Extended"](M)||!!In.Bopomofo(M)||!(!In["CJK Compatibility Forms"](M)||M>=65097&&M<=65103)||!!In["CJK Compatibility Ideographs"](M)||!!In["CJK Compatibility"](M)||!!In["CJK Radicals Supplement"](M)||!!In["CJK Strokes"](M)||!(!In["CJK Symbols and Punctuation"](M)||M>=12296&&M<=12305||M>=12308&&M<=12319||M===12336)||!!In["CJK Unified Ideographs Extension A"](M)||!!In["CJK Unified Ideographs"](M)||!!In["Enclosed CJK Letters and Months"](M)||!!In["Hangul Compatibility Jamo"](M)||!!In["Hangul Jamo Extended-A"](M)||!!In["Hangul Jamo Extended-B"](M)||!!In["Hangul Jamo"](M)||!!In["Hangul Syllables"](M)||!!In.Hiragana(M)||!!In["Ideographic Description Characters"](M)||!!In.Kanbun(M)||!!In["Kangxi Radicals"](M)||!!In["Katakana Phonetic Extensions"](M)||!(!In.Katakana(M)||M===12540)||!(!In["Halfwidth and Fullwidth Forms"](M)||M===65288||M===65289||M===65293||M>=65306&&M<=65310||M===65339||M===65341||M===65343||M>=65371&&M<=65503||M===65507||M>=65512&&M<=65519)||!(!In["Small Form Variants"](M)||M>=65112&&M<=65118||M>=65123&&M<=65126)||!!In["Unified Canadian Aboriginal Syllabics"](M)||!!In["Unified Canadian Aboriginal Syllabics Extended"](M)||!!In["Vertical Forms"](M)||!!In["Yijing Hexagram Symbols"](M)||!!In["Yi Syllables"](M)||!!In["Yi Radicals"](M))}function Fi(M){return!(gi(M)||function(O){return!(!In["Latin-1 Supplement"](O)||O!==167&&O!==169&&O!==174&&O!==177&&O!==188&&O!==189&&O!==190&&O!==215&&O!==247)||!(!In["General Punctuation"](O)||O!==8214&&O!==8224&&O!==8225&&O!==8240&&O!==8241&&O!==8251&&O!==8252&&O!==8258&&O!==8263&&O!==8264&&O!==8265&&O!==8273)||!!In["Letterlike Symbols"](O)||!!In["Number Forms"](O)||!(!In["Miscellaneous Technical"](O)||!(O>=8960&&O<=8967||O>=8972&&O<=8991||O>=8996&&O<=9e3||O===9003||O>=9085&&O<=9114||O>=9150&&O<=9165||O===9167||O>=9169&&O<=9179||O>=9186&&O<=9215))||!(!In["Control Pictures"](O)||O===9251)||!!In["Optical Character Recognition"](O)||!!In["Enclosed Alphanumerics"](O)||!!In["Geometric Shapes"](O)||!(!In["Miscellaneous Symbols"](O)||O>=9754&&O<=9759)||!(!In["Miscellaneous Symbols and Arrows"](O)||!(O>=11026&&O<=11055||O>=11088&&O<=11097||O>=11192&&O<=11243))||!!In["CJK Symbols and Punctuation"](O)||!!In.Katakana(O)||!!In["Private Use Area"](O)||!!In["CJK Compatibility Forms"](O)||!!In["Small Form Variants"](O)||!!In["Halfwidth and Fullwidth Forms"](O)||O===8734||O===8756||O===8757||O>=9984&&O<=10087||O>=10102&&O<=10131||O===65532||O===65533}(M))}function Ei(M){return M>=1424&&M<=2303||In["Arabic Presentation Forms-A"](M)||In["Arabic Presentation Forms-B"](M)}function na(M,O){return!(!O&&Ei(M))&&!(M>=2304&&M<=3583||M>=3840&&M<=4255||In.Khmer(M))}function ai(M){for(var O=0,W=M;O<W.length;O+=1)if(Ei(W[O].charCodeAt(0)))return!0;return!1}var Ki="deferred",Ya="loading",is="loaded",Ho="error",Mo=null,xi="unavailable",xa=null,Ao=function(M){M&&typeof M=="string"&&M.indexOf("NetworkError")>-1&&(xi=Ho),Mo&&Mo(M)};function Ji(){La.fire(new Ne("pluginStateChange",{pluginStatus:xi,pluginURL:xa}))}var La=new pe,$a=function(){return xi},aa=function(){if(xi!==Ki||!xa)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");xi=Ya,Ji(),xa&&vt({url:xa},function(M){M?Ao(M):(xi=is,Ji())})},bo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return xi===is||bo.applyArabicShaping!=null},isLoading:function(){return xi===Ya},setState:function(M){xi=M.pluginStatus,xa=M.pluginURL},isParsed:function(){return bo.applyArabicShaping!=null&&bo.processBidirectionalText!=null&&bo.processStyledBidirectionalText!=null},getPluginURL:function(){return xa}},oa=function(M,O){this.zoom=M,O?(this.now=O.now,this.fadeDuration=O.fadeDuration,this.zoomHistory=O.zoomHistory,this.transition=O.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Pi,this.transition={})};oa.prototype.isSupportedScript=function(M){return function(O,W){for(var ie=0,xe=O;ie<xe.length;ie+=1)if(!na(xe[ie].charCodeAt(0),W))return!1;return!0}(M,bo.isLoaded())},oa.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},oa.prototype.getCrossfadeParameters=function(){var M=this.zoom,O=M-Math.floor(M),W=this.crossFadingFactor();return M>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:O+(1-O)*W}:{fromScale:.5,toScale:1,t:1-(1-W)*O}};var co=function(M,O){this.property=M,this.value=O,this.expression=function(W,ie){if(Ue(W))return new Sr(W,ie);if(rr(W)){var xe=kr(W,ie);if(xe.result==="error")throw new Error(xe.value.map(function(Pe){return Pe.key+": "+Pe.message}).join(", "));return xe.value}var ke=W;return typeof W=="string"&&ie.type==="color"&&(ke=tr.parse(W)),{kind:"constant",evaluate:function(){return ke}}}(O===void 0?M.specification.default:O,M.specification)};co.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},co.prototype.possiblyEvaluate=function(M,O,W){return this.property.possiblyEvaluate(this,M,O,W)};var bs=function(M){this.property=M,this.value=new co(M,void 0)};bs.prototype.transitioned=function(M,O){return new ol(this.property,this.value,O,s({},M.transition,this.transition),M.now)},bs.prototype.untransitioned=function(){return new ol(this.property,this.value,null,{},0)};var ps=function(M){this._properties=M,this._values=Object.create(M.defaultTransitionablePropertyValues)};ps.prototype.getValue=function(M){return k(this._values[M].value.value)},ps.prototype.setValue=function(M,O){this._values.hasOwnProperty(M)||(this._values[M]=new bs(this._values[M].property)),this._values[M].value=new co(this._values[M].property,O===null?void 0:k(O))},ps.prototype.getTransition=function(M){return k(this._values[M].transition)},ps.prototype.setTransition=function(M,O){this._values.hasOwnProperty(M)||(this._values[M]=new bs(this._values[M].property)),this._values[M].transition=k(O)||void 0},ps.prototype.serialize=function(){for(var M={},O=0,W=Object.keys(this._values);O<W.length;O+=1){var ie=W[O],xe=this.getValue(ie);xe!==void 0&&(M[ie]=xe);var ke=this.getTransition(ie);ke!==void 0&&(M[ie+"-transition"]=ke)}return M},ps.prototype.transitioned=function(M,O){for(var W=new Ua(this._properties),ie=0,xe=Object.keys(this._values);ie<xe.length;ie+=1){var ke=xe[ie];W._values[ke]=this._values[ke].transitioned(M,O._values[ke])}return W},ps.prototype.untransitioned=function(){for(var M=new Ua(this._properties),O=0,W=Object.keys(this._values);O<W.length;O+=1){var ie=W[O];M._values[ie]=this._values[ie].untransitioned()}return M};var ol=function(M,O,W,ie,xe){this.property=M,this.value=O,this.begin=xe+ie.delay||0,this.end=this.begin+ie.duration||0,M.specification.transition&&(ie.delay||ie.duration)&&(this.prior=W)};ol.prototype.possiblyEvaluate=function(M,O,W){var ie=M.now||0,xe=this.value.possiblyEvaluate(M,O,W),ke=this.prior;if(ke){if(ie>this.end)return this.prior=null,xe;if(this.value.isDataDriven())return this.prior=null,xe;if(ie<this.begin)return ke.possiblyEvaluate(M,O,W);var Pe=(ie-this.begin)/(this.end-this.begin);return this.property.interpolate(ke.possiblyEvaluate(M,O,W),xe,function(je){if(je<=0)return 0;if(je>=1)return 1;var tt=je*je,ft=tt*je;return 4*(je<.5?ft:3*(je-tt)+ft-.75)}(Pe))}return xe};var Ua=function(M){this._properties=M,this._values=Object.create(M.defaultTransitioningPropertyValues)};Ua.prototype.possiblyEvaluate=function(M,O,W){for(var ie=new ds(this._properties),xe=0,ke=Object.keys(this._values);xe<ke.length;xe+=1){var Pe=ke[xe];ie._values[Pe]=this._values[Pe].possiblyEvaluate(M,O,W)}return ie},Ua.prototype.hasTransition=function(){for(var M=0,O=Object.keys(this._values);M<O.length;M+=1){var W=O[M];if(this._values[W].prior)return!0}return!1};var sl=function(M){this._properties=M,this._values=Object.create(M.defaultPropertyValues)};sl.prototype.getValue=function(M){return k(this._values[M].value)},sl.prototype.setValue=function(M,O){this._values[M]=new co(this._values[M].property,O===null?void 0:k(O))},sl.prototype.serialize=function(){for(var M={},O=0,W=Object.keys(this._values);O<W.length;O+=1){var ie=W[O],xe=this.getValue(ie);xe!==void 0&&(M[ie]=xe)}return M},sl.prototype.possiblyEvaluate=function(M,O,W){for(var ie=new ds(this._properties),xe=0,ke=Object.keys(this._values);xe<ke.length;xe+=1){var Pe=ke[xe];ie._values[Pe]=this._values[Pe].possiblyEvaluate(M,O,W)}return ie};var Va=function(M,O,W){this.property=M,this.value=O,this.parameters=W};Va.prototype.isConstant=function(){return this.value.kind==="constant"},Va.prototype.constantOr=function(M){return this.value.kind==="constant"?this.value.value:M},Va.prototype.evaluate=function(M,O,W,ie){return this.property.evaluate(this.value,this.parameters,M,O,W,ie)};var ds=function(M){this._properties=M,this._values=Object.create(M.defaultPossiblyEvaluatedValues)};ds.prototype.get=function(M){return this._values[M]};var fi=function(M){this.specification=M};fi.prototype.possiblyEvaluate=function(M,O){return M.expression.evaluate(O)},fi.prototype.interpolate=function(M,O,W){var ie=Pn[this.specification.type];return ie?ie(M,O,W):M};var bi=function(M,O){this.specification=M,this.overrides=O};bi.prototype.possiblyEvaluate=function(M,O,W,ie){return M.expression.kind==="constant"||M.expression.kind==="camera"?new Va(this,{kind:"constant",value:M.expression.evaluate(O,null,{},W,ie)},O):new Va(this,M.expression,O)},bi.prototype.interpolate=function(M,O,W){if(M.value.kind!=="constant"||O.value.kind!=="constant")return M;if(M.value.value===void 0||O.value.value===void 0)return new Va(this,{kind:"constant",value:void 0},M.parameters);var ie=Pn[this.specification.type];return ie?new Va(this,{kind:"constant",value:ie(M.value.value,O.value.value,W)},M.parameters):M},bi.prototype.evaluate=function(M,O,W,ie,xe,ke){return M.kind==="constant"?M.value:M.evaluate(O,W,ie,xe,ke)};var ll=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.possiblyEvaluate=function(W,ie,xe,ke){if(W.value===void 0)return new Va(this,{kind:"constant",value:void 0},ie);if(W.expression.kind==="constant"){var Pe=W.expression.evaluate(ie,null,{},xe,ke),je=W.property.specification.type==="resolvedImage"&&typeof Pe!="string"?Pe.name:Pe,tt=this._calculate(je,je,je,ie);return new Va(this,{kind:"constant",value:tt},ie)}if(W.expression.kind==="camera"){var ft=this._calculate(W.expression.evaluate({zoom:ie.zoom-1}),W.expression.evaluate({zoom:ie.zoom}),W.expression.evaluate({zoom:ie.zoom+1}),ie);return new Va(this,{kind:"constant",value:ft},ie)}return new Va(this,W.expression,ie)},O.prototype.evaluate=function(W,ie,xe,ke,Pe,je){if(W.kind==="source"){var tt=W.evaluate(ie,xe,ke,Pe,je);return this._calculate(tt,tt,tt,ie)}return W.kind==="composite"?this._calculate(W.evaluate({zoom:Math.floor(ie.zoom)-1},xe,ke),W.evaluate({zoom:Math.floor(ie.zoom)},xe,ke),W.evaluate({zoom:Math.floor(ie.zoom)+1},xe,ke),ie):W.value},O.prototype._calculate=function(W,ie,xe,ke){return ke.zoom>ke.zoomHistory.lastIntegerZoom?{from:W,to:ie}:{from:xe,to:ie}},O.prototype.interpolate=function(W){return W},O}(bi),cl=function(M){this.specification=M};cl.prototype.possiblyEvaluate=function(M,O,W,ie){if(M.value!==void 0){if(M.expression.kind==="constant"){var xe=M.expression.evaluate(O,null,{},W,ie);return this._calculate(xe,xe,xe,O)}return this._calculate(M.expression.evaluate(new oa(Math.floor(O.zoom-1),O)),M.expression.evaluate(new oa(Math.floor(O.zoom),O)),M.expression.evaluate(new oa(Math.floor(O.zoom+1),O)),O)}},cl.prototype._calculate=function(M,O,W,ie){return ie.zoom>ie.zoomHistory.lastIntegerZoom?{from:M,to:O}:{from:W,to:O}},cl.prototype.interpolate=function(M){return M};var ms=function(M){this.specification=M};ms.prototype.possiblyEvaluate=function(M,O,W,ie){return!!M.expression.evaluate(O,null,{},W,ie)},ms.prototype.interpolate=function(){return!1};var No=function(M){for(var O in this.properties=M,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],M){var W=M[O];W.specification.overridable&&this.overridableProperties.push(O);var ie=this.defaultPropertyValues[O]=new co(W,void 0),xe=this.defaultTransitionablePropertyValues[O]=new bs(W);this.defaultTransitioningPropertyValues[O]=xe.untransitioned(),this.defaultPossiblyEvaluatedValues[O]=ie.possiblyEvaluate({})}};Qr("DataDrivenProperty",bi),Qr("DataConstantProperty",fi),Qr("CrossFadedDataDrivenProperty",ll),Qr("CrossFadedProperty",cl),Qr("ColorRampProperty",ms);var Qo=function(M){function O(W,ie){if(M.call(this),this.id=W.id,this.type=W.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},W.type!=="custom"&&(W=W,this.metadata=W.metadata,this.minzoom=W.minzoom,this.maxzoom=W.maxzoom,W.type!=="background"&&(this.source=W.source,this.sourceLayer=W["source-layer"],this.filter=W.filter),ie.layout&&(this._unevaluatedLayout=new sl(ie.layout)),ie.paint)){for(var xe in this._transitionablePaint=new ps(ie.paint),W.paint)this.setPaintProperty(xe,W.paint[xe],{validate:!1});for(var ke in W.layout)this.setLayoutProperty(ke,W.layout[ke],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ds(ie.paint)}}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},O.prototype.getLayoutProperty=function(W){return W==="visibility"?this.visibility:this._unevaluatedLayout.getValue(W)},O.prototype.setLayoutProperty=function(W,ie,xe){if(xe===void 0&&(xe={}),ie!=null){var ke="layers."+this.id+".layout."+W;if(this._validate(_n,ke,W,ie,xe))return}W!=="visibility"?this._unevaluatedLayout.setValue(W,ie):this.visibility=ie},O.prototype.getPaintProperty=function(W){return _(W,"-transition")?this._transitionablePaint.getTransition(W.slice(0,-11)):this._transitionablePaint.getValue(W)},O.prototype.setPaintProperty=function(W,ie,xe){if(xe===void 0&&(xe={}),ie!=null){var ke="layers."+this.id+".paint."+W;if(this._validate(fn,ke,W,ie,xe))return!1}if(_(W,"-transition"))return this._transitionablePaint.setTransition(W.slice(0,-11),ie||void 0),!1;var Pe=this._transitionablePaint._values[W],je=Pe.property.specification["property-type"]==="cross-faded-data-driven",tt=Pe.value.isDataDriven(),ft=Pe.value;this._transitionablePaint.setValue(W,ie),this._handleSpecialPaintPropertyUpdate(W);var bt=this._transitionablePaint._values[W].value;return bt.isDataDriven()||tt||je||this._handleOverridablePaintPropertyUpdate(W,ft,bt)},O.prototype._handleSpecialPaintPropertyUpdate=function(W){},O.prototype._handleOverridablePaintPropertyUpdate=function(W,ie,xe){return!1},O.prototype.isHidden=function(W){return!!(this.minzoom&&W<this.minzoom)||!!(this.maxzoom&&W>=this.maxzoom)||this.visibility==="none"},O.prototype.updateTransitions=function(W){this._transitioningPaint=this._transitionablePaint.transitioned(W,this._transitioningPaint)},O.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},O.prototype.recalculate=function(W,ie){W.getCrossfadeParameters&&(this._crossfadeParameters=W.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(W,void 0,ie)),this.paint=this._transitioningPaint.possiblyEvaluate(W,void 0,ie)},O.prototype.serialize=function(){var W={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(W.layout=W.layout||{},W.layout.visibility=this.visibility),T(W,function(ie,xe){return!(ie===void 0||xe==="layout"&&!Object.keys(ie).length||xe==="paint"&&!Object.keys(ie).length)})},O.prototype._validate=function(W,ie,xe,ke,Pe){return Pe===void 0&&(Pe={}),(!Pe||Pe.validate!==!1)&&Sn(this,W.call($r,{key:ie,layerType:this.type,objectKey:xe,value:ke,styleSpec:_e,style:{glyphs:!0,sprite:!0}}))},O.prototype.is3D=function(){return!1},O.prototype.isTileClipped=function(){return!1},O.prototype.hasOffscreenPass=function(){return!1},O.prototype.resize=function(){},O.prototype.isStateDependent=function(){for(var W in this.paint._values){var ie=this.paint.get(W);if(ie instanceof Va&&$o(ie.property.specification)&&(ie.value.kind==="source"||ie.value.kind==="composite")&&ie.value.isStateDependent)return!0}return!1},O}(pe),Dl={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},qs=function(M,O){this._structArray=M,this._pos1=O*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},$i=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function sa(M,O){O===void 0&&(O=1);var W=0,ie=0;return{members:M.map(function(xe){var ke,Pe=(ke=xe.type,Dl[ke].BYTES_PER_ELEMENT),je=W=Ls(W,Math.max(O,Pe)),tt=xe.components||1;return ie=Math.max(ie,Pe),W+=Pe*tt,{name:xe.name,type:xe.type,components:tt,offset:je}}),size:Ls(W,Math.max(ie,O)),alignment:O}}function Ls(M,O){return Math.ceil(M/O)*O}$i.serialize=function(M,O){return M._trim(),O&&(M.isTransferred=!0,O.push(M.arrayBuffer)),{length:M.length,arrayBuffer:M.arrayBuffer}},$i.deserialize=function(M){var O=Object.create(this.prototype);return O.arrayBuffer=M.arrayBuffer,O.length=M.length,O.capacity=M.arrayBuffer.byteLength/O.bytesPerElement,O._refreshViews(),O},$i.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},$i.prototype.clear=function(){this.length=0},$i.prototype.resize=function(M){this.reserve(M),this.length=M},$i.prototype.reserve=function(M){if(M>this.capacity){this.capacity=Math.max(M,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var O=this.uint8;this._refreshViews(),O&&this.uint8.set(O)}},$i.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var _s=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(W,ie){var xe=this.length;return this.resize(xe+1),this.emplace(xe,W,ie)},O.prototype.emplace=function(W,ie,xe){var ke=2*W;return this.int16[ke+0]=ie,this.int16[ke+1]=xe,W},O}($i);_s.prototype.bytesPerElement=4,Qr("StructArrayLayout2i4",_s);var Fa=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(W,ie,xe,ke){var Pe=this.length;return this.resize(Pe+1),this.emplace(Pe,W,ie,xe,ke)},O.prototype.emplace=function(W,ie,xe,ke,Pe){var je=4*W;return this.int16[je+0]=ie,this.int16[je+1]=xe,this.int16[je+2]=ke,this.int16[je+3]=Pe,W},O}($i);Fa.prototype.bytesPerElement=8,Qr("StructArrayLayout4i8",Fa);var Cs=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(W,ie,xe,ke,Pe,je){var tt=this.length;return this.resize(tt+1),this.emplace(tt,W,ie,xe,ke,Pe,je)},O.prototype.emplace=function(W,ie,xe,ke,Pe,je,tt){var ft=6*W;return this.int16[ft+0]=ie,this.int16[ft+1]=xe,this.int16[ft+2]=ke,this.int16[ft+3]=Pe,this.int16[ft+4]=je,this.int16[ft+5]=tt,W},O}($i);Cs.prototype.bytesPerElement=12,Qr("StructArrayLayout2i4i12",Cs);var Gs=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(W,ie,xe,ke,Pe,je){var tt=this.length;return this.resize(tt+1),this.emplace(tt,W,ie,xe,ke,Pe,je)},O.prototype.emplace=function(W,ie,xe,ke,Pe,je,tt){var ft=4*W,bt=8*W;return this.int16[ft+0]=ie,this.int16[ft+1]=xe,this.uint8[bt+4]=ke,this.uint8[bt+5]=Pe,this.uint8[bt+6]=je,this.uint8[bt+7]=tt,W},O}($i);Gs.prototype.bytesPerElement=8,Qr("StructArrayLayout2i4ub8",Gs);var Rs=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(W,ie,xe,ke,Pe,je,tt,ft,bt,Nt){var Kt=this.length;return this.resize(Kt+1),this.emplace(Kt,W,ie,xe,ke,Pe,je,tt,ft,bt,Nt)},O.prototype.emplace=function(W,ie,xe,ke,Pe,je,tt,ft,bt,Nt,Kt){var Wt=9*W,fr=18*W;return this.uint16[Wt+0]=ie,this.uint16[Wt+1]=xe,this.uint16[Wt+2]=ke,this.uint16[Wt+3]=Pe,this.uint16[Wt+4]=je,this.uint16[Wt+5]=tt,this.uint16[Wt+6]=ft,this.uint16[Wt+7]=bt,this.uint8[fr+16]=Nt,this.uint8[fr+17]=Kt,W},O}($i);Rs.prototype.bytesPerElement=18,Qr("StructArrayLayout8ui2ub18",Rs);var Ys=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(W,ie,xe,ke,Pe,je,tt,ft,bt,Nt,Kt,Wt){var fr=this.length;return this.resize(fr+1),this.emplace(fr,W,ie,xe,ke,Pe,je,tt,ft,bt,Nt,Kt,Wt)},O.prototype.emplace=function(W,ie,xe,ke,Pe,je,tt,ft,bt,Nt,Kt,Wt,fr){var Tr=12*W;return this.int16[Tr+0]=ie,this.int16[Tr+1]=xe,this.int16[Tr+2]=ke,this.int16[Tr+3]=Pe,this.uint16[Tr+4]=je,this.uint16[Tr+5]=tt,this.uint16[Tr+6]=ft,this.uint16[Tr+7]=bt,this.int16[Tr+8]=Nt,this.int16[Tr+9]=Kt,this.int16[Tr+10]=Wt,this.int16[Tr+11]=fr,W},O}($i);Ys.prototype.bytesPerElement=24,Qr("StructArrayLayout4i4ui4i24",Ys);var ws=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(W,ie,xe){var ke=this.length;return this.resize(ke+1),this.emplace(ke,W,ie,xe)},O.prototype.emplace=function(W,ie,xe,ke){var Pe=3*W;return this.float32[Pe+0]=ie,this.float32[Pe+1]=xe,this.float32[Pe+2]=ke,W},O}($i);ws.prototype.bytesPerElement=12,Qr("StructArrayLayout3f12",ws);var zl=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(W){var ie=this.length;return this.resize(ie+1),this.emplace(ie,W)},O.prototype.emplace=function(W,ie){var xe=1*W;return this.uint32[xe+0]=ie,W},O}($i);zl.prototype.bytesPerElement=4,Qr("StructArrayLayout1ul4",zl);var Jl=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(W,ie,xe,ke,Pe,je,tt,ft,bt){var Nt=this.length;return this.resize(Nt+1),this.emplace(Nt,W,ie,xe,ke,Pe,je,tt,ft,bt)},O.prototype.emplace=function(W,ie,xe,ke,Pe,je,tt,ft,bt,Nt){var Kt=10*W,Wt=5*W;return this.int16[Kt+0]=ie,this.int16[Kt+1]=xe,this.int16[Kt+2]=ke,this.int16[Kt+3]=Pe,this.int16[Kt+4]=je,this.int16[Kt+5]=tt,this.uint32[Wt+3]=ft,this.uint16[Kt+8]=bt,this.uint16[Kt+9]=Nt,W},O}($i);Jl.prototype.bytesPerElement=20,Qr("StructArrayLayout6i1ul2ui20",Jl);var Ps=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(W,ie,xe,ke,Pe,je){var tt=this.length;return this.resize(tt+1),this.emplace(tt,W,ie,xe,ke,Pe,je)},O.prototype.emplace=function(W,ie,xe,ke,Pe,je,tt){var ft=6*W;return this.int16[ft+0]=ie,this.int16[ft+1]=xe,this.int16[ft+2]=ke,this.int16[ft+3]=Pe,this.int16[ft+4]=je,this.int16[ft+5]=tt,W},O}($i);Ps.prototype.bytesPerElement=12,Qr("StructArrayLayout2i2i2i12",Ps);var Rl=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(W,ie,xe,ke,Pe){var je=this.length;return this.resize(je+1),this.emplace(je,W,ie,xe,ke,Pe)},O.prototype.emplace=function(W,ie,xe,ke,Pe,je){var tt=4*W,ft=8*W;return this.float32[tt+0]=ie,this.float32[tt+1]=xe,this.float32[tt+2]=ke,this.int16[ft+6]=Pe,this.int16[ft+7]=je,W},O}($i);Rl.prototype.bytesPerElement=16,Qr("StructArrayLayout2f1f2i16",Rl);var Ws=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(W,ie,xe,ke){var Pe=this.length;return this.resize(Pe+1),this.emplace(Pe,W,ie,xe,ke)},O.prototype.emplace=function(W,ie,xe,ke,Pe){var je=12*W,tt=3*W;return this.uint8[je+0]=ie,this.uint8[je+1]=xe,this.float32[tt+1]=ke,this.float32[tt+2]=Pe,W},O}($i);Ws.prototype.bytesPerElement=12,Qr("StructArrayLayout2ub2f12",Ws);var uo=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(W,ie,xe){var ke=this.length;return this.resize(ke+1),this.emplace(ke,W,ie,xe)},O.prototype.emplace=function(W,ie,xe,ke){var Pe=3*W;return this.uint16[Pe+0]=ie,this.uint16[Pe+1]=xe,this.uint16[Pe+2]=ke,W},O}($i);uo.prototype.bytesPerElement=6,Qr("StructArrayLayout3ui6",uo);var $l=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(W,ie,xe,ke,Pe,je,tt,ft,bt,Nt,Kt,Wt,fr,Tr,Br,Fr,Gr){var Wr=this.length;return this.resize(Wr+1),this.emplace(Wr,W,ie,xe,ke,Pe,je,tt,ft,bt,Nt,Kt,Wt,fr,Tr,Br,Fr,Gr)},O.prototype.emplace=function(W,ie,xe,ke,Pe,je,tt,ft,bt,Nt,Kt,Wt,fr,Tr,Br,Fr,Gr,Wr){var Jr=24*W,gn=12*W,An=48*W;return this.int16[Jr+0]=ie,this.int16[Jr+1]=xe,this.uint16[Jr+2]=ke,this.uint16[Jr+3]=Pe,this.uint32[gn+2]=je,this.uint32[gn+3]=tt,this.uint32[gn+4]=ft,this.uint16[Jr+10]=bt,this.uint16[Jr+11]=Nt,this.uint16[Jr+12]=Kt,this.float32[gn+7]=Wt,this.float32[gn+8]=fr,this.uint8[An+36]=Tr,this.uint8[An+37]=Br,this.uint8[An+38]=Fr,this.uint32[gn+10]=Gr,this.int16[Jr+22]=Wr,W},O}($i);$l.prototype.bytesPerElement=48,Qr("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",$l);var Ql=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(W,ie,xe,ke,Pe,je,tt,ft,bt,Nt,Kt,Wt,fr,Tr,Br,Fr,Gr,Wr,Jr,gn,An,Un,jn,Zn,li,ci,Qn,mi){var pi=this.length;return this.resize(pi+1),this.emplace(pi,W,ie,xe,ke,Pe,je,tt,ft,bt,Nt,Kt,Wt,fr,Tr,Br,Fr,Gr,Wr,Jr,gn,An,Un,jn,Zn,li,ci,Qn,mi)},O.prototype.emplace=function(W,ie,xe,ke,Pe,je,tt,ft,bt,Nt,Kt,Wt,fr,Tr,Br,Fr,Gr,Wr,Jr,gn,An,Un,jn,Zn,li,ci,Qn,mi,pi){var ui=34*W,Qi=17*W;return this.int16[ui+0]=ie,this.int16[ui+1]=xe,this.int16[ui+2]=ke,this.int16[ui+3]=Pe,this.int16[ui+4]=je,this.int16[ui+5]=tt,this.int16[ui+6]=ft,this.int16[ui+7]=bt,this.uint16[ui+8]=Nt,this.uint16[ui+9]=Kt,this.uint16[ui+10]=Wt,this.uint16[ui+11]=fr,this.uint16[ui+12]=Tr,this.uint16[ui+13]=Br,this.uint16[ui+14]=Fr,this.uint16[ui+15]=Gr,this.uint16[ui+16]=Wr,this.uint16[ui+17]=Jr,this.uint16[ui+18]=gn,this.uint16[ui+19]=An,this.uint16[ui+20]=Un,this.uint16[ui+21]=jn,this.uint16[ui+22]=Zn,this.uint32[Qi+12]=li,this.float32[Qi+13]=ci,this.float32[Qi+14]=Qn,this.float32[Qi+15]=mi,this.float32[Qi+16]=pi,W},O}($i);Ql.prototype.bytesPerElement=68,Qr("StructArrayLayout8i15ui1ul4f68",Ql);var ue=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(W){var ie=this.length;return this.resize(ie+1),this.emplace(ie,W)},O.prototype.emplace=function(W,ie){var xe=1*W;return this.float32[xe+0]=ie,W},O}($i);ue.prototype.bytesPerElement=4,Qr("StructArrayLayout1f4",ue);var C=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(W,ie,xe){var ke=this.length;return this.resize(ke+1),this.emplace(ke,W,ie,xe)},O.prototype.emplace=function(W,ie,xe,ke){var Pe=3*W;return this.int16[Pe+0]=ie,this.int16[Pe+1]=xe,this.int16[Pe+2]=ke,W},O}($i);C.prototype.bytesPerElement=6,Qr("StructArrayLayout3i6",C);var R=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(W,ie,xe){var ke=this.length;return this.resize(ke+1),this.emplace(ke,W,ie,xe)},O.prototype.emplace=function(W,ie,xe,ke){var Pe=2*W,je=4*W;return this.uint32[Pe+0]=ie,this.uint16[je+2]=xe,this.uint16[je+3]=ke,W},O}($i);R.prototype.bytesPerElement=8,Qr("StructArrayLayout1ul2ui8",R);var F=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(W,ie){var xe=this.length;return this.resize(xe+1),this.emplace(xe,W,ie)},O.prototype.emplace=function(W,ie,xe){var ke=2*W;return this.uint16[ke+0]=ie,this.uint16[ke+1]=xe,W},O}($i);F.prototype.bytesPerElement=4,Qr("StructArrayLayout2ui4",F);var q=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},O.prototype.emplaceBack=function(W){var ie=this.length;return this.resize(ie+1),this.emplace(ie,W)},O.prototype.emplace=function(W,ie){var xe=1*W;return this.uint16[xe+0]=ie,W},O}($i);q.prototype.bytesPerElement=2,Qr("StructArrayLayout1ui2",q);var ae=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(W,ie){var xe=this.length;return this.resize(xe+1),this.emplace(xe,W,ie)},O.prototype.emplace=function(W,ie,xe){var ke=2*W;return this.float32[ke+0]=ie,this.float32[ke+1]=xe,W},O}($i);ae.prototype.bytesPerElement=8,Qr("StructArrayLayout2f8",ae);var he=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},O.prototype.emplaceBack=function(W,ie,xe,ke){var Pe=this.length;return this.resize(Pe+1),this.emplace(Pe,W,ie,xe,ke)},O.prototype.emplace=function(W,ie,xe,ke,Pe){var je=4*W;return this.float32[je+0]=ie,this.float32[je+1]=xe,this.float32[je+2]=ke,this.float32[je+3]=Pe,W},O}($i);he.prototype.bytesPerElement=16,Qr("StructArrayLayout4f16",he);var be=function(M){function O(){M.apply(this,arguments)}M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O;var W={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return W.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},W.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},W.x1.get=function(){return this._structArray.int16[this._pos2+2]},W.y1.get=function(){return this._structArray.int16[this._pos2+3]},W.x2.get=function(){return this._structArray.int16[this._pos2+4]},W.y2.get=function(){return this._structArray.int16[this._pos2+5]},W.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},W.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},W.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},W.anchorPoint.get=function(){return new r(this.anchorPointX,this.anchorPointY)},Object.defineProperties(O.prototype,W),O}(qs);be.prototype.size=20;var Ae=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.get=function(W){return new be(this,W)},O}(Jl);Qr("CollisionBoxArray",Ae);var Ce=function(M){function O(){M.apply(this,arguments)}M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O;var W={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return W.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},W.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},W.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},W.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},W.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},W.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},W.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},W.segment.get=function(){return this._structArray.uint16[this._pos2+10]},W.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},W.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},W.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},W.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},W.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},W.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},W.placedOrientation.set=function(ie){this._structArray.uint8[this._pos1+37]=ie},W.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},W.hidden.set=function(ie){this._structArray.uint8[this._pos1+38]=ie},W.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},W.crossTileID.set=function(ie){this._structArray.uint32[this._pos4+10]=ie},W.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(O.prototype,W),O}(qs);Ce.prototype.size=48;var qe=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.get=function(W){return new Ce(this,W)},O}($l);Qr("PlacedSymbolArray",qe);var et=function(M){function O(){M.apply(this,arguments)}M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O;var W={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return W.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},W.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},W.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},W.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},W.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},W.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},W.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},W.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},W.key.get=function(){return this._structArray.uint16[this._pos2+8]},W.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},W.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},W.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},W.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},W.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},W.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},W.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},W.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},W.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},W.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},W.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},W.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},W.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},W.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},W.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},W.crossTileID.set=function(ie){this._structArray.uint32[this._pos4+12]=ie},W.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},W.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},W.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},W.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(O.prototype,W),O}(qs);et.prototype.size=68;var st=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.get=function(W){return new et(this,W)},O}(Ql);Qr("SymbolInstanceArray",st);var kt=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getoffsetX=function(W){return this.float32[1*W+0]},O}(ue);Qr("GlyphOffsetArray",kt);var Pt=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.getx=function(W){return this.int16[3*W+0]},O.prototype.gety=function(W){return this.int16[3*W+1]},O.prototype.gettileUnitDistanceFromAnchor=function(W){return this.int16[3*W+2]},O}(C);Qr("SymbolLineVertexArray",Pt);var Et=function(M){function O(){M.apply(this,arguments)}M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O;var W={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return W.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},W.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},W.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(O.prototype,W),O}(qs);Et.prototype.size=8;var Lt=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.get=function(W){return new Et(this,W)},O}(R);Qr("FeatureIndexArray",Lt);var Tt=sa([{name:"a_pos",components:2,type:"Int16"}],4).members,Bt=function(M){M===void 0&&(M=[]),this.segments=M};function zt(M,O){return 256*(M=h(Math.floor(M),0,255))+(O=h(Math.floor(O),0,255))}Bt.prototype.prepareSegment=function(M,O,W,ie){var xe=this.segments[this.segments.length-1];return M>Bt.MAX_VERTEX_ARRAY_LENGTH&&A("Max vertices per segment is "+Bt.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+M),(!xe||xe.vertexLength+M>Bt.MAX_VERTEX_ARRAY_LENGTH||xe.sortKey!==ie)&&(xe={vertexOffset:O.length,primitiveOffset:W.length,vertexLength:0,primitiveLength:0},ie!==void 0&&(xe.sortKey=ie),this.segments.push(xe)),xe},Bt.prototype.get=function(){return this.segments},Bt.prototype.destroy=function(){for(var M=0,O=this.segments;M<O.length;M+=1){var W=O[M];for(var ie in W.vaos)W.vaos[ie].destroy()}},Bt.simpleSegment=function(M,O,W,ie){return new Bt([{vertexOffset:M,primitiveOffset:O,vertexLength:W,primitiveLength:ie,vaos:{},sortKey:0}])},Bt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Qr("SegmentVector",Bt);var Ht=sa([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),lr=t(function(M){M.exports=function(O,W){var ie,xe,ke,Pe,je,tt,ft,bt;for(ie=3&O.length,xe=O.length-ie,ke=W,je=3432918353,tt=461845907,bt=0;bt<xe;)ft=255&O.charCodeAt(bt)|(255&O.charCodeAt(++bt))<<8|(255&O.charCodeAt(++bt))<<16|(255&O.charCodeAt(++bt))<<24,++bt,ke=27492+(65535&(Pe=5*(65535&(ke=(ke^=ft=(65535&(ft=(ft=(65535&ft)*je+(((ft>>>16)*je&65535)<<16)&4294967295)<<15|ft>>>17))*tt+(((ft>>>16)*tt&65535)<<16)&4294967295)<<13|ke>>>19))+((5*(ke>>>16)&65535)<<16)&4294967295))+((58964+(Pe>>>16)&65535)<<16);switch(ft=0,ie){case 3:ft^=(255&O.charCodeAt(bt+2))<<16;case 2:ft^=(255&O.charCodeAt(bt+1))<<8;case 1:ke^=ft=(65535&(ft=(ft=(65535&(ft^=255&O.charCodeAt(bt)))*je+(((ft>>>16)*je&65535)<<16)&4294967295)<<15|ft>>>17))*tt+(((ft>>>16)*tt&65535)<<16)&4294967295}return ke^=O.length,ke=2246822507*(65535&(ke^=ke>>>16))+((2246822507*(ke>>>16)&65535)<<16)&4294967295,ke=3266489909*(65535&(ke^=ke>>>13))+((3266489909*(ke>>>16)&65535)<<16)&4294967295,(ke^=ke>>>16)>>>0}}),br=t(function(M){M.exports=function(O,W){for(var ie,xe=O.length,ke=W^xe,Pe=0;xe>=4;)ie=1540483477*(65535&(ie=255&O.charCodeAt(Pe)|(255&O.charCodeAt(++Pe))<<8|(255&O.charCodeAt(++Pe))<<16|(255&O.charCodeAt(++Pe))<<24))+((1540483477*(ie>>>16)&65535)<<16),ke=1540483477*(65535&ke)+((1540483477*(ke>>>16)&65535)<<16)^(ie=1540483477*(65535&(ie^=ie>>>24))+((1540483477*(ie>>>16)&65535)<<16)),xe-=4,++Pe;switch(xe){case 3:ke^=(255&O.charCodeAt(Pe+2))<<16;case 2:ke^=(255&O.charCodeAt(Pe+1))<<8;case 1:ke=1540483477*(65535&(ke^=255&O.charCodeAt(Pe)))+((1540483477*(ke>>>16)&65535)<<16)}return ke=1540483477*(65535&(ke^=ke>>>13))+((1540483477*(ke>>>16)&65535)<<16),(ke^=ke>>>15)>>>0}}),zr=lr,Or=lr,tn=br;zr.murmur3=Or,zr.murmur2=tn;var en=function(){this.ids=[],this.positions=[],this.indexed=!1};en.prototype.add=function(M,O,W,ie){this.ids.push(hn(M)),this.positions.push(O,W,ie)},en.prototype.getPositions=function(M){for(var O=hn(M),W=0,ie=this.ids.length-1;W<ie;){var xe=W+ie>>1;this.ids[xe]>=O?ie=xe:W=xe+1}for(var ke=[];this.ids[W]===O;){var Pe=this.positions[3*W],je=this.positions[3*W+1],tt=this.positions[3*W+2];ke.push({index:Pe,start:je,end:tt}),W++}return ke},en.serialize=function(M,O){var W=new Float64Array(M.ids),ie=new Uint32Array(M.positions);return function xe(ke,Pe,je,tt){for(;je<tt;){for(var ft=ke[je+tt>>1],bt=je-1,Nt=tt+1;;){do bt++;while(ke[bt]<ft);do Nt--;while(ke[Nt]>ft);if(bt>=Nt)break;Hn(ke,bt,Nt),Hn(Pe,3*bt,3*Nt),Hn(Pe,3*bt+1,3*Nt+1),Hn(Pe,3*bt+2,3*Nt+2)}Nt-je<tt-Nt?(xe(ke,Pe,je,Nt),je=Nt+1):(xe(ke,Pe,Nt+1,tt),tt=Nt)}}(W,ie,0,W.length-1),O&&O.push(W.buffer,ie.buffer),{ids:W,positions:ie}},en.deserialize=function(M){var O=new en;return O.ids=M.ids,O.positions=M.positions,O.indexed=!0,O};var vn=Math.pow(2,53)-1;function hn(M){var O=+M;return!isNaN(O)&&O<=vn?O:zr(String(M))}function Hn(M,O,W){var ie=M[O];M[O]=M[W],M[W]=ie}Qr("FeaturePositionMap",en);var Kn=function(M,O){this.gl=M.gl,this.location=O},hi=function(M){function O(W,ie){M.call(this,W,ie),this.current=0}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.set=function(W){this.current!==W&&(this.current=W,this.gl.uniform1i(this.location,W))},O}(Kn),Kr=function(M){function O(W,ie){M.call(this,W,ie),this.current=0}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.set=function(W){this.current!==W&&(this.current=W,this.gl.uniform1f(this.location,W))},O}(Kn),Ln=function(M){function O(W,ie){M.call(this,W,ie),this.current=[0,0]}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.set=function(W){W[0]===this.current[0]&&W[1]===this.current[1]||(this.current=W,this.gl.uniform2f(this.location,W[0],W[1]))},O}(Kn),Jn=function(M){function O(W,ie){M.call(this,W,ie),this.current=[0,0,0]}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.set=function(W){W[0]===this.current[0]&&W[1]===this.current[1]&&W[2]===this.current[2]||(this.current=W,this.gl.uniform3f(this.location,W[0],W[1],W[2]))},O}(Kn),Wn=function(M){function O(W,ie){M.call(this,W,ie),this.current=[0,0,0,0]}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.set=function(W){W[0]===this.current[0]&&W[1]===this.current[1]&&W[2]===this.current[2]&&W[3]===this.current[3]||(this.current=W,this.gl.uniform4f(this.location,W[0],W[1],W[2],W[3]))},O}(Kn),oi=function(M){function O(W,ie){M.call(this,W,ie),this.current=tr.transparent}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.set=function(W){W.r===this.current.r&&W.g===this.current.g&&W.b===this.current.b&&W.a===this.current.a||(this.current=W,this.gl.uniform4f(this.location,W.r,W.g,W.b,W.a))},O}(Kn),di=new Float32Array(16),Li=function(M){function O(W,ie){M.call(this,W,ie),this.current=di}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.set=function(W){if(W[12]!==this.current[12]||W[0]!==this.current[0])return this.current=W,void this.gl.uniformMatrix4fv(this.location,!1,W);for(var ie=1;ie<16;ie++)if(W[ie]!==this.current[ie]){this.current=W,this.gl.uniformMatrix4fv(this.location,!1,W);break}},O}(Kn);function ri(M){return[zt(255*M.r,255*M.g),zt(255*M.b,255*M.a)]}var _i=function(M,O,W){this.value=M,this.uniformNames=O.map(function(ie){return"u_"+ie}),this.type=W};_i.prototype.setUniform=function(M,O,W){M.set(W.constantOr(this.value))},_i.prototype.getBinding=function(M,O,W){return this.type==="color"?new oi(M,O):new Kr(M,O)};var yi=function(M,O){this.uniformNames=O.map(function(W){return"u_"+W}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};yi.prototype.setConstantPatternPositions=function(M,O){this.pixelRatioFrom=O.pixelRatio,this.pixelRatioTo=M.pixelRatio,this.patternFrom=O.tlbr,this.patternTo=M.tlbr},yi.prototype.setUniform=function(M,O,W,ie){var xe=ie==="u_pattern_to"?this.patternTo:ie==="u_pattern_from"?this.patternFrom:ie==="u_pixel_ratio_to"?this.pixelRatioTo:ie==="u_pixel_ratio_from"?this.pixelRatioFrom:null;xe&&M.set(xe)},yi.prototype.getBinding=function(M,O,W){return W.substr(0,9)==="u_pattern"?new Wn(M,O):new Kr(M,O)};var Ii=function(M,O,W,ie){this.expression=M,this.type=W,this.maxValue=0,this.paintVertexAttributes=O.map(function(xe){return{name:"a_"+xe,type:"Float32",components:W==="color"?2:1,offset:0}}),this.paintVertexArray=new ie};Ii.prototype.populatePaintArray=function(M,O,W,ie,xe){var ke=this.paintVertexArray.length,Pe=this.expression.evaluate(new oa(0),O,{},ie,[],xe);this.paintVertexArray.resize(M),this._setPaintValue(ke,M,Pe)},Ii.prototype.updatePaintArray=function(M,O,W,ie){var xe=this.expression.evaluate({zoom:0},W,ie);this._setPaintValue(M,O,xe)},Ii.prototype._setPaintValue=function(M,O,W){if(this.type==="color")for(var ie=ri(W),xe=M;xe<O;xe++)this.paintVertexArray.emplace(xe,ie[0],ie[1]);else{for(var ke=M;ke<O;ke++)this.paintVertexArray.emplace(ke,W);this.maxValue=Math.max(this.maxValue,Math.abs(W))}},Ii.prototype.upload=function(M){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=M.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ii.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var wi=function(M,O,W,ie,xe,ke){this.expression=M,this.uniformNames=O.map(function(Pe){return"u_"+Pe+"_t"}),this.type=W,this.useIntegerZoom=ie,this.zoom=xe,this.maxValue=0,this.paintVertexAttributes=O.map(function(Pe){return{name:"a_"+Pe,type:"Float32",components:W==="color"?4:2,offset:0}}),this.paintVertexArray=new ke};wi.prototype.populatePaintArray=function(M,O,W,ie,xe){var ke=this.expression.evaluate(new oa(this.zoom),O,{},ie,[],xe),Pe=this.expression.evaluate(new oa(this.zoom+1),O,{},ie,[],xe),je=this.paintVertexArray.length;this.paintVertexArray.resize(M),this._setPaintValue(je,M,ke,Pe)},wi.prototype.updatePaintArray=function(M,O,W,ie){var xe=this.expression.evaluate({zoom:this.zoom},W,ie),ke=this.expression.evaluate({zoom:this.zoom+1},W,ie);this._setPaintValue(M,O,xe,ke)},wi.prototype._setPaintValue=function(M,O,W,ie){if(this.type==="color")for(var xe=ri(W),ke=ri(ie),Pe=M;Pe<O;Pe++)this.paintVertexArray.emplace(Pe,xe[0],xe[1],ke[0],ke[1]);else{for(var je=M;je<O;je++)this.paintVertexArray.emplace(je,W,ie);this.maxValue=Math.max(this.maxValue,Math.abs(W),Math.abs(ie))}},wi.prototype.upload=function(M){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=M.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},wi.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},wi.prototype.setUniform=function(M,O){var W=this.useIntegerZoom?Math.floor(O.zoom):O.zoom,ie=h(this.expression.interpolationFactor(W,this.zoom,this.zoom+1),0,1);M.set(ie)},wi.prototype.getBinding=function(M,O,W){return new Kr(M,O)};var Oi=function(M,O,W,ie,xe,ke){this.expression=M,this.type=O,this.useIntegerZoom=W,this.zoom=ie,this.layerId=ke,this.zoomInPaintVertexArray=new xe,this.zoomOutPaintVertexArray=new xe};Oi.prototype.populatePaintArray=function(M,O,W){var ie=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(M),this.zoomOutPaintVertexArray.resize(M),this._setPaintValues(ie,M,O.patterns&&O.patterns[this.layerId],W)},Oi.prototype.updatePaintArray=function(M,O,W,ie,xe){this._setPaintValues(M,O,W.patterns&&W.patterns[this.layerId],xe)},Oi.prototype._setPaintValues=function(M,O,W,ie){if(ie&&W){var xe=W.min,ke=W.mid,Pe=W.max,je=ie[xe],tt=ie[ke],ft=ie[Pe];if(je&&tt&&ft)for(var bt=M;bt<O;bt++)this.zoomInPaintVertexArray.emplace(bt,tt.tl[0],tt.tl[1],tt.br[0],tt.br[1],je.tl[0],je.tl[1],je.br[0],je.br[1],tt.pixelRatio,je.pixelRatio),this.zoomOutPaintVertexArray.emplace(bt,tt.tl[0],tt.tl[1],tt.br[0],tt.br[1],ft.tl[0],ft.tl[1],ft.br[0],ft.br[1],tt.pixelRatio,ft.pixelRatio)}},Oi.prototype.upload=function(M){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=M.createVertexBuffer(this.zoomInPaintVertexArray,Ht.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=M.createVertexBuffer(this.zoomOutPaintVertexArray,Ht.members,this.expression.isStateDependent))},Oi.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Hi=function(M,O,W,ie){this.binders={},this.layoutAttributes=ie,this._buffers=[];var xe=[];for(var ke in M.paint._values)if(W(ke)){var Pe=M.paint.get(ke);if(Pe instanceof Va&&$o(Pe.property.specification)){var je=Ba(ke,M.type),tt=Pe.value,ft=Pe.property.specification.type,bt=Pe.property.useIntegerZoom,Nt=Pe.property.specification["property-type"],Kt=Nt==="cross-faded"||Nt==="cross-faded-data-driven";if(tt.kind==="constant")this.binders[ke]=Kt?new yi(tt.value,je):new _i(tt.value,je,ft),xe.push("/u_"+ke);else if(tt.kind==="source"||Kt){var Wt=Na(ke,ft,"source");this.binders[ke]=Kt?new Oi(tt,ft,bt,O,Wt,M.id):new Ii(tt,je,ft,Wt),xe.push("/a_"+ke)}else{var fr=Na(ke,ft,"composite");this.binders[ke]=new wi(tt,je,ft,bt,O,fr),xe.push("/z_"+ke)}}}this.cacheKey=xe.sort().join("")};Hi.prototype.getMaxValue=function(M){var O=this.binders[M];return O instanceof Ii||O instanceof wi?O.maxValue:0},Hi.prototype.populatePaintArrays=function(M,O,W,ie,xe){for(var ke in this.binders){var Pe=this.binders[ke];(Pe instanceof Ii||Pe instanceof wi||Pe instanceof Oi)&&Pe.populatePaintArray(M,O,W,ie,xe)}},Hi.prototype.setConstantPatternPositions=function(M,O){for(var W in this.binders){var ie=this.binders[W];ie instanceof yi&&ie.setConstantPatternPositions(M,O)}},Hi.prototype.updatePaintArrays=function(M,O,W,ie,xe){var ke=!1;for(var Pe in M)for(var je=0,tt=O.getPositions(Pe);je<tt.length;je+=1){var ft=tt[je],bt=W.feature(ft.index);for(var Nt in this.binders){var Kt=this.binders[Nt];if((Kt instanceof Ii||Kt instanceof wi||Kt instanceof Oi)&&Kt.expression.isStateDependent===!0){var Wt=ie.paint.get(Nt);Kt.expression=Wt.value,Kt.updatePaintArray(ft.start,ft.end,bt,M[Pe],xe),ke=!0}}}return ke},Hi.prototype.defines=function(){var M=[];for(var O in this.binders){var W=this.binders[O];(W instanceof _i||W instanceof yi)&&M.push.apply(M,W.uniformNames.map(function(ie){return"#define HAS_UNIFORM_"+ie}))}return M},Hi.prototype.getPaintVertexBuffers=function(){return this._buffers},Hi.prototype.getUniforms=function(M,O){var W=[];for(var ie in this.binders){var xe=this.binders[ie];if(xe instanceof _i||xe instanceof yi||xe instanceof wi)for(var ke=0,Pe=xe.uniformNames;ke<Pe.length;ke+=1){var je=Pe[ke];if(O[je]){var tt=xe.getBinding(M,O[je],je);W.push({name:je,property:ie,binding:tt})}}}return W},Hi.prototype.setUniforms=function(M,O,W,ie){for(var xe=0,ke=O;xe<ke.length;xe+=1){var Pe=ke[xe],je=Pe.name,tt=Pe.property,ft=Pe.binding;this.binders[tt].setUniform(ft,ie,W.get(tt),je)}},Hi.prototype.updatePaintBuffers=function(M){for(var O in this._buffers=[],this.binders){var W=this.binders[O];if(M&&W instanceof Oi){var ie=M.fromScale===2?W.zoomInPaintVertexBuffer:W.zoomOutPaintVertexBuffer;ie&&this._buffers.push(ie)}else(W instanceof Ii||W instanceof wi)&&W.paintVertexBuffer&&this._buffers.push(W.paintVertexBuffer)}},Hi.prototype.upload=function(M){for(var O in this.binders){var W=this.binders[O];(W instanceof Ii||W instanceof wi||W instanceof Oi)&&W.upload(M)}this.updatePaintBuffers()},Hi.prototype.destroy=function(){for(var M in this.binders){var O=this.binders[M];(O instanceof Ii||O instanceof wi||O instanceof Oi)&&O.destroy()}};var da=function(M,O,W,ie){ie===void 0&&(ie=function(){return!0}),this.programConfigurations={};for(var xe=0,ke=O;xe<ke.length;xe+=1){var Pe=ke[xe];this.programConfigurations[Pe.id]=new Hi(Pe,W,ie,M)}this.needsUpload=!1,this._featureMap=new en,this._bufferOffset=0};function Ba(M,O){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[M]||[M.replace(O+"-","").replace(/-/g,"_")]}function Na(M,O,W){var ie={color:{source:ae,composite:he},number:{source:ue,composite:ae}},xe=function(ke){return{"line-pattern":{source:Rs,composite:Rs},"fill-pattern":{source:Rs,composite:Rs},"fill-extrusion-pattern":{source:Rs,composite:Rs}}[ke]}(M);return xe&&xe[W]||ie[O][W]}da.prototype.populatePaintArrays=function(M,O,W,ie,xe,ke){for(var Pe in this.programConfigurations)this.programConfigurations[Pe].populatePaintArrays(M,O,ie,xe,ke);O.id!==void 0&&this._featureMap.add(O.id,W,this._bufferOffset,M),this._bufferOffset=M,this.needsUpload=!0},da.prototype.updatePaintArrays=function(M,O,W,ie){for(var xe=0,ke=W;xe<ke.length;xe+=1){var Pe=ke[xe];this.needsUpload=this.programConfigurations[Pe.id].updatePaintArrays(M,this._featureMap,O,Pe,ie)||this.needsUpload}},da.prototype.get=function(M){return this.programConfigurations[M]},da.prototype.upload=function(M){if(this.needsUpload){for(var O in this.programConfigurations)this.programConfigurations[O].upload(M);this.needsUpload=!1}},da.prototype.destroy=function(){for(var M in this.programConfigurations)this.programConfigurations[M].destroy()},Qr("ConstantBinder",_i),Qr("CrossFadedConstantBinder",yi),Qr("SourceExpressionBinder",Ii),Qr("CrossFadedCompositeBinder",Oi),Qr("CompositeExpressionBinder",wi),Qr("ProgramConfiguration",Hi,{omit:["_buffers"]}),Qr("ProgramConfigurationSet",da);var pa,Ca=(pa=15,{min:-1*Math.pow(2,pa-1),max:Math.pow(2,pa-1)-1});function ba(M){for(var O=8192/M.extent,W=M.loadGeometry(),ie=0;ie<W.length;ie++)for(var xe=W[ie],ke=0;ke<xe.length;ke++){var Pe=xe[ke];Pe.x=Math.round(Pe.x*O),Pe.y=Math.round(Pe.y*O),(Pe.x<Ca.min||Pe.x>Ca.max||Pe.y<Ca.min||Pe.y>Ca.max)&&(A("Geometry exceeds allowed extent, reduce your vector tile buffer size"),Pe.x=h(Pe.x,Ca.min,Ca.max),Pe.y=h(Pe.y,Ca.min,Ca.max))}return W}function So(M,O,W,ie,xe){M.emplaceBack(2*O+(ie+1)/2,2*W+(xe+1)/2)}var Qa=function(M){this.zoom=M.zoom,this.overscaling=M.overscaling,this.layers=M.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=M.index,this.hasPattern=!1,this.layoutVertexArray=new _s,this.indexArray=new uo,this.segments=new Bt,this.programConfigurations=new da(Tt,M.layers,M.zoom),this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};function qo(M,O){for(var W=0;W<M.length;W++)if(gs(O,M[W]))return!0;for(var ie=0;ie<O.length;ie++)if(gs(M,O[ie]))return!0;return!!Fl(M,O)}function Fs(M,O,W){return!!gs(M,O)||!!Eo(O,M,W)}function ul(M,O){if(M.length===1)return tc(O,M[0]);for(var W=0;W<O.length;W++)for(var ie=O[W],xe=0;xe<ie.length;xe++)if(gs(M,ie[xe]))return!0;for(var ke=0;ke<M.length;ke++)if(tc(O,M[ke]))return!0;for(var Pe=0;Pe<O.length;Pe++)if(Fl(M,O[Pe]))return!0;return!1}function ec(M,O,W){if(M.length>1){if(Fl(M,O))return!0;for(var ie=0;ie<O.length;ie++)if(Eo(O[ie],M,W))return!0}for(var xe=0;xe<M.length;xe++)if(Eo(M[xe],O,W))return!0;return!1}function Fl(M,O){if(M.length===0||O.length===0)return!1;for(var W=0;W<M.length-1;W++)for(var ie=M[W],xe=M[W+1],ke=0;ke<O.length-1;ke++)if(Bl(ie,xe,O[ke],O[ke+1]))return!0;return!1}function Bl(M,O,W,ie){return I(M,W,ie)!==I(O,W,ie)&&I(M,O,W)!==I(M,O,ie)}function Eo(M,O,W){var ie=W*W;if(O.length===1)return M.distSqr(O[0])<ie;for(var xe=1;xe<O.length;xe++)if(bl(M,O[xe-1],O[xe])<ie)return!0;return!1}function bl(M,O,W){var ie=O.distSqr(W);if(ie===0)return M.distSqr(O);var xe=((M.x-O.x)*(W.x-O.x)+(M.y-O.y)*(W.y-O.y))/ie;return xe<0?M.distSqr(O):xe>1?M.distSqr(W):M.distSqr(W.sub(O)._mult(xe)._add(O))}function tc(M,O){for(var W,ie,xe,ke=!1,Pe=0;Pe<M.length;Pe++)for(var je=0,tt=(W=M[Pe]).length-1;je<W.length;tt=je++)ie=W[je],xe=W[tt],ie.y>O.y!=xe.y>O.y&&O.x<(xe.x-ie.x)*(O.y-ie.y)/(xe.y-ie.y)+ie.x&&(ke=!ke);return ke}function gs(M,O){for(var W=!1,ie=0,xe=M.length-1;ie<M.length;xe=ie++){var ke=M[ie],Pe=M[xe];ke.y>O.y!=Pe.y>O.y&&O.x<(Pe.x-ke.x)*(O.y-ke.y)/(Pe.y-ke.y)+ke.x&&(W=!W)}return W}function rc(M,O,W){var ie=W[0],xe=W[2];if(M.x<ie.x&&O.x<ie.x||M.x>xe.x&&O.x>xe.x||M.y<ie.y&&O.y<ie.y||M.y>xe.y&&O.y>xe.y)return!1;var ke=I(M,O,W[0]);return ke!==I(M,O,W[1])||ke!==I(M,O,W[2])||ke!==I(M,O,W[3])}function Pa(M,O,W){var ie=O.paint.get(M).value;return ie.kind==="constant"?ie.value:W.programConfigurations.get(O.id).getMaxValue(M)}function jo(M){return Math.sqrt(M[0]*M[0]+M[1]*M[1])}function Uo(M,O,W,ie,xe){if(!O[0]&&!O[1])return M;var ke=r.convert(O)._mult(xe);W==="viewport"&&ke._rotate(-ie);for(var Pe=[],je=0;je<M.length;je++){var tt=M[je];Pe.push(tt.sub(ke))}return Pe}Qa.prototype.populate=function(M,O,W){var ie=this.layers[0],xe=[],ke=null;ie.type==="circle"&&(ke=ie.layout.get("circle-sort-key"));for(var Pe=0,je=M;Pe<je.length;Pe+=1){var tt=je[Pe],ft=tt.feature,bt=tt.id,Nt=tt.index,Kt=tt.sourceLayerIndex,Wt=this.layers[0]._featureFilter.needGeometry,fr={type:ft.type,id:bt,properties:ft.properties,geometry:Wt?ba(ft):[]};if(this.layers[0]._featureFilter.filter(new oa(this.zoom),fr,W)){Wt||(fr.geometry=ba(ft));var Tr=ke?ke.evaluate(fr,{},W):void 0,Br={id:bt,properties:ft.properties,type:ft.type,sourceLayerIndex:Kt,index:Nt,geometry:fr.geometry,patterns:{},sortKey:Tr};xe.push(Br)}}ke&&xe.sort(function(Zn,li){return Zn.sortKey-li.sortKey});for(var Fr=0,Gr=xe;Fr<Gr.length;Fr+=1){var Wr=Gr[Fr],Jr=Wr,gn=Jr.geometry,An=Jr.index,Un=Jr.sourceLayerIndex,jn=M[An].feature;this.addFeature(Wr,gn,An,W),O.featureIndex.insert(jn,gn,An,Un,this.index)}},Qa.prototype.update=function(M,O,W){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(M,O,this.stateDependentLayers,W)},Qa.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Qa.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Qa.prototype.upload=function(M){this.uploaded||(this.layoutVertexBuffer=M.createVertexBuffer(this.layoutVertexArray,Tt),this.indexBuffer=M.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(M),this.uploaded=!0},Qa.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Qa.prototype.addFeature=function(M,O,W,ie){for(var xe=0,ke=O;xe<ke.length;xe+=1)for(var Pe=0,je=ke[xe];Pe<je.length;Pe+=1){var tt=je[Pe],ft=tt.x,bt=tt.y;if(!(ft<0||ft>=8192||bt<0||bt>=8192)){var Nt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,M.sortKey),Kt=Nt.vertexLength;So(this.layoutVertexArray,ft,bt,-1,-1),So(this.layoutVertexArray,ft,bt,1,-1),So(this.layoutVertexArray,ft,bt,1,1),So(this.layoutVertexArray,ft,bt,-1,1),this.indexArray.emplaceBack(Kt,Kt+1,Kt+2),this.indexArray.emplaceBack(Kt,Kt+3,Kt+2),Nt.vertexLength+=4,Nt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,M,W,{},ie)},Qr("CircleBucket",Qa,{omit:["layers"]});var yc=new No({"circle-sort-key":new bi(_e.layout_circle["circle-sort-key"])}),Yf={paint:new No({"circle-radius":new bi(_e.paint_circle["circle-radius"]),"circle-color":new bi(_e.paint_circle["circle-color"]),"circle-blur":new bi(_e.paint_circle["circle-blur"]),"circle-opacity":new bi(_e.paint_circle["circle-opacity"]),"circle-translate":new fi(_e.paint_circle["circle-translate"]),"circle-translate-anchor":new fi(_e.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new fi(_e.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new fi(_e.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new bi(_e.paint_circle["circle-stroke-width"]),"circle-stroke-color":new bi(_e.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new bi(_e.paint_circle["circle-stroke-opacity"])}),layout:yc},as=typeof Float32Array<"u"?Float32Array:Array;function eu(M){return M[0]=1,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=1,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=1,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,M}function nc(M,O,W){var ie=O[0],xe=O[1],ke=O[2],Pe=O[3],je=O[4],tt=O[5],ft=O[6],bt=O[7],Nt=O[8],Kt=O[9],Wt=O[10],fr=O[11],Tr=O[12],Br=O[13],Fr=O[14],Gr=O[15],Wr=W[0],Jr=W[1],gn=W[2],An=W[3];return M[0]=Wr*ie+Jr*je+gn*Nt+An*Tr,M[1]=Wr*xe+Jr*tt+gn*Kt+An*Br,M[2]=Wr*ke+Jr*ft+gn*Wt+An*Fr,M[3]=Wr*Pe+Jr*bt+gn*fr+An*Gr,Wr=W[4],Jr=W[5],gn=W[6],An=W[7],M[4]=Wr*ie+Jr*je+gn*Nt+An*Tr,M[5]=Wr*xe+Jr*tt+gn*Kt+An*Br,M[6]=Wr*ke+Jr*ft+gn*Wt+An*Fr,M[7]=Wr*Pe+Jr*bt+gn*fr+An*Gr,Wr=W[8],Jr=W[9],gn=W[10],An=W[11],M[8]=Wr*ie+Jr*je+gn*Nt+An*Tr,M[9]=Wr*xe+Jr*tt+gn*Kt+An*Br,M[10]=Wr*ke+Jr*ft+gn*Wt+An*Fr,M[11]=Wr*Pe+Jr*bt+gn*fr+An*Gr,Wr=W[12],Jr=W[13],gn=W[14],An=W[15],M[12]=Wr*ie+Jr*je+gn*Nt+An*Tr,M[13]=Wr*xe+Jr*tt+gn*Kt+An*Br,M[14]=Wr*ke+Jr*ft+gn*Wt+An*Fr,M[15]=Wr*Pe+Jr*bt+gn*fr+An*Gr,M}Math.hypot||(Math.hypot=function(){for(var M=arguments,O=0,W=arguments.length;W--;)O+=M[W]*M[W];return Math.sqrt(O)});var Wf=nc,_l,Zf=function(M,O,W){return M[0]=O[0]-W[0],M[1]=O[1]-W[1],M[2]=O[2]-W[2],M};_l=new as(3),as!=Float32Array&&(_l[0]=0,_l[1]=0,_l[2]=0);function xc(M,O,W){var ie=O[0],xe=O[1],ke=O[2],Pe=O[3];return M[0]=W[0]*ie+W[4]*xe+W[8]*ke+W[12]*Pe,M[1]=W[1]*ie+W[5]*xe+W[9]*ke+W[13]*Pe,M[2]=W[2]*ie+W[6]*xe+W[10]*ke+W[14]*Pe,M[3]=W[3]*ie+W[7]*xe+W[11]*ke+W[15]*Pe,M}(function(){(function(){var M=new as(4);return as!=Float32Array&&(M[0]=0,M[1]=0,M[2]=0,M[3]=0),M})()})();var tu=function(M){var O=M[0],W=M[1];return O*O+W*W},Tm=(function(){(function(){var M=new as(2);return as!=Float32Array&&(M[0]=0,M[1]=0),M})()}(),function(M){function O(W){M.call(this,W,Yf)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.createBucket=function(W){return new Qa(W)},O.prototype.queryRadius=function(W){var ie=W;return Pa("circle-radius",this,ie)+Pa("circle-stroke-width",this,ie)+jo(this.paint.get("circle-translate"))},O.prototype.queryIntersectsFeature=function(W,ie,xe,ke,Pe,je,tt,ft){for(var bt=Uo(W,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),je.angle,tt),Nt=this.paint.get("circle-radius").evaluate(ie,xe)+this.paint.get("circle-stroke-width").evaluate(ie,xe),Kt=this.paint.get("circle-pitch-alignment")==="map",Wt=Kt?bt:function(Un,jn){return Un.map(function(Zn){return kp(Zn,jn)})}(bt,ft),fr=Kt?Nt*tt:Nt,Tr=0,Br=ke;Tr<Br.length;Tr+=1)for(var Fr=0,Gr=Br[Tr];Fr<Gr.length;Fr+=1){var Wr=Gr[Fr],Jr=Kt?Wr:kp(Wr,ft),gn=fr,An=xc([],[Wr.x,Wr.y,0,1],ft);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?gn*=An[3]/je.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(gn*=je.cameraToCenterDistance/An[3]),Fs(Wt,Jr,gn))return!0}return!1},O}(Qo));function kp(M,O){var W=xc([],[M.x,M.y,0,1],O);return new r(W[0]/W[3],W[1]/W[3])}var Mp=function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O}(Qa);function Xf(M,O,W,ie){var xe=O.width,ke=O.height;if(ie){if(ie instanceof Uint8ClampedArray)ie=new Uint8Array(ie.buffer);else if(ie.length!==xe*ke*W)throw new RangeError("mismatched image size")}else ie=new Uint8Array(xe*ke*W);return M.width=xe,M.height=ke,M.data=ie,M}function Ap(M,O,W){var ie=O.width,xe=O.height;if(ie!==M.width||xe!==M.height){var ke=Xf({},{width:ie,height:xe},W);Kf(M,ke,{x:0,y:0},{x:0,y:0},{width:Math.min(M.width,ie),height:Math.min(M.height,xe)},W),M.width=ie,M.height=xe,M.data=ke.data}}function Kf(M,O,W,ie,xe,ke){if(xe.width===0||xe.height===0)return O;if(xe.width>M.width||xe.height>M.height||W.x>M.width-xe.width||W.y>M.height-xe.height)throw new RangeError("out of range source coordinates for image copy");if(xe.width>O.width||xe.height>O.height||ie.x>O.width-xe.width||ie.y>O.height-xe.height)throw new RangeError("out of range destination coordinates for image copy");for(var Pe=M.data,je=O.data,tt=0;tt<xe.height;tt++)for(var ft=((W.y+tt)*M.width+W.x)*ke,bt=((ie.y+tt)*O.width+ie.x)*ke,Nt=0;Nt<xe.width*ke;Nt++)je[bt+Nt]=Pe[ft+Nt];return O}Qr("HeatmapBucket",Mp,{omit:["layers"]});var ic=function(M,O){Xf(this,M,1,O)};ic.prototype.resize=function(M){Ap(this,M,1)},ic.prototype.clone=function(){return new ic({width:this.width,height:this.height},new Uint8Array(this.data))},ic.copy=function(M,O,W,ie,xe){Kf(M,O,W,ie,xe,1)};var os=function(M,O){Xf(this,M,4,O)};os.prototype.resize=function(M){Ap(this,M,4)},os.prototype.replace=function(M,O){O?this.data.set(M):M instanceof Uint8ClampedArray?this.data=new Uint8Array(M.buffer):this.data=M},os.prototype.clone=function(){return new os({width:this.width,height:this.height},new Uint8Array(this.data))},os.copy=function(M,O,W,ie,xe){Kf(M,O,W,ie,xe,4)},Qr("AlphaImage",ic),Qr("RGBAImage",os);var km={paint:new No({"heatmap-radius":new bi(_e.paint_heatmap["heatmap-radius"]),"heatmap-weight":new bi(_e.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new fi(_e.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ms(_e.paint_heatmap["heatmap-color"]),"heatmap-opacity":new fi(_e.paint_heatmap["heatmap-opacity"])})};function Sp(M,O){for(var W=new Uint8Array(1024),ie={},xe=0,ke=0;xe<256;xe++,ke+=4){ie[O]=xe/255;var Pe=M.evaluate(ie);W[ke+0]=Math.floor(255*Pe.r/Pe.a),W[ke+1]=Math.floor(255*Pe.g/Pe.a),W[ke+2]=Math.floor(255*Pe.b/Pe.a),W[ke+3]=Math.floor(255*Pe.a)}return new os({width:256,height:1},W)}var Mm=function(M){function O(W){M.call(this,W,km),this._updateColorRamp()}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.createBucket=function(W){return new Mp(W)},O.prototype._handleSpecialPaintPropertyUpdate=function(W){W==="heatmap-color"&&this._updateColorRamp()},O.prototype._updateColorRamp=function(){var W=this._transitionablePaint._values["heatmap-color"].value.expression;this.colorRamp=Sp(W,"heatmapDensity"),this.colorRampTexture=null},O.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},O.prototype.queryRadius=function(){return 0},O.prototype.queryIntersectsFeature=function(){return!1},O.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},O}(Qo),Am={paint:new No({"hillshade-illumination-direction":new fi(_e.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new fi(_e.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new fi(_e.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new fi(_e.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new fi(_e.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new fi(_e.paint_hillshade["hillshade-accent-color"])})},Sm=function(M){function O(W){M.call(this,W,Am)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},O}(Qo),Ep=sa([{name:"a_pos",components:2,type:"Int16"}],4).members,Jf=Ou,Em=Ou;function Ou(M,O,W){W=W||2;var ie,xe,ke,Pe,je,tt,ft,bt=O&&O.length,Nt=bt?O[0]*W:M.length,Kt=Lp(M,0,Nt,W,!0),Wt=[];if(!Kt||Kt.next===Kt.prev)return Wt;if(bt&&(Kt=function(Tr,Br,Fr,Gr){var Wr,Jr,gn,An,Un,jn=[];for(Wr=0,Jr=Br.length;Wr<Jr;Wr++)gn=Br[Wr]*Gr,An=Wr<Jr-1?Br[Wr+1]*Gr:Tr.length,(Un=Lp(Tr,gn,An,Gr,!1))===Un.next&&(Un.steiner=!0),jn.push(Rm(Un));for(jn.sort(Om),Wr=0;Wr<jn.length;Wr++)Dm(jn[Wr],Fr),Fr=Nl(Fr,Fr.next);return Fr}(M,O,Kt,W)),M.length>80*W){ie=ke=M[0],xe=Pe=M[1];for(var fr=W;fr<Nt;fr+=W)(je=M[fr])<ie&&(ie=je),(tt=M[fr+1])<xe&&(xe=tt),je>ke&&(ke=je),tt>Pe&&(Pe=tt);ft=(ft=Math.max(ke-ie,Pe-xe))!==0?1/ft:0}return ru(Kt,Wt,W,ie,xe,ft),Wt}function Lp(M,O,W,ie,xe){var ke,Pe;if(xe===eh(M,O,W,ie)>0)for(ke=O;ke<W;ke+=ie)Pe=Ip(ke,M[ke],M[ke+1],Pe);else for(ke=W-ie;ke>=O;ke-=ie)Pe=Ip(ke,M[ke],M[ke+1],Pe);return Pe&&Du(Pe,Pe.next)&&(iu(Pe),Pe=Pe.next),Pe}function Nl(M,O){if(!M)return M;O||(O=M);var W,ie=M;do if(W=!1,ie.steiner||!Du(ie,ie.next)&&fo(ie.prev,ie,ie.next)!==0)ie=ie.next;else{if(iu(ie),(ie=O=ie.prev)===ie.next)break;W=!0}while(W||ie!==O);return O}function ru(M,O,W,ie,xe,ke,Pe){if(M){!Pe&&ke&&function(bt,Nt,Kt,Wt){var fr=bt;do fr.z===null&&(fr.z=$f(fr.x,fr.y,Nt,Kt,Wt)),fr.prevZ=fr.prev,fr.nextZ=fr.next,fr=fr.next;while(fr!==bt);fr.prevZ.nextZ=null,fr.prevZ=null,function(Tr){var Br,Fr,Gr,Wr,Jr,gn,An,Un,jn=1;do{for(Fr=Tr,Tr=null,Jr=null,gn=0;Fr;){for(gn++,Gr=Fr,An=0,Br=0;Br<jn&&(An++,Gr=Gr.nextZ);Br++);for(Un=jn;An>0||Un>0&&Gr;)An!==0&&(Un===0||!Gr||Fr.z<=Gr.z)?(Wr=Fr,Fr=Fr.nextZ,An--):(Wr=Gr,Gr=Gr.nextZ,Un--),Jr?Jr.nextZ=Wr:Tr=Wr,Wr.prevZ=Jr,Jr=Wr;Fr=Gr}Jr.nextZ=null,jn*=2}while(gn>1)}(fr)}(M,ie,xe,ke);for(var je,tt,ft=M;M.prev!==M.next;)if(je=M.prev,tt=M.next,ke?Cm(M,ie,xe,ke):Lm(M))O.push(je.i/W),O.push(M.i/W),O.push(tt.i/W),iu(M),M=tt.next,ft=tt.next;else if((M=tt)===ft){Pe?Pe===1?ru(M=Pm(Nl(M),O,W),O,W,ie,xe,ke,2):Pe===2&&Im(M,O,W,ie,xe,ke):ru(Nl(M),O,W,ie,xe,ke,1);break}}}function Lm(M){var O=M.prev,W=M,ie=M.next;if(fo(O,W,ie)>=0)return!1;for(var xe=M.next.next;xe!==M.prev;){if(bc(O.x,O.y,W.x,W.y,ie.x,ie.y,xe.x,xe.y)&&fo(xe.prev,xe,xe.next)>=0)return!1;xe=xe.next}return!0}function Cm(M,O,W,ie){var xe=M.prev,ke=M,Pe=M.next;if(fo(xe,ke,Pe)>=0)return!1;for(var je=xe.x<ke.x?xe.x<Pe.x?xe.x:Pe.x:ke.x<Pe.x?ke.x:Pe.x,tt=xe.y<ke.y?xe.y<Pe.y?xe.y:Pe.y:ke.y<Pe.y?ke.y:Pe.y,ft=xe.x>ke.x?xe.x>Pe.x?xe.x:Pe.x:ke.x>Pe.x?ke.x:Pe.x,bt=xe.y>ke.y?xe.y>Pe.y?xe.y:Pe.y:ke.y>Pe.y?ke.y:Pe.y,Nt=$f(je,tt,O,W,ie),Kt=$f(ft,bt,O,W,ie),Wt=M.prevZ,fr=M.nextZ;Wt&&Wt.z>=Nt&&fr&&fr.z<=Kt;){if(Wt!==M.prev&&Wt!==M.next&&bc(xe.x,xe.y,ke.x,ke.y,Pe.x,Pe.y,Wt.x,Wt.y)&&fo(Wt.prev,Wt,Wt.next)>=0||(Wt=Wt.prevZ,fr!==M.prev&&fr!==M.next&&bc(xe.x,xe.y,ke.x,ke.y,Pe.x,Pe.y,fr.x,fr.y)&&fo(fr.prev,fr,fr.next)>=0))return!1;fr=fr.nextZ}for(;Wt&&Wt.z>=Nt;){if(Wt!==M.prev&&Wt!==M.next&&bc(xe.x,xe.y,ke.x,ke.y,Pe.x,Pe.y,Wt.x,Wt.y)&&fo(Wt.prev,Wt,Wt.next)>=0)return!1;Wt=Wt.prevZ}for(;fr&&fr.z<=Kt;){if(fr!==M.prev&&fr!==M.next&&bc(xe.x,xe.y,ke.x,ke.y,Pe.x,Pe.y,fr.x,fr.y)&&fo(fr.prev,fr,fr.next)>=0)return!1;fr=fr.nextZ}return!0}function Pm(M,O,W){var ie=M;do{var xe=ie.prev,ke=ie.next.next;!Du(xe,ke)&&Cp(xe,ie,ie.next,ke)&&nu(xe,ke)&&nu(ke,xe)&&(O.push(xe.i/W),O.push(ie.i/W),O.push(ke.i/W),iu(ie),iu(ie.next),ie=M=ke),ie=ie.next}while(ie!==M);return Nl(ie)}function Im(M,O,W,ie,xe,ke){var Pe=M;do{for(var je=Pe.next.next;je!==Pe.prev;){if(Pe.i!==je.i&&Fm(Pe,je)){var tt=Pp(Pe,je);return Pe=Nl(Pe,Pe.next),tt=Nl(tt,tt.next),ru(Pe,O,W,ie,xe,ke),void ru(tt,O,W,ie,xe,ke)}je=je.next}Pe=Pe.next}while(Pe!==M)}function Om(M,O){return M.x-O.x}function Dm(M,O){if(O=function(ie,xe){var ke,Pe=xe,je=ie.x,tt=ie.y,ft=-1/0;do{if(tt<=Pe.y&&tt>=Pe.next.y&&Pe.next.y!==Pe.y){var bt=Pe.x+(tt-Pe.y)*(Pe.next.x-Pe.x)/(Pe.next.y-Pe.y);if(bt<=je&&bt>ft){if(ft=bt,bt===je){if(tt===Pe.y)return Pe;if(tt===Pe.next.y)return Pe.next}ke=Pe.x<Pe.next.x?Pe:Pe.next}}Pe=Pe.next}while(Pe!==xe);if(!ke)return null;if(je===ft)return ke;var Nt,Kt=ke,Wt=ke.x,fr=ke.y,Tr=1/0;Pe=ke;do je>=Pe.x&&Pe.x>=Wt&&je!==Pe.x&&bc(tt<fr?je:ft,tt,Wt,fr,tt<fr?ft:je,tt,Pe.x,Pe.y)&&(Nt=Math.abs(tt-Pe.y)/(je-Pe.x),nu(Pe,ie)&&(Nt<Tr||Nt===Tr&&(Pe.x>ke.x||Pe.x===ke.x&&zm(ke,Pe)))&&(ke=Pe,Tr=Nt)),Pe=Pe.next;while(Pe!==Kt);return ke}(M,O)){var W=Pp(O,M);Nl(O,O.next),Nl(W,W.next)}}function zm(M,O){return fo(M.prev,M,O.prev)<0&&fo(O.next,M,M.next)<0}function $f(M,O,W,ie,xe){return(M=1431655765&((M=858993459&((M=252645135&((M=16711935&((M=32767*(M-W)*xe)|M<<8))|M<<4))|M<<2))|M<<1))|(O=1431655765&((O=858993459&((O=252645135&((O=16711935&((O=32767*(O-ie)*xe)|O<<8))|O<<4))|O<<2))|O<<1))<<1}function Rm(M){var O=M,W=M;do(O.x<W.x||O.x===W.x&&O.y<W.y)&&(W=O),O=O.next;while(O!==M);return W}function bc(M,O,W,ie,xe,ke,Pe,je){return(xe-Pe)*(O-je)-(M-Pe)*(ke-je)>=0&&(M-Pe)*(ie-je)-(W-Pe)*(O-je)>=0&&(W-Pe)*(ke-je)-(xe-Pe)*(ie-je)>=0}function Fm(M,O){return M.next.i!==O.i&&M.prev.i!==O.i&&!function(W,ie){var xe=W;do{if(xe.i!==W.i&&xe.next.i!==W.i&&xe.i!==ie.i&&xe.next.i!==ie.i&&Cp(xe,xe.next,W,ie))return!0;xe=xe.next}while(xe!==W);return!1}(M,O)&&(nu(M,O)&&nu(O,M)&&function(W,ie){var xe=W,ke=!1,Pe=(W.x+ie.x)/2,je=(W.y+ie.y)/2;do xe.y>je!=xe.next.y>je&&xe.next.y!==xe.y&&Pe<(xe.next.x-xe.x)*(je-xe.y)/(xe.next.y-xe.y)+xe.x&&(ke=!ke),xe=xe.next;while(xe!==W);return ke}(M,O)&&(fo(M.prev,M,O.prev)||fo(M,O.prev,O))||Du(M,O)&&fo(M.prev,M,M.next)>0&&fo(O.prev,O,O.next)>0)}function fo(M,O,W){return(O.y-M.y)*(W.x-O.x)-(O.x-M.x)*(W.y-O.y)}function Du(M,O){return M.x===O.x&&M.y===O.y}function Cp(M,O,W,ie){var xe=Ru(fo(M,O,W)),ke=Ru(fo(M,O,ie)),Pe=Ru(fo(W,ie,M)),je=Ru(fo(W,ie,O));return xe!==ke&&Pe!==je||!(xe!==0||!zu(M,W,O))||!(ke!==0||!zu(M,ie,O))||!(Pe!==0||!zu(W,M,ie))||!(je!==0||!zu(W,O,ie))}function zu(M,O,W){return O.x<=Math.max(M.x,W.x)&&O.x>=Math.min(M.x,W.x)&&O.y<=Math.max(M.y,W.y)&&O.y>=Math.min(M.y,W.y)}function Ru(M){return M>0?1:M<0?-1:0}function nu(M,O){return fo(M.prev,M,M.next)<0?fo(M,O,M.next)>=0&&fo(M,M.prev,O)>=0:fo(M,O,M.prev)<0||fo(M,M.next,O)<0}function Pp(M,O){var W=new Qf(M.i,M.x,M.y),ie=new Qf(O.i,O.x,O.y),xe=M.next,ke=O.prev;return M.next=O,O.prev=M,W.next=xe,xe.prev=W,ie.next=W,W.prev=ie,ke.next=ie,ie.prev=ke,ie}function Ip(M,O,W,ie){var xe=new Qf(M,O,W);return ie?(xe.next=ie.next,xe.prev=ie,ie.next.prev=xe,ie.next=xe):(xe.prev=xe,xe.next=xe),xe}function iu(M){M.next.prev=M.prev,M.prev.next=M.next,M.prevZ&&(M.prevZ.nextZ=M.nextZ),M.nextZ&&(M.nextZ.prevZ=M.prevZ)}function Qf(M,O,W){this.i=M,this.x=O,this.y=W,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function eh(M,O,W,ie){for(var xe=0,ke=O,Pe=W-ie;ke<W;ke+=ie)xe+=(M[Pe]-M[ke])*(M[ke+1]+M[Pe+1]),Pe=ke;return xe}function Bm(M,O,W,ie,xe){(function ke(Pe,je,tt,ft,bt){for(;ft>tt;){if(ft-tt>600){var Nt=ft-tt+1,Kt=je-tt+1,Wt=Math.log(Nt),fr=.5*Math.exp(2*Wt/3),Tr=.5*Math.sqrt(Wt*fr*(Nt-fr)/Nt)*(Kt-Nt/2<0?-1:1),Br=Math.max(tt,Math.floor(je-Kt*fr/Nt+Tr)),Fr=Math.min(ft,Math.floor(je+(Nt-Kt)*fr/Nt+Tr));ke(Pe,je,Br,Fr,bt)}var Gr=Pe[je],Wr=tt,Jr=ft;for(au(Pe,tt,je),bt(Pe[ft],Gr)>0&&au(Pe,tt,ft);Wr<Jr;){for(au(Pe,Wr,Jr),Wr++,Jr--;bt(Pe[Wr],Gr)<0;)Wr++;for(;bt(Pe[Jr],Gr)>0;)Jr--}bt(Pe[tt],Gr)===0?au(Pe,tt,Jr):(Jr++,au(Pe,Jr,ft)),Jr<=je&&(tt=Jr+1),je<=Jr&&(ft=Jr-1)}})(M,O,W||0,ie||M.length-1,xe||Nm)}function au(M,O,W){var ie=M[O];M[O]=M[W],M[W]=ie}function Nm(M,O){return M<O?-1:M>O?1:0}function th(M,O){var W=M.length;if(W<=1)return[M];for(var ie,xe,ke=[],Pe=0;Pe<W;Pe++){var je=P(M[Pe]);je!==0&&(M[Pe].area=Math.abs(je),xe===void 0&&(xe=je<0),xe===je<0?(ie&&ke.push(ie),ie=[M[Pe]]):ie.push(M[Pe]))}if(ie&&ke.push(ie),O>1)for(var tt=0;tt<ke.length;tt++)ke[tt].length<=O||(Bm(ke[tt],O,1,ke[tt].length-1,jm),ke[tt]=ke[tt].slice(0,O));return ke}function jm(M,O){return O.area-M.area}function rh(M,O,W){for(var ie=W.patternDependencies,xe=!1,ke=0,Pe=O;ke<Pe.length;ke+=1){var je=Pe[ke].paint.get(M+"-pattern");je.isConstant()||(xe=!0);var tt=je.constantOr(null);tt&&(xe=!0,ie[tt.to]=!0,ie[tt.from]=!0)}return xe}function nh(M,O,W,ie,xe){for(var ke=xe.patternDependencies,Pe=0,je=O;Pe<je.length;Pe+=1){var tt=je[Pe],ft=tt.paint.get(M+"-pattern").value;if(ft.kind!=="constant"){var bt=ft.evaluate({zoom:ie-1},W,{},xe.availableImages),Nt=ft.evaluate({zoom:ie},W,{},xe.availableImages),Kt=ft.evaluate({zoom:ie+1},W,{},xe.availableImages);bt=bt&&bt.name?bt.name:bt,Nt=Nt&&Nt.name?Nt.name:Nt,Kt=Kt&&Kt.name?Kt.name:Kt,ke[bt]=!0,ke[Nt]=!0,ke[Kt]=!0,W.patterns[tt.id]={min:bt,mid:Nt,max:Kt}}}return W}Ou.deviation=function(M,O,W,ie){var xe=O&&O.length,ke=xe?O[0]*W:M.length,Pe=Math.abs(eh(M,0,ke,W));if(xe)for(var je=0,tt=O.length;je<tt;je++){var ft=O[je]*W,bt=je<tt-1?O[je+1]*W:M.length;Pe-=Math.abs(eh(M,ft,bt,W))}var Nt=0;for(je=0;je<ie.length;je+=3){var Kt=ie[je]*W,Wt=ie[je+1]*W,fr=ie[je+2]*W;Nt+=Math.abs((M[Kt]-M[fr])*(M[Wt+1]-M[Kt+1])-(M[Kt]-M[Wt])*(M[fr+1]-M[Kt+1]))}return Pe===0&&Nt===0?0:Math.abs((Nt-Pe)/Pe)},Ou.flatten=function(M){for(var O=M[0][0].length,W={vertices:[],holes:[],dimensions:O},ie=0,xe=0;xe<M.length;xe++){for(var ke=0;ke<M[xe].length;ke++)for(var Pe=0;Pe<O;Pe++)W.vertices.push(M[xe][ke][Pe]);xe>0&&(ie+=M[xe-1].length,W.holes.push(ie))}return W},Jf.default=Em;var Zs=function(M){this.zoom=M.zoom,this.overscaling=M.overscaling,this.layers=M.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=M.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new _s,this.indexArray=new uo,this.indexArray2=new F,this.programConfigurations=new da(Ep,M.layers,M.zoom),this.segments=new Bt,this.segments2=new Bt,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};Zs.prototype.populate=function(M,O,W){this.hasPattern=rh("fill",this.layers,O);for(var ie=this.layers[0].layout.get("fill-sort-key"),xe=[],ke=0,Pe=M;ke<Pe.length;ke+=1){var je=Pe[ke],tt=je.feature,ft=je.id,bt=je.index,Nt=je.sourceLayerIndex,Kt=this.layers[0]._featureFilter.needGeometry,Wt={type:tt.type,id:ft,properties:tt.properties,geometry:Kt?ba(tt):[]};if(this.layers[0]._featureFilter.filter(new oa(this.zoom),Wt,W)){Kt||(Wt.geometry=ba(tt));var fr=ie?ie.evaluate(Wt,{},W,O.availableImages):void 0,Tr={id:ft,properties:tt.properties,type:tt.type,sourceLayerIndex:Nt,index:bt,geometry:Wt.geometry,patterns:{},sortKey:fr};xe.push(Tr)}}ie&&xe.sort(function(Zn,li){return Zn.sortKey-li.sortKey});for(var Br=0,Fr=xe;Br<Fr.length;Br+=1){var Gr=Fr[Br],Wr=Gr,Jr=Wr.geometry,gn=Wr.index,An=Wr.sourceLayerIndex;if(this.hasPattern){var Un=nh("fill",this.layers,Gr,this.zoom,O);this.patternFeatures.push(Un)}else this.addFeature(Gr,Jr,gn,W,{});var jn=M[gn].feature;O.featureIndex.insert(jn,Jr,gn,An,this.index)}},Zs.prototype.update=function(M,O,W){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(M,O,this.stateDependentLayers,W)},Zs.prototype.addFeatures=function(M,O,W){for(var ie=0,xe=this.patternFeatures;ie<xe.length;ie+=1){var ke=xe[ie];this.addFeature(ke,ke.geometry,ke.index,O,W)}},Zs.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Zs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Zs.prototype.upload=function(M){this.uploaded||(this.layoutVertexBuffer=M.createVertexBuffer(this.layoutVertexArray,Ep),this.indexBuffer=M.createIndexBuffer(this.indexArray),this.indexBuffer2=M.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(M),this.uploaded=!0},Zs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},Zs.prototype.addFeature=function(M,O,W,ie,xe){for(var ke=0,Pe=th(O,500);ke<Pe.length;ke+=1){for(var je=Pe[ke],tt=0,ft=0,bt=je;ft<bt.length;ft+=1)tt+=bt[ft].length;for(var Nt=this.segments.prepareSegment(tt,this.layoutVertexArray,this.indexArray),Kt=Nt.vertexLength,Wt=[],fr=[],Tr=0,Br=je;Tr<Br.length;Tr+=1){var Fr=Br[Tr];if(Fr.length!==0){Fr!==je[0]&&fr.push(Wt.length/2);var Gr=this.segments2.prepareSegment(Fr.length,this.layoutVertexArray,this.indexArray2),Wr=Gr.vertexLength;this.layoutVertexArray.emplaceBack(Fr[0].x,Fr[0].y),this.indexArray2.emplaceBack(Wr+Fr.length-1,Wr),Wt.push(Fr[0].x),Wt.push(Fr[0].y);for(var Jr=1;Jr<Fr.length;Jr++)this.layoutVertexArray.emplaceBack(Fr[Jr].x,Fr[Jr].y),this.indexArray2.emplaceBack(Wr+Jr-1,Wr+Jr),Wt.push(Fr[Jr].x),Wt.push(Fr[Jr].y);Gr.vertexLength+=Fr.length,Gr.primitiveLength+=Fr.length}}for(var gn=Jf(Wt,fr),An=0;An<gn.length;An+=3)this.indexArray.emplaceBack(Kt+gn[An],Kt+gn[An+1],Kt+gn[An+2]);Nt.vertexLength+=tt,Nt.primitiveLength+=gn.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,M,W,xe,ie)},Qr("FillBucket",Zs,{omit:["layers","patternFeatures"]});var Um=new No({"fill-sort-key":new bi(_e.layout_fill["fill-sort-key"])}),Vm={paint:new No({"fill-antialias":new fi(_e.paint_fill["fill-antialias"]),"fill-opacity":new bi(_e.paint_fill["fill-opacity"]),"fill-color":new bi(_e.paint_fill["fill-color"]),"fill-outline-color":new bi(_e.paint_fill["fill-outline-color"]),"fill-translate":new fi(_e.paint_fill["fill-translate"]),"fill-translate-anchor":new fi(_e.paint_fill["fill-translate-anchor"]),"fill-pattern":new ll(_e.paint_fill["fill-pattern"])}),layout:Um},Hm=function(M){function O(W){M.call(this,W,Vm)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.recalculate=function(W,ie){M.prototype.recalculate.call(this,W,ie);var xe=this.paint._values["fill-outline-color"];xe.value.kind==="constant"&&xe.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},O.prototype.createBucket=function(W){return new Zs(W)},O.prototype.queryRadius=function(){return jo(this.paint.get("fill-translate"))},O.prototype.queryIntersectsFeature=function(W,ie,xe,ke,Pe,je,tt){return ul(Uo(W,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),je.angle,tt),ke)},O.prototype.isTileClipped=function(){return!0},O}(Qo),Op=sa([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Dp=_c;function _c(M,O,W,ie,xe){this.properties={},this.extent=W,this.type=0,this._pbf=M,this._geometry=-1,this._keys=ie,this._values=xe,M.readFields(qm,this,O)}function qm(M,O,W){M==1?O.id=W.readVarint():M==2?function(ie,xe){for(var ke=ie.readVarint()+ie.pos;ie.pos<ke;){var Pe=xe._keys[ie.readVarint()],je=xe._values[ie.readVarint()];xe.properties[Pe]=je}}(W,O):M==3?O.type=W.readVarint():M==4&&(O._geometry=W.pos)}function Gm(M){for(var O,W,ie=0,xe=0,ke=M.length,Pe=ke-1;xe<ke;Pe=xe++)O=M[xe],ie+=((W=M[Pe]).x-O.x)*(O.y+W.y);return ie}_c.types=["Unknown","Point","LineString","Polygon"],_c.prototype.loadGeometry=function(){var M=this._pbf;M.pos=this._geometry;for(var O,W=M.readVarint()+M.pos,ie=1,xe=0,ke=0,Pe=0,je=[];M.pos<W;){if(xe<=0){var tt=M.readVarint();ie=7&tt,xe=tt>>3}if(xe--,ie===1||ie===2)ke+=M.readSVarint(),Pe+=M.readSVarint(),ie===1&&(O&&je.push(O),O=[]),O.push(new r(ke,Pe));else{if(ie!==7)throw new Error("unknown command "+ie);O&&O.push(O[0].clone())}}return O&&je.push(O),je},_c.prototype.bbox=function(){var M=this._pbf;M.pos=this._geometry;for(var O=M.readVarint()+M.pos,W=1,ie=0,xe=0,ke=0,Pe=1/0,je=-1/0,tt=1/0,ft=-1/0;M.pos<O;){if(ie<=0){var bt=M.readVarint();W=7&bt,ie=bt>>3}if(ie--,W===1||W===2)(xe+=M.readSVarint())<Pe&&(Pe=xe),xe>je&&(je=xe),(ke+=M.readSVarint())<tt&&(tt=ke),ke>ft&&(ft=ke);else if(W!==7)throw new Error("unknown command "+W)}return[Pe,tt,je,ft]},_c.prototype.toGeoJSON=function(M,O,W){var ie,xe,ke=this.extent*Math.pow(2,W),Pe=this.extent*M,je=this.extent*O,tt=this.loadGeometry(),ft=_c.types[this.type];function bt(Wt){for(var fr=0;fr<Wt.length;fr++){var Tr=Wt[fr],Br=180-360*(Tr.y+je)/ke;Wt[fr]=[360*(Tr.x+Pe)/ke-180,360/Math.PI*Math.atan(Math.exp(Br*Math.PI/180))-90]}}switch(this.type){case 1:var Nt=[];for(ie=0;ie<tt.length;ie++)Nt[ie]=tt[ie][0];bt(tt=Nt);break;case 2:for(ie=0;ie<tt.length;ie++)bt(tt[ie]);break;case 3:for(tt=function(Wt){var fr=Wt.length;if(fr<=1)return[Wt];for(var Tr,Br,Fr=[],Gr=0;Gr<fr;Gr++){var Wr=Gm(Wt[Gr]);Wr!==0&&(Br===void 0&&(Br=Wr<0),Br===Wr<0?(Tr&&Fr.push(Tr),Tr=[Wt[Gr]]):Tr.push(Wt[Gr]))}return Tr&&Fr.push(Tr),Fr}(tt),ie=0;ie<tt.length;ie++)for(xe=0;xe<tt[ie].length;xe++)bt(tt[ie][xe])}tt.length===1?tt=tt[0]:ft="Multi"+ft;var Kt={type:"Feature",geometry:{type:ft,coordinates:tt},properties:this.properties};return"id"in this&&(Kt.id=this.id),Kt};var zp=Rp;function Rp(M,O){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=M,this._keys=[],this._values=[],this._features=[],M.readFields(Ym,this,O),this.length=this._features.length}function Ym(M,O,W){M===15?O.version=W.readVarint():M===1?O.name=W.readString():M===5?O.extent=W.readVarint():M===2?O._features.push(W.pos):M===3?O._keys.push(W.readString()):M===4&&O._values.push(function(ie){for(var xe=null,ke=ie.readVarint()+ie.pos;ie.pos<ke;){var Pe=ie.readVarint()>>3;xe=Pe===1?ie.readString():Pe===2?ie.readFloat():Pe===3?ie.readDouble():Pe===4?ie.readVarint64():Pe===5?ie.readVarint():Pe===6?ie.readSVarint():Pe===7?ie.readBoolean():null}return xe}(W))}function Wm(M,O,W){if(M===3){var ie=new zp(W,W.readVarint()+W.pos);ie.length&&(O[ie.name]=ie)}}Rp.prototype.feature=function(M){if(M<0||M>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[M];var O=this._pbf.readVarint()+this._pbf.pos;return new Dp(this._pbf,O,this.extent,this._keys,this._values)};var wc={VectorTile:function(M,O){this.layers=M.readFields(Wm,{},O)},VectorTileFeature:Dp,VectorTileLayer:zp},Zm=wc.VectorTileFeature.types,ih=Math.pow(2,13);function ou(M,O,W,ie,xe,ke,Pe,je){M.emplaceBack(O,W,2*Math.floor(ie*ih)+Pe,xe*ih*2,ke*ih*2,Math.round(je))}var Xs=function(M){this.zoom=M.zoom,this.overscaling=M.overscaling,this.layers=M.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=M.index,this.hasPattern=!1,this.layoutVertexArray=new Cs,this.indexArray=new uo,this.programConfigurations=new da(Op,M.layers,M.zoom),this.segments=new Bt,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};function Xm(M,O){return M.x===O.x&&(M.x<0||M.x>8192)||M.y===O.y&&(M.y<0||M.y>8192)}function Km(M){return M.every(function(O){return O.x<0})||M.every(function(O){return O.x>8192})||M.every(function(O){return O.y<0})||M.every(function(O){return O.y>8192})}Xs.prototype.populate=function(M,O,W){this.features=[],this.hasPattern=rh("fill-extrusion",this.layers,O);for(var ie=0,xe=M;ie<xe.length;ie+=1){var ke=xe[ie],Pe=ke.feature,je=ke.id,tt=ke.index,ft=ke.sourceLayerIndex,bt=this.layers[0]._featureFilter.needGeometry,Nt={type:Pe.type,id:je,properties:Pe.properties,geometry:bt?ba(Pe):[]};if(this.layers[0]._featureFilter.filter(new oa(this.zoom),Nt,W)){var Kt={id:je,sourceLayerIndex:ft,index:tt,geometry:bt?Nt.geometry:ba(Pe),properties:Pe.properties,type:Pe.type,patterns:{}};Pe.id!==void 0&&(Kt.id=Pe.id),this.hasPattern?this.features.push(nh("fill-extrusion",this.layers,Kt,this.zoom,O)):this.addFeature(Kt,Kt.geometry,tt,W,{}),O.featureIndex.insert(Pe,Kt.geometry,tt,ft,this.index,!0)}}},Xs.prototype.addFeatures=function(M,O,W){for(var ie=0,xe=this.features;ie<xe.length;ie+=1){var ke=xe[ie],Pe=ke.geometry;this.addFeature(ke,Pe,ke.index,O,W)}},Xs.prototype.update=function(M,O,W){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(M,O,this.stateDependentLayers,W)},Xs.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Xs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Xs.prototype.upload=function(M){this.uploaded||(this.layoutVertexBuffer=M.createVertexBuffer(this.layoutVertexArray,Op),this.indexBuffer=M.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(M),this.uploaded=!0},Xs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Xs.prototype.addFeature=function(M,O,W,ie,xe){for(var ke=0,Pe=th(O,500);ke<Pe.length;ke+=1){for(var je=Pe[ke],tt=0,ft=0,bt=je;ft<bt.length;ft+=1)tt+=bt[ft].length;for(var Nt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),Kt=0,Wt=je;Kt<Wt.length;Kt+=1){var fr=Wt[Kt];if(fr.length!==0&&!Km(fr))for(var Tr=0,Br=0;Br<fr.length;Br++){var Fr=fr[Br];if(Br>=1){var Gr=fr[Br-1];if(!Xm(Fr,Gr)){Nt.vertexLength+4>Bt.MAX_VERTEX_ARRAY_LENGTH&&(Nt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var Wr=Fr.sub(Gr)._perp()._unit(),Jr=Gr.dist(Fr);Tr+Jr>32768&&(Tr=0),ou(this.layoutVertexArray,Fr.x,Fr.y,Wr.x,Wr.y,0,0,Tr),ou(this.layoutVertexArray,Fr.x,Fr.y,Wr.x,Wr.y,0,1,Tr),Tr+=Jr,ou(this.layoutVertexArray,Gr.x,Gr.y,Wr.x,Wr.y,0,0,Tr),ou(this.layoutVertexArray,Gr.x,Gr.y,Wr.x,Wr.y,0,1,Tr);var gn=Nt.vertexLength;this.indexArray.emplaceBack(gn,gn+2,gn+1),this.indexArray.emplaceBack(gn+1,gn+2,gn+3),Nt.vertexLength+=4,Nt.primitiveLength+=2}}}}if(Nt.vertexLength+tt>Bt.MAX_VERTEX_ARRAY_LENGTH&&(Nt=this.segments.prepareSegment(tt,this.layoutVertexArray,this.indexArray)),Zm[M.type]==="Polygon"){for(var An=[],Un=[],jn=Nt.vertexLength,Zn=0,li=je;Zn<li.length;Zn+=1){var ci=li[Zn];if(ci.length!==0){ci!==je[0]&&Un.push(An.length/2);for(var Qn=0;Qn<ci.length;Qn++){var mi=ci[Qn];ou(this.layoutVertexArray,mi.x,mi.y,0,0,1,1,0),An.push(mi.x),An.push(mi.y)}}}for(var pi=Jf(An,Un),ui=0;ui<pi.length;ui+=3)this.indexArray.emplaceBack(jn+pi[ui],jn+pi[ui+2],jn+pi[ui+1]);Nt.primitiveLength+=pi.length/3,Nt.vertexLength+=tt}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,M,W,xe,ie)},Qr("FillExtrusionBucket",Xs,{omit:["layers","features"]});var Jm={paint:new No({"fill-extrusion-opacity":new fi(_e["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new bi(_e["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new fi(_e["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new fi(_e["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ll(_e["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new bi(_e["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new bi(_e["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new fi(_e["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},$m=function(M){function O(W){M.call(this,W,Jm)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.createBucket=function(W){return new Xs(W)},O.prototype.queryRadius=function(){return jo(this.paint.get("fill-extrusion-translate"))},O.prototype.is3D=function(){return!0},O.prototype.queryIntersectsFeature=function(W,ie,xe,ke,Pe,je,tt,ft){var bt=Uo(W,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),je.angle,tt),Nt=this.paint.get("fill-extrusion-height").evaluate(ie,xe),Kt=this.paint.get("fill-extrusion-base").evaluate(ie,xe),Wt=function(Tr,Br,Fr,Gr){for(var Wr=[],Jr=0,gn=Tr;Jr<gn.length;Jr+=1){var An=gn[Jr],Un=[An.x,An.y,Gr,1];xc(Un,Un,Br),Wr.push(new r(Un[0]/Un[3],Un[1]/Un[3]))}return Wr}(bt,ft,0,0),fr=function(Tr,Br,Fr,Gr){for(var Wr=[],Jr=[],gn=Gr[8]*Br,An=Gr[9]*Br,Un=Gr[10]*Br,jn=Gr[11]*Br,Zn=Gr[8]*Fr,li=Gr[9]*Fr,ci=Gr[10]*Fr,Qn=Gr[11]*Fr,mi=0,pi=Tr;mi<pi.length;mi+=1){for(var ui=pi[mi],Qi=[],qi=[],ia=0,Ti=ui;ia<Ti.length;ia+=1){var Yi=Ti[ia],wa=Yi.x,ma=Yi.y,Oa=Gr[0]*wa+Gr[4]*ma+Gr[12],ga=Gr[1]*wa+Gr[5]*ma+Gr[13],mo=Gr[2]*wa+Gr[6]*ma+Gr[14],Da=Gr[3]*wa+Gr[7]*ma+Gr[15],Vo=mo+Un,Co=Da+jn,Oo=Oa+Zn,es=ga+li,Yo=mo+ci,go=Da+Qn,Do=new r((Oa+gn)/Co,(ga+An)/Co);Do.z=Vo/Co,Qi.push(Do);var ro=new r(Oo/go,es/go);ro.z=Yo/go,qi.push(ro)}Wr.push(Qi),Jr.push(qi)}return[Wr,Jr]}(ke,Kt,Nt,ft);return function(Tr,Br,Fr){var Gr=1/0;ul(Fr,Br)&&(Gr=Fp(Fr,Br[0]));for(var Wr=0;Wr<Br.length;Wr++)for(var Jr=Br[Wr],gn=Tr[Wr],An=0;An<Jr.length-1;An++){var Un=Jr[An],jn=Jr[An+1],Zn=gn[An],li=gn[An+1],ci=[Un,jn,li,Zn,Un];qo(Fr,ci)&&(Gr=Math.min(Gr,Fp(Fr,ci)))}return Gr!==1/0&&Gr}(fr[0],fr[1],Wt)},O}(Qo);function su(M,O){return M.x*O.x+M.y*O.y}function Fp(M,O){if(M.length===1){for(var W,ie=0,xe=O[ie++];!W||xe.equals(W);)if(!(W=O[ie++]))return 1/0;for(;ie<O.length;ie++){var ke=O[ie],Pe=M[0],je=W.sub(xe),tt=ke.sub(xe),ft=Pe.sub(xe),bt=su(je,je),Nt=su(je,tt),Kt=su(tt,tt),Wt=su(ft,je),fr=su(ft,tt),Tr=bt*Kt-Nt*Nt,Br=(Kt*Wt-Nt*fr)/Tr,Fr=(bt*fr-Nt*Wt)/Tr,Gr=1-Br-Fr,Wr=xe.z*Gr+W.z*Br+ke.z*Fr;if(isFinite(Wr))return Wr}return 1/0}for(var Jr=1/0,gn=0,An=O;gn<An.length;gn+=1){var Un=An[gn];Jr=Math.min(Jr,Un.z)}return Jr}var Bp=sa([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,Qm=wc.VectorTileFeature.types,eg=Math.cos(Math.PI/180*37.5),Np=Math.pow(2,14)/.5,ss=function(M){this.zoom=M.zoom,this.overscaling=M.overscaling,this.layers=M.layers,this.layerIds=this.layers.map(function(O){return O.id}),this.index=M.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Gs,this.indexArray=new uo,this.programConfigurations=new da(Bp,M.layers,M.zoom),this.segments=new Bt,this.stateDependentLayerIds=this.layers.filter(function(O){return O.isStateDependent()}).map(function(O){return O.id})};ss.prototype.populate=function(M,O,W){this.hasPattern=rh("line",this.layers,O);for(var ie=this.layers[0].layout.get("line-sort-key"),xe=[],ke=0,Pe=M;ke<Pe.length;ke+=1){var je=Pe[ke],tt=je.feature,ft=je.id,bt=je.index,Nt=je.sourceLayerIndex,Kt=this.layers[0]._featureFilter.needGeometry,Wt={type:tt.type,id:ft,properties:tt.properties,geometry:Kt?ba(tt):[]};if(this.layers[0]._featureFilter.filter(new oa(this.zoom),Wt,W)){Kt||(Wt.geometry=ba(tt));var fr=ie?ie.evaluate(Wt,{},W):void 0,Tr={id:ft,properties:tt.properties,type:tt.type,sourceLayerIndex:Nt,index:bt,geometry:Wt.geometry,patterns:{},sortKey:fr};xe.push(Tr)}}ie&&xe.sort(function(Zn,li){return Zn.sortKey-li.sortKey});for(var Br=0,Fr=xe;Br<Fr.length;Br+=1){var Gr=Fr[Br],Wr=Gr,Jr=Wr.geometry,gn=Wr.index,An=Wr.sourceLayerIndex;if(this.hasPattern){var Un=nh("line",this.layers,Gr,this.zoom,O);this.patternFeatures.push(Un)}else this.addFeature(Gr,Jr,gn,W,{});var jn=M[gn].feature;O.featureIndex.insert(jn,Jr,gn,An,this.index)}},ss.prototype.update=function(M,O,W){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(M,O,this.stateDependentLayers,W)},ss.prototype.addFeatures=function(M,O,W){for(var ie=0,xe=this.patternFeatures;ie<xe.length;ie+=1){var ke=xe[ie];this.addFeature(ke,ke.geometry,ke.index,O,W)}},ss.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},ss.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},ss.prototype.upload=function(M){this.uploaded||(this.layoutVertexBuffer=M.createVertexBuffer(this.layoutVertexArray,Bp),this.indexBuffer=M.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(M),this.uploaded=!0},ss.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},ss.prototype.addFeature=function(M,O,W,ie,xe){for(var ke=this.layers[0].layout,Pe=ke.get("line-join").evaluate(M,{}),je=ke.get("line-cap"),tt=ke.get("line-miter-limit"),ft=ke.get("line-round-limit"),bt=0,Nt=O;bt<Nt.length;bt+=1){var Kt=Nt[bt];this.addLine(Kt,M,Pe,je,tt,ft)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,M,W,xe,ie)},ss.prototype.addLine=function(M,O,W,ie,xe,ke){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,O.properties&&O.properties.hasOwnProperty("mapbox_clip_start")&&O.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+O.properties.mapbox_clip_start,this.clipEnd=+O.properties.mapbox_clip_end;for(var Pe=0;Pe<M.length-1;Pe++)this.totalDistance+=M[Pe].dist(M[Pe+1]);this.updateScaledDistance()}for(var je=Qm[O.type]==="Polygon",tt=M.length;tt>=2&&M[tt-1].equals(M[tt-2]);)tt--;for(var ft=0;ft<tt-1&&M[ft].equals(M[ft+1]);)ft++;if(!(tt<(je?3:2))){W==="bevel"&&(xe=1.05);var bt,Nt=this.overscaling<=16?122880/(512*this.overscaling):0,Kt=this.segments.prepareSegment(10*tt,this.layoutVertexArray,this.indexArray),Wt=void 0,fr=void 0,Tr=void 0,Br=void 0;this.e1=this.e2=-1,je&&(bt=M[tt-2],Br=M[ft].sub(bt)._unit()._perp());for(var Fr=ft;Fr<tt;Fr++)if(!(fr=Fr===tt-1?je?M[ft+1]:void 0:M[Fr+1])||!M[Fr].equals(fr)){Br&&(Tr=Br),bt&&(Wt=bt),bt=M[Fr],Br=fr?fr.sub(bt)._unit()._perp():Tr;var Gr=(Tr=Tr||Br).add(Br);Gr.x===0&&Gr.y===0||Gr._unit();var Wr=Tr.x*Br.x+Tr.y*Br.y,Jr=Gr.x*Br.x+Gr.y*Br.y,gn=Jr!==0?1/Jr:1/0,An=2*Math.sqrt(2-2*Jr),Un=Jr<eg&&Wt&&fr,jn=Tr.x*Br.y-Tr.y*Br.x>0;if(Un&&Fr>ft){var Zn=bt.dist(Wt);if(Zn>2*Nt){var li=bt.sub(bt.sub(Wt)._mult(Nt/Zn)._round());this.updateDistance(Wt,li),this.addCurrentVertex(li,Tr,0,0,Kt),Wt=li}}var ci=Wt&&fr,Qn=ci?W:je?"butt":ie;if(ci&&Qn==="round"&&(gn<ke?Qn="miter":gn<=2&&(Qn="fakeround")),Qn==="miter"&&gn>xe&&(Qn="bevel"),Qn==="bevel"&&(gn>2&&(Qn="flipbevel"),gn<xe&&(Qn="miter")),Wt&&this.updateDistance(Wt,bt),Qn==="miter")Gr._mult(gn),this.addCurrentVertex(bt,Gr,0,0,Kt);else if(Qn==="flipbevel"){if(gn>100)Gr=Br.mult(-1);else{var mi=gn*Tr.add(Br).mag()/Tr.sub(Br).mag();Gr._perp()._mult(mi*(jn?-1:1))}this.addCurrentVertex(bt,Gr,0,0,Kt),this.addCurrentVertex(bt,Gr.mult(-1),0,0,Kt)}else if(Qn==="bevel"||Qn==="fakeround"){var pi=-Math.sqrt(gn*gn-1),ui=jn?pi:0,Qi=jn?0:pi;if(Wt&&this.addCurrentVertex(bt,Tr,ui,Qi,Kt),Qn==="fakeround")for(var qi=Math.round(180*An/Math.PI/20),ia=1;ia<qi;ia++){var Ti=ia/qi;if(Ti!==.5){var Yi=Ti-.5;Ti+=Ti*Yi*(Ti-1)*((1.0904+Wr*(Wr*(3.55645-1.43519*Wr)-3.2452))*Yi*Yi+(.848013+Wr*(.215638*Wr-1.06021)))}var wa=Br.sub(Tr)._mult(Ti)._add(Tr)._unit()._mult(jn?-1:1);this.addHalfVertex(bt,wa.x,wa.y,!1,jn,0,Kt)}fr&&this.addCurrentVertex(bt,Br,-ui,-Qi,Kt)}else if(Qn==="butt")this.addCurrentVertex(bt,Gr,0,0,Kt);else if(Qn==="square"){var ma=Wt?1:-1;this.addCurrentVertex(bt,Gr,ma,ma,Kt)}else Qn==="round"&&(Wt&&(this.addCurrentVertex(bt,Tr,0,0,Kt),this.addCurrentVertex(bt,Tr,1,1,Kt,!0)),fr&&(this.addCurrentVertex(bt,Br,-1,-1,Kt,!0),this.addCurrentVertex(bt,Br,0,0,Kt)));if(Un&&Fr<tt-1){var Oa=bt.dist(fr);if(Oa>2*Nt){var ga=bt.add(fr.sub(bt)._mult(Nt/Oa)._round());this.updateDistance(bt,ga),this.addCurrentVertex(ga,Br,0,0,Kt),bt=ga}}}}},ss.prototype.addCurrentVertex=function(M,O,W,ie,xe,ke){ke===void 0&&(ke=!1);var Pe=O.x+O.y*W,je=O.y-O.x*W,tt=-O.x+O.y*ie,ft=-O.y-O.x*ie;this.addHalfVertex(M,Pe,je,ke,!1,W,xe),this.addHalfVertex(M,tt,ft,ke,!0,-ie,xe),this.distance>Np/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(M,O,W,ie,xe,ke))},ss.prototype.addHalfVertex=function(M,O,W,ie,xe,ke,Pe){var je=M.x,tt=M.y,ft=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((je<<1)+(ie?1:0),(tt<<1)+(xe?1:0),Math.round(63*O)+128,Math.round(63*W)+128,1+(ke===0?0:ke<0?-1:1)|(63&ft)<<2,ft>>6);var bt=Pe.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,bt),Pe.primitiveLength++),xe?this.e2=bt:this.e1=bt},ss.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(Np-1):this.distance},ss.prototype.updateDistance=function(M,O){this.distance+=M.dist(O),this.updateScaledDistance()},Qr("LineBucket",ss,{omit:["layers","patternFeatures"]});var tg=new No({"line-cap":new fi(_e.layout_line["line-cap"]),"line-join":new bi(_e.layout_line["line-join"]),"line-miter-limit":new fi(_e.layout_line["line-miter-limit"]),"line-round-limit":new fi(_e.layout_line["line-round-limit"]),"line-sort-key":new bi(_e.layout_line["line-sort-key"])}),jp={paint:new No({"line-opacity":new bi(_e.paint_line["line-opacity"]),"line-color":new bi(_e.paint_line["line-color"]),"line-translate":new fi(_e.paint_line["line-translate"]),"line-translate-anchor":new fi(_e.paint_line["line-translate-anchor"]),"line-width":new bi(_e.paint_line["line-width"]),"line-gap-width":new bi(_e.paint_line["line-gap-width"]),"line-offset":new bi(_e.paint_line["line-offset"]),"line-blur":new bi(_e.paint_line["line-blur"]),"line-dasharray":new cl(_e.paint_line["line-dasharray"]),"line-pattern":new ll(_e.paint_line["line-pattern"]),"line-gradient":new ms(_e.paint_line["line-gradient"])}),layout:tg},Up=new(function(M){function O(){M.apply(this,arguments)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.possiblyEvaluate=function(W,ie){return ie=new oa(Math.floor(ie.zoom),{now:ie.now,fadeDuration:ie.fadeDuration,zoomHistory:ie.zoomHistory,transition:ie.transition}),M.prototype.possiblyEvaluate.call(this,W,ie)},O.prototype.evaluate=function(W,ie,xe,ke){return ie=s({},ie,{zoom:Math.floor(ie.zoom)}),M.prototype.evaluate.call(this,W,ie,xe,ke)},O}(bi))(jp.paint.properties["line-width"].specification);Up.useIntegerZoom=!0;var rg=function(M){function O(W){M.call(this,W,jp)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype._handleSpecialPaintPropertyUpdate=function(W){W==="line-gradient"&&this._updateGradient()},O.prototype._updateGradient=function(){var W=this._transitionablePaint._values["line-gradient"].value.expression;this.gradient=Sp(W,"lineProgress"),this.gradientTexture=null},O.prototype.recalculate=function(W,ie){M.prototype.recalculate.call(this,W,ie),this.paint._values["line-floorwidth"]=Up.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,W)},O.prototype.createBucket=function(W){return new ss(W)},O.prototype.queryRadius=function(W){var ie=W,xe=Vp(Pa("line-width",this,ie),Pa("line-gap-width",this,ie)),ke=Pa("line-offset",this,ie);return xe/2+Math.abs(ke)+jo(this.paint.get("line-translate"))},O.prototype.queryIntersectsFeature=function(W,ie,xe,ke,Pe,je,tt){var ft=Uo(W,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),je.angle,tt),bt=tt/2*Vp(this.paint.get("line-width").evaluate(ie,xe),this.paint.get("line-gap-width").evaluate(ie,xe)),Nt=this.paint.get("line-offset").evaluate(ie,xe);return Nt&&(ke=function(Kt,Wt){for(var fr=[],Tr=new r(0,0),Br=0;Br<Kt.length;Br++){for(var Fr=Kt[Br],Gr=[],Wr=0;Wr<Fr.length;Wr++){var Jr=Fr[Wr-1],gn=Fr[Wr],An=Fr[Wr+1],Un=Wr===0?Tr:gn.sub(Jr)._unit()._perp(),jn=Wr===Fr.length-1?Tr:An.sub(gn)._unit()._perp(),Zn=Un._add(jn)._unit(),li=Zn.x*jn.x+Zn.y*jn.y;Zn._mult(1/li),Gr.push(Zn._mult(Wt)._add(gn))}fr.push(Gr)}return fr}(ke,Nt*tt)),function(Kt,Wt,fr){for(var Tr=0;Tr<Wt.length;Tr++){var Br=Wt[Tr];if(Kt.length>=3){for(var Fr=0;Fr<Br.length;Fr++)if(gs(Kt,Br[Fr]))return!0}if(ec(Kt,Br,fr))return!0}return!1}(ft,ke,bt)},O.prototype.isTileClipped=function(){return!0},O}(Qo);function Vp(M,O){return O>0?O+2*M:M}var ah=sa([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),ng=sa([{name:"a_projected_pos",components:3,type:"Float32"}],4),ig=(sa([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),sa([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Hp=(sa([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),sa([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),ag=sa([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);sa([{name:"triangle",components:3,type:"Uint16"}]),sa([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),sa([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),sa([{type:"Float32",name:"offsetX"}]),sa([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);function og(M,O,W){return M.sections.forEach(function(ie){ie.text=function(xe,ke,Pe){var je=ke.layout.get("text-transform").evaluate(Pe,{});return je==="uppercase"?xe=xe.toLocaleUpperCase():je==="lowercase"&&(xe=xe.toLocaleLowerCase()),bo.applyArabicShaping&&(xe=bo.applyArabicShaping(xe)),xe}(ie.text,O,W)}),M}var lu={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},qp=function(M,O,W,ie,xe){var ke,Pe,je=8*xe-ie-1,tt=(1<<je)-1,ft=tt>>1,bt=-7,Nt=W?xe-1:0,Kt=W?-1:1,Wt=M[O+Nt];for(Nt+=Kt,ke=Wt&(1<<-bt)-1,Wt>>=-bt,bt+=je;bt>0;ke=256*ke+M[O+Nt],Nt+=Kt,bt-=8);for(Pe=ke&(1<<-bt)-1,ke>>=-bt,bt+=ie;bt>0;Pe=256*Pe+M[O+Nt],Nt+=Kt,bt-=8);if(ke===0)ke=1-ft;else{if(ke===tt)return Pe?NaN:1/0*(Wt?-1:1);Pe+=Math.pow(2,ie),ke-=ft}return(Wt?-1:1)*Pe*Math.pow(2,ke-ie)},Gp=function(M,O,W,ie,xe,ke){var Pe,je,tt,ft=8*ke-xe-1,bt=(1<<ft)-1,Nt=bt>>1,Kt=xe===23?Math.pow(2,-24)-Math.pow(2,-77):0,Wt=ie?0:ke-1,fr=ie?1:-1,Tr=O<0||O===0&&1/O<0?1:0;for(O=Math.abs(O),isNaN(O)||O===1/0?(je=isNaN(O)?1:0,Pe=bt):(Pe=Math.floor(Math.log(O)/Math.LN2),O*(tt=Math.pow(2,-Pe))<1&&(Pe--,tt*=2),(O+=Pe+Nt>=1?Kt/tt:Kt*Math.pow(2,1-Nt))*tt>=2&&(Pe++,tt/=2),Pe+Nt>=bt?(je=0,Pe=bt):Pe+Nt>=1?(je=(O*tt-1)*Math.pow(2,xe),Pe+=Nt):(je=O*Math.pow(2,Nt-1)*Math.pow(2,xe),Pe=0));xe>=8;M[W+Wt]=255&je,Wt+=fr,je/=256,xe-=8);for(Pe=Pe<<xe|je,ft+=xe;ft>0;M[W+Wt]=255&Pe,Wt+=fr,Pe/=256,ft-=8);M[W+Wt-fr]|=128*Tr},Fu=_a;function _a(M){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(M)?M:new Uint8Array(M||0),this.pos=0,this.type=0,this.length=this.buf.length}_a.Varint=0,_a.Fixed64=1,_a.Bytes=2,_a.Fixed32=5;var Yp=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function wl(M){return M.type===_a.Bytes?M.readVarint()+M.pos:M.pos+1}function Tc(M,O,W){return W?4294967296*O+(M>>>0):4294967296*(O>>>0)+(M>>>0)}function Wp(M,O,W){var ie=O<=16383?1:O<=2097151?2:O<=268435455?3:Math.floor(Math.log(O)/(7*Math.LN2));W.realloc(ie);for(var xe=W.pos-1;xe>=M;xe--)W.buf[xe+ie]=W.buf[xe]}function sg(M,O){for(var W=0;W<M.length;W++)O.writeVarint(M[W])}function lg(M,O){for(var W=0;W<M.length;W++)O.writeSVarint(M[W])}function cg(M,O){for(var W=0;W<M.length;W++)O.writeFloat(M[W])}function ug(M,O){for(var W=0;W<M.length;W++)O.writeDouble(M[W])}function fg(M,O){for(var W=0;W<M.length;W++)O.writeBoolean(M[W])}function hg(M,O){for(var W=0;W<M.length;W++)O.writeFixed32(M[W])}function pg(M,O){for(var W=0;W<M.length;W++)O.writeSFixed32(M[W])}function dg(M,O){for(var W=0;W<M.length;W++)O.writeFixed64(M[W])}function mg(M,O){for(var W=0;W<M.length;W++)O.writeSFixed64(M[W])}function Bu(M,O){return(M[O]|M[O+1]<<8|M[O+2]<<16)+16777216*M[O+3]}function kc(M,O,W){M[W]=O,M[W+1]=O>>>8,M[W+2]=O>>>16,M[W+3]=O>>>24}function Zp(M,O){return(M[O]|M[O+1]<<8|M[O+2]<<16)+(M[O+3]<<24)}_a.prototype={destroy:function(){this.buf=null},readFields:function(M,O,W){for(W=W||this.length;this.pos<W;){var ie=this.readVarint(),xe=ie>>3,ke=this.pos;this.type=7&ie,M(xe,O,this),this.pos===ke&&this.skip(ie)}return O},readMessage:function(M,O){return this.readFields(M,O,this.readVarint()+this.pos)},readFixed32:function(){var M=Bu(this.buf,this.pos);return this.pos+=4,M},readSFixed32:function(){var M=Zp(this.buf,this.pos);return this.pos+=4,M},readFixed64:function(){var M=Bu(this.buf,this.pos)+4294967296*Bu(this.buf,this.pos+4);return this.pos+=8,M},readSFixed64:function(){var M=Bu(this.buf,this.pos)+4294967296*Zp(this.buf,this.pos+4);return this.pos+=8,M},readFloat:function(){var M=qp(this.buf,this.pos,!0,23,4);return this.pos+=4,M},readDouble:function(){var M=qp(this.buf,this.pos,!0,52,8);return this.pos+=8,M},readVarint:function(M){var O,W,ie=this.buf;return O=127&(W=ie[this.pos++]),W<128?O:(O|=(127&(W=ie[this.pos++]))<<7,W<128?O:(O|=(127&(W=ie[this.pos++]))<<14,W<128?O:(O|=(127&(W=ie[this.pos++]))<<21,W<128?O:function(xe,ke,Pe){var je,tt,ft=Pe.buf;if(tt=ft[Pe.pos++],je=(112&tt)>>4,tt<128||(tt=ft[Pe.pos++],je|=(127&tt)<<3,tt<128)||(tt=ft[Pe.pos++],je|=(127&tt)<<10,tt<128)||(tt=ft[Pe.pos++],je|=(127&tt)<<17,tt<128)||(tt=ft[Pe.pos++],je|=(127&tt)<<24,tt<128)||(tt=ft[Pe.pos++],je|=(1&tt)<<31,tt<128))return Tc(xe,je,ke);throw new Error("Expected varint not more than 10 bytes")}(O|=(15&(W=ie[this.pos]))<<28,M,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var M=this.readVarint();return M%2==1?(M+1)/-2:M/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var M=this.readVarint()+this.pos,O=this.pos;return this.pos=M,M-O>=12&&Yp?function(W,ie,xe){return Yp.decode(W.subarray(ie,xe))}(this.buf,O,M):function(W,ie,xe){for(var ke="",Pe=ie;Pe<xe;){var je,tt,ft,bt=W[Pe],Nt=null,Kt=bt>239?4:bt>223?3:bt>191?2:1;if(Pe+Kt>xe)break;Kt===1?bt<128&&(Nt=bt):Kt===2?(192&(je=W[Pe+1]))==128&&(Nt=(31&bt)<<6|63&je)<=127&&(Nt=null):Kt===3?(je=W[Pe+1],tt=W[Pe+2],(192&je)==128&&(192&tt)==128&&((Nt=(15&bt)<<12|(63&je)<<6|63&tt)<=2047||Nt>=55296&&Nt<=57343)&&(Nt=null)):Kt===4&&(je=W[Pe+1],tt=W[Pe+2],ft=W[Pe+3],(192&je)==128&&(192&tt)==128&&(192&ft)==128&&((Nt=(15&bt)<<18|(63&je)<<12|(63&tt)<<6|63&ft)<=65535||Nt>=1114112)&&(Nt=null)),Nt===null?(Nt=65533,Kt=1):Nt>65535&&(Nt-=65536,ke+=String.fromCharCode(Nt>>>10&1023|55296),Nt=56320|1023&Nt),ke+=String.fromCharCode(Nt),Pe+=Kt}return ke}(this.buf,O,M)},readBytes:function(){var M=this.readVarint()+this.pos,O=this.buf.subarray(this.pos,M);return this.pos=M,O},readPackedVarint:function(M,O){if(this.type!==_a.Bytes)return M.push(this.readVarint(O));var W=wl(this);for(M=M||[];this.pos<W;)M.push(this.readVarint(O));return M},readPackedSVarint:function(M){if(this.type!==_a.Bytes)return M.push(this.readSVarint());var O=wl(this);for(M=M||[];this.pos<O;)M.push(this.readSVarint());return M},readPackedBoolean:function(M){if(this.type!==_a.Bytes)return M.push(this.readBoolean());var O=wl(this);for(M=M||[];this.pos<O;)M.push(this.readBoolean());return M},readPackedFloat:function(M){if(this.type!==_a.Bytes)return M.push(this.readFloat());var O=wl(this);for(M=M||[];this.pos<O;)M.push(this.readFloat());return M},readPackedDouble:function(M){if(this.type!==_a.Bytes)return M.push(this.readDouble());var O=wl(this);for(M=M||[];this.pos<O;)M.push(this.readDouble());return M},readPackedFixed32:function(M){if(this.type!==_a.Bytes)return M.push(this.readFixed32());var O=wl(this);for(M=M||[];this.pos<O;)M.push(this.readFixed32());return M},readPackedSFixed32:function(M){if(this.type!==_a.Bytes)return M.push(this.readSFixed32());var O=wl(this);for(M=M||[];this.pos<O;)M.push(this.readSFixed32());return M},readPackedFixed64:function(M){if(this.type!==_a.Bytes)return M.push(this.readFixed64());var O=wl(this);for(M=M||[];this.pos<O;)M.push(this.readFixed64());return M},readPackedSFixed64:function(M){if(this.type!==_a.Bytes)return M.push(this.readSFixed64());var O=wl(this);for(M=M||[];this.pos<O;)M.push(this.readSFixed64());return M},skip:function(M){var O=7&M;if(O===_a.Varint)for(;this.buf[this.pos++]>127;);else if(O===_a.Bytes)this.pos=this.readVarint()+this.pos;else if(O===_a.Fixed32)this.pos+=4;else{if(O!==_a.Fixed64)throw new Error("Unimplemented type: "+O);this.pos+=8}},writeTag:function(M,O){this.writeVarint(M<<3|O)},realloc:function(M){for(var O=this.length||16;O<this.pos+M;)O*=2;if(O!==this.length){var W=new Uint8Array(O);W.set(this.buf),this.buf=W,this.length=O}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(M){this.realloc(4),kc(this.buf,M,this.pos),this.pos+=4},writeSFixed32:function(M){this.realloc(4),kc(this.buf,M,this.pos),this.pos+=4},writeFixed64:function(M){this.realloc(8),kc(this.buf,-1&M,this.pos),kc(this.buf,Math.floor(M*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(M){this.realloc(8),kc(this.buf,-1&M,this.pos),kc(this.buf,Math.floor(M*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(M){(M=+M||0)>268435455||M<0?function(O,W){var ie,xe;if(O>=0?(ie=O%4294967296|0,xe=O/4294967296|0):(xe=~(-O/4294967296),4294967295^(ie=~(-O%4294967296))?ie=ie+1|0:(ie=0,xe=xe+1|0)),O>=18446744073709552e3||O<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");W.realloc(10),function(ke,Pe,je){je.buf[je.pos++]=127&ke|128,ke>>>=7,je.buf[je.pos++]=127&ke|128,ke>>>=7,je.buf[je.pos++]=127&ke|128,ke>>>=7,je.buf[je.pos++]=127&ke|128,ke>>>=7,je.buf[je.pos]=127&ke}(ie,0,W),function(ke,Pe){var je=(7&ke)<<4;Pe.buf[Pe.pos++]|=je|((ke>>>=3)?128:0),ke&&(Pe.buf[Pe.pos++]=127&ke|((ke>>>=7)?128:0),ke&&(Pe.buf[Pe.pos++]=127&ke|((ke>>>=7)?128:0),ke&&(Pe.buf[Pe.pos++]=127&ke|((ke>>>=7)?128:0),ke&&(Pe.buf[Pe.pos++]=127&ke|((ke>>>=7)?128:0),ke&&(Pe.buf[Pe.pos++]=127&ke)))))}(xe,W)}(M,this):(this.realloc(4),this.buf[this.pos++]=127&M|(M>127?128:0),M<=127||(this.buf[this.pos++]=127&(M>>>=7)|(M>127?128:0),M<=127||(this.buf[this.pos++]=127&(M>>>=7)|(M>127?128:0),M<=127||(this.buf[this.pos++]=M>>>7&127))))},writeSVarint:function(M){this.writeVarint(M<0?2*-M-1:2*M)},writeBoolean:function(M){this.writeVarint(Boolean(M))},writeString:function(M){M=String(M),this.realloc(4*M.length),this.pos++;var O=this.pos;this.pos=function(ie,xe,ke){for(var Pe,je,tt=0;tt<xe.length;tt++){if((Pe=xe.charCodeAt(tt))>55295&&Pe<57344){if(!je){Pe>56319||tt+1===xe.length?(ie[ke++]=239,ie[ke++]=191,ie[ke++]=189):je=Pe;continue}if(Pe<56320){ie[ke++]=239,ie[ke++]=191,ie[ke++]=189,je=Pe;continue}Pe=je-55296<<10|Pe-56320|65536,je=null}else je&&(ie[ke++]=239,ie[ke++]=191,ie[ke++]=189,je=null);Pe<128?ie[ke++]=Pe:(Pe<2048?ie[ke++]=Pe>>6|192:(Pe<65536?ie[ke++]=Pe>>12|224:(ie[ke++]=Pe>>18|240,ie[ke++]=Pe>>12&63|128),ie[ke++]=Pe>>6&63|128),ie[ke++]=63&Pe|128)}return ke}(this.buf,M,this.pos);var W=this.pos-O;W>=128&&Wp(O,W,this),this.pos=O-1,this.writeVarint(W),this.pos+=W},writeFloat:function(M){this.realloc(4),Gp(this.buf,M,this.pos,!0,23,4),this.pos+=4},writeDouble:function(M){this.realloc(8),Gp(this.buf,M,this.pos,!0,52,8),this.pos+=8},writeBytes:function(M){var O=M.length;this.writeVarint(O),this.realloc(O);for(var W=0;W<O;W++)this.buf[this.pos++]=M[W]},writeRawMessage:function(M,O){this.pos++;var W=this.pos;M(O,this);var ie=this.pos-W;ie>=128&&Wp(W,ie,this),this.pos=W-1,this.writeVarint(ie),this.pos+=ie},writeMessage:function(M,O,W){this.writeTag(M,_a.Bytes),this.writeRawMessage(O,W)},writePackedVarint:function(M,O){O.length&&this.writeMessage(M,sg,O)},writePackedSVarint:function(M,O){O.length&&this.writeMessage(M,lg,O)},writePackedBoolean:function(M,O){O.length&&this.writeMessage(M,fg,O)},writePackedFloat:function(M,O){O.length&&this.writeMessage(M,cg,O)},writePackedDouble:function(M,O){O.length&&this.writeMessage(M,ug,O)},writePackedFixed32:function(M,O){O.length&&this.writeMessage(M,hg,O)},writePackedSFixed32:function(M,O){O.length&&this.writeMessage(M,pg,O)},writePackedFixed64:function(M,O){O.length&&this.writeMessage(M,dg,O)},writePackedSFixed64:function(M,O){O.length&&this.writeMessage(M,mg,O)},writeBytesField:function(M,O){this.writeTag(M,_a.Bytes),this.writeBytes(O)},writeFixed32Field:function(M,O){this.writeTag(M,_a.Fixed32),this.writeFixed32(O)},writeSFixed32Field:function(M,O){this.writeTag(M,_a.Fixed32),this.writeSFixed32(O)},writeFixed64Field:function(M,O){this.writeTag(M,_a.Fixed64),this.writeFixed64(O)},writeSFixed64Field:function(M,O){this.writeTag(M,_a.Fixed64),this.writeSFixed64(O)},writeVarintField:function(M,O){this.writeTag(M,_a.Varint),this.writeVarint(O)},writeSVarintField:function(M,O){this.writeTag(M,_a.Varint),this.writeSVarint(O)},writeStringField:function(M,O){this.writeTag(M,_a.Bytes),this.writeString(O)},writeFloatField:function(M,O){this.writeTag(M,_a.Fixed32),this.writeFloat(O)},writeDoubleField:function(M,O){this.writeTag(M,_a.Fixed64),this.writeDouble(O)},writeBooleanField:function(M,O){this.writeVarintField(M,Boolean(O))}};function gg(M,O,W){M===1&&W.readMessage(vg,O)}function vg(M,O,W){if(M===3){var ie=W.readMessage(yg,{}),xe=ie.id,ke=ie.bitmap,Pe=ie.width,je=ie.height,tt=ie.left,ft=ie.top,bt=ie.advance;O.push({id:xe,bitmap:new ic({width:Pe+6,height:je+6},ke),metrics:{width:Pe,height:je,left:tt,top:ft,advance:bt}})}}function yg(M,O,W){M===1?O.id=W.readVarint():M===2?O.bitmap=W.readBytes():M===3?O.width=W.readVarint():M===4?O.height=W.readVarint():M===5?O.left=W.readSVarint():M===6?O.top=W.readSVarint():M===7&&(O.advance=W.readVarint())}function Xp(M){for(var O=0,W=0,ie=0,xe=M;ie<xe.length;ie+=1){var ke=xe[ie];O+=ke.w*ke.h,W=Math.max(W,ke.w)}M.sort(function(Tr,Br){return Br.h-Tr.h});for(var Pe=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(O/.95)),W),h:1/0}],je=0,tt=0,ft=0,bt=M;ft<bt.length;ft+=1)for(var Nt=bt[ft],Kt=Pe.length-1;Kt>=0;Kt--){var Wt=Pe[Kt];if(!(Nt.w>Wt.w||Nt.h>Wt.h)){if(Nt.x=Wt.x,Nt.y=Wt.y,tt=Math.max(tt,Nt.y+Nt.h),je=Math.max(je,Nt.x+Nt.w),Nt.w===Wt.w&&Nt.h===Wt.h){var fr=Pe.pop();Kt<Pe.length&&(Pe[Kt]=fr)}else Nt.h===Wt.h?(Wt.x+=Nt.w,Wt.w-=Nt.w):Nt.w===Wt.w?(Wt.y+=Nt.h,Wt.h-=Nt.h):(Pe.push({x:Wt.x+Nt.w,y:Wt.y,w:Wt.w-Nt.w,h:Nt.h}),Wt.y+=Nt.h,Wt.h-=Nt.h);break}}return{w:je,h:tt,fill:O/(je*tt)||0}}var Nu=function(M,O){var W=O.pixelRatio,ie=O.version,xe=O.stretchX,ke=O.stretchY,Pe=O.content;this.paddedRect=M,this.pixelRatio=W,this.stretchX=xe,this.stretchY=ke,this.content=Pe,this.version=ie},cu={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};cu.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},cu.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},cu.tlbr.get=function(){return this.tl.concat(this.br)},cu.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Nu.prototype,cu);var uu=function(M,O){var W={},ie={};this.haveRenderCallbacks=[];var xe=[];this.addImages(M,W,xe),this.addImages(O,ie,xe);var ke=Xp(xe),Pe=ke.w,je=ke.h,tt=new os({width:Pe||1,height:je||1});for(var ft in M){var bt=M[ft],Nt=W[ft].paddedRect;os.copy(bt.data,tt,{x:0,y:0},{x:Nt.x+1,y:Nt.y+1},bt.data)}for(var Kt in O){var Wt=O[Kt],fr=ie[Kt].paddedRect,Tr=fr.x+1,Br=fr.y+1,Fr=Wt.data.width,Gr=Wt.data.height;os.copy(Wt.data,tt,{x:0,y:0},{x:Tr,y:Br},Wt.data),os.copy(Wt.data,tt,{x:0,y:Gr-1},{x:Tr,y:Br-1},{width:Fr,height:1}),os.copy(Wt.data,tt,{x:0,y:0},{x:Tr,y:Br+Gr},{width:Fr,height:1}),os.copy(Wt.data,tt,{x:Fr-1,y:0},{x:Tr-1,y:Br},{width:1,height:Gr}),os.copy(Wt.data,tt,{x:0,y:0},{x:Tr+Fr,y:Br},{width:1,height:Gr})}this.image=tt,this.iconPositions=W,this.patternPositions=ie};uu.prototype.addImages=function(M,O,W){for(var ie in M){var xe=M[ie],ke={x:0,y:0,w:xe.data.width+2,h:xe.data.height+2};W.push(ke),O[ie]=new Nu(ke,xe),xe.hasRenderCallback&&this.haveRenderCallbacks.push(ie)}},uu.prototype.patchUpdatedImages=function(M,O){for(var W in M.dispatchRenderCallbacks(this.haveRenderCallbacks),M.updatedImages)this.patchUpdatedImage(this.iconPositions[W],M.getImage(W),O),this.patchUpdatedImage(this.patternPositions[W],M.getImage(W),O)},uu.prototype.patchUpdatedImage=function(M,O,W){if(M&&O&&M.version!==O.version){M.version=O.version;var ie=M.tl,xe=ie[0],ke=ie[1];W.update(O.data,void 0,{x:xe,y:ke})}},Qr("ImagePosition",Nu),Qr("ImageAtlas",uu);var Ts={horizontal:1,vertical:2,horizontalOnly:3},Mc=function(){this.scale=1,this.fontStack="",this.imageName=null};Mc.forText=function(M,O){var W=new Mc;return W.scale=M||1,W.fontStack=O,W},Mc.forImage=function(M){var O=new Mc;return O.imageName=M,O};var Go=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function ju(M,O,W,ie,xe,ke,Pe,je,tt,ft,bt,Nt,Kt,Wt,fr,Tr){var Br,Fr=Go.fromFeature(M,xe);Nt===Ts.vertical&&Fr.verticalizePunctuation();var Gr=bo.processBidirectionalText,Wr=bo.processStyledBidirectionalText;if(Gr&&Fr.sections.length===1){Br=[];for(var Jr=0,gn=Gr(Fr.toString(),oh(Fr,ft,ke,O,ie,Wt,fr));Jr<gn.length;Jr+=1){var An=gn[Jr],Un=new Go;Un.text=An,Un.sections=Fr.sections;for(var jn=0;jn<An.length;jn++)Un.sectionIndex.push(0);Br.push(Un)}}else if(Wr){Br=[];for(var Zn=0,li=Wr(Fr.text,Fr.sectionIndex,oh(Fr,ft,ke,O,ie,Wt,fr));Zn<li.length;Zn+=1){var ci=li[Zn],Qn=new Go;Qn.text=ci[0],Qn.sectionIndex=ci[1],Qn.sections=Fr.sections,Br.push(Qn)}}else Br=function(ui,Qi){for(var qi=[],ia=ui.text,Ti=0,Yi=0,wa=Qi;Yi<wa.length;Yi+=1){var ma=wa[Yi];qi.push(ui.substring(Ti,ma)),Ti=ma}return Ti<ia.length&&qi.push(ui.substring(Ti,ia.length)),qi}(Fr,oh(Fr,ft,ke,O,ie,Wt,fr));var mi=[],pi={positionedLines:mi,text:Fr.toString(),top:bt[1],bottom:bt[1],left:bt[0],right:bt[0],writingMode:Nt,iconsInText:!1,verticalizable:!1};return function(ui,Qi,qi,ia,Ti,Yi,wa,ma,Oa,ga,mo,Da){for(var Vo=0,Co=-17,Oo=0,es=0,Yo=ma==="right"?1:ma==="left"?0:.5,go=0,Do=0,ro=Ti;Do<ro.length;Do+=1){var _o=ro[Do];_o.trim();var Bi=_o.getMaxScale(),ta=24*(Bi-1),Wa={positionedGlyphs:[],lineOffset:0};ui.positionedLines[go]=Wa;var Za=Wa.positionedGlyphs,Ha=0;if(_o.length()){for(var za=0;za<_o.length();za++){var la=_o.getSection(za),Xa=_o.getSectionIndex(za),ts=_o.getCharCode(za),ys=0,Wo=null,Ks=null,Ml=null,Po=24,Js=!(Oa===Ts.horizontal||!mo&&!gi(ts)||mo&&(Uu[ts]||(Ul=ts,In.Arabic(Ul)||In["Arabic Supplement"](Ul)||In["Arabic Extended-A"](Ul)||In["Arabic Presentation Forms-A"](Ul)||In["Arabic Presentation Forms-B"](Ul))));if(la.imageName){var $s=ia[la.imageName];if(!$s)continue;Ml=la.imageName,ui.iconsInText=ui.iconsInText||!0,Ks=$s.paddedRect;var Qs=$s.displaySize;la.scale=24*la.scale/Da,Wo={width:Qs[0],height:Qs[1],left:1,top:-3,advance:Js?Qs[1]:Qs[0]};var gh=24-Qs[1]*la.scale;ys=ta+gh,Po=Wo.advance;var Oc=Js?Qs[0]*la.scale-24*Bi:Qs[1]*la.scale-24*Bi;Oc>0&&Oc>Ha&&(Ha=Oc)}else{var Ku=qi[la.fontStack],lc=Ku&&Ku[ts];if(lc&&lc.rect)Ks=lc.rect,Wo=lc.metrics;else{var Ju=Qi[la.fontStack],$u=Ju&&Ju[ts];if(!$u)continue;Wo=$u.metrics}ys=24*(Bi-la.scale)}Js?(ui.verticalizable=!0,Za.push({glyph:ts,imageName:Ml,x:Vo,y:Co+ys,vertical:Js,scale:la.scale,fontStack:la.fontStack,sectionIndex:Xa,metrics:Wo,rect:Ks}),Vo+=Po*la.scale+ga):(Za.push({glyph:ts,imageName:Ml,x:Vo,y:Co+ys,vertical:Js,scale:la.scale,fontStack:la.fontStack,sectionIndex:Xa,metrics:Wo,rect:Ks}),Vo+=Wo.advance*la.scale+ga)}if(Za.length!==0){var Qu=Vo-ga;Oo=Math.max(Qu,Oo),bg(Za,0,Za.length-1,Yo,Ha)}Vo=0;var ef=Yi*Bi+Ha;Wa.lineOffset=Math.max(Ha,ta),Co+=ef,es=Math.max(ef,es),++go}else Co+=Yi,++go}var Ul,Dc=Co- -17,tf=sh(wa),zc=tf.horizontalAlign,Vl=tf.verticalAlign;(function(pu,rf,nf,af,du,of,mu,sf,gu){var lf=(rf-nf)*du,Rc=0;Rc=of!==mu?-sf*af- -17:(-af*gu+.5)*mu;for(var Fc=0,Bc=pu;Fc<Bc.length;Fc+=1)for(var cf=Bc[Fc],Nc=0,vu=cf.positionedGlyphs;Nc<vu.length;Nc+=1){var jc=vu[Nc];jc.x+=lf,jc.y+=Rc}})(ui.positionedLines,Yo,zc,Vl,Oo,es,Yi,Dc,Ti.length),ui.top+=-Vl*Dc,ui.bottom=ui.top+Dc,ui.left+=-zc*Oo,ui.right=ui.left+Oo}(pi,O,W,ie,Br,Pe,je,tt,Nt,ft,Kt,Tr),!function(ui){for(var Qi=0,qi=ui;Qi<qi.length;Qi+=1)if(qi[Qi].positionedGlyphs.length!==0)return!1;return!0}(mi)&&pi}Go.fromFeature=function(M,O){for(var W=new Go,ie=0;ie<M.sections.length;ie++){var xe=M.sections[ie];xe.image?W.addImageSection(xe):W.addTextSection(xe,O)}return W},Go.prototype.length=function(){return this.text.length},Go.prototype.getSection=function(M){return this.sections[this.sectionIndex[M]]},Go.prototype.getSectionIndex=function(M){return this.sectionIndex[M]},Go.prototype.getCharCode=function(M){return this.text.charCodeAt(M)},Go.prototype.verticalizePunctuation=function(){this.text=function(M){for(var O="",W=0;W<M.length;W++){var ie=M.charCodeAt(W+1)||null,xe=M.charCodeAt(W-1)||null;(!ie||!Fi(ie)||lu[M[W+1]])&&(!xe||!Fi(xe)||lu[M[W-1]])&&lu[M[W]]?O+=lu[M[W]]:O+=M[W]}return O}(this.text)},Go.prototype.trim=function(){for(var M=0,O=0;O<this.text.length&&Uu[this.text.charCodeAt(O)];O++)M++;for(var W=this.text.length,ie=this.text.length-1;ie>=0&&ie>=M&&Uu[this.text.charCodeAt(ie)];ie--)W--;this.text=this.text.substring(M,W),this.sectionIndex=this.sectionIndex.slice(M,W)},Go.prototype.substring=function(M,O){var W=new Go;return W.text=this.text.substring(M,O),W.sectionIndex=this.sectionIndex.slice(M,O),W.sections=this.sections,W},Go.prototype.toString=function(){return this.text},Go.prototype.getMaxScale=function(){var M=this;return this.sectionIndex.reduce(function(O,W){return Math.max(O,M.sections[W].scale)},0)},Go.prototype.addTextSection=function(M,O){this.text+=M.text,this.sections.push(Mc.forText(M.scale,M.fontStack||O));for(var W=this.sections.length-1,ie=0;ie<M.text.length;++ie)this.sectionIndex.push(W)},Go.prototype.addImageSection=function(M){var O=M.image?M.image.name:"";if(O.length!==0){var W=this.getNextImageSectionCharCode();W?(this.text+=String.fromCharCode(W),this.sections.push(Mc.forImage(O)),this.sectionIndex.push(this.sections.length-1)):A("Reached maximum number of images 6401")}else A("Can't add FormattedSection with an empty image.")},Go.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Uu={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},vs={};function Kp(M,O,W,ie,xe,ke){if(O.imageName){var Pe=ie[O.imageName];return Pe?Pe.displaySize[0]*O.scale*24/ke+xe:0}var je=W[O.fontStack],tt=je&&je[M];return tt?tt.metrics.advance*O.scale+xe:0}function Jp(M,O,W,ie){var xe=Math.pow(M-O,2);return ie?M<O?xe/2:2*xe:xe+Math.abs(W)*W}function xg(M,O,W){var ie=0;return M===10&&(ie-=1e4),W&&(ie+=150),M!==40&&M!==65288||(ie+=50),O!==41&&O!==65289||(ie+=50),ie}function $p(M,O,W,ie,xe,ke){for(var Pe=null,je=Jp(O,W,xe,ke),tt=0,ft=ie;tt<ft.length;tt+=1){var bt=ft[tt],Nt=Jp(O-bt.x,W,xe,ke)+bt.badness;Nt<=je&&(Pe=bt,je=Nt)}return{index:M,x:O,priorBreak:Pe,badness:je}}function oh(M,O,W,ie,xe,ke,Pe){if(ke!=="point")return[];if(!M)return[];for(var je,tt=[],ft=function(Br,Fr,Gr,Wr,Jr,gn){for(var An=0,Un=0;Un<Br.length();Un++){var jn=Br.getSection(Un);An+=Kp(Br.getCharCode(Un),jn,Wr,Jr,Fr,gn)}return An/Math.max(1,Math.ceil(An/Gr))}(M,O,W,ie,xe,Pe),bt=M.text.indexOf("\u200B")>=0,Nt=0,Kt=0;Kt<M.length();Kt++){var Wt=M.getSection(Kt),fr=M.getCharCode(Kt);if(Uu[fr]||(Nt+=Kp(fr,Wt,ie,xe,O,Pe)),Kt<M.length()-1){var Tr=!!(!((je=fr)<11904)&&(In["Bopomofo Extended"](je)||In.Bopomofo(je)||In["CJK Compatibility Forms"](je)||In["CJK Compatibility Ideographs"](je)||In["CJK Compatibility"](je)||In["CJK Radicals Supplement"](je)||In["CJK Strokes"](je)||In["CJK Symbols and Punctuation"](je)||In["CJK Unified Ideographs Extension A"](je)||In["CJK Unified Ideographs"](je)||In["Enclosed CJK Letters and Months"](je)||In["Halfwidth and Fullwidth Forms"](je)||In.Hiragana(je)||In["Ideographic Description Characters"](je)||In["Kangxi Radicals"](je)||In["Katakana Phonetic Extensions"](je)||In.Katakana(je)||In["Vertical Forms"](je)||In["Yi Radicals"](je)||In["Yi Syllables"](je)));(vs[fr]||Tr||Wt.imageName)&&tt.push($p(Kt+1,Nt,ft,tt,xg(fr,M.getCharCode(Kt+1),Tr&&bt),!1))}}return function Br(Fr){return Fr?Br(Fr.priorBreak).concat(Fr.index):[]}($p(M.length(),Nt,ft,tt,0,!0))}function sh(M){var O=.5,W=.5;switch(M){case"right":case"top-right":case"bottom-right":O=1;break;case"left":case"top-left":case"bottom-left":O=0}switch(M){case"bottom":case"bottom-right":case"bottom-left":W=1;break;case"top":case"top-right":case"top-left":W=0}return{horizontalAlign:O,verticalAlign:W}}function bg(M,O,W,ie,xe){if(ie||xe)for(var ke=M[W],Pe=ke.metrics.advance*ke.scale,je=(M[W].x+Pe)*ie,tt=O;tt<=W;tt++)M[tt].x-=je,M[tt].y+=xe}function Qp(M,O,W,ie,xe,ke){var Pe,je=M.image;if(je.content){var tt=je.content,ft=je.pixelRatio||1;Pe=[tt[0]/ft,tt[1]/ft,je.displaySize[0]-tt[2]/ft,je.displaySize[1]-tt[3]/ft]}var bt,Nt,Kt,Wt,fr=O.left*ke,Tr=O.right*ke;W==="width"||W==="both"?(Wt=xe[0]+fr-ie[3],Nt=xe[0]+Tr+ie[1]):Nt=(Wt=xe[0]+(fr+Tr-je.displaySize[0])/2)+je.displaySize[0];var Br=O.top*ke,Fr=O.bottom*ke;return W==="height"||W==="both"?(bt=xe[1]+Br-ie[0],Kt=xe[1]+Fr+ie[2]):Kt=(bt=xe[1]+(Br+Fr-je.displaySize[1])/2)+je.displaySize[1],{image:je,top:bt,right:Nt,bottom:Kt,left:Wt,collisionPadding:Pe}}vs[10]=!0,vs[32]=!0,vs[38]=!0,vs[40]=!0,vs[41]=!0,vs[43]=!0,vs[45]=!0,vs[47]=!0,vs[173]=!0,vs[183]=!0,vs[8203]=!0,vs[8208]=!0,vs[8211]=!0,vs[8231]=!0;var Ac=function(M){function O(W,ie,xe,ke){M.call(this,W,ie),this.angle=xe,ke!==void 0&&(this.segment=ke)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.clone=function(){return new O(this.x,this.y,this.angle,this.segment)},O}(r);Qr("Anchor",Ac);function lh(M,O){var W=O.expression;if(W.kind==="constant")return{kind:"constant",layoutSize:W.evaluate(new oa(M+1))};if(W.kind==="source")return{kind:"source"};for(var ie=W.zoomStops,xe=W.interpolationType,ke=0;ke<ie.length&&ie[ke]<=M;)ke++;for(var Pe=ke=Math.max(0,ke-1);Pe<ie.length&&ie[Pe]<M+1;)Pe++;Pe=Math.min(ie.length-1,Pe);var je=ie[ke],tt=ie[Pe];return W.kind==="composite"?{kind:"composite",minZoom:je,maxZoom:tt,interpolationType:xe}:{kind:"camera",minZoom:je,maxZoom:tt,minSize:W.evaluate(new oa(je)),maxSize:W.evaluate(new oa(tt)),interpolationType:xe}}function ed(M,O,W){var ie=O.uSize,xe=O.uSizeT,ke=W.lowerSize,Pe=W.upperSize;return M.kind==="source"?ke/128:M.kind==="composite"?wn(ke/128,Pe/128,xe):ie}function td(M,O){var W=0,ie=0;if(M.kind==="constant")ie=M.layoutSize;else if(M.kind!=="source"){var xe=M.interpolationType,ke=M.minZoom,Pe=M.maxZoom,je=xe?h(Ni.interpolationFactor(xe,O,ke,Pe),0,1):0;M.kind==="camera"?ie=wn(M.minSize,M.maxSize,je):W=je}return{uSizeT:W,uSize:ie}}var _g=Object.freeze({__proto__:null,getSizeData:lh,evaluateSizeForFeature:ed,evaluateSizeForZoom:td,SIZE_PACK_FACTOR:128});function rd(M,O,W,ie,xe){if(O.segment===void 0)return!0;for(var ke=O,Pe=O.segment+1,je=0;je>-W/2;){if(--Pe<0)return!1;je-=M[Pe].dist(ke),ke=M[Pe]}je+=M[Pe].dist(M[Pe+1]),Pe++;for(var tt=[],ft=0;je<W/2;){var bt=M[Pe-1],Nt=M[Pe],Kt=M[Pe+1];if(!Kt)return!1;var Wt=bt.angleTo(Nt)-Nt.angleTo(Kt);for(Wt=Math.abs((Wt+3*Math.PI)%(2*Math.PI)-Math.PI),tt.push({distance:je,angleDelta:Wt}),ft+=Wt;je-tt[0].distance>ie;)ft-=tt.shift().angleDelta;if(ft>xe)return!1;Pe++,je+=Nt.dist(Kt)}return!0}function nd(M){for(var O=0,W=0;W<M.length-1;W++)O+=M[W].dist(M[W+1]);return O}function id(M,O,W){return M?.6*O*W:0}function ad(M,O){return Math.max(M?M.right-M.left:0,O?O.right-O.left:0)}function wg(M,O,W,ie,xe,ke){for(var Pe=id(W,xe,ke),je=ad(W,ie)*ke,tt=0,ft=nd(M)/2,bt=0;bt<M.length-1;bt++){var Nt=M[bt],Kt=M[bt+1],Wt=Nt.dist(Kt);if(tt+Wt>ft){var fr=(ft-tt)/Wt,Tr=wn(Nt.x,Kt.x,fr),Br=wn(Nt.y,Kt.y,fr),Fr=new Ac(Tr,Br,Kt.angleTo(Nt),bt);return Fr._round(),!Pe||rd(M,Fr,je,Pe,O)?Fr:void 0}tt+=Wt}}function Tg(M,O,W,ie,xe,ke,Pe,je,tt){var ft=id(ie,ke,Pe),bt=ad(ie,xe),Nt=bt*Pe,Kt=M[0].x===0||M[0].x===tt||M[0].y===0||M[0].y===tt;return O-Nt<O/4&&(O=Nt+O/4),function Wt(fr,Tr,Br,Fr,Gr,Wr,Jr,gn,An){for(var Un=Wr/2,jn=nd(fr),Zn=0,li=Tr-Br,ci=[],Qn=0;Qn<fr.length-1;Qn++){for(var mi=fr[Qn],pi=fr[Qn+1],ui=mi.dist(pi),Qi=pi.angleTo(mi);li+Br<Zn+ui;){var qi=((li+=Br)-Zn)/ui,ia=wn(mi.x,pi.x,qi),Ti=wn(mi.y,pi.y,qi);if(ia>=0&&ia<An&&Ti>=0&&Ti<An&&li-Un>=0&&li+Un<=jn){var Yi=new Ac(ia,Ti,Qi,Qn);Yi._round(),Fr&&!rd(fr,Yi,Wr,Fr,Gr)||ci.push(Yi)}}Zn+=ui}return gn||ci.length||Jr||(ci=Wt(fr,Zn/2,Br,Fr,Gr,Wr,Jr,!0,An)),ci}(M,Kt?O/2*je%O:(bt/2+2*ke)*Pe*je%O,O,ft,W,Nt,Kt,!1,tt)}function od(M,O,W,ie,xe){for(var ke=[],Pe=0;Pe<M.length;Pe++)for(var je=M[Pe],tt=void 0,ft=0;ft<je.length-1;ft++){var bt=je[ft],Nt=je[ft+1];bt.x<O&&Nt.x<O||(bt.x<O?bt=new r(O,bt.y+(Nt.y-bt.y)*((O-bt.x)/(Nt.x-bt.x)))._round():Nt.x<O&&(Nt=new r(O,bt.y+(Nt.y-bt.y)*((O-bt.x)/(Nt.x-bt.x)))._round()),bt.y<W&&Nt.y<W||(bt.y<W?bt=new r(bt.x+(Nt.x-bt.x)*((W-bt.y)/(Nt.y-bt.y)),W)._round():Nt.y<W&&(Nt=new r(bt.x+(Nt.x-bt.x)*((W-bt.y)/(Nt.y-bt.y)),W)._round()),bt.x>=ie&&Nt.x>=ie||(bt.x>=ie?bt=new r(ie,bt.y+(Nt.y-bt.y)*((ie-bt.x)/(Nt.x-bt.x)))._round():Nt.x>=ie&&(Nt=new r(ie,bt.y+(Nt.y-bt.y)*((ie-bt.x)/(Nt.x-bt.x)))._round()),bt.y>=xe&&Nt.y>=xe||(bt.y>=xe?bt=new r(bt.x+(Nt.x-bt.x)*((xe-bt.y)/(Nt.y-bt.y)),xe)._round():Nt.y>=xe&&(Nt=new r(bt.x+(Nt.x-bt.x)*((xe-bt.y)/(Nt.y-bt.y)),xe)._round()),tt&&bt.equals(tt[tt.length-1])||(tt=[bt],ke.push(tt)),tt.push(Nt)))))}return ke}function sd(M,O,W,ie){var xe=[],ke=M.image,Pe=ke.pixelRatio,je=ke.paddedRect.w-2,tt=ke.paddedRect.h-2,ft=M.right-M.left,bt=M.bottom-M.top,Nt=ke.stretchX||[[0,je]],Kt=ke.stretchY||[[0,tt]],Wt=function(Yi,wa){return Yi+wa[1]-wa[0]},fr=Nt.reduce(Wt,0),Tr=Kt.reduce(Wt,0),Br=je-fr,Fr=tt-Tr,Gr=0,Wr=fr,Jr=0,gn=Tr,An=0,Un=Br,jn=0,Zn=Fr;if(ke.content&&ie){var li=ke.content;Gr=Vu(Nt,0,li[0]),Jr=Vu(Kt,0,li[1]),Wr=Vu(Nt,li[0],li[2]),gn=Vu(Kt,li[1],li[3]),An=li[0]-Gr,jn=li[1]-Jr,Un=li[2]-li[0]-Wr,Zn=li[3]-li[1]-gn}var ci=function(Yi,wa,ma,Oa){var ga=Hu(Yi.stretch-Gr,Wr,ft,M.left),mo=qu(Yi.fixed-An,Un,Yi.stretch,fr),Da=Hu(wa.stretch-Jr,gn,bt,M.top),Vo=qu(wa.fixed-jn,Zn,wa.stretch,Tr),Co=Hu(ma.stretch-Gr,Wr,ft,M.left),Oo=qu(ma.fixed-An,Un,ma.stretch,fr),es=Hu(Oa.stretch-Jr,gn,bt,M.top),Yo=qu(Oa.fixed-jn,Zn,Oa.stretch,Tr),go=new r(ga,Da),Do=new r(Co,Da),ro=new r(Co,es),_o=new r(ga,es),Bi=new r(mo/Pe,Vo/Pe),ta=new r(Oo/Pe,Yo/Pe),Wa=O*Math.PI/180;if(Wa){var Za=Math.sin(Wa),Ha=Math.cos(Wa),za=[Ha,-Za,Za,Ha];go._matMult(za),Do._matMult(za),_o._matMult(za),ro._matMult(za)}var la=Yi.stretch+Yi.fixed,Xa=ma.stretch+ma.fixed,ts=wa.stretch+wa.fixed,ys=Oa.stretch+Oa.fixed;return{tl:go,tr:Do,bl:_o,br:ro,tex:{x:ke.paddedRect.x+1+la,y:ke.paddedRect.y+1+ts,w:Xa-la,h:ys-ts},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Bi,pixelOffsetBR:ta,minFontScaleX:Un/Pe/ft,minFontScaleY:Zn/Pe/bt,isSDF:W}};if(ie&&(ke.stretchX||ke.stretchY))for(var Qn=ld(Nt,Br,fr),mi=ld(Kt,Fr,Tr),pi=0;pi<Qn.length-1;pi++)for(var ui=Qn[pi],Qi=Qn[pi+1],qi=0;qi<mi.length-1;qi++){var ia=mi[qi],Ti=mi[qi+1];xe.push(ci(ui,ia,Qi,Ti))}else xe.push(ci({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:je+1},{fixed:0,stretch:tt+1}));return xe}function Vu(M,O,W){for(var ie=0,xe=0,ke=M;xe<ke.length;xe+=1){var Pe=ke[xe];ie+=Math.max(O,Math.min(W,Pe[1]))-Math.max(O,Math.min(W,Pe[0]))}return ie}function ld(M,O,W){for(var ie=[{fixed:-1,stretch:0}],xe=0,ke=M;xe<ke.length;xe+=1){var Pe=ke[xe],je=Pe[0],tt=Pe[1],ft=ie[ie.length-1];ie.push({fixed:je-ft.stretch,stretch:ft.stretch}),ie.push({fixed:je-ft.stretch,stretch:ft.stretch+(tt-je)})}return ie.push({fixed:O+1,stretch:W}),ie}function Hu(M,O,W,ie){return M/O*W+ie}function qu(M,O,W,ie){return M-O*W/ie}var Gu=function(M,O,W,ie,xe,ke,Pe,je,tt,ft){if(this.boxStartIndex=M.length,tt){var bt=ke.top,Nt=ke.bottom,Kt=ke.collisionPadding;Kt&&(bt-=Kt[1],Nt+=Kt[3]);var Wt=Nt-bt;Wt>0&&(Wt=Math.max(10,Wt),this.circleDiameter=Wt)}else{var fr=ke.top*Pe-je,Tr=ke.bottom*Pe+je,Br=ke.left*Pe-je,Fr=ke.right*Pe+je,Gr=ke.collisionPadding;if(Gr&&(Br-=Gr[0]*Pe,fr-=Gr[1]*Pe,Fr+=Gr[2]*Pe,Tr+=Gr[3]*Pe),ft){var Wr=new r(Br,fr),Jr=new r(Fr,fr),gn=new r(Br,Tr),An=new r(Fr,Tr),Un=ft*Math.PI/180;Wr._rotate(Un),Jr._rotate(Un),gn._rotate(Un),An._rotate(Un),Br=Math.min(Wr.x,Jr.x,gn.x,An.x),Fr=Math.max(Wr.x,Jr.x,gn.x,An.x),fr=Math.min(Wr.y,Jr.y,gn.y,An.y),Tr=Math.max(Wr.y,Jr.y,gn.y,An.y)}M.emplaceBack(O.x,O.y,Br,fr,Fr,Tr,W,ie,xe)}this.boxEndIndex=M.length},Sc=function(M,O){if(M===void 0&&(M=[]),O===void 0&&(O=kg),this.data=M,this.length=this.data.length,this.compare=O,this.length>0)for(var W=(this.length>>1)-1;W>=0;W--)this._down(W)};function kg(M,O){return M<O?-1:M>O?1:0}function Mg(M,O,W){O===void 0&&(O=1),W===void 0&&(W=!1);for(var ie=1/0,xe=1/0,ke=-1/0,Pe=-1/0,je=M[0],tt=0;tt<je.length;tt++){var ft=je[tt];(!tt||ft.x<ie)&&(ie=ft.x),(!tt||ft.y<xe)&&(xe=ft.y),(!tt||ft.x>ke)&&(ke=ft.x),(!tt||ft.y>Pe)&&(Pe=ft.y)}var bt=ke-ie,Nt=Pe-xe,Kt=Math.min(bt,Nt),Wt=Kt/2,fr=new Sc([],Ag);if(Kt===0)return new r(ie,xe);for(var Tr=ie;Tr<ke;Tr+=Kt)for(var Br=xe;Br<Pe;Br+=Kt)fr.push(new Ec(Tr+Wt,Br+Wt,Wt,M));for(var Fr=function(Jr){for(var gn=0,An=0,Un=0,jn=Jr[0],Zn=0,li=jn.length,ci=li-1;Zn<li;ci=Zn++){var Qn=jn[Zn],mi=jn[ci],pi=Qn.x*mi.y-mi.x*Qn.y;An+=(Qn.x+mi.x)*pi,Un+=(Qn.y+mi.y)*pi,gn+=3*pi}return new Ec(An/gn,Un/gn,0,Jr)}(M),Gr=fr.length;fr.length;){var Wr=fr.pop();(Wr.d>Fr.d||!Fr.d)&&(Fr=Wr,W&&console.log("found best %d after %d probes",Math.round(1e4*Wr.d)/1e4,Gr)),Wr.max-Fr.d<=O||(Wt=Wr.h/2,fr.push(new Ec(Wr.p.x-Wt,Wr.p.y-Wt,Wt,M)),fr.push(new Ec(Wr.p.x+Wt,Wr.p.y-Wt,Wt,M)),fr.push(new Ec(Wr.p.x-Wt,Wr.p.y+Wt,Wt,M)),fr.push(new Ec(Wr.p.x+Wt,Wr.p.y+Wt,Wt,M)),Gr+=4)}return W&&(console.log("num probes: "+Gr),console.log("best distance: "+Fr.d)),Fr.p}function Ag(M,O){return O.max-M.max}function Ec(M,O,W,ie){this.p=new r(M,O),this.h=W,this.d=function(xe,ke){for(var Pe=!1,je=1/0,tt=0;tt<ke.length;tt++)for(var ft=ke[tt],bt=0,Nt=ft.length,Kt=Nt-1;bt<Nt;Kt=bt++){var Wt=ft[bt],fr=ft[Kt];Wt.y>xe.y!=fr.y>xe.y&&xe.x<(fr.x-Wt.x)*(xe.y-Wt.y)/(fr.y-Wt.y)+Wt.x&&(Pe=!Pe),je=Math.min(je,bl(xe,Wt,fr))}return(Pe?1:-1)*Math.sqrt(je)}(this.p,ie),this.max=this.d+this.h*Math.SQRT2}Sc.prototype.push=function(M){this.data.push(M),this.length++,this._up(this.length-1)},Sc.prototype.pop=function(){if(this.length!==0){var M=this.data[0],O=this.data.pop();return this.length--,this.length>0&&(this.data[0]=O,this._down(0)),M}},Sc.prototype.peek=function(){return this.data[0]},Sc.prototype._up=function(M){for(var O=this.data,W=this.compare,ie=O[M];M>0;){var xe=M-1>>1,ke=O[xe];if(W(ie,ke)>=0)break;O[M]=ke,M=xe}O[M]=ie},Sc.prototype._down=function(M){for(var O=this.data,W=this.compare,ie=this.length>>1,xe=O[M];M<ie;){var ke=1+(M<<1),Pe=O[ke],je=ke+1;if(je<this.length&&W(O[je],Pe)<0&&(ke=je,Pe=O[je]),W(Pe,xe)>=0)break;O[M]=Pe,M=ke}O[M]=xe};var ch=Number.POSITIVE_INFINITY;function cd(M,O){return O[1]!==ch?function(W,ie,xe){var ke=0,Pe=0;switch(ie=Math.abs(ie),xe=Math.abs(xe),W){case"top-right":case"top-left":case"top":Pe=xe-7;break;case"bottom-right":case"bottom-left":case"bottom":Pe=7-xe}switch(W){case"top-right":case"bottom-right":case"right":ke=-ie;break;case"top-left":case"bottom-left":case"left":ke=ie}return[ke,Pe]}(M,O[0],O[1]):function(W,ie){var xe=0,ke=0;ie<0&&(ie=0);var Pe=ie/Math.sqrt(2);switch(W){case"top-right":case"top-left":ke=Pe-7;break;case"bottom-right":case"bottom-left":ke=7-Pe;break;case"bottom":ke=7-ie;break;case"top":ke=ie-7}switch(W){case"top-right":case"bottom-right":xe=-Pe;break;case"top-left":case"bottom-left":xe=Pe;break;case"left":xe=ie;break;case"right":xe=-ie}return[xe,ke]}(M,O[0])}function uh(M){switch(M){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ud(M,O,W,ie,xe,ke,Pe,je,tt,ft,bt,Nt,Kt,Wt,fr){var Tr=function(Jr,gn,An,Un,jn,Zn,li,ci){for(var Qn=Un.layout.get("text-rotate").evaluate(Zn,{})*Math.PI/180,mi=[],pi=0,ui=gn.positionedLines;pi<ui.length;pi+=1)for(var Qi=ui[pi],qi=0,ia=Qi.positionedGlyphs;qi<ia.length;qi+=1){var Ti=ia[qi];if(Ti.rect){var Yi=Ti.rect||{},wa=4,ma=!0,Oa=1,ga=0,mo=(jn||ci)&&Ti.vertical,Da=Ti.metrics.advance*Ti.scale/2;if(ci&&gn.verticalizable){var Vo=24*(Ti.scale-1),Co=(24-Ti.metrics.width*Ti.scale)/2;ga=Qi.lineOffset/2-(Ti.imageName?-Co:Vo)}if(Ti.imageName){var Oo=li[Ti.imageName];ma=Oo.sdf,wa=1/(Oa=Oo.pixelRatio)}var es=jn?[Ti.x+Da,Ti.y]:[0,0],Yo=jn?[0,0]:[Ti.x+Da+An[0],Ti.y+An[1]-ga],go=[0,0];mo&&(go=Yo,Yo=[0,0]);var Do=(Ti.metrics.left-wa)*Ti.scale-Da+Yo[0],ro=(-Ti.metrics.top-wa)*Ti.scale+Yo[1],_o=Do+Yi.w*Ti.scale/Oa,Bi=ro+Yi.h*Ti.scale/Oa,ta=new r(Do,ro),Wa=new r(_o,ro),Za=new r(Do,Bi),Ha=new r(_o,Bi);if(mo){var za=new r(-Da,Da- -17),la=-Math.PI/2,Xa=12-Da,ts=Ti.imageName?Xa:0,ys=new r(22-Xa,-ts),Wo=new(Function.prototype.bind.apply(r,[null].concat(go)));ta._rotateAround(la,za)._add(ys)._add(Wo),Wa._rotateAround(la,za)._add(ys)._add(Wo),Za._rotateAround(la,za)._add(ys)._add(Wo),Ha._rotateAround(la,za)._add(ys)._add(Wo)}if(Qn){var Ks=Math.sin(Qn),Ml=Math.cos(Qn),Po=[Ml,-Ks,Ks,Ml];ta._matMult(Po),Wa._matMult(Po),Za._matMult(Po),Ha._matMult(Po)}var Js=new r(0,0),$s=new r(0,0);mi.push({tl:ta,tr:Wa,bl:Za,br:Ha,tex:Yi,writingMode:gn.writingMode,glyphOffset:es,sectionIndex:Ti.sectionIndex,isSDF:ma,pixelOffsetTL:Js,pixelOffsetBR:$s,minFontScaleX:0,minFontScaleY:0})}}return mi}(0,W,je,xe,ke,Pe,ie,M.allowVerticalPlacement),Br=M.textSizeData,Fr=null;Br.kind==="source"?(Fr=[128*xe.layout.get("text-size").evaluate(Pe,{})])[0]>32640&&A(M.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):Br.kind==="composite"&&((Fr=[128*Wt.compositeTextSizes[0].evaluate(Pe,{},fr),128*Wt.compositeTextSizes[1].evaluate(Pe,{},fr)])[0]>32640||Fr[1]>32640)&&A(M.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),M.addSymbols(M.text,Tr,Fr,je,ke,Pe,ft,O,tt.lineStartIndex,tt.lineLength,Kt,fr);for(var Gr=0,Wr=bt;Gr<Wr.length;Gr+=1)Nt[Wr[Gr]]=M.text.placedSymbolArray.length-1;return 4*Tr.length}function fd(M){for(var O in M)return M[O];return null}function Sg(M,O,W,ie){var xe=M.compareText;if(O in xe){for(var ke=xe[O],Pe=ke.length-1;Pe>=0;Pe--)if(ie.dist(ke[Pe])<W)return!0}else xe[O]=[];return xe[O].push(ie),!1}var Eg=wc.VectorTileFeature.types,Lg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Yu(M,O,W,ie,xe,ke,Pe,je,tt,ft,bt,Nt,Kt){var Wt=je?Math.min(32640,Math.round(je[0])):0,fr=je?Math.min(32640,Math.round(je[1])):0;M.emplaceBack(O,W,Math.round(32*ie),Math.round(32*xe),ke,Pe,(Wt<<1)+(tt?1:0),fr,16*ft,16*bt,256*Nt,256*Kt)}function fh(M,O,W){M.emplaceBack(O.x,O.y,W),M.emplaceBack(O.x,O.y,W),M.emplaceBack(O.x,O.y,W),M.emplaceBack(O.x,O.y,W)}function Cg(M){for(var O=0,W=M.sections;O<W.length;O+=1)if(ai(W[O].text))return!0;return!1}var Lc=function(M){this.layoutVertexArray=new Ys,this.indexArray=new uo,this.programConfigurations=M,this.segments=new Bt,this.dynamicLayoutVertexArray=new ws,this.opacityVertexArray=new zl,this.placedSymbolArray=new qe};Lc.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Lc.prototype.upload=function(M,O,W,ie){this.isEmpty()||(W&&(this.layoutVertexBuffer=M.createVertexBuffer(this.layoutVertexArray,ah.members),this.indexBuffer=M.createIndexBuffer(this.indexArray,O),this.dynamicLayoutVertexBuffer=M.createVertexBuffer(this.dynamicLayoutVertexArray,ng.members,!0),this.opacityVertexBuffer=M.createVertexBuffer(this.opacityVertexArray,Lg,!0),this.opacityVertexBuffer.itemSize=1),(W||ie)&&this.programConfigurations.upload(M))},Lc.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Qr("SymbolBuffers",Lc);var fu=function(M,O,W){this.layoutVertexArray=new M,this.layoutAttributes=O,this.indexArray=new W,this.segments=new Bt,this.collisionVertexArray=new Ws};fu.prototype.upload=function(M){this.layoutVertexBuffer=M.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=M.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=M.createVertexBuffer(this.collisionVertexArray,ig.members,!0)},fu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Qr("CollisionBuffers",fu);var ha=function(M){this.collisionBoxArray=M.collisionBoxArray,this.zoom=M.zoom,this.overscaling=M.overscaling,this.layers=M.layers,this.layerIds=this.layers.map(function(Pe){return Pe.id}),this.index=M.index,this.pixelRatio=M.pixelRatio,this.sourceLayerIndex=M.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=eu([]),this.placementViewportMatrix=eu([]);var O=this.layers[0]._unevaluatedLayout._values;this.textSizeData=lh(this.zoom,O["text-size"]),this.iconSizeData=lh(this.zoom,O["icon-size"]);var W=this.layers[0].layout,ie=W.get("symbol-sort-key"),xe=W.get("symbol-z-order");this.sortFeaturesByKey=xe!=="viewport-y"&&ie.constantOr(1)!==void 0;var ke=xe==="viewport-y"||xe==="auto"&&!this.sortFeaturesByKey;this.sortFeaturesByY=ke&&(W.get("text-allow-overlap")||W.get("icon-allow-overlap")||W.get("text-ignore-placement")||W.get("icon-ignore-placement")),W.get("symbol-placement")==="point"&&(this.writingModes=W.get("text-writing-mode").map(function(Pe){return Ts[Pe]})),this.stateDependentLayerIds=this.layers.filter(function(Pe){return Pe.isStateDependent()}).map(function(Pe){return Pe.id}),this.sourceID=M.sourceID};ha.prototype.createArrays=function(){this.text=new Lc(new da(ah.members,this.layers,this.zoom,function(M){return/^text/.test(M)})),this.icon=new Lc(new da(ah.members,this.layers,this.zoom,function(M){return/^icon/.test(M)})),this.glyphOffsetArray=new kt,this.lineVertexArray=new Pt,this.symbolInstances=new st},ha.prototype.calculateGlyphDependencies=function(M,O,W,ie,xe){for(var ke=0;ke<M.length;ke++)if(O[M.charCodeAt(ke)]=!0,(W||ie)&&xe){var Pe=lu[M.charAt(ke)];Pe&&(O[Pe.charCodeAt(0)]=!0)}},ha.prototype.populate=function(M,O,W){var ie=this.layers[0],xe=ie.layout,ke=xe.get("text-font"),Pe=xe.get("text-field"),je=xe.get("icon-image"),tt=(Pe.value.kind!=="constant"||Pe.value.value instanceof dr&&!Pe.value.value.isEmpty()||Pe.value.value.toString().length>0)&&(ke.value.kind!=="constant"||ke.value.value.length>0),ft=je.value.kind!=="constant"||!!je.value.value||Object.keys(je.parameters).length>0,bt=xe.get("symbol-sort-key");if(this.features=[],tt||ft){for(var Nt=O.iconDependencies,Kt=O.glyphDependencies,Wt=O.availableImages,fr=new oa(this.zoom),Tr=0,Br=M;Tr<Br.length;Tr+=1){var Fr=Br[Tr],Gr=Fr.feature,Wr=Fr.id,Jr=Fr.index,gn=Fr.sourceLayerIndex,An=ie._featureFilter.needGeometry,Un={type:Gr.type,id:Wr,properties:Gr.properties,geometry:An?ba(Gr):[]};if(ie._featureFilter.filter(fr,Un,W)){An||(Un.geometry=ba(Gr));var jn=void 0;if(tt){var Zn=ie.getValueAndResolveTokens("text-field",Un,W,Wt),li=dr.factory(Zn);Cg(li)&&(this.hasRTLText=!0),(!this.hasRTLText||$a()==="unavailable"||this.hasRTLText&&bo.isParsed())&&(jn=og(li,ie,Un))}var ci=void 0;if(ft){var Qn=ie.getValueAndResolveTokens("icon-image",Un,W,Wt);ci=Qn instanceof _r?Qn:_r.fromString(Qn)}if(jn||ci){var mi=this.sortFeaturesByKey?bt.evaluate(Un,{},W):void 0,pi={id:Wr,text:jn,icon:ci,index:Jr,sourceLayerIndex:gn,geometry:ba(Gr),properties:Gr.properties,type:Eg[Gr.type],sortKey:mi};if(this.features.push(pi),ci&&(Nt[ci.name]=!0),jn){var ui=ke.evaluate(Un,{},W).join(","),Qi=xe.get("text-rotation-alignment")==="map"&&xe.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ts.vertical)>=0;for(var qi=0,ia=jn.sections;qi<ia.length;qi+=1){var Ti=ia[qi];if(Ti.image)Nt[Ti.image.name]=!0;else{var Yi=Ri(jn.toString()),wa=Ti.fontStack||ui,ma=Kt[wa]=Kt[wa]||{};this.calculateGlyphDependencies(Ti.text,ma,Qi,this.allowVerticalPlacement,Yi)}}}}}}xe.get("symbol-placement")==="line"&&(this.features=function(Oa){var ga={},mo={},Da=[],Vo=0;function Co(Ha){Da.push(Oa[Ha]),Vo++}function Oo(Ha,za,la){var Xa=mo[Ha];return delete mo[Ha],mo[za]=Xa,Da[Xa].geometry[0].pop(),Da[Xa].geometry[0]=Da[Xa].geometry[0].concat(la[0]),Xa}function es(Ha,za,la){var Xa=ga[za];return delete ga[za],ga[Ha]=Xa,Da[Xa].geometry[0].shift(),Da[Xa].geometry[0]=la[0].concat(Da[Xa].geometry[0]),Xa}function Yo(Ha,za,la){var Xa=la?za[0][za[0].length-1]:za[0][0];return Ha+":"+Xa.x+":"+Xa.y}for(var go=0;go<Oa.length;go++){var Do=Oa[go],ro=Do.geometry,_o=Do.text?Do.text.toString():null;if(_o){var Bi=Yo(_o,ro),ta=Yo(_o,ro,!0);if(Bi in mo&&ta in ga&&mo[Bi]!==ga[ta]){var Wa=es(Bi,ta,ro),Za=Oo(Bi,ta,Da[Wa].geometry);delete ga[Bi],delete mo[ta],mo[Yo(_o,Da[Za].geometry,!0)]=Za,Da[Wa].geometry=null}else Bi in mo?Oo(Bi,ta,ro):ta in ga?es(Bi,ta,ro):(Co(go),ga[Bi]=Vo-1,mo[ta]=Vo-1)}else Co(go)}return Da.filter(function(Ha){return Ha.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Oa,ga){return Oa.sortKey-ga.sortKey})}},ha.prototype.update=function(M,O,W){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(M,O,this.layers,W),this.icon.programConfigurations.updatePaintArrays(M,O,this.layers,W))},ha.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},ha.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},ha.prototype.upload=function(M){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(M),this.iconCollisionBox.upload(M)),this.text.upload(M,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(M,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},ha.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},ha.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},ha.prototype.addToLineVertexArray=function(M,O){var W=this.lineVertexArray.length;if(M.segment!==void 0){for(var ie=M.dist(O[M.segment+1]),xe=M.dist(O[M.segment]),ke={},Pe=M.segment+1;Pe<O.length;Pe++)ke[Pe]={x:O[Pe].x,y:O[Pe].y,tileUnitDistanceFromAnchor:ie},Pe<O.length-1&&(ie+=O[Pe+1].dist(O[Pe]));for(var je=M.segment||0;je>=0;je--)ke[je]={x:O[je].x,y:O[je].y,tileUnitDistanceFromAnchor:xe},je>0&&(xe+=O[je-1].dist(O[je]));for(var tt=0;tt<O.length;tt++){var ft=ke[tt];this.lineVertexArray.emplaceBack(ft.x,ft.y,ft.tileUnitDistanceFromAnchor)}}return{lineStartIndex:W,lineLength:this.lineVertexArray.length-W}},ha.prototype.addSymbols=function(M,O,W,ie,xe,ke,Pe,je,tt,ft,bt,Nt){for(var Kt=M.indexArray,Wt=M.layoutVertexArray,fr=M.segments.prepareSegment(4*O.length,Wt,Kt,ke.sortKey),Tr=this.glyphOffsetArray.length,Br=fr.vertexLength,Fr=this.allowVerticalPlacement&&Pe===Ts.vertical?Math.PI/2:0,Gr=ke.text&&ke.text.sections,Wr=0;Wr<O.length;Wr++){var Jr=O[Wr],gn=Jr.tl,An=Jr.tr,Un=Jr.bl,jn=Jr.br,Zn=Jr.tex,li=Jr.pixelOffsetTL,ci=Jr.pixelOffsetBR,Qn=Jr.minFontScaleX,mi=Jr.minFontScaleY,pi=Jr.glyphOffset,ui=Jr.isSDF,Qi=Jr.sectionIndex,qi=fr.vertexLength,ia=pi[1];Yu(Wt,je.x,je.y,gn.x,ia+gn.y,Zn.x,Zn.y,W,ui,li.x,li.y,Qn,mi),Yu(Wt,je.x,je.y,An.x,ia+An.y,Zn.x+Zn.w,Zn.y,W,ui,ci.x,li.y,Qn,mi),Yu(Wt,je.x,je.y,Un.x,ia+Un.y,Zn.x,Zn.y+Zn.h,W,ui,li.x,ci.y,Qn,mi),Yu(Wt,je.x,je.y,jn.x,ia+jn.y,Zn.x+Zn.w,Zn.y+Zn.h,W,ui,ci.x,ci.y,Qn,mi),fh(M.dynamicLayoutVertexArray,je,Fr),Kt.emplaceBack(qi,qi+1,qi+2),Kt.emplaceBack(qi+1,qi+2,qi+3),fr.vertexLength+=4,fr.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(pi[0]),Wr!==O.length-1&&Qi===O[Wr+1].sectionIndex||M.programConfigurations.populatePaintArrays(Wt.length,ke,ke.index,{},Nt,Gr&&Gr[Qi])}M.placedSymbolArray.emplaceBack(je.x,je.y,Tr,this.glyphOffsetArray.length-Tr,Br,tt,ft,je.segment,W?W[0]:0,W?W[1]:0,ie[0],ie[1],Pe,0,!1,0,bt)},ha.prototype._addCollisionDebugVertex=function(M,O,W,ie,xe,ke){return O.emplaceBack(0,0),M.emplaceBack(W.x,W.y,ie,xe,Math.round(ke.x),Math.round(ke.y))},ha.prototype.addCollisionDebugVertices=function(M,O,W,ie,xe,ke,Pe){var je=xe.segments.prepareSegment(4,xe.layoutVertexArray,xe.indexArray),tt=je.vertexLength,ft=xe.layoutVertexArray,bt=xe.collisionVertexArray,Nt=Pe.anchorX,Kt=Pe.anchorY;this._addCollisionDebugVertex(ft,bt,ke,Nt,Kt,new r(M,O)),this._addCollisionDebugVertex(ft,bt,ke,Nt,Kt,new r(W,O)),this._addCollisionDebugVertex(ft,bt,ke,Nt,Kt,new r(W,ie)),this._addCollisionDebugVertex(ft,bt,ke,Nt,Kt,new r(M,ie)),je.vertexLength+=4;var Wt=xe.indexArray;Wt.emplaceBack(tt,tt+1),Wt.emplaceBack(tt+1,tt+2),Wt.emplaceBack(tt+2,tt+3),Wt.emplaceBack(tt+3,tt),je.primitiveLength+=4},ha.prototype.addDebugCollisionBoxes=function(M,O,W,ie){for(var xe=M;xe<O;xe++){var ke=this.collisionBoxArray.get(xe),Pe=ke.x1,je=ke.y1,tt=ke.x2,ft=ke.y2;this.addCollisionDebugVertices(Pe,je,tt,ft,ie?this.textCollisionBox:this.iconCollisionBox,ke.anchorPoint,W)}},ha.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new fu(Ps,Hp.members,F),this.iconCollisionBox=new fu(Ps,Hp.members,F);for(var M=0;M<this.symbolInstances.length;M++){var O=this.symbolInstances.get(M);this.addDebugCollisionBoxes(O.textBoxStartIndex,O.textBoxEndIndex,O,!0),this.addDebugCollisionBoxes(O.verticalTextBoxStartIndex,O.verticalTextBoxEndIndex,O,!0),this.addDebugCollisionBoxes(O.iconBoxStartIndex,O.iconBoxEndIndex,O,!1),this.addDebugCollisionBoxes(O.verticalIconBoxStartIndex,O.verticalIconBoxEndIndex,O,!1)}},ha.prototype._deserializeCollisionBoxesForSymbol=function(M,O,W,ie,xe,ke,Pe,je,tt){for(var ft={},bt=O;bt<W;bt++){var Nt=M.get(bt);ft.textBox={x1:Nt.x1,y1:Nt.y1,x2:Nt.x2,y2:Nt.y2,anchorPointX:Nt.anchorPointX,anchorPointY:Nt.anchorPointY},ft.textFeatureIndex=Nt.featureIndex;break}for(var Kt=ie;Kt<xe;Kt++){var Wt=M.get(Kt);ft.verticalTextBox={x1:Wt.x1,y1:Wt.y1,x2:Wt.x2,y2:Wt.y2,anchorPointX:Wt.anchorPointX,anchorPointY:Wt.anchorPointY},ft.verticalTextFeatureIndex=Wt.featureIndex;break}for(var fr=ke;fr<Pe;fr++){var Tr=M.get(fr);ft.iconBox={x1:Tr.x1,y1:Tr.y1,x2:Tr.x2,y2:Tr.y2,anchorPointX:Tr.anchorPointX,anchorPointY:Tr.anchorPointY},ft.iconFeatureIndex=Tr.featureIndex;break}for(var Br=je;Br<tt;Br++){var Fr=M.get(Br);ft.verticalIconBox={x1:Fr.x1,y1:Fr.y1,x2:Fr.x2,y2:Fr.y2,anchorPointX:Fr.anchorPointX,anchorPointY:Fr.anchorPointY},ft.verticalIconFeatureIndex=Fr.featureIndex;break}return ft},ha.prototype.deserializeCollisionBoxes=function(M){this.collisionArrays=[];for(var O=0;O<this.symbolInstances.length;O++){var W=this.symbolInstances.get(O);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(M,W.textBoxStartIndex,W.textBoxEndIndex,W.verticalTextBoxStartIndex,W.verticalTextBoxEndIndex,W.iconBoxStartIndex,W.iconBoxEndIndex,W.verticalIconBoxStartIndex,W.verticalIconBoxEndIndex))}},ha.prototype.hasTextData=function(){return this.text.segments.get().length>0},ha.prototype.hasIconData=function(){return this.icon.segments.get().length>0},ha.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},ha.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},ha.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},ha.prototype.addIndicesForPlacedSymbol=function(M,O){for(var W=M.placedSymbolArray.get(O),ie=W.vertexStartIndex+4*W.numGlyphs,xe=W.vertexStartIndex;xe<ie;xe+=4)M.indexArray.emplaceBack(xe,xe+1,xe+2),M.indexArray.emplaceBack(xe+1,xe+2,xe+3)},ha.prototype.getSortedSymbolIndexes=function(M){if(this.sortedAngle===M&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var O=Math.sin(M),W=Math.cos(M),ie=[],xe=[],ke=[],Pe=0;Pe<this.symbolInstances.length;++Pe){ke.push(Pe);var je=this.symbolInstances.get(Pe);ie.push(0|Math.round(O*je.anchorX+W*je.anchorY)),xe.push(je.featureIndex)}return ke.sort(function(tt,ft){return ie[tt]-ie[ft]||xe[ft]-xe[tt]}),ke},ha.prototype.addToSortKeyRanges=function(M,O){var W=this.sortKeyRanges[this.sortKeyRanges.length-1];W&&W.sortKey===O?W.symbolInstanceEnd=M+1:this.sortKeyRanges.push({sortKey:O,symbolInstanceStart:M,symbolInstanceEnd:M+1})},ha.prototype.sortFeatures=function(M){var O=this;if(this.sortFeaturesByY&&this.sortedAngle!==M&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(M),this.sortedAngle=M,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var W=0,ie=this.symbolInstanceIndexes;W<ie.length;W+=1){var xe=ie[W],ke=this.symbolInstances.get(xe);this.featureSortOrder.push(ke.featureIndex),[ke.rightJustifiedTextSymbolIndex,ke.centerJustifiedTextSymbolIndex,ke.leftJustifiedTextSymbolIndex].forEach(function(Pe,je,tt){Pe>=0&&tt.indexOf(Pe)===je&&O.addIndicesForPlacedSymbol(O.text,Pe)}),ke.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,ke.verticalPlacedTextSymbolIndex),ke.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,ke.placedIconSymbolIndex),ke.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,ke.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Qr("SymbolBucket",ha,{omit:["layers","collisionBoxArray","features","compareText"]}),ha.MAX_GLYPHS=65535,ha.addDynamicAttributes=fh;var Pg=new No({"symbol-placement":new fi(_e.layout_symbol["symbol-placement"]),"symbol-spacing":new fi(_e.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new fi(_e.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new bi(_e.layout_symbol["symbol-sort-key"]),"symbol-z-order":new fi(_e.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new fi(_e.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new fi(_e.layout_symbol["icon-ignore-placement"]),"icon-optional":new fi(_e.layout_symbol["icon-optional"]),"icon-rotation-alignment":new fi(_e.layout_symbol["icon-rotation-alignment"]),"icon-size":new bi(_e.layout_symbol["icon-size"]),"icon-text-fit":new fi(_e.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new fi(_e.layout_symbol["icon-text-fit-padding"]),"icon-image":new bi(_e.layout_symbol["icon-image"]),"icon-rotate":new bi(_e.layout_symbol["icon-rotate"]),"icon-padding":new fi(_e.layout_symbol["icon-padding"]),"icon-keep-upright":new fi(_e.layout_symbol["icon-keep-upright"]),"icon-offset":new bi(_e.layout_symbol["icon-offset"]),"icon-anchor":new bi(_e.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new fi(_e.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new fi(_e.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new fi(_e.layout_symbol["text-rotation-alignment"]),"text-field":new bi(_e.layout_symbol["text-field"]),"text-font":new bi(_e.layout_symbol["text-font"]),"text-size":new bi(_e.layout_symbol["text-size"]),"text-max-width":new bi(_e.layout_symbol["text-max-width"]),"text-line-height":new fi(_e.layout_symbol["text-line-height"]),"text-letter-spacing":new bi(_e.layout_symbol["text-letter-spacing"]),"text-justify":new bi(_e.layout_symbol["text-justify"]),"text-radial-offset":new bi(_e.layout_symbol["text-radial-offset"]),"text-variable-anchor":new fi(_e.layout_symbol["text-variable-anchor"]),"text-anchor":new bi(_e.layout_symbol["text-anchor"]),"text-max-angle":new fi(_e.layout_symbol["text-max-angle"]),"text-writing-mode":new fi(_e.layout_symbol["text-writing-mode"]),"text-rotate":new bi(_e.layout_symbol["text-rotate"]),"text-padding":new fi(_e.layout_symbol["text-padding"]),"text-keep-upright":new fi(_e.layout_symbol["text-keep-upright"]),"text-transform":new bi(_e.layout_symbol["text-transform"]),"text-offset":new bi(_e.layout_symbol["text-offset"]),"text-allow-overlap":new fi(_e.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new fi(_e.layout_symbol["text-ignore-placement"]),"text-optional":new fi(_e.layout_symbol["text-optional"])}),hh={paint:new No({"icon-opacity":new bi(_e.paint_symbol["icon-opacity"]),"icon-color":new bi(_e.paint_symbol["icon-color"]),"icon-halo-color":new bi(_e.paint_symbol["icon-halo-color"]),"icon-halo-width":new bi(_e.paint_symbol["icon-halo-width"]),"icon-halo-blur":new bi(_e.paint_symbol["icon-halo-blur"]),"icon-translate":new fi(_e.paint_symbol["icon-translate"]),"icon-translate-anchor":new fi(_e.paint_symbol["icon-translate-anchor"]),"text-opacity":new bi(_e.paint_symbol["text-opacity"]),"text-color":new bi(_e.paint_symbol["text-color"],{runtimeType:Mt,getOverride:function(M){return M.textColor},hasOverride:function(M){return!!M.textColor}}),"text-halo-color":new bi(_e.paint_symbol["text-halo-color"]),"text-halo-width":new bi(_e.paint_symbol["text-halo-width"]),"text-halo-blur":new bi(_e.paint_symbol["text-halo-blur"]),"text-translate":new fi(_e.paint_symbol["text-translate"]),"text-translate-anchor":new fi(_e.paint_symbol["text-translate-anchor"])}),layout:Pg},Cc=function(M){this.type=M.property.overrides?M.property.overrides.runtimeType:Ot,this.defaultValue=M};Cc.prototype.evaluate=function(M){if(M.formattedSection){var O=this.defaultValue.property.overrides;if(O&&O.hasOverride(M.formattedSection))return O.getOverride(M.formattedSection)}return M.feature&&M.featureState?this.defaultValue.evaluate(M.feature,M.featureState):this.defaultValue.property.specification.default},Cc.prototype.eachChild=function(M){this.defaultValue.isConstant()||M(this.defaultValue.value._styleExpression.expression)},Cc.prototype.outputDefined=function(){return!1},Cc.prototype.serialize=function(){return null},Qr("FormatSectionOverride",Cc,{omit:["defaultValue"]});var Ig=function(M){function O(W){M.call(this,W,hh)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.recalculate=function(W,ie){if(M.prototype.recalculate.call(this,W,ie),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["icon-rotation-alignment"]="map":this.layout._values["icon-rotation-alignment"]="viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout.get("symbol-placement")!=="point"?this.layout._values["text-rotation-alignment"]="map":this.layout._values["text-rotation-alignment"]="viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var xe=this.layout.get("text-writing-mode");if(xe){for(var ke=[],Pe=0,je=xe;Pe<je.length;Pe+=1){var tt=je[Pe];ke.indexOf(tt)<0&&ke.push(tt)}this.layout._values["text-writing-mode"]=ke}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},O.prototype.getValueAndResolveTokens=function(W,ie,xe,ke){var Pe=this.layout.get(W).evaluate(ie,{},xe,ke),je=this._unevaluatedLayout._values[W];return je.isDataDriven()||rr(je.value)||!Pe?Pe:function(tt,ft){return ft.replace(/{([^{}]+)}/g,function(bt,Nt){return Nt in tt?String(tt[Nt]):""})}(ie.properties,Pe)},O.prototype.createBucket=function(W){return new ha(W)},O.prototype.queryRadius=function(){return 0},O.prototype.queryIntersectsFeature=function(){return!1},O.prototype._setPaintOverrides=function(){for(var W=0,ie=hh.paint.overridableProperties;W<ie.length;W+=1){var xe=ie[W];if(O.hasPaintOverride(this.layout,xe)){var ke=this.paint.get(xe),Pe=new Cc(ke),je=new er(Pe,ke.property.specification),tt=null;tt=ke.value.kind==="constant"||ke.value.kind==="source"?new ur("source",je):new yr("composite",je,ke.value.zoomStops,ke.value._interpolationType),this.paint._values[xe]=new Va(ke.property,tt,ke.parameters)}}},O.prototype._handleOverridablePaintPropertyUpdate=function(W,ie,xe){return!(!this.layout||ie.isDataDriven()||xe.isDataDriven())&&O.hasPaintOverride(this.layout,W)},O.hasPaintOverride=function(W,ie){var xe=W.get("text-field"),ke=hh.paint.properties[ie],Pe=!1,je=function(bt){for(var Nt=0,Kt=bt;Nt<Kt.length;Nt+=1){var Wt=Kt[Nt];if(ke.overrides&&ke.overrides.hasOverride(Wt))return void(Pe=!0)}};if(xe.value.kind==="constant"&&xe.value.value instanceof dr)je(xe.value.value.sections);else if(xe.value.kind==="source"){var tt=function(bt){if(!Pe)if(bt instanceof cn&&Vr(bt.value)===ot){var Nt=bt.value;je(Nt.sections)}else bt instanceof Tn?je(bt.sections):bt.eachChild(tt)},ft=xe.value;ft._styleExpression&&tt(ft._styleExpression.expression)}return Pe},O}(Qo),Og={paint:new No({"background-color":new fi(_e.paint_background["background-color"]),"background-pattern":new cl(_e.paint_background["background-pattern"]),"background-opacity":new fi(_e.paint_background["background-opacity"])})},Dg=function(M){function O(W){M.call(this,W,Og)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O}(Qo),zg={paint:new No({"raster-opacity":new fi(_e.paint_raster["raster-opacity"]),"raster-hue-rotate":new fi(_e.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new fi(_e.paint_raster["raster-brightness-min"]),"raster-brightness-max":new fi(_e.paint_raster["raster-brightness-max"]),"raster-saturation":new fi(_e.paint_raster["raster-saturation"]),"raster-contrast":new fi(_e.paint_raster["raster-contrast"]),"raster-resampling":new fi(_e.paint_raster["raster-resampling"]),"raster-fade-duration":new fi(_e.paint_raster["raster-fade-duration"])})},Rg=function(M){function O(W){M.call(this,W,zg)}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O}(Qo),Fg=function(M){function O(W){M.call(this,W,{}),this.implementation=W}return M&&(O.__proto__=M),O.prototype=Object.create(M&&M.prototype),O.prototype.constructor=O,O.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},O.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},O.prototype.recalculate=function(){},O.prototype.updateTransitions=function(){},O.prototype.hasTransition=function(){},O.prototype.serialize=function(){},O.prototype.onAdd=function(W){this.implementation.onAdd&&this.implementation.onAdd(W,W.painter.context.gl)},O.prototype.onRemove=function(W){this.implementation.onRemove&&this.implementation.onRemove(W,W.painter.context.gl)},O}(Qo),Bg={circle:Tm,heatmap:Mm,hillshade:Sm,fill:Hm,"fill-extrusion":$m,line:rg,symbol:Ig,background:Dg,raster:Rg},hd=self.HTMLImageElement,pd=self.HTMLCanvasElement,dd=self.HTMLVideoElement,md=self.ImageData,Wu=self.ImageBitmap,ac=function(M,O,W,ie){this.context=M,this.format=W,this.texture=M.gl.createTexture(),this.update(O,ie)};ac.prototype.update=function(M,O,W){var ie=M.width,xe=M.height,ke=!(this.size&&this.size[0]===ie&&this.size[1]===xe||W),Pe=this.context,je=Pe.gl;if(this.useMipmap=Boolean(O&&O.useMipmap),je.bindTexture(je.TEXTURE_2D,this.texture),Pe.pixelStoreUnpackFlipY.set(!1),Pe.pixelStoreUnpack.set(1),Pe.pixelStoreUnpackPremultiplyAlpha.set(this.format===je.RGBA&&(!O||O.premultiply!==!1)),ke)this.size=[ie,xe],M instanceof hd||M instanceof pd||M instanceof dd||M instanceof md||Wu&&M instanceof Wu?je.texImage2D(je.TEXTURE_2D,0,this.format,this.format,je.UNSIGNED_BYTE,M):je.texImage2D(je.TEXTURE_2D,0,this.format,ie,xe,0,this.format,je.UNSIGNED_BYTE,M.data);else{var tt=W||{x:0,y:0},ft=tt.x,bt=tt.y;M instanceof hd||M instanceof pd||M instanceof dd||M instanceof md||Wu&&M instanceof Wu?je.texSubImage2D(je.TEXTURE_2D,0,ft,bt,je.RGBA,je.UNSIGNED_BYTE,M):je.texSubImage2D(je.TEXTURE_2D,0,ft,bt,ie,xe,je.RGBA,je.UNSIGNED_BYTE,M.data)}this.useMipmap&&this.isSizePowerOfTwo()&&je.generateMipmap(je.TEXTURE_2D)},ac.prototype.bind=function(M,O,W){var ie=this.context.gl;ie.bindTexture(ie.TEXTURE_2D,this.texture),W!==ie.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(W=ie.LINEAR),M!==this.filter&&(ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_MAG_FILTER,M),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_MIN_FILTER,W||M),this.filter=M),O!==this.wrap&&(ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_WRAP_S,O),ie.texParameteri(ie.TEXTURE_2D,ie.TEXTURE_WRAP_T,O),this.wrap=O)},ac.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},ac.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var ph=function(M){var O=this;this._callback=M,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){O._triggered=!1,O._callback()})};ph.prototype.trigger=function(){var M=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){M._triggered=!1,M._callback()},0))},ph.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Pc=function(M,O,W){this.target=M,this.parent=O,this.mapId=W,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},f(["receive","process"],this),this.invoker=new ph(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=S()?M:self};function gd(M,O,W){var ie=2*Math.PI*6378137/256/Math.pow(2,W);return[M*ie-2*Math.PI*6378137/2,O*ie-2*Math.PI*6378137/2]}Pc.prototype.send=function(M,O,W,ie,xe){var ke=this;xe===void 0&&(xe=!1);var Pe=Math.round(1e18*Math.random()).toString(36).substring(0,10);W&&(this.callbacks[Pe]=W);var je=D(this.globalScope)?void 0:[];return this.target.postMessage({id:Pe,type:M,hasCallback:!!W,targetMapId:ie,mustQueue:xe,sourceMapId:this.mapId,data:ni(O,je)},je),{cancel:function(){W&&delete ke.callbacks[Pe],ke.target.postMessage({id:Pe,type:"<cancel>",targetMapId:ie,sourceMapId:ke.mapId})}}},Pc.prototype.receive=function(M){var O=M.data,W=O.id;if(W&&(!O.targetMapId||this.mapId===O.targetMapId))if(O.type==="<cancel>"){delete this.tasks[W];var ie=this.cancelCallbacks[W];delete this.cancelCallbacks[W],ie&&ie()}else S()||O.mustQueue?(this.tasks[W]=O,this.taskQueue.push(W),this.invoker.trigger()):this.processTask(W,O)},Pc.prototype.process=function(){if(this.taskQueue.length){var M=this.taskQueue.shift(),O=this.tasks[M];delete this.tasks[M],this.taskQueue.length&&this.invoker.trigger(),O&&this.processTask(M,O)}},Pc.prototype.processTask=function(M,O){var W=this;if(O.type==="<response>"){var ie=this.callbacks[M];delete this.callbacks[M],ie&&(O.error?ie(ki(O.error)):ie(null,ki(O.data)))}else{var xe=!1,ke=D(this.globalScope)?void 0:[],Pe=O.hasCallback?function(bt,Nt){xe=!0,delete W.cancelCallbacks[M],W.target.postMessage({id:M,type:"<response>",sourceMapId:W.mapId,error:bt?ni(bt):null,data:ni(Nt,ke)},ke)}:function(bt){xe=!0},je=null,tt=ki(O.data);if(this.parent[O.type])je=this.parent[O.type](O.sourceMapId,tt,Pe);else if(this.parent.getWorkerSource){var ft=O.type.split(".");je=this.parent.getWorkerSource(O.sourceMapId,ft[0],tt.source)[ft[1]](tt,Pe)}else Pe(new Error("Could not find function "+O.type));!xe&&je&&je.cancel&&(this.cancelCallbacks[M]=je.cancel)}},Pc.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var ho=function(M,O){M&&(O?this.setSouthWest(M).setNorthEast(O):M.length===4?this.setSouthWest([M[0],M[1]]).setNorthEast([M[2],M[3]]):this.setSouthWest(M[0]).setNorthEast(M[1]))};ho.prototype.setNorthEast=function(M){return this._ne=M instanceof Ia?new Ia(M.lng,M.lat):Ia.convert(M),this},ho.prototype.setSouthWest=function(M){return this._sw=M instanceof Ia?new Ia(M.lng,M.lat):Ia.convert(M),this},ho.prototype.extend=function(M){var O,W,ie=this._sw,xe=this._ne;if(M instanceof Ia)O=M,W=M;else{if(!(M instanceof ho)){if(Array.isArray(M)){if(M.length===4||M.every(Array.isArray)){var ke=M;return this.extend(ho.convert(ke))}var Pe=M;return this.extend(Ia.convert(Pe))}return this}if(O=M._sw,W=M._ne,!O||!W)return this}return ie||xe?(ie.lng=Math.min(O.lng,ie.lng),ie.lat=Math.min(O.lat,ie.lat),xe.lng=Math.max(W.lng,xe.lng),xe.lat=Math.max(W.lat,xe.lat)):(this._sw=new Ia(O.lng,O.lat),this._ne=new Ia(W.lng,W.lat)),this},ho.prototype.getCenter=function(){return new Ia((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},ho.prototype.getSouthWest=function(){return this._sw},ho.prototype.getNorthEast=function(){return this._ne},ho.prototype.getNorthWest=function(){return new Ia(this.getWest(),this.getNorth())},ho.prototype.getSouthEast=function(){return new Ia(this.getEast(),this.getSouth())},ho.prototype.getWest=function(){return this._sw.lng},ho.prototype.getSouth=function(){return this._sw.lat},ho.prototype.getEast=function(){return this._ne.lng},ho.prototype.getNorth=function(){return this._ne.lat},ho.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},ho.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},ho.prototype.isEmpty=function(){return!(this._sw&&this._ne)},ho.prototype.contains=function(M){var O=Ia.convert(M),W=O.lng,ie=O.lat,xe=this._sw.lat<=ie&&ie<=this._ne.lat,ke=this._sw.lng<=W&&W<=this._ne.lng;return this._sw.lng>this._ne.lng&&(ke=this._sw.lng>=W&&W>=this._ne.lng),xe&&ke},ho.convert=function(M){return!M||M instanceof ho?M:new ho(M)};var Ia=function(M,O){if(isNaN(M)||isNaN(O))throw new Error("Invalid LngLat object: ("+M+", "+O+")");if(this.lng=+M,this.lat=+O,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Ia.prototype.wrap=function(){return new Ia(l(this.lng,-180,180),this.lat)},Ia.prototype.toArray=function(){return[this.lng,this.lat]},Ia.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Ia.prototype.distanceTo=function(M){var O=Math.PI/180,W=this.lat*O,ie=M.lat*O,xe=Math.sin(W)*Math.sin(ie)+Math.cos(W)*Math.cos(ie)*Math.cos((M.lng-this.lng)*O);return 63710088e-1*Math.acos(Math.min(xe,1))},Ia.prototype.toBounds=function(M){M===void 0&&(M=0);var O=360*M/40075017,W=O/Math.cos(Math.PI/180*this.lat);return new ho(new Ia(this.lng-W,this.lat-O),new Ia(this.lng+W,this.lat+O))},Ia.convert=function(M){if(M instanceof Ia)return M;if(Array.isArray(M)&&(M.length===2||M.length===3))return new Ia(Number(M[0]),Number(M[1]));if(!Array.isArray(M)&&typeof M=="object"&&M!==null)return new Ia(Number("lng"in M?M.lng:M.lon),Number(M.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var vd=2*Math.PI*63710088e-1;function yd(M){return vd*Math.cos(M*Math.PI/180)}function xd(M){return(180+M)/360}function bd(M){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+M*Math.PI/360)))/360}function _d(M,O){return M/yd(O)}function dh(M){var O=180-360*M;return 360/Math.PI*Math.atan(Math.exp(O*Math.PI/180))-90}var oc=function(M,O,W){W===void 0&&(W=0),this.x=+M,this.y=+O,this.z=+W};oc.fromLngLat=function(M,O){O===void 0&&(O=0);var W=Ia.convert(M);return new oc(xd(W.lng),bd(W.lat),_d(O,W.lat))},oc.prototype.toLngLat=function(){return new Ia(360*this.x-180,dh(this.y))},oc.prototype.toAltitude=function(){return M=this.z,O=this.y,M*yd(dh(O));var M,O},oc.prototype.meterInMercatorCoordinateUnits=function(){return 1/vd*(M=dh(this.y),1/Math.cos(M*Math.PI/180));var M};var sc=function(M,O,W){this.z=M,this.x=O,this.y=W,this.key=hu(0,M,M,O,W)};sc.prototype.equals=function(M){return this.z===M.z&&this.x===M.x&&this.y===M.y},sc.prototype.url=function(M,O){var W,ie,xe,ke,Pe,je=(W=this.x,ie=this.y,xe=this.z,ke=gd(256*W,256*(ie=Math.pow(2,xe)-ie-1),xe),Pe=gd(256*(W+1),256*(ie+1),xe),ke[0]+","+ke[1]+","+Pe[0]+","+Pe[1]),tt=function(ft,bt,Nt){for(var Kt,Wt="",fr=ft;fr>0;fr--)Wt+=(bt&(Kt=1<<fr-1)?1:0)+(Nt&Kt?2:0);return Wt}(this.z,this.x,this.y);return M[(this.x+this.y)%M.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(O==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",tt).replace("{bbox-epsg-3857}",je)},sc.prototype.getTilePoint=function(M){var O=Math.pow(2,this.z);return new r(8192*(M.x*O-this.x),8192*(M.y*O-this.y))},sc.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var wd=function(M,O){this.wrap=M,this.canonical=O,this.key=hu(M,O.z,O.z,O.x,O.y)},po=function(M,O,W,ie,xe){this.overscaledZ=M,this.wrap=O,this.canonical=new sc(W,+ie,+xe),this.key=hu(O,M,W,ie,xe)};function hu(M,O,W,ie,xe){(M*=2)<0&&(M=-1*M-1);var ke=1<<W;return(ke*ke*M+ke*xe+ie).toString(36)+W.toString(36)+O.toString(36)}po.prototype.equals=function(M){return this.overscaledZ===M.overscaledZ&&this.wrap===M.wrap&&this.canonical.equals(M.canonical)},po.prototype.scaledTo=function(M){var O=this.canonical.z-M;return M>this.canonical.z?new po(M,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new po(M,this.wrap,M,this.canonical.x>>O,this.canonical.y>>O)},po.prototype.calculateScaledKey=function(M,O){var W=this.canonical.z-M;return M>this.canonical.z?hu(this.wrap*+O,M,this.canonical.z,this.canonical.x,this.canonical.y):hu(this.wrap*+O,M,M,this.canonical.x>>W,this.canonical.y>>W)},po.prototype.isChildOf=function(M){if(M.wrap!==this.wrap)return!1;var O=this.canonical.z-M.canonical.z;return M.overscaledZ===0||M.overscaledZ<this.overscaledZ&&M.canonical.x===this.canonical.x>>O&&M.canonical.y===this.canonical.y>>O},po.prototype.children=function(M){if(this.overscaledZ>=M)return[new po(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var O=this.canonical.z+1,W=2*this.canonical.x,ie=2*this.canonical.y;return[new po(O,this.wrap,O,W,ie),new po(O,this.wrap,O,W+1,ie),new po(O,this.wrap,O,W,ie+1),new po(O,this.wrap,O,W+1,ie+1)]},po.prototype.isLessThan=function(M){return this.wrap<M.wrap||!(this.wrap>M.wrap)&&(this.overscaledZ<M.overscaledZ||!(this.overscaledZ>M.overscaledZ)&&(this.canonical.x<M.canonical.x||!(this.canonical.x>M.canonical.x)&&this.canonical.y<M.canonical.y))},po.prototype.wrapped=function(){return new po(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},po.prototype.unwrapTo=function(M){return new po(this.overscaledZ,M,this.canonical.z,this.canonical.x,this.canonical.y)},po.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},po.prototype.toUnwrapped=function(){return new wd(this.wrap,this.canonical)},po.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},po.prototype.getTilePoint=function(M){return this.canonical.getTilePoint(new oc(M.x-this.wrap,M.y))},Qr("CanonicalTileID",sc),Qr("OverscaledTileID",po,{omit:["posMatrix"]});var Tl=function(M,O,W){if(this.uid=M,O.height!==O.width)throw new RangeError("DEM tiles must be square");if(W&&W!=="mapbox"&&W!=="terrarium")return A('"'+W+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=O.height;var ie=this.dim=O.height-2;this.data=new Uint32Array(O.data.buffer),this.encoding=W||"mapbox";for(var xe=0;xe<ie;xe++)this.data[this._idx(-1,xe)]=this.data[this._idx(0,xe)],this.data[this._idx(ie,xe)]=this.data[this._idx(ie-1,xe)],this.data[this._idx(xe,-1)]=this.data[this._idx(xe,0)],this.data[this._idx(xe,ie)]=this.data[this._idx(xe,ie-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(ie,-1)]=this.data[this._idx(ie-1,0)],this.data[this._idx(-1,ie)]=this.data[this._idx(0,ie-1)],this.data[this._idx(ie,ie)]=this.data[this._idx(ie-1,ie-1)]};Tl.prototype.get=function(M,O){var W=new Uint8Array(this.data.buffer),ie=4*this._idx(M,O);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(W[ie],W[ie+1],W[ie+2])},Tl.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Tl.prototype._idx=function(M,O){if(M<-1||M>=this.dim+1||O<-1||O>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(O+1)*this.stride+(M+1)},Tl.prototype._unpackMapbox=function(M,O,W){return(256*M*256+256*O+W)/10-1e4},Tl.prototype._unpackTerrarium=function(M,O,W){return 256*M+O+W/256-32768},Tl.prototype.getPixels=function(){return new os({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Tl.prototype.backfillBorder=function(M,O,W){if(this.dim!==M.dim)throw new Error("dem dimension mismatch");var ie=O*this.dim,xe=O*this.dim+this.dim,ke=W*this.dim,Pe=W*this.dim+this.dim;switch(O){case-1:ie=xe-1;break;case 1:xe=ie+1}switch(W){case-1:ke=Pe-1;break;case 1:Pe=ke+1}for(var je=-O*this.dim,tt=-W*this.dim,ft=ke;ft<Pe;ft++)for(var bt=ie;bt<xe;bt++)this.data[this._idx(bt,ft)]=M.data[this._idx(bt+je,ft+tt)]},Qr("DEMData",Tl);var Zu=function(M){this._stringToNumber={},this._numberToString=[];for(var O=0;O<M.length;O++){var W=M[O];this._stringToNumber[W]=O,this._numberToString[O]=W}};Zu.prototype.encode=function(M){return this._stringToNumber[M]},Zu.prototype.decode=function(M){return this._numberToString[M]};var Xu=function(M,O,W,ie,xe){this.type="Feature",this._vectorTileFeature=M,M._z=O,M._x=W,M._y=ie,this.properties=M.properties,this.id=xe},mh={geometry:{configurable:!0}};mh.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},mh.geometry.set=function(M){this._geometry=M},Xu.prototype.toJSON=function(){var M={geometry:this.geometry};for(var O in this)O!=="_geometry"&&O!=="_vectorTileFeature"&&(M[O]=this[O]);return M},Object.defineProperties(Xu.prototype,mh);var Ic=function(){this.state={},this.stateChanges={},this.deletedStates={}};Ic.prototype.updateState=function(M,O,W){var ie=String(O);if(this.stateChanges[M]=this.stateChanges[M]||{},this.stateChanges[M][ie]=this.stateChanges[M][ie]||{},s(this.stateChanges[M][ie],W),this.deletedStates[M]===null)for(var xe in this.deletedStates[M]={},this.state[M])xe!==ie&&(this.deletedStates[M][xe]=null);else if(this.deletedStates[M]&&this.deletedStates[M][ie]===null)for(var ke in this.deletedStates[M][ie]={},this.state[M][ie])W[ke]||(this.deletedStates[M][ie][ke]=null);else for(var Pe in W)this.deletedStates[M]&&this.deletedStates[M][ie]&&this.deletedStates[M][ie][Pe]===null&&delete this.deletedStates[M][ie][Pe]},Ic.prototype.removeFeatureState=function(M,O,W){if(this.deletedStates[M]!==null){var ie=String(O);if(this.deletedStates[M]=this.deletedStates[M]||{},W&&O!==void 0)this.deletedStates[M][ie]!==null&&(this.deletedStates[M][ie]=this.deletedStates[M][ie]||{},this.deletedStates[M][ie][W]=null);else if(O!==void 0)if(this.stateChanges[M]&&this.stateChanges[M][ie])for(W in this.deletedStates[M][ie]={},this.stateChanges[M][ie])this.deletedStates[M][ie][W]=null;else this.deletedStates[M][ie]=null;else this.deletedStates[M]=null}},Ic.prototype.getState=function(M,O){var W=String(O),ie=this.state[M]||{},xe=this.stateChanges[M]||{},ke=s({},ie[W],xe[W]);if(this.deletedStates[M]===null)return{};if(this.deletedStates[M]){var Pe=this.deletedStates[M][O];if(Pe===null)return{};for(var je in Pe)delete ke[je]}return ke},Ic.prototype.initializeTileState=function(M,O){M.setFeatureState(this.state,O)},Ic.prototype.coalesceChanges=function(M,O){var W={};for(var ie in this.stateChanges){this.state[ie]=this.state[ie]||{};var xe={};for(var ke in this.stateChanges[ie])this.state[ie][ke]||(this.state[ie][ke]={}),s(this.state[ie][ke],this.stateChanges[ie][ke]),xe[ke]=this.state[ie][ke];W[ie]=xe}for(var Pe in this.deletedStates){this.state[Pe]=this.state[Pe]||{};var je={};if(this.deletedStates[Pe]===null)for(var tt in this.state[Pe])je[tt]={},this.state[Pe][tt]={};else for(var ft in this.deletedStates[Pe]){if(this.deletedStates[Pe][ft]===null)this.state[Pe][ft]={};else for(var bt=0,Nt=Object.keys(this.deletedStates[Pe][ft]);bt<Nt.length;bt+=1){var Kt=Nt[bt];delete this.state[Pe][ft][Kt]}je[ft]=this.state[Pe][ft]}W[Pe]=W[Pe]||{},s(W[Pe],je)}if(this.stateChanges={},this.deletedStates={},Object.keys(W).length!==0)for(var Wt in M)M[Wt].setFeatureState(W,O)};var kl=function(M,O){this.tileID=M,this.x=M.canonical.x,this.y=M.canonical.y,this.z=M.canonical.z,this.grid=new mn(8192,16,0),this.grid3D=new mn(8192,16,0),this.featureIndexArray=new Lt,this.promoteId=O};function Td(M,O,W,ie,xe){return b(M,function(ke,Pe){var je=O instanceof ds?O.get(Pe):null;return je&&je.evaluate?je.evaluate(W,ie,xe):je})}function kd(M){for(var O=1/0,W=1/0,ie=-1/0,xe=-1/0,ke=0,Pe=M;ke<Pe.length;ke+=1){var je=Pe[ke];O=Math.min(O,je.x),W=Math.min(W,je.y),ie=Math.max(ie,je.x),xe=Math.max(xe,je.y)}return{minX:O,minY:W,maxX:ie,maxY:xe}}function Ng(M,O){return O-M}kl.prototype.insert=function(M,O,W,ie,xe,ke){var Pe=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(W,ie,xe);for(var je=ke?this.grid3D:this.grid,tt=0;tt<O.length;tt++){for(var ft=O[tt],bt=[1/0,1/0,-1/0,-1/0],Nt=0;Nt<ft.length;Nt++){var Kt=ft[Nt];bt[0]=Math.min(bt[0],Kt.x),bt[1]=Math.min(bt[1],Kt.y),bt[2]=Math.max(bt[2],Kt.x),bt[3]=Math.max(bt[3],Kt.y)}bt[0]<8192&&bt[1]<8192&&bt[2]>=0&&bt[3]>=0&&je.insert(Pe,bt[0],bt[1],bt[2],bt[3])}},kl.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new wc.VectorTile(new Fu(this.rawTileData)).layers,this.sourceLayerCoder=new Zu(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},kl.prototype.query=function(M,O,W,ie){var xe=this;this.loadVTLayers();for(var ke=M.params||{},Pe=8192/M.tileSize/M.scale,je=Si(ke.filter),tt=M.queryGeometry,ft=M.queryPadding*Pe,bt=kd(tt),Nt=this.grid.query(bt.minX-ft,bt.minY-ft,bt.maxX+ft,bt.maxY+ft),Kt=kd(M.cameraQueryGeometry),Wt=this.grid3D.query(Kt.minX-ft,Kt.minY-ft,Kt.maxX+ft,Kt.maxY+ft,function(gn,An,Un,jn){return function(Zn,li,ci,Qn,mi){for(var pi=0,ui=Zn;pi<ui.length;pi+=1){var Qi=ui[pi];if(li<=Qi.x&&ci<=Qi.y&&Qn>=Qi.x&&mi>=Qi.y)return!0}var qi=[new r(li,ci),new r(li,mi),new r(Qn,mi),new r(Qn,ci)];if(Zn.length>2){for(var ia=0,Ti=qi;ia<Ti.length;ia+=1)if(gs(Zn,Ti[ia]))return!0}for(var Yi=0;Yi<Zn.length-1;Yi++)if(rc(Zn[Yi],Zn[Yi+1],qi))return!0;return!1}(M.cameraQueryGeometry,gn-ft,An-ft,Un+ft,jn+ft)}),fr=0,Tr=Wt;fr<Tr.length;fr+=1){var Br=Tr[fr];Nt.push(Br)}Nt.sort(Ng);for(var Fr,Gr={},Wr=function(gn){var An=Nt[gn];if(An!==Fr){Fr=An;var Un=xe.featureIndexArray.get(An),jn=null;xe.loadMatchingFeature(Gr,Un.bucketIndex,Un.sourceLayerIndex,Un.featureIndex,je,ke.layers,ke.availableImages,O,W,ie,function(Zn,li,ci){return jn||(jn=ba(Zn)),li.queryIntersectsFeature(tt,Zn,ci,jn,xe.z,M.transform,Pe,M.pixelPosMatrix)})}},Jr=0;Jr<Nt.length;Jr++)Wr(Jr);return Gr},kl.prototype.loadMatchingFeature=function(M,O,W,ie,xe,ke,Pe,je,tt,ft,bt){var Nt=this.bucketLayerIDs[O];if(!ke||function(Un,jn){for(var Zn=0;Zn<Un.length;Zn++)if(jn.indexOf(Un[Zn])>=0)return!0;return!1}(ke,Nt)){var Kt=this.sourceLayerCoder.decode(W),Wt=this.vtLayers[Kt].feature(ie);if(xe.filter(new oa(this.tileID.overscaledZ),Wt))for(var fr=this.getId(Wt,Kt),Tr=0;Tr<Nt.length;Tr++){var Br=Nt[Tr];if(!(ke&&ke.indexOf(Br)<0)){var Fr=je[Br];if(Fr){var Gr={};fr!==void 0&&ft&&(Gr=ft.getState(Fr.sourceLayer||"_geojsonTileLayer",fr));var Wr=tt[Br];Wr.paint=Td(Wr.paint,Fr.paint,Wt,Gr,Pe),Wr.layout=Td(Wr.layout,Fr.layout,Wt,Gr,Pe);var Jr=!bt||bt(Wt,Fr,Gr);if(Jr){var gn=new Xu(Wt,this.z,this.x,this.y,fr);gn.layer=Wr;var An=M[Br];An===void 0&&(An=M[Br]=[]),An.push({featureIndex:ie,feature:gn,intersectionZ:Jr})}}}}}},kl.prototype.lookupSymbolFeatures=function(M,O,W,ie,xe,ke,Pe,je){var tt={};this.loadVTLayers();for(var ft=Si(xe),bt=0,Nt=M;bt<Nt.length;bt+=1){var Kt=Nt[bt];this.loadMatchingFeature(tt,W,ie,Kt,ft,ke,Pe,je,O)}return tt},kl.prototype.hasLayer=function(M){for(var O=0,W=this.bucketLayerIDs;O<W.length;O+=1)for(var ie=0,xe=W[O];ie<xe.length;ie+=1)if(M===xe[ie])return!0;return!1},kl.prototype.getId=function(M,O){var W=M.id;if(this.promoteId){var ie=typeof this.promoteId=="string"?this.promoteId:this.promoteId[O];typeof(W=M.properties[ie])=="boolean"&&(W=Number(W))}return W},Qr("FeatureIndex",kl,{omit:["rawTileData","sourceLayerCoder"]});var Lo=function(M,O){this.tileID=M,this.uid=u(),this.uses=0,this.tileSize=O,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Lo.prototype.registerFadeDuration=function(M){var O=M+this.timeAdded;O<N.now()||this.fadeEndTime&&O<this.fadeEndTime||(this.fadeEndTime=O)},Lo.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},Lo.prototype.loadVectorData=function(M,O,W){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",M){for(var ie in M.featureIndex&&(this.latestFeatureIndex=M.featureIndex,M.rawTileData?(this.latestRawTileData=M.rawTileData,this.latestFeatureIndex.rawTileData=M.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=M.collisionBoxArray,this.buckets=function(ft,bt){var Nt={};if(!bt)return Nt;for(var Kt=function(){var Tr=fr[Wt],Br=Tr.layerIds.map(function(Jr){return bt.getLayer(Jr)}).filter(Boolean);if(Br.length!==0){Tr.layers=Br,Tr.stateDependentLayerIds&&(Tr.stateDependentLayers=Tr.stateDependentLayerIds.map(function(Jr){return Br.filter(function(gn){return gn.id===Jr})[0]}));for(var Fr=0,Gr=Br;Fr<Gr.length;Fr+=1){var Wr=Gr[Fr];Nt[Wr.id]=Tr}}},Wt=0,fr=ft;Wt<fr.length;Wt+=1)Kt();return Nt}(M.buckets,O.style),this.hasSymbolBuckets=!1,this.buckets){var xe=this.buckets[ie];if(xe instanceof ha){if(this.hasSymbolBuckets=!0,!W)break;xe.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var ke in this.buckets){var Pe=this.buckets[ke];if(Pe instanceof ha&&Pe.hasRTLText){this.hasRTLText=!0,bo.isLoading()||bo.isLoaded()||$a()!=="deferred"||aa();break}}for(var je in this.queryPadding=0,this.buckets){var tt=this.buckets[je];this.queryPadding=Math.max(this.queryPadding,O.style.getLayer(je).queryRadius(tt))}M.imageAtlas&&(this.imageAtlas=M.imageAtlas),M.glyphAtlasImage&&(this.glyphAtlasImage=M.glyphAtlasImage)}else this.collisionBoxArray=new Ae},Lo.prototype.unloadVectorData=function(){for(var M in this.buckets)this.buckets[M].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Lo.prototype.getBucket=function(M){return this.buckets[M.id]},Lo.prototype.upload=function(M){for(var O in this.buckets){var W=this.buckets[O];W.uploadPending()&&W.upload(M)}var ie=M.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new ac(M,this.imageAtlas.image,ie.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new ac(M,this.glyphAtlasImage,ie.ALPHA),this.glyphAtlasImage=null)},Lo.prototype.prepare=function(M){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(M,this.imageAtlasTexture)},Lo.prototype.queryRenderedFeatures=function(M,O,W,ie,xe,ke,Pe,je,tt,ft){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:ie,cameraQueryGeometry:xe,scale:ke,tileSize:this.tileSize,pixelPosMatrix:ft,transform:je,params:Pe,queryPadding:this.queryPadding*tt},M,O,W):{}},Lo.prototype.querySourceFeatures=function(M,O){var W=this.latestFeatureIndex;if(W&&W.rawTileData){var ie=W.loadVTLayers(),xe=O?O.sourceLayer:"",ke=ie._geojsonTileLayer||ie[xe];if(ke)for(var Pe=Si(O&&O.filter),je=this.tileID.canonical,tt=je.z,ft=je.x,bt=je.y,Nt={z:tt,x:ft,y:bt},Kt=0;Kt<ke.length;Kt++){var Wt=ke.feature(Kt);if(Pe.filter(new oa(this.tileID.overscaledZ),Wt)){var fr=W.getId(Wt,xe),Tr=new Xu(Wt,tt,ft,bt,fr);Tr.tile=Nt,M.push(Tr)}}}},Lo.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},Lo.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Lo.prototype.setExpiryData=function(M){var O=this.expirationTime;if(M.cacheControl){var W=E(M.cacheControl);W["max-age"]&&(this.expirationTime=Date.now()+1e3*W["max-age"])}else M.expires&&(this.expirationTime=new Date(M.expires).getTime());if(this.expirationTime){var ie=Date.now(),xe=!1;if(this.expirationTime>ie)xe=!1;else if(O)if(this.expirationTime<O)xe=!0;else{var ke=this.expirationTime-O;ke?this.expirationTime=ie+Math.max(ke,3e4):xe=!0}else xe=!0;xe?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Lo.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},Lo.prototype.setFeatureState=function(M,O){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(M).length!==0){var W=this.latestFeatureIndex.loadVTLayers();for(var ie in this.buckets)if(O.style.hasLayer(ie)){var xe=this.buckets[ie],ke=xe.layers[0].sourceLayer||"_geojsonTileLayer",Pe=W[ke],je=M[ke];if(Pe&&je&&Object.keys(je).length!==0){xe.update(je,Pe,this.imageAtlas&&this.imageAtlas.patternPositions||{});var tt=O&&O.style&&O.style.getLayer(ie);tt&&(this.queryPadding=Math.max(this.queryPadding,tt.queryRadius(xe)))}}}},Lo.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},Lo.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<N.now()},Lo.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Lo.prototype.setHoldDuration=function(M){this.symbolFadeHoldUntil=N.now()+M},Lo.prototype.setDependencies=function(M,O){for(var W={},ie=0,xe=O;ie<xe.length;ie+=1)W[xe[ie]]=!0;this.dependencies[M]=W},Lo.prototype.hasDependency=function(M,O){for(var W=0,ie=M;W<ie.length;W+=1){var xe=ie[W],ke=this.dependencies[xe];if(ke){for(var Pe=0,je=O;Pe<je.length;Pe+=1)if(ke[je[Pe]])return!0}}return!1};var jl=self.performance,Md=function(M){this._marks={start:[M.url,"start"].join("#"),end:[M.url,"end"].join("#"),measure:M.url.toString()},jl.mark(this._marks.start)};Md.prototype.finish=function(){jl.mark(this._marks.end);var M=jl.getEntriesByName(this._marks.measure);return M.length===0&&(jl.measure(this._marks.measure,this._marks.start,this._marks.end),M=jl.getEntriesByName(this._marks.measure),jl.clearMarks(this._marks.start),jl.clearMarks(this._marks.end),jl.clearMeasures(this._marks.measure)),M},e.Actor=Pc,e.AlphaImage=ic,e.CanonicalTileID=sc,e.CollisionBoxArray=Ae,e.Color=tr,e.DEMData=Tl,e.DataConstantProperty=fi,e.DictionaryCoder=Zu,e.EXTENT=8192,e.ErrorEvent=Ye,e.EvaluationParameters=oa,e.Event=Ne,e.Evented=pe,e.FeatureIndex=kl,e.FillBucket=Zs,e.FillExtrusionBucket=Xs,e.ImageAtlas=uu,e.ImagePosition=Nu,e.LineBucket=ss,e.LngLat=Ia,e.LngLatBounds=ho,e.MercatorCoordinate=oc,e.ONE_EM=24,e.OverscaledTileID=po,e.Point=r,e.Point$1=r,e.Properties=No,e.Protobuf=Fu,e.RGBAImage=os,e.RequestManager=ne,e.RequestPerformance=Md,e.ResourceType=gt,e.SegmentVector=Bt,e.SourceFeatureState=Ic,e.StructArrayLayout1ui2=q,e.StructArrayLayout2f1f2i16=Rl,e.StructArrayLayout2i4=_s,e.StructArrayLayout3ui6=uo,e.StructArrayLayout4i8=Fa,e.SymbolBucket=ha,e.Texture=ac,e.Tile=Lo,e.Transitionable=ps,e.Uniform1f=Kr,e.Uniform1i=hi,e.Uniform2f=Ln,e.Uniform3f=Jn,e.Uniform4f=Wn,e.UniformColor=oi,e.UniformMatrix4f=Li,e.UnwrappedTileID=wd,e.ValidationError=Be,e.WritingMode=Ts,e.ZoomHistory=Pi,e.add=function(M,O,W){return M[0]=O[0]+W[0],M[1]=O[1]+W[1],M[2]=O[2]+W[2],M},e.addDynamicAttributes=fh,e.asyncAll=function(M,O,W){if(!M.length)return W(null,[]);var ie=M.length,xe=new Array(M.length),ke=null;M.forEach(function(Pe,je){O(Pe,function(tt,ft){tt&&(ke=tt),xe[je]=ft,--ie==0&&W(ke,xe)})})},e.bezier=c,e.bindAll=f,e.browser=N,e.cacheEntryPossiblyAdded=function(M){++$e>Oe&&(M.getActor().send("enforceCacheSizeLimit",De),$e=0)},e.clamp=h,e.clearTileCache=function(M){var O=self.caches.delete("mapbox-tiles");M&&O.catch(M).then(function(){return M()})},e.clipLine=od,e.clone=function(M){var O=new as(16);return O[0]=M[0],O[1]=M[1],O[2]=M[2],O[3]=M[3],O[4]=M[4],O[5]=M[5],O[6]=M[6],O[7]=M[7],O[8]=M[8],O[9]=M[9],O[10]=M[10],O[11]=M[11],O[12]=M[12],O[13]=M[13],O[14]=M[14],O[15]=M[15],O},e.clone$1=k,e.clone$2=function(M){var O=new as(3);return O[0]=M[0],O[1]=M[1],O[2]=M[2],O},e.collisionCircleLayout=ag,e.config=U,e.create=function(){var M=new as(16);return as!=Float32Array&&(M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[11]=0,M[12]=0,M[13]=0,M[14]=0),M[0]=1,M[5]=1,M[10]=1,M[15]=1,M},e.create$1=function(){var M=new as(9);return as!=Float32Array&&(M[1]=0,M[2]=0,M[3]=0,M[5]=0,M[6]=0,M[7]=0),M[0]=1,M[4]=1,M[8]=1,M},e.create$2=function(){var M=new as(4);return as!=Float32Array&&(M[1]=0,M[2]=0),M[0]=1,M[3]=1,M},e.createCommonjsModule=t,e.createExpression=Xt,e.createLayout=sa,e.createStyleLayer=function(M){return M.type==="custom"?new Fg(M):new Bg[M.type](M)},e.cross=function(M,O,W){var ie=O[0],xe=O[1],ke=O[2],Pe=W[0],je=W[1],tt=W[2];return M[0]=xe*tt-ke*je,M[1]=ke*Pe-ie*tt,M[2]=ie*je-xe*Pe,M},e.deepEqual=function M(O,W){if(Array.isArray(O)){if(!Array.isArray(W)||O.length!==W.length)return!1;for(var ie=0;ie<O.length;ie++)if(!M(O[ie],W[ie]))return!1;return!0}if(typeof O=="object"&&O!==null&&W!==null){if(typeof W!="object"||Object.keys(O).length!==Object.keys(W).length)return!1;for(var xe in O)if(!M(O[xe],W[xe]))return!1;return!0}return O===W},e.dot=function(M,O){return M[0]*O[0]+M[1]*O[1]+M[2]*O[2]},e.dot$1=function(M,O){return M[0]*O[0]+M[1]*O[1]+M[2]*O[2]+M[3]*O[3]},e.ease=a,e.emitValidationErrors=Sn,e.endsWith=_,e.enforceCacheSizeLimit=function(M){Ve(),Te&&Te.then(function(O){O.keys().then(function(W){for(var ie=0;ie<W.length-M;ie++)O.delete(W[ie])})})},e.evaluateSizeForFeature=ed,e.evaluateSizeForZoom=td,e.evaluateVariableOffset=cd,e.evented=La,e.extend=s,e.featureFilter=Si,e.filterObject=T,e.fromRotation=function(M,O){var W=Math.sin(O),ie=Math.cos(O);return M[0]=ie,M[1]=W,M[2]=0,M[3]=-W,M[4]=ie,M[5]=0,M[6]=0,M[7]=0,M[8]=1,M},e.getAnchorAlignment=sh,e.getAnchorJustification=uh,e.getArrayBuffer=vt,e.getImage=Zt,e.getJSON=function(M,O){return Qe(s(M,{type:"json"}),O)},e.getRTLTextPluginStatus=$a,e.getReferrer=mt,e.getVideo=function(M,O){var W,ie,xe=self.document.createElement("video");xe.muted=!0,xe.onloadstart=function(){O(null,xe)};for(var ke=0;ke<M.length;ke++){var Pe=self.document.createElement("source");W=M[ke],ie=void 0,(ie=self.document.createElement("a")).href=W,(ie.protocol!==self.document.location.protocol||ie.host!==self.document.location.host)&&(xe.crossOrigin="Anonymous"),Pe.src=M[ke],xe.appendChild(Pe)}return{cancel:function(){}}},e.identity=eu,e.invert=function(M,O){var W=O[0],ie=O[1],xe=O[2],ke=O[3],Pe=O[4],je=O[5],tt=O[6],ft=O[7],bt=O[8],Nt=O[9],Kt=O[10],Wt=O[11],fr=O[12],Tr=O[13],Br=O[14],Fr=O[15],Gr=W*je-ie*Pe,Wr=W*tt-xe*Pe,Jr=W*ft-ke*Pe,gn=ie*tt-xe*je,An=ie*ft-ke*je,Un=xe*ft-ke*tt,jn=bt*Tr-Nt*fr,Zn=bt*Br-Kt*fr,li=bt*Fr-Wt*fr,ci=Nt*Br-Kt*Tr,Qn=Nt*Fr-Wt*Tr,mi=Kt*Fr-Wt*Br,pi=Gr*mi-Wr*Qn+Jr*ci+gn*li-An*Zn+Un*jn;return pi?(pi=1/pi,M[0]=(je*mi-tt*Qn+ft*ci)*pi,M[1]=(xe*Qn-ie*mi-ke*ci)*pi,M[2]=(Tr*Un-Br*An+Fr*gn)*pi,M[3]=(Kt*An-Nt*Un-Wt*gn)*pi,M[4]=(tt*li-Pe*mi-ft*Zn)*pi,M[5]=(W*mi-xe*li+ke*Zn)*pi,M[6]=(Br*Jr-fr*Un-Fr*Wr)*pi,M[7]=(bt*Un-Kt*Jr+Wt*Wr)*pi,M[8]=(Pe*Qn-je*li+ft*jn)*pi,M[9]=(ie*li-W*Qn-ke*jn)*pi,M[10]=(fr*An-Tr*Jr+Fr*Gr)*pi,M[11]=(Nt*Jr-bt*An-Wt*Gr)*pi,M[12]=(je*Zn-Pe*ci-tt*jn)*pi,M[13]=(W*ci-ie*Zn+xe*jn)*pi,M[14]=(Tr*Wr-fr*gn-Br*Gr)*pi,M[15]=(bt*gn-Nt*Wr+Kt*Gr)*pi,M):null},e.isChar=In,e.isMapboxURL=se,e.keysDifference=function(M,O){var W=[];for(var ie in M)ie in O||W.push(ie);return W},e.makeRequest=Qe,e.mapObject=b,e.mercatorXfromLng=xd,e.mercatorYfromLat=bd,e.mercatorZfromAltitude=_d,e.mul=Wf,e.multiply=nc,e.mvt=wc,e.normalize=function(M,O){var W=O[0],ie=O[1],xe=O[2],ke=W*W+ie*ie+xe*xe;return ke>0&&(ke=1/Math.sqrt(ke)),M[0]=O[0]*ke,M[1]=O[1]*ke,M[2]=O[2]*ke,M},e.number=wn,e.offscreenCanvasSupported=at,e.ortho=function(M,O,W,ie,xe,ke,Pe){var je=1/(O-W),tt=1/(ie-xe),ft=1/(ke-Pe);return M[0]=-2*je,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=-2*tt,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[10]=2*ft,M[11]=0,M[12]=(O+W)*je,M[13]=(xe+ie)*tt,M[14]=(Pe+ke)*ft,M[15]=1,M},e.parseGlyphPBF=function(M){return new Fu(M).readFields(gg,[])},e.pbf=Fu,e.performSymbolLayout=function(M,O,W,ie,xe,ke,Pe){M.createArrays();var je=512*M.overscaling;M.tilePixelRatio=8192/je,M.compareText={},M.iconsNeedLinear=!1;var tt=M.layers[0].layout,ft=M.layers[0]._unevaluatedLayout._values,bt={};if(M.textSizeData.kind==="composite"){var Nt=M.textSizeData,Kt=Nt.minZoom,Wt=Nt.maxZoom;bt.compositeTextSizes=[ft["text-size"].possiblyEvaluate(new oa(Kt),Pe),ft["text-size"].possiblyEvaluate(new oa(Wt),Pe)]}if(M.iconSizeData.kind==="composite"){var fr=M.iconSizeData,Tr=fr.minZoom,Br=fr.maxZoom;bt.compositeIconSizes=[ft["icon-size"].possiblyEvaluate(new oa(Tr),Pe),ft["icon-size"].possiblyEvaluate(new oa(Br),Pe)]}bt.layoutTextSize=ft["text-size"].possiblyEvaluate(new oa(M.zoom+1),Pe),bt.layoutIconSize=ft["icon-size"].possiblyEvaluate(new oa(M.zoom+1),Pe),bt.textMaxSize=ft["text-size"].possiblyEvaluate(new oa(18));for(var Fr=24*tt.get("text-line-height"),Gr=tt.get("text-rotation-alignment")==="map"&&tt.get("symbol-placement")!=="point",Wr=tt.get("text-keep-upright"),Jr=tt.get("text-size"),gn=function(){var jn=Un[An],Zn=tt.get("text-font").evaluate(jn,{},Pe).join(","),li=Jr.evaluate(jn,{},Pe),ci=bt.layoutTextSize.evaluate(jn,{},Pe),Qn=bt.layoutIconSize.evaluate(jn,{},Pe),mi={horizontal:{},vertical:void 0},pi=jn.text,ui=[0,0];if(pi){var Qi=pi.toString(),qi=24*tt.get("text-letter-spacing").evaluate(jn,{},Pe),ia=function(Bi){for(var ta=0,Wa=Bi;ta<Wa.length;ta+=1)if(!Ci(Wa[ta].charCodeAt(0)))return!1;return!0}(Qi)?qi:0,Ti=tt.get("text-anchor").evaluate(jn,{},Pe),Yi=tt.get("text-variable-anchor");if(!Yi){var wa=tt.get("text-radial-offset").evaluate(jn,{},Pe);ui=wa?cd(Ti,[24*wa,ch]):tt.get("text-offset").evaluate(jn,{},Pe).map(function(Bi){return 24*Bi})}var ma=Gr?"center":tt.get("text-justify").evaluate(jn,{},Pe),Oa=tt.get("symbol-placement"),ga=Oa==="point"?24*tt.get("text-max-width").evaluate(jn,{},Pe):0,mo=function(){M.allowVerticalPlacement&&Ri(Qi)&&(mi.vertical=ju(pi,O,W,xe,Zn,ga,Fr,Ti,"left",ia,ui,Ts.vertical,!0,Oa,ci,li))};if(!Gr&&Yi){for(var Da=ma==="auto"?Yi.map(function(Bi){return uh(Bi)}):[ma],Vo=!1,Co=0;Co<Da.length;Co++){var Oo=Da[Co];if(!mi.horizontal[Oo])if(Vo)mi.horizontal[Oo]=mi.horizontal[0];else{var es=ju(pi,O,W,xe,Zn,ga,Fr,"center",Oo,ia,ui,Ts.horizontal,!1,Oa,ci,li);es&&(mi.horizontal[Oo]=es,Vo=es.positionedLines.length===1)}}mo()}else{ma==="auto"&&(ma=uh(Ti));var Yo=ju(pi,O,W,xe,Zn,ga,Fr,Ti,ma,ia,ui,Ts.horizontal,!1,Oa,ci,li);Yo&&(mi.horizontal[ma]=Yo),mo(),Ri(Qi)&&Gr&&Wr&&(mi.vertical=ju(pi,O,W,xe,Zn,ga,Fr,Ti,ma,ia,ui,Ts.vertical,!1,Oa,ci,li))}}var go=void 0,Do=!1;if(jn.icon&&jn.icon.name){var ro=ie[jn.icon.name];ro&&(go=function(Bi,ta,Wa){var Za=sh(Wa),Ha=Za.horizontalAlign,za=Za.verticalAlign,la=ta[0],Xa=ta[1],ts=la-Bi.displaySize[0]*Ha,ys=ts+Bi.displaySize[0],Wo=Xa-Bi.displaySize[1]*za;return{image:Bi,top:Wo,bottom:Wo+Bi.displaySize[1],left:ts,right:ys}}(xe[jn.icon.name],tt.get("icon-offset").evaluate(jn,{},Pe),tt.get("icon-anchor").evaluate(jn,{},Pe)),Do=ro.sdf,M.sdfIcons===void 0?M.sdfIcons=ro.sdf:M.sdfIcons!==ro.sdf&&A("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ro.pixelRatio!==M.pixelRatio||tt.get("icon-rotate").constantOr(1)!==0)&&(M.iconsNeedLinear=!0))}var _o=fd(mi.horizontal)||mi.vertical;M.iconsInText=!!_o&&_o.iconsInText,(_o||go)&&function(Bi,ta,Wa,Za,Ha,za,la,Xa,ts,ys,Wo){var Ks=za.textMaxSize.evaluate(ta,{});Ks===void 0&&(Ks=la);var Ml,Po=Bi.layers[0].layout,Js=Po.get("icon-offset").evaluate(ta,{},Wo),$s=fd(Wa.horizontal),Qs=la/24,gh=Bi.tilePixelRatio*Qs,Oc=Bi.tilePixelRatio*Ks/24,Ku=Bi.tilePixelRatio*Xa,lc=Bi.tilePixelRatio*Po.get("symbol-spacing"),Ju=Po.get("text-padding")*Bi.tilePixelRatio,$u=Po.get("icon-padding")*Bi.tilePixelRatio,Qu=Po.get("text-max-angle")/180*Math.PI,ef=Po.get("text-rotation-alignment")==="map"&&Po.get("symbol-placement")!=="point",Ul=Po.get("icon-rotation-alignment")==="map"&&Po.get("symbol-placement")!=="point",Dc=Po.get("symbol-placement"),tf=lc/2,zc=Po.get("icon-text-fit");Za&&zc!=="none"&&(Bi.allowVerticalPlacement&&Wa.vertical&&(Ml=Qp(Za,Wa.vertical,zc,Po.get("icon-text-fit-padding"),Js,Qs)),$s&&(Za=Qp(Za,$s,zc,Po.get("icon-text-fit-padding"),Js,Qs)));var Vl=function(Ug,yu){yu.x<0||yu.x>=8192||yu.y<0||yu.y>=8192||function(eo,el,Vg,Hl,_h,Ld,uf,fl,ff,xu,hf,pf,wh,Cd,bu,Pd,Id,Od,Dd,zd,ks,df,Rd,hl,Hg){var Th,cc,Uc,Vc,Hc,qc=eo.addToLineVertexArray(el,Vg),Fd=0,Bd=0,Nd=0,jd=0,kh=-1,Mh=-1,Al={},Ud=zr(""),Ah=0,Sh=0;if(fl._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Th=fl.layout.get("text-offset").evaluate(ks,{},hl).map(function(wu){return 24*wu}),Ah=Th[0],Sh=Th[1]):(Ah=24*fl.layout.get("text-radial-offset").evaluate(ks,{},hl),Sh=ch),eo.allowVerticalPlacement&&Hl.vertical){var Vd=fl.layout.get("text-rotate").evaluate(ks,{},hl)+90,qg=Hl.vertical;Vc=new Gu(ff,el,xu,hf,pf,qg,wh,Cd,bu,Vd),uf&&(Hc=new Gu(ff,el,xu,hf,pf,uf,Id,Od,bu,Vd))}if(_h){var Eh=fl.layout.get("icon-rotate").evaluate(ks,{}),Hd=fl.layout.get("icon-text-fit")!=="none",qd=sd(_h,Eh,Rd,Hd),Lh=uf?sd(uf,Eh,Rd,Hd):void 0;Uc=new Gu(ff,el,xu,hf,pf,_h,Id,Od,!1,Eh),Fd=4*qd.length;var Gd=eo.iconSizeData,_u=null;Gd.kind==="source"?(_u=[128*fl.layout.get("icon-size").evaluate(ks,{})])[0]>32640&&A(eo.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):Gd.kind==="composite"&&((_u=[128*df.compositeIconSizes[0].evaluate(ks,{},hl),128*df.compositeIconSizes[1].evaluate(ks,{},hl)])[0]>32640||_u[1]>32640)&&A(eo.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),eo.addSymbols(eo.icon,qd,_u,zd,Dd,ks,!1,el,qc.lineStartIndex,qc.lineLength,-1,hl),kh=eo.icon.placedSymbolArray.length-1,Lh&&(Bd=4*Lh.length,eo.addSymbols(eo.icon,Lh,_u,zd,Dd,ks,Ts.vertical,el,qc.lineStartIndex,qc.lineLength,-1,hl),Mh=eo.icon.placedSymbolArray.length-1)}for(var Yd in Hl.horizontal){var mf=Hl.horizontal[Yd];if(!cc){Ud=zr(mf.text);var Gg=fl.layout.get("text-rotate").evaluate(ks,{},hl);cc=new Gu(ff,el,xu,hf,pf,mf,wh,Cd,bu,Gg)}var Wd=mf.positionedLines.length===1;if(Nd+=ud(eo,el,mf,Ld,fl,bu,ks,Pd,qc,Hl.vertical?Ts.horizontal:Ts.horizontalOnly,Wd?Object.keys(Hl.horizontal):[Yd],Al,kh,df,hl),Wd)break}Hl.vertical&&(jd+=ud(eo,el,Hl.vertical,Ld,fl,bu,ks,Pd,qc,Ts.vertical,["vertical"],Al,Mh,df,hl));var Yg=cc?cc.boxStartIndex:eo.collisionBoxArray.length,Wg=cc?cc.boxEndIndex:eo.collisionBoxArray.length,Zg=Vc?Vc.boxStartIndex:eo.collisionBoxArray.length,Xg=Vc?Vc.boxEndIndex:eo.collisionBoxArray.length,Kg=Uc?Uc.boxStartIndex:eo.collisionBoxArray.length,Jg=Uc?Uc.boxEndIndex:eo.collisionBoxArray.length,$g=Hc?Hc.boxStartIndex:eo.collisionBoxArray.length,Qg=Hc?Hc.boxEndIndex:eo.collisionBoxArray.length,pl=-1,gf=function(wu,Xd){return wu&&wu.circleDiameter?Math.max(wu.circleDiameter,Xd):Xd};pl=gf(cc,pl),pl=gf(Vc,pl),pl=gf(Uc,pl);var Zd=(pl=gf(Hc,pl))>-1?1:0;Zd&&(pl*=Hg/24),eo.glyphOffsetArray.length>=ha.MAX_GLYPHS&&A("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ks.sortKey!==void 0&&eo.addToSortKeyRanges(eo.symbolInstances.length,ks.sortKey),eo.symbolInstances.emplaceBack(el.x,el.y,Al.right>=0?Al.right:-1,Al.center>=0?Al.center:-1,Al.left>=0?Al.left:-1,Al.vertical||-1,kh,Mh,Ud,Yg,Wg,Zg,Xg,Kg,Jg,$g,Qg,xu,Nd,jd,Fd,Bd,Zd,0,wh,Ah,Sh,pl)}(Bi,yu,Ug,Wa,Za,Ha,Ml,Bi.layers[0],Bi.collisionBoxArray,ta.index,ta.sourceLayerIndex,Bi.index,gh,Ju,ef,ts,Ku,$u,Ul,Js,ta,za,ys,Wo,la)};if(Dc==="line")for(var pu=0,rf=od(ta.geometry,0,0,8192,8192);pu<rf.length;pu+=1)for(var nf=rf[pu],af=Tg(nf,lc,Qu,Wa.vertical||$s,Za,24,Oc,Bi.overscaling,8192),du=0,of=af;du<of.length;du+=1){var mu=of[du],sf=$s;sf&&Sg(Bi,sf.text,tf,mu)||Vl(nf,mu)}else if(Dc==="line-center")for(var gu=0,lf=ta.geometry;gu<lf.length;gu+=1){var Rc=lf[gu];if(Rc.length>1){var Fc=wg(Rc,Qu,Wa.vertical||$s,Za,24,Oc);Fc&&Vl(Rc,Fc)}}else if(ta.type==="Polygon")for(var Bc=0,cf=th(ta.geometry,0);Bc<cf.length;Bc+=1){var Nc=cf[Bc],vu=Mg(Nc,16);Vl(Nc[0],new Ac(vu.x,vu.y,0))}else if(ta.type==="LineString")for(var jc=0,Ad=ta.geometry;jc<Ad.length;jc+=1){var vh=Ad[jc];Vl(vh,new Ac(vh[0].x,vh[0].y,0))}else if(ta.type==="Point")for(var yh=0,Sd=ta.geometry;yh<Sd.length;yh+=1)for(var jg=Sd[yh],xh=0,Ed=jg;xh<Ed.length;xh+=1){var bh=Ed[xh];Vl([bh],new Ac(bh.x,bh.y,0))}}(M,jn,mi,go,ie,bt,ci,Qn,ui,Do,Pe)},An=0,Un=M.features;An<Un.length;An+=1)gn();ke&&M.generateCollisionDebugBuffers()},e.perspective=function(M,O,W,ie,xe){var ke,Pe=1/Math.tan(O/2);return M[0]=Pe/W,M[1]=0,M[2]=0,M[3]=0,M[4]=0,M[5]=Pe,M[6]=0,M[7]=0,M[8]=0,M[9]=0,M[11]=-1,M[12]=0,M[13]=0,M[15]=0,xe!=null&&xe!==1/0?(ke=1/(ie-xe),M[10]=(xe+ie)*ke,M[14]=2*xe*ie*ke):(M[10]=-1,M[14]=-2*ie),M},e.pick=function(M,O){for(var W={},ie=0;ie<O.length;ie++){var xe=O[ie];xe in M&&(W[xe]=M[xe])}return W},e.plugin=bo,e.polygonIntersectsPolygon=qo,e.postMapLoadEvent=Ie,e.postTurnstileEvent=we,e.potpack=Xp,e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.register=Qr,e.registerForPluginStateChange=function(M){return M({pluginStatus:xi,pluginURL:xa}),La.on("pluginStateChange",M),M},e.rotate=function(M,O,W){var ie=O[0],xe=O[1],ke=O[2],Pe=O[3],je=Math.sin(W),tt=Math.cos(W);return M[0]=ie*tt+ke*je,M[1]=xe*tt+Pe*je,M[2]=ie*-je+ke*tt,M[3]=xe*-je+Pe*tt,M},e.rotateX=function(M,O,W){var ie=Math.sin(W),xe=Math.cos(W),ke=O[4],Pe=O[5],je=O[6],tt=O[7],ft=O[8],bt=O[9],Nt=O[10],Kt=O[11];return O!==M&&(M[0]=O[0],M[1]=O[1],M[2]=O[2],M[3]=O[3],M[12]=O[12],M[13]=O[13],M[14]=O[14],M[15]=O[15]),M[4]=ke*xe+ft*ie,M[5]=Pe*xe+bt*ie,M[6]=je*xe+Nt*ie,M[7]=tt*xe+Kt*ie,M[8]=ft*xe-ke*ie,M[9]=bt*xe-Pe*ie,M[10]=Nt*xe-je*ie,M[11]=Kt*xe-tt*ie,M},e.rotateZ=function(M,O,W){var ie=Math.sin(W),xe=Math.cos(W),ke=O[0],Pe=O[1],je=O[2],tt=O[3],ft=O[4],bt=O[5],Nt=O[6],Kt=O[7];return O!==M&&(M[8]=O[8],M[9]=O[9],M[10]=O[10],M[11]=O[11],M[12]=O[12],M[13]=O[13],M[14]=O[14],M[15]=O[15]),M[0]=ke*xe+ft*ie,M[1]=Pe*xe+bt*ie,M[2]=je*xe+Nt*ie,M[3]=tt*xe+Kt*ie,M[4]=ft*xe-ke*ie,M[5]=bt*xe-Pe*ie,M[6]=Nt*xe-je*ie,M[7]=Kt*xe-tt*ie,M},e.scale=function(M,O,W){var ie=W[0],xe=W[1],ke=W[2];return M[0]=O[0]*ie,M[1]=O[1]*ie,M[2]=O[2]*ie,M[3]=O[3]*ie,M[4]=O[4]*xe,M[5]=O[5]*xe,M[6]=O[6]*xe,M[7]=O[7]*xe,M[8]=O[8]*ke,M[9]=O[9]*ke,M[10]=O[10]*ke,M[11]=O[11]*ke,M[12]=O[12],M[13]=O[13],M[14]=O[14],M[15]=O[15],M},e.scale$1=function(M,O,W){return M[0]=O[0]*W,M[1]=O[1]*W,M[2]=O[2]*W,M[3]=O[3]*W,M},e.scale$2=function(M,O,W){return M[0]=O[0]*W,M[1]=O[1]*W,M[2]=O[2]*W,M},e.setCacheLimits=function(M,O){De=M,Oe=O},e.setRTLTextPlugin=function(M,O,W){if(W===void 0&&(W=!1),xi===Ki||xi===Ya||xi===is)throw new Error("setRTLTextPlugin cannot be called multiple times.");xa=N.resolveURL(M),xi=Ki,Mo=O,Ji(),W||aa()},e.sphericalToCartesian=function(M){var O=M[0],W=M[1],ie=M[2];return W+=90,W*=Math.PI/180,ie*=Math.PI/180,{x:O*Math.cos(W)*Math.sin(ie),y:O*Math.sin(W)*Math.sin(ie),z:O*Math.cos(ie)}},e.sqrLen=tu,e.styleSpec=_e,e.sub=Zf,e.symbolSize=_g,e.transformMat3=function(M,O,W){var ie=O[0],xe=O[1],ke=O[2];return M[0]=ie*W[0]+xe*W[3]+ke*W[6],M[1]=ie*W[1]+xe*W[4]+ke*W[7],M[2]=ie*W[2]+xe*W[5]+ke*W[8],M},e.transformMat4=xc,e.translate=function(M,O,W){var ie,xe,ke,Pe,je,tt,ft,bt,Nt,Kt,Wt,fr,Tr=W[0],Br=W[1],Fr=W[2];return O===M?(M[12]=O[0]*Tr+O[4]*Br+O[8]*Fr+O[12],M[13]=O[1]*Tr+O[5]*Br+O[9]*Fr+O[13],M[14]=O[2]*Tr+O[6]*Br+O[10]*Fr+O[14],M[15]=O[3]*Tr+O[7]*Br+O[11]*Fr+O[15]):(ie=O[0],xe=O[1],ke=O[2],Pe=O[3],je=O[4],tt=O[5],ft=O[6],bt=O[7],Nt=O[8],Kt=O[9],Wt=O[10],fr=O[11],M[0]=ie,M[1]=xe,M[2]=ke,M[3]=Pe,M[4]=je,M[5]=tt,M[6]=ft,M[7]=bt,M[8]=Nt,M[9]=Kt,M[10]=Wt,M[11]=fr,M[12]=ie*Tr+je*Br+Nt*Fr+O[12],M[13]=xe*Tr+tt*Br+Kt*Fr+O[13],M[14]=ke*Tr+ft*Br+Wt*Fr+O[14],M[15]=Pe*Tr+bt*Br+fr*Fr+O[15]),M},e.triggerPluginCompletionEvent=Ao,e.uniqueId=u,e.validateCustomStyleLayer=function(M){var O=[],W=M.id;return W===void 0&&O.push({message:"layers."+W+': missing required property "id"'}),M.render===void 0&&O.push({message:"layers."+W+': missing required method "render"'}),M.renderingMode&&M.renderingMode!=="2d"&&M.renderingMode!=="3d"&&O.push({message:"layers."+W+': property "renderingMode" must be either "2d" or "3d"'}),O},e.validateLight=dn,e.validateStyle=$r,e.values=function(M){var O=[];for(var W in M)O.push(M[W]);return O},e.vectorTile=wc,e.version="1.10.1",e.warnOnce=A,e.webpSupported=te,e.window=self,e.wrap=l}),y(0,function(e){function t(Ne){var Ye=typeof Ne;if(Ye==="number"||Ye==="boolean"||Ye==="string"||Ne==null)return JSON.stringify(Ne);if(Array.isArray(Ne)){for(var pe="[",_e=0,Be=Ne;_e<Be.length;_e+=1)pe+=t(Be[_e])+",";return pe+"]"}for(var He=Object.keys(Ne).sort(),Je="{",Ze=0;Ze<He.length;Ze++)Je+=JSON.stringify(He[Ze])+":"+t(Ne[He[Ze]])+",";return Je+"}"}function n(Ne){for(var Ye="",pe=0,_e=e.refProperties;pe<_e.length;pe+=1)Ye+="/"+t(Ne[_e[pe]]);return Ye}var o=function(Ne){this.keyCache={},Ne&&this.replace(Ne)};o.prototype.replace=function(Ne){this._layerConfigs={},this._layers={},this.update(Ne,[])},o.prototype.update=function(Ne,Ye){for(var pe=this,_e=0,Be=Ne;_e<Be.length;_e+=1){var He=Be[_e];this._layerConfigs[He.id]=He;var Je=this._layers[He.id]=e.createStyleLayer(He);Je._featureFilter=e.featureFilter(Je.filter),this.keyCache[He.id]&&delete this.keyCache[He.id]}for(var Ze=0,ct=Ye;Ze<ct.length;Ze+=1){var lt=ct[Ze];delete this.keyCache[lt],delete this._layerConfigs[lt],delete this._layers[lt]}this.familiesBySource={};for(var At=0,Ot=function(Xe,ot){for(var pt={},St=0;St<Xe.length;St++){var Vt=ot&&ot[Xe[St].id]||n(Xe[St]);ot&&(ot[Xe[St].id]=Vt);var Jt=pt[Vt];Jt||(Jt=pt[Vt]=[]),Jt.push(Xe[St])}var qt=[];for(var gr in pt)qt.push(pt[gr]);return qt}(e.values(this._layerConfigs),this.keyCache);At<Ot.length;At+=1){var it=Ot[At].map(function(Xe){return pe._layers[Xe.id]}),ht=it[0];if(ht.visibility!=="none"){var Ut=ht.source||"",Mt=this.familiesBySource[Ut];Mt||(Mt=this.familiesBySource[Ut]={});var It=ht.sourceLayer||"_geojsonTileLayer",Le=Mt[It];Le||(Le=Mt[It]=[]),Le.push(it)}}};var r=function(Ne){var Ye={},pe=[];for(var _e in Ne){var Be=Ne[_e],He=Ye[_e]={};for(var Je in Be){var Ze=Be[+Je];if(Ze&&Ze.bitmap.width!==0&&Ze.bitmap.height!==0){var ct={x:0,y:0,w:Ze.bitmap.width+2,h:Ze.bitmap.height+2};pe.push(ct),He[Je]={rect:ct,metrics:Ze.metrics}}}}var lt=e.potpack(pe),At=lt.w,Ot=lt.h,it=new e.AlphaImage({width:At||1,height:Ot||1});for(var ht in Ne){var Ut=Ne[ht];for(var Mt in Ut){var It=Ut[+Mt];if(It&&It.bitmap.width!==0&&It.bitmap.height!==0){var Le=Ye[ht][Mt].rect;e.AlphaImage.copy(It.bitmap,it,{x:0,y:0},{x:Le.x+1,y:Le.y+1},It.bitmap)}}}this.image=it,this.positions=Ye};e.register("GlyphAtlas",r);var g=function(Ne){this.tileID=new e.OverscaledTileID(Ne.tileID.overscaledZ,Ne.tileID.wrap,Ne.tileID.canonical.z,Ne.tileID.canonical.x,Ne.tileID.canonical.y),this.uid=Ne.uid,this.zoom=Ne.zoom,this.pixelRatio=Ne.pixelRatio,this.tileSize=Ne.tileSize,this.source=Ne.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Ne.showCollisionBoxes,this.collectResourceTiming=!!Ne.collectResourceTiming,this.returnDependencies=!!Ne.returnDependencies,this.promoteId=Ne.promoteId};function c(Ne,Ye,pe){for(var _e=new e.EvaluationParameters(Ye),Be=0,He=Ne;Be<He.length;Be+=1)He[Be].recalculate(_e,pe)}function a(Ne,Ye){var pe=e.getArrayBuffer(Ne.request,function(_e,Be,He,Je){_e?Ye(_e):Be&&Ye(null,{vectorTile:new e.vectorTile.VectorTile(new e.pbf(Be)),rawData:Be,cacheControl:He,expires:Je})});return function(){pe.cancel(),Ye()}}g.prototype.parse=function(Ne,Ye,pe,_e,Be){var He=this;this.status="parsing",this.data=Ne,this.collisionBoxArray=new e.CollisionBoxArray;var Je=new e.DictionaryCoder(Object.keys(Ne.layers).sort()),Ze=new e.FeatureIndex(this.tileID,this.promoteId);Ze.bucketLayerIDs=[];var ct,lt,At,Ot,it={},ht={featureIndex:Ze,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:pe},Ut=Ye.familiesBySource[this.source];for(var Mt in Ut){var It=Ne.layers[Mt];if(It){It.version===1&&e.warnOnce('Vector tile source "'+this.source+'" layer "'+Mt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Le=Je.encode(Mt),Xe=[],ot=0;ot<It.length;ot++){var pt=It.feature(ot),St=Ze.getId(pt,Mt);Xe.push({feature:pt,id:St,index:ot,sourceLayerIndex:Le})}for(var Vt=0,Jt=Ut[Mt];Vt<Jt.length;Vt+=1){var qt=Jt[Vt],gr=qt[0];gr.minzoom&&this.zoom<Math.floor(gr.minzoom)||gr.maxzoom&&this.zoom>=gr.maxzoom||gr.visibility!=="none"&&(c(qt,this.zoom,pe),(it[gr.id]=gr.createBucket({index:Ze.bucketLayerIDs.length,layers:qt,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Le,sourceID:this.source})).populate(Xe,ht,this.tileID.canonical),Ze.bucketLayerIDs.push(qt.map(function(Qt){return Qt.id})))}}}var Cr=e.mapObject(ht.glyphDependencies,function(Qt){return Object.keys(Qt).map(Number)});Object.keys(Cr).length?_e.send("getGlyphs",{uid:this.uid,stacks:Cr},function(Qt,dr){ct||(ct=Qt,lt=dr,nr.call(He))}):lt={};var mr=Object.keys(ht.iconDependencies);mr.length?_e.send("getImages",{icons:mr,source:this.source,tileID:this.tileID,type:"icons"},function(Qt,dr){ct||(ct=Qt,At=dr,nr.call(He))}):At={};var tr=Object.keys(ht.patternDependencies);function nr(){if(ct)return Be(ct);if(lt&&At&&Ot){var Qt=new r(lt),dr=new e.ImageAtlas(At,Ot);for(var _r in it){var Ir=it[_r];Ir instanceof e.SymbolBucket?(c(Ir.layers,this.zoom,pe),e.performSymbolLayout(Ir,lt,Qt.positions,At,dr.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Ir.hasPattern&&(Ir instanceof e.LineBucket||Ir instanceof e.FillBucket||Ir instanceof e.FillExtrusionBucket)&&(c(Ir.layers,this.zoom,pe),Ir.addFeatures(ht,this.tileID.canonical,dr.patternPositions))}this.status="done",Be(null,{buckets:e.values(it).filter(function(Rr){return!Rr.isEmpty()}),featureIndex:Ze,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Qt.image,imageAtlas:dr,glyphMap:this.returnDependencies?lt:null,iconMap:this.returnDependencies?At:null,glyphPositions:this.returnDependencies?Qt.positions:null})}}tr.length?_e.send("getImages",{icons:tr,source:this.source,tileID:this.tileID,type:"patterns"},function(Qt,dr){ct||(ct=Qt,Ot=dr,nr.call(He))}):Ot={},nr.call(this)};var h=function(Ne,Ye,pe,_e){this.actor=Ne,this.layerIndex=Ye,this.availableImages=pe,this.loadVectorData=_e||a,this.loading={},this.loaded={}};h.prototype.loadTile=function(Ne,Ye){var pe=this,_e=Ne.uid;this.loading||(this.loading={});var Be=!!(Ne&&Ne.request&&Ne.request.collectResourceTiming)&&new e.RequestPerformance(Ne.request),He=this.loading[_e]=new g(Ne);He.abort=this.loadVectorData(Ne,function(Je,Ze){if(delete pe.loading[_e],Je||!Ze)return He.status="done",pe.loaded[_e]=He,Ye(Je);var ct=Ze.rawData,lt={};Ze.expires&&(lt.expires=Ze.expires),Ze.cacheControl&&(lt.cacheControl=Ze.cacheControl);var At={};if(Be){var Ot=Be.finish();Ot&&(At.resourceTiming=JSON.parse(JSON.stringify(Ot)))}He.vectorTile=Ze.vectorTile,He.parse(Ze.vectorTile,pe.layerIndex,pe.availableImages,pe.actor,function(it,ht){if(it||!ht)return Ye(it);Ye(null,e.extend({rawTileData:ct.slice(0)},ht,lt,At))}),pe.loaded=pe.loaded||{},pe.loaded[_e]=He})},h.prototype.reloadTile=function(Ne,Ye){var pe=this,_e=this.loaded,Be=Ne.uid,He=this;if(_e&&_e[Be]){var Je=_e[Be];Je.showCollisionBoxes=Ne.showCollisionBoxes;var Ze=function(ct,lt){var At=Je.reloadCallback;At&&(delete Je.reloadCallback,Je.parse(Je.vectorTile,He.layerIndex,pe.availableImages,He.actor,At)),Ye(ct,lt)};Je.status==="parsing"?Je.reloadCallback=Ze:Je.status==="done"&&(Je.vectorTile?Je.parse(Je.vectorTile,this.layerIndex,this.availableImages,this.actor,Ze):Ze())}},h.prototype.abortTile=function(Ne,Ye){var pe=this.loading,_e=Ne.uid;pe&&pe[_e]&&pe[_e].abort&&(pe[_e].abort(),delete pe[_e]),Ye()},h.prototype.removeTile=function(Ne,Ye){var pe=this.loaded,_e=Ne.uid;pe&&pe[_e]&&delete pe[_e],Ye()};var l=e.window.ImageBitmap,s=function(){this.loaded={}};s.prototype.loadTile=function(Ne,Ye){var pe=Ne.uid,_e=Ne.encoding,Be=Ne.rawImageData,He=l&&Be instanceof l?this.getImageData(Be):Be,Je=new e.DEMData(pe,He,_e);this.loaded=this.loaded||{},this.loaded[pe]=Je,Ye(null,Je)},s.prototype.getImageData=function(Ne){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Ne.width,Ne.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Ne.width,this.offscreenCanvas.height=Ne.height,this.offscreenCanvasContext.drawImage(Ne,0,0,Ne.width,Ne.height);var Ye=this.offscreenCanvasContext.getImageData(-1,-1,Ne.width+2,Ne.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new e.RGBAImage({width:Ye.width,height:Ye.height},Ye.data)},s.prototype.removeTile=function(Ne){var Ye=this.loaded,pe=Ne.uid;Ye&&Ye[pe]&&delete Ye[pe]};var p=function Ne(Ye,pe){var _e,Be=Ye&&Ye.type;if(Be==="FeatureCollection")for(_e=0;_e<Ye.features.length;_e++)Ne(Ye.features[_e],pe);else if(Be==="GeometryCollection")for(_e=0;_e<Ye.geometries.length;_e++)Ne(Ye.geometries[_e],pe);else if(Be==="Feature")Ne(Ye.geometry,pe);else if(Be==="Polygon")u(Ye.coordinates,pe);else if(Be==="MultiPolygon")for(_e=0;_e<Ye.coordinates.length;_e++)u(Ye.coordinates[_e],pe);return Ye};function u(Ne,Ye){if(Ne.length!==0){i(Ne[0],Ye);for(var pe=1;pe<Ne.length;pe++)i(Ne[pe],!Ye)}}function i(Ne,Ye){for(var pe=0,_e=0,Be=Ne.length,He=Be-1;_e<Be;He=_e++)pe+=(Ne[_e][0]-Ne[He][0])*(Ne[He][1]+Ne[_e][1]);pe>=0!=!!Ye&&Ne.reverse()}var x=e.vectorTile.VectorTileFeature.prototype.toGeoJSON,f=function(Ne){this._feature=Ne,this.extent=e.EXTENT,this.type=Ne.type,this.properties=Ne.tags,"id"in Ne&&!isNaN(Ne.id)&&(this.id=parseInt(Ne.id,10))};f.prototype.loadGeometry=function(){if(this._feature.type===1){for(var Ne=[],Ye=0,pe=this._feature.geometry;Ye<pe.length;Ye+=1){var _e=pe[Ye];Ne.push([new e.Point$1(_e[0],_e[1])])}return Ne}for(var Be=[],He=0,Je=this._feature.geometry;He<Je.length;He+=1){for(var Ze=[],ct=0,lt=Je[He];ct<lt.length;ct+=1){var At=lt[ct];Ze.push(new e.Point$1(At[0],At[1]))}Be.push(Ze)}return Be},f.prototype.toGeoJSON=function(Ne,Ye,pe){return x.call(this,Ne,Ye,pe)};var _=function(Ne){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=Ne.length,this._features=Ne};_.prototype.feature=function(Ne){return new f(this._features[Ne])};var b=e.vectorTile.VectorTileFeature,T=k;function k(Ne,Ye){this.options=Ye||{},this.features=Ne,this.length=Ne.length}function L(Ne,Ye){this.id=typeof Ne.id=="number"?Ne.id:void 0,this.type=Ne.type,this.rawGeometry=Ne.type===1?[Ne.geometry]:Ne.geometry,this.properties=Ne.tags,this.extent=Ye||4096}k.prototype.feature=function(Ne){return new L(this.features[Ne],this.options.extent)},L.prototype.loadGeometry=function(){var Ne=this.rawGeometry;this.geometry=[];for(var Ye=0;Ye<Ne.length;Ye++){for(var pe=Ne[Ye],_e=[],Be=0;Be<pe.length;Be++)_e.push(new e.Point$1(pe[Be][0],pe[Be][1]));this.geometry.push(_e)}return this.geometry},L.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ne=this.geometry,Ye=1/0,pe=-1/0,_e=1/0,Be=-1/0,He=0;He<Ne.length;He++)for(var Je=Ne[He],Ze=0;Ze<Je.length;Ze++){var ct=Je[Ze];Ye=Math.min(Ye,ct.x),pe=Math.max(pe,ct.x),_e=Math.min(_e,ct.y),Be=Math.max(Be,ct.y)}return[Ye,_e,pe,Be]},L.prototype.toGeoJSON=b.prototype.toGeoJSON;var A=E,I=E,P=function(Ne,Ye){Ye=Ye||{};var pe={};for(var _e in Ne)pe[_e]=new T(Ne[_e].features,Ye),pe[_e].name=_e,pe[_e].version=Ye.version,pe[_e].extent=Ye.extent;return E({layers:pe})},S=T;function E(Ne){var Ye=new e.pbf;return function(pe,_e){for(var Be in pe.layers)_e.writeMessage(3,z,pe.layers[Be])}(Ne,Ye),Ye.finish()}function z(Ne,Ye){var pe;Ye.writeVarintField(15,Ne.version||1),Ye.writeStringField(1,Ne.name||""),Ye.writeVarintField(5,Ne.extent||4096);var _e={keys:[],values:[],keycache:{},valuecache:{}};for(pe=0;pe<Ne.length;pe++)_e.feature=Ne.feature(pe),Ye.writeMessage(2,D,_e);var Be=_e.keys;for(pe=0;pe<Be.length;pe++)Ye.writeStringField(3,Be[pe]);var He=_e.values;for(pe=0;pe<He.length;pe++)Ye.writeMessage(4,X,He[pe])}function D(Ne,Ye){var pe=Ne.feature;pe.id!==void 0&&Ye.writeVarintField(1,pe.id),Ye.writeMessage(2,j,Ne),Ye.writeVarintField(3,pe.type),Ye.writeMessage(4,Q,pe)}function j(Ne,Ye){var pe=Ne.feature,_e=Ne.keys,Be=Ne.values,He=Ne.keycache,Je=Ne.valuecache;for(var Ze in pe.properties){var ct=He[Ze];ct===void 0&&(_e.push(Ze),ct=_e.length-1,He[Ze]=ct),Ye.writeVarint(ct);var lt=pe.properties[Ze],At=typeof lt;At!=="string"&&At!=="boolean"&&At!=="number"&&(lt=JSON.stringify(lt));var Ot=At+":"+lt,it=Je[Ot];it===void 0&&(Be.push(lt),it=Be.length-1,Je[Ot]=it),Ye.writeVarint(it)}}function V(Ne,Ye){return(Ye<<3)+(7&Ne)}function Z(Ne){return Ne<<1^Ne>>31}function Q(Ne,Ye){for(var pe=Ne.loadGeometry(),_e=Ne.type,Be=0,He=0,Je=pe.length,Ze=0;Ze<Je;Ze++){var ct=pe[Ze],lt=1;_e===1&&(lt=ct.length),Ye.writeVarint(V(1,lt));for(var At=_e===3?ct.length-1:ct.length,Ot=0;Ot<At;Ot++){Ot===1&&_e!==1&&Ye.writeVarint(V(2,At-1));var it=ct[Ot].x-Be,ht=ct[Ot].y-He;Ye.writeVarint(Z(it)),Ye.writeVarint(Z(ht)),Be+=it,He+=ht}_e===3&&Ye.writeVarint(V(7,1))}}function X(Ne,Ye){var pe=typeof Ne;pe==="string"?Ye.writeStringField(1,Ne):pe==="boolean"?Ye.writeBooleanField(7,Ne):pe==="number"&&(Ne%1!=0?Ye.writeDoubleField(3,Ne):Ne<0?Ye.writeSVarintField(6,Ne):Ye.writeVarintField(5,Ne))}function $(Ne,Ye,pe,_e,Be,He){if(!(Be-_e<=pe)){var Je=_e+Be>>1;(function Ze(ct,lt,At,Ot,it,ht){for(;it>Ot;){if(it-Ot>600){var Ut=it-Ot+1,Mt=At-Ot+1,It=Math.log(Ut),Le=.5*Math.exp(2*It/3),Xe=.5*Math.sqrt(It*Le*(Ut-Le)/Ut)*(Mt-Ut/2<0?-1:1),ot=Math.max(Ot,Math.floor(At-Mt*Le/Ut+Xe)),pt=Math.min(it,Math.floor(At+(Ut-Mt)*Le/Ut+Xe));Ze(ct,lt,At,ot,pt,ht)}var St=lt[2*At+ht],Vt=Ot,Jt=it;for(re(ct,lt,Ot,At),lt[2*it+ht]>St&&re(ct,lt,Ot,it);Vt<Jt;){for(re(ct,lt,Vt,Jt),Vt++,Jt--;lt[2*Vt+ht]<St;)Vt++;for(;lt[2*Jt+ht]>St;)Jt--}lt[2*Ot+ht]===St?re(ct,lt,Ot,Jt):(Jt++,re(ct,lt,Jt,it)),Jt<=At&&(Ot=Jt+1),At<=Jt&&(it=Jt-1)}})(Ne,Ye,Je,_e,Be,He%2),$(Ne,Ye,pe,_e,Je-1,He+1),$(Ne,Ye,pe,Je+1,Be,He+1)}}function re(Ne,Ye,pe,_e){H(Ne,pe,_e),H(Ye,2*pe,2*_e),H(Ye,2*pe+1,2*_e+1)}function H(Ne,Ye,pe){var _e=Ne[Ye];Ne[Ye]=Ne[pe],Ne[pe]=_e}function N(Ne,Ye,pe,_e){var Be=Ne-pe,He=Ye-_e;return Be*Be+He*He}A.fromVectorTileJs=I,A.fromGeojsonVt=P,A.GeoJSONWrapper=S;var U=function(Ne){return Ne[0]},te=function(Ne){return Ne[1]},B=function(Ne,Ye,pe,_e,Be){Ye===void 0&&(Ye=U),pe===void 0&&(pe=te),_e===void 0&&(_e=64),Be===void 0&&(Be=Float64Array),this.nodeSize=_e,this.points=Ne;for(var He=Ne.length<65536?Uint16Array:Uint32Array,Je=this.ids=new He(Ne.length),Ze=this.coords=new Be(2*Ne.length),ct=0;ct<Ne.length;ct++)Je[ct]=ct,Ze[2*ct]=Ye(Ne[ct]),Ze[2*ct+1]=pe(Ne[ct]);$(Je,Ze,_e,0,Je.length-1,0)};B.prototype.range=function(Ne,Ye,pe,_e){return function(Be,He,Je,Ze,ct,lt,At){for(var Ot,it,ht=[0,Be.length-1,0],Ut=[];ht.length;){var Mt=ht.pop(),It=ht.pop(),Le=ht.pop();if(It-Le<=At)for(var Xe=Le;Xe<=It;Xe++)Ot=He[2*Xe],it=He[2*Xe+1],Ot>=Je&&Ot<=ct&&it>=Ze&&it<=lt&&Ut.push(Be[Xe]);else{var ot=Math.floor((Le+It)/2);Ot=He[2*ot],it=He[2*ot+1],Ot>=Je&&Ot<=ct&&it>=Ze&&it<=lt&&Ut.push(Be[ot]);var pt=(Mt+1)%2;(Mt===0?Je<=Ot:Ze<=it)&&(ht.push(Le),ht.push(ot-1),ht.push(pt)),(Mt===0?ct>=Ot:lt>=it)&&(ht.push(ot+1),ht.push(It),ht.push(pt))}}return Ut}(this.ids,this.coords,Ne,Ye,pe,_e,this.nodeSize)},B.prototype.within=function(Ne,Ye,pe){return function(_e,Be,He,Je,Ze,ct){for(var lt=[0,_e.length-1,0],At=[],Ot=Ze*Ze;lt.length;){var it=lt.pop(),ht=lt.pop(),Ut=lt.pop();if(ht-Ut<=ct)for(var Mt=Ut;Mt<=ht;Mt++)N(Be[2*Mt],Be[2*Mt+1],He,Je)<=Ot&&At.push(_e[Mt]);else{var It=Math.floor((Ut+ht)/2),Le=Be[2*It],Xe=Be[2*It+1];N(Le,Xe,He,Je)<=Ot&&At.push(_e[It]);var ot=(it+1)%2;(it===0?He-Ze<=Le:Je-Ze<=Xe)&&(lt.push(Ut),lt.push(It-1),lt.push(ot)),(it===0?He+Ze>=Le:Je+Ze>=Xe)&&(lt.push(It+1),lt.push(ht),lt.push(ot))}}return At}(this.ids,this.coords,Ne,Ye,pe,this.nodeSize)};var K={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Ne){return Ne}},J=function(Ne){this.options=ye(Object.create(K),Ne),this.trees=new Array(this.options.maxZoom+1)};function ee(Ne,Ye,pe,_e,Be){return{x:Ne,y:Ye,zoom:1/0,id:pe,parentId:-1,numPoints:_e,properties:Be}}function ne(Ne,Ye){var pe=Ne.geometry.coordinates,_e=pe[0],Be=pe[1];return{x:me(_e),y:ce(Be),zoom:1/0,index:Ye,parentId:-1}}function se(Ne){return{type:"Feature",id:Ne.id,properties:oe(Ne),geometry:{type:"Point",coordinates:[(_e=Ne.x,360*(_e-.5)),(Ye=Ne.y,pe=(180-360*Ye)*Math.PI/180,360*Math.atan(Math.exp(pe))/Math.PI-90)]}};var Ye,pe,_e}function oe(Ne){var Ye=Ne.numPoints,pe=Ye>=1e4?Math.round(Ye/1e3)+"k":Ye>=1e3?Math.round(Ye/100)/10+"k":Ye;return ye(ye({},Ne.properties),{cluster:!0,cluster_id:Ne.id,point_count:Ye,point_count_abbreviated:pe})}function me(Ne){return Ne/360+.5}function ce(Ne){var Ye=Math.sin(Ne*Math.PI/180),pe=.5-.25*Math.log((1+Ye)/(1-Ye))/Math.PI;return pe<0?0:pe>1?1:pe}function ye(Ne,Ye){for(var pe in Ye)Ne[pe]=Ye[pe];return Ne}function Se(Ne){return Ne.x}function fe(Ne){return Ne.y}function ge(Ne,Ye,pe,_e,Be,He){var Je=Be-pe,Ze=He-_e;if(Je!==0||Ze!==0){var ct=((Ne-pe)*Je+(Ye-_e)*Ze)/(Je*Je+Ze*Ze);ct>1?(pe=Be,_e=He):ct>0&&(pe+=Je*ct,_e+=Ze*ct)}return(Je=Ne-pe)*Je+(Ze=Ye-_e)*Ze}function Te(Ne,Ye,pe,_e){var Be={id:Ne===void 0?null:Ne,type:Ye,geometry:pe,tags:_e,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(He){var Je=He.geometry,Ze=He.type;if(Ze==="Point"||Ze==="MultiPoint"||Ze==="LineString")le(He,Je);else if(Ze==="Polygon"||Ze==="MultiLineString")for(var ct=0;ct<Je.length;ct++)le(He,Je[ct]);else if(Ze==="MultiPolygon")for(ct=0;ct<Je.length;ct++)for(var lt=0;lt<Je[ct].length;lt++)le(He,Je[ct][lt])}(Be),Be}function le(Ne,Ye){for(var pe=0;pe<Ye.length;pe+=3)Ne.minX=Math.min(Ne.minX,Ye[pe]),Ne.minY=Math.min(Ne.minY,Ye[pe+1]),Ne.maxX=Math.max(Ne.maxX,Ye[pe]),Ne.maxY=Math.max(Ne.maxY,Ye[pe+1])}function ve(Ne,Ye,pe,_e){if(Ye.geometry){var Be=Ye.geometry.coordinates,He=Ye.geometry.type,Je=Math.pow(pe.tolerance/((1<<pe.maxZoom)*pe.extent),2),Ze=[],ct=Ye.id;if(pe.promoteId?ct=Ye.properties[pe.promoteId]:pe.generateId&&(ct=_e||0),He==="Point")Me(Be,Ze);else if(He==="MultiPoint")for(var lt=0;lt<Be.length;lt++)Me(Be[lt],Ze);else if(He==="LineString")we(Be,Ze,Je,!1);else if(He==="MultiLineString"){if(pe.lineMetrics){for(lt=0;lt<Be.length;lt++)Ze=[],we(Be[lt],Ze,Je,!1),Ne.push(Te(ct,"LineString",Ze,Ye.properties));return}de(Be,Ze,Je,!1)}else if(He==="Polygon")de(Be,Ze,Je,!0);else{if(He!=="MultiPolygon"){if(He==="GeometryCollection"){for(lt=0;lt<Ye.geometry.geometries.length;lt++)ve(Ne,{id:ct,geometry:Ye.geometry.geometries[lt],properties:Ye.properties},pe,_e);return}throw new Error("Input data is not a valid GeoJSON object.")}for(lt=0;lt<Be.length;lt++){var At=[];de(Be[lt],At,Je,!0),Ze.push(At)}}Ne.push(Te(ct,He,Ze,Ye.properties))}}function Me(Ne,Ye){Ye.push(Ie(Ne[0])),Ye.push(De(Ne[1])),Ye.push(0)}function we(Ne,Ye,pe,_e){for(var Be,He,Je=0,Ze=0;Ze<Ne.length;Ze++){var ct=Ie(Ne[Ze][0]),lt=De(Ne[Ze][1]);Ye.push(ct),Ye.push(lt),Ye.push(0),Ze>0&&(Je+=_e?(Be*lt-ct*He)/2:Math.sqrt(Math.pow(ct-Be,2)+Math.pow(lt-He,2))),Be=ct,He=lt}var At=Ye.length-3;Ye[2]=1,function Ot(it,ht,Ut,Mt){for(var It,Le=Mt,Xe=Ut-ht>>1,ot=Ut-ht,pt=it[ht],St=it[ht+1],Vt=it[Ut],Jt=it[Ut+1],qt=ht+3;qt<Ut;qt+=3){var gr=ge(it[qt],it[qt+1],pt,St,Vt,Jt);if(gr>Le)It=qt,Le=gr;else if(gr===Le){var Cr=Math.abs(qt-Xe);Cr<ot&&(It=qt,ot=Cr)}}Le>Mt&&(It-ht>3&&Ot(it,ht,It,Mt),it[It+2]=Le,Ut-It>3&&Ot(it,It,Ut,Mt))}(Ye,0,At,pe),Ye[At+2]=1,Ye.size=Math.abs(Je),Ye.start=0,Ye.end=Ye.size}function de(Ne,Ye,pe,_e){for(var Be=0;Be<Ne.length;Be++){var He=[];we(Ne[Be],He,pe,_e),Ye.push(He)}}function Ie(Ne){return Ne/360+.5}function De(Ne){var Ye=Math.sin(Ne*Math.PI/180),pe=.5-.25*Math.log((1+Ye)/(1-Ye))/Math.PI;return pe<0?0:pe>1?1:pe}function Oe(Ne,Ye,pe,_e,Be,He,Je,Ze){if(_e/=Ye,He>=(pe/=Ye)&&Je<_e)return Ne;if(Je<pe||He>=_e)return null;for(var ct=[],lt=0;lt<Ne.length;lt++){var At=Ne[lt],Ot=At.geometry,it=At.type,ht=Be===0?At.minX:At.minY,Ut=Be===0?At.maxX:At.maxY;if(ht>=pe&&Ut<_e)ct.push(At);else if(!(Ut<pe||ht>=_e)){var Mt=[];if(it==="Point"||it==="MultiPoint")Ve(Ot,Mt,pe,_e,Be);else if(it==="LineString")Fe(Ot,Mt,pe,_e,Be,!1,Ze.lineMetrics);else if(it==="MultiLineString")Re(Ot,Mt,pe,_e,Be,!1);else if(it==="Polygon")Re(Ot,Mt,pe,_e,Be,!0);else if(it==="MultiPolygon")for(var It=0;It<Ot.length;It++){var Le=[];Re(Ot[It],Le,pe,_e,Be,!0),Le.length&&Mt.push(Le)}if(Mt.length){if(Ze.lineMetrics&&it==="LineString"){for(It=0;It<Mt.length;It++)ct.push(Te(At.id,it,Mt[It],At.tags));continue}it!=="LineString"&&it!=="MultiLineString"||(Mt.length===1?(it="LineString",Mt=Mt[0]):it="MultiLineString"),it!=="Point"&&it!=="MultiPoint"||(it=Mt.length===3?"Point":"MultiPoint"),ct.push(Te(At.id,it,Mt,At.tags))}}}return ct.length?ct:null}function Ve(Ne,Ye,pe,_e,Be){for(var He=0;He<Ne.length;He+=3){var Je=Ne[He+Be];Je>=pe&&Je<=_e&&(Ye.push(Ne[He]),Ye.push(Ne[He+1]),Ye.push(Ne[He+2]))}}function Fe(Ne,Ye,pe,_e,Be,He,Je){for(var Ze,ct,lt=ze(Ne),At=Be===0?$e:at,Ot=Ne.start,it=0;it<Ne.length-3;it+=3){var ht=Ne[it],Ut=Ne[it+1],Mt=Ne[it+2],It=Ne[it+3],Le=Ne[it+4],Xe=Be===0?ht:Ut,ot=Be===0?It:Le,pt=!1;Je&&(Ze=Math.sqrt(Math.pow(ht-It,2)+Math.pow(Ut-Le,2))),Xe<pe?ot>pe&&(ct=At(lt,ht,Ut,It,Le,pe),Je&&(lt.start=Ot+Ze*ct)):Xe>_e?ot<_e&&(ct=At(lt,ht,Ut,It,Le,_e),Je&&(lt.start=Ot+Ze*ct)):We(lt,ht,Ut,Mt),ot<pe&&Xe>=pe&&(ct=At(lt,ht,Ut,It,Le,pe),pt=!0),ot>_e&&Xe<=_e&&(ct=At(lt,ht,Ut,It,Le,_e),pt=!0),!He&&pt&&(Je&&(lt.end=Ot+Ze*ct),Ye.push(lt),lt=ze(Ne)),Je&&(Ot+=Ze)}var St=Ne.length-3;ht=Ne[St],Ut=Ne[St+1],Mt=Ne[St+2],(Xe=Be===0?ht:Ut)>=pe&&Xe<=_e&&We(lt,ht,Ut,Mt),St=lt.length-3,He&&St>=3&&(lt[St]!==lt[0]||lt[St+1]!==lt[1])&&We(lt,lt[0],lt[1],lt[2]),lt.length&&Ye.push(lt)}function ze(Ne){var Ye=[];return Ye.size=Ne.size,Ye.start=Ne.start,Ye.end=Ne.end,Ye}function Re(Ne,Ye,pe,_e,Be,He){for(var Je=0;Je<Ne.length;Je++)Fe(Ne[Je],Ye,pe,_e,Be,He,!1)}function We(Ne,Ye,pe,_e){Ne.push(Ye),Ne.push(pe),Ne.push(_e)}function $e(Ne,Ye,pe,_e,Be,He){var Je=(He-Ye)/(_e-Ye);return Ne.push(He),Ne.push(pe+(Be-pe)*Je),Ne.push(1),Je}function at(Ne,Ye,pe,_e,Be,He){var Je=(He-pe)/(Be-pe);return Ne.push(Ye+(_e-Ye)*Je),Ne.push(He),Ne.push(1),Je}function gt(Ne,Ye){for(var pe=[],_e=0;_e<Ne.length;_e++){var Be,He=Ne[_e],Je=He.type;if(Je==="Point"||Je==="MultiPoint"||Je==="LineString")Be=xt(He.geometry,Ye);else if(Je==="MultiLineString"||Je==="Polygon"){Be=[];for(var Ze=0;Ze<He.geometry.length;Ze++)Be.push(xt(He.geometry[Ze],Ye))}else if(Je==="MultiPolygon")for(Be=[],Ze=0;Ze<He.geometry.length;Ze++){for(var ct=[],lt=0;lt<He.geometry[Ze].length;lt++)ct.push(xt(He.geometry[Ze][lt],Ye));Be.push(ct)}pe.push(Te(He.id,Je,Be,He.tags))}return pe}function xt(Ne,Ye){var pe=[];pe.size=Ne.size,Ne.start!==void 0&&(pe.start=Ne.start,pe.end=Ne.end);for(var _e=0;_e<Ne.length;_e+=3)pe.push(Ne[_e]+Ye,Ne[_e+1],Ne[_e+2]);return pe}function mt(Ne,Ye){if(Ne.transformed)return Ne;var pe,_e,Be,He=1<<Ne.z,Je=Ne.x,Ze=Ne.y;for(pe=0;pe<Ne.features.length;pe++){var ct=Ne.features[pe],lt=ct.geometry,At=ct.type;if(ct.geometry=[],At===1)for(_e=0;_e<lt.length;_e+=2)ct.geometry.push(nt(lt[_e],lt[_e+1],Ye,He,Je,Ze));else for(_e=0;_e<lt.length;_e++){var Ot=[];for(Be=0;Be<lt[_e].length;Be+=2)Ot.push(nt(lt[_e][Be],lt[_e][Be+1],Ye,He,Je,Ze));ct.geometry.push(Ot)}}return Ne.transformed=!0,Ne}function nt(Ne,Ye,pe,_e,Be,He){return[Math.round(pe*(Ne*_e-Be)),Math.round(pe*(Ye*_e-He))]}function Qe(Ne,Ye,pe,_e,Be){for(var He=Ye===Be.maxZoom?0:Be.tolerance/((1<<Ye)*Be.extent),Je={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:pe,y:_e,z:Ye,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ze=0;Ze<Ne.length;Ze++){Je.numFeatures++,vt(Je,Ne[Ze],He,Be);var ct=Ne[Ze].minX,lt=Ne[Ze].minY,At=Ne[Ze].maxX,Ot=Ne[Ze].maxY;ct<Je.minX&&(Je.minX=ct),lt<Je.minY&&(Je.minY=lt),At>Je.maxX&&(Je.maxX=At),Ot>Je.maxY&&(Je.maxY=Ot)}return Je}function vt(Ne,Ye,pe,_e){var Be=Ye.geometry,He=Ye.type,Je=[];if(He==="Point"||He==="MultiPoint")for(var Ze=0;Ze<Be.length;Ze+=3)Je.push(Be[Ze]),Je.push(Be[Ze+1]),Ne.numPoints++,Ne.numSimplified++;else if(He==="LineString")jt(Je,Be,Ne,pe,!1,!1);else if(He==="MultiLineString"||He==="Polygon")for(Ze=0;Ze<Be.length;Ze++)jt(Je,Be[Ze],Ne,pe,He==="Polygon",Ze===0);else if(He==="MultiPolygon")for(var ct=0;ct<Be.length;ct++){var lt=Be[ct];for(Ze=0;Ze<lt.length;Ze++)jt(Je,lt[Ze],Ne,pe,!0,Ze===0)}if(Je.length){var At=Ye.tags||null;if(He==="LineString"&&_e.lineMetrics){for(var Ot in At={},Ye.tags)At[Ot]=Ye.tags[Ot];At.mapbox_clip_start=Be.start/Be.size,At.mapbox_clip_end=Be.end/Be.size}var it={geometry:Je,type:He==="Polygon"||He==="MultiPolygon"?3:He==="LineString"||He==="MultiLineString"?2:1,tags:At};Ye.id!==null&&(it.id=Ye.id),Ne.features.push(it)}}function jt(Ne,Ye,pe,_e,Be,He){var Je=_e*_e;if(_e>0&&Ye.size<(Be?Je:_e))pe.numPoints+=Ye.length/3;else{for(var Ze=[],ct=0;ct<Ye.length;ct+=3)(_e===0||Ye[ct+2]>Je)&&(pe.numSimplified++,Ze.push(Ye[ct]),Ze.push(Ye[ct+1])),pe.numPoints++;Be&&function(lt,At){for(var Ot=0,it=0,ht=lt.length,Ut=ht-2;it<ht;Ut=it,it+=2)Ot+=(lt[it]-lt[Ut])*(lt[it+1]+lt[Ut+1]);if(Ot>0===At)for(it=0,ht=lt.length;it<ht/2;it+=2){var Mt=lt[it],It=lt[it+1];lt[it]=lt[ht-2-it],lt[it+1]=lt[ht-1-it],lt[ht-2-it]=Mt,lt[ht-1-it]=It}}(Ze,He),Ne.push(Ze)}}function Gt(Ne,Ye){var pe=(Ye=this.options=function(Be,He){for(var Je in He)Be[Je]=He[Je];return Be}(Object.create(this.options),Ye)).debug;if(pe&&console.time("preprocess data"),Ye.maxZoom<0||Ye.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ye.promoteId&&Ye.generateId)throw new Error("promoteId and generateId cannot be used together.");var _e=function(Be,He){var Je=[];if(Be.type==="FeatureCollection")for(var Ze=0;Ze<Be.features.length;Ze++)ve(Je,Be.features[Ze],He,Ze);else Be.type==="Feature"?ve(Je,Be,He):ve(Je,{geometry:Be},He);return Je}(Ne,Ye);this.tiles={},this.tileCoords=[],pe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ye.indexMaxZoom,Ye.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(_e=function(Be,He){var Je=He.buffer/He.extent,Ze=Be,ct=Oe(Be,1,-1-Je,Je,0,-1,2,He),lt=Oe(Be,1,1-Je,2+Je,0,-1,2,He);return(ct||lt)&&(Ze=Oe(Be,1,-Je,1+Je,0,-1,2,He)||[],ct&&(Ze=gt(ct,1).concat(Ze)),lt&&(Ze=Ze.concat(gt(lt,-1)))),Ze}(_e,Ye)).length&&this.splitTile(_e,0,0,0),pe&&(_e.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function $t(Ne,Ye,pe){return 32*((1<<Ne)*pe+Ye)+Ne}function Zt(Ne,Ye){var pe=Ne.tileID.canonical;if(!this._geoJSONIndex)return Ye(null,null);var _e=this._geoJSONIndex.getTile(pe.z,pe.x,pe.y);if(!_e)return Ye(null,null);var Be=new _(_e.features),He=A(Be);He.byteOffset===0&&He.byteLength===He.buffer.byteLength||(He=new Uint8Array(He)),Ye(null,{vectorTile:Be,rawData:He.buffer})}J.prototype.load=function(Ne){var Ye=this.options,pe=Ye.log,_e=Ye.minZoom,Be=Ye.maxZoom,He=Ye.nodeSize;pe&&console.time("total time");var Je="prepare "+Ne.length+" points";pe&&console.time(Je),this.points=Ne;for(var Ze=[],ct=0;ct<Ne.length;ct++)Ne[ct].geometry&&Ze.push(ne(Ne[ct],ct));this.trees[Be+1]=new B(Ze,Se,fe,He,Float32Array),pe&&console.timeEnd(Je);for(var lt=Be;lt>=_e;lt--){var At=+Date.now();Ze=this._cluster(Ze,lt),this.trees[lt]=new B(Ze,Se,fe,He,Float32Array),pe&&console.log("z%d: %d clusters in %dms",lt,Ze.length,+Date.now()-At)}return pe&&console.timeEnd("total time"),this},J.prototype.getClusters=function(Ne,Ye){var pe=((Ne[0]+180)%360+360)%360-180,_e=Math.max(-90,Math.min(90,Ne[1])),Be=Ne[2]===180?180:((Ne[2]+180)%360+360)%360-180,He=Math.max(-90,Math.min(90,Ne[3]));if(Ne[2]-Ne[0]>=360)pe=-180,Be=180;else if(pe>Be){var Je=this.getClusters([pe,_e,180,He],Ye),Ze=this.getClusters([-180,_e,Be,He],Ye);return Je.concat(Ze)}for(var ct=this.trees[this._limitZoom(Ye)],lt=[],At=0,Ot=ct.range(me(pe),ce(He),me(Be),ce(_e));At<Ot.length;At+=1){var it=Ot[At],ht=ct.points[it];lt.push(ht.numPoints?se(ht):this.points[ht.index])}return lt},J.prototype.getChildren=function(Ne){var Ye=this._getOriginId(Ne),pe=this._getOriginZoom(Ne),_e="No cluster with the specified id.",Be=this.trees[pe];if(!Be)throw new Error(_e);var He=Be.points[Ye];if(!He)throw new Error(_e);for(var Je=this.options.radius/(this.options.extent*Math.pow(2,pe-1)),Ze=[],ct=0,lt=Be.within(He.x,He.y,Je);ct<lt.length;ct+=1){var At=lt[ct],Ot=Be.points[At];Ot.parentId===Ne&&Ze.push(Ot.numPoints?se(Ot):this.points[Ot.index])}if(Ze.length===0)throw new Error(_e);return Ze},J.prototype.getLeaves=function(Ne,Ye,pe){Ye=Ye||10,pe=pe||0;var _e=[];return this._appendLeaves(_e,Ne,Ye,pe,0),_e},J.prototype.getTile=function(Ne,Ye,pe){var _e=this.trees[this._limitZoom(Ne)],Be=Math.pow(2,Ne),He=this.options,Je=He.extent,Ze=He.radius/Je,ct=(pe-Ze)/Be,lt=(pe+1+Ze)/Be,At={features:[]};return this._addTileFeatures(_e.range((Ye-Ze)/Be,ct,(Ye+1+Ze)/Be,lt),_e.points,Ye,pe,Be,At),Ye===0&&this._addTileFeatures(_e.range(1-Ze/Be,ct,1,lt),_e.points,Be,pe,Be,At),Ye===Be-1&&this._addTileFeatures(_e.range(0,ct,Ze/Be,lt),_e.points,-1,pe,Be,At),At.features.length?At:null},J.prototype.getClusterExpansionZoom=function(Ne){for(var Ye=this._getOriginZoom(Ne)-1;Ye<=this.options.maxZoom;){var pe=this.getChildren(Ne);if(Ye++,pe.length!==1)break;Ne=pe[0].properties.cluster_id}return Ye},J.prototype._appendLeaves=function(Ne,Ye,pe,_e,Be){for(var He=0,Je=this.getChildren(Ye);He<Je.length;He+=1){var Ze=Je[He],ct=Ze.properties;if(ct&&ct.cluster?Be+ct.point_count<=_e?Be+=ct.point_count:Be=this._appendLeaves(Ne,ct.cluster_id,pe,_e,Be):Be<_e?Be++:Ne.push(Ze),Ne.length===pe)break}return Be},J.prototype._addTileFeatures=function(Ne,Ye,pe,_e,Be,He){for(var Je=0,Ze=Ne;Je<Ze.length;Je+=1){var ct=Ye[Ze[Je]],lt=ct.numPoints,At={type:1,geometry:[[Math.round(this.options.extent*(ct.x*Be-pe)),Math.round(this.options.extent*(ct.y*Be-_e))]],tags:lt?oe(ct):this.points[ct.index].properties},Ot=void 0;lt?Ot=ct.id:this.options.generateId?Ot=ct.index:this.points[ct.index].id&&(Ot=this.points[ct.index].id),Ot!==void 0&&(At.id=Ot),He.features.push(At)}},J.prototype._limitZoom=function(Ne){return Math.max(this.options.minZoom,Math.min(Ne,this.options.maxZoom+1))},J.prototype._cluster=function(Ne,Ye){for(var pe=[],_e=this.options,Be=_e.radius,He=_e.extent,Je=_e.reduce,Ze=Be/(He*Math.pow(2,Ye)),ct=0;ct<Ne.length;ct++){var lt=Ne[ct];if(!(lt.zoom<=Ye)){lt.zoom=Ye;for(var At=this.trees[Ye+1],Ot=At.within(lt.x,lt.y,Ze),it=lt.numPoints||1,ht=lt.x*it,Ut=lt.y*it,Mt=Je&&it>1?this._map(lt,!0):null,It=(ct<<5)+(Ye+1)+this.points.length,Le=0,Xe=Ot;Le<Xe.length;Le+=1){var ot=Xe[Le],pt=At.points[ot];if(!(pt.zoom<=Ye)){pt.zoom=Ye;var St=pt.numPoints||1;ht+=pt.x*St,Ut+=pt.y*St,it+=St,pt.parentId=It,Je&&(Mt||(Mt=this._map(lt,!0)),Je(Mt,this._map(pt)))}}it===1?pe.push(lt):(lt.parentId=It,pe.push(ee(ht/it,Ut/it,It,it,Mt)))}}return pe},J.prototype._getOriginId=function(Ne){return Ne-this.points.length>>5},J.prototype._getOriginZoom=function(Ne){return(Ne-this.points.length)%32},J.prototype._map=function(Ne,Ye){if(Ne.numPoints)return Ye?ye({},Ne.properties):Ne.properties;var pe=this.points[Ne.index].properties,_e=this.options.map(pe);return Ye&&_e===pe?ye({},_e):_e},Gt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Gt.prototype.splitTile=function(Ne,Ye,pe,_e,Be,He,Je){for(var Ze=[Ne,Ye,pe,_e],ct=this.options,lt=ct.debug;Ze.length;){_e=Ze.pop(),pe=Ze.pop(),Ye=Ze.pop(),Ne=Ze.pop();var At=1<<Ye,Ot=$t(Ye,pe,_e),it=this.tiles[Ot];if(!it&&(lt>1&&console.time("creation"),it=this.tiles[Ot]=Qe(Ne,Ye,pe,_e,ct),this.tileCoords.push({z:Ye,x:pe,y:_e}),lt)){lt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ye,pe,_e,it.numFeatures,it.numPoints,it.numSimplified),console.timeEnd("creation"));var ht="z"+Ye;this.stats[ht]=(this.stats[ht]||0)+1,this.total++}if(it.source=Ne,Be){if(Ye===ct.maxZoom||Ye===Be)continue;var Ut=1<<Be-Ye;if(pe!==Math.floor(He/Ut)||_e!==Math.floor(Je/Ut))continue}else if(Ye===ct.indexMaxZoom||it.numPoints<=ct.indexMaxPoints)continue;if(it.source=null,Ne.length!==0){lt>1&&console.time("clipping");var Mt,It,Le,Xe,ot,pt,St=.5*ct.buffer/ct.extent,Vt=.5-St,Jt=.5+St,qt=1+St;Mt=It=Le=Xe=null,ot=Oe(Ne,At,pe-St,pe+Jt,0,it.minX,it.maxX,ct),pt=Oe(Ne,At,pe+Vt,pe+qt,0,it.minX,it.maxX,ct),Ne=null,ot&&(Mt=Oe(ot,At,_e-St,_e+Jt,1,it.minY,it.maxY,ct),It=Oe(ot,At,_e+Vt,_e+qt,1,it.minY,it.maxY,ct),ot=null),pt&&(Le=Oe(pt,At,_e-St,_e+Jt,1,it.minY,it.maxY,ct),Xe=Oe(pt,At,_e+Vt,_e+qt,1,it.minY,it.maxY,ct),pt=null),lt>1&&console.timeEnd("clipping"),Ze.push(Mt||[],Ye+1,2*pe,2*_e),Ze.push(It||[],Ye+1,2*pe,2*_e+1),Ze.push(Le||[],Ye+1,2*pe+1,2*_e),Ze.push(Xe||[],Ye+1,2*pe+1,2*_e+1)}}},Gt.prototype.getTile=function(Ne,Ye,pe){var _e=this.options,Be=_e.extent,He=_e.debug;if(Ne<0||Ne>24)return null;var Je=1<<Ne,Ze=$t(Ne,Ye=(Ye%Je+Je)%Je,pe);if(this.tiles[Ze])return mt(this.tiles[Ze],Be);He>1&&console.log("drilling down to z%d-%d-%d",Ne,Ye,pe);for(var ct,lt=Ne,At=Ye,Ot=pe;!ct&&lt>0;)lt--,At=Math.floor(At/2),Ot=Math.floor(Ot/2),ct=this.tiles[$t(lt,At,Ot)];return ct&&ct.source?(He>1&&console.log("found parent tile z%d-%d-%d",lt,At,Ot),He>1&&console.time("drilling down"),this.splitTile(ct.source,lt,At,Ot,Ne,Ye,pe),He>1&&console.timeEnd("drilling down"),this.tiles[Ze]?mt(this.tiles[Ze],Be):null):null};var cr=function(Ne){function Ye(pe,_e,Be,He){Ne.call(this,pe,_e,Be,Zt),He&&(this.loadGeoJSON=He)}return Ne&&(Ye.__proto__=Ne),Ye.prototype=Object.create(Ne&&Ne.prototype),Ye.prototype.constructor=Ye,Ye.prototype.loadData=function(pe,_e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=_e,this._pendingLoadDataParams=pe,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},Ye.prototype._loadData=function(){var pe=this;if(this._pendingCallback&&this._pendingLoadDataParams){var _e=this._pendingCallback,Be=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var He=!!(Be&&Be.request&&Be.request.collectResourceTiming)&&new e.RequestPerformance(Be.request);this.loadGeoJSON(Be,function(Je,Ze){if(Je||!Ze)return _e(Je);if(typeof Ze!="object")return _e(new Error("Input data given to '"+Be.source+"' is not a valid GeoJSON object."));p(Ze,!0);try{pe._geoJSONIndex=Be.cluster?new J(function(At){var Ot=At.superclusterOptions,it=At.clusterProperties;if(!it||!Ot)return Ot;for(var ht={},Ut={},Mt={accumulated:null,zoom:0},It={properties:null},Le=Object.keys(it),Xe=0,ot=Le;Xe<ot.length;Xe+=1){var pt=ot[Xe],St=it[pt],Vt=St[0],Jt=St[1],qt=e.createExpression(Jt),gr=e.createExpression(typeof Vt=="string"?[Vt,["accumulated"],["get",pt]]:Vt);ht[pt]=qt.value,Ut[pt]=gr.value}return Ot.map=function(Cr){It.properties=Cr;for(var mr={},tr=0,nr=Le;tr<nr.length;tr+=1){var Qt=nr[tr];mr[Qt]=ht[Qt].evaluate(Mt,It)}return mr},Ot.reduce=function(Cr,mr){It.properties=mr;for(var tr=0,nr=Le;tr<nr.length;tr+=1){var Qt=nr[tr];Mt.accumulated=Cr[Qt],Cr[Qt]=Ut[Qt].evaluate(Mt,It)}},Ot}(Be)).load(Ze.features):function(At,Ot){return new Gt(At,Ot)}(Ze,Be.geojsonVtOptions)}catch(At){return _e(At)}pe.loaded={};var ct={};if(He){var lt=He.finish();lt&&(ct.resourceTiming={},ct.resourceTiming[Be.source]=JSON.parse(JSON.stringify(lt)))}_e(null,ct)})}},Ye.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},Ye.prototype.reloadTile=function(pe,_e){var Be=this.loaded,He=pe.uid;return Be&&Be[He]?Ne.prototype.reloadTile.call(this,pe,_e):this.loadTile(pe,_e)},Ye.prototype.loadGeoJSON=function(pe,_e){if(pe.request)e.getJSON(pe.request,_e);else{if(typeof pe.data!="string")return _e(new Error("Input data given to '"+pe.source+"' is not a valid GeoJSON object."));try{return _e(null,JSON.parse(pe.data))}catch{return _e(new Error("Input data given to '"+pe.source+"' is not a valid GeoJSON object."))}}},Ye.prototype.removeSource=function(pe,_e){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),_e()},Ye.prototype.getClusterExpansionZoom=function(pe,_e){try{_e(null,this._geoJSONIndex.getClusterExpansionZoom(pe.clusterId))}catch(Be){_e(Be)}},Ye.prototype.getClusterChildren=function(pe,_e){try{_e(null,this._geoJSONIndex.getChildren(pe.clusterId))}catch(Be){_e(Be)}},Ye.prototype.getClusterLeaves=function(pe,_e){try{_e(null,this._geoJSONIndex.getLeaves(pe.clusterId,pe.limit,pe.offset))}catch(Be){_e(Be)}},Ye}(h),Dt=function(Ne){var Ye=this;this.self=Ne,this.actor=new e.Actor(Ne,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:h,geojson:cr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(pe,_e){if(Ye.workerSourceTypes[pe])throw new Error('Worker source with name "'+pe+'" already registered.');Ye.workerSourceTypes[pe]=_e},this.self.registerRTLTextPlugin=function(pe){if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=pe.applyArabicShaping,e.plugin.processBidirectionalText=pe.processBidirectionalText,e.plugin.processStyledBidirectionalText=pe.processStyledBidirectionalText}};return Dt.prototype.setReferrer=function(Ne,Ye){this.referrer=Ye},Dt.prototype.setImages=function(Ne,Ye,pe){for(var _e in this.availableImages[Ne]=Ye,this.workerSources[Ne]){var Be=this.workerSources[Ne][_e];for(var He in Be)Be[He].availableImages=Ye}pe()},Dt.prototype.setLayers=function(Ne,Ye,pe){this.getLayerIndex(Ne).replace(Ye),pe()},Dt.prototype.updateLayers=function(Ne,Ye,pe){this.getLayerIndex(Ne).update(Ye.layers,Ye.removedIds),pe()},Dt.prototype.loadTile=function(Ne,Ye,pe){this.getWorkerSource(Ne,Ye.type,Ye.source).loadTile(Ye,pe)},Dt.prototype.loadDEMTile=function(Ne,Ye,pe){this.getDEMWorkerSource(Ne,Ye.source).loadTile(Ye,pe)},Dt.prototype.reloadTile=function(Ne,Ye,pe){this.getWorkerSource(Ne,Ye.type,Ye.source).reloadTile(Ye,pe)},Dt.prototype.abortTile=function(Ne,Ye,pe){this.getWorkerSource(Ne,Ye.type,Ye.source).abortTile(Ye,pe)},Dt.prototype.removeTile=function(Ne,Ye,pe){this.getWorkerSource(Ne,Ye.type,Ye.source).removeTile(Ye,pe)},Dt.prototype.removeDEMTile=function(Ne,Ye){this.getDEMWorkerSource(Ne,Ye.source).removeTile(Ye)},Dt.prototype.removeSource=function(Ne,Ye,pe){if(this.workerSources[Ne]&&this.workerSources[Ne][Ye.type]&&this.workerSources[Ne][Ye.type][Ye.source]){var _e=this.workerSources[Ne][Ye.type][Ye.source];delete this.workerSources[Ne][Ye.type][Ye.source],_e.removeSource!==void 0?_e.removeSource(Ye,pe):pe()}},Dt.prototype.loadWorkerSource=function(Ne,Ye,pe){try{this.self.importScripts(Ye.url),pe()}catch(_e){pe(_e.toString())}},Dt.prototype.syncRTLPluginState=function(Ne,Ye,pe){try{e.plugin.setState(Ye);var _e=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&_e!=null){this.self.importScripts(_e);var Be=e.plugin.isParsed();pe(Be?void 0:new Error("RTL Text Plugin failed to import scripts from "+_e),Be)}}catch(He){pe(He.toString())}},Dt.prototype.getAvailableImages=function(Ne){var Ye=this.availableImages[Ne];return Ye||(Ye=[]),Ye},Dt.prototype.getLayerIndex=function(Ne){var Ye=this.layerIndexes[Ne];return Ye||(Ye=this.layerIndexes[Ne]=new o),Ye},Dt.prototype.getWorkerSource=function(Ne,Ye,pe){var _e=this;if(this.workerSources[Ne]||(this.workerSources[Ne]={}),this.workerSources[Ne][Ye]||(this.workerSources[Ne][Ye]={}),!this.workerSources[Ne][Ye][pe]){var Be={send:function(He,Je,Ze){_e.actor.send(He,Je,Ze,Ne)}};this.workerSources[Ne][Ye][pe]=new this.workerSourceTypes[Ye](Be,this.getLayerIndex(Ne),this.getAvailableImages(Ne))}return this.workerSources[Ne][Ye][pe]},Dt.prototype.getDEMWorkerSource=function(Ne,Ye){return this.demWorkerSources[Ne]||(this.demWorkerSources[Ne]={}),this.demWorkerSources[Ne][Ye]||(this.demWorkerSources[Ne][Ye]=new s),this.demWorkerSources[Ne][Ye]},Dt.prototype.enforceCacheSizeLimit=function(Ne,Ye){e.enforceCacheSizeLimit(Ye)},typeof WorkerGlobalScope<"u"&&e.window!==void 0&&e.window instanceof WorkerGlobalScope&&(e.window.worker=new Dt(e.window)),Dt}),y(0,function(e){var t=e.createCommonjsModule(function(C){function R(ae){return!F(ae)}function F(ae){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var he,be,Ae=new Blob([""],{type:"text/javascript"}),Ce=URL.createObjectURL(Ae);try{be=new Worker(Ce),he=!0}catch{he=!1}return be&&be.terminate(),URL.revokeObjectURL(Ce),he}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var he=document.createElement("canvas");he.width=he.height=1;var be=he.getContext("2d");if(!be)return!1;var Ae=be.getImageData(0,0,1,1);return Ae&&Ae.width===he.width}()?function(he){return q[he]===void 0&&(q[he]=function(be){var Ae=function(qe){var et=document.createElement("canvas"),st=Object.create(R.webGLContextAttributes);return st.failIfMajorPerformanceCaveat=qe,et.probablySupportsContext?et.probablySupportsContext("webgl",st)||et.probablySupportsContext("experimental-webgl",st):et.supportsContext?et.supportsContext("webgl",st)||et.supportsContext("experimental-webgl",st):et.getContext("webgl",st)||et.getContext("experimental-webgl",st)}(be);if(!Ae)return!1;var Ce=Ae.createShader(Ae.VERTEX_SHADER);return!Ce||Ae.isContextLost()?!1:(Ae.shaderSource(Ce,"void main() {}"),Ae.compileShader(Ce),Ae.getShaderParameter(Ce,Ae.COMPILE_STATUS)===!0)}(he)),q[he]}(ae&&ae.failIfMajorPerformanceCaveat)?void 0:"insufficient WebGL support":"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support"}C.exports?C.exports=R:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=R,window.mapboxgl.notSupportedReason=F);var q={};R.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),n={create:function(C,R,F){var q=e.window.document.createElement(C);return R!==void 0&&(q.className=R),F&&F.appendChild(q),q},createNS:function(C,R){return e.window.document.createElementNS(C,R)}},o=e.window.document.documentElement.style;function r(C){if(!o)return C[0];for(var R=0;R<C.length;R++)if(C[R]in o)return C[R];return C[0]}var g,c=r(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);n.disableDrag=function(){o&&c&&(g=o[c],o[c]="none")},n.enableDrag=function(){o&&c&&(o[c]=g)};var a=r(["transform","WebkitTransform"]);n.setTransform=function(C,R){C.style[a]=R};var h=!1;try{var l=Object.defineProperty({},"passive",{get:function(){h=!0}});e.window.addEventListener("test",l,l),e.window.removeEventListener("test",l,l)}catch{h=!1}n.addEventListener=function(C,R,F,q){q===void 0&&(q={}),"passive"in q&&h?C.addEventListener(R,F,q):C.addEventListener(R,F,q.capture)},n.removeEventListener=function(C,R,F,q){q===void 0&&(q={}),"passive"in q&&h?C.removeEventListener(R,F,q):C.removeEventListener(R,F,q.capture)};var s=function(C){C.preventDefault(),C.stopPropagation(),e.window.removeEventListener("click",s,!0)};function p(C){var R=C.userImage;return R&&R.render&&R.render()?(C.data.replace(new Uint8Array(R.data.buffer)),!0):!1}n.suppressClick=function(){e.window.addEventListener("click",s,!0),e.window.setTimeout(function(){e.window.removeEventListener("click",s,!0)},0)},n.mousePos=function(C,R){var F=C.getBoundingClientRect();return new e.Point(R.clientX-F.left-C.clientLeft,R.clientY-F.top-C.clientTop)},n.touchPos=function(C,R){for(var F=C.getBoundingClientRect(),q=[],ae=0;ae<R.length;ae++)q.push(new e.Point(R[ae].clientX-F.left-C.clientLeft,R[ae].clientY-F.top-C.clientTop));return q},n.mouseButton=function(C){return e.window.InstallTrigger!==void 0&&C.button===2&&C.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:C.button},n.remove=function(C){C.parentNode&&C.parentNode.removeChild(C)};var u=function(C){function R(){C.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.isLoaded=function(){return this.loaded},R.prototype.setLoaded=function(F){if(this.loaded!==F&&(this.loaded=F,F)){for(var q=0,ae=this.requestors;q<ae.length;q+=1){var he=ae[q],be=he.ids,Ae=he.callback;this._notify(be,Ae)}this.requestors=[]}},R.prototype.getImage=function(F){return this.images[F]},R.prototype.addImage=function(F,q){this._validate(F,q)&&(this.images[F]=q)},R.prototype._validate=function(F,q){var ae=!0;return this._validateStretch(q.stretchX,q.data&&q.data.width)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "stretchX" value'))),ae=!1),this._validateStretch(q.stretchY,q.data&&q.data.height)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "stretchY" value'))),ae=!1),this._validateContent(q.content,q)||(this.fire(new e.ErrorEvent(new Error('Image "'+F+'" has invalid "content" value'))),ae=!1),ae},R.prototype._validateStretch=function(F,q){if(!F)return!0;for(var ae=0,he=0,be=F;he<be.length;he+=1){var Ae=be[he];if(Ae[0]<ae||Ae[1]<Ae[0]||q<Ae[1])return!1;ae=Ae[1]}return!0},R.prototype._validateContent=function(F,q){return!F||F.length===4&&!(F[0]<0||q.data.width<F[0])&&!(F[1]<0||q.data.height<F[1])&&!(F[2]<0||q.data.width<F[2])&&!(F[3]<0||q.data.height<F[3])&&!(F[2]<F[0])&&!(F[3]<F[1])},R.prototype.updateImage=function(F,q){var ae=this.images[F];q.version=ae.version+1,this.images[F]=q,this.updatedImages[F]=!0},R.prototype.removeImage=function(F){var q=this.images[F];delete this.images[F],delete this.patterns[F],q.userImage&&q.userImage.onRemove&&q.userImage.onRemove()},R.prototype.listImages=function(){return Object.keys(this.images)},R.prototype.getImages=function(F,q){var ae=!0;if(!this.isLoaded())for(var he=0,be=F;he<be.length;he+=1){var Ae=be[he];this.images[Ae]||(ae=!1)}this.isLoaded()||ae?this._notify(F,q):this.requestors.push({ids:F,callback:q})},R.prototype._notify=function(F,q){for(var ae={},he=0,be=F;he<be.length;he+=1){var Ae=be[he];this.images[Ae]||this.fire(new e.Event("styleimagemissing",{id:Ae}));var Ce=this.images[Ae];Ce?ae[Ae]={data:Ce.data.clone(),pixelRatio:Ce.pixelRatio,sdf:Ce.sdf,version:Ce.version,stretchX:Ce.stretchX,stretchY:Ce.stretchY,content:Ce.content,hasRenderCallback:Boolean(Ce.userImage&&Ce.userImage.render)}:e.warnOnce('Image "'+Ae+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}q(null,ae)},R.prototype.getPixelSize=function(){var F=this.atlasImage;return{width:F.width,height:F.height}},R.prototype.getPattern=function(F){var q=this.patterns[F],ae=this.getImage(F);if(!ae)return null;if(q&&q.position.version===ae.version)return q.position;if(q)q.position.version=ae.version;else{var he={w:ae.data.width+2,h:ae.data.height+2,x:0,y:0},be=new e.ImagePosition(he,ae);this.patterns[F]={bin:he,position:be}}return this._updatePatternAtlas(),this.patterns[F].position},R.prototype.bind=function(F){var q=F.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(F,this.atlasImage,q.RGBA),this.atlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE)},R.prototype._updatePatternAtlas=function(){var F=[];for(var q in this.patterns)F.push(this.patterns[q].bin);var ae=e.potpack(F),he=ae.w,be=ae.h,Ae=this.atlasImage;for(var Ce in Ae.resize({width:he||1,height:be||1}),this.patterns){var qe=this.patterns[Ce].bin,et=qe.x+1,st=qe.y+1,kt=this.images[Ce].data,Pt=kt.width,Et=kt.height;e.RGBAImage.copy(kt,Ae,{x:0,y:0},{x:et,y:st},{width:Pt,height:Et}),e.RGBAImage.copy(kt,Ae,{x:0,y:Et-1},{x:et,y:st-1},{width:Pt,height:1}),e.RGBAImage.copy(kt,Ae,{x:0,y:0},{x:et,y:st+Et},{width:Pt,height:1}),e.RGBAImage.copy(kt,Ae,{x:Pt-1,y:0},{x:et-1,y:st},{width:1,height:Et}),e.RGBAImage.copy(kt,Ae,{x:0,y:0},{x:et+Pt,y:st},{width:1,height:Et})}this.dirty=!0},R.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},R.prototype.dispatchRenderCallbacks=function(F){for(var q=0,ae=F;q<ae.length;q+=1){var he=ae[q];if(!this.callbackDispatchedThisFrame[he]){this.callbackDispatchedThisFrame[he]=!0;var be=this.images[he];p(be)&&this.updateImage(he,be)}}},R}(e.Evented),i=_,x=_,f=1e20;function _(C,R,F,q,ae,he){this.fontSize=C||24,this.buffer=R===void 0?3:R,this.cutoff=q||.25,this.fontFamily=ae||"sans-serif",this.fontWeight=he||"normal",this.radius=F||8;var be=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=be,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(be*be),this.gridInner=new Float64Array(be*be),this.f=new Float64Array(be),this.d=new Float64Array(be),this.z=new Float64Array(be+1),this.v=new Int16Array(be),this.middle=Math.round(be/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function b(C,R,F,q,ae,he,be){for(var Ae=0;Ae<R;Ae++){for(var Ce=0;Ce<F;Ce++)q[Ce]=C[Ce*R+Ae];for(T(q,ae,he,be,F),Ce=0;Ce<F;Ce++)C[Ce*R+Ae]=ae[Ce]}for(Ce=0;Ce<F;Ce++){for(Ae=0;Ae<R;Ae++)q[Ae]=C[Ce*R+Ae];for(T(q,ae,he,be,R),Ae=0;Ae<R;Ae++)C[Ce*R+Ae]=Math.sqrt(ae[Ae])}}function T(C,R,F,q,ae){F[0]=0,q[0]=-f,q[1]=+f;for(var he=1,be=0;he<ae;he++){for(var Ae=(C[he]+he*he-(C[F[be]]+F[be]*F[be]))/(2*he-2*F[be]);Ae<=q[be];)be--,Ae=(C[he]+he*he-(C[F[be]]+F[be]*F[be]))/(2*he-2*F[be]);F[++be]=he,q[be]=Ae,q[be+1]=+f}for(he=0,be=0;he<ae;he++){for(;q[be+1]<he;)be++;R[he]=(he-F[be])*(he-F[be])+C[F[be]]}}_.prototype.draw=function(C){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(C,this.buffer,this.middle);for(var R=this.ctx.getImageData(0,0,this.size,this.size),F=new Uint8ClampedArray(this.size*this.size),q=0;q<this.size*this.size;q++){var ae=R.data[4*q+3]/255;this.gridOuter[q]=ae===1?0:ae===0?f:Math.pow(Math.max(0,.5-ae),2),this.gridInner[q]=ae===1?f:ae===0?0:Math.pow(Math.max(0,ae-.5),2)}for(b(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),b(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),q=0;q<this.size*this.size;q++){var he=this.gridOuter[q]-this.gridInner[q];F[q]=Math.max(0,Math.min(255,Math.round(255-255*(he/this.radius+this.cutoff))))}return F},i.default=x;var k=function(C,R){this.requestManager=C,this.localIdeographFontFamily=R,this.entries={}};k.prototype.setURL=function(C){this.url=C},k.prototype.getGlyphs=function(C,R){var F=this,q=[];for(var ae in C)for(var he=0,be=C[ae];he<be.length;he+=1){var Ae=be[he];q.push({stack:ae,id:Ae})}e.asyncAll(q,function(Ce,qe){var et=Ce.stack,st=Ce.id,kt=F.entries[et];kt||(kt=F.entries[et]={glyphs:{},requests:{},ranges:{}});var Pt=kt.glyphs[st];if(Pt===void 0){if(Pt=F._tinySDF(kt,et,st))return kt.glyphs[st]=Pt,void qe(null,{stack:et,id:st,glyph:Pt});var Et=Math.floor(st/256);if(256*Et>65535)qe(new Error("glyphs > 65535 not supported"));else if(kt.ranges[Et])qe(null,{stack:et,id:st,glyph:Pt});else{var Lt=kt.requests[Et];Lt||(Lt=kt.requests[Et]=[],k.loadGlyphRange(et,Et,F.url,F.requestManager,function(Tt,Bt){if(Bt){for(var zt in Bt)F._doesCharSupportLocalGlyph(+zt)||(kt.glyphs[+zt]=Bt[+zt]);kt.ranges[Et]=!0}for(var Ht=0,lr=Lt;Ht<lr.length;Ht+=1)(0,lr[Ht])(Tt,Bt);delete kt.requests[Et]})),Lt.push(function(Tt,Bt){Tt?qe(Tt):Bt&&qe(null,{stack:et,id:st,glyph:Bt[st]||null})})}}else qe(null,{stack:et,id:st,glyph:Pt})},function(Ce,qe){if(Ce)R(Ce);else if(qe){for(var et={},st=0,kt=qe;st<kt.length;st+=1){var Pt=kt[st],Et=Pt.stack,Lt=Pt.id,Tt=Pt.glyph;(et[Et]||(et[Et]={}))[Lt]=Tt&&{id:Tt.id,bitmap:Tt.bitmap.clone(),metrics:Tt.metrics}}R(null,et)}})},k.prototype._doesCharSupportLocalGlyph=function(C){return!!this.localIdeographFontFamily&&(e.isChar["CJK Unified Ideographs"](C)||e.isChar["Hangul Syllables"](C)||e.isChar.Hiragana(C)||e.isChar.Katakana(C))},k.prototype._tinySDF=function(C,R,F){var q=this.localIdeographFontFamily;if(q&&this._doesCharSupportLocalGlyph(F)){var ae=C.tinySDF;if(!ae){var he="400";/bold/i.test(R)?he="900":/medium/i.test(R)?he="500":/light/i.test(R)&&(he="200"),ae=C.tinySDF=new k.TinySDF(24,3,8,.25,q,he)}return{id:F,bitmap:new e.AlphaImage({width:30,height:30},ae.draw(String.fromCharCode(F))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},k.loadGlyphRange=function(C,R,F,q,ae){var he=256*R,be=he+255,Ae=q.transformRequest(q.normalizeGlyphsURL(F).replace("{fontstack}",C).replace("{range}",he+"-"+be),e.ResourceType.Glyphs);e.getArrayBuffer(Ae,function(Ce,qe){if(Ce)ae(Ce);else if(qe){for(var et={},st=0,kt=e.parseGlyphPBF(qe);st<kt.length;st+=1){var Pt=kt[st];et[Pt.id]=Pt}ae(null,et)}})},k.TinySDF=i;var L=function(){this.specification=e.styleSpec.light.position};L.prototype.possiblyEvaluate=function(C,R){return e.sphericalToCartesian(C.expression.evaluate(R))},L.prototype.interpolate=function(C,R,F){return{x:e.number(C.x,R.x,F),y:e.number(C.y,R.y,F),z:e.number(C.z,R.z,F)}};var A=new e.Properties({anchor:new e.DataConstantProperty(e.styleSpec.light.anchor),position:new L,color:new e.DataConstantProperty(e.styleSpec.light.color),intensity:new e.DataConstantProperty(e.styleSpec.light.intensity)}),I=function(C){function R(F){C.call(this),this._transitionable=new e.Transitionable(A),this.setLight(F),this._transitioning=this._transitionable.untransitioned()}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getLight=function(){return this._transitionable.serialize()},R.prototype.setLight=function(F,q){if(q===void 0&&(q={}),!this._validate(e.validateLight,F,q))for(var ae in F){var he=F[ae];e.endsWith(ae,"-transition")?this._transitionable.setTransition(ae.slice(0,-11),he):this._transitionable.setValue(ae,he)}},R.prototype.updateTransitions=function(F){this._transitioning=this._transitionable.transitioned(F,this._transitioning)},R.prototype.hasTransition=function(){return this._transitioning.hasTransition()},R.prototype.recalculate=function(F){this.properties=this._transitioning.possiblyEvaluate(F)},R.prototype._validate=function(F,q,ae){return(!ae||ae.validate!==!1)&&e.emitValidationErrors(this,F.call(e.validateStyle,e.extend({value:q,style:{glyphs:!0,sprite:!0},styleSpec:e.styleSpec})))},R}(e.Evented),P=function(C,R){this.width=C,this.height=R,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};P.prototype.getDash=function(C,R){var F=C.join(",")+String(R);return this.dashEntry[F]||(this.dashEntry[F]=this.addDash(C,R)),this.dashEntry[F]},P.prototype.getDashRanges=function(C,R,F){var q=[],ae=C.length%2==1?-C[C.length-1]*F:0,he=C[0]*F,be=!0;q.push({left:ae,right:he,isDash:be,zeroLength:C[0]===0});for(var Ae=C[0],Ce=1;Ce<C.length;Ce++){be=!be;var qe=C[Ce];ae=Ae*F,he=(Ae+=qe)*F,q.push({left:ae,right:he,isDash:be,zeroLength:qe===0})}return q},P.prototype.addRoundDash=function(C,R,F){for(var q=R/2,ae=-F;ae<=F;ae++)for(var he=this.nextRow+F+ae,be=this.width*he,Ae=0,Ce=C[Ae],qe=0;qe<this.width;qe++){qe/Ce.right>1&&(Ce=C[++Ae]);var et=Math.abs(qe-Ce.left),st=Math.abs(qe-Ce.right),kt=Math.min(et,st),Pt=void 0,Et=ae/F*(q+1);if(Ce.isDash){var Lt=q-Math.abs(Et);Pt=Math.sqrt(kt*kt+Lt*Lt)}else Pt=q-Math.sqrt(kt*kt+Et*Et);this.data[be+qe]=Math.max(0,Math.min(255,Pt+128))}},P.prototype.addRegularDash=function(C){for(var R=C.length-1;R>=0;--R){var F=C[R],q=C[R+1];F.zeroLength?C.splice(R,1):q&&q.isDash===F.isDash&&(q.left=F.left,C.splice(R,1))}var ae=C[0],he=C[C.length-1];ae.isDash===he.isDash&&(ae.left=he.left-this.width,he.right=ae.right+this.width);for(var be=this.width*this.nextRow,Ae=0,Ce=C[Ae],qe=0;qe<this.width;qe++){qe/Ce.right>1&&(Ce=C[++Ae]);var et=Math.abs(qe-Ce.left),st=Math.abs(qe-Ce.right),kt=Math.min(et,st),Pt=Ce.isDash?kt:-kt;this.data[be+qe]=Math.max(0,Math.min(255,Pt+128))}},P.prototype.addDash=function(C,R){var F=R?7:0,q=2*F+1;if(this.nextRow+q>this.height)return e.warnOnce("LineAtlas out of space"),null;for(var ae=0,he=0;he<C.length;he++)ae+=C[he];if(ae!==0){var be=this.width/ae,Ae=this.getDashRanges(C,this.width,be);R?this.addRoundDash(Ae,be,F):this.addRegularDash(Ae)}var Ce={y:(this.nextRow+F+.5)/this.height,height:2*F/this.height,width:ae};return this.nextRow+=q,this.dirty=!0,Ce},P.prototype.bind=function(C){var R=C.gl;this.texture?(R.bindTexture(R.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,R.texSubImage2D(R.TEXTURE_2D,0,0,0,this.width,this.height,R.ALPHA,R.UNSIGNED_BYTE,this.data))):(this.texture=R.createTexture(),R.bindTexture(R.TEXTURE_2D,this.texture),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_WRAP_S,R.REPEAT),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_WRAP_T,R.REPEAT),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_MIN_FILTER,R.LINEAR),R.texParameteri(R.TEXTURE_2D,R.TEXTURE_MAG_FILTER,R.LINEAR),R.texImage2D(R.TEXTURE_2D,0,R.ALPHA,this.width,this.height,0,R.ALPHA,R.UNSIGNED_BYTE,this.data))};var S=function C(R,F){this.workerPool=R,this.actors=[],this.currentActor=0,this.id=e.uniqueId();for(var q=this.workerPool.acquire(this.id),ae=0;ae<q.length;ae++){var he=q[ae],be=new C.Actor(he,F,this.id);be.name="Worker "+ae,this.actors.push(be)}};function E(C,R,F){var q=function(ae,he){if(ae)return F(ae);if(he){var be=e.pick(e.extend(he,C),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);he.vector_layers&&(be.vectorLayers=he.vector_layers,be.vectorLayerIds=be.vectorLayers.map(function(Ae){return Ae.id})),be.tiles=R.canonicalizeTileset(be,C.url),F(null,be)}};return C.url?e.getJSON(R.transformRequest(R.normalizeSourceURL(C.url),e.ResourceType.Source),q):e.browser.frame(function(){return q(null,C)})}S.prototype.broadcast=function(C,R,F){F=F||function(){},e.asyncAll(this.actors,function(q,ae){q.send(C,R,ae)},F)},S.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},S.prototype.remove=function(){this.actors.forEach(function(C){C.remove()}),this.actors=[],this.workerPool.release(this.id)},S.Actor=e.Actor;var z=function(C,R,F){this.bounds=e.LngLatBounds.convert(this.validateBounds(C)),this.minzoom=R||0,this.maxzoom=F||24};z.prototype.validateBounds=function(C){return Array.isArray(C)&&C.length===4?[Math.max(-180,C[0]),Math.max(-90,C[1]),Math.min(180,C[2]),Math.min(90,C[3])]:[-180,-90,180,90]},z.prototype.contains=function(C){var R=Math.pow(2,C.z),F=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*R),q=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*R),ae=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*R),he=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*R);return C.x>=F&&C.x<ae&&C.y>=q&&C.y<he};var D=function(C){function R(F,q,ae,he){if(C.call(this),this.id=F,this.dispatcher=ae,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(q,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},q),this._collectResourceTiming=q.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(he)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.load=function(){var F=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=E(this._options,this.map._requestManager,function(q,ae){F._tileJSONRequest=null,F._loaded=!0,q?F.fire(new e.ErrorEvent(q)):ae&&(e.extend(F,ae),ae.bounds&&(F.tileBounds=new z(ae.bounds,F.minzoom,F.maxzoom)),e.postTurnstileEvent(ae.tiles,F.map._requestManager._customAccessToken),e.postMapLoadEvent(ae.tiles,F.map._getMapId(),F.map._requestManager._skuToken,F.map._requestManager._customAccessToken),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},R.prototype.loaded=function(){return this._loaded},R.prototype.hasTile=function(F){return!this.tileBounds||this.tileBounds.contains(F.canonical)},R.prototype.onAdd=function(F){this.map=F,this.load()},R.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},R.prototype.serialize=function(){return e.extend({},this._options)},R.prototype.loadTile=function(F,q){var ae=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme)),he={request:this.map._requestManager.transformRequest(ae,e.ResourceType.Tile),uid:F.uid,tileID:F.tileID,zoom:F.tileID.overscaledZ,tileSize:this.tileSize*F.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function be(Ae,Ce){return delete F.request,F.aborted?q(null):Ae&&Ae.status!==404?q(Ae):(Ce&&Ce.resourceTiming&&(F.resourceTiming=Ce.resourceTiming),this.map._refreshExpiredTiles&&Ce&&F.setExpiryData(Ce),F.loadVectorData(Ce,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),q(null),void(F.reloadCallback&&(this.loadTile(F,F.reloadCallback),F.reloadCallback=null)))}he.request.collectResourceTiming=this._collectResourceTiming,F.actor&&F.state!=="expired"?F.state==="loading"?F.reloadCallback=q:F.request=F.actor.send("reloadTile",he,be.bind(this)):(F.actor=this.dispatcher.getActor(),F.request=F.actor.send("loadTile",he,be.bind(this)))},R.prototype.abortTile=function(F){F.request&&(F.request.cancel(),delete F.request),F.actor&&F.actor.send("abortTile",{uid:F.uid,type:this.type,source:this.id},void 0)},R.prototype.unloadTile=function(F){F.unloadVectorData(),F.actor&&F.actor.send("removeTile",{uid:F.uid,type:this.type,source:this.id},void 0)},R.prototype.hasTransition=function(){return!1},R}(e.Evented),j=function(C){function R(F,q,ae,he){C.call(this),this.id=F,this.dispatcher=ae,this.setEventedParent(he),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},q),e.extend(this,e.pick(q,["url","scheme","tileSize"]))}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.load=function(){var F=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=E(this._options,this.map._requestManager,function(q,ae){F._tileJSONRequest=null,F._loaded=!0,q?F.fire(new e.ErrorEvent(q)):ae&&(e.extend(F,ae),ae.bounds&&(F.tileBounds=new z(ae.bounds,F.minzoom,F.maxzoom)),e.postTurnstileEvent(ae.tiles),e.postMapLoadEvent(ae.tiles,F.map._getMapId(),F.map._requestManager._skuToken),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),F.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})))})},R.prototype.loaded=function(){return this._loaded},R.prototype.onAdd=function(F){this.map=F,this.load()},R.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},R.prototype.serialize=function(){return e.extend({},this._options)},R.prototype.hasTile=function(F){return!this.tileBounds||this.tileBounds.contains(F.canonical)},R.prototype.loadTile=function(F,q){var ae=this,he=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);F.request=e.getImage(this.map._requestManager.transformRequest(he,e.ResourceType.Tile),function(be,Ae){if(delete F.request,F.aborted)F.state="unloaded",q(null);else if(be)F.state="errored",q(be);else if(Ae){ae.map._refreshExpiredTiles&&F.setExpiryData(Ae),delete Ae.cacheControl,delete Ae.expires;var Ce=ae.map.painter.context,qe=Ce.gl;F.texture=ae.map.painter.getTileTexture(Ae.width),F.texture?F.texture.update(Ae,{useMipmap:!0}):(F.texture=new e.Texture(Ce,Ae,qe.RGBA,{useMipmap:!0}),F.texture.bind(qe.LINEAR,qe.CLAMP_TO_EDGE,qe.LINEAR_MIPMAP_NEAREST),Ce.extTextureFilterAnisotropic&&qe.texParameterf(qe.TEXTURE_2D,Ce.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Ce.extTextureFilterAnisotropicMax)),F.state="loaded",e.cacheEntryPossiblyAdded(ae.dispatcher),q(null)}})},R.prototype.abortTile=function(F,q){F.request&&(F.request.cancel(),delete F.request),q()},R.prototype.unloadTile=function(F,q){F.texture&&this.map.painter.saveTileTexture(F.texture),q()},R.prototype.hasTransition=function(){return!1},R}(e.Evented),V=function(C){function R(F,q,ae,he){C.call(this,F,q,ae,he),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},q),this.encoding=q.encoding||"mapbox"}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},R.prototype.loadTile=function(F,q){var ae=this.map._requestManager.normalizeTileURL(F.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function he(be,Ae){be&&(F.state="errored",q(be)),Ae&&(F.dem=Ae,F.needsHillshadePrepare=!0,F.state="loaded",q(null))}F.request=e.getImage(this.map._requestManager.transformRequest(ae,e.ResourceType.Tile),function(be,Ae){if(delete F.request,F.aborted)F.state="unloaded",q(null);else if(be)F.state="errored",q(be);else if(Ae){this.map._refreshExpiredTiles&&F.setExpiryData(Ae),delete Ae.cacheControl,delete Ae.expires;var Ce=e.window.ImageBitmap&&Ae instanceof e.window.ImageBitmap&&e.offscreenCanvasSupported()?Ae:e.browser.getImageData(Ae,1),qe={uid:F.uid,coord:F.tileID,source:this.id,rawImageData:Ce,encoding:this.encoding};F.actor&&F.state!=="expired"||(F.actor=this.dispatcher.getActor(),F.actor.send("loadDEMTile",qe,he.bind(this)))}}.bind(this)),F.neighboringTiles=this._getNeighboringTiles(F.tileID)},R.prototype._getNeighboringTiles=function(F){var q=F.canonical,ae=Math.pow(2,q.z),he=(q.x-1+ae)%ae,be=q.x===0?F.wrap-1:F.wrap,Ae=(q.x+1+ae)%ae,Ce=q.x+1===ae?F.wrap+1:F.wrap,qe={};return qe[new e.OverscaledTileID(F.overscaledZ,be,q.z,he,q.y).key]={backfilled:!1},qe[new e.OverscaledTileID(F.overscaledZ,Ce,q.z,Ae,q.y).key]={backfilled:!1},q.y>0&&(qe[new e.OverscaledTileID(F.overscaledZ,be,q.z,he,q.y-1).key]={backfilled:!1},qe[new e.OverscaledTileID(F.overscaledZ,F.wrap,q.z,q.x,q.y-1).key]={backfilled:!1},qe[new e.OverscaledTileID(F.overscaledZ,Ce,q.z,Ae,q.y-1).key]={backfilled:!1}),q.y+1<ae&&(qe[new e.OverscaledTileID(F.overscaledZ,be,q.z,he,q.y+1).key]={backfilled:!1},qe[new e.OverscaledTileID(F.overscaledZ,F.wrap,q.z,q.x,q.y+1).key]={backfilled:!1},qe[new e.OverscaledTileID(F.overscaledZ,Ce,q.z,Ae,q.y+1).key]={backfilled:!1}),qe},R.prototype.unloadTile=function(F){F.demTexture&&this.map.painter.saveTileTexture(F.demTexture),F.fbo&&(F.fbo.destroy(),delete F.fbo),F.dem&&delete F.dem,delete F.neighboringTiles,F.state="unloaded",F.actor&&F.actor.send("removeDEMTile",{uid:F.uid,source:this.id})},R}(j),Z=function(C){function R(F,q,ae,he){C.call(this),this.id=F,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=ae.getActor(),this.setEventedParent(he),this._data=q.data,this._options=e.extend({},q),this._collectResourceTiming=q.collectResourceTiming,this._resourceTiming=[],q.maxzoom!==void 0&&(this.maxzoom=q.maxzoom),q.type&&(this.type=q.type),q.attribution&&(this.attribution=q.attribution),this.promoteId=q.promoteId;var be=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:q.cluster||!1,geojsonVtOptions:{buffer:(q.buffer!==void 0?q.buffer:128)*be,tolerance:(q.tolerance!==void 0?q.tolerance:.375)*be,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:q.lineMetrics||!1,generateId:q.generateId||!1},superclusterOptions:{maxZoom:q.clusterMaxZoom!==void 0?Math.min(q.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:e.EXTENT,radius:(q.clusterRadius||50)*be,log:!1,generateId:q.generateId||!1},clusterProperties:q.clusterProperties},q.workerOptions)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.load=function(){var F=this;this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(q){if(q)F.fire(new e.ErrorEvent(q));else{var ae={dataType:"source",sourceDataType:"metadata"};F._collectResourceTiming&&F._resourceTiming&&F._resourceTiming.length>0&&(ae.resourceTiming=F._resourceTiming,F._resourceTiming=[]),F.fire(new e.Event("data",ae))}})},R.prototype.onAdd=function(F){this.map=F,this.load()},R.prototype.setData=function(F){var q=this;return this._data=F,this.fire(new e.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(ae){if(ae)q.fire(new e.ErrorEvent(ae));else{var he={dataType:"source",sourceDataType:"content"};q._collectResourceTiming&&q._resourceTiming&&q._resourceTiming.length>0&&(he.resourceTiming=q._resourceTiming,q._resourceTiming=[]),q.fire(new e.Event("data",he))}}),this},R.prototype.getClusterExpansionZoom=function(F,q){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:F,source:this.id},q),this},R.prototype.getClusterChildren=function(F,q){return this.actor.send("geojson.getClusterChildren",{clusterId:F,source:this.id},q),this},R.prototype.getClusterLeaves=function(F,q,ae,he){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:F,limit:q,offset:ae},he),this},R.prototype._updateWorkerData=function(F){var q=this;this._loaded=!1;var ae=e.extend({},this.workerOptions),he=this._data;typeof he=="string"?(ae.request=this.map._requestManager.transformRequest(e.browser.resolveURL(he),e.ResourceType.Source),ae.request.collectResourceTiming=this._collectResourceTiming):ae.data=JSON.stringify(he),this.actor.send(this.type+".loadData",ae,function(be,Ae){q._removed||Ae&&Ae.abandoned||(q._loaded=!0,Ae&&Ae.resourceTiming&&Ae.resourceTiming[q.id]&&(q._resourceTiming=Ae.resourceTiming[q.id].slice(0)),q.actor.send(q.type+".coalesce",{source:ae.source},null),F(be))})},R.prototype.loaded=function(){return this._loaded},R.prototype.loadTile=function(F,q){var ae=this,he=F.actor?"reloadTile":"loadTile";F.actor=this.actor;var be={type:this.type,uid:F.uid,tileID:F.tileID,zoom:F.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};F.request=this.actor.send(he,be,function(Ae,Ce){return delete F.request,F.unloadVectorData(),F.aborted?q(null):Ae?q(Ae):(F.loadVectorData(Ce,ae.map.painter,he==="reloadTile"),q(null))})},R.prototype.abortTile=function(F){F.request&&(F.request.cancel(),delete F.request),F.aborted=!0},R.prototype.unloadTile=function(F){F.unloadVectorData(),this.actor.send("removeTile",{uid:F.uid,type:this.type,source:this.id})},R.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},R.prototype.serialize=function(){return e.extend({},this._options,{type:this.type,data:this._data})},R.prototype.hasTransition=function(){return!1},R}(e.Evented),Q=e.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),X=function(C){function R(F,q,ae,he){C.call(this),this.id=F,this.dispatcher=ae,this.coordinates=q.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(he),this.options=q}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.load=function(F,q){var ae=this;this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),function(he,be){ae._loaded=!0,he?ae.fire(new e.ErrorEvent(he)):be&&(ae.image=be,F&&(ae.coordinates=F),q&&q(),ae._finishLoading())})},R.prototype.loaded=function(){return this._loaded},R.prototype.updateImage=function(F){var q=this;return this.image&&F.url?(this.options.url=F.url,this.load(F.coordinates,function(){q.texture=null}),this):this},R.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))},R.prototype.onAdd=function(F){this.map=F,this.load()},R.prototype.setCoordinates=function(F){var q=this;this.coordinates=F;var ae=F.map(e.MercatorCoordinate.fromLngLat);this.tileID=function(be){for(var Ae=1/0,Ce=1/0,qe=-1/0,et=-1/0,st=0,kt=be;st<kt.length;st+=1){var Pt=kt[st];Ae=Math.min(Ae,Pt.x),Ce=Math.min(Ce,Pt.y),qe=Math.max(qe,Pt.x),et=Math.max(et,Pt.y)}var Et=qe-Ae,Lt=et-Ce,Tt=Math.max(Et,Lt),Bt=Math.max(0,Math.floor(-Math.log(Tt)/Math.LN2)),zt=Math.pow(2,Bt);return new e.CanonicalTileID(Bt,Math.floor((Ae+qe)/2*zt),Math.floor((Ce+et)/2*zt))}(ae),this.minzoom=this.maxzoom=this.tileID.z;var he=ae.map(function(be){return q.tileID.getTilePoint(be)._round()});return this._boundsArray=new e.StructArrayLayout4i8,this._boundsArray.emplaceBack(he[0].x,he[0].y,0,0),this._boundsArray.emplaceBack(he[1].x,he[1].y,e.EXTENT,0),this._boundsArray.emplaceBack(he[3].x,he[3].y,0,e.EXTENT),this._boundsArray.emplaceBack(he[2].x,he[2].y,e.EXTENT,e.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this},R.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var F=this.map.painter.context,q=F.gl;for(var ae in this.boundsBuffer||(this.boundsBuffer=F.createVertexBuffer(this._boundsArray,Q.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new e.Texture(F,this.image,q.RGBA),this.texture.bind(q.LINEAR,q.CLAMP_TO_EDGE)),this.tiles){var he=this.tiles[ae];he.state!=="loaded"&&(he.state="loaded",he.texture=this.texture)}}},R.prototype.loadTile=function(F,q){this.tileID&&this.tileID.equals(F.tileID.canonical)?(this.tiles[String(F.tileID.wrap)]=F,F.buckets={},q(null)):(F.state="errored",q(null))},R.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},R.prototype.hasTransition=function(){return!1},R}(e.Evented),$=function(C){function R(F,q,ae,he){C.call(this,F,q,ae,he),this.roundZoom=!0,this.type="video",this.options=q}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.load=function(){var F=this;this._loaded=!1;var q=this.options;this.urls=[];for(var ae=0,he=q.urls;ae<he.length;ae+=1){var be=he[ae];this.urls.push(this.map._requestManager.transformRequest(be,e.ResourceType.Source).url)}e.getVideo(this.urls,function(Ae,Ce){F._loaded=!0,Ae?F.fire(new e.ErrorEvent(Ae)):Ce&&(F.video=Ce,F.video.loop=!0,F.video.addEventListener("playing",function(){F.map.triggerRepaint()}),F.map&&F.video.play(),F._finishLoading())})},R.prototype.pause=function(){this.video&&this.video.pause()},R.prototype.play=function(){this.video&&this.video.play()},R.prototype.seek=function(F){if(this.video){var q=this.video.seekable;F<q.start(0)||F>q.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+q.start(0)+" and "+q.end(0)+"-second mark."))):this.video.currentTime=F}},R.prototype.getVideo=function(){return this.video},R.prototype.onAdd=function(F){this.map||(this.map=F,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},R.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var F=this.map.painter.context,q=F.gl;for(var ae in this.boundsBuffer||(this.boundsBuffer=F.createVertexBuffer(this._boundsArray,Q.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(q.LINEAR,q.CLAMP_TO_EDGE),q.texSubImage2D(q.TEXTURE_2D,0,0,0,q.RGBA,q.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(F,this.video,q.RGBA),this.texture.bind(q.LINEAR,q.CLAMP_TO_EDGE)),this.tiles){var he=this.tiles[ae];he.state!=="loaded"&&(he.state="loaded",he.texture=this.texture)}}},R.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},R.prototype.hasTransition=function(){return this.video&&!this.video.paused},R}(X),re=function(C){function R(F,q,ae,he){C.call(this,F,q,ae,he),q.coordinates?Array.isArray(q.coordinates)&&q.coordinates.length===4&&!q.coordinates.some(function(be){return!Array.isArray(be)||be.length!==2||be.some(function(Ae){return typeof Ae!="number"})})||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'missing required property "coordinates"'))),q.animate&&typeof q.animate!="boolean"&&this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'optional "animate" property must be a boolean value'))),q.canvas?typeof q.canvas=="string"||q.canvas instanceof e.window.HTMLCanvasElement||this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError("sources."+F,null,'missing required property "canvas"'))),this.options=q,this.animate=q.animate===void 0||q.animate}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},R.prototype.getCanvas=function(){return this.canvas},R.prototype.onAdd=function(F){this.map=F,this.load(),this.canvas&&this.animate&&this.play()},R.prototype.onRemove=function(){this.pause()},R.prototype.prepare=function(){var F=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,F=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,F=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var q=this.map.painter.context,ae=q.gl;for(var he in this.boundsBuffer||(this.boundsBuffer=q.createVertexBuffer(this._boundsArray,Q.members)),this.boundsSegments||(this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(F||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(q,this.canvas,ae.RGBA,{premultiply:!0}),this.tiles){var be=this.tiles[he];be.state!=="loaded"&&(be.state="loaded",be.texture=this.texture)}}},R.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},R.prototype.hasTransition=function(){return this._playing},R.prototype._hasInvalidDimensions=function(){for(var F=0,q=[this.canvas.width,this.canvas.height];F<q.length;F+=1){var ae=q[F];if(isNaN(ae)||ae<=0)return!0}return!1},R}(X),H={vector:D,raster:j,"raster-dem":V,geojson:Z,video:$,image:X,canvas:re};function N(C,R){var F=e.identity([]);return e.translate(F,F,[1,1,0]),e.scale(F,F,[.5*C.width,.5*C.height,1]),e.multiply(F,F,C.calculatePosMatrix(R.toUnwrapped()))}function U(C,R,F,q,ae,he){var be=function(Lt,Tt,Bt){if(Lt)for(var zt=0,Ht=Lt;zt<Ht.length;zt+=1){var lr=Tt[Ht[zt]];if(lr&&lr.source===Bt&&lr.type==="fill-extrusion")return!0}else for(var br in Tt){var zr=Tt[br];if(zr.source===Bt&&zr.type==="fill-extrusion")return!0}return!1}(ae&&ae.layers,R,C.id),Ae=he.maxPitchScaleFactor(),Ce=C.tilesIn(q,Ae,be);Ce.sort(te);for(var qe=[],et=0,st=Ce;et<st.length;et+=1){var kt=st[et];qe.push({wrappedTileID:kt.tileID.wrapped().key,queryResults:kt.tile.queryRenderedFeatures(R,F,C._state,kt.queryGeometry,kt.cameraQueryGeometry,kt.scale,ae,he,Ae,N(C.transform,kt.tileID))})}var Pt=function(Lt){for(var Tt={},Bt={},zt=0,Ht=Lt;zt<Ht.length;zt+=1){var lr=Ht[zt],br=lr.queryResults,zr=lr.wrappedTileID,Or=Bt[zr]=Bt[zr]||{};for(var tn in br)for(var en=br[tn],vn=Or[tn]=Or[tn]||{},hn=Tt[tn]=Tt[tn]||[],Hn=0,Kn=en;Hn<Kn.length;Hn+=1){var hi=Kn[Hn];vn[hi.featureIndex]||(vn[hi.featureIndex]=!0,hn.push(hi))}}return Tt}(qe);for(var Et in Pt)Pt[Et].forEach(function(Lt){var Tt=Lt.feature,Bt=C.getFeatureState(Tt.layer["source-layer"],Tt.id);Tt.source=Tt.layer.source,Tt.layer["source-layer"]&&(Tt.sourceLayer=Tt.layer["source-layer"]),Tt.state=Bt});return Pt}function te(C,R){var F=C.tileID,q=R.tileID;return F.overscaledZ-q.overscaledZ||F.canonical.y-q.canonical.y||F.wrap-q.wrap||F.canonical.x-q.canonical.x}var B=function(C,R){this.max=C,this.onRemove=R,this.reset()};B.prototype.reset=function(){for(var C in this.data)for(var R=0,F=this.data[C];R<F.length;R+=1){var q=F[R];q.timeout&&clearTimeout(q.timeout),this.onRemove(q.value)}return this.data={},this.order=[],this},B.prototype.add=function(C,R,F){var q=this,ae=C.wrapped().key;this.data[ae]===void 0&&(this.data[ae]=[]);var he={value:R,timeout:void 0};if(F!==void 0&&(he.timeout=setTimeout(function(){q.remove(C,he)},F)),this.data[ae].push(he),this.order.push(ae),this.order.length>this.max){var be=this._getAndRemoveByKey(this.order[0]);be&&this.onRemove(be)}return this},B.prototype.has=function(C){return C.wrapped().key in this.data},B.prototype.getAndRemove=function(C){return this.has(C)?this._getAndRemoveByKey(C.wrapped().key):null},B.prototype._getAndRemoveByKey=function(C){var R=this.data[C].shift();return R.timeout&&clearTimeout(R.timeout),this.data[C].length===0&&delete this.data[C],this.order.splice(this.order.indexOf(C),1),R.value},B.prototype.getByKey=function(C){var R=this.data[C];return R?R[0].value:null},B.prototype.get=function(C){return this.has(C)?this.data[C.wrapped().key][0].value:null},B.prototype.remove=function(C,R){if(!this.has(C))return this;var F=C.wrapped().key,q=R===void 0?0:this.data[F].indexOf(R),ae=this.data[F][q];return this.data[F].splice(q,1),ae.timeout&&clearTimeout(ae.timeout),this.data[F].length===0&&delete this.data[F],this.onRemove(ae.value),this.order.splice(this.order.indexOf(F),1),this},B.prototype.setMaxSize=function(C){for(this.max=C;this.order.length>this.max;){var R=this._getAndRemoveByKey(this.order[0]);R&&this.onRemove(R)}return this},B.prototype.filter=function(C){var R=[];for(var F in this.data)for(var q=0,ae=this.data[F];q<ae.length;q+=1){var he=ae[q];C(he.value)||R.push(he)}for(var be=0,Ae=R;be<Ae.length;be+=1){var Ce=Ae[be];this.remove(Ce.value.tileID,Ce)}};var K=function(C,R,F){this.context=C;var q=C.gl;this.buffer=q.createBuffer(),this.dynamicDraw=Boolean(F),this.context.unbindVAO(),C.bindElementBuffer.set(this.buffer),q.bufferData(q.ELEMENT_ARRAY_BUFFER,R.arrayBuffer,this.dynamicDraw?q.DYNAMIC_DRAW:q.STATIC_DRAW),this.dynamicDraw||delete R.arrayBuffer};K.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},K.prototype.updateData=function(C){var R=this.context.gl;this.context.unbindVAO(),this.bind(),R.bufferSubData(R.ELEMENT_ARRAY_BUFFER,0,C.arrayBuffer)},K.prototype.destroy=function(){var C=this.context.gl;this.buffer&&(C.deleteBuffer(this.buffer),delete this.buffer)};var J={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},ee=function(C,R,F,q){this.length=R.length,this.attributes=F,this.itemSize=R.bytesPerElement,this.dynamicDraw=q,this.context=C;var ae=C.gl;this.buffer=ae.createBuffer(),C.bindVertexBuffer.set(this.buffer),ae.bufferData(ae.ARRAY_BUFFER,R.arrayBuffer,this.dynamicDraw?ae.DYNAMIC_DRAW:ae.STATIC_DRAW),this.dynamicDraw||delete R.arrayBuffer};ee.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},ee.prototype.updateData=function(C){var R=this.context.gl;this.bind(),R.bufferSubData(R.ARRAY_BUFFER,0,C.arrayBuffer)},ee.prototype.enableAttributes=function(C,R){for(var F=0;F<this.attributes.length;F++){var q=this.attributes[F],ae=R.attributes[q.name];ae!==void 0&&C.enableVertexAttribArray(ae)}},ee.prototype.setVertexAttribPointers=function(C,R,F){for(var q=0;q<this.attributes.length;q++){var ae=this.attributes[q],he=R.attributes[ae.name];he!==void 0&&C.vertexAttribPointer(he,ae.components,C[J[ae.type]],!1,this.itemSize,ae.offset+this.itemSize*(F||0))}},ee.prototype.destroy=function(){var C=this.context.gl;this.buffer&&(C.deleteBuffer(this.buffer),delete this.buffer)};var ne=function(C){this.gl=C.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};ne.prototype.get=function(){return this.current},ne.prototype.set=function(C){},ne.prototype.getDefault=function(){return this.default},ne.prototype.setDefault=function(){this.set(this.default)};var se=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return e.Color.transparent},R.prototype.set=function(F){var q=this.current;(F.r!==q.r||F.g!==q.g||F.b!==q.b||F.a!==q.a||this.dirty)&&(this.gl.clearColor(F.r,F.g,F.b,F.a),this.current=F,this.dirty=!1)},R}(ne),oe=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return 1},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.clearDepth(F),this.current=F,this.dirty=!1)},R}(ne),me=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return 0},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.clearStencil(F),this.current=F,this.dirty=!1)},R}(ne),ce=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return[!0,!0,!0,!0]},R.prototype.set=function(F){var q=this.current;(F[0]!==q[0]||F[1]!==q[1]||F[2]!==q[2]||F[3]!==q[3]||this.dirty)&&(this.gl.colorMask(F[0],F[1],F[2],F[3]),this.current=F,this.dirty=!1)},R}(ne),ye=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!0},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.depthMask(F),this.current=F,this.dirty=!1)},R}(ne),Se=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return 255},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.stencilMask(F),this.current=F,this.dirty=!1)},R}(ne),fe=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},R.prototype.set=function(F){var q=this.current;(F.func!==q.func||F.ref!==q.ref||F.mask!==q.mask||this.dirty)&&(this.gl.stencilFunc(F.func,F.ref,F.mask),this.current=F,this.dirty=!1)},R}(ne),ge=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){var F=this.gl;return[F.KEEP,F.KEEP,F.KEEP]},R.prototype.set=function(F){var q=this.current;(F[0]!==q[0]||F[1]!==q[1]||F[2]!==q[2]||this.dirty)&&(this.gl.stencilOp(F[0],F[1],F[2]),this.current=F,this.dirty=!1)},R}(ne),Te=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;F?q.enable(q.STENCIL_TEST):q.disable(q.STENCIL_TEST),this.current=F,this.dirty=!1}},R}(ne),le=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return[0,1]},R.prototype.set=function(F){var q=this.current;(F[0]!==q[0]||F[1]!==q[1]||this.dirty)&&(this.gl.depthRange(F[0],F[1]),this.current=F,this.dirty=!1)},R}(ne),ve=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;F?q.enable(q.DEPTH_TEST):q.disable(q.DEPTH_TEST),this.current=F,this.dirty=!1}},R}(ne),Me=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return this.gl.LESS},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.depthFunc(F),this.current=F,this.dirty=!1)},R}(ne),we=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;F?q.enable(q.BLEND):q.disable(q.BLEND),this.current=F,this.dirty=!1}},R}(ne),de=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){var F=this.gl;return[F.ONE,F.ZERO]},R.prototype.set=function(F){var q=this.current;(F[0]!==q[0]||F[1]!==q[1]||this.dirty)&&(this.gl.blendFunc(F[0],F[1]),this.current=F,this.dirty=!1)},R}(ne),Ie=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return e.Color.transparent},R.prototype.set=function(F){var q=this.current;(F.r!==q.r||F.g!==q.g||F.b!==q.b||F.a!==q.a||this.dirty)&&(this.gl.blendColor(F.r,F.g,F.b,F.a),this.current=F,this.dirty=!1)},R}(ne),De=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return this.gl.FUNC_ADD},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.blendEquation(F),this.current=F,this.dirty=!1)},R}(ne),Oe=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;F?q.enable(q.CULL_FACE):q.disable(q.CULL_FACE),this.current=F,this.dirty=!1}},R}(ne),Ve=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return this.gl.BACK},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.cullFace(F),this.current=F,this.dirty=!1)},R}(ne),Fe=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return this.gl.CCW},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.frontFace(F),this.current=F,this.dirty=!1)},R}(ne),ze=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.useProgram(F),this.current=F,this.dirty=!1)},R}(ne),Re=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return this.gl.TEXTURE0},R.prototype.set=function(F){(F!==this.current||this.dirty)&&(this.gl.activeTexture(F),this.current=F,this.dirty=!1)},R}(ne),We=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){var F=this.gl;return[0,0,F.drawingBufferWidth,F.drawingBufferHeight]},R.prototype.set=function(F){var q=this.current;(F[0]!==q[0]||F[1]!==q[1]||F[2]!==q[2]||F[3]!==q[3]||this.dirty)&&(this.gl.viewport(F[0],F[1],F[2],F[3]),this.current=F,this.dirty=!1)},R}(ne),$e=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;q.bindFramebuffer(q.FRAMEBUFFER,F),this.current=F,this.dirty=!1}},R}(ne),at=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;q.bindRenderbuffer(q.RENDERBUFFER,F),this.current=F,this.dirty=!1}},R}(ne),gt=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;q.bindTexture(q.TEXTURE_2D,F),this.current=F,this.dirty=!1}},R}(ne),xt=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;q.bindBuffer(q.ARRAY_BUFFER,F),this.current=F,this.dirty=!1}},R}(ne),mt=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){var q=this.gl;q.bindBuffer(q.ELEMENT_ARRAY_BUFFER,F),this.current=F,this.dirty=!1},R}(ne),nt=function(C){function R(F){C.call(this,F),this.vao=F.extVertexArrayObject}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R.prototype.set=function(F){this.vao&&(F!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(F),this.current=F,this.dirty=!1)},R}(ne),Qe=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return 4},R.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;q.pixelStorei(q.UNPACK_ALIGNMENT,F),this.current=F,this.dirty=!1}},R}(ne),vt=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;q.pixelStorei(q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,F),this.current=F,this.dirty=!1}},R}(ne),jt=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return!1},R.prototype.set=function(F){if(F!==this.current||this.dirty){var q=this.gl;q.pixelStorei(q.UNPACK_FLIP_Y_WEBGL,F),this.current=F,this.dirty=!1}},R}(ne),Gt=function(C){function R(F,q){C.call(this,F),this.context=F,this.parent=q}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getDefault=function(){return null},R}(ne),$t=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.setDirty=function(){this.dirty=!0},R.prototype.set=function(F){if(F!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var q=this.gl;q.framebufferTexture2D(q.FRAMEBUFFER,q.COLOR_ATTACHMENT0,q.TEXTURE_2D,F,0),this.current=F,this.dirty=!1}},R}(Gt),Zt=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.set=function(F){if(F!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var q=this.gl;q.framebufferRenderbuffer(q.FRAMEBUFFER,q.DEPTH_ATTACHMENT,q.RENDERBUFFER,F),this.current=F,this.dirty=!1}},R}(Gt),cr=function(C,R,F,q){this.context=C,this.width=R,this.height=F;var ae=C.gl,he=this.framebuffer=ae.createFramebuffer();this.colorAttachment=new $t(C,he),q&&(this.depthAttachment=new Zt(C,he))};cr.prototype.destroy=function(){var C=this.context.gl,R=this.colorAttachment.get();if(R&&C.deleteTexture(R),this.depthAttachment){var F=this.depthAttachment.get();F&&C.deleteRenderbuffer(F)}C.deleteFramebuffer(this.framebuffer)};var Dt=function(C,R,F){this.func=C,this.mask=R,this.range=F};Dt.ReadOnly=!1,Dt.ReadWrite=!0,Dt.disabled=new Dt(519,Dt.ReadOnly,[0,1]);var Ne=function(C,R,F,q,ae,he){this.test=C,this.ref=R,this.mask=F,this.fail=q,this.depthFail=ae,this.pass=he};Ne.disabled=new Ne({func:519,mask:0},0,0,7680,7680,7680);var Ye=function(C,R,F){this.blendFunction=C,this.blendColor=R,this.mask=F};Ye.disabled=new Ye(Ye.Replace=[1,0],e.Color.transparent,[!1,!1,!1,!1]),Ye.unblended=new Ye(Ye.Replace,e.Color.transparent,[!0,!0,!0,!0]),Ye.alphaBlended=new Ye([1,771],e.Color.transparent,[!0,!0,!0,!0]);var pe=function(C,R,F){this.enable=C,this.mode=R,this.frontFace=F};pe.disabled=new pe(!1,1029,2305),pe.backCCW=new pe(!0,1029,2305);var _e=function(C){this.gl=C,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new se(this),this.clearDepth=new oe(this),this.clearStencil=new me(this),this.colorMask=new ce(this),this.depthMask=new ye(this),this.stencilMask=new Se(this),this.stencilFunc=new fe(this),this.stencilOp=new ge(this),this.stencilTest=new Te(this),this.depthRange=new le(this),this.depthTest=new ve(this),this.depthFunc=new Me(this),this.blend=new we(this),this.blendFunc=new de(this),this.blendColor=new Ie(this),this.blendEquation=new De(this),this.cullFace=new Oe(this),this.cullFaceSide=new Ve(this),this.frontFace=new Fe(this),this.program=new ze(this),this.activeTexture=new Re(this),this.viewport=new We(this),this.bindFramebuffer=new $e(this),this.bindRenderbuffer=new at(this),this.bindTexture=new gt(this),this.bindVertexBuffer=new xt(this),this.bindElementBuffer=new mt(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new nt(this),this.pixelStoreUnpack=new Qe(this),this.pixelStoreUnpackPremultiplyAlpha=new vt(this),this.pixelStoreUnpackFlipY=new jt(this),this.extTextureFilterAnisotropic=C.getExtension("EXT_texture_filter_anisotropic")||C.getExtension("MOZ_EXT_texture_filter_anisotropic")||C.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=C.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=C.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(C.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=C.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=C.getExtension("EXT_disjoint_timer_query")};_e.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},_e.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},_e.prototype.createIndexBuffer=function(C,R){return new K(this,C,R)},_e.prototype.createVertexBuffer=function(C,R,F){return new ee(this,C,R,F)},_e.prototype.createRenderbuffer=function(C,R,F){var q=this.gl,ae=q.createRenderbuffer();return this.bindRenderbuffer.set(ae),q.renderbufferStorage(q.RENDERBUFFER,C,R,F),this.bindRenderbuffer.set(null),ae},_e.prototype.createFramebuffer=function(C,R,F){return new cr(this,C,R,F)},_e.prototype.clear=function(C){var R=C.color,F=C.depth,q=this.gl,ae=0;R&&(ae|=q.COLOR_BUFFER_BIT,this.clearColor.set(R),this.colorMask.set([!0,!0,!0,!0])),F!==void 0&&(ae|=q.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(F),this.depthMask.set(!0)),q.clear(ae)},_e.prototype.setCullFace=function(C){C.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(C.mode),this.frontFace.set(C.frontFace))},_e.prototype.setDepthMode=function(C){C.func!==this.gl.ALWAYS||C.mask?(this.depthTest.set(!0),this.depthFunc.set(C.func),this.depthMask.set(C.mask),this.depthRange.set(C.range)):this.depthTest.set(!1)},_e.prototype.setStencilMode=function(C){C.test.func!==this.gl.ALWAYS||C.mask?(this.stencilTest.set(!0),this.stencilMask.set(C.mask),this.stencilOp.set([C.fail,C.depthFail,C.pass]),this.stencilFunc.set({func:C.test.func,ref:C.ref,mask:C.test.mask})):this.stencilTest.set(!1)},_e.prototype.setColorMode=function(C){e.deepEqual(C.blendFunction,Ye.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(C.blendFunction),this.blendColor.set(C.blendColor)),this.colorMask.set(C.mask)},_e.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Be=function(C){function R(F,q,ae){var he=this;C.call(this),this.id=F,this.dispatcher=ae,this.on("data",function(be){be.dataType==="source"&&be.sourceDataType==="metadata"&&(he._sourceLoaded=!0),he._sourceLoaded&&!he._paused&&be.dataType==="source"&&be.sourceDataType==="content"&&(he.reload(),he.transform&&he.update(he.transform))}),this.on("error",function(){he._sourceErrored=!0}),this._source=function(be,Ae,Ce,qe){var et=new H[Ae.type](be,Ae,Ce,qe);if(et.id!==be)throw new Error("Expected Source id to be "+be+" instead of "+et.id);return e.bindAll(["load","abort","unload","serialize","prepare"],et),et}(F,q,ae,this),this._tiles={},this._cache=new B(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new e.SourceFeatureState}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.onAdd=function(F){this.map=F,this._maxTileCacheSize=F?F._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(F)},R.prototype.onRemove=function(F){this._source&&this._source.onRemove&&this._source.onRemove(F)},R.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var F in this._tiles){var q=this._tiles[F];if(q.state!=="loaded"&&q.state!=="errored")return!1}return!0},R.prototype.getSource=function(){return this._source},R.prototype.pause=function(){this._paused=!0},R.prototype.resume=function(){if(this._paused){var F=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,F&&this.reload(),this.transform&&this.update(this.transform)}},R.prototype._loadTile=function(F,q){return this._source.loadTile(F,q)},R.prototype._unloadTile=function(F){if(this._source.unloadTile)return this._source.unloadTile(F,function(){})},R.prototype._abortTile=function(F){if(this._source.abortTile)return this._source.abortTile(F,function(){})},R.prototype.serialize=function(){return this._source.serialize()},R.prototype.prepare=function(F){for(var q in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var ae=this._tiles[q];ae.upload(F),ae.prepare(this.map.style.imageManager)}},R.prototype.getIds=function(){return e.values(this._tiles).map(function(F){return F.tileID}).sort(He).map(function(F){return F.key})},R.prototype.getRenderableIds=function(F){var q=this,ae=[];for(var he in this._tiles)this._isIdRenderable(he,F)&&ae.push(this._tiles[he]);return F?ae.sort(function(be,Ae){var Ce=be.tileID,qe=Ae.tileID,et=new e.Point(Ce.canonical.x,Ce.canonical.y)._rotate(q.transform.angle),st=new e.Point(qe.canonical.x,qe.canonical.y)._rotate(q.transform.angle);return Ce.overscaledZ-qe.overscaledZ||st.y-et.y||st.x-et.x}).map(function(be){return be.tileID.key}):ae.map(function(be){return be.tileID}).sort(He).map(function(be){return be.key})},R.prototype.hasRenderableParent=function(F){var q=this.findLoadedParent(F,0);return!!q&&this._isIdRenderable(q.tileID.key)},R.prototype._isIdRenderable=function(F,q){return this._tiles[F]&&this._tiles[F].hasData()&&!this._coveredTiles[F]&&(q||!this._tiles[F].holdingForFade())},R.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var F in this._cache.reset(),this._tiles)this._tiles[F].state!=="errored"&&this._reloadTile(F,"reloading")},R.prototype._reloadTile=function(F,q){var ae=this._tiles[F];ae&&(ae.state!=="loading"&&(ae.state=q),this._loadTile(ae,this._tileLoaded.bind(this,ae,F,q)))},R.prototype._tileLoaded=function(F,q,ae,he){if(he)return F.state="errored",void(he.status!==404?this._source.fire(new e.ErrorEvent(he,{tile:F})):this.update(this.transform));F.timeAdded=e.browser.now(),ae==="expired"&&(F.refreshedUponExpiration=!0),this._setTileReloadTimer(q,F),this.getSource().type==="raster-dem"&&F.dem&&this._backfillDEM(F),this._state.initializeTileState(F,this.map?this.map.painter:null),this._source.fire(new e.Event("data",{dataType:"source",tile:F,coord:F.tileID}))},R.prototype._backfillDEM=function(F){for(var q=this.getRenderableIds(),ae=0;ae<q.length;ae++){var he=q[ae];if(F.neighboringTiles&&F.neighboringTiles[he]){var be=this.getTileByID(he);Ae(F,be),Ae(be,F)}}function Ae(Ce,qe){Ce.needsHillshadePrepare=!0;var et=qe.tileID.canonical.x-Ce.tileID.canonical.x,st=qe.tileID.canonical.y-Ce.tileID.canonical.y,kt=Math.pow(2,Ce.tileID.canonical.z),Pt=qe.tileID.key;et===0&&st===0||Math.abs(st)>1||(Math.abs(et)>1&&(Math.abs(et+kt)===1?et+=kt:Math.abs(et-kt)===1&&(et-=kt)),qe.dem&&Ce.dem&&(Ce.dem.backfillBorder(qe.dem,et,st),Ce.neighboringTiles&&Ce.neighboringTiles[Pt]&&(Ce.neighboringTiles[Pt].backfilled=!0)))}},R.prototype.getTile=function(F){return this.getTileByID(F.key)},R.prototype.getTileByID=function(F){return this._tiles[F]},R.prototype._retainLoadedChildren=function(F,q,ae,he){for(var be in this._tiles){var Ae=this._tiles[be];if(!(he[be]||!Ae.hasData()||Ae.tileID.overscaledZ<=q||Ae.tileID.overscaledZ>ae)){for(var Ce=Ae.tileID;Ae&&Ae.tileID.overscaledZ>q+1;){var qe=Ae.tileID.scaledTo(Ae.tileID.overscaledZ-1);(Ae=this._tiles[qe.key])&&Ae.hasData()&&(Ce=qe)}for(var et=Ce;et.overscaledZ>q;)if(F[(et=et.scaledTo(et.overscaledZ-1)).key]){he[Ce.key]=Ce;break}}}},R.prototype.findLoadedParent=function(F,q){if(F.key in this._loadedParentTiles){var ae=this._loadedParentTiles[F.key];return ae&&ae.tileID.overscaledZ>=q?ae:null}for(var he=F.overscaledZ-1;he>=q;he--){var be=F.scaledTo(he),Ae=this._getLoadedTile(be);if(Ae)return Ae}},R.prototype._getLoadedTile=function(F){var q=this._tiles[F.key];return q&&q.hasData()?q:this._cache.getByKey(F.wrapped().key)},R.prototype.updateCacheSize=function(F){var q=(Math.ceil(F.width/this._source.tileSize)+1)*(Math.ceil(F.height/this._source.tileSize)+1),ae=Math.floor(5*q),he=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,ae):ae;this._cache.setMaxSize(he)},R.prototype.handleWrapJump=function(F){var q=(F-(this._prevLng===void 0?F:this._prevLng))/360,ae=Math.round(q);if(this._prevLng=F,ae){var he={};for(var be in this._tiles){var Ae=this._tiles[be];Ae.tileID=Ae.tileID.unwrapTo(Ae.tileID.wrap+ae),he[Ae.tileID.key]=Ae}for(var Ce in this._tiles=he,this._timers)clearTimeout(this._timers[Ce]),delete this._timers[Ce];for(var qe in this._tiles){var et=this._tiles[qe];this._setTileReloadTimer(qe,et)}}},R.prototype.update=function(F){var q=this;if(this.transform=F,this._sourceLoaded&&!this._paused){var ae;this.updateCacheSize(F),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?ae=F.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Or){return new e.OverscaledTileID(Or.canonical.z,Or.wrap,Or.canonical.z,Or.canonical.x,Or.canonical.y)}):(ae=F.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(ae=ae.filter(function(Or){return q._source.hasTile(Or)}))):ae=[];var he=F.coveringZoomLevel(this._source),be=Math.max(he-R.maxOverzooming,this._source.minzoom),Ae=Math.max(he+R.maxUnderzooming,this._source.minzoom),Ce=this._updateRetainedTiles(ae,he);if(Je(this._source.type)){for(var qe={},et={},st=0,kt=Object.keys(Ce);st<kt.length;st+=1){var Pt=kt[st],Et=Ce[Pt],Lt=this._tiles[Pt];if(Lt&&!(Lt.fadeEndTime&&Lt.fadeEndTime<=e.browser.now())){var Tt=this.findLoadedParent(Et,be);Tt&&(this._addTile(Tt.tileID),qe[Tt.tileID.key]=Tt.tileID),et[Pt]=Et}}for(var Bt in this._retainLoadedChildren(et,he,Ae,Ce),qe)Ce[Bt]||(this._coveredTiles[Bt]=!0,Ce[Bt]=qe[Bt])}for(var zt in Ce)this._tiles[zt].clearFadeHold();for(var Ht=0,lr=e.keysDifference(this._tiles,Ce);Ht<lr.length;Ht+=1){var br=lr[Ht],zr=this._tiles[br];zr.hasSymbolBuckets&&!zr.holdingForFade()?zr.setHoldDuration(this.map._fadeDuration):zr.hasSymbolBuckets&&!zr.symbolFadeFinished()||this._removeTile(br)}this._updateLoadedParentTileCache()}},R.prototype.releaseSymbolFadeTiles=function(){for(var F in this._tiles)this._tiles[F].holdingForFade()&&this._removeTile(F)},R.prototype._updateRetainedTiles=function(F,q){for(var ae={},he={},be=Math.max(q-R.maxOverzooming,this._source.minzoom),Ae=Math.max(q+R.maxUnderzooming,this._source.minzoom),Ce={},qe=0,et=F;qe<et.length;qe+=1){var st=et[qe],kt=this._addTile(st);ae[st.key]=st,kt.hasData()||q<this._source.maxzoom&&(Ce[st.key]=st)}this._retainLoadedChildren(Ce,q,Ae,ae);for(var Pt=0,Et=F;Pt<Et.length;Pt+=1){var Lt=Et[Pt],Tt=this._tiles[Lt.key];if(!Tt.hasData()){if(q+1>this._source.maxzoom){var Bt=Lt.children(this._source.maxzoom)[0],zt=this.getTile(Bt);if(zt&&zt.hasData()){ae[Bt.key]=Bt;continue}}else{var Ht=Lt.children(this._source.maxzoom);if(ae[Ht[0].key]&&ae[Ht[1].key]&&ae[Ht[2].key]&&ae[Ht[3].key])continue}for(var lr=Tt.wasRequested(),br=Lt.overscaledZ-1;br>=be;--br){var zr=Lt.scaledTo(br);if(he[zr.key]||(he[zr.key]=!0,!(Tt=this.getTile(zr))&&lr&&(Tt=this._addTile(zr)),Tt&&(ae[zr.key]=zr,lr=Tt.wasRequested(),Tt.hasData())))break}}}return ae},R.prototype._updateLoadedParentTileCache=function(){for(var F in this._loadedParentTiles={},this._tiles){for(var q=[],ae=void 0,he=this._tiles[F].tileID;he.overscaledZ>0;){if(he.key in this._loadedParentTiles){ae=this._loadedParentTiles[he.key];break}q.push(he.key);var be=he.scaledTo(he.overscaledZ-1);if(ae=this._getLoadedTile(be))break;he=be}for(var Ae=0,Ce=q;Ae<Ce.length;Ae+=1){var qe=Ce[Ae];this._loadedParentTiles[qe]=ae}}},R.prototype._addTile=function(F){var q=this._tiles[F.key];if(q)return q;(q=this._cache.getAndRemove(F))&&(this._setTileReloadTimer(F.key,q),q.tileID=F,this._state.initializeTileState(q,this.map?this.map.painter:null),this._cacheTimers[F.key]&&(clearTimeout(this._cacheTimers[F.key]),delete this._cacheTimers[F.key],this._setTileReloadTimer(F.key,q)));var ae=Boolean(q);return ae||(q=new e.Tile(F,this._source.tileSize*F.overscaleFactor()),this._loadTile(q,this._tileLoaded.bind(this,q,F.key,q.state))),q?(q.uses++,this._tiles[F.key]=q,ae||this._source.fire(new e.Event("dataloading",{tile:q,coord:q.tileID,dataType:"source"})),q):null},R.prototype._setTileReloadTimer=function(F,q){var ae=this;F in this._timers&&(clearTimeout(this._timers[F]),delete this._timers[F]);var he=q.getExpiryTimeout();he&&(this._timers[F]=setTimeout(function(){ae._reloadTile(F,"expired"),delete ae._timers[F]},he))},R.prototype._removeTile=function(F){var q=this._tiles[F];q&&(q.uses--,delete this._tiles[F],this._timers[F]&&(clearTimeout(this._timers[F]),delete this._timers[F]),q.uses>0||(q.hasData()&&q.state!=="reloading"?this._cache.add(q.tileID,q,q.getExpiryTimeout()):(q.aborted=!0,this._abortTile(q),this._unloadTile(q))))},R.prototype.clearTiles=function(){for(var F in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(F);this._cache.reset()},R.prototype.tilesIn=function(F,q,ae){var he=this,be=[],Ae=this.transform;if(!Ae)return be;for(var Ce=ae?Ae.getCameraQueryGeometry(F):F,qe=F.map(function(br){return Ae.pointCoordinate(br)}),et=Ce.map(function(br){return Ae.pointCoordinate(br)}),st=this.getIds(),kt=1/0,Pt=1/0,Et=-1/0,Lt=-1/0,Tt=0,Bt=et;Tt<Bt.length;Tt+=1){var zt=Bt[Tt];kt=Math.min(kt,zt.x),Pt=Math.min(Pt,zt.y),Et=Math.max(Et,zt.x),Lt=Math.max(Lt,zt.y)}for(var Ht=function(br){var zr=he._tiles[st[br]];if(!zr.holdingForFade()){var Or=zr.tileID,tn=Math.pow(2,Ae.zoom-zr.tileID.overscaledZ),en=q*zr.queryPadding*e.EXTENT/zr.tileSize/tn,vn=[Or.getTilePoint(new e.MercatorCoordinate(kt,Pt)),Or.getTilePoint(new e.MercatorCoordinate(Et,Lt))];if(vn[0].x-en<e.EXTENT&&vn[0].y-en<e.EXTENT&&vn[1].x+en>=0&&vn[1].y+en>=0){var hn=qe.map(function(Kn){return Or.getTilePoint(Kn)}),Hn=et.map(function(Kn){return Or.getTilePoint(Kn)});be.push({tile:zr,tileID:Or,queryGeometry:hn,cameraQueryGeometry:Hn,scale:tn})}}},lr=0;lr<st.length;lr++)Ht(lr);return be},R.prototype.getVisibleCoordinates=function(F){for(var q=this,ae=this.getRenderableIds(F).map(function(Ce){return q._tiles[Ce].tileID}),he=0,be=ae;he<be.length;he+=1){var Ae=be[he];Ae.posMatrix=this.transform.calculatePosMatrix(Ae.toUnwrapped())}return ae},R.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Je(this._source.type))for(var F in this._tiles){var q=this._tiles[F];if(q.fadeEndTime!==void 0&&q.fadeEndTime>=e.browser.now())return!0}return!1},R.prototype.setFeatureState=function(F,q,ae){F=F||"_geojsonTileLayer",this._state.updateState(F,q,ae)},R.prototype.removeFeatureState=function(F,q,ae){F=F||"_geojsonTileLayer",this._state.removeFeatureState(F,q,ae)},R.prototype.getFeatureState=function(F,q){return F=F||"_geojsonTileLayer",this._state.getState(F,q)},R.prototype.setDependencies=function(F,q,ae){var he=this._tiles[F];he&&he.setDependencies(q,ae)},R.prototype.reloadTilesForDependencies=function(F,q){for(var ae in this._tiles)this._tiles[ae].hasDependency(F,q)&&this._reloadTile(ae,"reloading");this._cache.filter(function(he){return!he.hasDependency(F,q)})},R}(e.Evented);function He(C,R){var F=Math.abs(2*C.wrap)-+(C.wrap<0),q=Math.abs(2*R.wrap)-+(R.wrap<0);return C.overscaledZ-R.overscaledZ||q-F||R.canonical.y-C.canonical.y||R.canonical.x-C.canonical.x}function Je(C){return C==="raster"||C==="image"||C==="video"}function Ze(){return new e.window.Worker(ue.workerUrl)}Be.maxOverzooming=10,Be.maxUnderzooming=3;var ct="mapboxgl_preloaded_worker_pool",lt=function(){this.active={}};lt.prototype.acquire=function(C){if(!this.workers)for(this.workers=[];this.workers.length<lt.workerCount;)this.workers.push(new Ze);return this.active[C]=!0,this.workers.slice()},lt.prototype.release=function(C){delete this.active[C],this.numActive()===0&&(this.workers.forEach(function(R){R.terminate()}),this.workers=null)},lt.prototype.isPreloaded=function(){return!!this.active[ct]},lt.prototype.numActive=function(){return Object.keys(this.active).length};var At,Ot=Math.floor(e.browser.hardwareConcurrency/2);function it(){return At||(At=new lt),At}function ht(C,R){var F={};for(var q in C)q!=="ref"&&(F[q]=C[q]);return e.refProperties.forEach(function(ae){ae in R&&(F[ae]=R[ae])}),F}function Ut(C){C=C.slice();for(var R=Object.create(null),F=0;F<C.length;F++)R[C[F].id]=C[F];for(var q=0;q<C.length;q++)"ref"in C[q]&&(C[q]=ht(C[q],R[C[q].ref]));return C}lt.workerCount=Math.max(Math.min(Ot,6),1);var Mt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function It(C,R,F){F.push({command:Mt.addSource,args:[C,R[C]]})}function Le(C,R,F){R.push({command:Mt.removeSource,args:[C]}),F[C]=!0}function Xe(C,R,F,q){Le(C,F,q),It(C,R,F)}function ot(C,R,F){var q;for(q in C[F])if(C[F].hasOwnProperty(q)&&q!=="data"&&!e.deepEqual(C[F][q],R[F][q]))return!1;for(q in R[F])if(R[F].hasOwnProperty(q)&&q!=="data"&&!e.deepEqual(C[F][q],R[F][q]))return!1;return!0}function pt(C,R,F,q,ae,he){var be;for(be in R=R||{},C=C||{})C.hasOwnProperty(be)&&(e.deepEqual(C[be],R[be])||F.push({command:he,args:[q,be,R[be],ae]}));for(be in R)R.hasOwnProperty(be)&&!C.hasOwnProperty(be)&&(e.deepEqual(C[be],R[be])||F.push({command:he,args:[q,be,R[be],ae]}))}function St(C){return C.id}function Vt(C,R){return C[R.id]=R,C}function Jt(C,R){if(!C)return[{command:Mt.setStyle,args:[R]}];var F=[];try{if(!e.deepEqual(C.version,R.version))return[{command:Mt.setStyle,args:[R]}];e.deepEqual(C.center,R.center)||F.push({command:Mt.setCenter,args:[R.center]}),e.deepEqual(C.zoom,R.zoom)||F.push({command:Mt.setZoom,args:[R.zoom]}),e.deepEqual(C.bearing,R.bearing)||F.push({command:Mt.setBearing,args:[R.bearing]}),e.deepEqual(C.pitch,R.pitch)||F.push({command:Mt.setPitch,args:[R.pitch]}),e.deepEqual(C.sprite,R.sprite)||F.push({command:Mt.setSprite,args:[R.sprite]}),e.deepEqual(C.glyphs,R.glyphs)||F.push({command:Mt.setGlyphs,args:[R.glyphs]}),e.deepEqual(C.transition,R.transition)||F.push({command:Mt.setTransition,args:[R.transition]}),e.deepEqual(C.light,R.light)||F.push({command:Mt.setLight,args:[R.light]});var q={},ae=[];(function(be,Ae,Ce,qe){var et;for(et in Ae=Ae||{},be=be||{})be.hasOwnProperty(et)&&(Ae.hasOwnProperty(et)||Le(et,Ce,qe));for(et in Ae)Ae.hasOwnProperty(et)&&(be.hasOwnProperty(et)?e.deepEqual(be[et],Ae[et])||(be[et].type==="geojson"&&Ae[et].type==="geojson"&&ot(be,Ae,et)?Ce.push({command:Mt.setGeoJSONSourceData,args:[et,Ae[et].data]}):Xe(et,Ae,Ce,qe)):It(et,Ae,Ce))})(C.sources,R.sources,ae,q);var he=[];C.layers&&C.layers.forEach(function(be){q[be.source]?F.push({command:Mt.removeLayer,args:[be.id]}):he.push(be)}),F=F.concat(ae),function(be,Ae,Ce){Ae=Ae||[];var qe,et,st,kt,Pt,Et,Lt,Tt=(be=be||[]).map(St),Bt=Ae.map(St),zt=be.reduce(Vt,{}),Ht=Ae.reduce(Vt,{}),lr=Tt.slice(),br=Object.create(null);for(qe=0,et=0;qe<Tt.length;qe++)st=Tt[qe],Ht.hasOwnProperty(st)?et++:(Ce.push({command:Mt.removeLayer,args:[st]}),lr.splice(lr.indexOf(st,et),1));for(qe=0,et=0;qe<Bt.length;qe++)st=Bt[Bt.length-1-qe],lr[lr.length-1-qe]!==st&&(zt.hasOwnProperty(st)?(Ce.push({command:Mt.removeLayer,args:[st]}),lr.splice(lr.lastIndexOf(st,lr.length-et),1)):et++,Et=lr[lr.length-qe],Ce.push({command:Mt.addLayer,args:[Ht[st],Et]}),lr.splice(lr.length-qe,0,st),br[st]=!0);for(qe=0;qe<Bt.length;qe++)if(kt=zt[st=Bt[qe]],Pt=Ht[st],!br[st]&&!e.deepEqual(kt,Pt))if(e.deepEqual(kt.source,Pt.source)&&e.deepEqual(kt["source-layer"],Pt["source-layer"])&&e.deepEqual(kt.type,Pt.type)){for(Lt in pt(kt.layout,Pt.layout,Ce,st,null,Mt.setLayoutProperty),pt(kt.paint,Pt.paint,Ce,st,null,Mt.setPaintProperty),e.deepEqual(kt.filter,Pt.filter)||Ce.push({command:Mt.setFilter,args:[st,Pt.filter]}),e.deepEqual(kt.minzoom,Pt.minzoom)&&e.deepEqual(kt.maxzoom,Pt.maxzoom)||Ce.push({command:Mt.setLayerZoomRange,args:[st,Pt.minzoom,Pt.maxzoom]}),kt)kt.hasOwnProperty(Lt)&&Lt!=="layout"&&Lt!=="paint"&&Lt!=="filter"&&Lt!=="metadata"&&Lt!=="minzoom"&&Lt!=="maxzoom"&&(Lt.indexOf("paint.")===0?pt(kt[Lt],Pt[Lt],Ce,st,Lt.slice(6),Mt.setPaintProperty):e.deepEqual(kt[Lt],Pt[Lt])||Ce.push({command:Mt.setLayerProperty,args:[st,Lt,Pt[Lt]]}));for(Lt in Pt)Pt.hasOwnProperty(Lt)&&!kt.hasOwnProperty(Lt)&&Lt!=="layout"&&Lt!=="paint"&&Lt!=="filter"&&Lt!=="metadata"&&Lt!=="minzoom"&&Lt!=="maxzoom"&&(Lt.indexOf("paint.")===0?pt(kt[Lt],Pt[Lt],Ce,st,Lt.slice(6),Mt.setPaintProperty):e.deepEqual(kt[Lt],Pt[Lt])||Ce.push({command:Mt.setLayerProperty,args:[st,Lt,Pt[Lt]]}))}else Ce.push({command:Mt.removeLayer,args:[st]}),Et=lr[lr.lastIndexOf(st)+1],Ce.push({command:Mt.addLayer,args:[Pt,Et]})}(he,R.layers,F)}catch(be){console.warn("Unable to compute style diff:",be),F=[{command:Mt.setStyle,args:[R]}]}return F}var qt=function(C,R){this.reset(C,R)};qt.prototype.reset=function(C,R){this.points=C||[],this._distances=[0];for(var F=1;F<this.points.length;F++)this._distances[F]=this._distances[F-1]+this.points[F].dist(this.points[F-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(R||0,.5*this.length),this.paddedLength=this.length-2*this.padding},qt.prototype.lerp=function(C){if(this.points.length===1)return this.points[0];C=e.clamp(C,0,1);for(var R=1,F=this._distances[R],q=C*this.paddedLength+this.padding;F<q&&R<this._distances.length;)F=this._distances[++R];var ae=R-1,he=this._distances[ae],be=F-he,Ae=be>0?(q-he)/be:0;return this.points[ae].mult(1-Ae).add(this.points[R].mult(Ae))};var gr=function(C,R,F){var q=this.boxCells=[],ae=this.circleCells=[];this.xCellCount=Math.ceil(C/F),this.yCellCount=Math.ceil(R/F);for(var he=0;he<this.xCellCount*this.yCellCount;he++)q.push([]),ae.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=C,this.height=R,this.xScale=this.xCellCount/C,this.yScale=this.yCellCount/R,this.boxUid=0,this.circleUid=0};function Cr(C,R,F,q,ae){var he=e.create();return R?(e.scale(he,he,[1/ae,1/ae,1]),F||e.rotateZ(he,he,q.angle)):e.multiply(he,q.labelPlaneMatrix,C),he}function mr(C,R,F,q,ae){if(R){var he=e.clone(C);return e.scale(he,he,[ae,ae,1]),F||e.rotateZ(he,he,-q.angle),he}return q.glCoordMatrix}function tr(C,R){var F=[C.x,C.y,0,1];zn(F,F,R);var q=F[3];return{point:new e.Point(F[0]/q,F[1]/q),signedDistanceFromCamera:q}}function nr(C,R){return .5+C/R*.5}function Qt(C,R){var F=C[0]/C[3],q=C[1]/C[3];return F>=-R[0]&&F<=R[0]&&q>=-R[1]&&q<=R[1]}function dr(C,R,F,q,ae,he,be,Ae){var Ce=q?C.textSizeData:C.iconSizeData,qe=e.evaluateSizeForZoom(Ce,F.transform.zoom),et=[256/F.width*2+1,256/F.height*2+1],st=q?C.text.dynamicLayoutVertexArray:C.icon.dynamicLayoutVertexArray;st.clear();for(var kt=C.lineVertexArray,Pt=q?C.text.placedSymbolArray:C.icon.placedSymbolArray,Et=F.transform.width/F.transform.height,Lt=!1,Tt=0;Tt<Pt.length;Tt++){var Bt=Pt.get(Tt);if(Bt.hidden||Bt.writingMode===e.WritingMode.vertical&&!Lt)an(Bt.numGlyphs,st);else{Lt=!1;var zt=[Bt.anchorX,Bt.anchorY,0,1];if(e.transformMat4(zt,zt,R),Qt(zt,et)){var Ht=zt[3],lr=nr(F.transform.cameraToCenterDistance,Ht),br=e.evaluateSizeForFeature(Ce,qe,Bt),zr=be?br/lr:br*lr,Or=new e.Point(Bt.anchorX,Bt.anchorY),tn=tr(Or,ae).point,en={},vn=Rr(Bt,zr,!1,Ae,R,ae,he,C.glyphOffsetArray,kt,st,tn,Or,en,Et);Lt=vn.useVertical,(vn.notEnoughRoom||Lt||vn.needsFlipping&&Rr(Bt,zr,!0,Ae,R,ae,he,C.glyphOffsetArray,kt,st,tn,Or,en,Et).notEnoughRoom)&&an(Bt.numGlyphs,st)}else an(Bt.numGlyphs,st)}}q?C.text.dynamicLayoutVertexBuffer.updateData(st):C.icon.dynamicLayoutVertexBuffer.updateData(st)}function _r(C,R,F,q,ae,he,be,Ae,Ce,qe,et){var st=Ae.glyphStartIndex+Ae.numGlyphs,kt=Ae.lineStartIndex,Pt=Ae.lineStartIndex+Ae.lineLength,Et=R.getoffsetX(Ae.glyphStartIndex),Lt=R.getoffsetX(st-1),Tt=Xr(C*Et,F,q,ae,he,be,Ae.segment,kt,Pt,Ce,qe,et);if(!Tt)return null;var Bt=Xr(C*Lt,F,q,ae,he,be,Ae.segment,kt,Pt,Ce,qe,et);return Bt?{first:Tt,last:Bt}:null}function Ir(C,R,F,q){return C===e.WritingMode.horizontal&&Math.abs(F.y-R.y)>Math.abs(F.x-R.x)*q?{useVertical:!0}:(C===e.WritingMode.vertical?R.y<F.y:R.x>F.x)?{needsFlipping:!0}:null}function Rr(C,R,F,q,ae,he,be,Ae,Ce,qe,et,st,kt,Pt){var Et,Lt=R/24,Tt=C.lineOffsetX*Lt,Bt=C.lineOffsetY*Lt;if(C.numGlyphs>1){var zt=C.glyphStartIndex+C.numGlyphs,Ht=C.lineStartIndex,lr=C.lineStartIndex+C.lineLength,br=_r(Lt,Ae,Tt,Bt,F,et,st,C,Ce,he,kt);if(!br)return{notEnoughRoom:!0};var zr=tr(br.first.point,be).point,Or=tr(br.last.point,be).point;if(q&&!F){var tn=Ir(C.writingMode,zr,Or,Pt);if(tn)return tn}Et=[br.first];for(var en=C.glyphStartIndex+1;en<zt-1;en++)Et.push(Xr(Lt*Ae.getoffsetX(en),Tt,Bt,F,et,st,C.segment,Ht,lr,Ce,he,kt));Et.push(br.last)}else{if(q&&!F){var vn=tr(st,ae).point,hn=C.lineStartIndex+C.segment+1,Hn=new e.Point(Ce.getx(hn),Ce.gety(hn)),Kn=tr(Hn,ae),hi=Kn.signedDistanceFromCamera>0?Kn.point:Vr(st,Hn,vn,1,ae),Kr=Ir(C.writingMode,vn,hi,Pt);if(Kr)return Kr}var Ln=Xr(Lt*Ae.getoffsetX(C.glyphStartIndex),Tt,Bt,F,et,st,C.segment,C.lineStartIndex,C.lineStartIndex+C.lineLength,Ce,he,kt);if(!Ln)return{notEnoughRoom:!0};Et=[Ln]}for(var Jn=0,Wn=Et;Jn<Wn.length;Jn+=1){var oi=Wn[Jn];e.addDynamicAttributes(qe,oi.point,oi.angle)}return{}}function Vr(C,R,F,q,ae){var he=tr(C.add(C.sub(R)._unit()),ae).point,be=F.sub(he);return F.add(be._mult(q/be.mag()))}function Xr(C,R,F,q,ae,he,be,Ae,Ce,qe,et,st){var kt=q?C-R:C+R,Pt=kt>0?1:-1,Et=0;q&&(Pt*=-1,Et=Math.PI),Pt<0&&(Et+=Math.PI);for(var Lt=Pt>0?Ae+be:Ae+be+1,Tt=ae,Bt=ae,zt=0,Ht=0,lr=Math.abs(kt),br=[];zt+Ht<=lr;){if((Lt+=Pt)<Ae||Lt>=Ce)return null;if(Bt=Tt,br.push(Tt),(Tt=st[Lt])===void 0){var zr=new e.Point(qe.getx(Lt),qe.gety(Lt)),Or=tr(zr,et);if(Or.signedDistanceFromCamera>0)Tt=st[Lt]=Or.point;else{var tn=Lt-Pt;Tt=Vr(zt===0?he:new e.Point(qe.getx(tn),qe.gety(tn)),zr,Bt,lr-zt+1,et)}}zt+=Ht,Ht=Bt.dist(Tt)}var en=(lr-zt)/Ht,vn=Tt.sub(Bt),hn=vn.mult(en)._add(Bt);hn._add(vn._unit()._perp()._mult(F*Pt));var Hn=Et+Math.atan2(Tt.y-Bt.y,Tt.x-Bt.x);return br.push(hn),{point:hn,angle:Hn,path:br}}gr.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},gr.prototype.insert=function(C,R,F,q,ae){this._forEachCell(R,F,q,ae,this._insertBoxCell,this.boxUid++),this.boxKeys.push(C),this.bboxes.push(R),this.bboxes.push(F),this.bboxes.push(q),this.bboxes.push(ae)},gr.prototype.insertCircle=function(C,R,F,q){this._forEachCell(R-q,F-q,R+q,F+q,this._insertCircleCell,this.circleUid++),this.circleKeys.push(C),this.circles.push(R),this.circles.push(F),this.circles.push(q)},gr.prototype._insertBoxCell=function(C,R,F,q,ae,he){this.boxCells[ae].push(he)},gr.prototype._insertCircleCell=function(C,R,F,q,ae,he){this.circleCells[ae].push(he)},gr.prototype._query=function(C,R,F,q,ae,he){if(F<0||C>this.width||q<0||R>this.height)return!ae&&[];var be=[];if(C<=0&&R<=0&&this.width<=F&&this.height<=q){if(ae)return!0;for(var Ae=0;Ae<this.boxKeys.length;Ae++)be.push({key:this.boxKeys[Ae],x1:this.bboxes[4*Ae],y1:this.bboxes[4*Ae+1],x2:this.bboxes[4*Ae+2],y2:this.bboxes[4*Ae+3]});for(var Ce=0;Ce<this.circleKeys.length;Ce++){var qe=this.circles[3*Ce],et=this.circles[3*Ce+1],st=this.circles[3*Ce+2];be.push({key:this.circleKeys[Ce],x1:qe-st,y1:et-st,x2:qe+st,y2:et+st})}return he?be.filter(he):be}var kt={hitTest:ae,seenUids:{box:{},circle:{}}};return this._forEachCell(C,R,F,q,this._queryCell,be,kt,he),ae?be.length>0:be},gr.prototype._queryCircle=function(C,R,F,q,ae){var he=C-F,be=C+F,Ae=R-F,Ce=R+F;if(be<0||he>this.width||Ce<0||Ae>this.height)return!q&&[];var qe=[],et={hitTest:q,circle:{x:C,y:R,radius:F},seenUids:{box:{},circle:{}}};return this._forEachCell(he,Ae,be,Ce,this._queryCellCircle,qe,et,ae),q?qe.length>0:qe},gr.prototype.query=function(C,R,F,q,ae){return this._query(C,R,F,q,!1,ae)},gr.prototype.hitTest=function(C,R,F,q,ae){return this._query(C,R,F,q,!0,ae)},gr.prototype.hitTestCircle=function(C,R,F,q){return this._queryCircle(C,R,F,!0,q)},gr.prototype._queryCell=function(C,R,F,q,ae,he,be,Ae){var Ce=be.seenUids,qe=this.boxCells[ae];if(qe!==null)for(var et=this.bboxes,st=0,kt=qe;st<kt.length;st+=1){var Pt=kt[st];if(!Ce.box[Pt]){Ce.box[Pt]=!0;var Et=4*Pt;if(C<=et[Et+2]&&R<=et[Et+3]&&F>=et[Et+0]&&q>=et[Et+1]&&(!Ae||Ae(this.boxKeys[Pt]))){if(be.hitTest)return he.push(!0),!0;he.push({key:this.boxKeys[Pt],x1:et[Et],y1:et[Et+1],x2:et[Et+2],y2:et[Et+3]})}}}var Lt=this.circleCells[ae];if(Lt!==null)for(var Tt=this.circles,Bt=0,zt=Lt;Bt<zt.length;Bt+=1){var Ht=zt[Bt];if(!Ce.circle[Ht]){Ce.circle[Ht]=!0;var lr=3*Ht;if(this._circleAndRectCollide(Tt[lr],Tt[lr+1],Tt[lr+2],C,R,F,q)&&(!Ae||Ae(this.circleKeys[Ht]))){if(be.hitTest)return he.push(!0),!0;var br=Tt[lr],zr=Tt[lr+1],Or=Tt[lr+2];he.push({key:this.circleKeys[Ht],x1:br-Or,y1:zr-Or,x2:br+Or,y2:zr+Or})}}}},gr.prototype._queryCellCircle=function(C,R,F,q,ae,he,be,Ae){var Ce=be.circle,qe=be.seenUids,et=this.boxCells[ae];if(et!==null)for(var st=this.bboxes,kt=0,Pt=et;kt<Pt.length;kt+=1){var Et=Pt[kt];if(!qe.box[Et]){qe.box[Et]=!0;var Lt=4*Et;if(this._circleAndRectCollide(Ce.x,Ce.y,Ce.radius,st[Lt+0],st[Lt+1],st[Lt+2],st[Lt+3])&&(!Ae||Ae(this.boxKeys[Et])))return he.push(!0),!0}}var Tt=this.circleCells[ae];if(Tt!==null)for(var Bt=this.circles,zt=0,Ht=Tt;zt<Ht.length;zt+=1){var lr=Ht[zt];if(!qe.circle[lr]){qe.circle[lr]=!0;var br=3*lr;if(this._circlesCollide(Bt[br],Bt[br+1],Bt[br+2],Ce.x,Ce.y,Ce.radius)&&(!Ae||Ae(this.circleKeys[lr])))return he.push(!0),!0}}},gr.prototype._forEachCell=function(C,R,F,q,ae,he,be,Ae){for(var Ce=this._convertToXCellCoord(C),qe=this._convertToYCellCoord(R),et=this._convertToXCellCoord(F),st=this._convertToYCellCoord(q),kt=Ce;kt<=et;kt++)for(var Pt=qe;Pt<=st;Pt++){var Et=this.xCellCount*Pt+kt;if(ae.call(this,C,R,F,q,Et,he,be,Ae))return}},gr.prototype._convertToXCellCoord=function(C){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(C*this.xScale)))},gr.prototype._convertToYCellCoord=function(C){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(C*this.yScale)))},gr.prototype._circlesCollide=function(C,R,F,q,ae,he){var be=q-C,Ae=ae-R,Ce=F+he;return Ce*Ce>be*be+Ae*Ae},gr.prototype._circleAndRectCollide=function(C,R,F,q,ae,he,be){var Ae=(he-q)/2,Ce=Math.abs(C-(q+Ae));if(Ce>Ae+F)return!1;var qe=(be-ae)/2,et=Math.abs(R-(ae+qe));if(et>qe+F)return!1;if(Ce<=Ae||et<=qe)return!0;var st=Ce-Ae,kt=et-qe;return st*st+kt*kt<=F*F};var cn=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function an(C,R){for(var F=0;F<C;F++){var q=R.length;R.resize(q+4),R.float32.set(cn,3*q)}}function zn(C,R,F){var q=R[0],ae=R[1];return C[0]=F[0]*q+F[4]*ae+F[12],C[1]=F[1]*q+F[5]*ae+F[13],C[3]=F[3]*q+F[7]*ae+F[15],C}var on=function(C,R,F){R===void 0&&(R=new gr(C.width+200,C.height+200,25)),F===void 0&&(F=new gr(C.width+200,C.height+200,25)),this.transform=C,this.grid=R,this.ignoredGrid=F,this.pitchfactor=Math.cos(C._pitch)*C.cameraToCenterDistance,this.screenRightBoundary=C.width+100,this.screenBottomBoundary=C.height+100,this.gridRightBoundary=C.width+200,this.gridBottomBoundary=C.height+200};function Tn(C,R,F){return R*(e.EXTENT/(C.tileSize*Math.pow(2,F-C.tileID.overscaledZ)))}on.prototype.placeCollisionBox=function(C,R,F,q,ae){var he=this.projectAndGetPerspectiveRatio(q,C.anchorPointX,C.anchorPointY),be=F*he.perspectiveRatio,Ae=C.x1*be+he.point.x,Ce=C.y1*be+he.point.y,qe=C.x2*be+he.point.x,et=C.y2*be+he.point.y;return!this.isInsideGrid(Ae,Ce,qe,et)||!R&&this.grid.hitTest(Ae,Ce,qe,et,ae)?{box:[],offscreen:!1}:{box:[Ae,Ce,qe,et],offscreen:this.isOffscreen(Ae,Ce,qe,et)}},on.prototype.placeCollisionCircles=function(C,R,F,q,ae,he,be,Ae,Ce,qe,et,st,kt){var Pt=[],Et=new e.Point(R.anchorX,R.anchorY),Lt=tr(Et,he),Tt=nr(this.transform.cameraToCenterDistance,Lt.signedDistanceFromCamera),Bt=(qe?ae/Tt:ae*Tt)/e.ONE_EM,zt=tr(Et,be).point,Ht=_r(Bt,q,R.lineOffsetX*Bt,R.lineOffsetY*Bt,!1,zt,Et,R,F,be,{}),lr=!1,br=!1,zr=!0;if(Ht){for(var Or=.5*st*Tt+kt,tn=new e.Point(-100,-100),en=new e.Point(this.screenRightBoundary,this.screenBottomBoundary),vn=new qt,hn=Ht.first,Hn=Ht.last,Kn=[],hi=hn.path.length-1;hi>=1;hi--)Kn.push(hn.path[hi]);for(var Kr=1;Kr<Hn.path.length;Kr++)Kn.push(Hn.path[Kr]);var Ln=2.5*Or;if(Ae){var Jn=Kn.map(function(So){return tr(So,Ae)});Kn=Jn.some(function(So){return So.signedDistanceFromCamera<=0})?[]:Jn.map(function(So){return So.point})}var Wn=[];if(Kn.length>0){for(var oi=Kn[0].clone(),di=Kn[0].clone(),Li=1;Li<Kn.length;Li++)oi.x=Math.min(oi.x,Kn[Li].x),oi.y=Math.min(oi.y,Kn[Li].y),di.x=Math.max(di.x,Kn[Li].x),di.y=Math.max(di.y,Kn[Li].y);Wn=oi.x>=tn.x&&di.x<=en.x&&oi.y>=tn.y&&di.y<=en.y?[Kn]:di.x<tn.x||oi.x>en.x||di.y<tn.y||oi.y>en.y?[]:e.clipLine([Kn],tn.x,tn.y,en.x,en.y)}for(var ri=0,_i=Wn;ri<_i.length;ri+=1){var yi=_i[ri];vn.reset(yi,.25*Or);var Ii=0;Ii=vn.length<=.5*Or?1:Math.ceil(vn.paddedLength/Ln)+1;for(var wi=0;wi<Ii;wi++){var Oi=wi/Math.max(Ii-1,1),Hi=vn.lerp(Oi),da=Hi.x+100,Ba=Hi.y+100;Pt.push(da,Ba,Or,0);var Na=da-Or,pa=Ba-Or,Ca=da+Or,ba=Ba+Or;if(zr=zr&&this.isOffscreen(Na,pa,Ca,ba),br=br||this.isInsideGrid(Na,pa,Ca,ba),!C&&this.grid.hitTestCircle(da,Ba,Or,et)&&(lr=!0,!Ce))return{circles:[],offscreen:!1,collisionDetected:lr}}}}return{circles:!Ce&&lr||!br?[]:Pt,offscreen:zr,collisionDetected:lr}},on.prototype.queryRenderedSymbols=function(C){if(C.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var R=[],F=1/0,q=1/0,ae=-1/0,he=-1/0,be=0,Ae=C;be<Ae.length;be+=1){var Ce=Ae[be],qe=new e.Point(Ce.x+100,Ce.y+100);F=Math.min(F,qe.x),q=Math.min(q,qe.y),ae=Math.max(ae,qe.x),he=Math.max(he,qe.y),R.push(qe)}for(var et={},st={},kt=0,Pt=this.grid.query(F,q,ae,he).concat(this.ignoredGrid.query(F,q,ae,he));kt<Pt.length;kt+=1){var Et=Pt[kt],Lt=Et.key;if(et[Lt.bucketInstanceId]===void 0&&(et[Lt.bucketInstanceId]={}),!et[Lt.bucketInstanceId][Lt.featureIndex]){var Tt=[new e.Point(Et.x1,Et.y1),new e.Point(Et.x2,Et.y1),new e.Point(Et.x2,Et.y2),new e.Point(Et.x1,Et.y2)];e.polygonIntersectsPolygon(R,Tt)&&(et[Lt.bucketInstanceId][Lt.featureIndex]=!0,st[Lt.bucketInstanceId]===void 0&&(st[Lt.bucketInstanceId]=[]),st[Lt.bucketInstanceId].push(Lt.featureIndex))}}return st},on.prototype.insertCollisionBox=function(C,R,F,q,ae){var he={bucketInstanceId:F,featureIndex:q,collisionGroupID:ae};(R?this.ignoredGrid:this.grid).insert(he,C[0],C[1],C[2],C[3])},on.prototype.insertCollisionCircles=function(C,R,F,q,ae){for(var he=R?this.ignoredGrid:this.grid,be={bucketInstanceId:F,featureIndex:q,collisionGroupID:ae},Ae=0;Ae<C.length;Ae+=4)he.insertCircle(be,C[Ae],C[Ae+1],C[Ae+2])},on.prototype.projectAndGetPerspectiveRatio=function(C,R,F){var q=[R,F,0,1];return zn(q,q,C),{point:new e.Point((q[0]/q[3]+1)/2*this.transform.width+100,(-q[1]/q[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/q[3]*.5}},on.prototype.isOffscreen=function(C,R,F,q){return F<100||C>=this.screenRightBoundary||q<100||R>this.screenBottomBoundary},on.prototype.isInsideGrid=function(C,R,F,q){return F>=0&&C<this.gridRightBoundary&&q>=0&&R<this.gridBottomBoundary},on.prototype.getViewportMatrix=function(){var C=e.identity([]);return e.translate(C,C,[-100,-100,0]),C};var Mn=function(C,R,F,q){this.opacity=C?Math.max(0,Math.min(1,C.opacity+(C.placed?R:-R))):q&&F?1:0,this.placed=F};Mn.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var ei=function(C,R,F,q,ae){this.text=new Mn(C?C.text:null,R,F,ae),this.icon=new Mn(C?C.icon:null,R,q,ae)};ei.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Hr=function(C,R,F){this.text=C,this.icon=R,this.skipFade=F},ln=function(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]},bn=function(C,R,F,q,ae){this.bucketInstanceId=C,this.featureIndex=R,this.sourceLayerIndex=F,this.bucketIndex=q,this.tileID=ae},nn=function(C){this.crossSourceCollisions=C,this.maxGroupID=0,this.collisionGroups={}};function pn(C,R,F,q,ae){var he=e.getAnchorAlignment(C),be=-(he.horizontalAlign-.5)*R,Ae=-(he.verticalAlign-.5)*F,Ce=e.evaluateVariableOffset(C,q);return new e.Point(be+Ce[0]*ae,Ae+Ce[1]*ae)}function qn(C,R,F,q,ae,he){var be=C.x1,Ae=C.x2,Ce=C.y1,qe=C.y2,et=C.anchorPointX,st=C.anchorPointY,kt=new e.Point(R,F);return q&&kt._rotate(ae?he:-he),{x1:be+kt.x,y1:Ce+kt.y,x2:Ae+kt.x,y2:qe+kt.y,anchorPointX:et,anchorPointY:st}}nn.prototype.get=function(C){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[C]){var R=++this.maxGroupID;this.collisionGroups[C]={ID:R,predicate:function(F){return F.collisionGroupID===R}}}return this.collisionGroups[C]};var sr=function(C,R,F,q){this.transform=C.clone(),this.collisionIndex=new on(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=R,this.retainedQueryData={},this.collisionGroups=new nn(F),this.collisionCircleArrays={},this.prevPlacement=q,q&&(q.prevPlacement=void 0),this.placedOrientations={}};function xr(C,R,F,q,ae){C.emplaceBack(R?1:0,F?1:0,q||0,ae||0),C.emplaceBack(R?1:0,F?1:0,q||0,ae||0),C.emplaceBack(R?1:0,F?1:0,q||0,ae||0),C.emplaceBack(R?1:0,F?1:0,q||0,ae||0)}sr.prototype.getBucketParts=function(C,R,F,q){var ae=F.getBucket(R),he=F.latestFeatureIndex;if(ae&&he&&R.id===ae.layerIds[0]){var be=F.collisionBoxArray,Ae=ae.layers[0].layout,Ce=Math.pow(2,this.transform.zoom-F.tileID.overscaledZ),qe=F.tileSize/e.EXTENT,et=this.transform.calculatePosMatrix(F.tileID.toUnwrapped()),st=Ae.get("text-pitch-alignment")==="map",kt=Ae.get("text-rotation-alignment")==="map",Pt=Tn(F,1,this.transform.zoom),Et=Cr(et,st,kt,this.transform,Pt),Lt=null;if(st){var Tt=mr(et,st,kt,this.transform,Pt);Lt=e.multiply([],this.transform.labelPlaneMatrix,Tt)}this.retainedQueryData[ae.bucketInstanceId]=new bn(ae.bucketInstanceId,he,ae.sourceLayerIndex,ae.index,F.tileID);var Bt={bucket:ae,layout:Ae,posMatrix:et,textLabelPlaneMatrix:Et,labelToScreenMatrix:Lt,scale:Ce,textPixelRatio:qe,holdingForFade:F.holdingForFade(),collisionBoxArray:be,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(ae.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(ae.sourceID)};if(q)for(var zt=0,Ht=ae.sortKeyRanges;zt<Ht.length;zt+=1){var lr=Ht[zt],br=lr.sortKey,zr=lr.symbolInstanceStart,Or=lr.symbolInstanceEnd;C.push({sortKey:br,symbolInstanceStart:zr,symbolInstanceEnd:Or,parameters:Bt})}else C.push({symbolInstanceStart:0,symbolInstanceEnd:ae.symbolInstances.length,parameters:Bt})}},sr.prototype.attemptAnchorPlacement=function(C,R,F,q,ae,he,be,Ae,Ce,qe,et,st,kt,Pt,Et){var Lt,Tt=[st.textOffset0,st.textOffset1],Bt=pn(C,F,q,Tt,ae),zt=this.collisionIndex.placeCollisionBox(qn(R,Bt.x,Bt.y,he,be,this.transform.angle),et,Ae,Ce,qe.predicate);if(!(Et&&this.collisionIndex.placeCollisionBox(qn(Et,Bt.x,Bt.y,he,be,this.transform.angle),et,Ae,Ce,qe.predicate).box.length===0)&&zt.box.length>0)return this.prevPlacement&&this.prevPlacement.variableOffsets[st.crossTileID]&&this.prevPlacement.placements[st.crossTileID]&&this.prevPlacement.placements[st.crossTileID].text&&(Lt=this.prevPlacement.variableOffsets[st.crossTileID].anchor),this.variableOffsets[st.crossTileID]={textOffset:Tt,width:F,height:q,anchor:C,textBoxScale:ae,prevAnchor:Lt},this.markUsedJustification(kt,C,st,Pt),kt.allowVerticalPlacement&&(this.markUsedOrientation(kt,Pt,st),this.placedOrientations[st.crossTileID]=Pt),{shift:Bt,placedGlyphBoxes:zt}},sr.prototype.placeLayerBucketPart=function(C,R,F){var q=this,ae=C.parameters,he=ae.bucket,be=ae.layout,Ae=ae.posMatrix,Ce=ae.textLabelPlaneMatrix,qe=ae.labelToScreenMatrix,et=ae.textPixelRatio,st=ae.holdingForFade,kt=ae.collisionBoxArray,Pt=ae.partiallyEvaluatedTextSize,Et=ae.collisionGroup,Lt=be.get("text-optional"),Tt=be.get("icon-optional"),Bt=be.get("text-allow-overlap"),zt=be.get("icon-allow-overlap"),Ht=be.get("text-rotation-alignment")==="map",lr=be.get("text-pitch-alignment")==="map",br=be.get("icon-text-fit")!=="none",zr=be.get("symbol-z-order")==="viewport-y",Or=Bt&&(zt||!he.hasIconData()||Tt),tn=zt&&(Bt||!he.hasTextData()||Lt);!he.collisionArrays&&kt&&he.deserializeCollisionBoxes(kt);var en=function(Kr,Ln){if(!R[Kr.crossTileID])if(st)q.placements[Kr.crossTileID]=new Hr(!1,!1,!1);else{var Jn,Wn=!1,oi=!1,di=!0,Li=null,ri={box:null,offscreen:null},_i={box:null,offscreen:null},yi=null,Ii=null,wi=0,Oi=0,Hi=0;Ln.textFeatureIndex?wi=Ln.textFeatureIndex:Kr.useRuntimeCollisionCircles&&(wi=Kr.featureIndex),Ln.verticalTextFeatureIndex&&(Oi=Ln.verticalTextFeatureIndex);var da=Ln.textBox;if(da){var Ba=function(Pa){var jo=e.WritingMode.horizontal;if(he.allowVerticalPlacement&&!Pa&&q.prevPlacement){var Uo=q.prevPlacement.placedOrientations[Kr.crossTileID];Uo&&(q.placedOrientations[Kr.crossTileID]=Uo,jo=Uo,q.markUsedOrientation(he,jo,Kr))}return jo},Na=function(Pa,jo){if(he.allowVerticalPlacement&&Kr.numVerticalGlyphVertices>0&&Ln.verticalTextBox)for(var Uo=0,yc=he.writingModes;Uo<yc.length&&(yc[Uo]===e.WritingMode.vertical?(ri=jo(),_i=ri):ri=Pa(),!(ri&&ri.box&&ri.box.length));Uo+=1);else ri=Pa()};if(be.get("text-variable-anchor")){var pa=be.get("text-variable-anchor");if(q.prevPlacement&&q.prevPlacement.variableOffsets[Kr.crossTileID]){var Ca=q.prevPlacement.variableOffsets[Kr.crossTileID];pa.indexOf(Ca.anchor)>0&&(pa=pa.filter(function(Pa){return Pa!==Ca.anchor})).unshift(Ca.anchor)}var ba=function(Pa,jo,Uo){for(var yc=Pa.x2-Pa.x1,Yf=Pa.y2-Pa.y1,as=Kr.textBoxScale,eu=br&&!zt?jo:null,nc={box:[],offscreen:!1},Wf=Bt?2*pa.length:pa.length,_l=0;_l<Wf;++_l){var Zf=pa[_l%pa.length],xc=_l>=pa.length,tu=q.attemptAnchorPlacement(Zf,Pa,yc,Yf,as,Ht,lr,et,Ae,Et,xc,Kr,he,Uo,eu);if(tu&&(nc=tu.placedGlyphBoxes)&&nc.box&&nc.box.length){Wn=!0,Li=tu.shift;break}}return nc};Na(function(){return ba(da,Ln.iconBox,e.WritingMode.horizontal)},function(){var Pa=Ln.verticalTextBox,jo=ri&&ri.box&&ri.box.length;return he.allowVerticalPlacement&&!jo&&Kr.numVerticalGlyphVertices>0&&Pa?ba(Pa,Ln.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null}}),ri&&(Wn=ri.box,di=ri.offscreen);var So=Ba(ri&&ri.box);if(!Wn&&q.prevPlacement){var Qa=q.prevPlacement.variableOffsets[Kr.crossTileID];Qa&&(q.variableOffsets[Kr.crossTileID]=Qa,q.markUsedJustification(he,Qa.anchor,Kr,So))}}else{var qo=function(Pa,jo){var Uo=q.collisionIndex.placeCollisionBox(Pa,Bt,et,Ae,Et.predicate);return Uo&&Uo.box&&Uo.box.length&&(q.markUsedOrientation(he,jo,Kr),q.placedOrientations[Kr.crossTileID]=jo),Uo};Na(function(){return qo(da,e.WritingMode.horizontal)},function(){var Pa=Ln.verticalTextBox;return he.allowVerticalPlacement&&Kr.numVerticalGlyphVertices>0&&Pa?qo(Pa,e.WritingMode.vertical):{box:null,offscreen:null}}),Ba(ri&&ri.box&&ri.box.length)}}if(Wn=(Jn=ri)&&Jn.box&&Jn.box.length>0,di=Jn&&Jn.offscreen,Kr.useRuntimeCollisionCircles){var Fs=he.text.placedSymbolArray.get(Kr.centerJustifiedTextSymbolIndex),ul=e.evaluateSizeForFeature(he.textSizeData,Pt,Fs),ec=be.get("text-padding"),Fl=Kr.collisionCircleDiameter;yi=q.collisionIndex.placeCollisionCircles(Bt,Fs,he.lineVertexArray,he.glyphOffsetArray,ul,Ae,Ce,qe,F,lr,Et.predicate,Fl,ec),Wn=Bt||yi.circles.length>0&&!yi.collisionDetected,di=di&&yi.offscreen}if(Ln.iconFeatureIndex&&(Hi=Ln.iconFeatureIndex),Ln.iconBox){var Bl=function(Pa){var jo=br&&Li?qn(Pa,Li.x,Li.y,Ht,lr,q.transform.angle):Pa;return q.collisionIndex.placeCollisionBox(jo,zt,et,Ae,Et.predicate)};oi=_i&&_i.box&&_i.box.length&&Ln.verticalIconBox?(Ii=Bl(Ln.verticalIconBox)).box.length>0:(Ii=Bl(Ln.iconBox)).box.length>0,di=di&&Ii.offscreen}var Eo=Lt||Kr.numHorizontalGlyphVertices===0&&Kr.numVerticalGlyphVertices===0,bl=Tt||Kr.numIconVertices===0;if(Eo||bl?bl?Eo||(oi=oi&&Wn):Wn=oi&&Wn:oi=Wn=oi&&Wn,Wn&&Jn&&Jn.box&&(_i&&_i.box&&Oi?q.collisionIndex.insertCollisionBox(Jn.box,be.get("text-ignore-placement"),he.bucketInstanceId,Oi,Et.ID):q.collisionIndex.insertCollisionBox(Jn.box,be.get("text-ignore-placement"),he.bucketInstanceId,wi,Et.ID)),oi&&Ii&&q.collisionIndex.insertCollisionBox(Ii.box,be.get("icon-ignore-placement"),he.bucketInstanceId,Hi,Et.ID),yi&&(Wn&&q.collisionIndex.insertCollisionCircles(yi.circles,be.get("text-ignore-placement"),he.bucketInstanceId,wi,Et.ID),F)){var tc=he.bucketInstanceId,gs=q.collisionCircleArrays[tc];gs===void 0&&(gs=q.collisionCircleArrays[tc]=new ln);for(var rc=0;rc<yi.circles.length;rc+=4)gs.circles.push(yi.circles[rc+0]),gs.circles.push(yi.circles[rc+1]),gs.circles.push(yi.circles[rc+2]),gs.circles.push(yi.collisionDetected?1:0)}q.placements[Kr.crossTileID]=new Hr(Wn||Or,oi||tn,di||he.justReloaded),R[Kr.crossTileID]=!0}};if(zr)for(var vn=he.getSortedSymbolIndexes(this.transform.angle),hn=vn.length-1;hn>=0;--hn){var Hn=vn[hn];en(he.symbolInstances.get(Hn),he.collisionArrays[Hn])}else for(var Kn=C.symbolInstanceStart;Kn<C.symbolInstanceEnd;Kn++)en(he.symbolInstances.get(Kn),he.collisionArrays[Kn]);if(F&&he.bucketInstanceId in this.collisionCircleArrays){var hi=this.collisionCircleArrays[he.bucketInstanceId];e.invert(hi.invProjMatrix,Ae),hi.viewportMatrix=this.collisionIndex.getViewportMatrix()}he.justReloaded=!1},sr.prototype.markUsedJustification=function(C,R,F,q){var ae,he={left:F.leftJustifiedTextSymbolIndex,center:F.centerJustifiedTextSymbolIndex,right:F.rightJustifiedTextSymbolIndex};ae=q===e.WritingMode.vertical?F.verticalPlacedTextSymbolIndex:he[e.getAnchorJustification(R)];for(var be=0,Ae=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex,F.verticalPlacedTextSymbolIndex];be<Ae.length;be+=1){var Ce=Ae[be];Ce>=0&&(C.text.placedSymbolArray.get(Ce).crossTileID=ae>=0&&Ce!==ae?0:F.crossTileID)}},sr.prototype.markUsedOrientation=function(C,R,F){for(var q=R===e.WritingMode.horizontal||R===e.WritingMode.horizontalOnly?R:0,ae=R===e.WritingMode.vertical?R:0,he=0,be=[F.leftJustifiedTextSymbolIndex,F.centerJustifiedTextSymbolIndex,F.rightJustifiedTextSymbolIndex];he<be.length;he+=1){var Ae=be[he];C.text.placedSymbolArray.get(Ae).placedOrientation=q}F.verticalPlacedTextSymbolIndex&&(C.text.placedSymbolArray.get(F.verticalPlacedTextSymbolIndex).placedOrientation=ae)},sr.prototype.commit=function(C){this.commitTime=C,this.zoomAtLastRecencyCheck=this.transform.zoom;var R=this.prevPlacement,F=!1;this.prevZoomAdjustment=R?R.zoomAdjustment(this.transform.zoom):0;var q=R?R.symbolFadeChange(C):1,ae=R?R.opacities:{},he=R?R.variableOffsets:{},be=R?R.placedOrientations:{};for(var Ae in this.placements){var Ce=this.placements[Ae],qe=ae[Ae];qe?(this.opacities[Ae]=new ei(qe,q,Ce.text,Ce.icon),F=F||Ce.text!==qe.text.placed||Ce.icon!==qe.icon.placed):(this.opacities[Ae]=new ei(null,q,Ce.text,Ce.icon,Ce.skipFade),F=F||Ce.text||Ce.icon)}for(var et in ae){var st=ae[et];if(!this.opacities[et]){var kt=new ei(st,q,!1,!1);kt.isHidden()||(this.opacities[et]=kt,F=F||st.text.placed||st.icon.placed)}}for(var Pt in he)this.variableOffsets[Pt]||!this.opacities[Pt]||this.opacities[Pt].isHidden()||(this.variableOffsets[Pt]=he[Pt]);for(var Et in be)this.placedOrientations[Et]||!this.opacities[Et]||this.opacities[Et].isHidden()||(this.placedOrientations[Et]=be[Et]);F?this.lastPlacementChangeTime=C:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=R?R.lastPlacementChangeTime:C)},sr.prototype.updateLayerOpacities=function(C,R){for(var F={},q=0,ae=R;q<ae.length;q+=1){var he=ae[q],be=he.getBucket(C);be&&he.latestFeatureIndex&&C.id===be.layerIds[0]&&this.updateBucketOpacities(be,F,he.collisionBoxArray)}},sr.prototype.updateBucketOpacities=function(C,R,F){var q=this;C.hasTextData()&&C.text.opacityVertexArray.clear(),C.hasIconData()&&C.icon.opacityVertexArray.clear(),C.hasIconCollisionBoxData()&&C.iconCollisionBox.collisionVertexArray.clear(),C.hasTextCollisionBoxData()&&C.textCollisionBox.collisionVertexArray.clear();var ae=C.layers[0].layout,he=new ei(null,0,!1,!1,!0),be=ae.get("text-allow-overlap"),Ae=ae.get("icon-allow-overlap"),Ce=ae.get("text-variable-anchor"),qe=ae.get("text-rotation-alignment")==="map",et=ae.get("text-pitch-alignment")==="map",st=ae.get("icon-text-fit")!=="none",kt=new ei(null,0,be&&(Ae||!C.hasIconData()||ae.get("icon-optional")),Ae&&(be||!C.hasTextData()||ae.get("text-optional")),!0);!C.collisionArrays&&F&&(C.hasIconCollisionBoxData()||C.hasTextCollisionBoxData())&&C.deserializeCollisionBoxes(F);for(var Pt=function(Bt,zt,Ht){for(var lr=0;lr<zt/4;lr++)Bt.opacityVertexArray.emplaceBack(Ht)},Et=function(Bt){var zt=C.symbolInstances.get(Bt),Ht=zt.numHorizontalGlyphVertices,lr=zt.numVerticalGlyphVertices,br=zt.crossTileID,zr=R[br],Or=q.opacities[br];zr?Or=he:Or||(Or=kt,q.opacities[br]=Or),R[br]=!0;var tn=Ht>0||lr>0,en=zt.numIconVertices>0,vn=q.placedOrientations[zt.crossTileID],hn=vn===e.WritingMode.vertical,Hn=vn===e.WritingMode.horizontal||vn===e.WritingMode.horizontalOnly;if(tn){var Kn=Pr(Or.text),hi=hn?Er:Kn;Pt(C.text,Ht,hi);var Kr=Hn?Er:Kn;Pt(C.text,lr,Kr);var Ln=Or.text.isHidden();[zt.rightJustifiedTextSymbolIndex,zt.centerJustifiedTextSymbolIndex,zt.leftJustifiedTextSymbolIndex].forEach(function(Hi){Hi>=0&&(C.text.placedSymbolArray.get(Hi).hidden=Ln||hn?1:0)}),zt.verticalPlacedTextSymbolIndex>=0&&(C.text.placedSymbolArray.get(zt.verticalPlacedTextSymbolIndex).hidden=Ln||Hn?1:0);var Jn=q.variableOffsets[zt.crossTileID];Jn&&q.markUsedJustification(C,Jn.anchor,zt,vn);var Wn=q.placedOrientations[zt.crossTileID];Wn&&(q.markUsedJustification(C,"left",zt,Wn),q.markUsedOrientation(C,Wn,zt))}if(en){var oi=Pr(Or.icon),di=!(st&&zt.verticalPlacedIconSymbolIndex&&hn);if(zt.placedIconSymbolIndex>=0){var Li=di?oi:Er;Pt(C.icon,zt.numIconVertices,Li),C.icon.placedSymbolArray.get(zt.placedIconSymbolIndex).hidden=Or.icon.isHidden()}if(zt.verticalPlacedIconSymbolIndex>=0){var ri=di?Er:oi;Pt(C.icon,zt.numVerticalIconVertices,ri),C.icon.placedSymbolArray.get(zt.verticalPlacedIconSymbolIndex).hidden=Or.icon.isHidden()}}if(C.hasIconCollisionBoxData()||C.hasTextCollisionBoxData()){var _i=C.collisionArrays[Bt];if(_i){var yi=new e.Point(0,0);if(_i.textBox||_i.verticalTextBox){var Ii=!0;if(Ce){var wi=q.variableOffsets[br];wi?(yi=pn(wi.anchor,wi.width,wi.height,wi.textOffset,wi.textBoxScale),qe&&yi._rotate(et?q.transform.angle:-q.transform.angle)):Ii=!1}_i.textBox&&xr(C.textCollisionBox.collisionVertexArray,Or.text.placed,!Ii||hn,yi.x,yi.y),_i.verticalTextBox&&xr(C.textCollisionBox.collisionVertexArray,Or.text.placed,!Ii||Hn,yi.x,yi.y)}var Oi=Boolean(!Hn&&_i.verticalIconBox);_i.iconBox&&xr(C.iconCollisionBox.collisionVertexArray,Or.icon.placed,Oi,st?yi.x:0,st?yi.y:0),_i.verticalIconBox&&xr(C.iconCollisionBox.collisionVertexArray,Or.icon.placed,!Oi,st?yi.x:0,st?yi.y:0)}}},Lt=0;Lt<C.symbolInstances.length;Lt++)Et(Lt);if(C.sortFeatures(this.transform.angle),this.retainedQueryData[C.bucketInstanceId]&&(this.retainedQueryData[C.bucketInstanceId].featureSortOrder=C.featureSortOrder),C.hasTextData()&&C.text.opacityVertexBuffer&&C.text.opacityVertexBuffer.updateData(C.text.opacityVertexArray),C.hasIconData()&&C.icon.opacityVertexBuffer&&C.icon.opacityVertexBuffer.updateData(C.icon.opacityVertexArray),C.hasIconCollisionBoxData()&&C.iconCollisionBox.collisionVertexBuffer&&C.iconCollisionBox.collisionVertexBuffer.updateData(C.iconCollisionBox.collisionVertexArray),C.hasTextCollisionBoxData()&&C.textCollisionBox.collisionVertexBuffer&&C.textCollisionBox.collisionVertexBuffer.updateData(C.textCollisionBox.collisionVertexArray),C.bucketInstanceId in this.collisionCircleArrays){var Tt=this.collisionCircleArrays[C.bucketInstanceId];C.placementInvProjMatrix=Tt.invProjMatrix,C.placementViewportMatrix=Tt.viewportMatrix,C.collisionCircleArray=Tt.circles,delete this.collisionCircleArrays[C.bucketInstanceId]}},sr.prototype.symbolFadeChange=function(C){return this.fadeDuration===0?1:(C-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},sr.prototype.zoomAdjustment=function(C){return Math.max(0,(this.transform.zoom-C)/1.5)},sr.prototype.hasTransitions=function(C){return this.stale||C-this.lastPlacementChangeTime<this.fadeDuration},sr.prototype.stillRecent=function(C,R){var F=this.zoomAtLastRecencyCheck===R?1-this.zoomAdjustment(R):1;return this.zoomAtLastRecencyCheck=R,this.commitTime+this.fadeDuration*F>C},sr.prototype.setStale=function(){this.stale=!0};var jr=Math.pow(2,25),Rt=Math.pow(2,24),or=Math.pow(2,17),wt=Math.pow(2,16),ir=Math.pow(2,9),ar=Math.pow(2,8),Dr=Math.pow(2,1);function Pr(C){if(C.opacity===0&&!C.placed)return 0;if(C.opacity===1&&C.placed)return 4294967295;var R=C.placed?1:0,F=Math.floor(127*C.opacity);return F*jr+R*Rt+F*or+R*wt+F*ir+R*ar+F*Dr+R}var Er=0,Ar=function(C){this._sortAcrossTiles=C.layout.get("symbol-z-order")!=="viewport-y"&&C.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Ar.prototype.continuePlacement=function(C,R,F,q,ae){for(var he=this._bucketParts;this._currentTileIndex<C.length;){var be=C[this._currentTileIndex];if(R.getBucketParts(he,q,be,this._sortAcrossTiles),this._currentTileIndex++,ae())return!0}for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,he.sort(function(Ce,qe){return Ce.sortKey-qe.sortKey}));this._currentPartIndex<he.length;){var Ae=he[this._currentPartIndex];if(R.placeLayerBucketPart(Ae,this._seenCrossTileIDs,F),this._currentPartIndex++,ae())return!0}return!1};var vr=function(C,R,F,q,ae,he,be){this.placement=new sr(C,ae,he,be),this._currentPlacementIndex=R.length-1,this._forceFullPlacement=F,this._showCollisionBoxes=q,this._done=!1};vr.prototype.isDone=function(){return this._done},vr.prototype.continuePlacement=function(C,R,F){for(var q=this,ae=e.browser.now(),he=function(){var Ce=e.browser.now()-ae;return!q._forceFullPlacement&&Ce>2};this._currentPlacementIndex>=0;){var be=R[C[this._currentPlacementIndex]],Ae=this.placement.collisionIndex.transform.zoom;if(be.type==="symbol"&&(!be.minzoom||be.minzoom<=Ae)&&(!be.maxzoom||be.maxzoom>Ae)){if(this._inProgressLayer||(this._inProgressLayer=new Ar(be)),this._inProgressLayer.continuePlacement(F[be.source],this.placement,this._showCollisionBoxes,be,he))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},vr.prototype.commit=function(C){return this.placement.commit(C),this.placement};var wr=512/e.EXTENT/2,Mr=function(C,R,F){this.tileID=C,this.indexedSymbolInstances={},this.bucketInstanceId=F;for(var q=0;q<R.length;q++){var ae=R.get(q),he=ae.key;this.indexedSymbolInstances[he]||(this.indexedSymbolInstances[he]=[]),this.indexedSymbolInstances[he].push({crossTileID:ae.crossTileID,coord:this.getScaledCoordinates(ae,C)})}};Mr.prototype.getScaledCoordinates=function(C,R){var F=R.canonical.z-this.tileID.canonical.z,q=wr/Math.pow(2,F);return{x:Math.floor((R.canonical.x*e.EXTENT+C.anchorX)*q),y:Math.floor((R.canonical.y*e.EXTENT+C.anchorY)*q)}},Mr.prototype.findMatches=function(C,R,F){for(var q=this.tileID.canonical.z<R.canonical.z?1:Math.pow(2,this.tileID.canonical.z-R.canonical.z),ae=0;ae<C.length;ae++){var he=C.get(ae);if(!he.crossTileID){var be=this.indexedSymbolInstances[he.key];if(be)for(var Ae=this.getScaledCoordinates(he,R),Ce=0,qe=be;Ce<qe.length;Ce+=1){var et=qe[Ce];if(Math.abs(et.coord.x-Ae.x)<=q&&Math.abs(et.coord.y-Ae.y)<=q&&!F[et.crossTileID]){F[et.crossTileID]=!0,he.crossTileID=et.crossTileID;break}}}}};var Lr=function(){this.maxCrossTileID=0};Lr.prototype.generate=function(){return++this.maxCrossTileID};var Zr=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Zr.prototype.handleWrapJump=function(C){var R=Math.round((C-this.lng)/360);if(R!==0)for(var F in this.indexes){var q=this.indexes[F],ae={};for(var he in q){var be=q[he];be.tileID=be.tileID.unwrapTo(be.tileID.wrap+R),ae[be.tileID.key]=be}this.indexes[F]=ae}this.lng=C},Zr.prototype.addBucket=function(C,R,F){if(this.indexes[C.overscaledZ]&&this.indexes[C.overscaledZ][C.key]){if(this.indexes[C.overscaledZ][C.key].bucketInstanceId===R.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(C.overscaledZ,this.indexes[C.overscaledZ][C.key])}for(var q=0;q<R.symbolInstances.length;q++)R.symbolInstances.get(q).crossTileID=0;this.usedCrossTileIDs[C.overscaledZ]||(this.usedCrossTileIDs[C.overscaledZ]={});var ae=this.usedCrossTileIDs[C.overscaledZ];for(var he in this.indexes){var be=this.indexes[he];if(Number(he)>C.overscaledZ)for(var Ae in be){var Ce=be[Ae];Ce.tileID.isChildOf(C)&&Ce.findMatches(R.symbolInstances,C,ae)}else{var qe=be[C.scaledTo(Number(he)).key];qe&&qe.findMatches(R.symbolInstances,C,ae)}}for(var et=0;et<R.symbolInstances.length;et++){var st=R.symbolInstances.get(et);st.crossTileID||(st.crossTileID=F.generate(),ae[st.crossTileID]=!0)}return this.indexes[C.overscaledZ]===void 0&&(this.indexes[C.overscaledZ]={}),this.indexes[C.overscaledZ][C.key]=new Mr(C,R.symbolInstances,R.bucketInstanceId),!0},Zr.prototype.removeBucketCrossTileIDs=function(C,R){for(var F in R.indexedSymbolInstances)for(var q=0,ae=R.indexedSymbolInstances[F];q<ae.length;q+=1){var he=ae[q];delete this.usedCrossTileIDs[C][he.crossTileID]}},Zr.prototype.removeStaleBuckets=function(C){var R=!1;for(var F in this.indexes){var q=this.indexes[F];for(var ae in q)C[q[ae].bucketInstanceId]||(this.removeBucketCrossTileIDs(F,q[ae]),delete q[ae],R=!0)}return R};var Yr=function(){this.layerIndexes={},this.crossTileIDs=new Lr,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Yr.prototype.addLayer=function(C,R,F){var q=this.layerIndexes[C.id];q===void 0&&(q=this.layerIndexes[C.id]=new Zr);var ae=!1,he={};q.handleWrapJump(F);for(var be=0,Ae=R;be<Ae.length;be+=1){var Ce=Ae[be],qe=Ce.getBucket(C);qe&&C.id===qe.layerIds[0]&&(qe.bucketInstanceId||(qe.bucketInstanceId=++this.maxBucketInstanceId),q.addBucket(Ce.tileID,qe,this.crossTileIDs)&&(ae=!0),he[qe.bucketInstanceId]=!0)}return q.removeStaleBuckets(he)&&(ae=!0),ae},Yr.prototype.pruneUnusedLayers=function(C){var R={};for(var F in C.forEach(function(q){R[q]=!0}),this.layerIndexes)R[F]||delete this.layerIndexes[F]};var rn=function(C,R){return e.emitValidationErrors(C,R&&R.filter(function(F){return F.identifier!=="source.canvas"}))},sn=e.pick(Mt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),yn=e.pick(Mt,["setCenter","setZoom","setBearing","setPitch"]),kn=function(){var C={},R=e.styleSpec.$version;for(var F in e.styleSpec.$root){var q=e.styleSpec.$root[F];if(q.required){var ae=null;(ae=F==="version"?R:q.type==="array"?[]:{})!=null&&(C[F]=ae)}}return C}(),wn=function(C){function R(F,q){var ae=this;q===void 0&&(q={}),C.call(this),this.map=F,this.dispatcher=new S(it(),this),this.imageManager=new u,this.imageManager.setEventedParent(this),this.glyphManager=new k(F._requestManager,q.localIdeographFontFamily),this.lineAtlas=new P(256,512),this.crossTileSymbolIndex=new Yr,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new e.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());var he=this;this._rtlTextPluginCallback=R.registerForPluginStateChange(function(be){var Ae={pluginStatus:be.pluginStatus,pluginURL:be.pluginURL};he.dispatcher.broadcast("syncRTLPluginState",Ae,function(Ce,qe){if(e.triggerPluginCompletionEvent(Ce),qe&&qe.every(function(st){return st}))for(var et in he.sourceCaches)he.sourceCaches[et].reload()})}),this.on("data",function(be){if(be.dataType==="source"&&be.sourceDataType==="metadata"){var Ae=ae.sourceCaches[be.sourceId];if(Ae){var Ce=Ae.getSource();if(Ce&&Ce.vectorLayerIds)for(var qe in ae._layers){var et=ae._layers[qe];et.source===Ce.id&&ae._validateLayer(et)}}}})}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.loadURL=function(F,q){var ae=this;q===void 0&&(q={}),this.fire(new e.Event("dataloading",{dataType:"style"}));var he=typeof q.validate=="boolean"?q.validate:!e.isMapboxURL(F);F=this.map._requestManager.normalizeStyleURL(F,q.accessToken);var be=this.map._requestManager.transformRequest(F,e.ResourceType.Style);this._request=e.getJSON(be,function(Ae,Ce){ae._request=null,Ae?ae.fire(new e.ErrorEvent(Ae)):Ce&&ae._load(Ce,he)})},R.prototype.loadJSON=function(F,q){var ae=this;q===void 0&&(q={}),this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.browser.frame(function(){ae._request=null,ae._load(F,q.validate!==!1)})},R.prototype.loadEmpty=function(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(kn,!1)},R.prototype._load=function(F,q){if(!q||!rn(this,e.validateStyle(F))){for(var ae in this._loaded=!0,this.stylesheet=F,F.sources)this.addSource(ae,F.sources[ae],{validate:!1});F.sprite?this._loadSprite(F.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(F.glyphs);var he=Ut(this.stylesheet.layers);this._order=he.map(function(qe){return qe.id}),this._layers={},this._serializedLayers={};for(var be=0,Ae=he;be<Ae.length;be+=1){var Ce=Ae[be];(Ce=e.createStyleLayer(Ce)).setEventedParent(this,{layer:{id:Ce.id}}),this._layers[Ce.id]=Ce,this._serializedLayers[Ce.id]=Ce.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new I(this.stylesheet.light),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}},R.prototype._loadSprite=function(F){var q=this;this._spriteRequest=function(ae,he,be){var Ae,Ce,qe,et=e.browser.devicePixelRatio>1?"@2x":"",st=e.getJSON(he.transformRequest(he.normalizeSpriteURL(ae,et,".json"),e.ResourceType.SpriteJSON),function(Et,Lt){st=null,qe||(qe=Et,Ae=Lt,Pt())}),kt=e.getImage(he.transformRequest(he.normalizeSpriteURL(ae,et,".png"),e.ResourceType.SpriteImage),function(Et,Lt){kt=null,qe||(qe=Et,Ce=Lt,Pt())});function Pt(){if(qe)be(qe);else if(Ae&&Ce){var Et=e.browser.getImageData(Ce),Lt={};for(var Tt in Ae){var Bt=Ae[Tt],zt=Bt.width,Ht=Bt.height,lr=Bt.x,br=Bt.y,zr=Bt.sdf,Or=Bt.pixelRatio,tn=Bt.stretchX,en=Bt.stretchY,vn=Bt.content,hn=new e.RGBAImage({width:zt,height:Ht});e.RGBAImage.copy(Et,hn,{x:lr,y:br},{x:0,y:0},{width:zt,height:Ht}),Lt[Tt]={data:hn,pixelRatio:Or,sdf:zr,stretchX:tn,stretchY:en,content:vn}}be(null,Lt)}}return{cancel:function(){st&&(st.cancel(),st=null),kt&&(kt.cancel(),kt=null)}}}(F,this.map._requestManager,function(ae,he){if(q._spriteRequest=null,ae)q.fire(new e.ErrorEvent(ae));else if(he)for(var be in he)q.imageManager.addImage(be,he[be]);q.imageManager.setLoaded(!0),q._availableImages=q.imageManager.listImages(),q.dispatcher.broadcast("setImages",q._availableImages),q.fire(new e.Event("data",{dataType:"style"}))})},R.prototype._validateLayer=function(F){var q=this.sourceCaches[F.source];if(q){var ae=F.sourceLayer;if(ae){var he=q.getSource();(he.type==="geojson"||he.vectorLayerIds&&he.vectorLayerIds.indexOf(ae)===-1)&&this.fire(new e.ErrorEvent(new Error('Source layer "'+ae+'" does not exist on source "'+he.id+'" as specified by style layer "'+F.id+'"')))}}},R.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var F in this.sourceCaches)if(!this.sourceCaches[F].loaded())return!1;return!!this.imageManager.isLoaded()},R.prototype._serializeLayers=function(F){for(var q=[],ae=0,he=F;ae<he.length;ae+=1){var be=he[ae],Ae=this._layers[be];Ae.type!=="custom"&&q.push(Ae.serialize())}return q},R.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var F in this.sourceCaches)if(this.sourceCaches[F].hasTransition())return!0;for(var q in this._layers)if(this._layers[q].hasTransition())return!0;return!1},R.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},R.prototype.update=function(F){if(this._loaded){var q=this._changed;if(this._changed){var ae=Object.keys(this._updatedLayers),he=Object.keys(this._removedLayers);for(var be in(ae.length||he.length)&&this._updateWorkerLayers(ae,he),this._updatedSources){var Ae=this._updatedSources[be];Ae==="reload"?this._reloadSource(be):Ae==="clear"&&this._clearSource(be)}for(var Ce in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[Ce].updateTransitions(F);this.light.updateTransitions(F),this._resetUpdates()}for(var qe in this.sourceCaches)this.sourceCaches[qe].used=!1;for(var et=0,st=this._order;et<st.length;et+=1){var kt=st[et],Pt=this._layers[kt];Pt.recalculate(F,this._availableImages),!Pt.isHidden(F.zoom)&&Pt.source&&(this.sourceCaches[Pt.source].used=!0)}this.light.recalculate(F),this.z=F.zoom,q&&this.fire(new e.Event("data",{dataType:"style"}))}},R.prototype._updateTilesForChangedImages=function(){var F=Object.keys(this._changedImages);if(F.length){for(var q in this.sourceCaches)this.sourceCaches[q].reloadTilesForDependencies(["icons","patterns"],F);this._changedImages={}}},R.prototype._updateWorkerLayers=function(F,q){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(F),removedIds:q})},R.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},R.prototype.setState=function(F){var q=this;if(this._checkLoaded(),rn(this,e.validateStyle(F)))return!1;(F=e.clone$1(F)).layers=Ut(F.layers);var ae=Jt(this.serialize(),F).filter(function(be){return!(be.command in yn)});if(ae.length===0)return!1;var he=ae.filter(function(be){return!(be.command in sn)});if(he.length>0)throw new Error("Unimplemented: "+he.map(function(be){return be.command}).join(", ")+".");return ae.forEach(function(be){be.command!=="setTransition"&&q[be.command].apply(q,be.args)}),this.stylesheet=F,!0},R.prototype.addImage=function(F,q){if(this.getImage(F))return this.fire(new e.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(F,q),this._availableImages=this.imageManager.listImages(),this._changedImages[F]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},R.prototype.updateImage=function(F,q){this.imageManager.updateImage(F,q)},R.prototype.getImage=function(F){return this.imageManager.getImage(F)},R.prototype.removeImage=function(F){if(!this.getImage(F))return this.fire(new e.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(F),this._availableImages=this.imageManager.listImages(),this._changedImages[F]=!0,this._changed=!0,this.fire(new e.Event("data",{dataType:"style"}))},R.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},R.prototype.addSource=function(F,q,ae){var he=this;if(ae===void 0&&(ae={}),this._checkLoaded(),this.sourceCaches[F]!==void 0)throw new Error("There is already a source with this ID");if(!q.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(q).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(q.type)>=0)||!this._validate(e.validateStyle.source,"sources."+F,q,null,ae)){this.map&&this.map._collectResourceTiming&&(q.collectResourceTiming=!0);var be=this.sourceCaches[F]=new Be(F,q,this.dispatcher);be.style=this,be.setEventedParent(this,function(){return{isSourceLoaded:he.loaded(),source:be.serialize(),sourceId:F}}),be.onAdd(this.map),this._changed=!0}},R.prototype.removeSource=function(F){if(this._checkLoaded(),this.sourceCaches[F]===void 0)throw new Error("There is no source with this ID");for(var q in this._layers)if(this._layers[q].source===F)return this.fire(new e.ErrorEvent(new Error('Source "'+F+'" cannot be removed while layer "'+q+'" is using it.')));var ae=this.sourceCaches[F];delete this.sourceCaches[F],delete this._updatedSources[F],ae.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:F})),ae.setEventedParent(null),ae.clearTiles(),ae.onRemove&&ae.onRemove(this.map),this._changed=!0},R.prototype.setGeoJSONSourceData=function(F,q){this._checkLoaded(),this.sourceCaches[F].getSource().setData(q),this._changed=!0},R.prototype.getSource=function(F){return this.sourceCaches[F]&&this.sourceCaches[F].getSource()},R.prototype.addLayer=function(F,q,ae){ae===void 0&&(ae={}),this._checkLoaded();var he=F.id;if(this.getLayer(he))this.fire(new e.ErrorEvent(new Error('Layer with id "'+he+'" already exists on this map')));else{var be;if(F.type==="custom"){if(rn(this,e.validateCustomStyleLayer(F)))return;be=e.createStyleLayer(F)}else{if(typeof F.source=="object"&&(this.addSource(he,F.source),F=e.clone$1(F),F=e.extend(F,{source:he})),this._validate(e.validateStyle.layer,"layers."+he,F,{arrayIndex:-1},ae))return;be=e.createStyleLayer(F),this._validateLayer(be),be.setEventedParent(this,{layer:{id:he}}),this._serializedLayers[be.id]=be.serialize()}var Ae=q?this._order.indexOf(q):this._order.length;if(q&&Ae===-1)this.fire(new e.ErrorEvent(new Error('Layer with id "'+q+'" does not exist on this map.')));else{if(this._order.splice(Ae,0,he),this._layerOrderChanged=!0,this._layers[he]=be,this._removedLayers[he]&&be.source&&be.type!=="custom"){var Ce=this._removedLayers[he];delete this._removedLayers[he],Ce.type!==be.type?this._updatedSources[be.source]="clear":(this._updatedSources[be.source]="reload",this.sourceCaches[be.source].pause())}this._updateLayer(be),be.onAdd&&be.onAdd(this.map)}}},R.prototype.moveLayer=function(F,q){if(this._checkLoaded(),this._changed=!0,this._layers[F]){if(F!==q){var ae=this._order.indexOf(F);this._order.splice(ae,1);var he=q?this._order.indexOf(q):this._order.length;q&&he===-1?this.fire(new e.ErrorEvent(new Error('Layer with id "'+q+'" does not exist on this map.'))):(this._order.splice(he,0,F),this._layerOrderChanged=!0)}}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be moved.")))},R.prototype.removeLayer=function(F){this._checkLoaded();var q=this._layers[F];if(q){q.setEventedParent(null);var ae=this._order.indexOf(F);this._order.splice(ae,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[F]=q,delete this._layers[F],delete this._serializedLayers[F],delete this._updatedLayers[F],delete this._updatedPaintProps[F],q.onRemove&&q.onRemove(this.map)}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be removed.")))},R.prototype.getLayer=function(F){return this._layers[F]},R.prototype.hasLayer=function(F){return F in this._layers},R.prototype.setLayerZoomRange=function(F,q,ae){this._checkLoaded();var he=this.getLayer(F);he?he.minzoom===q&&he.maxzoom===ae||(q!=null&&(he.minzoom=q),ae!=null&&(he.maxzoom=ae),this._updateLayer(he)):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot have zoom extent.")))},R.prototype.setFilter=function(F,q,ae){ae===void 0&&(ae={}),this._checkLoaded();var he=this.getLayer(F);if(he){if(!e.deepEqual(he.filter,q))return q==null?(he.filter=void 0,void this._updateLayer(he)):void(this._validate(e.validateStyle.filter,"layers."+he.id+".filter",q,null,ae)||(he.filter=e.clone$1(q),this._updateLayer(he)))}else this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be filtered.")))},R.prototype.getFilter=function(F){return e.clone$1(this.getLayer(F).filter)},R.prototype.setLayoutProperty=function(F,q,ae,he){he===void 0&&(he={}),this._checkLoaded();var be=this.getLayer(F);be?e.deepEqual(be.getLayoutProperty(q),ae)||(be.setLayoutProperty(q,ae,he),this._updateLayer(be)):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be styled.")))},R.prototype.getLayoutProperty=function(F,q){var ae=this.getLayer(F);if(ae)return ae.getLayoutProperty(q);this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style.")))},R.prototype.setPaintProperty=function(F,q,ae,he){he===void 0&&(he={}),this._checkLoaded();var be=this.getLayer(F);be?e.deepEqual(be.getPaintProperty(q),ae)||(be.setPaintProperty(q,ae,he)&&this._updateLayer(be),this._changed=!0,this._updatedPaintProps[F]=!0):this.fire(new e.ErrorEvent(new Error("The layer '"+F+"' does not exist in the map's style and cannot be styled.")))},R.prototype.getPaintProperty=function(F,q){return this.getLayer(F).getPaintProperty(q)},R.prototype.setFeatureState=function(F,q){this._checkLoaded();var ae=F.source,he=F.sourceLayer,be=this.sourceCaches[ae];if(be!==void 0){var Ae=be.getSource().type;Ae==="geojson"&&he?this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):Ae!=="vector"||he?(F.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),be.setFeatureState(he,F.id,q)):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+ae+"' does not exist in the map's style.")))},R.prototype.removeFeatureState=function(F,q){this._checkLoaded();var ae=F.source,he=this.sourceCaches[ae];if(he!==void 0){var be=he.getSource().type,Ae=be==="vector"?F.sourceLayer:void 0;be!=="vector"||Ae?q&&typeof F.id!="string"&&typeof F.id!="number"?this.fire(new e.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):he.removeFeatureState(Ae,F.id,q):this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+ae+"' does not exist in the map's style.")))},R.prototype.getFeatureState=function(F){this._checkLoaded();var q=F.source,ae=F.sourceLayer,he=this.sourceCaches[q];if(he!==void 0){if(he.getSource().type!=="vector"||ae)return F.id===void 0&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),he.getFeatureState(ae,F.id);this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error("The source '"+q+"' does not exist in the map's style.")))},R.prototype.getTransition=function(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},R.prototype.serialize=function(){return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:e.mapObject(this.sourceCaches,function(F){return F.serialize()}),layers:this._serializeLayers(this._order)},function(F){return F!==void 0})},R.prototype._updateLayer=function(F){this._updatedLayers[F.id]=!0,F.source&&!this._updatedSources[F.source]&&this.sourceCaches[F.source].getSource().type!=="raster"&&(this._updatedSources[F.source]="reload",this.sourceCaches[F.source].pause()),this._changed=!0},R.prototype._flattenAndSortRenderedFeatures=function(F){for(var q=this,ae=function(vn){return q._layers[vn].type==="fill-extrusion"},he={},be=[],Ae=this._order.length-1;Ae>=0;Ae--){var Ce=this._order[Ae];if(ae(Ce)){he[Ce]=Ae;for(var qe=0,et=F;qe<et.length;qe+=1){var st=et[qe][Ce];if(st)for(var kt=0,Pt=st;kt<Pt.length;kt+=1){var Et=Pt[kt];be.push(Et)}}}}be.sort(function(vn,hn){return hn.intersectionZ-vn.intersectionZ});for(var Lt=[],Tt=this._order.length-1;Tt>=0;Tt--){var Bt=this._order[Tt];if(ae(Bt))for(var zt=be.length-1;zt>=0;zt--){var Ht=be[zt].feature;if(he[Ht.layer.id]<Tt)break;Lt.push(Ht),be.pop()}else for(var lr=0,br=F;lr<br.length;lr+=1){var zr=br[lr][Bt];if(zr)for(var Or=0,tn=zr;Or<tn.length;Or+=1){var en=tn[Or];Lt.push(en.feature)}}}return Lt},R.prototype.queryRenderedFeatures=function(F,q,ae){q&&q.filter&&this._validate(e.validateStyle.filter,"queryRenderedFeatures.filter",q.filter,null,q);var he={};if(q&&q.layers){if(!Array.isArray(q.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var be=0,Ae=q.layers;be<Ae.length;be+=1){var Ce=Ae[be],qe=this._layers[Ce];if(!qe)return this.fire(new e.ErrorEvent(new Error("The layer '"+Ce+"' does not exist in the map's style and cannot be queried for features."))),[];he[qe.source]=!0}}var et=[];for(var st in q.availableImages=this._availableImages,this.sourceCaches)q.layers&&!he[st]||et.push(U(this.sourceCaches[st],this._layers,this._serializedLayers,F,q,ae));return this.placement&&et.push(function(kt,Pt,Et,Lt,Tt,Bt,zt){for(var Ht={},lr=Bt.queryRenderedSymbols(Lt),br=[],zr=0,Or=Object.keys(lr).map(Number);zr<Or.length;zr+=1){var tn=Or[zr];br.push(zt[tn])}br.sort(te);for(var en=function(){var hi=hn[vn],Kr=hi.featureIndex.lookupSymbolFeatures(lr[hi.bucketInstanceId],Pt,hi.bucketIndex,hi.sourceLayerIndex,Tt.filter,Tt.layers,Tt.availableImages,kt);for(var Ln in Kr){var Jn=Ht[Ln]=Ht[Ln]||[],Wn=Kr[Ln];Wn.sort(function(ri,_i){var yi=hi.featureSortOrder;if(yi){var Ii=yi.indexOf(ri.featureIndex);return yi.indexOf(_i.featureIndex)-Ii}return _i.featureIndex-ri.featureIndex});for(var oi=0,di=Wn;oi<di.length;oi+=1){var Li=di[oi];Jn.push(Li)}}},vn=0,hn=br;vn<hn.length;vn+=1)en();var Hn=function(hi){Ht[hi].forEach(function(Kr){var Ln=Kr.feature,Jn=kt[hi],Wn=Et[Jn.source].getFeatureState(Ln.layer["source-layer"],Ln.id);Ln.source=Ln.layer.source,Ln.layer["source-layer"]&&(Ln.sourceLayer=Ln.layer["source-layer"]),Ln.state=Wn})};for(var Kn in Ht)Hn(Kn);return Ht}(this._layers,this._serializedLayers,this.sourceCaches,F,q,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(et)},R.prototype.querySourceFeatures=function(F,q){q&&q.filter&&this._validate(e.validateStyle.filter,"querySourceFeatures.filter",q.filter,null,q);var ae=this.sourceCaches[F];return ae?function(he,be){for(var Ae=he.getRenderableIds().map(function(Pt){return he.getTileByID(Pt)}),Ce=[],qe={},et=0;et<Ae.length;et++){var st=Ae[et],kt=st.tileID.canonical.key;qe[kt]||(qe[kt]=!0,st.querySourceFeatures(Ce,be))}return Ce}(ae,q):[]},R.prototype.addSourceType=function(F,q,ae){return R.getSourceType(F)?ae(new Error('A source type called "'+F+'" already exists.')):(R.setSourceType(F,q),q.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:F,url:q.workerSourceURL},ae):ae(null,null))},R.prototype.getLight=function(){return this.light.getLight()},R.prototype.setLight=function(F,q){q===void 0&&(q={}),this._checkLoaded();var ae=this.light.getLight(),he=!1;for(var be in F)if(!e.deepEqual(F[be],ae[be])){he=!0;break}if(he){var Ae={now:e.browser.now(),transition:e.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(F,q),this.light.updateTransitions(Ae)}},R.prototype._validate=function(F,q,ae,he,be){return be===void 0&&(be={}),(!be||be.validate!==!1)&&rn(this,F.call(e.validateStyle,e.extend({key:q,style:this.serialize(),value:ae,styleSpec:e.styleSpec},he)))},R.prototype._remove=function(){for(var F in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[F].setEventedParent(null);for(var q in this.sourceCaches)this.sourceCaches[q].clearTiles(),this.sourceCaches[q].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},R.prototype._clearSource=function(F){this.sourceCaches[F].clearTiles()},R.prototype._reloadSource=function(F){this.sourceCaches[F].resume(),this.sourceCaches[F].reload()},R.prototype._updateSources=function(F){for(var q in this.sourceCaches)this.sourceCaches[q].update(F)},R.prototype._generateCollisionBoxes=function(){for(var F in this.sourceCaches)this._reloadSource(F)},R.prototype._updatePlacement=function(F,q,ae,he,be){be===void 0&&(be=!1);for(var Ae=!1,Ce=!1,qe={},et=0,st=this._order;et<st.length;et+=1){var kt=st[et],Pt=this._layers[kt];if(Pt.type==="symbol"){if(!qe[Pt.source]){var Et=this.sourceCaches[Pt.source];qe[Pt.source]=Et.getRenderableIds(!0).map(function(lr){return Et.getTileByID(lr)}).sort(function(lr,br){return br.tileID.overscaledZ-lr.tileID.overscaledZ||(lr.tileID.isLessThan(br.tileID)?-1:1)})}var Lt=this.crossTileSymbolIndex.addLayer(Pt,qe[Pt.source],F.center.lng);Ae=Ae||Lt}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((be=be||this._layerOrderChanged||ae===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.browser.now(),F.zoom))&&(this.pauseablePlacement=new vr(F,this._order,be,q,ae,he,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,qe),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.browser.now()),Ce=!0),Ae&&this.pauseablePlacement.placement.setStale()),Ce||Ae)for(var Tt=0,Bt=this._order;Tt<Bt.length;Tt+=1){var zt=Bt[Tt],Ht=this._layers[zt];Ht.type==="symbol"&&this.placement.updateLayerOpacities(Ht,qe[Ht.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.browser.now())},R.prototype._releaseSymbolFadeTiles=function(){for(var F in this.sourceCaches)this.sourceCaches[F].releaseSymbolFadeTiles()},R.prototype.getImages=function(F,q,ae){this.imageManager.getImages(q.icons,ae),this._updateTilesForChangedImages();var he=this.sourceCaches[q.source];he&&he.setDependencies(q.tileID.key,q.type,q.icons)},R.prototype.getGlyphs=function(F,q,ae){this.glyphManager.getGlyphs(q.stacks,ae)},R.prototype.getResource=function(F,q,ae){return e.makeRequest(q,ae)},R}(e.Evented);wn.getSourceType=function(C){return H[C]},wn.setSourceType=function(C,R){H[C]=R},wn.registerForPluginStateChange=e.registerForPluginStateChange;var Pn=e.createLayout([{name:"a_pos",type:"Int16",components:2}]),Rn=Xi(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Xn=Xi(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ai=Xi(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Mi=Xi(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Cn=Xi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),ti=Xi(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),$n=Xi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Di=Xi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),va=Xi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),ja=Xi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),vo=Xi(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Wi=Xi(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Zi=Xi(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),no=Xi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Ni=Xi(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),yo=Xi(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),wo=Xi(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Sa=Xi(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),io=Xi(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),To=Xi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define MAX_LINE_DISTANCE 32767.0
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Io=Xi(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),qa=Xi(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),ya=Xi(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),to=Xi(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),Ds=Xi(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),js=Xi(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Xi(C,R){var F=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,q={};return{fragmentSource:C=C.replace(F,function(ae,he,be,Ae,Ce){return q[Ce]=!0,he==="define"?`
#ifndef HAS_UNIFORM_u_`+Ce+`
varying `+be+" "+Ae+" "+Ce+`;
#else
uniform `+be+" "+Ae+" u_"+Ce+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+Ce+`
    `+be+" "+Ae+" "+Ce+" = u_"+Ce+`;
#endif
`}),vertexSource:R=R.replace(F,function(ae,he,be,Ae,Ce){var qe=Ae==="float"?"vec2":"vec4",et=Ce.match(/color/)?"color":qe;return q[Ce]?he==="define"?`
#ifndef HAS_UNIFORM_u_`+Ce+`
uniform lowp float u_`+Ce+`_t;
attribute `+be+" "+qe+" a_"+Ce+`;
varying `+be+" "+Ae+" "+Ce+`;
#else
uniform `+be+" "+Ae+" u_"+Ce+`;
#endif
`:et==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Ce+`
    `+Ce+" = a_"+Ce+`;
#else
    `+be+" "+Ae+" "+Ce+" = u_"+Ce+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Ce+`
    `+Ce+" = unpack_mix_"+et+"(a_"+Ce+", u_"+Ce+`_t);
#else
    `+be+" "+Ae+" "+Ce+" = u_"+Ce+`;
#endif
`:he==="define"?`
#ifndef HAS_UNIFORM_u_`+Ce+`
uniform lowp float u_`+Ce+`_t;
attribute `+be+" "+qe+" a_"+Ce+`;
#else
uniform `+be+" "+Ae+" u_"+Ce+`;
#endif
`:et==="vec4"?`
#ifndef HAS_UNIFORM_u_`+Ce+`
    `+be+" "+Ae+" "+Ce+" = a_"+Ce+`;
#else
    `+be+" "+Ae+" "+Ce+" = u_"+Ce+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+Ce+`
    `+be+" "+Ae+" "+Ce+" = unpack_mix_"+et+"(a_"+Ce+", u_"+Ce+`_t);
#else
    `+be+" "+Ae+" "+Ce+" = u_"+Ce+`;
#endif
`})}}var As=Object.freeze({__proto__:null,prelude:Rn,background:Xn,backgroundPattern:Ai,circle:Mi,clippingMask:Cn,heatmap:ti,heatmapTexture:$n,collisionBox:Di,collisionCircle:va,debug:ja,fill:vo,fillOutline:Wi,fillOutlinePattern:Zi,fillPattern:no,fillExtrusion:Ni,fillExtrusionPattern:yo,hillshadePrepare:wo,hillshade:Sa,line:io,lineGradient:To,linePattern:Io,lineSDF:qa,raster:ya,symbolIcon:to,symbolSDF:Ds,symbolTextAndIcon:js}),fs=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};fs.prototype.bind=function(C,R,F,q,ae,he,be,Ae){this.context=C;for(var Ce=this.boundPaintVertexBuffers.length!==q.length,qe=0;!Ce&&qe<q.length;qe++)this.boundPaintVertexBuffers[qe]!==q[qe]&&(Ce=!0);var et=!this.vao||this.boundProgram!==R||this.boundLayoutVertexBuffer!==F||Ce||this.boundIndexBuffer!==ae||this.boundVertexOffset!==he||this.boundDynamicVertexBuffer!==be||this.boundDynamicVertexBuffer2!==Ae;!C.extVertexArrayObject||et?this.freshBind(R,F,q,ae,he,be,Ae):(C.bindVertexArrayOES.set(this.vao),be&&be.bind(),ae&&ae.dynamicDraw&&ae.bind(),Ae&&Ae.bind())},fs.prototype.freshBind=function(C,R,F,q,ae,he,be){var Ae,Ce=C.numAttributes,qe=this.context,et=qe.gl;if(qe.extVertexArrayObject)this.vao&&this.destroy(),this.vao=qe.extVertexArrayObject.createVertexArrayOES(),qe.bindVertexArrayOES.set(this.vao),Ae=0,this.boundProgram=C,this.boundLayoutVertexBuffer=R,this.boundPaintVertexBuffers=F,this.boundIndexBuffer=q,this.boundVertexOffset=ae,this.boundDynamicVertexBuffer=he,this.boundDynamicVertexBuffer2=be;else{Ae=qe.currentNumAttributes||0;for(var st=Ce;st<Ae;st++)et.disableVertexAttribArray(st)}R.enableAttributes(et,C);for(var kt=0,Pt=F;kt<Pt.length;kt+=1)Pt[kt].enableAttributes(et,C);he&&he.enableAttributes(et,C),be&&be.enableAttributes(et,C),R.bind(),R.setVertexAttribPointers(et,C,ae);for(var Et=0,Lt=F;Et<Lt.length;Et+=1){var Tt=Lt[Et];Tt.bind(),Tt.setVertexAttribPointers(et,C,ae)}he&&(he.bind(),he.setVertexAttribPointers(et,C,ae)),q&&q.bind(),be&&(be.bind(),be.setVertexAttribPointers(et,C,ae)),qe.currentNumAttributes=Ce},fs.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Us=function(C,R,F,q,ae){var he=C.gl;this.program=he.createProgram();var be=F?F.defines():[];ae&&be.push("#define OVERDRAW_INSPECTOR;");var Ae=be.concat(Rn.fragmentSource,R.fragmentSource).join(`
`),Ce=be.concat(Rn.vertexSource,R.vertexSource).join(`
`),qe=he.createShader(he.FRAGMENT_SHADER);if(he.isContextLost())this.failedToCreate=!0;else{he.shaderSource(qe,Ae),he.compileShader(qe),he.attachShader(this.program,qe);var et=he.createShader(he.VERTEX_SHADER);if(he.isContextLost())this.failedToCreate=!0;else{he.shaderSource(et,Ce),he.compileShader(et),he.attachShader(this.program,et);for(var st=F?F.layoutAttributes:[],kt=0;kt<st.length;kt++)he.bindAttribLocation(this.program,kt,st[kt].name);he.linkProgram(this.program),he.deleteShader(et),he.deleteShader(qe),this.numAttributes=he.getProgramParameter(this.program,he.ACTIVE_ATTRIBUTES),this.attributes={};for(var Pt={},Et=0;Et<this.numAttributes;Et++){var Lt=he.getActiveAttrib(this.program,Et);Lt&&(this.attributes[Lt.name]=he.getAttribLocation(this.program,Lt.name))}for(var Tt=he.getProgramParameter(this.program,he.ACTIVE_UNIFORMS),Bt=0;Bt<Tt;Bt++){var zt=he.getActiveUniform(this.program,Bt);zt&&(Pt[zt.name]=he.getUniformLocation(this.program,zt.name))}this.fixedUniforms=q(C,Pt),this.binderUniforms=F?F.getUniforms(C,Pt):[]}}};function Vs(C,R,F){var q=1/Tn(F,1,R.transform.tileZoom),ae=Math.pow(2,F.tileID.overscaledZ),he=F.tileSize*Math.pow(2,R.transform.tileZoom)/ae,be=he*(F.tileID.canonical.x+F.tileID.wrap*ae),Ae=he*F.tileID.canonical.y;return{u_image:0,u_texsize:F.imageAtlasTexture.size,u_scale:[q,C.fromScale,C.toScale],u_fade:C.t,u_pixel_coord_upper:[be>>16,Ae>>16],u_pixel_coord_lower:[65535&be,65535&Ae]}}Us.prototype.draw=function(C,R,F,q,ae,he,be,Ae,Ce,qe,et,st,kt,Pt,Et,Lt){var Tt,Bt=C.gl;if(!this.failedToCreate){for(var zt in C.program.set(this.program),C.setDepthMode(F),C.setStencilMode(q),C.setColorMode(ae),C.setCullFace(he),this.fixedUniforms)this.fixedUniforms[zt].set(be[zt]);Pt&&Pt.setUniforms(C,this.binderUniforms,st,{zoom:kt});for(var Ht=(Tt={},Tt[Bt.LINES]=2,Tt[Bt.TRIANGLES]=3,Tt[Bt.LINE_STRIP]=1,Tt)[R],lr=0,br=et.get();lr<br.length;lr+=1){var zr=br[lr],Or=zr.vaos||(zr.vaos={});(Or[Ae]||(Or[Ae]=new fs)).bind(C,this,Ce,Pt?Pt.getPaintVertexBuffers():[],qe,zr.vertexOffset,Et,Lt),Bt.drawElements(R,zr.primitiveLength*Ht,Bt.UNSIGNED_SHORT,zr.primitiveOffset*Ht*2)}}};var zs=function(C,R,F,q){var ae=R.style.light,he=ae.properties.get("position"),be=[he.x,he.y,he.z],Ae=e.create$1();ae.properties.get("anchor")==="viewport"&&e.fromRotation(Ae,-R.transform.angle),e.transformMat3(be,be,Ae);var Ce=ae.properties.get("color");return{u_matrix:C,u_lightpos:be,u_lightintensity:ae.properties.get("intensity"),u_lightcolor:[Ce.r,Ce.g,Ce.b],u_vertical_gradient:+F,u_opacity:q}},Hs=function(C,R,F,q,ae,he,be){return e.extend(zs(C,R,F,q),Vs(he,R,be),{u_height_factor:-Math.pow(2,ae.overscaledZ)/be.tileSize/8})},Ro=function(C){return{u_matrix:C}},Fo=function(C,R,F,q){return e.extend(Ro(C),Vs(F,R,q))},Xo=function(C,R){return{u_matrix:C,u_world:R}},Ko=function(C,R,F,q,ae){return e.extend(Fo(C,R,F,q),{u_world:ae})},Jo=function(C,R,F,q){var ae,he,be=C.transform;if(q.paint.get("circle-pitch-alignment")==="map"){var Ae=Tn(F,1,be.zoom);ae=!0,he=[Ae,Ae]}else ae=!1,he=be.pixelsToGLUnits;return{u_camera_to_center_distance:be.cameraToCenterDistance,u_scale_with_map:+(q.paint.get("circle-pitch-scale")==="map"),u_matrix:C.translatePosMatrix(R.posMatrix,F,q.paint.get("circle-translate"),q.paint.get("circle-translate-anchor")),u_pitch_with_map:+ae,u_device_pixel_ratio:e.browser.devicePixelRatio,u_extrude_scale:he}},hs=function(C,R,F){var q=Tn(F,1,R.zoom),ae=Math.pow(2,R.zoom-F.tileID.overscaledZ),he=F.tileID.overscaleFactor();return{u_matrix:C,u_camera_to_center_distance:R.cameraToCenterDistance,u_pixels_to_tile_units:q,u_extrude_scale:[R.pixelsToGLUnits[0]/(q*ae),R.pixelsToGLUnits[1]/(q*ae)],u_overscale_factor:he}},ko=function(C,R,F){return{u_matrix:C,u_inv_matrix:R,u_camera_to_center_distance:F.cameraToCenterDistance,u_viewport_size:[F.width,F.height]}},Ss=function(C,R,F){return F===void 0&&(F=1),{u_matrix:C,u_color:R,u_overlay:0,u_overlay_scale:F}},xo=function(C){return{u_matrix:C}},$o=function(C,R,F,q){return{u_matrix:C,u_extrude_scale:Tn(R,1,F),u_intensity:q}};function Es(C,R){var F=Math.pow(2,R.canonical.z),q=R.canonical.y;return[new e.MercatorCoordinate(0,q/F).toLngLat().lat,new e.MercatorCoordinate(0,(q+1)/F).toLngLat().lat]}var Bo=function(C,R,F){var q=C.transform;return{u_matrix:ut(C,R,F),u_ratio:1/Tn(R,1,q.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_units_to_pixels:[1/q.pixelsToGLUnits[0],1/q.pixelsToGLUnits[1]]}},Gi=function(C,R,F){return e.extend(Bo(C,R,F),{u_image:0})},Ue=function(C,R,F,q){var ae=C.transform,he=rt(R,ae);return{u_matrix:ut(C,R,F),u_texsize:R.imageAtlasTexture.size,u_ratio:1/Tn(R,1,ae.zoom),u_device_pixel_ratio:e.browser.devicePixelRatio,u_image:0,u_scale:[he,q.fromScale,q.toScale],u_fade:q.t,u_units_to_pixels:[1/ae.pixelsToGLUnits[0],1/ae.pixelsToGLUnits[1]]}},Ke=function(C,R,F,q,ae){var he=C.transform,be=C.lineAtlas,Ae=rt(R,he),Ce=F.layout.get("line-cap")==="round",qe=be.getDash(q.from,Ce),et=be.getDash(q.to,Ce),st=qe.width*ae.fromScale,kt=et.width*ae.toScale;return e.extend(Bo(C,R,F),{u_patternscale_a:[Ae/st,-qe.height/2],u_patternscale_b:[Ae/kt,-et.height/2],u_sdfgamma:be.width/(256*Math.min(st,kt)*e.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:qe.y,u_tex_y_b:et.y,u_mix:ae.t})};function rt(C,R){return 1/Tn(C,1,R.tileZoom)}function ut(C,R,F){return C.translatePosMatrix(R.tileID.posMatrix,R,F.paint.get("line-translate"),F.paint.get("line-translate-anchor"))}var _t=function(C,R,F,q,ae){return{u_matrix:C,u_tl_parent:R,u_scale_parent:F,u_buffer_scale:1,u_fade_t:q.mix,u_opacity:q.opacity*ae.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:ae.paint.get("raster-brightness-min"),u_brightness_high:ae.paint.get("raster-brightness-max"),u_saturation_factor:(be=ae.paint.get("raster-saturation"),be>0?1-1/(1.001-be):-be),u_contrast_factor:(he=ae.paint.get("raster-contrast"),he>0?1/(1-he):1+he),u_spin_weights:yt(ae.paint.get("raster-hue-rotate"))};var he,be};function yt(C){C*=Math.PI/180;var R=Math.sin(C),F=Math.cos(C);return[(2*F+1)/3,(-Math.sqrt(3)*R-F+1)/3,(Math.sqrt(3)*R-F+1)/3]}var Ct,er=function(C,R,F,q,ae,he,be,Ae,Ce,qe){var et=ae.transform;return{u_is_size_zoom_constant:+(C==="constant"||C==="source"),u_is_size_feature_constant:+(C==="constant"||C==="camera"),u_size_t:R?R.uSizeT:0,u_size:R?R.uSize:0,u_camera_to_center_distance:et.cameraToCenterDistance,u_pitch:et.pitch/360*2*Math.PI,u_rotate_symbol:+F,u_aspect_ratio:et.width/et.height,u_fade_change:ae.options.fadeDuration?ae.symbolFadeChange:1,u_matrix:he,u_label_plane_matrix:be,u_coord_matrix:Ae,u_is_text:+Ce,u_pitch_with_map:+q,u_texsize:qe,u_texture:0}},rr=function(C,R,F,q,ae,he,be,Ae,Ce,qe,et){var st=ae.transform;return e.extend(er(C,R,F,q,ae,he,be,Ae,Ce,qe),{u_gamma_scale:q?Math.cos(st._pitch)*st.cameraToCenterDistance:1,u_device_pixel_ratio:e.browser.devicePixelRatio,u_is_halo:+et})},Xt=function(C,R,F,q,ae,he,be,Ae,Ce,qe){return e.extend(rr(C,R,F,q,ae,he,be,Ae,!0,Ce,!0),{u_texsize_icon:qe,u_texture_icon:1})},ur=function(C,R,F){return{u_matrix:C,u_opacity:R,u_color:F}},yr=function(C,R,F,q,ae,he){return e.extend(function(be,Ae,Ce,qe){var et=Ce.imageManager.getPattern(be.from.toString()),st=Ce.imageManager.getPattern(be.to.toString()),kt=Ce.imageManager.getPixelSize(),Pt=kt.width,Et=kt.height,Lt=Math.pow(2,qe.tileID.overscaledZ),Tt=qe.tileSize*Math.pow(2,Ce.transform.tileZoom)/Lt,Bt=Tt*(qe.tileID.canonical.x+qe.tileID.wrap*Lt),zt=Tt*qe.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:et.tl,u_pattern_br_a:et.br,u_pattern_tl_b:st.tl,u_pattern_br_b:st.br,u_texsize:[Pt,Et],u_mix:Ae.t,u_pattern_size_a:et.displaySize,u_pattern_size_b:st.displaySize,u_scale_a:Ae.fromScale,u_scale_b:Ae.toScale,u_tile_units_to_pixels:1/Tn(qe,1,Ce.transform.tileZoom),u_pixel_coord_upper:[Bt>>16,zt>>16],u_pixel_coord_lower:[65535&Bt,65535&zt]}}(q,he,F,ae),{u_matrix:C,u_opacity:R})},kr={fillExtrusion:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_lightpos:new e.Uniform3f(C,R.u_lightpos),u_lightintensity:new e.Uniform1f(C,R.u_lightintensity),u_lightcolor:new e.Uniform3f(C,R.u_lightcolor),u_vertical_gradient:new e.Uniform1f(C,R.u_vertical_gradient),u_opacity:new e.Uniform1f(C,R.u_opacity)}},fillExtrusionPattern:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_lightpos:new e.Uniform3f(C,R.u_lightpos),u_lightintensity:new e.Uniform1f(C,R.u_lightintensity),u_lightcolor:new e.Uniform3f(C,R.u_lightcolor),u_vertical_gradient:new e.Uniform1f(C,R.u_vertical_gradient),u_height_factor:new e.Uniform1f(C,R.u_height_factor),u_image:new e.Uniform1i(C,R.u_image),u_texsize:new e.Uniform2f(C,R.u_texsize),u_pixel_coord_upper:new e.Uniform2f(C,R.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(C,R.u_pixel_coord_lower),u_scale:new e.Uniform3f(C,R.u_scale),u_fade:new e.Uniform1f(C,R.u_fade),u_opacity:new e.Uniform1f(C,R.u_opacity)}},fill:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix)}},fillPattern:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_image:new e.Uniform1i(C,R.u_image),u_texsize:new e.Uniform2f(C,R.u_texsize),u_pixel_coord_upper:new e.Uniform2f(C,R.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(C,R.u_pixel_coord_lower),u_scale:new e.Uniform3f(C,R.u_scale),u_fade:new e.Uniform1f(C,R.u_fade)}},fillOutline:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_world:new e.Uniform2f(C,R.u_world)}},fillOutlinePattern:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_world:new e.Uniform2f(C,R.u_world),u_image:new e.Uniform1i(C,R.u_image),u_texsize:new e.Uniform2f(C,R.u_texsize),u_pixel_coord_upper:new e.Uniform2f(C,R.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(C,R.u_pixel_coord_lower),u_scale:new e.Uniform3f(C,R.u_scale),u_fade:new e.Uniform1f(C,R.u_fade)}},circle:function(C,R){return{u_camera_to_center_distance:new e.Uniform1f(C,R.u_camera_to_center_distance),u_scale_with_map:new e.Uniform1i(C,R.u_scale_with_map),u_pitch_with_map:new e.Uniform1i(C,R.u_pitch_with_map),u_extrude_scale:new e.Uniform2f(C,R.u_extrude_scale),u_device_pixel_ratio:new e.Uniform1f(C,R.u_device_pixel_ratio),u_matrix:new e.UniformMatrix4f(C,R.u_matrix)}},collisionBox:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_camera_to_center_distance:new e.Uniform1f(C,R.u_camera_to_center_distance),u_pixels_to_tile_units:new e.Uniform1f(C,R.u_pixels_to_tile_units),u_extrude_scale:new e.Uniform2f(C,R.u_extrude_scale),u_overscale_factor:new e.Uniform1f(C,R.u_overscale_factor)}},collisionCircle:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_inv_matrix:new e.UniformMatrix4f(C,R.u_inv_matrix),u_camera_to_center_distance:new e.Uniform1f(C,R.u_camera_to_center_distance),u_viewport_size:new e.Uniform2f(C,R.u_viewport_size)}},debug:function(C,R){return{u_color:new e.UniformColor(C,R.u_color),u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_overlay:new e.Uniform1i(C,R.u_overlay),u_overlay_scale:new e.Uniform1f(C,R.u_overlay_scale)}},clippingMask:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix)}},heatmap:function(C,R){return{u_extrude_scale:new e.Uniform1f(C,R.u_extrude_scale),u_intensity:new e.Uniform1f(C,R.u_intensity),u_matrix:new e.UniformMatrix4f(C,R.u_matrix)}},heatmapTexture:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_world:new e.Uniform2f(C,R.u_world),u_image:new e.Uniform1i(C,R.u_image),u_color_ramp:new e.Uniform1i(C,R.u_color_ramp),u_opacity:new e.Uniform1f(C,R.u_opacity)}},hillshade:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_image:new e.Uniform1i(C,R.u_image),u_latrange:new e.Uniform2f(C,R.u_latrange),u_light:new e.Uniform2f(C,R.u_light),u_shadow:new e.UniformColor(C,R.u_shadow),u_highlight:new e.UniformColor(C,R.u_highlight),u_accent:new e.UniformColor(C,R.u_accent)}},hillshadePrepare:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_image:new e.Uniform1i(C,R.u_image),u_dimension:new e.Uniform2f(C,R.u_dimension),u_zoom:new e.Uniform1f(C,R.u_zoom),u_maxzoom:new e.Uniform1f(C,R.u_maxzoom),u_unpack:new e.Uniform4f(C,R.u_unpack)}},line:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_ratio:new e.Uniform1f(C,R.u_ratio),u_device_pixel_ratio:new e.Uniform1f(C,R.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(C,R.u_units_to_pixels)}},lineGradient:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_ratio:new e.Uniform1f(C,R.u_ratio),u_device_pixel_ratio:new e.Uniform1f(C,R.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(C,R.u_units_to_pixels),u_image:new e.Uniform1i(C,R.u_image)}},linePattern:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_texsize:new e.Uniform2f(C,R.u_texsize),u_ratio:new e.Uniform1f(C,R.u_ratio),u_device_pixel_ratio:new e.Uniform1f(C,R.u_device_pixel_ratio),u_image:new e.Uniform1i(C,R.u_image),u_units_to_pixels:new e.Uniform2f(C,R.u_units_to_pixels),u_scale:new e.Uniform3f(C,R.u_scale),u_fade:new e.Uniform1f(C,R.u_fade)}},lineSDF:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_ratio:new e.Uniform1f(C,R.u_ratio),u_device_pixel_ratio:new e.Uniform1f(C,R.u_device_pixel_ratio),u_units_to_pixels:new e.Uniform2f(C,R.u_units_to_pixels),u_patternscale_a:new e.Uniform2f(C,R.u_patternscale_a),u_patternscale_b:new e.Uniform2f(C,R.u_patternscale_b),u_sdfgamma:new e.Uniform1f(C,R.u_sdfgamma),u_image:new e.Uniform1i(C,R.u_image),u_tex_y_a:new e.Uniform1f(C,R.u_tex_y_a),u_tex_y_b:new e.Uniform1f(C,R.u_tex_y_b),u_mix:new e.Uniform1f(C,R.u_mix)}},raster:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_tl_parent:new e.Uniform2f(C,R.u_tl_parent),u_scale_parent:new e.Uniform1f(C,R.u_scale_parent),u_buffer_scale:new e.Uniform1f(C,R.u_buffer_scale),u_fade_t:new e.Uniform1f(C,R.u_fade_t),u_opacity:new e.Uniform1f(C,R.u_opacity),u_image0:new e.Uniform1i(C,R.u_image0),u_image1:new e.Uniform1i(C,R.u_image1),u_brightness_low:new e.Uniform1f(C,R.u_brightness_low),u_brightness_high:new e.Uniform1f(C,R.u_brightness_high),u_saturation_factor:new e.Uniform1f(C,R.u_saturation_factor),u_contrast_factor:new e.Uniform1f(C,R.u_contrast_factor),u_spin_weights:new e.Uniform3f(C,R.u_spin_weights)}},symbolIcon:function(C,R){return{u_is_size_zoom_constant:new e.Uniform1i(C,R.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(C,R.u_is_size_feature_constant),u_size_t:new e.Uniform1f(C,R.u_size_t),u_size:new e.Uniform1f(C,R.u_size),u_camera_to_center_distance:new e.Uniform1f(C,R.u_camera_to_center_distance),u_pitch:new e.Uniform1f(C,R.u_pitch),u_rotate_symbol:new e.Uniform1i(C,R.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(C,R.u_aspect_ratio),u_fade_change:new e.Uniform1f(C,R.u_fade_change),u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(C,R.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(C,R.u_coord_matrix),u_is_text:new e.Uniform1i(C,R.u_is_text),u_pitch_with_map:new e.Uniform1i(C,R.u_pitch_with_map),u_texsize:new e.Uniform2f(C,R.u_texsize),u_texture:new e.Uniform1i(C,R.u_texture)}},symbolSDF:function(C,R){return{u_is_size_zoom_constant:new e.Uniform1i(C,R.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(C,R.u_is_size_feature_constant),u_size_t:new e.Uniform1f(C,R.u_size_t),u_size:new e.Uniform1f(C,R.u_size),u_camera_to_center_distance:new e.Uniform1f(C,R.u_camera_to_center_distance),u_pitch:new e.Uniform1f(C,R.u_pitch),u_rotate_symbol:new e.Uniform1i(C,R.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(C,R.u_aspect_ratio),u_fade_change:new e.Uniform1f(C,R.u_fade_change),u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(C,R.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(C,R.u_coord_matrix),u_is_text:new e.Uniform1i(C,R.u_is_text),u_pitch_with_map:new e.Uniform1i(C,R.u_pitch_with_map),u_texsize:new e.Uniform2f(C,R.u_texsize),u_texture:new e.Uniform1i(C,R.u_texture),u_gamma_scale:new e.Uniform1f(C,R.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(C,R.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(C,R.u_is_halo)}},symbolTextAndIcon:function(C,R){return{u_is_size_zoom_constant:new e.Uniform1i(C,R.u_is_size_zoom_constant),u_is_size_feature_constant:new e.Uniform1i(C,R.u_is_size_feature_constant),u_size_t:new e.Uniform1f(C,R.u_size_t),u_size:new e.Uniform1f(C,R.u_size),u_camera_to_center_distance:new e.Uniform1f(C,R.u_camera_to_center_distance),u_pitch:new e.Uniform1f(C,R.u_pitch),u_rotate_symbol:new e.Uniform1i(C,R.u_rotate_symbol),u_aspect_ratio:new e.Uniform1f(C,R.u_aspect_ratio),u_fade_change:new e.Uniform1f(C,R.u_fade_change),u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_label_plane_matrix:new e.UniformMatrix4f(C,R.u_label_plane_matrix),u_coord_matrix:new e.UniformMatrix4f(C,R.u_coord_matrix),u_is_text:new e.Uniform1i(C,R.u_is_text),u_pitch_with_map:new e.Uniform1i(C,R.u_pitch_with_map),u_texsize:new e.Uniform2f(C,R.u_texsize),u_texsize_icon:new e.Uniform2f(C,R.u_texsize_icon),u_texture:new e.Uniform1i(C,R.u_texture),u_texture_icon:new e.Uniform1i(C,R.u_texture_icon),u_gamma_scale:new e.Uniform1f(C,R.u_gamma_scale),u_device_pixel_ratio:new e.Uniform1f(C,R.u_device_pixel_ratio),u_is_halo:new e.Uniform1i(C,R.u_is_halo)}},background:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_opacity:new e.Uniform1f(C,R.u_opacity),u_color:new e.UniformColor(C,R.u_color)}},backgroundPattern:function(C,R){return{u_matrix:new e.UniformMatrix4f(C,R.u_matrix),u_opacity:new e.Uniform1f(C,R.u_opacity),u_image:new e.Uniform1i(C,R.u_image),u_pattern_tl_a:new e.Uniform2f(C,R.u_pattern_tl_a),u_pattern_br_a:new e.Uniform2f(C,R.u_pattern_br_a),u_pattern_tl_b:new e.Uniform2f(C,R.u_pattern_tl_b),u_pattern_br_b:new e.Uniform2f(C,R.u_pattern_br_b),u_texsize:new e.Uniform2f(C,R.u_texsize),u_mix:new e.Uniform1f(C,R.u_mix),u_pattern_size_a:new e.Uniform2f(C,R.u_pattern_size_a),u_pattern_size_b:new e.Uniform2f(C,R.u_pattern_size_b),u_scale_a:new e.Uniform1f(C,R.u_scale_a),u_scale_b:new e.Uniform1f(C,R.u_scale_b),u_pixel_coord_upper:new e.Uniform2f(C,R.u_pixel_coord_upper),u_pixel_coord_lower:new e.Uniform2f(C,R.u_pixel_coord_lower),u_tile_units_to_pixels:new e.Uniform1f(C,R.u_tile_units_to_pixels)}}};function Sr(C,R,F,q,ae,he,be){for(var Ae=C.context,Ce=Ae.gl,qe=C.useProgram("collisionBox"),et=[],st=0,kt=0,Pt=0;Pt<q.length;Pt++){var Et=q[Pt],Lt=R.getTile(Et),Tt=Lt.getBucket(F);if(Tt){var Bt=Et.posMatrix;ae[0]===0&&ae[1]===0||(Bt=C.translatePosMatrix(Et.posMatrix,Lt,ae,he));var zt=be?Tt.textCollisionBox:Tt.iconCollisionBox,Ht=Tt.collisionCircleArray;if(Ht.length>0){var lr=e.create(),br=Bt;e.mul(lr,Tt.placementInvProjMatrix,C.transform.glCoordMatrix),e.mul(lr,lr,Tt.placementViewportMatrix),et.push({circleArray:Ht,circleOffset:kt,transform:br,invTransform:lr}),kt=st+=Ht.length/4}zt&&qe.draw(Ae,Ce.LINES,Dt.disabled,Ne.disabled,C.colorModeForRenderPass(),pe.disabled,hs(Bt,C.transform,Lt),F.id,zt.layoutVertexBuffer,zt.indexBuffer,zt.segments,null,C.transform.zoom,null,null,zt.collisionVertexBuffer)}}if(be&&et.length){var zr=C.useProgram("collisionCircle"),Or=new e.StructArrayLayout2f1f2i16;Or.resize(4*st),Or._trim();for(var tn=0,en=0,vn=et;en<vn.length;en+=1)for(var hn=vn[en],Hn=0;Hn<hn.circleArray.length/4;Hn++){var Kn=4*Hn,hi=hn.circleArray[Kn+0],Kr=hn.circleArray[Kn+1],Ln=hn.circleArray[Kn+2],Jn=hn.circleArray[Kn+3];Or.emplace(tn++,hi,Kr,Ln,Jn,0),Or.emplace(tn++,hi,Kr,Ln,Jn,1),Or.emplace(tn++,hi,Kr,Ln,Jn,2),Or.emplace(tn++,hi,Kr,Ln,Jn,3)}(!Ct||Ct.length<2*st)&&(Ct=function(yi){var Ii=2*yi,wi=new e.StructArrayLayout3ui6;wi.resize(Ii),wi._trim();for(var Oi=0;Oi<Ii;Oi++){var Hi=6*Oi;wi.uint16[Hi+0]=4*Oi+0,wi.uint16[Hi+1]=4*Oi+1,wi.uint16[Hi+2]=4*Oi+2,wi.uint16[Hi+3]=4*Oi+2,wi.uint16[Hi+4]=4*Oi+3,wi.uint16[Hi+5]=4*Oi+0}return wi}(st));for(var Wn=Ae.createIndexBuffer(Ct,!0),oi=Ae.createVertexBuffer(Or,e.collisionCircleLayout.members,!0),di=0,Li=et;di<Li.length;di+=1){var ri=Li[di],_i=ko(ri.transform,ri.invTransform,C.transform);zr.draw(Ae,Ce.TRIANGLES,Dt.disabled,Ne.disabled,C.colorModeForRenderPass(),pe.disabled,_i,F.id,oi,Wn,e.SegmentVector.simpleSegment(0,2*ri.circleOffset,ri.circleArray.length,ri.circleArray.length/2),null,C.transform.zoom,null,null,null)}oi.destroy(),Wn.destroy()}}var Ur=e.identity(new Float32Array(16));function un(C,R,F,q,ae,he){var be=e.getAnchorAlignment(C),Ae=-(be.horizontalAlign-.5)*R,Ce=-(be.verticalAlign-.5)*F,qe=e.evaluateVariableOffset(C,q);return new e.Point((Ae/ae+qe[0])*he,(Ce/ae+qe[1])*he)}function xn(C,R,F,q,ae,he,be,Ae,Ce,qe,et){var st=C.text.placedSymbolArray,kt=C.text.dynamicLayoutVertexArray,Pt=C.icon.dynamicLayoutVertexArray,Et={};kt.clear();for(var Lt=0;Lt<st.length;Lt++){var Tt=st.get(Lt),Bt=C.allowVerticalPlacement&&!Tt.placedOrientation,zt=Tt.hidden||!Tt.crossTileID||Bt?null:q[Tt.crossTileID];if(zt){var Ht=new e.Point(Tt.anchorX,Tt.anchorY),lr=tr(Ht,F?Ae:be),br=nr(he.cameraToCenterDistance,lr.signedDistanceFromCamera),zr=ae.evaluateSizeForFeature(C.textSizeData,qe,Tt)*br/e.ONE_EM;F&&(zr*=C.tilePixelRatio/Ce);for(var Or=zt.width,tn=zt.height,en=un(zt.anchor,Or,tn,zt.textOffset,zt.textBoxScale,zr),vn=F?tr(Ht.add(en),be).point:lr.point.add(R?en.rotate(-he.angle):en),hn=C.allowVerticalPlacement&&Tt.placedOrientation===e.WritingMode.vertical?Math.PI/2:0,Hn=0;Hn<Tt.numGlyphs;Hn++)e.addDynamicAttributes(kt,vn,hn);et&&Tt.associatedIconIndex>=0&&(Et[Tt.associatedIconIndex]={shiftedAnchor:vn,angle:hn})}else an(Tt.numGlyphs,kt)}if(et){Pt.clear();for(var Kn=C.icon.placedSymbolArray,hi=0;hi<Kn.length;hi++){var Kr=Kn.get(hi);if(Kr.hidden)an(Kr.numGlyphs,Pt);else{var Ln=Et[hi];if(Ln)for(var Jn=0;Jn<Kr.numGlyphs;Jn++)e.addDynamicAttributes(Pt,Ln.shiftedAnchor,Ln.angle);else an(Kr.numGlyphs,Pt)}}C.icon.dynamicLayoutVertexBuffer.updateData(Pt)}C.text.dynamicLayoutVertexBuffer.updateData(kt)}function On(C,R,F){return F.iconsInText&&R?"symbolTextAndIcon":C?"symbolSDF":"symbolIcon"}function Fn(C,R,F,q,ae,he,be,Ae,Ce,qe,et,st){for(var kt=C.context,Pt=kt.gl,Et=C.transform,Lt=Ae==="map",Tt=Ce==="map",Bt=Lt&&F.layout.get("symbol-placement")!=="point",zt=Lt&&!Tt&&!Bt,Ht=F.layout.get("symbol-sort-key").constantOr(1)!==void 0,lr=C.depthModeForSublayer(0,Dt.ReadOnly),br=F.layout.get("text-variable-anchor"),zr=[],Or=0,tn=q;Or<tn.length;Or+=1){var en=tn[Or],vn=R.getTile(en),hn=vn.getBucket(F);if(hn){var Hn=ae?hn.text:hn.icon;if(Hn&&Hn.segments.get().length){var Kn=Hn.programConfigurations.get(F.id),hi=ae||hn.sdfIcons,Kr=ae?hn.textSizeData:hn.iconSizeData,Ln=Tt||Et.pitch!==0,Jn=C.useProgram(On(hi,ae,hn),Kn),Wn=e.evaluateSizeForZoom(Kr,Et.zoom),oi=void 0,di=[0,0],Li=void 0,ri=void 0,_i=null,yi=void 0;if(ae){if(Li=vn.glyphAtlasTexture,ri=Pt.LINEAR,oi=vn.glyphAtlasTexture.size,hn.iconsInText){di=vn.imageAtlasTexture.size,_i=vn.imageAtlasTexture;var Ii=Kr.kind==="composite"||Kr.kind==="camera";yi=Ln||C.options.rotating||C.options.zooming||Ii?Pt.LINEAR:Pt.NEAREST}}else{var wi=F.layout.get("icon-size").constantOr(0)!==1||hn.iconsNeedLinear;Li=vn.imageAtlasTexture,ri=hi||C.options.rotating||C.options.zooming||wi||Ln?Pt.LINEAR:Pt.NEAREST,oi=vn.imageAtlasTexture.size}var Oi=Tn(vn,1,C.transform.zoom),Hi=Cr(en.posMatrix,Tt,Lt,C.transform,Oi),da=mr(en.posMatrix,Tt,Lt,C.transform,Oi),Ba=br&&hn.hasTextData(),Na=F.layout.get("icon-text-fit")!=="none"&&Ba&&hn.hasIconData();Bt&&dr(hn,en.posMatrix,C,ae,Hi,da,Tt,qe);var pa=C.translatePosMatrix(en.posMatrix,vn,he,be),Ca=Bt||ae&&br||Na?Ur:Hi,ba=C.translatePosMatrix(da,vn,he,be,!0),So=hi&&F.paint.get(ae?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Qa={program:Jn,buffers:Hn,uniformValues:hi?hn.iconsInText?Xt(Kr.kind,Wn,zt,Tt,C,pa,Ca,ba,oi,di):rr(Kr.kind,Wn,zt,Tt,C,pa,Ca,ba,ae,oi,!0):er(Kr.kind,Wn,zt,Tt,C,pa,Ca,ba,ae,oi),atlasTexture:Li,atlasTextureIcon:_i,atlasInterpolation:ri,atlasInterpolationIcon:yi,isSDF:hi,hasHalo:So};if(Ht)for(var qo=0,Fs=Hn.segments.get();qo<Fs.length;qo+=1){var ul=Fs[qo];zr.push({segments:new e.SegmentVector([ul]),sortKey:ul.sortKey,state:Qa})}else zr.push({segments:Hn.segments,sortKey:0,state:Qa})}}}Ht&&zr.sort(function(tc,gs){return tc.sortKey-gs.sortKey});for(var ec=0,Fl=zr;ec<Fl.length;ec+=1){var Bl=Fl[ec],Eo=Bl.state;if(kt.activeTexture.set(Pt.TEXTURE0),Eo.atlasTexture.bind(Eo.atlasInterpolation,Pt.CLAMP_TO_EDGE),Eo.atlasTextureIcon&&(kt.activeTexture.set(Pt.TEXTURE1),Eo.atlasTextureIcon&&Eo.atlasTextureIcon.bind(Eo.atlasInterpolationIcon,Pt.CLAMP_TO_EDGE)),Eo.isSDF){var bl=Eo.uniformValues;Eo.hasHalo&&(bl.u_is_halo=1,Yn(Eo.buffers,Bl.segments,F,C,Eo.program,lr,et,st,bl)),bl.u_is_halo=0}Yn(Eo.buffers,Bl.segments,F,C,Eo.program,lr,et,st,Eo.uniformValues)}}function Yn(C,R,F,q,ae,he,be,Ae,Ce){var qe=q.context,et=qe.gl;ae.draw(qe,et.TRIANGLES,he,be,Ae,pe.disabled,Ce,F.id,C.layoutVertexBuffer,C.indexBuffer,R,F.paint,q.transform.zoom,C.programConfigurations.get(F.id),C.dynamicLayoutVertexBuffer,C.opacityVertexBuffer)}function Bn(C,R,F,q,ae,he,be){var Ae,Ce,qe,et,st,kt=C.context.gl,Pt=F.paint.get("fill-pattern"),Et=Pt&&Pt.constantOr(1),Lt=F.getCrossfadeParameters();be?(Ce=Et&&!F.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Ae=kt.LINES):(Ce=Et?"fillPattern":"fill",Ae=kt.TRIANGLES);for(var Tt=0,Bt=q;Tt<Bt.length;Tt+=1){var zt=Bt[Tt],Ht=R.getTile(zt);if(!Et||Ht.patternsLoaded()){var lr=Ht.getBucket(F);if(lr){var br=lr.programConfigurations.get(F.id),zr=C.useProgram(Ce,br);Et&&(C.context.activeTexture.set(kt.TEXTURE0),Ht.imageAtlasTexture.bind(kt.LINEAR,kt.CLAMP_TO_EDGE),br.updatePaintBuffers(Lt));var Or=Pt.constantOr(null);if(Or&&Ht.imageAtlas){var tn=Ht.imageAtlas,en=tn.patternPositions[Or.to.toString()],vn=tn.patternPositions[Or.from.toString()];en&&vn&&br.setConstantPatternPositions(en,vn)}var hn=C.translatePosMatrix(zt.posMatrix,Ht,F.paint.get("fill-translate"),F.paint.get("fill-translate-anchor"));if(be){et=lr.indexBuffer2,st=lr.segments2;var Hn=[kt.drawingBufferWidth,kt.drawingBufferHeight];qe=Ce==="fillOutlinePattern"&&Et?Ko(hn,C,Lt,Ht,Hn):Xo(hn,Hn)}else et=lr.indexBuffer,st=lr.segments,qe=Et?Fo(hn,C,Lt,Ht):Ro(hn);zr.draw(C.context,Ae,ae,C.stencilModeForClipping(zt),he,pe.disabled,qe,F.id,lr.layoutVertexBuffer,et,st,F.paint,C.transform.zoom,br)}}}}function vi(C,R,F,q,ae,he,be){for(var Ae=C.context,Ce=Ae.gl,qe=F.paint.get("fill-extrusion-pattern"),et=qe.constantOr(1),st=F.getCrossfadeParameters(),kt=F.paint.get("fill-extrusion-opacity"),Pt=0,Et=q;Pt<Et.length;Pt+=1){var Lt=Et[Pt],Tt=R.getTile(Lt),Bt=Tt.getBucket(F);if(Bt){var zt=Bt.programConfigurations.get(F.id),Ht=C.useProgram(et?"fillExtrusionPattern":"fillExtrusion",zt);et&&(C.context.activeTexture.set(Ce.TEXTURE0),Tt.imageAtlasTexture.bind(Ce.LINEAR,Ce.CLAMP_TO_EDGE),zt.updatePaintBuffers(st));var lr=qe.constantOr(null);if(lr&&Tt.imageAtlas){var br=Tt.imageAtlas,zr=br.patternPositions[lr.to.toString()],Or=br.patternPositions[lr.from.toString()];zr&&Or&&zt.setConstantPatternPositions(zr,Or)}var tn=C.translatePosMatrix(Lt.posMatrix,Tt,F.paint.get("fill-extrusion-translate"),F.paint.get("fill-extrusion-translate-anchor")),en=F.paint.get("fill-extrusion-vertical-gradient"),vn=et?Hs(tn,C,en,kt,Lt,st,Tt):zs(tn,C,en,kt);Ht.draw(Ae,Ae.gl.TRIANGLES,ae,he,be,pe.backCCW,vn,F.id,Bt.layoutVertexBuffer,Bt.indexBuffer,Bt.segments,F.paint,C.transform.zoom,zt)}}}function Si(C,R,F,q,ae,he){var be=C.context,Ae=be.gl,Ce=R.fbo;if(Ce){var qe=C.useProgram("hillshade");be.activeTexture.set(Ae.TEXTURE0),Ae.bindTexture(Ae.TEXTURE_2D,Ce.colorAttachment.get());var et=function(st,kt,Pt){var Et=Pt.paint.get("hillshade-shadow-color"),Lt=Pt.paint.get("hillshade-highlight-color"),Tt=Pt.paint.get("hillshade-accent-color"),Bt=Pt.paint.get("hillshade-illumination-direction")*(Math.PI/180);Pt.paint.get("hillshade-illumination-anchor")==="viewport"&&(Bt-=st.transform.angle);var zt=!st.options.moving;return{u_matrix:st.transform.calculatePosMatrix(kt.tileID.toUnwrapped(),zt),u_image:0,u_latrange:Es(st,kt.tileID),u_light:[Pt.paint.get("hillshade-exaggeration"),Bt],u_shadow:Et,u_highlight:Lt,u_accent:Tt}}(C,R,F);qe.draw(be,Ae.TRIANGLES,q,ae,he,pe.disabled,et,F.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments)}}function Ui(C,R,F,q,ae,he,be){var Ae=C.context,Ce=Ae.gl,qe=R.dem;if(qe&&qe.data){var et=qe.dim,st=qe.stride,kt=qe.getPixels();if(Ae.activeTexture.set(Ce.TEXTURE1),Ae.pixelStoreUnpackPremultiplyAlpha.set(!1),R.demTexture=R.demTexture||C.getTileTexture(st),R.demTexture){var Pt=R.demTexture;Pt.update(kt,{premultiply:!1}),Pt.bind(Ce.NEAREST,Ce.CLAMP_TO_EDGE)}else R.demTexture=new e.Texture(Ae,kt,Ce.RGBA,{premultiply:!1}),R.demTexture.bind(Ce.NEAREST,Ce.CLAMP_TO_EDGE);Ae.activeTexture.set(Ce.TEXTURE0);var Et=R.fbo;if(!Et){var Lt=new e.Texture(Ae,{width:et,height:et,data:null},Ce.RGBA);Lt.bind(Ce.LINEAR,Ce.CLAMP_TO_EDGE),(Et=R.fbo=Ae.createFramebuffer(et,et,!0)).colorAttachment.set(Lt.texture)}Ae.bindFramebuffer.set(Et.framebuffer),Ae.viewport.set([0,0,et,et]),C.useProgram("hillshadePrepare").draw(Ae,Ce.TRIANGLES,ae,he,be,pe.disabled,function(Tt,Bt,zt){var Ht=Bt.stride,lr=e.create();return e.ortho(lr,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(lr,lr,[0,-e.EXTENT,0]),{u_matrix:lr,u_image:1,u_dimension:[Ht,Ht],u_zoom:Tt.overscaledZ,u_maxzoom:zt,u_unpack:Bt.getUnpackVector()}}(R.tileID,qe,q),F.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments),R.needsHillshadePrepare=!1}}function ji(C,R,F,q,ae){var he=q.paint.get("raster-fade-duration");if(he>0){var be=e.browser.now(),Ae=(be-C.timeAdded)/he,Ce=R?(be-R.timeAdded)/he:-1,qe=F.getSource(),et=ae.coveringZoomLevel({tileSize:qe.tileSize,roundZoom:qe.roundZoom}),st=!R||Math.abs(R.tileID.overscaledZ-et)>Math.abs(C.tileID.overscaledZ-et),kt=st&&C.refreshedUponExpiration?1:e.clamp(st?Ae:1-Ce,0,1);return C.refreshedUponExpiration&&Ae>=1&&(C.refreshedUponExpiration=!1),R?{opacity:1,mix:1-kt}:{opacity:kt,mix:0}}return{opacity:1,mix:0}}var Vi=new e.Color(1,0,0,1),Ea=new e.Color(0,1,0,1),ka=new e.Color(0,0,1,1),ca=new e.Color(1,0,1,1),ua=new e.Color(0,1,1,1);function Ma(C){var R=C.transform.padding;Ga(C,C.transform.height-(R.top||0),3,Vi),Ga(C,R.bottom||0,3,Ea),ao(C,R.left||0,3,ka),ao(C,C.transform.width-(R.right||0),3,ca);var F=C.transform.centerPoint;(function(q,ae,he,be){oo(q,ae-1,he-10,2,20,be),oo(q,ae-10,he-1,20,2,be)})(C,F.x,C.transform.height-F.y,ua)}function Ga(C,R,F,q){oo(C,0,R+F/2,C.transform.width,F,q)}function ao(C,R,F,q){oo(C,R-F/2,0,F,C.transform.height,q)}function oo(C,R,F,q,ae,he){var be=C.context,Ae=be.gl;Ae.enable(Ae.SCISSOR_TEST),Ae.scissor(R*e.browser.devicePixelRatio,F*e.browser.devicePixelRatio,q*e.browser.devicePixelRatio,ae*e.browser.devicePixelRatio),be.clear({color:he}),Ae.disable(Ae.SCISSOR_TEST)}function so(C,R,F){var q=C.context,ae=q.gl,he=F.posMatrix,be=C.useProgram("debug"),Ae=Dt.disabled,Ce=Ne.disabled,qe=C.colorModeForRenderPass();q.activeTexture.set(ae.TEXTURE0),C.emptyTexture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE),be.draw(q,ae.LINE_STRIP,Ae,Ce,qe,pe.disabled,Ss(he,e.Color.red),"$debug",C.debugBuffer,C.tileBorderIndexBuffer,C.debugSegments);var et=R.getTileByID(F.key).latestRawTileData,st=et&&et.byteLength||0,kt=Math.floor(st/1024),Pt=R.getTile(F).tileSize,Et=512/Math.min(Pt,512)*(F.overscaledZ/C.transform.zoom)*.5,Lt=F.canonical.toString();F.overscaledZ!==F.canonical.z&&(Lt+=" => "+F.overscaledZ),function(Tt,Bt){Tt.initDebugOverlayCanvas();var zt=Tt.debugOverlayCanvas,Ht=Tt.context.gl,lr=Tt.debugOverlayCanvas.getContext("2d");lr.clearRect(0,0,zt.width,zt.height),lr.shadowColor="white",lr.shadowBlur=2,lr.lineWidth=1.5,lr.strokeStyle="white",lr.textBaseline="top",lr.font="bold 36px Open Sans, sans-serif",lr.fillText(Bt,5,5),lr.strokeText(Bt,5,5),Tt.debugOverlayTexture.update(zt),Tt.debugOverlayTexture.bind(Ht.LINEAR,Ht.CLAMP_TO_EDGE)}(C,Lt+" "+kt+"kb"),be.draw(q,ae.TRIANGLES,Ae,Ce,Ye.alphaBlended,pe.disabled,Ss(he,e.Color.transparent,Et),"$debug",C.debugBuffer,C.quadTriangleIndexBuffer,C.debugSegments)}var lo={symbol:function(C,R,F,q,ae){if(C.renderPass==="translucent"){var he=Ne.disabled,be=C.colorModeForRenderPass();F.layout.get("text-variable-anchor")&&function(Ae,Ce,qe,et,st,kt,Pt){for(var Et=Ce.transform,Lt=st==="map",Tt=kt==="map",Bt=0,zt=Ae;Bt<zt.length;Bt+=1){var Ht=zt[Bt],lr=et.getTile(Ht),br=lr.getBucket(qe);if(br&&br.text&&br.text.segments.get().length){var zr=br.textSizeData,Or=e.evaluateSizeForZoom(zr,Et.zoom),tn=Tn(lr,1,Ce.transform.zoom),en=Cr(Ht.posMatrix,Tt,Lt,Ce.transform,tn),vn=qe.layout.get("icon-text-fit")!=="none"&&br.hasIconData();if(Or){var hn=Math.pow(2,Et.zoom-lr.tileID.overscaledZ);xn(br,Lt,Tt,Pt,e.symbolSize,Et,en,Ht.posMatrix,hn,Or,vn)}}}}(q,C,F,R,F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),ae),F.paint.get("icon-opacity").constantOr(1)!==0&&Fn(C,R,F,q,!1,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),F.layout.get("icon-rotation-alignment"),F.layout.get("icon-pitch-alignment"),F.layout.get("icon-keep-upright"),he,be),F.paint.get("text-opacity").constantOr(1)!==0&&Fn(C,R,F,q,!0,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),F.layout.get("text-rotation-alignment"),F.layout.get("text-pitch-alignment"),F.layout.get("text-keep-upright"),he,be),R.map.showCollisionBoxes&&(Sr(C,R,F,q,F.paint.get("text-translate"),F.paint.get("text-translate-anchor"),!0),Sr(C,R,F,q,F.paint.get("icon-translate"),F.paint.get("icon-translate-anchor"),!1))}},circle:function(C,R,F,q){if(C.renderPass==="translucent"){var ae=F.paint.get("circle-opacity"),he=F.paint.get("circle-stroke-width"),be=F.paint.get("circle-stroke-opacity"),Ae=F.layout.get("circle-sort-key").constantOr(1)!==void 0;if(ae.constantOr(1)!==0||he.constantOr(1)!==0&&be.constantOr(1)!==0){for(var Ce=C.context,qe=Ce.gl,et=C.depthModeForSublayer(0,Dt.ReadOnly),st=Ne.disabled,kt=C.colorModeForRenderPass(),Pt=[],Et=0;Et<q.length;Et++){var Lt=q[Et],Tt=R.getTile(Lt),Bt=Tt.getBucket(F);if(Bt){var zt=Bt.programConfigurations.get(F.id),Ht={programConfiguration:zt,program:C.useProgram("circle",zt),layoutVertexBuffer:Bt.layoutVertexBuffer,indexBuffer:Bt.indexBuffer,uniformValues:Jo(C,Lt,Tt,F)};if(Ae)for(var lr=0,br=Bt.segments.get();lr<br.length;lr+=1){var zr=br[lr];Pt.push({segments:new e.SegmentVector([zr]),sortKey:zr.sortKey,state:Ht})}else Pt.push({segments:Bt.segments,sortKey:0,state:Ht})}}Ae&&Pt.sort(function(Jn,Wn){return Jn.sortKey-Wn.sortKey});for(var Or=0,tn=Pt;Or<tn.length;Or+=1){var en=tn[Or],vn=en.state,hn=vn.programConfiguration,Hn=vn.program,Kn=vn.layoutVertexBuffer,hi=vn.indexBuffer,Kr=vn.uniformValues,Ln=en.segments;Hn.draw(Ce,qe.TRIANGLES,et,st,kt,pe.disabled,Kr,F.id,Kn,hi,Ln,F.paint,C.transform.zoom,hn)}}}},heatmap:function(C,R,F,q){if(F.paint.get("heatmap-opacity")!==0)if(C.renderPass==="offscreen"){var ae=C.context,he=ae.gl,be=Ne.disabled,Ae=new Ye([he.ONE,he.ONE],e.Color.transparent,[!0,!0,!0,!0]);(function(Lt,Tt,Bt){var zt=Lt.gl;Lt.activeTexture.set(zt.TEXTURE1),Lt.viewport.set([0,0,Tt.width/4,Tt.height/4]);var Ht=Bt.heatmapFbo;if(Ht)zt.bindTexture(zt.TEXTURE_2D,Ht.colorAttachment.get()),Lt.bindFramebuffer.set(Ht.framebuffer);else{var lr=zt.createTexture();zt.bindTexture(zt.TEXTURE_2D,lr),zt.texParameteri(zt.TEXTURE_2D,zt.TEXTURE_WRAP_S,zt.CLAMP_TO_EDGE),zt.texParameteri(zt.TEXTURE_2D,zt.TEXTURE_WRAP_T,zt.CLAMP_TO_EDGE),zt.texParameteri(zt.TEXTURE_2D,zt.TEXTURE_MIN_FILTER,zt.LINEAR),zt.texParameteri(zt.TEXTURE_2D,zt.TEXTURE_MAG_FILTER,zt.LINEAR),Ht=Bt.heatmapFbo=Lt.createFramebuffer(Tt.width/4,Tt.height/4,!1),function(br,zr,Or,tn){var en=br.gl,vn=br.extRenderToTextureHalfFloat?br.extTextureHalfFloat.HALF_FLOAT_OES:en.UNSIGNED_BYTE;en.texImage2D(en.TEXTURE_2D,0,en.RGBA,zr.width/4,zr.height/4,0,en.RGBA,vn,null),tn.colorAttachment.set(Or)}(Lt,Tt,lr,Ht)}})(ae,C,F),ae.clear({color:e.Color.transparent});for(var Ce=0;Ce<q.length;Ce++){var qe=q[Ce];if(!R.hasRenderableParent(qe)){var et=R.getTile(qe),st=et.getBucket(F);if(st){var kt=st.programConfigurations.get(F.id),Pt=C.useProgram("heatmap",kt),Et=C.transform.zoom;Pt.draw(ae,he.TRIANGLES,Dt.disabled,be,Ae,pe.disabled,$o(qe.posMatrix,et,Et,F.paint.get("heatmap-intensity")),F.id,st.layoutVertexBuffer,st.indexBuffer,st.segments,F.paint,C.transform.zoom,kt)}}}ae.viewport.set([0,0,C.width,C.height])}else C.renderPass==="translucent"&&(C.context.setColorMode(C.colorModeForRenderPass()),function(Lt,Tt){var Bt=Lt.context,zt=Bt.gl,Ht=Tt.heatmapFbo;if(!!Ht){Bt.activeTexture.set(zt.TEXTURE0),zt.bindTexture(zt.TEXTURE_2D,Ht.colorAttachment.get()),Bt.activeTexture.set(zt.TEXTURE1);var lr=Tt.colorRampTexture;lr||(lr=Tt.colorRampTexture=new e.Texture(Bt,Tt.colorRamp,zt.RGBA)),lr.bind(zt.LINEAR,zt.CLAMP_TO_EDGE),Lt.useProgram("heatmapTexture").draw(Bt,zt.TRIANGLES,Dt.disabled,Ne.disabled,Lt.colorModeForRenderPass(),pe.disabled,function(br,zr,Or,tn){var en=e.create();e.ortho(en,0,br.width,br.height,0,0,1);var vn=br.context.gl;return{u_matrix:en,u_world:[vn.drawingBufferWidth,vn.drawingBufferHeight],u_image:Or,u_color_ramp:tn,u_opacity:zr.paint.get("heatmap-opacity")}}(Lt,Tt,0,1),Tt.id,Lt.viewportBuffer,Lt.quadTriangleIndexBuffer,Lt.viewportSegments,Tt.paint,Lt.transform.zoom)}}(C,F))},line:function(C,R,F,q){if(C.renderPass==="translucent"){var ae=F.paint.get("line-opacity"),he=F.paint.get("line-width");if(ae.constantOr(1)!==0&&he.constantOr(1)!==0){var be=C.depthModeForSublayer(0,Dt.ReadOnly),Ae=C.colorModeForRenderPass(),Ce=F.paint.get("line-dasharray"),qe=F.paint.get("line-pattern"),et=qe.constantOr(1),st=F.paint.get("line-gradient"),kt=F.getCrossfadeParameters(),Pt=et?"linePattern":Ce?"lineSDF":st?"lineGradient":"line",Et=C.context,Lt=Et.gl,Tt=!0;if(st){Et.activeTexture.set(Lt.TEXTURE0);var Bt=F.gradientTexture;if(!F.gradient)return;Bt||(Bt=F.gradientTexture=new e.Texture(Et,F.gradient,Lt.RGBA)),Bt.bind(Lt.LINEAR,Lt.CLAMP_TO_EDGE)}for(var zt=0,Ht=q;zt<Ht.length;zt+=1){var lr=Ht[zt],br=R.getTile(lr);if(!et||br.patternsLoaded()){var zr=br.getBucket(F);if(zr){var Or=zr.programConfigurations.get(F.id),tn=C.context.program.get(),en=C.useProgram(Pt,Or),vn=Tt||en.program!==tn,hn=qe.constantOr(null);if(hn&&br.imageAtlas){var Hn=br.imageAtlas,Kn=Hn.patternPositions[hn.to.toString()],hi=Hn.patternPositions[hn.from.toString()];Kn&&hi&&Or.setConstantPatternPositions(Kn,hi)}var Kr=et?Ue(C,br,F,kt):Ce?Ke(C,br,F,Ce,kt):st?Gi(C,br,F):Bo(C,br,F);et?(Et.activeTexture.set(Lt.TEXTURE0),br.imageAtlasTexture.bind(Lt.LINEAR,Lt.CLAMP_TO_EDGE),Or.updatePaintBuffers(kt)):Ce&&(vn||C.lineAtlas.dirty)&&(Et.activeTexture.set(Lt.TEXTURE0),C.lineAtlas.bind(Et)),en.draw(Et,Lt.TRIANGLES,be,C.stencilModeForClipping(lr),Ae,pe.disabled,Kr,F.id,zr.layoutVertexBuffer,zr.indexBuffer,zr.segments,F.paint,C.transform.zoom,Or),Tt=!1}}}}}},fill:function(C,R,F,q){var ae=F.paint.get("fill-color"),he=F.paint.get("fill-opacity");if(he.constantOr(1)!==0){var be=C.colorModeForRenderPass(),Ae=F.paint.get("fill-pattern"),Ce=C.opaquePassEnabledForLayer()&&!Ae.constantOr(1)&&ae.constantOr(e.Color.transparent).a===1&&he.constantOr(0)===1?"opaque":"translucent";if(C.renderPass===Ce){var qe=C.depthModeForSublayer(1,C.renderPass==="opaque"?Dt.ReadWrite:Dt.ReadOnly);Bn(C,R,F,q,qe,be,!1)}if(C.renderPass==="translucent"&&F.paint.get("fill-antialias")){var et=C.depthModeForSublayer(F.getPaintProperty("fill-outline-color")?2:0,Dt.ReadOnly);Bn(C,R,F,q,et,be,!0)}}},"fill-extrusion":function(C,R,F,q){var ae=F.paint.get("fill-extrusion-opacity");if(ae!==0&&C.renderPass==="translucent"){var he=new Dt(C.context.gl.LEQUAL,Dt.ReadWrite,C.depthRangeFor3D);if(ae!==1||F.paint.get("fill-extrusion-pattern").constantOr(1))vi(C,R,F,q,he,Ne.disabled,Ye.disabled),vi(C,R,F,q,he,C.stencilModeFor3D(),C.colorModeForRenderPass());else{var be=C.colorModeForRenderPass();vi(C,R,F,q,he,Ne.disabled,be)}}},hillshade:function(C,R,F,q){if(C.renderPass==="offscreen"||C.renderPass==="translucent"){for(var ae=C.context,he=R.getSource().maxzoom,be=C.depthModeForSublayer(0,Dt.ReadOnly),Ae=C.colorModeForRenderPass(),Ce=C.renderPass==="translucent"?C.stencilConfigForOverlap(q):[{},q],qe=Ce[0],et=0,st=Ce[1];et<st.length;et+=1){var kt=st[et],Pt=R.getTile(kt);Pt.needsHillshadePrepare&&C.renderPass==="offscreen"?Ui(C,Pt,F,he,be,Ne.disabled,Ae):C.renderPass==="translucent"&&Si(C,Pt,F,be,qe[kt.overscaledZ],Ae)}ae.viewport.set([0,0,C.width,C.height])}},raster:function(C,R,F,q){if(C.renderPass==="translucent"&&F.paint.get("raster-opacity")!==0&&q.length)for(var ae=C.context,he=ae.gl,be=R.getSource(),Ae=C.useProgram("raster"),Ce=C.colorModeForRenderPass(),qe=be instanceof X?[{},q]:C.stencilConfigForOverlap(q),et=qe[0],st=qe[1],kt=st[st.length-1].overscaledZ,Pt=!C.options.moving,Et=0,Lt=st;Et<Lt.length;Et+=1){var Tt=Lt[Et],Bt=C.depthModeForSublayer(Tt.overscaledZ-kt,F.paint.get("raster-opacity")===1?Dt.ReadWrite:Dt.ReadOnly,he.LESS),zt=R.getTile(Tt),Ht=C.transform.calculatePosMatrix(Tt.toUnwrapped(),Pt);zt.registerFadeDuration(F.paint.get("raster-fade-duration"));var lr=R.findLoadedParent(Tt,0),br=ji(zt,lr,R,F,C.transform),zr=void 0,Or=void 0,tn=F.paint.get("raster-resampling")==="nearest"?he.NEAREST:he.LINEAR;ae.activeTexture.set(he.TEXTURE0),zt.texture.bind(tn,he.CLAMP_TO_EDGE,he.LINEAR_MIPMAP_NEAREST),ae.activeTexture.set(he.TEXTURE1),lr?(lr.texture.bind(tn,he.CLAMP_TO_EDGE,he.LINEAR_MIPMAP_NEAREST),zr=Math.pow(2,lr.tileID.overscaledZ-zt.tileID.overscaledZ),Or=[zt.tileID.canonical.x*zr%1,zt.tileID.canonical.y*zr%1]):zt.texture.bind(tn,he.CLAMP_TO_EDGE,he.LINEAR_MIPMAP_NEAREST);var en=_t(Ht,Or||[0,0],zr||1,br,F);be instanceof X?Ae.draw(ae,he.TRIANGLES,Bt,Ne.disabled,Ce,pe.disabled,en,F.id,be.boundsBuffer,C.quadTriangleIndexBuffer,be.boundsSegments):Ae.draw(ae,he.TRIANGLES,Bt,et[Tt.overscaledZ],Ce,pe.disabled,en,F.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments)}},background:function(C,R,F){var q=F.paint.get("background-color"),ae=F.paint.get("background-opacity");if(ae!==0){var he=C.context,be=he.gl,Ae=C.transform,Ce=Ae.tileSize,qe=F.paint.get("background-pattern");if(!C.isPatternMissing(qe)){var et=!qe&&q.a===1&&ae===1&&C.opaquePassEnabledForLayer()?"opaque":"translucent";if(C.renderPass===et){var st=Ne.disabled,kt=C.depthModeForSublayer(0,et==="opaque"?Dt.ReadWrite:Dt.ReadOnly),Pt=C.colorModeForRenderPass(),Et=C.useProgram(qe?"backgroundPattern":"background"),Lt=Ae.coveringTiles({tileSize:Ce});qe&&(he.activeTexture.set(be.TEXTURE0),C.imageManager.bind(C.context));for(var Tt=F.getCrossfadeParameters(),Bt=0,zt=Lt;Bt<zt.length;Bt+=1){var Ht=zt[Bt],lr=C.transform.calculatePosMatrix(Ht.toUnwrapped()),br=qe?yr(lr,ae,C,qe,{tileID:Ht,tileSize:Ce},Tt):ur(lr,ae,q);Et.draw(he,be.TRIANGLES,kt,st,Pt,pe.disabled,br,F.id,C.tileExtentBuffer,C.quadTriangleIndexBuffer,C.tileExtentSegments)}}}}},debug:function(C,R,F){for(var q=0;q<F.length;q++)so(C,R,F[q])},custom:function(C,R,F){var q=C.context,ae=F.implementation;if(C.renderPass==="offscreen"){var he=ae.prerender;he&&(C.setCustomLayerDefaults(),q.setColorMode(C.colorModeForRenderPass()),he.call(ae,q.gl,C.transform.customLayerMatrix()),q.setDirty(),C.setBaseState())}else if(C.renderPass==="translucent"){C.setCustomLayerDefaults(),q.setColorMode(C.colorModeForRenderPass()),q.setStencilMode(Ne.disabled);var be=ae.renderingMode==="3d"?new Dt(C.context.gl.LEQUAL,Dt.ReadWrite,C.depthRangeFor3D):C.depthModeForSublayer(0,Dt.ReadOnly);q.setDepthMode(be),ae.render(q.gl,C.transform.customLayerMatrix()),q.setDirty(),C.setBaseState(),q.bindFramebuffer.set(null)}}},zi=function(C,R){this.context=new _e(C),this.transform=R,this._tileTextures={},this.setup(),this.numSublayers=Be.maxUnderzooming+Be.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Yr,this.gpuTimers={}};zi.prototype.resize=function(C,R){if(this.width=C*e.browser.devicePixelRatio,this.height=R*e.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var F=0,q=this.style._order;F<q.length;F+=1){var ae=q[F];this.style._layers[ae].resize()}},zi.prototype.setup=function(){var C=this.context,R=new e.StructArrayLayout2i4;R.emplaceBack(0,0),R.emplaceBack(e.EXTENT,0),R.emplaceBack(0,e.EXTENT),R.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=C.createVertexBuffer(R,Pn.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);var F=new e.StructArrayLayout2i4;F.emplaceBack(0,0),F.emplaceBack(e.EXTENT,0),F.emplaceBack(0,e.EXTENT),F.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=C.createVertexBuffer(F,Pn.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);var q=new e.StructArrayLayout4i8;q.emplaceBack(0,0,0,0),q.emplaceBack(e.EXTENT,0,e.EXTENT,0),q.emplaceBack(0,e.EXTENT,0,e.EXTENT),q.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.rasterBoundsBuffer=C.createVertexBuffer(q,Q.members),this.rasterBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);var ae=new e.StructArrayLayout2i4;ae.emplaceBack(0,0),ae.emplaceBack(1,0),ae.emplaceBack(0,1),ae.emplaceBack(1,1),this.viewportBuffer=C.createVertexBuffer(ae,Pn.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);var he=new e.StructArrayLayout1ui2;he.emplaceBack(0),he.emplaceBack(1),he.emplaceBack(3),he.emplaceBack(2),he.emplaceBack(0),this.tileBorderIndexBuffer=C.createIndexBuffer(he);var be=new e.StructArrayLayout3ui6;be.emplaceBack(0,1,2),be.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=C.createIndexBuffer(be),this.emptyTexture=new e.Texture(C,{width:1,height:1,data:new Uint8Array([0,0,0,0])},C.gl.RGBA);var Ae=this.context.gl;this.stencilClearMode=new Ne({func:Ae.ALWAYS,mask:0},0,255,Ae.ZERO,Ae.ZERO,Ae.ZERO)},zi.prototype.clearStencil=function(){var C=this.context,R=C.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var F=e.create();e.ortho(F,0,this.width,this.height,0,0,1),e.scale(F,F,[R.drawingBufferWidth,R.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(C,R.TRIANGLES,Dt.disabled,this.stencilClearMode,Ye.disabled,pe.disabled,xo(F),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},zi.prototype._renderTileClippingMasks=function(C,R){if(this.currentStencilSource!==C.source&&C.isTileClipped()&&R&&R.length){this.currentStencilSource=C.source;var F=this.context,q=F.gl;this.nextStencilID+R.length>256&&this.clearStencil(),F.setColorMode(Ye.disabled),F.setDepthMode(Dt.disabled);var ae=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var he=0,be=R;he<be.length;he+=1){var Ae=be[he],Ce=this._tileClippingMaskIDs[Ae.key]=this.nextStencilID++;ae.draw(F,q.TRIANGLES,Dt.disabled,new Ne({func:q.ALWAYS,mask:0},Ce,255,q.KEEP,q.KEEP,q.REPLACE),Ye.disabled,pe.disabled,xo(Ae.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},zi.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var C=this.nextStencilID++,R=this.context.gl;return new Ne({func:R.NOTEQUAL,mask:255},C,255,R.KEEP,R.KEEP,R.REPLACE)},zi.prototype.stencilModeForClipping=function(C){var R=this.context.gl;return new Ne({func:R.EQUAL,mask:255},this._tileClippingMaskIDs[C.key],0,R.KEEP,R.KEEP,R.REPLACE)},zi.prototype.stencilConfigForOverlap=function(C){var R,F=this.context.gl,q=C.sort(function(Ce,qe){return qe.overscaledZ-Ce.overscaledZ}),ae=q[q.length-1].overscaledZ,he=q[0].overscaledZ-ae+1;if(he>1){this.currentStencilSource=void 0,this.nextStencilID+he>256&&this.clearStencil();for(var be={},Ae=0;Ae<he;Ae++)be[Ae+ae]=new Ne({func:F.GEQUAL,mask:255},Ae+this.nextStencilID,255,F.KEEP,F.KEEP,F.REPLACE);return this.nextStencilID+=he,[be,q]}return[(R={},R[ae]=Ne.disabled,R),q]},zi.prototype.colorModeForRenderPass=function(){var C=this.context.gl;return this._showOverdrawInspector?new Ye([C.CONSTANT_COLOR,C.ONE],new e.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ye.unblended:Ye.alphaBlended},zi.prototype.depthModeForSublayer=function(C,R,F){if(!this.opaquePassEnabledForLayer())return Dt.disabled;var q=1-((1+this.currentLayer)*this.numSublayers+C)*this.depthEpsilon;return new Dt(F||this.context.gl.LEQUAL,R,[q,q])},zi.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},zi.prototype.render=function(C,R){var F=this;this.style=C,this.options=R,this.lineAtlas=C.lineAtlas,this.imageManager=C.imageManager,this.glyphManager=C.glyphManager,this.symbolFadeChange=C.placement.symbolFadeChange(e.browser.now()),this.imageManager.beginFrame();var q=this.style._order,ae=this.style.sourceCaches;for(var he in ae){var be=ae[he];be.used&&be.prepare(this.context)}var Ae,Ce,qe={},et={},st={};for(var kt in ae){var Pt=ae[kt];qe[kt]=Pt.getVisibleCoordinates(),et[kt]=qe[kt].slice().reverse(),st[kt]=Pt.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Et=0;Et<q.length;Et++){var Lt=q[Et];if(this.style._layers[Lt].is3D()){this.opaquePassCutoff=Et;break}}this.renderPass="offscreen";for(var Tt=0,Bt=q;Tt<Bt.length;Tt+=1){var zt=Bt[Tt],Ht=this.style._layers[zt];if(Ht.hasOffscreenPass()&&!Ht.isHidden(this.transform.zoom)){var lr=et[Ht.source];(Ht.type==="custom"||lr.length)&&this.renderLayer(this,ae[Ht.source],Ht,lr)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:R.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=R.showOverdrawInspector,this.depthRangeFor3D=[0,1-(C._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=q.length-1;this.currentLayer>=0;this.currentLayer--){var br=this.style._layers[q[this.currentLayer]],zr=ae[br.source],Or=qe[br.source];this._renderTileClippingMasks(br,Or),this.renderLayer(this,zr,br,Or)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<q.length;this.currentLayer++){var tn=this.style._layers[q[this.currentLayer]],en=ae[tn.source],vn=(tn.type==="symbol"?st:et)[tn.source];this._renderTileClippingMasks(tn,qe[tn.source]),this.renderLayer(this,en,tn,vn)}this.options.showTileBoundaries&&(e.values(this.style._layers).forEach(function(hn){hn.source&&!hn.isHidden(F.transform.zoom)&&(hn.source!==(Ce&&Ce.id)&&(Ce=F.style.sourceCaches[hn.source]),(!Ae||Ae.getSource().maxzoom<Ce.getSource().maxzoom)&&(Ae=Ce))}),Ae&&lo.debug(this,Ae,Ae.getVisibleCoordinates())),this.options.showPadding&&Ma(this),this.context.setDefault()},zi.prototype.renderLayer=function(C,R,F,q){F.isHidden(this.transform.zoom)||(F.type==="background"||F.type==="custom"||q.length)&&(this.id=F.id,this.gpuTimingStart(F),lo[F.type](C,R,F,q,this.style.placement.variableOffsets),this.gpuTimingEnd())},zi.prototype.gpuTimingStart=function(C){if(this.options.gpuTiming){var R=this.context.extTimerQuery,F=this.gpuTimers[C.id];F||(F=this.gpuTimers[C.id]={calls:0,cpuTime:0,query:R.createQueryEXT()}),F.calls++,R.beginQueryEXT(R.TIME_ELAPSED_EXT,F.query)}},zi.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var C=this.context.extTimerQuery;C.endQueryEXT(C.TIME_ELAPSED_EXT)}},zi.prototype.collectGpuTimers=function(){var C=this.gpuTimers;return this.gpuTimers={},C},zi.prototype.queryGpuTimers=function(C){var R={};for(var F in C){var q=C[F],ae=this.context.extTimerQuery,he=ae.getQueryObjectEXT(q.query,ae.QUERY_RESULT_EXT)/1e6;ae.deleteQueryEXT(q.query),R[F]=he}return R},zi.prototype.translatePosMatrix=function(C,R,F,q,ae){if(!F[0]&&!F[1])return C;var he=ae?q==="map"?this.transform.angle:0:q==="viewport"?-this.transform.angle:0;if(he){var be=Math.sin(he),Ae=Math.cos(he);F=[F[0]*Ae-F[1]*be,F[0]*be+F[1]*Ae]}var Ce=[ae?F[0]:Tn(R,F[0],this.transform.zoom),ae?F[1]:Tn(R,F[1],this.transform.zoom),0],qe=new Float32Array(16);return e.translate(qe,C,Ce),qe},zi.prototype.saveTileTexture=function(C){var R=this._tileTextures[C.size[0]];R?R.push(C):this._tileTextures[C.size[0]]=[C]},zi.prototype.getTileTexture=function(C){var R=this._tileTextures[C];return R&&R.length>0?R.pop():null},zi.prototype.isPatternMissing=function(C){if(!C)return!1;if(!C.from||!C.to)return!0;var R=this.imageManager.getPattern(C.from.toString()),F=this.imageManager.getPattern(C.to.toString());return!R||!F},zi.prototype.useProgram=function(C,R){this.cache=this.cache||{};var F=""+C+(R?R.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[F]||(this.cache[F]=new Us(this.context,As[C],R,kr[C],this._showOverdrawInspector)),this.cache[F]},zi.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},zi.prototype.setBaseState=function(){var C=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(C.FUNC_ADD)},zi.prototype.initDebugOverlayCanvas=function(){if(this.debugOverlayCanvas==null){this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512;var C=this.context.gl;this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,C.RGBA)}},zi.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var dt=function(C,R){this.points=C,this.planes=R};dt.fromInvProjectionMatrix=function(C,R,F){var q=Math.pow(2,F),ae=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(be){return e.transformMat4([],be,C)}).map(function(be){return e.scale$1([],be,1/be[3]/R*q)}),he=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(be){var Ae=e.sub([],ae[be[0]],ae[be[1]]),Ce=e.sub([],ae[be[2]],ae[be[1]]),qe=e.normalize([],e.cross([],Ae,Ce)),et=-e.dot(qe,ae[be[1]]);return qe.concat(et)});return new dt(ae,he)};var Ft=function(C,R){this.min=C,this.max=R,this.center=e.scale$2([],e.add([],this.min,this.max),.5)};Ft.prototype.quadrant=function(C){for(var R=[C%2==0,C<2],F=e.clone$2(this.min),q=e.clone$2(this.max),ae=0;ae<R.length;ae++)F[ae]=R[ae]?this.min[ae]:this.center[ae],q[ae]=R[ae]?this.center[ae]:this.max[ae];return q[2]=this.max[2],new Ft(F,q)},Ft.prototype.distanceX=function(C){return Math.max(Math.min(this.max[0],C[0]),this.min[0])-C[0]},Ft.prototype.distanceY=function(C){return Math.max(Math.min(this.max[1],C[1]),this.min[1])-C[1]},Ft.prototype.intersects=function(C){for(var R=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],F=!0,q=0;q<C.planes.length;q++){for(var ae=C.planes[q],he=0,be=0;be<R.length;be++)he+=e.dot$1(ae,R[be])>=0;if(he===0)return 0;he!==R.length&&(F=!1)}if(F)return 2;for(var Ae=0;Ae<3;Ae++){for(var Ce=Number.MAX_VALUE,qe=-Number.MAX_VALUE,et=0;et<C.points.length;et++){var st=C.points[et][Ae]-this.min[Ae];Ce=Math.min(Ce,st),qe=Math.max(qe,st)}if(qe<0||Ce>this.max[Ae]-this.min[Ae])return 0}return 1};var hr=function(C,R,F,q){if(C===void 0&&(C=0),R===void 0&&(R=0),F===void 0&&(F=0),q===void 0&&(q=0),isNaN(C)||C<0||isNaN(R)||R<0||isNaN(F)||F<0||isNaN(q)||q<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=C,this.bottom=R,this.left=F,this.right=q};hr.prototype.interpolate=function(C,R,F){return R.top!=null&&C.top!=null&&(this.top=e.number(C.top,R.top,F)),R.bottom!=null&&C.bottom!=null&&(this.bottom=e.number(C.bottom,R.bottom,F)),R.left!=null&&C.left!=null&&(this.left=e.number(C.left,R.left,F)),R.right!=null&&C.right!=null&&(this.right=e.number(C.right,R.right,F)),this},hr.prototype.getCenter=function(C,R){var F=e.clamp((this.left+C-this.right)/2,0,C),q=e.clamp((this.top+R-this.bottom)/2,0,R);return new e.Point(F,q)},hr.prototype.equals=function(C){return this.top===C.top&&this.bottom===C.bottom&&this.left===C.left&&this.right===C.right},hr.prototype.clone=function(){return new hr(this.top,this.bottom,this.left,this.right)},hr.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Yt=function(C,R,F,q,ae){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=ae===void 0||ae,this._minZoom=C||0,this._maxZoom=R||22,this._minPitch=F==null?0:F,this._maxPitch=q==null?60:q,this.setMaxBounds(),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new hr,this._posMatrixCache={},this._alignedPosMatrixCache={}},pr={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Yt.prototype.clone=function(){var C=new Yt(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return C.tileSize=this.tileSize,C.latRange=this.latRange,C.width=this.width,C.height=this.height,C._center=this._center,C.zoom=this.zoom,C.angle=this.angle,C._fov=this._fov,C._pitch=this._pitch,C._unmodified=this._unmodified,C._edgeInsets=this._edgeInsets.clone(),C._calcMatrices(),C},pr.minZoom.get=function(){return this._minZoom},pr.minZoom.set=function(C){this._minZoom!==C&&(this._minZoom=C,this.zoom=Math.max(this.zoom,C))},pr.maxZoom.get=function(){return this._maxZoom},pr.maxZoom.set=function(C){this._maxZoom!==C&&(this._maxZoom=C,this.zoom=Math.min(this.zoom,C))},pr.minPitch.get=function(){return this._minPitch},pr.minPitch.set=function(C){this._minPitch!==C&&(this._minPitch=C,this.pitch=Math.max(this.pitch,C))},pr.maxPitch.get=function(){return this._maxPitch},pr.maxPitch.set=function(C){this._maxPitch!==C&&(this._maxPitch=C,this.pitch=Math.min(this.pitch,C))},pr.renderWorldCopies.get=function(){return this._renderWorldCopies},pr.renderWorldCopies.set=function(C){C===void 0?C=!0:C===null&&(C=!1),this._renderWorldCopies=C},pr.worldSize.get=function(){return this.tileSize*this.scale},pr.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},pr.size.get=function(){return new e.Point(this.width,this.height)},pr.bearing.get=function(){return-this.angle/Math.PI*180},pr.bearing.set=function(C){var R=-e.wrap(C,-180,180)*Math.PI/180;this.angle!==R&&(this._unmodified=!1,this.angle=R,this._calcMatrices(),this.rotationMatrix=e.create$2(),e.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},pr.pitch.get=function(){return this._pitch/Math.PI*180},pr.pitch.set=function(C){var R=e.clamp(C,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==R&&(this._unmodified=!1,this._pitch=R,this._calcMatrices())},pr.fov.get=function(){return this._fov/Math.PI*180},pr.fov.set=function(C){C=Math.max(.01,Math.min(60,C)),this._fov!==C&&(this._unmodified=!1,this._fov=C/180*Math.PI,this._calcMatrices())},pr.zoom.get=function(){return this._zoom},pr.zoom.set=function(C){var R=Math.min(Math.max(C,this.minZoom),this.maxZoom);this._zoom!==R&&(this._unmodified=!1,this._zoom=R,this.scale=this.zoomScale(R),this.tileZoom=Math.floor(R),this.zoomFraction=R-this.tileZoom,this._constrain(),this._calcMatrices())},pr.center.get=function(){return this._center},pr.center.set=function(C){C.lat===this._center.lat&&C.lng===this._center.lng||(this._unmodified=!1,this._center=C,this._constrain(),this._calcMatrices())},pr.padding.get=function(){return this._edgeInsets.toJSON()},pr.padding.set=function(C){this._edgeInsets.equals(C)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,C,1),this._calcMatrices())},pr.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Yt.prototype.isPaddingEqual=function(C){return this._edgeInsets.equals(C)},Yt.prototype.interpolatePadding=function(C,R,F){this._unmodified=!1,this._edgeInsets.interpolate(C,R,F),this._constrain(),this._calcMatrices()},Yt.prototype.coveringZoomLevel=function(C){var R=(C.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/C.tileSize));return Math.max(0,R)},Yt.prototype.getVisibleUnwrappedCoordinates=function(C){var R=[new e.UnwrappedTileID(0,C)];if(this._renderWorldCopies)for(var F=this.pointCoordinate(new e.Point(0,0)),q=this.pointCoordinate(new e.Point(this.width,0)),ae=this.pointCoordinate(new e.Point(this.width,this.height)),he=this.pointCoordinate(new e.Point(0,this.height)),be=Math.floor(Math.min(F.x,q.x,ae.x,he.x)),Ae=Math.floor(Math.max(F.x,q.x,ae.x,he.x)),Ce=be-1;Ce<=Ae+1;Ce++)Ce!==0&&R.push(new e.UnwrappedTileID(Ce,C));return R},Yt.prototype.coveringTiles=function(C){var R=this.coveringZoomLevel(C),F=R;if(C.minzoom!==void 0&&R<C.minzoom)return[];C.maxzoom!==void 0&&R>C.maxzoom&&(R=C.maxzoom);var q=e.MercatorCoordinate.fromLngLat(this.center),ae=Math.pow(2,R),he=[ae*q.x,ae*q.y,0],be=dt.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,R),Ae=C.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(Ae=R);var Ce=function(vn){return{aabb:new Ft([vn*ae,0,0],[(vn+1)*ae,ae,0]),zoom:0,x:0,y:0,wrap:vn,fullyVisible:!1}},qe=[],et=[],st=R,kt=C.reparseOverscaled?F:R;if(this._renderWorldCopies)for(var Pt=1;Pt<=3;Pt++)qe.push(Ce(-Pt)),qe.push(Ce(Pt));for(qe.push(Ce(0));qe.length>0;){var Et=qe.pop(),Lt=Et.x,Tt=Et.y,Bt=Et.fullyVisible;if(!Bt){var zt=Et.aabb.intersects(be);if(zt===0)continue;Bt=zt===2}var Ht=Et.aabb.distanceX(he),lr=Et.aabb.distanceY(he),br=Math.max(Math.abs(Ht),Math.abs(lr)),zr=3+(1<<st-Et.zoom)-2;if(Et.zoom===st||br>zr&&Et.zoom>=Ae)et.push({tileID:new e.OverscaledTileID(Et.zoom===st?kt:Et.zoom,Et.wrap,Et.zoom,Lt,Tt),distanceSq:e.sqrLen([he[0]-.5-Lt,he[1]-.5-Tt])});else for(var Or=0;Or<4;Or++){var tn=(Lt<<1)+Or%2,en=(Tt<<1)+(Or>>1);qe.push({aabb:Et.aabb.quadrant(Or),zoom:Et.zoom+1,x:tn,y:en,wrap:Et.wrap,fullyVisible:Bt})}}return et.sort(function(vn,hn){return vn.distanceSq-hn.distanceSq}).map(function(vn){return vn.tileID})},Yt.prototype.resize=function(C,R){this.width=C,this.height=R,this.pixelsToGLUnits=[2/C,-2/R],this._constrain(),this._calcMatrices()},pr.unmodified.get=function(){return this._unmodified},Yt.prototype.zoomScale=function(C){return Math.pow(2,C)},Yt.prototype.scaleZoom=function(C){return Math.log(C)/Math.LN2},Yt.prototype.project=function(C){var R=e.clamp(C.lat,-this.maxValidLatitude,this.maxValidLatitude);return new e.Point(e.mercatorXfromLng(C.lng)*this.worldSize,e.mercatorYfromLat(R)*this.worldSize)},Yt.prototype.unproject=function(C){return new e.MercatorCoordinate(C.x/this.worldSize,C.y/this.worldSize).toLngLat()},pr.point.get=function(){return this.project(this.center)},Yt.prototype.setLocationAtPoint=function(C,R){var F=this.pointCoordinate(R),q=this.pointCoordinate(this.centerPoint),ae=this.locationCoordinate(C),he=new e.MercatorCoordinate(ae.x-(F.x-q.x),ae.y-(F.y-q.y));this.center=this.coordinateLocation(he),this._renderWorldCopies&&(this.center=this.center.wrap())},Yt.prototype.locationPoint=function(C){return this.coordinatePoint(this.locationCoordinate(C))},Yt.prototype.pointLocation=function(C){return this.coordinateLocation(this.pointCoordinate(C))},Yt.prototype.locationCoordinate=function(C){return e.MercatorCoordinate.fromLngLat(C)},Yt.prototype.coordinateLocation=function(C){return C.toLngLat()},Yt.prototype.pointCoordinate=function(C){var R=[C.x,C.y,0,1],F=[C.x,C.y,1,1];e.transformMat4(R,R,this.pixelMatrixInverse),e.transformMat4(F,F,this.pixelMatrixInverse);var q=R[3],ae=F[3],he=R[0]/q,be=F[0]/ae,Ae=R[1]/q,Ce=F[1]/ae,qe=R[2]/q,et=F[2]/ae,st=qe===et?0:(0-qe)/(et-qe);return new e.MercatorCoordinate(e.number(he,be,st)/this.worldSize,e.number(Ae,Ce,st)/this.worldSize)},Yt.prototype.coordinatePoint=function(C){var R=[C.x*this.worldSize,C.y*this.worldSize,0,1];return e.transformMat4(R,R,this.pixelMatrix),new e.Point(R[0]/R[3],R[1]/R[3])},Yt.prototype.getBounds=function(){return new e.LngLatBounds().extend(this.pointLocation(new e.Point(0,0))).extend(this.pointLocation(new e.Point(this.width,0))).extend(this.pointLocation(new e.Point(this.width,this.height))).extend(this.pointLocation(new e.Point(0,this.height)))},Yt.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new e.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Yt.prototype.setMaxBounds=function(C){C?(this.lngRange=[C.getWest(),C.getEast()],this.latRange=[C.getSouth(),C.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Yt.prototype.calculatePosMatrix=function(C,R){R===void 0&&(R=!1);var F=C.key,q=R?this._alignedPosMatrixCache:this._posMatrixCache;if(q[F])return q[F];var ae=C.canonical,he=this.worldSize/this.zoomScale(ae.z),be=ae.x+Math.pow(2,ae.z)*C.wrap,Ae=e.identity(new Float64Array(16));return e.translate(Ae,Ae,[be*he,ae.y*he,0]),e.scale(Ae,Ae,[he/e.EXTENT,he/e.EXTENT,1]),e.multiply(Ae,R?this.alignedProjMatrix:this.projMatrix,Ae),q[F]=new Float32Array(Ae),q[F]},Yt.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Yt.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var C,R,F,q,ae=-90,he=90,be=-180,Ae=180,Ce=this.size,qe=this._unmodified;if(this.latRange){var et=this.latRange;ae=e.mercatorYfromLat(et[1])*this.worldSize,C=(he=e.mercatorYfromLat(et[0])*this.worldSize)-ae<Ce.y?Ce.y/(he-ae):0}if(this.lngRange){var st=this.lngRange;be=e.mercatorXfromLng(st[0])*this.worldSize,R=(Ae=e.mercatorXfromLng(st[1])*this.worldSize)-be<Ce.x?Ce.x/(Ae-be):0}var kt=this.point,Pt=Math.max(R||0,C||0);if(Pt)return this.center=this.unproject(new e.Point(R?(Ae+be)/2:kt.x,C?(he+ae)/2:kt.y)),this.zoom+=this.scaleZoom(Pt),this._unmodified=qe,void(this._constraining=!1);if(this.latRange){var Et=kt.y,Lt=Ce.y/2;Et-Lt<ae&&(q=ae+Lt),Et+Lt>he&&(q=he-Lt)}if(this.lngRange){var Tt=kt.x,Bt=Ce.x/2;Tt-Bt<be&&(F=be+Bt),Tt+Bt>Ae&&(F=Ae-Bt)}F===void 0&&q===void 0||(this.center=this.unproject(new e.Point(F!==void 0?F:kt.x,q!==void 0?q:kt.y))),this._unmodified=qe,this._constraining=!1}},Yt.prototype._calcMatrices=function(){if(this.height){var C=this._fov/2,R=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(C)*this.height;var F=Math.PI/2+this._pitch,q=this._fov*(.5+R.y/this.height),ae=Math.sin(q)*this.cameraToCenterDistance/Math.sin(e.clamp(Math.PI-F-q,.01,Math.PI-.01)),he=this.point,be=he.x,Ae=he.y,Ce=1.01*(Math.cos(Math.PI/2-this._pitch)*ae+this.cameraToCenterDistance),qe=this.height/50,et=new Float64Array(16);e.perspective(et,this._fov,this.width/this.height,qe,Ce),et[8]=2*-R.x/this.width,et[9]=2*R.y/this.height,e.scale(et,et,[1,-1,1]),e.translate(et,et,[0,0,-this.cameraToCenterDistance]),e.rotateX(et,et,this._pitch),e.rotateZ(et,et,this.angle),e.translate(et,et,[-be,-Ae,0]),this.mercatorMatrix=e.scale([],et,[this.worldSize,this.worldSize,this.worldSize]),e.scale(et,et,[1,1,e.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=et,this.invProjMatrix=e.invert([],this.projMatrix);var st=this.width%2/2,kt=this.height%2/2,Pt=Math.cos(this.angle),Et=Math.sin(this.angle),Lt=be-Math.round(be)+Pt*st+Et*kt,Tt=Ae-Math.round(Ae)+Pt*kt+Et*st,Bt=new Float64Array(et);if(e.translate(Bt,Bt,[Lt>.5?Lt-1:Lt,Tt>.5?Tt-1:Tt,0]),this.alignedProjMatrix=Bt,et=e.create(),e.scale(et,et,[this.width/2,-this.height/2,1]),e.translate(et,et,[1,-1,0]),this.labelPlaneMatrix=et,et=e.create(),e.scale(et,et,[1,-1,1]),e.translate(et,et,[-1,-1,0]),e.scale(et,et,[2/this.width,2/this.height,1]),this.glCoordMatrix=et,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(et=e.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=et,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Yt.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var C=this.pointCoordinate(new e.Point(0,0)),R=[C.x*this.worldSize,C.y*this.worldSize,0,1];return e.transformMat4(R,R,this.pixelMatrix)[3]/this.cameraToCenterDistance},Yt.prototype.getCameraPoint=function(){var C=this._pitch,R=Math.tan(C)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.Point(0,R))},Yt.prototype.getCameraQueryGeometry=function(C){var R=this.getCameraPoint();if(C.length===1)return[C[0],R];for(var F=R.x,q=R.y,ae=R.x,he=R.y,be=0,Ae=C;be<Ae.length;be+=1){var Ce=Ae[be];F=Math.min(F,Ce.x),q=Math.min(q,Ce.y),ae=Math.max(ae,Ce.x),he=Math.max(he,Ce.y)}return[new e.Point(F,q),new e.Point(ae,q),new e.Point(ae,he),new e.Point(F,he),new e.Point(F,q)]},Object.defineProperties(Yt.prototype,pr);var Nr=function(C){var R,F,q,ae,he;this._hashName=C&&encodeURIComponent(C),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(R=this._updateHashUnthrottled.bind(this),F=300,q=!1,ae=null,he=function(){ae=null,q&&(R(),ae=setTimeout(he,F),q=!1)},function(){return q=!0,ae||he(),ae})};Nr.prototype.addTo=function(C){return this._map=C,e.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Nr.prototype.remove=function(){return e.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Nr.prototype.getHashString=function(C){var R=this._map.getCenter(),F=Math.round(100*this._map.getZoom())/100,q=Math.ceil((F*Math.LN2+Math.log(512/360/.5))/Math.LN10),ae=Math.pow(10,q),he=Math.round(R.lng*ae)/ae,be=Math.round(R.lat*ae)/ae,Ae=this._map.getBearing(),Ce=this._map.getPitch(),qe="";if(qe+=C?"/"+he+"/"+be+"/"+F:F+"/"+be+"/"+he,(Ae||Ce)&&(qe+="/"+Math.round(10*Ae)/10),Ce&&(qe+="/"+Math.round(Ce)),this._hashName){var et=this._hashName,st=!1,kt=e.window.location.hash.slice(1).split("&").map(function(Pt){var Et=Pt.split("=")[0];return Et===et?(st=!0,Et+"="+qe):Pt}).filter(function(Pt){return Pt});return st||kt.push(et+"="+qe),"#"+kt.join("&")}return"#"+qe},Nr.prototype._getCurrentHash=function(){var C,R=this,F=e.window.location.hash.replace("#","");return this._hashName?(F.split("&").map(function(q){return q.split("=")}).forEach(function(q){q[0]===R._hashName&&(C=q)}),(C&&C[1]||"").split("/")):F.split("/")},Nr.prototype._onHashChange=function(){var C=this._getCurrentHash();if(C.length>=3&&!C.some(function(F){return isNaN(F)})){var R=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(C[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+C[2],+C[1]],zoom:+C[0],bearing:R,pitch:+(C[4]||0)}),!0}return!1},Nr.prototype._updateHashUnthrottled=function(){var C=this.getHashString();try{e.window.history.replaceState(e.window.history.state,"",C)}catch{}};var qr={linearity:.3,easing:e.bezier(0,0,.3,1)},$r=e.extend({deceleration:2500,maxSpeed:1400},qr),dn=e.extend({deceleration:20,maxSpeed:1400},qr),fn=e.extend({deceleration:1e3,maxSpeed:360},qr),_n=e.extend({deceleration:1e3,maxSpeed:90},qr),Sn=function(C){this._map=C,this.clear()};function mn(C,R){(!C.duration||C.duration<R.duration)&&(C.duration=R.duration,C.easing=R.easing)}function En(C,R,F){var q=F.maxSpeed,ae=F.linearity,he=F.deceleration,be=e.clamp(C*ae/(R/1e3),-q,q),Ae=Math.abs(be)/(he*ae);return{easing:F.easing,duration:1e3*Ae,amount:be*(Ae/2)}}Sn.prototype.clear=function(){this._inertiaBuffer=[]},Sn.prototype.record=function(C){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.browser.now(),settings:C})},Sn.prototype._drainInertiaBuffer=function(){for(var C=this._inertiaBuffer,R=e.browser.now();C.length>0&&R-C[0].time>160;)C.shift()},Sn.prototype._onMoveEnd=function(C){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var R={zoom:0,bearing:0,pitch:0,pan:new e.Point(0,0),pinchAround:void 0,around:void 0},F=0,q=this._inertiaBuffer;F<q.length;F+=1){var ae=q[F].settings;R.zoom+=ae.zoomDelta||0,R.bearing+=ae.bearingDelta||0,R.pitch+=ae.pitchDelta||0,ae.panDelta&&R.pan._add(ae.panDelta),ae.around&&(R.around=ae.around),ae.pinchAround&&(R.pinchAround=ae.pinchAround)}var he=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,be={};if(R.pan.mag()){var Ae=En(R.pan.mag(),he,e.extend({},$r,C||{}));be.offset=R.pan.mult(Ae.amount/R.pan.mag()),be.center=this._map.transform.center,mn(be,Ae)}if(R.zoom){var Ce=En(R.zoom,he,dn);be.zoom=this._map.transform.zoom+Ce.amount,mn(be,Ce)}if(R.bearing){var qe=En(R.bearing,he,fn);be.bearing=this._map.transform.bearing+e.clamp(qe.amount,-179,179),mn(be,qe)}if(R.pitch){var et=En(R.pitch,he,_n);be.pitch=this._map.transform.pitch+et.amount,mn(be,et)}if(be.zoom||be.bearing){var st=R.pinchAround===void 0?R.around:R.pinchAround;be.around=st?this._map.unproject(st):this._map.getCenter()}return this.clear(),e.extend(be,{noMoveStart:!0})}};var Nn=function(C){function R(q,ae,he,be){be===void 0&&(be={});var Ae=n.mousePos(ae.getCanvasContainer(),he),Ce=ae.unproject(Ae);C.call(this,q,e.extend({point:Ae,lngLat:Ce,originalEvent:he},be)),this._defaultPrevented=!1,this.target=ae}C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R;var F={defaultPrevented:{configurable:!0}};return R.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(R.prototype,F),R}(e.Event),Gn=function(C){function R(q,ae,he){var be=q==="touchend"?he.changedTouches:he.touches,Ae=n.touchPos(ae.getCanvasContainer(),be),Ce=Ae.map(function(st){return ae.unproject(st)}),qe=Ae.reduce(function(st,kt,Pt,Et){return st.add(kt.div(Et.length))},new e.Point(0,0)),et=ae.unproject(qe);C.call(this,q,{points:Ae,point:qe,lngLats:Ce,lngLat:et,originalEvent:he}),this._defaultPrevented=!1}C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R;var F={defaultPrevented:{configurable:!0}};return R.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(R.prototype,F),R}(e.Event),si=function(C){function R(q,ae,he){C.call(this,q,{originalEvent:he}),this._defaultPrevented=!1}C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R;var F={defaultPrevented:{configurable:!0}};return R.prototype.preventDefault=function(){this._defaultPrevented=!0},F.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(R.prototype,F),R}(e.Event),Qr=function(C,R){this._map=C,this._clickTolerance=R.clickTolerance};Qr.prototype.reset=function(){delete this._mousedownPos},Qr.prototype.wheel=function(C){return this._firePreventable(new si(C.type,this._map,C))},Qr.prototype.mousedown=function(C,R){return this._mousedownPos=R,this._firePreventable(new Nn(C.type,this._map,C))},Qr.prototype.mouseup=function(C){this._map.fire(new Nn(C.type,this._map,C))},Qr.prototype.click=function(C,R){this._mousedownPos&&this._mousedownPos.dist(R)>=this._clickTolerance||this._map.fire(new Nn(C.type,this._map,C))},Qr.prototype.dblclick=function(C){return this._firePreventable(new Nn(C.type,this._map,C))},Qr.prototype.mouseover=function(C){this._map.fire(new Nn(C.type,this._map,C))},Qr.prototype.mouseout=function(C){this._map.fire(new Nn(C.type,this._map,C))},Qr.prototype.touchstart=function(C){return this._firePreventable(new Gn(C.type,this._map,C))},Qr.prototype.touchmove=function(C){this._map.fire(new Gn(C.type,this._map,C))},Qr.prototype.touchend=function(C){this._map.fire(new Gn(C.type,this._map,C))},Qr.prototype.touchcancel=function(C){this._map.fire(new Gn(C.type,this._map,C))},Qr.prototype._firePreventable=function(C){if(this._map.fire(C),C.defaultPrevented)return{}},Qr.prototype.isEnabled=function(){return!0},Qr.prototype.isActive=function(){return!1},Qr.prototype.enable=function(){},Qr.prototype.disable=function(){};var ii=function(C){this._map=C};ii.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},ii.prototype.mousemove=function(C){this._map.fire(new Nn(C.type,this._map,C))},ii.prototype.mousedown=function(){this._delayContextMenu=!0},ii.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Nn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},ii.prototype.contextmenu=function(C){this._delayContextMenu?this._contextMenuEvent=C:this._map.fire(new Nn(C.type,this._map,C)),this._map.listens("contextmenu")&&C.preventDefault()},ii.prototype.isEnabled=function(){return!0},ii.prototype.isActive=function(){return!1},ii.prototype.enable=function(){},ii.prototype.disable=function(){};var Dn=function(C,R){this._map=C,this._el=C.getCanvasContainer(),this._container=C.getContainer(),this._clickTolerance=R.clickTolerance||1};function Vn(C,R){for(var F={},q=0;q<C.length;q++)F[C[q].identifier]=R[q];return F}Dn.prototype.isEnabled=function(){return!!this._enabled},Dn.prototype.isActive=function(){return!!this._active},Dn.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Dn.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Dn.prototype.mousedown=function(C,R){this.isEnabled()&&C.shiftKey&&C.button===0&&(n.disableDrag(),this._startPos=this._lastPos=R,this._active=!0)},Dn.prototype.mousemoveWindow=function(C,R){if(this._active){var F=R;if(!(this._lastPos.equals(F)||!this._box&&F.dist(this._startPos)<this._clickTolerance)){var q=this._startPos;this._lastPos=F,this._box||(this._box=n.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",C));var ae=Math.min(q.x,F.x),he=Math.max(q.x,F.x),be=Math.min(q.y,F.y),Ae=Math.max(q.y,F.y);n.setTransform(this._box,"translate("+ae+"px,"+be+"px)"),this._box.style.width=he-ae+"px",this._box.style.height=Ae-be+"px"}}},Dn.prototype.mouseupWindow=function(C,R){var F=this;if(this._active&&C.button===0){var q=this._startPos,ae=R;if(this.reset(),n.suppressClick(),q.x!==ae.x||q.y!==ae.y)return this._map.fire(new e.Event("boxzoomend",{originalEvent:C})),{cameraAnimation:function(he){return he.fitScreenCoordinates(q,ae,F._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",C)}},Dn.prototype.keydown=function(C){this._active&&C.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",C))},Dn.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(n.remove(this._box),this._box=null),n.enableDrag(),delete this._startPos,delete this._lastPos},Dn.prototype._fireEvent=function(C,R){return this._map.fire(new e.Event(C,{originalEvent:R}))};var ni=function(C){this.reset(),this.numTouches=C.numTouches};ni.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},ni.prototype.touchstart=function(C,R,F){(this.centroid||F.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=C.timeStamp),F.length===this.numTouches&&(this.centroid=function(q){for(var ae=new e.Point(0,0),he=0,be=q;he<be.length;he+=1){var Ae=be[he];ae._add(Ae)}return ae.div(q.length)}(R),this.touches=Vn(F,R)))},ni.prototype.touchmove=function(C,R,F){if(!this.aborted&&this.centroid){var q=Vn(F,R);for(var ae in this.touches){var he=this.touches[ae],be=q[ae];(!be||be.dist(he)>30)&&(this.aborted=!0)}}},ni.prototype.touchend=function(C,R,F){if((!this.centroid||C.timeStamp-this.startTime>500)&&(this.aborted=!0),F.length===0){var q=!this.aborted&&this.centroid;if(this.reset(),q)return q}};var ki=function(C){this.singleTap=new ni(C),this.numTaps=C.numTaps,this.reset()};ki.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},ki.prototype.touchstart=function(C,R,F){this.singleTap.touchstart(C,R,F)},ki.prototype.touchmove=function(C,R,F){this.singleTap.touchmove(C,R,F)},ki.prototype.touchend=function(C,R,F){var q=this.singleTap.touchend(C,R,F);if(q){var ae=C.timeStamp-this.lastTime<500,he=!this.lastTap||this.lastTap.dist(q)<30;if(ae&&he||this.reset(),this.count++,this.lastTime=C.timeStamp,this.lastTap=q,this.count===this.numTaps)return this.reset(),q}};var Pi=function(){this._zoomIn=new ki({numTouches:1,numTaps:2}),this._zoomOut=new ki({numTouches:2,numTaps:1}),this.reset()};Pi.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Pi.prototype.touchstart=function(C,R,F){this._zoomIn.touchstart(C,R,F),this._zoomOut.touchstart(C,R,F)},Pi.prototype.touchmove=function(C,R,F){this._zoomIn.touchmove(C,R,F),this._zoomOut.touchmove(C,R,F)},Pi.prototype.touchend=function(C,R,F){var q=this,ae=this._zoomIn.touchend(C,R,F),he=this._zoomOut.touchend(C,R,F);return ae?(this._active=!0,C.preventDefault(),setTimeout(function(){return q.reset()},0),{cameraAnimation:function(be){return be.easeTo({duration:300,zoom:be.getZoom()+1,around:be.unproject(ae)},{originalEvent:C})}}):he?(this._active=!0,C.preventDefault(),setTimeout(function(){return q.reset()},0),{cameraAnimation:function(be){return be.easeTo({duration:300,zoom:be.getZoom()-1,around:be.unproject(he)},{originalEvent:C})}}):void 0},Pi.prototype.touchcancel=function(){this.reset()},Pi.prototype.enable=function(){this._enabled=!0},Pi.prototype.disable=function(){this._enabled=!1,this.reset()},Pi.prototype.isEnabled=function(){return this._enabled},Pi.prototype.isActive=function(){return this._active};var In=function(C){this.reset(),this._clickTolerance=C.clickTolerance||1};In.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},In.prototype._correctButton=function(C,R){return!1},In.prototype._move=function(C,R){return{}},In.prototype.mousedown=function(C,R){if(!this._lastPoint){var F=n.mouseButton(C);this._correctButton(C,F)&&(this._lastPoint=R,this._eventButton=F)}},In.prototype.mousemoveWindow=function(C,R){var F=this._lastPoint;if(F&&(C.preventDefault(),this._moved||!(R.dist(F)<this._clickTolerance)))return this._moved=!0,this._lastPoint=R,this._move(F,R)},In.prototype.mouseupWindow=function(C){n.mouseButton(C)===this._eventButton&&(this._moved&&n.suppressClick(),this.reset())},In.prototype.enable=function(){this._enabled=!0},In.prototype.disable=function(){this._enabled=!1,this.reset()},In.prototype.isEnabled=function(){return this._enabled},In.prototype.isActive=function(){return this._active};var Ri=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.mousedown=function(F,q){C.prototype.mousedown.call(this,F,q),this._lastPoint&&(this._active=!0)},R.prototype._correctButton=function(F,q){return q===0&&!F.ctrlKey},R.prototype._move=function(F,q){return{around:q,panDelta:q.sub(F)}},R}(In),Ci=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype._correctButton=function(F,q){return q===0&&F.ctrlKey||q===2},R.prototype._move=function(F,q){var ae=.8*(q.x-F.x);if(ae)return this._active=!0,{bearingDelta:ae}},R.prototype.contextmenu=function(F){F.preventDefault()},R}(In),gi=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype._correctButton=function(F,q){return q===0&&F.ctrlKey||q===2},R.prototype._move=function(F,q){var ae=-.5*(q.y-F.y);if(ae)return this._active=!0,{pitchDelta:ae}},R.prototype.contextmenu=function(F){F.preventDefault()},R}(In),Fi=function(C){this._minTouches=1,this._clickTolerance=C.clickTolerance||1,this.reset()};Fi.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new e.Point(0,0)},Fi.prototype.touchstart=function(C,R,F){return this._calculateTransform(C,R,F)},Fi.prototype.touchmove=function(C,R,F){if(this._active)return C.preventDefault(),this._calculateTransform(C,R,F)},Fi.prototype.touchend=function(C,R,F){this._calculateTransform(C,R,F),this._active&&F.length<this._minTouches&&this.reset()},Fi.prototype.touchcancel=function(){this.reset()},Fi.prototype._calculateTransform=function(C,R,F){F.length>0&&(this._active=!0);var q=Vn(F,R),ae=new e.Point(0,0),he=new e.Point(0,0),be=0;for(var Ae in q){var Ce=q[Ae],qe=this._touches[Ae];qe&&(ae._add(Ce),he._add(Ce.sub(qe)),be++,q[Ae]=Ce)}if(this._touches=q,!(be<this._minTouches)&&he.mag()){var et=he.div(be);if(this._sum._add(et),!(this._sum.mag()<this._clickTolerance))return{around:ae.div(be),panDelta:et}}},Fi.prototype.enable=function(){this._enabled=!0},Fi.prototype.disable=function(){this._enabled=!1,this.reset()},Fi.prototype.isEnabled=function(){return this._enabled},Fi.prototype.isActive=function(){return this._active};var Ei=function(){this.reset()};function na(C,R,F){for(var q=0;q<C.length;q++)if(C[q].identifier===F)return R[q]}Ei.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Ei.prototype._start=function(C){},Ei.prototype._move=function(C,R,F){return{}},Ei.prototype.touchstart=function(C,R,F){this._firstTwoTouches||F.length<2||(this._firstTwoTouches=[F[0].identifier,F[1].identifier],this._start([R[0],R[1]]))},Ei.prototype.touchmove=function(C,R,F){if(this._firstTwoTouches){C.preventDefault();var q=this._firstTwoTouches,ae=q[0],he=q[1],be=na(F,R,ae),Ae=na(F,R,he);if(be&&Ae){var Ce=this._aroundCenter?null:be.add(Ae).div(2);return this._move([be,Ae],Ce,C)}}},Ei.prototype.touchend=function(C,R,F){if(this._firstTwoTouches){var q=this._firstTwoTouches,ae=q[0],he=q[1],be=na(F,R,ae),Ae=na(F,R,he);be&&Ae||(this._active&&n.suppressClick(),this.reset())}},Ei.prototype.touchcancel=function(){this.reset()},Ei.prototype.enable=function(C){this._enabled=!0,this._aroundCenter=!!C&&C.around==="center"},Ei.prototype.disable=function(){this._enabled=!1,this.reset()},Ei.prototype.isEnabled=function(){return this._enabled},Ei.prototype.isActive=function(){return this._active};function ai(C,R){return Math.log(C/R)/Math.LN2}var Ki=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.reset=function(){C.prototype.reset.call(this),delete this._distance,delete this._startDistance},R.prototype._start=function(F){this._startDistance=this._distance=F[0].dist(F[1])},R.prototype._move=function(F,q){var ae=this._distance;if(this._distance=F[0].dist(F[1]),this._active||!(Math.abs(ai(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ai(this._distance,ae),pinchAround:q}},R}(Ei);function Ya(C,R){return 180*C.angleWith(R)/Math.PI}var is=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.reset=function(){C.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},R.prototype._start=function(F){this._startVector=this._vector=F[0].sub(F[1]),this._minDiameter=F[0].dist(F[1])},R.prototype._move=function(F,q){var ae=this._vector;if(this._vector=F[0].sub(F[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Ya(this._vector,ae),pinchAround:q}},R.prototype._isBelowThreshold=function(F){this._minDiameter=Math.min(this._minDiameter,F.mag());var q=25/(Math.PI*this._minDiameter)*360,ae=Ya(F,this._startVector);return Math.abs(ae)<q},R}(Ei);function Ho(C){return Math.abs(C.y)>Math.abs(C.x)}var Mo=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.reset=function(){C.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},R.prototype._start=function(F){this._lastPoints=F,Ho(F[0].sub(F[1]))&&(this._valid=!1)},R.prototype._move=function(F,q,ae){var he=F[0].sub(this._lastPoints[0]),be=F[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(he,be,ae.timeStamp),this._valid)return this._lastPoints=F,this._active=!0,{pitchDelta:-.5*((he.y+be.y)/2)}},R.prototype.gestureBeginsVertically=function(F,q,ae){if(this._valid!==void 0)return this._valid;var he=F.mag()>=2,be=q.mag()>=2;if(he||be){if(!he||!be)return this._firstMove===void 0&&(this._firstMove=ae),ae-this._firstMove<100&&void 0;var Ae=F.y>0==q.y>0;return Ho(F)&&Ho(q)&&Ae}},R}(Ei),xi={panStep:100,bearingStep:15,pitchStep:10},xa=function(){var C=xi;this._panStep=C.panStep,this._bearingStep=C.bearingStep,this._pitchStep=C.pitchStep};function Ao(C){return C*(2-C)}xa.prototype.reset=function(){this._active=!1},xa.prototype.keydown=function(C){var R=this;if(!(C.altKey||C.ctrlKey||C.metaKey)){var F=0,q=0,ae=0,he=0,be=0;switch(C.keyCode){case 61:case 107:case 171:case 187:F=1;break;case 189:case 109:case 173:F=-1;break;case 37:C.shiftKey?q=-1:(C.preventDefault(),he=-1);break;case 39:C.shiftKey?q=1:(C.preventDefault(),he=1);break;case 38:C.shiftKey?ae=1:(C.preventDefault(),be=-1);break;case 40:C.shiftKey?ae=-1:(C.preventDefault(),be=1);break;default:return}return{cameraAnimation:function(Ae){var Ce=Ae.getZoom();Ae.easeTo({duration:300,easeId:"keyboardHandler",easing:Ao,zoom:F?Math.round(Ce)+F*(C.shiftKey?2:1):Ce,bearing:Ae.getBearing()+q*R._bearingStep,pitch:Ae.getPitch()+ae*R._pitchStep,offset:[-he*R._panStep,-be*R._panStep],center:Ae.getCenter()},{originalEvent:C})}}}},xa.prototype.enable=function(){this._enabled=!0},xa.prototype.disable=function(){this._enabled=!1,this.reset()},xa.prototype.isEnabled=function(){return this._enabled},xa.prototype.isActive=function(){return this._active};var Ji=function(C,R){this._map=C,this._el=C.getCanvasContainer(),this._handler=R,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,e.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};Ji.prototype.setZoomRate=function(C){this._defaultZoomRate=C},Ji.prototype.setWheelZoomRate=function(C){this._wheelZoomRate=C},Ji.prototype.isEnabled=function(){return!!this._enabled},Ji.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},Ji.prototype.isZooming=function(){return!!this._zooming},Ji.prototype.enable=function(C){this.isEnabled()||(this._enabled=!0,this._aroundCenter=C&&C.around==="center")},Ji.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Ji.prototype.wheel=function(C){if(this.isEnabled()){var R=C.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?40*C.deltaY:C.deltaY,F=e.browser.now(),q=F-(this._lastWheelEventTime||0);this._lastWheelEventTime=F,R!==0&&R%4.000244140625==0?this._type="wheel":R!==0&&Math.abs(R)<4?this._type="trackpad":q>400?(this._type=null,this._lastValue=R,this._timeout=setTimeout(this._onTimeout,40,C)):this._type||(this._type=Math.abs(q*R)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,R+=this._lastValue)),C.shiftKey&&R&&(R/=4),this._type&&(this._lastWheelEvent=C,this._delta-=R,this._active||this._start(C)),C.preventDefault()}},Ji.prototype._onTimeout=function(C){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(C)},Ji.prototype._start=function(C){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var R=n.mousePos(this._el,C);this._around=e.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(R)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},Ji.prototype.renderFrame=function(){return this._onScrollFrame()},Ji.prototype._onScrollFrame=function(){var C=this;if(this._frameId&&(this._frameId=null,this.isActive())){var R=this._map.transform;if(this._delta!==0){var F=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,q=2/(1+Math.exp(-Math.abs(this._delta*F)));this._delta<0&&q!==0&&(q=1/q);var ae=typeof this._targetZoom=="number"?R.zoomScale(this._targetZoom):R.scale;this._targetZoom=Math.min(R.maxZoom,Math.max(R.minZoom,R.scaleZoom(ae*q))),this._type==="wheel"&&(this._startZoom=R.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var he,be=typeof this._targetZoom=="number"?this._targetZoom:R.zoom,Ae=this._startZoom,Ce=this._easing,qe=!1;if(this._type==="wheel"&&Ae&&Ce){var et=Math.min((e.browser.now()-this._lastWheelEventTime)/200,1),st=Ce(et);he=e.number(Ae,be,st),et<1?this._frameId||(this._frameId=!0):qe=!0}else he=be,qe=!0;return this._active=!0,qe&&(this._active=!1,this._finishTimeout=setTimeout(function(){C._zooming=!1,C._handler._triggerRenderFrame(),delete C._targetZoom,delete C._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!qe,zoomDelta:he-R.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},Ji.prototype._smoothOutEasing=function(C){var R=e.ease;if(this._prevEase){var F=this._prevEase,q=(e.browser.now()-F.start)/F.duration,ae=F.easing(q+.01)-F.easing(q),he=.27/Math.sqrt(ae*ae+1e-4)*.01,be=Math.sqrt(.0729-he*he);R=e.bezier(he,be,.25,1)}return this._prevEase={start:e.browser.now(),duration:C,easing:R},R},Ji.prototype.reset=function(){this._active=!1};var La=function(C,R){this._clickZoom=C,this._tapZoom=R};La.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},La.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},La.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},La.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var $a=function(){this.reset()};$a.prototype.reset=function(){this._active=!1},$a.prototype.dblclick=function(C,R){return C.preventDefault(),{cameraAnimation:function(F){F.easeTo({duration:300,zoom:F.getZoom()+(C.shiftKey?-1:1),around:F.unproject(R)},{originalEvent:C})}}},$a.prototype.enable=function(){this._enabled=!0},$a.prototype.disable=function(){this._enabled=!1,this.reset()},$a.prototype.isEnabled=function(){return this._enabled},$a.prototype.isActive=function(){return this._active};var aa=function(){this._tap=new ki({numTouches:1,numTaps:1}),this.reset()};aa.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},aa.prototype.touchstart=function(C,R,F){this._swipePoint||(this._tapTime&&C.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?F.length>0&&(this._swipePoint=R[0],this._swipeTouch=F[0].identifier):this._tap.touchstart(C,R,F))},aa.prototype.touchmove=function(C,R,F){if(this._tapTime){if(this._swipePoint){if(F[0].identifier!==this._swipeTouch)return;var q=R[0],ae=q.y-this._swipePoint.y;return this._swipePoint=q,C.preventDefault(),this._active=!0,{zoomDelta:ae/128}}}else this._tap.touchmove(C,R,F)},aa.prototype.touchend=function(C,R,F){this._tapTime?this._swipePoint&&F.length===0&&this.reset():this._tap.touchend(C,R,F)&&(this._tapTime=C.timeStamp)},aa.prototype.touchcancel=function(){this.reset()},aa.prototype.enable=function(){this._enabled=!0},aa.prototype.disable=function(){this._enabled=!1,this.reset()},aa.prototype.isEnabled=function(){return this._enabled},aa.prototype.isActive=function(){return this._active};var bo=function(C,R,F){this._el=C,this._mousePan=R,this._touchPan=F};bo.prototype.enable=function(C){this._inertiaOptions=C||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},bo.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},bo.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},bo.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var oa=function(C,R,F){this._pitchWithRotate=C.pitchWithRotate,this._mouseRotate=R,this._mousePitch=F};oa.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},oa.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},oa.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},oa.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var co=function(C,R,F,q){this._el=C,this._touchZoom=R,this._touchRotate=F,this._tapDragZoom=q,this._rotationDisabled=!1,this._enabled=!0};co.prototype.enable=function(C){this._touchZoom.enable(C),this._rotationDisabled||this._touchRotate.enable(C),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},co.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},co.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},co.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},co.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},co.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var bs=function(C){return C.zoom||C.drag||C.pitch||C.rotate},ps=function(C){function R(){C.apply(this,arguments)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R}(e.Event);function ol(C){return C.panDelta&&C.panDelta.mag()||C.zoomDelta||C.bearingDelta||C.pitchDelta}var Ua=function(C,R){this._map=C,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Sn(C),this._bearingSnap=R.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(R),e.bindAll(["handleEvent","handleWindowEvent"],this);var F=this._el;this._listeners=[[F,"touchstart",{passive:!1}],[F,"touchmove",{passive:!1}],[F,"touchend",void 0],[F,"touchcancel",void 0],[F,"mousedown",void 0],[F,"mousemove",void 0],[F,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[F,"mouseover",void 0],[F,"mouseout",void 0],[F,"dblclick",void 0],[F,"click",void 0],[F,"keydown",{capture:!1}],[F,"keyup",void 0],[F,"wheel",{passive:!1}],[F,"contextmenu",void 0],[e.window,"blur",void 0]];for(var q=0,ae=this._listeners;q<ae.length;q+=1){var he=ae[q],be=he[0],Ae=he[1],Ce=he[2];n.addEventListener(be,Ae,be===e.window.document?this.handleWindowEvent:this.handleEvent,Ce)}};Ua.prototype.destroy=function(){for(var C=0,R=this._listeners;C<R.length;C+=1){var F=R[C],q=F[0],ae=F[1],he=F[2];n.removeEventListener(q,ae,q===e.window.document?this.handleWindowEvent:this.handleEvent,he)}},Ua.prototype._addDefaultHandlers=function(C){var R=this._map,F=R.getCanvasContainer();this._add("mapEvent",new Qr(R,C));var q=R.boxZoom=new Dn(R,C);this._add("boxZoom",q);var ae=new Pi,he=new $a;R.doubleClickZoom=new La(he,ae),this._add("tapZoom",ae),this._add("clickZoom",he);var be=new aa;this._add("tapDragZoom",be);var Ae=R.touchPitch=new Mo;this._add("touchPitch",Ae);var Ce=new Ci(C),qe=new gi(C);R.dragRotate=new oa(C,Ce,qe),this._add("mouseRotate",Ce,["mousePitch"]),this._add("mousePitch",qe,["mouseRotate"]);var et=new Ri(C),st=new Fi(C);R.dragPan=new bo(F,et,st),this._add("mousePan",et),this._add("touchPan",st,["touchZoom","touchRotate"]);var kt=new is,Pt=new Ki;R.touchZoomRotate=new co(F,Pt,kt,be),this._add("touchRotate",kt,["touchPan","touchZoom"]),this._add("touchZoom",Pt,["touchPan","touchRotate"]);var Et=R.scrollZoom=new Ji(R,this);this._add("scrollZoom",Et,["mousePan"]);var Lt=R.keyboard=new xa;this._add("keyboard",Lt),this._add("blockableMapEvent",new ii(R));for(var Tt=0,Bt=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Tt<Bt.length;Tt+=1){var zt=Bt[Tt];C.interactive&&C[zt]&&R[zt].enable(C[zt])}},Ua.prototype._add=function(C,R,F){this._handlers.push({handlerName:C,handler:R,allowed:F}),this._handlersById[C]=R},Ua.prototype.stop=function(){if(!this._updatingCamera){for(var C=0,R=this._handlers;C<R.length;C+=1)R[C].handler.reset();this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},Ua.prototype.isActive=function(){for(var C=0,R=this._handlers;C<R.length;C+=1)if(R[C].handler.isActive())return!0;return!1},Ua.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Ua.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Ua.prototype.isMoving=function(){return Boolean(bs(this._eventsInProgress))||this.isZooming()},Ua.prototype._blockedByActive=function(C,R,F){for(var q in C)if(q!==F&&(!R||R.indexOf(q)<0))return!0;return!1},Ua.prototype.handleWindowEvent=function(C){this.handleEvent(C,C.type+"Window")},Ua.prototype._getMapTouches=function(C){for(var R=[],F=0,q=C;F<q.length;F+=1){var ae=q[F],he=ae.target;this._el.contains(he)&&R.push(ae)}return R},Ua.prototype.handleEvent=function(C,R){if(C.type!=="blur"){this._updatingCamera=!0;for(var F=C.type==="renderFrame"?void 0:C,q={needsRenderFrame:!1},ae={},he={},be=C.touches?this._getMapTouches(C.touches):void 0,Ae=be?n.touchPos(this._el,be):n.mousePos(this._el,C),Ce=0,qe=this._handlers;Ce<qe.length;Ce+=1){var et=qe[Ce],st=et.handlerName,kt=et.handler,Pt=et.allowed;if(kt.isEnabled()){var Et=void 0;this._blockedByActive(he,Pt,st)?kt.reset():kt[R||C.type]&&(Et=kt[R||C.type](C,Ae,be),this.mergeHandlerResult(q,ae,Et,st,F),Et&&Et.needsRenderFrame&&this._triggerRenderFrame()),(Et||kt.isActive())&&(he[st]=kt)}}var Lt={};for(var Tt in this._previousActiveHandlers)he[Tt]||(Lt[Tt]=F);this._previousActiveHandlers=he,(Object.keys(Lt).length||ol(q))&&(this._changes.push([q,ae,Lt]),this._triggerRenderFrame()),(Object.keys(he).length||ol(q))&&this._map._stop(!0),this._updatingCamera=!1;var Bt=q.cameraAnimation;Bt&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],Bt(this._map))}else this.stop()},Ua.prototype.mergeHandlerResult=function(C,R,F,q,ae){if(F){e.extend(C,F);var he={handlerName:q,originalEvent:F.originalEvent||ae};F.zoomDelta!==void 0&&(R.zoom=he),F.panDelta!==void 0&&(R.drag=he),F.pitchDelta!==void 0&&(R.pitch=he),F.bearingDelta!==void 0&&(R.rotate=he)}},Ua.prototype._applyChanges=function(){for(var C={},R={},F={},q=0,ae=this._changes;q<ae.length;q+=1){var he=ae[q],be=he[0],Ae=he[1],Ce=he[2];be.panDelta&&(C.panDelta=(C.panDelta||new e.Point(0,0))._add(be.panDelta)),be.zoomDelta&&(C.zoomDelta=(C.zoomDelta||0)+be.zoomDelta),be.bearingDelta&&(C.bearingDelta=(C.bearingDelta||0)+be.bearingDelta),be.pitchDelta&&(C.pitchDelta=(C.pitchDelta||0)+be.pitchDelta),be.around!==void 0&&(C.around=be.around),be.pinchAround!==void 0&&(C.pinchAround=be.pinchAround),be.noInertia&&(C.noInertia=be.noInertia),e.extend(R,Ae),e.extend(F,Ce)}this._updateMapTransform(C,R,F),this._changes=[]},Ua.prototype._updateMapTransform=function(C,R,F){var q=this._map,ae=q.transform;if(!ol(C))return this._fireEvents(R,F);var he=C.panDelta,be=C.zoomDelta,Ae=C.bearingDelta,Ce=C.pitchDelta,qe=C.around,et=C.pinchAround;et!==void 0&&(qe=et),q._stop(!0),qe=qe||q.transform.centerPoint;var st=ae.pointLocation(he?qe.sub(he):qe);Ae&&(ae.bearing+=Ae),Ce&&(ae.pitch+=Ce),be&&(ae.zoom+=be),ae.setLocationAtPoint(st,qe),this._map._update(),C.noInertia||this._inertia.record(C),this._fireEvents(R,F)},Ua.prototype._fireEvents=function(C,R){var F=this,q=bs(this._eventsInProgress),ae=bs(C),he={};for(var be in C){var Ae=C[be].originalEvent;this._eventsInProgress[be]||(he[be+"start"]=Ae),this._eventsInProgress[be]=C[be]}for(var Ce in!q&&ae&&this._fireEvent("movestart",ae.originalEvent),he)this._fireEvent(Ce,he[Ce]);for(var qe in C.rotate&&(this._bearingChanged=!0),ae&&this._fireEvent("move",ae.originalEvent),C){var et=C[qe].originalEvent;this._fireEvent(qe,et)}var st,kt={};for(var Pt in this._eventsInProgress){var Et=this._eventsInProgress[Pt],Lt=Et.handlerName,Tt=Et.originalEvent;this._handlersById[Lt].isActive()||(delete this._eventsInProgress[Pt],st=R[Lt]||Tt,kt[Pt+"end"]=st)}for(var Bt in kt)this._fireEvent(Bt,kt[Bt]);var zt=bs(this._eventsInProgress);if((q||ae)&&!zt){this._updatingCamera=!0;var Ht=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),lr=function(br){return br!==0&&-F._bearingSnap<br&&br<F._bearingSnap};Ht?(lr(Ht.bearing||this._map.getBearing())&&(Ht.bearing=0),this._map.easeTo(Ht,{originalEvent:st})):(this._map.fire(new e.Event("moveend",{originalEvent:st})),lr(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},Ua.prototype._fireEvent=function(C,R){this._map.fire(new e.Event(C,R?{originalEvent:R}:{}))},Ua.prototype._triggerRenderFrame=function(){var C=this;this._frameId===void 0&&(this._frameId=this._map._requestRenderFrame(function(R){delete C._frameId,C.handleEvent(new ps("renderFrame",{timeStamp:R})),C._applyChanges()}))};var sl=function(C){function R(F,q){C.call(this),this._moving=!1,this._zooming=!1,this.transform=F,this._bearingSnap=q.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.getCenter=function(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)},R.prototype.setCenter=function(F,q){return this.jumpTo({center:F},q)},R.prototype.panBy=function(F,q,ae){return F=e.Point.convert(F).mult(-1),this.panTo(this.transform.center,e.extend({offset:F},q),ae)},R.prototype.panTo=function(F,q,ae){return this.easeTo(e.extend({center:F},q),ae)},R.prototype.getZoom=function(){return this.transform.zoom},R.prototype.setZoom=function(F,q){return this.jumpTo({zoom:F},q),this},R.prototype.zoomTo=function(F,q,ae){return this.easeTo(e.extend({zoom:F},q),ae)},R.prototype.zoomIn=function(F,q){return this.zoomTo(this.getZoom()+1,F,q),this},R.prototype.zoomOut=function(F,q){return this.zoomTo(this.getZoom()-1,F,q),this},R.prototype.getBearing=function(){return this.transform.bearing},R.prototype.setBearing=function(F,q){return this.jumpTo({bearing:F},q),this},R.prototype.getPadding=function(){return this.transform.padding},R.prototype.setPadding=function(F,q){return this.jumpTo({padding:F},q),this},R.prototype.rotateTo=function(F,q,ae){return this.easeTo(e.extend({bearing:F},q),ae)},R.prototype.resetNorth=function(F,q){return this.rotateTo(0,e.extend({duration:1e3},F),q),this},R.prototype.resetNorthPitch=function(F,q){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},F),q),this},R.prototype.snapToNorth=function(F,q){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(F,q):this},R.prototype.getPitch=function(){return this.transform.pitch},R.prototype.setPitch=function(F,q){return this.jumpTo({pitch:F},q),this},R.prototype.cameraForBounds=function(F,q){return F=e.LngLatBounds.convert(F),this._cameraForBoxAndBearing(F.getNorthWest(),F.getSouthEast(),0,q)},R.prototype._cameraForBoxAndBearing=function(F,q,ae,he){var be={top:0,bottom:0,right:0,left:0};if(typeof(he=e.extend({padding:be,offset:[0,0],maxZoom:this.transform.maxZoom},he)).padding=="number"){var Ae=he.padding;he.padding={top:Ae,bottom:Ae,right:Ae,left:Ae}}he.padding=e.extend(be,he.padding);var Ce=this.transform,qe=Ce.padding,et=Ce.project(e.LngLat.convert(F)),st=Ce.project(e.LngLat.convert(q)),kt=et.rotate(-ae*Math.PI/180),Pt=st.rotate(-ae*Math.PI/180),Et=new e.Point(Math.max(kt.x,Pt.x),Math.max(kt.y,Pt.y)),Lt=new e.Point(Math.min(kt.x,Pt.x),Math.min(kt.y,Pt.y)),Tt=Et.sub(Lt),Bt=(Ce.width-(qe.left+qe.right+he.padding.left+he.padding.right))/Tt.x,zt=(Ce.height-(qe.top+qe.bottom+he.padding.top+he.padding.bottom))/Tt.y;if(!(zt<0||Bt<0)){var Ht=Math.min(Ce.scaleZoom(Ce.scale*Math.min(Bt,zt)),he.maxZoom),lr=e.Point.convert(he.offset),br=(he.padding.left-he.padding.right)/2,zr=(he.padding.top-he.padding.bottom)/2,Or=new e.Point(lr.x+br,lr.y+zr).mult(Ce.scale/Ce.zoomScale(Ht));return{center:Ce.unproject(et.add(st).div(2).sub(Or)),zoom:Ht,bearing:ae}}e.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},R.prototype.fitBounds=function(F,q,ae){return this._fitInternal(this.cameraForBounds(F,q),q,ae)},R.prototype.fitScreenCoordinates=function(F,q,ae,he,be){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(e.Point.convert(F)),this.transform.pointLocation(e.Point.convert(q)),ae,he),he,be)},R.prototype._fitInternal=function(F,q,ae){return F?(delete(q=e.extend(F,q)).padding,q.linear?this.easeTo(q,ae):this.flyTo(q,ae)):this},R.prototype.jumpTo=function(F,q){this.stop();var ae=this.transform,he=!1,be=!1,Ae=!1;return"zoom"in F&&ae.zoom!==+F.zoom&&(he=!0,ae.zoom=+F.zoom),F.center!==void 0&&(ae.center=e.LngLat.convert(F.center)),"bearing"in F&&ae.bearing!==+F.bearing&&(be=!0,ae.bearing=+F.bearing),"pitch"in F&&ae.pitch!==+F.pitch&&(Ae=!0,ae.pitch=+F.pitch),F.padding==null||ae.isPaddingEqual(F.padding)||(ae.padding=F.padding),this.fire(new e.Event("movestart",q)).fire(new e.Event("move",q)),he&&this.fire(new e.Event("zoomstart",q)).fire(new e.Event("zoom",q)).fire(new e.Event("zoomend",q)),be&&this.fire(new e.Event("rotatestart",q)).fire(new e.Event("rotate",q)).fire(new e.Event("rotateend",q)),Ae&&this.fire(new e.Event("pitchstart",q)).fire(new e.Event("pitch",q)).fire(new e.Event("pitchend",q)),this.fire(new e.Event("moveend",q))},R.prototype.easeTo=function(F,q){var ae=this;this._stop(!1,F.easeId),((F=e.extend({offset:[0,0],duration:500,easing:e.ease},F)).animate===!1||!F.essential&&e.browser.prefersReducedMotion)&&(F.duration=0);var he=this.transform,be=this.getZoom(),Ae=this.getBearing(),Ce=this.getPitch(),qe=this.getPadding(),et="zoom"in F?+F.zoom:be,st="bearing"in F?this._normalizeBearing(F.bearing,Ae):Ae,kt="pitch"in F?+F.pitch:Ce,Pt="padding"in F?F.padding:he.padding,Et=e.Point.convert(F.offset),Lt=he.centerPoint.add(Et),Tt=he.pointLocation(Lt),Bt=e.LngLat.convert(F.center||Tt);this._normalizeCenter(Bt);var zt,Ht,lr=he.project(Tt),br=he.project(Bt).sub(lr),zr=he.zoomScale(et-be);F.around&&(zt=e.LngLat.convert(F.around),Ht=he.locationPoint(zt));var Or={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||et!==be,this._rotating=this._rotating||Ae!==st,this._pitching=this._pitching||kt!==Ce,this._padding=!he.isPaddingEqual(Pt),this._easeId=F.easeId,this._prepareEase(q,F.noMoveStart,Or),clearTimeout(this._easeEndTimeoutID),this._ease(function(tn){if(ae._zooming&&(he.zoom=e.number(be,et,tn)),ae._rotating&&(he.bearing=e.number(Ae,st,tn)),ae._pitching&&(he.pitch=e.number(Ce,kt,tn)),ae._padding&&(he.interpolatePadding(qe,Pt,tn),Lt=he.centerPoint.add(Et)),zt)he.setLocationAtPoint(zt,Ht);else{var en=he.zoomScale(he.zoom-be),vn=et>be?Math.min(2,zr):Math.max(.5,zr),hn=Math.pow(vn,1-tn),Hn=he.unproject(lr.add(br.mult(tn*hn)).mult(en));he.setLocationAtPoint(he.renderWorldCopies?Hn.wrap():Hn,Lt)}ae._fireMoveEvents(q)},function(tn){ae._afterEase(q,tn)},F),this},R.prototype._prepareEase=function(F,q,ae){ae===void 0&&(ae={}),this._moving=!0,q||ae.moving||this.fire(new e.Event("movestart",F)),this._zooming&&!ae.zooming&&this.fire(new e.Event("zoomstart",F)),this._rotating&&!ae.rotating&&this.fire(new e.Event("rotatestart",F)),this._pitching&&!ae.pitching&&this.fire(new e.Event("pitchstart",F))},R.prototype._fireMoveEvents=function(F){this.fire(new e.Event("move",F)),this._zooming&&this.fire(new e.Event("zoom",F)),this._rotating&&this.fire(new e.Event("rotate",F)),this._pitching&&this.fire(new e.Event("pitch",F))},R.prototype._afterEase=function(F,q){if(!this._easeId||!q||this._easeId!==q){delete this._easeId;var ae=this._zooming,he=this._rotating,be=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,ae&&this.fire(new e.Event("zoomend",F)),he&&this.fire(new e.Event("rotateend",F)),be&&this.fire(new e.Event("pitchend",F)),this.fire(new e.Event("moveend",F))}},R.prototype.flyTo=function(F,q){var ae=this;if(!F.essential&&e.browser.prefersReducedMotion){var he=e.pick(F,["center","zoom","bearing","pitch","around"]);return this.jumpTo(he,q)}this.stop(),F=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},F);var be=this.transform,Ae=this.getZoom(),Ce=this.getBearing(),qe=this.getPitch(),et=this.getPadding(),st="zoom"in F?e.clamp(+F.zoom,be.minZoom,be.maxZoom):Ae,kt="bearing"in F?this._normalizeBearing(F.bearing,Ce):Ce,Pt="pitch"in F?+F.pitch:qe,Et="padding"in F?F.padding:be.padding,Lt=be.zoomScale(st-Ae),Tt=e.Point.convert(F.offset),Bt=be.centerPoint.add(Tt),zt=be.pointLocation(Bt),Ht=e.LngLat.convert(F.center||zt);this._normalizeCenter(Ht);var lr=be.project(zt),br=be.project(Ht).sub(lr),zr=F.curve,Or=Math.max(be.width,be.height),tn=Or/Lt,en=br.mag();if("minZoom"in F){var vn=e.clamp(Math.min(F.minZoom,Ae,st),be.minZoom,be.maxZoom),hn=Or/be.zoomScale(vn-Ae);zr=Math.sqrt(hn/en*2)}var Hn=zr*zr;function Kn(ri){var _i=(tn*tn-Or*Or+(ri?-1:1)*Hn*Hn*en*en)/(2*(ri?tn:Or)*Hn*en);return Math.log(Math.sqrt(_i*_i+1)-_i)}function hi(ri){return(Math.exp(ri)-Math.exp(-ri))/2}function Kr(ri){return(Math.exp(ri)+Math.exp(-ri))/2}var Ln=Kn(0),Jn=function(ri){return Kr(Ln)/Kr(Ln+zr*ri)},Wn=function(ri){return Or*((Kr(Ln)*(hi(_i=Ln+zr*ri)/Kr(_i))-hi(Ln))/Hn)/en;var _i},oi=(Kn(1)-Ln)/zr;if(Math.abs(en)<1e-6||!isFinite(oi)){if(Math.abs(Or-tn)<1e-6)return this.easeTo(F,q);var di=tn<Or?-1:1;oi=Math.abs(Math.log(tn/Or))/zr,Wn=function(){return 0},Jn=function(ri){return Math.exp(di*zr*ri)}}if("duration"in F)F.duration=+F.duration;else{var Li="screenSpeed"in F?+F.screenSpeed/zr:+F.speed;F.duration=1e3*oi/Li}return F.maxDuration&&F.duration>F.maxDuration&&(F.duration=0),this._zooming=!0,this._rotating=Ce!==kt,this._pitching=Pt!==qe,this._padding=!be.isPaddingEqual(Et),this._prepareEase(q,!1),this._ease(function(ri){var _i=ri*oi,yi=1/Jn(_i);be.zoom=ri===1?st:Ae+be.scaleZoom(yi),ae._rotating&&(be.bearing=e.number(Ce,kt,ri)),ae._pitching&&(be.pitch=e.number(qe,Pt,ri)),ae._padding&&(be.interpolatePadding(et,Et,ri),Bt=be.centerPoint.add(Tt));var Ii=ri===1?Ht:be.unproject(lr.add(br.mult(Wn(_i))).mult(yi));be.setLocationAtPoint(be.renderWorldCopies?Ii.wrap():Ii,Bt),ae._fireMoveEvents(q)},function(){return ae._afterEase(q)},F),this},R.prototype.isEasing=function(){return!!this._easeFrameId},R.prototype.stop=function(){return this._stop()},R.prototype._stop=function(F,q){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var ae=this._onEaseEnd;delete this._onEaseEnd,ae.call(this,q)}if(!F){var he=this.handlers;he&&he.stop()}return this},R.prototype._ease=function(F,q,ae){ae.animate===!1||ae.duration===0?(F(1),q()):(this._easeStart=e.browser.now(),this._easeOptions=ae,this._onEaseFrame=F,this._onEaseEnd=q,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},R.prototype._renderFrameCallback=function(){var F=Math.min((e.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(F)),F<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},R.prototype._normalizeBearing=function(F,q){F=e.wrap(F,-180,180);var ae=Math.abs(F-q);return Math.abs(F-360-q)<ae&&(F-=360),Math.abs(F+360-q)<ae&&(F+=360),F},R.prototype._normalizeCenter=function(F){var q=this.transform;if(q.renderWorldCopies&&!q.lngRange){var ae=F.lng-q.center.lng;F.lng+=ae>180?-360:ae<-180?360:0}},R}(e.Evented),Va=function(C){C===void 0&&(C={}),this.options=C,e.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Va.prototype.getDefaultPosition=function(){return"bottom-right"},Va.prototype.onAdd=function(C){var R=this.options&&this.options.compact;return this._map=C,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=n.create("div","mapboxgl-ctrl-attrib-inner",this._container),R&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),R===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Va.prototype.onRemove=function(){n.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Va.prototype._updateEditLink=function(){var C=this._editLink;C||(C=this._editLink=this._container.querySelector(".mapbox-improve-map"));var R=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(C){var F=R.reduce(function(q,ae,he){return ae.value&&(q+=ae.key+"="+ae.value+(he<R.length-1?"&":"")),q},"?");C.href=e.config.FEEDBACK_URL+"/"+F+(this._map._hash?this._map._hash.getHashString(!0):""),C.rel="noopener nofollow"}},Va.prototype._updateData=function(C){!C||C.sourceDataType!=="metadata"&&C.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Va.prototype._updateAttributions=function(){if(this._map.style){var C=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?C=C.concat(this.options.customAttribution.map(function(Ae){return typeof Ae!="string"?"":Ae})):typeof this.options.customAttribution=="string"&&C.push(this.options.customAttribution)),this._map.style.stylesheet){var R=this._map.style.stylesheet;this.styleOwner=R.owner,this.styleId=R.id}var F=this._map.style.sourceCaches;for(var q in F){var ae=F[q];if(ae.used){var he=ae.getSource();he.attribution&&C.indexOf(he.attribution)<0&&C.push(he.attribution)}}C.sort(function(Ae,Ce){return Ae.length-Ce.length});var be=(C=C.filter(function(Ae,Ce){for(var qe=Ce+1;qe<C.length;qe++)if(C[qe].indexOf(Ae)>=0)return!1;return!0})).join(" | ");be!==this._attribHTML&&(this._attribHTML=be,C.length?(this._innerContainer.innerHTML=be,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Va.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var ds=function(){e.bindAll(["_updateLogo"],this),e.bindAll(["_updateCompact"],this)};ds.prototype.onAdd=function(C){this._map=C,this._container=n.create("div","mapboxgl-ctrl");var R=n.create("a","mapboxgl-ctrl-logo");return R.target="_blank",R.rel="noopener nofollow",R.href="https://www.mapbox.com/",R.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),R.setAttribute("rel","noopener nofollow"),this._container.appendChild(R),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ds.prototype.onRemove=function(){n.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ds.prototype.getDefaultPosition=function(){return"bottom-left"},ds.prototype._updateLogo=function(C){C&&C.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},ds.prototype._logoRequired=function(){if(this._map.style){var C=this._map.style.sourceCaches;for(var R in C)if(C[R].getSource().mapbox_logo)return!0;return!1}},ds.prototype._updateCompact=function(){var C=this._container.children;if(C.length){var R=C[0];this._map.getCanvasContainer().offsetWidth<250?R.classList.add("mapboxgl-compact"):R.classList.remove("mapboxgl-compact")}};var fi=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};fi.prototype.add=function(C){var R=++this._id;return this._queue.push({callback:C,id:R,cancelled:!1}),R},fi.prototype.remove=function(C){for(var R=this._currentlyRunning,F=0,q=R?this._queue.concat(R):this._queue;F<q.length;F+=1){var ae=q[F];if(ae.id===C)return void(ae.cancelled=!0)}},fi.prototype.run=function(C){C===void 0&&(C=0);var R=this._currentlyRunning=this._queue;this._queue=[];for(var F=0,q=R;F<q.length;F+=1){var ae=q[F];if(!ae.cancelled&&(ae.callback(C),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},fi.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var bi={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},ll=e.window.HTMLImageElement,cl=e.window.HTMLElement,ms=e.window.ImageBitmap,No={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},Qo=function(C){function R(q){var ae=this;if((q=e.extend({},No,q)).minZoom!=null&&q.maxZoom!=null&&q.minZoom>q.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(q.minPitch!=null&&q.maxPitch!=null&&q.minPitch>q.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(q.minPitch!=null&&q.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(q.maxPitch!=null&&q.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var he=new Yt(q.minZoom,q.maxZoom,q.minPitch,q.maxPitch,q.renderWorldCopies);if(C.call(this,he,q),this._interactive=q.interactive,this._maxTileCacheSize=q.maxTileCacheSize,this._failIfMajorPerformanceCaveat=q.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=q.preserveDrawingBuffer,this._antialias=q.antialias,this._trackResize=q.trackResize,this._bearingSnap=q.bearingSnap,this._refreshExpiredTiles=q.refreshExpiredTiles,this._fadeDuration=q.fadeDuration,this._crossSourceCollisions=q.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=q.collectResourceTiming,this._renderTaskQueue=new fi,this._controls=[],this._mapId=e.uniqueId(),this._locale=e.extend({},bi,q.locale),this._requestManager=new e.RequestManager(q.transformRequest,q.accessToken),typeof q.container=="string"){if(this._container=e.window.document.getElementById(q.container),!this._container)throw new Error("Container '"+q.container+"' not found.")}else{if(!(q.container instanceof cl))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=q.container}if(q.maxBounds&&this.setMaxBounds(q.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return ae._update(!1)}),this.on("moveend",function(){return ae._update(!1)}),this.on("zoom",function(){return ae._update(!0)}),e.window!==void 0&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new Ua(this,q);var be=typeof q.hash=="string"&&q.hash||void 0;this._hash=q.hash&&new Nr(be).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:q.center,zoom:q.zoom,bearing:q.bearing,pitch:q.pitch}),q.bounds&&(this.resize(),this.fitBounds(q.bounds,e.extend({},q.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=q.localIdeographFontFamily,q.style&&this.setStyle(q.style,{localIdeographFontFamily:q.localIdeographFontFamily}),q.attributionControl&&this.addControl(new Va({customAttribution:q.customAttribution})),this.addControl(new ds,q.logoPosition),this.on("style.load",function(){ae.transform.unmodified&&ae.jumpTo(ae.style.stylesheet)}),this.on("data",function(Ae){ae._update(Ae.dataType==="style"),ae.fire(new e.Event(Ae.dataType+"data",Ae))}),this.on("dataloading",function(Ae){ae.fire(new e.Event(Ae.dataType+"dataloading",Ae))})}C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R;var F={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return R.prototype._getMapId=function(){return this._mapId},R.prototype.addControl=function(q,ae){if(ae===void 0&&q.getDefaultPosition&&(ae=q.getDefaultPosition()),ae===void 0&&(ae="top-right"),!q||!q.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var he=q.onAdd(this);this._controls.push(q);var be=this._controlPositions[ae];return ae.indexOf("bottom")!==-1?be.insertBefore(he,be.firstChild):be.appendChild(he),this},R.prototype.removeControl=function(q){if(!q||!q.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var ae=this._controls.indexOf(q);return ae>-1&&this._controls.splice(ae,1),q.onRemove(this),this},R.prototype.resize=function(q){var ae=this._containerDimensions(),he=ae[0],be=ae[1];this._resizeCanvas(he,be),this.transform.resize(he,be),this.painter.resize(he,be);var Ae=!this._moving;return Ae&&(this.stop(),this.fire(new e.Event("movestart",q)).fire(new e.Event("move",q))),this.fire(new e.Event("resize",q)),Ae&&this.fire(new e.Event("moveend",q)),this},R.prototype.getBounds=function(){return this.transform.getBounds()},R.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},R.prototype.setMaxBounds=function(q){return this.transform.setMaxBounds(e.LngLatBounds.convert(q)),this._update()},R.prototype.setMinZoom=function(q){if((q=q==null?-2:q)>=-2&&q<=this.transform.maxZoom)return this.transform.minZoom=q,this._update(),this.getZoom()<q&&this.setZoom(q),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},R.prototype.getMinZoom=function(){return this.transform.minZoom},R.prototype.setMaxZoom=function(q){if((q=q==null?22:q)>=this.transform.minZoom)return this.transform.maxZoom=q,this._update(),this.getZoom()>q&&this.setZoom(q),this;throw new Error("maxZoom must be greater than the current minZoom")},R.prototype.getMaxZoom=function(){return this.transform.maxZoom},R.prototype.setMinPitch=function(q){if((q=q==null?0:q)<0)throw new Error("minPitch must be greater than or equal to 0");if(q>=0&&q<=this.transform.maxPitch)return this.transform.minPitch=q,this._update(),this.getPitch()<q&&this.setPitch(q),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},R.prototype.getMinPitch=function(){return this.transform.minPitch},R.prototype.setMaxPitch=function(q){if((q=q==null?60:q)>60)throw new Error("maxPitch must be less than or equal to 60");if(q>=this.transform.minPitch)return this.transform.maxPitch=q,this._update(),this.getPitch()>q&&this.setPitch(q),this;throw new Error("maxPitch must be greater than the current minPitch")},R.prototype.getMaxPitch=function(){return this.transform.maxPitch},R.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},R.prototype.setRenderWorldCopies=function(q){return this.transform.renderWorldCopies=q,this._update()},R.prototype.project=function(q){return this.transform.locationPoint(e.LngLat.convert(q))},R.prototype.unproject=function(q){return this.transform.pointLocation(e.Point.convert(q))},R.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},R.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},R.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},R.prototype._createDelegatedListener=function(q,ae,he){var be,Ae=this;if(q==="mouseenter"||q==="mouseover"){var Ce=!1;return{layer:ae,listener:he,delegates:{mousemove:function(et){var st=Ae.getLayer(ae)?Ae.queryRenderedFeatures(et.point,{layers:[ae]}):[];st.length?Ce||(Ce=!0,he.call(Ae,new Nn(q,Ae,et.originalEvent,{features:st}))):Ce=!1},mouseout:function(){Ce=!1}}}}if(q==="mouseleave"||q==="mouseout"){var qe=!1;return{layer:ae,listener:he,delegates:{mousemove:function(et){(Ae.getLayer(ae)?Ae.queryRenderedFeatures(et.point,{layers:[ae]}):[]).length?qe=!0:qe&&(qe=!1,he.call(Ae,new Nn(q,Ae,et.originalEvent)))},mouseout:function(et){qe&&(qe=!1,he.call(Ae,new Nn(q,Ae,et.originalEvent)))}}}}return{layer:ae,listener:he,delegates:(be={},be[q]=function(et){var st=Ae.getLayer(ae)?Ae.queryRenderedFeatures(et.point,{layers:[ae]}):[];st.length&&(et.features=st,he.call(Ae,et),delete et.features)},be)}},R.prototype.on=function(q,ae,he){if(he===void 0)return C.prototype.on.call(this,q,ae);var be=this._createDelegatedListener(q,ae,he);for(var Ae in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[q]=this._delegatedListeners[q]||[],this._delegatedListeners[q].push(be),be.delegates)this.on(Ae,be.delegates[Ae]);return this},R.prototype.once=function(q,ae,he){if(he===void 0)return C.prototype.once.call(this,q,ae);var be=this._createDelegatedListener(q,ae,he);for(var Ae in be.delegates)this.once(Ae,be.delegates[Ae]);return this},R.prototype.off=function(q,ae,he){var be=this;return he===void 0?C.prototype.off.call(this,q,ae):(this._delegatedListeners&&this._delegatedListeners[q]&&function(Ae){for(var Ce=Ae[q],qe=0;qe<Ce.length;qe++){var et=Ce[qe];if(et.layer===ae&&et.listener===he){for(var st in et.delegates)be.off(st,et.delegates[st]);return Ce.splice(qe,1),be}}}(this._delegatedListeners),this)},R.prototype.queryRenderedFeatures=function(q,ae){if(!this.style)return[];var he;if(ae!==void 0||q===void 0||q instanceof e.Point||Array.isArray(q)||(ae=q,q=void 0),ae=ae||{},(q=q||[[0,0],[this.transform.width,this.transform.height]])instanceof e.Point||typeof q[0]=="number")he=[e.Point.convert(q)];else{var be=e.Point.convert(q[0]),Ae=e.Point.convert(q[1]);he=[be,new e.Point(Ae.x,be.y),Ae,new e.Point(be.x,Ae.y),be]}return this.style.queryRenderedFeatures(he,ae,this.transform)},R.prototype.querySourceFeatures=function(q,ae){return this.style.querySourceFeatures(q,ae)},R.prototype.setStyle=function(q,ae){return(ae=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},ae)).diff!==!1&&ae.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&q?(this._diffStyle(q,ae),this):(this._localIdeographFontFamily=ae.localIdeographFontFamily,this._updateStyle(q,ae))},R.prototype._getUIString=function(q){var ae=this._locale[q];if(ae==null)throw new Error("Missing UI string '"+q+"'");return ae},R.prototype._updateStyle=function(q,ae){return this.style&&(this.style.setEventedParent(null),this.style._remove()),q?(this.style=new wn(this,ae||{}),this.style.setEventedParent(this,{style:this.style}),typeof q=="string"?this.style.loadURL(q):this.style.loadJSON(q),this):(delete this.style,this)},R.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new wn(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},R.prototype._diffStyle=function(q,ae){var he=this;if(typeof q=="string"){var be=this._requestManager.normalizeStyleURL(q),Ae=this._requestManager.transformRequest(be,e.ResourceType.Style);e.getJSON(Ae,function(Ce,qe){Ce?he.fire(new e.ErrorEvent(Ce)):qe&&he._updateDiff(qe,ae)})}else typeof q=="object"&&this._updateDiff(q,ae)},R.prototype._updateDiff=function(q,ae){try{this.style.setState(q)&&this._update(!0)}catch(he){e.warnOnce("Unable to perform style diff: "+(he.message||he.error||he)+".  Rebuilding the style from scratch."),this._updateStyle(q,ae)}},R.prototype.getStyle=function(){if(this.style)return this.style.serialize()},R.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():e.warnOnce("There is no style added to the map.")},R.prototype.addSource=function(q,ae){return this._lazyInitEmptyStyle(),this.style.addSource(q,ae),this._update(!0)},R.prototype.isSourceLoaded=function(q){var ae=this.style&&this.style.sourceCaches[q];if(ae!==void 0)return ae.loaded();this.fire(new e.ErrorEvent(new Error("There is no source with ID '"+q+"'")))},R.prototype.areTilesLoaded=function(){var q=this.style&&this.style.sourceCaches;for(var ae in q){var he=q[ae]._tiles;for(var be in he){var Ae=he[be];if(Ae.state!=="loaded"&&Ae.state!=="errored")return!1}}return!0},R.prototype.addSourceType=function(q,ae,he){return this._lazyInitEmptyStyle(),this.style.addSourceType(q,ae,he)},R.prototype.removeSource=function(q){return this.style.removeSource(q),this._update(!0)},R.prototype.getSource=function(q){return this.style.getSource(q)},R.prototype.addImage=function(q,ae,he){he===void 0&&(he={});var be=he.pixelRatio;be===void 0&&(be=1);var Ae=he.sdf;Ae===void 0&&(Ae=!1);var Ce=he.stretchX,qe=he.stretchY,et=he.content;if(this._lazyInitEmptyStyle(),ae instanceof ll||ms&&ae instanceof ms){var st=e.browser.getImageData(ae),kt=st.width,Pt=st.height,Et=st.data;this.style.addImage(q,{data:new e.RGBAImage({width:kt,height:Pt},Et),pixelRatio:be,stretchX:Ce,stretchY:qe,content:et,sdf:Ae,version:0})}else{if(ae.width===void 0||ae.height===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var Lt=ae.width,Tt=ae.height,Bt=ae.data,zt=ae;this.style.addImage(q,{data:new e.RGBAImage({width:Lt,height:Tt},new Uint8Array(Bt)),pixelRatio:be,stretchX:Ce,stretchY:qe,content:et,sdf:Ae,version:0,userImage:zt}),zt.onAdd&&zt.onAdd(this,q)}},R.prototype.updateImage=function(q,ae){var he=this.style.getImage(q);if(!he)return this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var be=ae instanceof ll||ms&&ae instanceof ms?e.browser.getImageData(ae):ae,Ae=be.width,Ce=be.height,qe=be.data;if(Ae===void 0||Ce===void 0)return this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(Ae!==he.data.width||Ce!==he.data.height)return this.fire(new e.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));var et=!(ae instanceof ll||ms&&ae instanceof ms);he.data.replace(qe,et),this.style.updateImage(q,he)},R.prototype.hasImage=function(q){return q?!!this.style.getImage(q):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)},R.prototype.removeImage=function(q){this.style.removeImage(q)},R.prototype.loadImage=function(q,ae){e.getImage(this._requestManager.transformRequest(q,e.ResourceType.Image),ae)},R.prototype.listImages=function(){return this.style.listImages()},R.prototype.addLayer=function(q,ae){return this._lazyInitEmptyStyle(),this.style.addLayer(q,ae),this._update(!0)},R.prototype.moveLayer=function(q,ae){return this.style.moveLayer(q,ae),this._update(!0)},R.prototype.removeLayer=function(q){return this.style.removeLayer(q),this._update(!0)},R.prototype.getLayer=function(q){return this.style.getLayer(q)},R.prototype.setLayerZoomRange=function(q,ae,he){return this.style.setLayerZoomRange(q,ae,he),this._update(!0)},R.prototype.setFilter=function(q,ae,he){return he===void 0&&(he={}),this.style.setFilter(q,ae,he),this._update(!0)},R.prototype.getFilter=function(q){return this.style.getFilter(q)},R.prototype.setPaintProperty=function(q,ae,he,be){return be===void 0&&(be={}),this.style.setPaintProperty(q,ae,he,be),this._update(!0)},R.prototype.getPaintProperty=function(q,ae){return this.style.getPaintProperty(q,ae)},R.prototype.setLayoutProperty=function(q,ae,he,be){return be===void 0&&(be={}),this.style.setLayoutProperty(q,ae,he,be),this._update(!0)},R.prototype.getLayoutProperty=function(q,ae){return this.style.getLayoutProperty(q,ae)},R.prototype.setLight=function(q,ae){return ae===void 0&&(ae={}),this._lazyInitEmptyStyle(),this.style.setLight(q,ae),this._update(!0)},R.prototype.getLight=function(){return this.style.getLight()},R.prototype.setFeatureState=function(q,ae){return this.style.setFeatureState(q,ae),this._update()},R.prototype.removeFeatureState=function(q,ae){return this.style.removeFeatureState(q,ae),this._update()},R.prototype.getFeatureState=function(q){return this.style.getFeatureState(q)},R.prototype.getContainer=function(){return this._container},R.prototype.getCanvasContainer=function(){return this._canvasContainer},R.prototype.getCanvas=function(){return this._canvas},R.prototype._containerDimensions=function(){var q=0,ae=0;return this._container&&(q=this._container.clientWidth||400,ae=this._container.clientHeight||300),[q,ae]},R.prototype._detectMissingCSS=function(){e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},R.prototype._setupContainer=function(){var q=this._container;q.classList.add("mapboxgl-map"),(this._missingCSSCanary=n.create("div","mapboxgl-canary",q)).style.visibility="hidden",this._detectMissingCSS();var ae=this._canvasContainer=n.create("div","mapboxgl-canvas-container",q);this._interactive&&ae.classList.add("mapboxgl-interactive"),this._canvas=n.create("canvas","mapboxgl-canvas",ae),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var he=this._containerDimensions();this._resizeCanvas(he[0],he[1]);var be=this._controlContainer=n.create("div","mapboxgl-control-container",q),Ae=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(Ce){Ae[Ce]=n.create("div","mapboxgl-ctrl-"+Ce,be)})},R.prototype._resizeCanvas=function(q,ae){var he=e.browser.devicePixelRatio||1;this._canvas.width=he*q,this._canvas.height=he*ae,this._canvas.style.width=q+"px",this._canvas.style.height=ae+"px"},R.prototype._setupPainter=function(){var q=e.extend({},t.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),ae=this._canvas.getContext("webgl",q)||this._canvas.getContext("experimental-webgl",q);ae?(this.painter=new zi(ae,this.transform),e.webpSupported.testSupport(ae)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))},R.prototype._contextLost=function(q){q.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:q}))},R.prototype._contextRestored=function(q){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:q}))},R.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},R.prototype._update=function(q){return this.style?(this._styleDirty=this._styleDirty||q,this._sourcesDirty=!0,this.triggerRepaint(),this):this},R.prototype._requestRenderFrame=function(q){return this._update(),this._renderTaskQueue.add(q)},R.prototype._cancelRenderFrame=function(q){this._renderTaskQueue.remove(q)},R.prototype._render=function(q){var ae,he=this,be=0,Ae=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(ae=Ae.createQueryEXT(),Ae.beginQueryEXT(Ae.TIME_ELAPSED_EXT,ae),be=e.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(q),!this._removed){var Ce=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var qe=this.transform.zoom,et=e.browser.now();this.style.zoomHistory.update(qe,et);var st=new e.EvaluationParameters(qe,{now:et,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),kt=st.crossFadingFactor();kt===1&&kt===this._crossFadingFactor||(Ce=!0,this._crossFadingFactor=kt),this.style.update(st)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&(this.style.hasTransitions()||Ce)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Pt=e.browser.now()-be;Ae.endQueryEXT(Ae.TIME_ELAPSED_EXT,ae),setTimeout(function(){var Lt=Ae.getQueryObjectEXT(ae,Ae.QUERY_RESULT_EXT)/1e6;Ae.deleteQueryEXT(ae),he.fire(new e.Event("gpu-timing-frame",{cpuTime:Pt,gpuTime:Lt}))},50)}if(this.listens("gpu-timing-layer")){var Et=this.painter.collectGpuTimers();setTimeout(function(){var Lt=he.painter.queryGpuTimers(Et);he.fire(new e.Event("gpu-timing-layer",{layerTimes:Lt}))},50)}return this._sourcesDirty||this._styleDirty||this._placementDirty||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new e.Event("idle"))),this}},R.prototype.remove=function(){this._hash&&this._hash.remove();for(var q=0,ae=this._controls;q<ae.length;q+=1)ae[q].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),e.window!==void 0&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1));var he=this.painter.context.gl.getExtension("WEBGL_lose_context");he&&he.loseContext(),Dl(this._canvasContainer),Dl(this._controlContainer),Dl(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new e.Event("remove"))},R.prototype.triggerRepaint=function(){var q=this;this.style&&!this._frame&&(this._frame=e.browser.frame(function(ae){q._frame=null,q._render(ae)}))},R.prototype._onWindowOnline=function(){this._update()},R.prototype._onWindowResize=function(q){this._trackResize&&this.resize({originalEvent:q})._update()},F.showTileBoundaries.get=function(){return!!this._showTileBoundaries},F.showTileBoundaries.set=function(q){this._showTileBoundaries!==q&&(this._showTileBoundaries=q,this._update())},F.showPadding.get=function(){return!!this._showPadding},F.showPadding.set=function(q){this._showPadding!==q&&(this._showPadding=q,this._update())},F.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},F.showCollisionBoxes.set=function(q){this._showCollisionBoxes!==q&&(this._showCollisionBoxes=q,q?this.style._generateCollisionBoxes():this._update())},F.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},F.showOverdrawInspector.set=function(q){this._showOverdrawInspector!==q&&(this._showOverdrawInspector=q,this._update())},F.repaint.get=function(){return!!this._repaint},F.repaint.set=function(q){this._repaint!==q&&(this._repaint=q,this.triggerRepaint())},F.vertices.get=function(){return!!this._vertices},F.vertices.set=function(q){this._vertices=q,this._update()},R.prototype._setCacheLimits=function(q,ae){e.setCacheLimits(q,ae)},F.version.get=function(){return e.version},Object.defineProperties(R.prototype,F),R}(sl);function Dl(C){C.parentNode&&C.parentNode.removeChild(C)}var qs={showCompass:!0,showZoom:!0,visualizePitch:!1},$i=function(C){var R=this;this.options=e.extend({},qs,C),this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(F){return F.preventDefault()}),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(F){return R._map.zoomIn({},{originalEvent:F})}),n.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(F){return R._map.zoomOut({},{originalEvent:F})}),n.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(F){R.options.visualizePitch?R._map.resetNorthPitch({},{originalEvent:F}):R._map.resetNorth({},{originalEvent:F})}),this._compassIcon=n.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};$i.prototype._updateZoomButtons=function(){var C=this._map.getZoom();this._zoomInButton.disabled=C===this._map.getMaxZoom(),this._zoomOutButton.disabled=C===this._map.getMinZoom()},$i.prototype._rotateCompassArrow=function(){var C=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=C},$i.prototype.onAdd=function(C){return this._map=C,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new sa(this._map,this._compass,this.options.visualizePitch)),this._container},$i.prototype.onRemove=function(){n.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},$i.prototype._createButton=function(C,R){var F=n.create("button",C,this._container);return F.type="button",F.addEventListener("click",R),F},$i.prototype._setButtonTitle=function(C,R){var F=this._map._getUIString("NavigationControl."+R);C.title=F,C.setAttribute("aria-label",F)};var sa=function(C,R,F){F===void 0&&(F=!1),this._clickTolerance=10,this.element=R,this.mouseRotate=new Ci({clickTolerance:C.dragRotate._mouseRotate._clickTolerance}),this.map=C,F&&(this.mousePitch=new gi({clickTolerance:C.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),n.addEventListener(R,"mousedown",this.mousedown),n.addEventListener(R,"touchstart",this.touchstart,{passive:!1}),n.addEventListener(R,"touchmove",this.touchmove),n.addEventListener(R,"touchend",this.touchend),n.addEventListener(R,"touchcancel",this.reset)};function Ls(C,R,F){if(C=new e.LngLat(C.lng,C.lat),R){var q=new e.LngLat(C.lng-360,C.lat),ae=new e.LngLat(C.lng+360,C.lat),he=F.locationPoint(C).distSqr(R);F.locationPoint(q).distSqr(R)<he?C=q:F.locationPoint(ae).distSqr(R)<he&&(C=ae)}for(;Math.abs(C.lng-F.center.lng)>180;){var be=F.locationPoint(C);if(be.x>=0&&be.y>=0&&be.x<=F.width&&be.y<=F.height)break;C.lng>F.center.lng?C.lng-=360:C.lng+=360}return C}sa.prototype.down=function(C,R){this.mouseRotate.mousedown(C,R),this.mousePitch&&this.mousePitch.mousedown(C,R),n.disableDrag()},sa.prototype.move=function(C,R){var F=this.map,q=this.mouseRotate.mousemoveWindow(C,R);if(q&&q.bearingDelta&&F.setBearing(F.getBearing()+q.bearingDelta),this.mousePitch){var ae=this.mousePitch.mousemoveWindow(C,R);ae&&ae.pitchDelta&&F.setPitch(F.getPitch()+ae.pitchDelta)}},sa.prototype.off=function(){var C=this.element;n.removeEventListener(C,"mousedown",this.mousedown),n.removeEventListener(C,"touchstart",this.touchstart,{passive:!1}),n.removeEventListener(C,"touchmove",this.touchmove),n.removeEventListener(C,"touchend",this.touchend),n.removeEventListener(C,"touchcancel",this.reset),this.offTemp()},sa.prototype.offTemp=function(){n.enableDrag(),n.removeEventListener(e.window,"mousemove",this.mousemove),n.removeEventListener(e.window,"mouseup",this.mouseup)},sa.prototype.mousedown=function(C){this.down(e.extend({},C,{ctrlKey:!0,preventDefault:function(){return C.preventDefault()}}),n.mousePos(this.element,C)),n.addEventListener(e.window,"mousemove",this.mousemove),n.addEventListener(e.window,"mouseup",this.mouseup)},sa.prototype.mousemove=function(C){this.move(C,n.mousePos(this.element,C))},sa.prototype.mouseup=function(C){this.mouseRotate.mouseupWindow(C),this.mousePitch&&this.mousePitch.mouseupWindow(C),this.offTemp()},sa.prototype.touchstart=function(C){C.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=n.touchPos(this.element,C.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return C.preventDefault()}},this._startPos))},sa.prototype.touchmove=function(C){C.targetTouches.length!==1?this.reset():(this._lastPos=n.touchPos(this.element,C.targetTouches)[0],this.move({preventDefault:function(){return C.preventDefault()}},this._lastPos))},sa.prototype.touchend=function(C){C.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},sa.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var _s={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Fa(C,R,F){var q=C.classList;for(var ae in _s)q.remove("mapboxgl-"+F+"-anchor-"+ae);q.add("mapboxgl-"+F+"-anchor-"+R)}var Cs,Gs=function(C){function R(F,q){var ae=this;if(C.call(this),(F instanceof e.window.HTMLElement||q)&&(F=e.extend({element:F},q)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=F&&F.anchor||"center",this._color=F&&F.color||"#3FB1CE",this._draggable=F&&F.draggable||!1,this._state="inactive",this._rotation=F&&F.rotation||0,this._rotationAlignment=F&&F.rotationAlignment||"auto",this._pitchAlignment=F&&F.pitchAlignment&&F.pitchAlignment!=="auto"?F.pitchAlignment:this._rotationAlignment,F&&F.element)this._element=F.element,this._offset=e.Point.convert(F&&F.offset||[0,0]);else{this._defaultMarker=!0,this._element=n.create("div"),this._element.setAttribute("aria-label","Map marker");var he=n.createNS("http://www.w3.org/2000/svg","svg");he.setAttributeNS(null,"display","block"),he.setAttributeNS(null,"height","41px"),he.setAttributeNS(null,"width","27px"),he.setAttributeNS(null,"viewBox","0 0 27 41");var be=n.createNS("http://www.w3.org/2000/svg","g");be.setAttributeNS(null,"stroke","none"),be.setAttributeNS(null,"stroke-width","1"),be.setAttributeNS(null,"fill","none"),be.setAttributeNS(null,"fill-rule","evenodd");var Ae=n.createNS("http://www.w3.org/2000/svg","g");Ae.setAttributeNS(null,"fill-rule","nonzero");var Ce=n.createNS("http://www.w3.org/2000/svg","g");Ce.setAttributeNS(null,"transform","translate(3.0, 29.0)"),Ce.setAttributeNS(null,"fill","#000000");for(var qe=0,et=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];qe<et.length;qe+=1){var st=et[qe],kt=n.createNS("http://www.w3.org/2000/svg","ellipse");kt.setAttributeNS(null,"opacity","0.04"),kt.setAttributeNS(null,"cx","10.5"),kt.setAttributeNS(null,"cy","5.80029008"),kt.setAttributeNS(null,"rx",st.rx),kt.setAttributeNS(null,"ry",st.ry),Ce.appendChild(kt)}var Pt=n.createNS("http://www.w3.org/2000/svg","g");Pt.setAttributeNS(null,"fill",this._color);var Et=n.createNS("http://www.w3.org/2000/svg","path");Et.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Pt.appendChild(Et);var Lt=n.createNS("http://www.w3.org/2000/svg","g");Lt.setAttributeNS(null,"opacity","0.25"),Lt.setAttributeNS(null,"fill","#000000");var Tt=n.createNS("http://www.w3.org/2000/svg","path");Tt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Lt.appendChild(Tt);var Bt=n.createNS("http://www.w3.org/2000/svg","g");Bt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Bt.setAttributeNS(null,"fill","#FFFFFF");var zt=n.createNS("http://www.w3.org/2000/svg","g");zt.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Ht=n.createNS("http://www.w3.org/2000/svg","circle");Ht.setAttributeNS(null,"fill","#000000"),Ht.setAttributeNS(null,"opacity","0.25"),Ht.setAttributeNS(null,"cx","5.5"),Ht.setAttributeNS(null,"cy","5.5"),Ht.setAttributeNS(null,"r","5.4999962");var lr=n.createNS("http://www.w3.org/2000/svg","circle");lr.setAttributeNS(null,"fill","#FFFFFF"),lr.setAttributeNS(null,"cx","5.5"),lr.setAttributeNS(null,"cy","5.5"),lr.setAttributeNS(null,"r","5.4999962"),zt.appendChild(Ht),zt.appendChild(lr),Ae.appendChild(Ce),Ae.appendChild(Pt),Ae.appendChild(Lt),Ae.appendChild(Bt),Ae.appendChild(zt),he.appendChild(Ae),this._element.appendChild(he),this._offset=e.Point.convert(F&&F.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(br){br.preventDefault()}),this._element.addEventListener("mousedown",function(br){br.preventDefault()}),this._element.addEventListener("focus",function(){var br=ae._map.getContainer();br.scrollTop=0,br.scrollLeft=0}),Fa(this._element,this._anchor,"marker"),this._popup=null}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.addTo=function(F){return this.remove(),this._map=F,F.getCanvasContainer().appendChild(this._element),F.on("move",this._update),F.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},R.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),n.remove(this._element),this._popup&&this._popup.remove(),this},R.prototype.getLngLat=function(){return this._lngLat},R.prototype.setLngLat=function(F){return this._lngLat=e.LngLat.convert(F),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},R.prototype.getElement=function(){return this._element},R.prototype.setPopup=function(F){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),F){if(!("offset"in F.options)){var q=Math.sqrt(Math.pow(13.5,2)/2);F.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[q,-1*(24.6+q)],"bottom-right":[-q,-1*(24.6+q)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=F,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},R.prototype._onKeyPress=function(F){var q=F.code,ae=F.charCode||F.keyCode;q!=="Space"&&q!=="Enter"&&ae!==32&&ae!==13||this.togglePopup()},R.prototype._onMapClick=function(F){var q=F.originalEvent.target,ae=this._element;this._popup&&(q===ae||ae.contains(q))&&this.togglePopup()},R.prototype.getPopup=function(){return this._popup},R.prototype.togglePopup=function(){var F=this._popup;return F?(F.isOpen()?F.remove():F.addTo(this._map),this):this},R.prototype._update=function(F){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Ls(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var q="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?q="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(q="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var ae="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?ae="rotateX(0deg)":this._pitchAlignment==="map"&&(ae="rotateX("+this._map.getPitch()+"deg)"),F&&F.type!=="moveend"||(this._pos=this._pos.round()),n.setTransform(this._element,_s[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+ae+" "+q)}},R.prototype.getOffset=function(){return this._offset},R.prototype.setOffset=function(F){return this._offset=e.Point.convert(F),this._update(),this},R.prototype._onMove=function(F){this._pos=F.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))},R.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new e.Event("dragend")),this._state="inactive"},R.prototype._addDragHandler=function(F){this._element.contains(F.originalEvent.target)&&(F.preventDefault(),this._positionDelta=F.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},R.prototype.setDraggable=function(F){return this._draggable=!!F,this._map&&(F?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},R.prototype.isDraggable=function(){return this._draggable},R.prototype.setRotation=function(F){return this._rotation=F||0,this._update(),this},R.prototype.getRotation=function(){return this._rotation},R.prototype.setRotationAlignment=function(F){return this._rotationAlignment=F||"auto",this._update(),this},R.prototype.getRotationAlignment=function(){return this._rotationAlignment},R.prototype.setPitchAlignment=function(F){return this._pitchAlignment=F&&F!=="auto"?F:this._rotationAlignment,this._update(),this},R.prototype.getPitchAlignment=function(){return this._pitchAlignment},R}(e.Evented),Rs={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Ys=0,ws=!1,zl=function(C){function R(F){C.call(this),this.options=e.extend({},Rs,F),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.onAdd=function(F){var q;return this._map=F,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),q=this._setupUI,Cs!==void 0?q(Cs):e.window.navigator.permissions!==void 0?e.window.navigator.permissions.query({name:"geolocation"}).then(function(ae){Cs=ae.state!=="denied",q(Cs)}):(Cs=!!e.window.navigator.geolocation,q(Cs)),this._container},R.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),n.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ys=0,ws=!1},R.prototype._isOutOfMapMaxBounds=function(F){var q=this._map.getMaxBounds(),ae=F.coords;return q&&(ae.longitude<q.getWest()||ae.longitude>q.getEast()||ae.latitude<q.getSouth()||ae.latitude>q.getNorth())},R.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},R.prototype._onSuccess=function(F){if(this._map){if(this._isOutOfMapMaxBounds(F))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",F)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=F,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(F),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(F),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",F)),this._finish()}},R.prototype._updateCamera=function(F){var q=new e.LngLat(F.coords.longitude,F.coords.latitude),ae=F.coords.accuracy,he=this._map.getBearing(),be=e.extend({bearing:he},this.options.fitBoundsOptions);this._map.fitBounds(q.toBounds(ae),be,{geolocateSource:!0})},R.prototype._updateMarker=function(F){if(F){var q=new e.LngLat(F.coords.longitude,F.coords.latitude);this._accuracyCircleMarker.setLngLat(q).addTo(this._map),this._userLocationDotMarker.setLngLat(q).addTo(this._map),this._accuracy=F.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},R.prototype._updateCircleRadius=function(){var F=this._map._container.clientHeight/2,q=this._map.unproject([0,F]),ae=this._map.unproject([1,F]),he=q.distanceTo(ae),be=Math.ceil(2*this._accuracy/he);this._circleElement.style.width=be+"px",this._circleElement.style.height=be+"px"},R.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},R.prototype._onError=function(F){if(this._map){if(this.options.trackUserLocation)if(F.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var q=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=q,this._geolocateButton.setAttribute("aria-label",q),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(F.code===3&&ws)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",F)),this._finish()}},R.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},R.prototype._setupUI=function(F){var q=this;if(this._container.addEventListener("contextmenu",function(be){return be.preventDefault()}),this._geolocateButton=n.create("button","mapboxgl-ctrl-geolocate",this._container),n.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",F===!1){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var ae=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=ae,this._geolocateButton.setAttribute("aria-label",ae)}else{var he=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=he,this._geolocateButton.setAttribute("aria-label",he)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=n.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Gs(this._dotElement),this._circleElement=n.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Gs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(be){var Ae=be.originalEvent&&be.originalEvent.type==="resize";be.geolocateSource||q._watchState!=="ACTIVE_LOCK"||Ae||(q._watchState="BACKGROUND",q._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),q._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),q.fire(new e.Event("trackuserlocationend")))})},R.prototype.trigger=function(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ys--,ws=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var F;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Ys>1?(F={maximumAge:6e5,timeout:0},ws=!0):(F=this.options.positionOptions,ws=!1),this._geolocationWatchID=e.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,F)}}else e.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},R.prototype._clearWatch=function(){e.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},R}(e.Evented),Jl={maxWidth:100,unit:"metric"},Ps=function(C){this.options=e.extend({},Jl,C),e.bindAll(["_onMove","setUnit"],this)};function Rl(C,R,F){var q=F&&F.maxWidth||100,ae=C._container.clientHeight/2,he=C.unproject([0,ae]),be=C.unproject([q,ae]),Ae=he.distanceTo(be);if(F&&F.unit==="imperial"){var Ce=3.2808*Ae;Ce>5280?Ws(R,q,Ce/5280,C._getUIString("ScaleControl.Miles")):Ws(R,q,Ce,C._getUIString("ScaleControl.Feet"))}else F&&F.unit==="nautical"?Ws(R,q,Ae/1852,C._getUIString("ScaleControl.NauticalMiles")):Ae>=1e3?Ws(R,q,Ae/1e3,C._getUIString("ScaleControl.Kilometers")):Ws(R,q,Ae,C._getUIString("ScaleControl.Meters"))}function Ws(C,R,F,q){var ae,he,be,Ae=(ae=F,he=Math.pow(10,(""+Math.floor(ae)).length-1),be=(be=ae/he)>=10?10:be>=5?5:be>=3?3:be>=2?2:be>=1?1:function(qe){var et=Math.pow(10,Math.ceil(-Math.log(qe)/Math.LN10));return Math.round(qe*et)/et}(be),he*be),Ce=Ae/F;C.style.width=R*Ce+"px",C.innerHTML=Ae+"&nbsp;"+q}Ps.prototype.getDefaultPosition=function(){return"bottom-left"},Ps.prototype._onMove=function(){Rl(this._map,this._container,this.options)},Ps.prototype.onAdd=function(C){return this._map=C,this._container=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",C.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Ps.prototype.onRemove=function(){n.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Ps.prototype.setUnit=function(C){this.options.unit=C,Rl(this._map,this._container,this.options)};var uo=function(C){this._fullscreen=!1,C&&C.container&&(C.container instanceof e.window.HTMLElement?this._container=C.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in e.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in e.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in e.window.document&&(this._fullscreenchange="MSFullscreenChange")};uo.prototype.onAdd=function(C){return this._map=C,this._container||(this._container=this._map.getContainer()),this._controlContainer=n.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},uo.prototype.onRemove=function(){n.remove(this._controlContainer),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},uo.prototype._checkFullscreenSupport=function(){return!!(e.window.document.fullscreenEnabled||e.window.document.mozFullScreenEnabled||e.window.document.msFullscreenEnabled||e.window.document.webkitFullscreenEnabled)},uo.prototype._setupUI=function(){var C=this._fullscreenButton=n.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);n.create("span","mapboxgl-ctrl-icon",C).setAttribute("aria-hidden",!0),C.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},uo.prototype._updateTitle=function(){var C=this._getTitle();this._fullscreenButton.setAttribute("aria-label",C),this._fullscreenButton.title=C},uo.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},uo.prototype._isFullscreen=function(){return this._fullscreen},uo.prototype._changeIcon=function(){(e.window.document.fullscreenElement||e.window.document.mozFullScreenElement||e.window.document.webkitFullscreenElement||e.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},uo.prototype._onClickFullscreen=function(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.mozCancelFullScreen?e.window.document.mozCancelFullScreen():e.window.document.msExitFullscreen?e.window.document.msExitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var $l={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},Ql=function(C){function R(F){C.call(this),this.options=e.extend(Object.create($l),F),e.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return C&&(R.__proto__=C),R.prototype=Object.create(C&&C.prototype),R.prototype.constructor=R,R.prototype.addTo=function(F){return this._map&&this.remove(),this._map=F,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new e.Event("open")),this},R.prototype.isOpen=function(){return!!this._map},R.prototype.remove=function(){return this._content&&n.remove(this._content),this._container&&(n.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new e.Event("close")),this},R.prototype.getLngLat=function(){return this._lngLat},R.prototype.setLngLat=function(F){return this._lngLat=e.LngLat.convert(F),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},R.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},R.prototype.getElement=function(){return this._container},R.prototype.setText=function(F){return this.setDOMContent(e.window.document.createTextNode(F))},R.prototype.setHTML=function(F){var q,ae=e.window.document.createDocumentFragment(),he=e.window.document.createElement("body");for(he.innerHTML=F;q=he.firstChild;)ae.appendChild(q);return this.setDOMContent(ae)},R.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},R.prototype.setMaxWidth=function(F){return this.options.maxWidth=F,this._update(),this},R.prototype.setDOMContent=function(F){return this._createContent(),this._content.appendChild(F),this._update(),this},R.prototype.addClassName=function(F){this._container&&this._container.classList.add(F)},R.prototype.removeClassName=function(F){this._container&&this._container.classList.remove(F)},R.prototype.toggleClassName=function(F){if(this._container)return this._container.classList.toggle(F)},R.prototype._createContent=function(){this._content&&n.remove(this._content),this._content=n.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=n.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},R.prototype._onMouseUp=function(F){this._update(F.point)},R.prototype._onMouseMove=function(F){this._update(F.point)},R.prototype._onDrag=function(F){this._update(F.point)},R.prototype._update=function(F){var q=this,ae=this._lngLat||this._trackPointer;if(this._map&&ae&&this._content&&(this._container||(this._container=n.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=n.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(kt){return q._container.classList.add(kt)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ls(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||F)){var he=this._pos=this._trackPointer&&F?F:this._map.project(this._lngLat),be=this.options.anchor,Ae=function kt(Pt){if(Pt){if(typeof Pt=="number"){var Et=Math.round(Math.sqrt(.5*Math.pow(Pt,2)));return{center:new e.Point(0,0),top:new e.Point(0,Pt),"top-left":new e.Point(Et,Et),"top-right":new e.Point(-Et,Et),bottom:new e.Point(0,-Pt),"bottom-left":new e.Point(Et,-Et),"bottom-right":new e.Point(-Et,-Et),left:new e.Point(Pt,0),right:new e.Point(-Pt,0)}}if(Pt instanceof e.Point||Array.isArray(Pt)){var Lt=e.Point.convert(Pt);return{center:Lt,top:Lt,"top-left":Lt,"top-right":Lt,bottom:Lt,"bottom-left":Lt,"bottom-right":Lt,left:Lt,right:Lt}}return{center:e.Point.convert(Pt.center||[0,0]),top:e.Point.convert(Pt.top||[0,0]),"top-left":e.Point.convert(Pt["top-left"]||[0,0]),"top-right":e.Point.convert(Pt["top-right"]||[0,0]),bottom:e.Point.convert(Pt.bottom||[0,0]),"bottom-left":e.Point.convert(Pt["bottom-left"]||[0,0]),"bottom-right":e.Point.convert(Pt["bottom-right"]||[0,0]),left:e.Point.convert(Pt.left||[0,0]),right:e.Point.convert(Pt.right||[0,0])}}return kt(new e.Point(0,0))}(this.options.offset);if(!be){var Ce,qe=this._container.offsetWidth,et=this._container.offsetHeight;Ce=he.y+Ae.bottom.y<et?["top"]:he.y>this._map.transform.height-et?["bottom"]:[],he.x<qe/2?Ce.push("left"):he.x>this._map.transform.width-qe/2&&Ce.push("right"),be=Ce.length===0?"bottom":Ce.join("-")}var st=he.add(Ae[be]).round();n.setTransform(this._container,_s[be]+" translate("+st.x+"px,"+st.y+"px)"),Fa(this._container,be,"popup")}},R.prototype._onClose=function(){this.remove()},R}(e.Evented),ue={version:e.version,supported:t,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:Qo,NavigationControl:$i,GeolocateControl:zl,AttributionControl:Va,ScaleControl:Ps,FullscreenControl:uo,Popup:Ql,Marker:Gs,Style:wn,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.Point,MercatorCoordinate:e.MercatorCoordinate,Evented:e.Evented,config:e.config,prewarm:function(){it().acquire(ct)},clearPrewarmedResources:function(){var C=At;C&&(C.isPreloaded()&&C.numActive()===1?(C.release(ct),At=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(C){e.config.ACCESS_TOKEN=C},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(C){e.config.API_URL=C},get workerCount(){return lt.workerCount},set workerCount(C){lt.workerCount=C},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(C){e.config.MAX_PARALLEL_IMAGE_REQUESTS=C},clearStorage:function(C){e.clearTileCache(C)},workerUrl:""};return ue}),w})},{}],240:[function(m,G,Y){G.exports=Math.log2||function(d){return Math.log(d)*Math.LOG2E}},{}],241:[function(m,G,Y){G.exports=function(v,w){w||(w=v,v=window);var y=0,e=0,t=0,n={shift:!1,alt:!1,control:!1,meta:!1},o=!1;function r(x){var f=!1;return"altKey"in x&&(f=f||x.altKey!==n.alt,n.alt=!!x.altKey),"shiftKey"in x&&(f=f||x.shiftKey!==n.shift,n.shift=!!x.shiftKey),"ctrlKey"in x&&(f=f||x.ctrlKey!==n.control,n.control=!!x.ctrlKey),"metaKey"in x&&(f=f||x.metaKey!==n.meta,n.meta=!!x.metaKey),f}function g(x,f){var _=d.x(f),b=d.y(f);"buttons"in f&&(x=0|f.buttons),(x!==y||_!==e||b!==t||r(f))&&(y=0|x,e=_||0,t=b||0,w&&w(y,e,t,n))}function c(x){g(0,x)}function a(){(y||e||t||n.shift||n.alt||n.meta||n.control)&&(e=t=0,y=0,n.shift=n.alt=n.control=n.meta=!1,w&&w(0,0,0,n))}function h(x){r(x)&&w&&w(y,e,t,n)}function l(x){d.buttons(x)===0?g(0,x):g(y,x)}function s(x){g(y|d.buttons(x),x)}function p(x){g(y&~d.buttons(x),x)}function u(){o||(o=!0,v.addEventListener("mousemove",l),v.addEventListener("mousedown",s),v.addEventListener("mouseup",p),v.addEventListener("mouseleave",c),v.addEventListener("mouseenter",c),v.addEventListener("mouseout",c),v.addEventListener("mouseover",c),v.addEventListener("blur",a),v.addEventListener("keyup",h),v.addEventListener("keydown",h),v.addEventListener("keypress",h),v!==window&&(window.addEventListener("blur",a),window.addEventListener("keyup",h),window.addEventListener("keydown",h),window.addEventListener("keypress",h)))}u();var i={element:v};return Object.defineProperties(i,{enabled:{get:function(){return o},set:function(x){x?u():function(){!o||(o=!1,v.removeEventListener("mousemove",l),v.removeEventListener("mousedown",s),v.removeEventListener("mouseup",p),v.removeEventListener("mouseleave",c),v.removeEventListener("mouseenter",c),v.removeEventListener("mouseout",c),v.removeEventListener("mouseover",c),v.removeEventListener("blur",a),v.removeEventListener("keyup",h),v.removeEventListener("keydown",h),v.removeEventListener("keypress",h),v!==window&&(window.removeEventListener("blur",a),window.removeEventListener("keyup",h),window.removeEventListener("keydown",h),window.removeEventListener("keypress",h)))}()},enumerable:!0},buttons:{get:function(){return y},enumerable:!0},x:{get:function(){return e},enumerable:!0},y:{get:function(){return t},enumerable:!0},mods:{get:function(){return n},enumerable:!0}}),i};var d=m("mouse-event")},{"mouse-event":243}],242:[function(m,G,Y){var d={left:0,top:0};G.exports=function(v,w,y){w=w||v.currentTarget||v.srcElement,Array.isArray(y)||(y=[0,0]);var e=v.clientX||0,t=v.clientY||0,n=(o=w,o===window||o===document||o===document.body?d:o.getBoundingClientRect()),o;return y[0]=e-n.left,y[1]=t-n.top,y}},{}],243:[function(m,G,Y){function d(v){return v.target||v.srcElement||window}Y.buttons=function(v){if(typeof v=="object"){if("buttons"in v)return v.buttons;if("which"in v){if((w=v.which)===2)return 4;if(w===3)return 2;if(w>0)return 1<<w-1}else if("button"in v){var w;if((w=v.button)===1)return 4;if(w===2)return 2;if(w>=0)return 1<<w}}return 0},Y.element=d,Y.x=function(v){if(typeof v=="object"){if("offsetX"in v)return v.offsetX;var w=d(v).getBoundingClientRect();return v.clientX-w.left}return 0},Y.y=function(v){if(typeof v=="object"){if("offsetY"in v)return v.offsetY;var w=d(v).getBoundingClientRect();return v.clientY-w.top}return 0}},{}],244:[function(m,G,Y){var d=m("to-px");G.exports=function(v,w,y){typeof v=="function"&&(y=!!w,w=v,v=window);var e=d("ex",v),t=function(n){y&&n.preventDefault();var o=n.deltaX||0,r=n.deltaY||0,g=n.deltaZ||0,c=1;switch(n.deltaMode){case 1:c=e;break;case 2:c=window.innerHeight}if(r*=c,g*=c,(o*=c)||r||g)return w(o,r,g,n)};return v.addEventListener("wheel",t),t}},{"to-px":315}],245:[function(m,G,Y){(function(d,v){(function(){/*! Native Promise Only
    v0.8.1 (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/(function(w,y,e){y[w]=y[w]||e(),G!==void 0&&G.exports&&(G.exports=y[w])})("Promise",d!==void 0?d:this,function(){var w,y,e,t=Object.prototype.toString,n=v!==void 0?function(x){return v(x)}:setTimeout;try{Object.defineProperty({},"x",{}),w=function(x,f,_,b){return Object.defineProperty(x,f,{value:_,writable:!0,configurable:b!==!1})}}catch{w=function(f,_,b){return f[_]=b,f}}function o(x,f){e.add(x,f),y||(y=n(e.drain))}function r(x){var f,_=typeof x;return x==null||_!="object"&&_!="function"||(f=x.then),typeof f=="function"&&f}function g(){for(var x=0;x<this.chain.length;x++)c(this,this.state===1?this.chain[x].success:this.chain[x].failure,this.chain[x]);this.chain.length=0}function c(x,f,_){var b,T;try{f===!1?_.reject(x.msg):(b=f===!0?x.msg:f.call(void 0,x.msg))===_.promise?_.reject(TypeError("Promise-chain cycle")):(T=r(b))?T.call(b,_.resolve,_.reject):_.resolve(b)}catch(k){_.reject(k)}}function a(x){var f,_=this;if(!_.triggered){_.triggered=!0,_.def&&(_=_.def);try{(f=r(x))?o(function(){var b=new s(_);try{f.call(x,function(){a.apply(b,arguments)},function(){h.apply(b,arguments)})}catch(T){h.call(b,T)}}):(_.msg=x,_.state=1,_.chain.length>0&&o(g,_))}catch(b){h.call(new s(_),b)}}}function h(x){var f=this;f.triggered||(f.triggered=!0,f.def&&(f=f.def),f.msg=x,f.state=2,f.chain.length>0&&o(g,f))}function l(x,f,_,b){for(var T=0;T<f.length;T++)(function(k){x.resolve(f[k]).then(function(L){_(k,L)},b)})(T)}function s(x){this.def=x,this.triggered=!1}function p(x){this.promise=x,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function u(x){if(typeof x!="function")throw TypeError("Not a function");if(this.__NPO__!==0)throw TypeError("Not a promise");this.__NPO__=1;var f=new p(this);this.then=function(_,b){var T={success:typeof _!="function"||_,failure:typeof b=="function"&&b};return T.promise=new this.constructor(function(k,L){if(typeof k!="function"||typeof L!="function")throw TypeError("Not a function");T.resolve=k,T.reject=L}),f.chain.push(T),f.state!==0&&o(g,f),T.promise},this.catch=function(_){return this.then(void 0,_)};try{x.call(void 0,function(_){a.call(f,_)},function(_){h.call(f,_)})}catch(_){h.call(f,_)}}e=function(){var x,f,_;function b(T,k){this.fn=T,this.self=k,this.next=void 0}return{add:function(T,k){_=new b(T,k),f?f.next=_:x=_,f=_,_=void 0},drain:function(){var T=x;for(x=f=y=void 0;T;)T.fn.call(T.self),T=T.next}}}();var i=w({},"constructor",u,!1);return u.prototype=i,w(i,"__NPO__",0,!1),w(u,"resolve",function(x){return x&&typeof x=="object"&&x.__NPO__===1?x:new this(function(f,_){if(typeof f!="function"||typeof _!="function")throw TypeError("Not a function");f(x)})}),w(u,"reject",function(x){return new this(function(f,_){if(typeof f!="function"||typeof _!="function")throw TypeError("Not a function");_(x)})}),w(u,"all",function(x){var f=this;return t.call(x)!="[object Array]"?f.reject(TypeError("Not an array")):x.length===0?f.resolve([]):new f(function(_,b){if(typeof _!="function"||typeof b!="function")throw TypeError("Not a function");var T=x.length,k=Array(T),L=0;l(f,x,function(A,I){k[A]=I,++L===T&&_(k)},b)})}),w(u,"race",function(x){var f=this;return t.call(x)!="[object Array]"?f.reject(TypeError("Not an array")):new f(function(_,b){if(typeof _!="function"||typeof b!="function")throw TypeError("Not a function");l(f,x,function(T,k){_(k)},b)})}),u})}).call(this)}).call(this,typeof Ka<"u"?Ka:typeof self<"u"?self:typeof window<"u"?window:{},m("timers").setImmediate)},{timers:312}],246:[function(m,G,Y){var d=Math.PI,v=n(120);function w(o,r,g,c){return["C",o,r,g,c,g,c]}function y(o,r,g,c,a,h){return["C",o/3+2/3*g,r/3+2/3*c,a/3+2/3*g,h/3+2/3*c,a,h]}function e(o,r,g,c,a,h,l,s,p,u){if(u)I=u[0],P=u[1],L=u[2],A=u[3];else{var i=t(o,r,-a);o=i.x,r=i.y;var x=(o-(s=(i=t(s,p,-a)).x))/2,f=(r-(p=i.y))/2,_=x*x/(g*g)+f*f/(c*c);_>1&&(g*=_=Math.sqrt(_),c*=_);var b=g*g,T=c*c,k=(h==l?-1:1)*Math.sqrt(Math.abs((b*T-b*f*f-T*x*x)/(b*f*f+T*x*x)));k==1/0&&(k=1);var L=k*g*f/c+(o+s)/2,A=k*-c*x/g+(r+p)/2,I=Math.asin(((r-A)/c).toFixed(9)),P=Math.asin(((p-A)/c).toFixed(9));(I=o<L?d-I:I)<0&&(I=2*d+I),(P=s<L?d-P:P)<0&&(P=2*d+P),l&&I>P&&(I-=2*d),!l&&P>I&&(P-=2*d)}if(Math.abs(P-I)>v){var S=P,E=s,z=p;P=I+v*(l&&P>I?1:-1);var D=e(s=L+g*Math.cos(P),p=A+c*Math.sin(P),g,c,a,0,l,E,z,[P,S,L,A])}var j=Math.tan((P-I)/4),V=4/3*g*j,Z=4/3*c*j,Q=[2*o-(o+V*Math.sin(I)),2*r-(r-Z*Math.cos(I)),s+V*Math.sin(P),p-Z*Math.cos(P),s,p];if(u)return Q;D&&(Q=Q.concat(D));for(var X=0;X<Q.length;){var $=t(Q[X],Q[X+1],a);Q[X++]=$.x,Q[X++]=$.y}return Q}function t(o,r,g){return{x:o*Math.cos(g)-r*Math.sin(g),y:o*Math.sin(g)+r*Math.cos(g)}}function n(o){return o*(d/180)}G.exports=function(o){for(var r,g=[],c=0,a=0,h=0,l=0,s=null,p=null,u=0,i=0,x=0,f=o.length;x<f;x++){var _=o[x],b=_[0];switch(b){case"M":h=_[1],l=_[2];break;case"A":(_=e(u,i,_[1],_[2],n(_[3]),_[4],_[5],_[6],_[7])).unshift("C"),_.length>7&&(g.push(_.splice(0,7)),_.unshift("C"));break;case"S":var T=u,k=i;r!="C"&&r!="S"||(T+=T-c,k+=k-a),_=["C",T,k,_[1],_[2],_[3],_[4]];break;case"T":r=="Q"||r=="T"?(s=2*u-s,p=2*i-p):(s=u,p=i),_=y(u,i,s,p,_[1],_[2]);break;case"Q":s=_[1],p=_[2],_=y(u,i,_[1],_[2],_[3],_[4]);break;case"L":_=w(u,i,_[1],_[2]);break;case"H":_=w(u,i,_[1],i);break;case"V":_=w(u,i,u,_[1]);break;case"Z":_=w(u,i,h,l)}r=b,u=_[_.length-2],i=_[_.length-1],_.length>4?(c=_[_.length-4],a=_[_.length-3]):(c=u,a=i),g.push(_)}return g}},{}],247:[function(m,G,Y){var d=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;function y(e){if(e==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}G.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de",Object.getOwnPropertyNames(e)[0]==="5")return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if(Object.getOwnPropertyNames(t).map(function(r){return t[r]}).join("")!=="0123456789")return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(r){o[r]=r}),Object.keys(Object.assign({},o)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}()?Object.assign:function(e,t){for(var n,o,r=y(e),g=1;g<arguments.length;g++){for(var c in n=Object(arguments[g]))v.call(n,c)&&(r[c]=n[c]);if(d){o=d(n);for(var a=0;a<o.length;a++)w.call(n,o[a])&&(r[o[a]]=n[o[a]])}}return r}},{}],248:[function(m,G,Y){function d(y,e){if(typeof y!="string")return[y];var t=[y];typeof e=="string"||Array.isArray(e)?e={brackets:e}:e||(e={});var n=e.brackets?Array.isArray(e.brackets)?e.brackets:[e.brackets]:["{}","[]","()"],o=e.escape||"___",r=!!e.flat;n.forEach(function(c){var a=new RegExp(["\\",c[0],"[^\\",c[0],"\\",c[1],"]*\\",c[1]].join("")),h=[];function l(s,p,u){var i=t.push(s.slice(c[0].length,-c[1].length))-1;return h.push(i),o+i+o}t.forEach(function(s,p){for(var u,i=0;s!=u;)if(u=s,s=s.replace(a,l),i++>1e4)throw Error("References have circular dependency. Please, check them.");t[p]=s}),h=h.reverse(),t=t.map(function(s){return h.forEach(function(p){s=s.replace(new RegExp("(\\"+o+p+"\\"+o+")","g"),c[0]+"$1"+c[1])}),s})});var g=new RegExp("\\"+o+"([0-9]+)\\"+o);return r?t:function c(a,h,l){for(var s,p=[],u=0;s=g.exec(a);){if(u++>1e4)throw Error("Circular references in parenthesis");p.push(a.slice(0,s.index)),p.push(c(h[s[1]],h)),a=a.slice(s.index+s[0].length)}return p.push(a),p}(t[0],t)}function v(y,e){if(e&&e.flat){var t,n=e&&e.escape||"___",o=y[0];if(!o)return"";for(var r=new RegExp("\\"+n+"([0-9]+)\\"+n),g=0;o!=t;){if(g++>1e4)throw Error("Circular references in "+y);t=o,o=o.replace(r,c)}return o}return y.reduce(function a(h,l){return Array.isArray(l)&&(l=l.reduce(a,"")),h+l},"");function c(a,h){if(y[h]==null)throw Error("Reference "+h+"is undefined");return y[h]}}function w(y,e){return Array.isArray(y)?v(y,e):d(y,e)}w.parse=d,w.stringify=v,G.exports=w},{}],249:[function(m,G,Y){var d=m("pick-by-alias");G.exports=function(v){var w;return arguments.length>1&&(v=arguments),typeof v=="string"?v=v.split(/\s/).map(parseFloat):typeof v=="number"&&(v=[v]),v.length&&typeof v[0]=="number"?w=v.length===1?{width:v[0],height:v[0],x:0,y:0}:v.length===2?{width:v[0],height:v[1],x:0,y:0}:{x:v[0],y:v[1],width:v[2]-v[0]||0,height:v[3]-v[1]||0}:v&&(v=d(v,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"}),w={x:v.left||0,y:v.top||0},v.width==null?v.right?w.width=v.right-w.x:w.width=0:w.width=v.width,v.height==null?v.bottom?w.height=v.bottom-w.y:w.height=0:w.height=v.height),w}},{"pick-by-alias":253}],250:[function(m,G,Y){G.exports=function(y){var e=[];return y.replace(v,function(t,n,o){var r=n.toLowerCase();for(o=function(g){var c=g.match(w);return c?c.map(Number):[]}(o),r=="m"&&o.length>2&&(e.push([n].concat(o.splice(0,2))),r="l",n=n=="m"?"l":"L");;){if(o.length==d[r])return o.unshift(n),e.push(o);if(o.length<d[r])throw new Error("malformed path data");e.push([n].concat(o.splice(0,d[r])))}}),e};var d={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},v=/([astvzqmhlc])([^astvzqmhlc]*)/gi,w=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi},{}],251:[function(m,G,Y){G.exports=function(d,v){v||(v=[0,""]),d=String(d);var w=parseFloat(d,10);return v[0]=w,v[1]=d.match(/[\d.\-\+]*\s*(.*)/)[1]||"",v}},{}],252:[function(m,G,Y){(function(d){(function(){(function(){var v,w,y,e,t,n;typeof performance<"u"&&performance!==null&&performance.now?G.exports=function(){return performance.now()}:d!=null&&d.hrtime?(G.exports=function(){return(v()-t)/1e6},w=d.hrtime,e=(v=function(){var o;return 1e9*(o=w())[0]+o[1]})(),n=1e9*d.uptime(),t=e-n):Date.now?(G.exports=function(){return Date.now()-y},y=Date.now()):(G.exports=function(){return new Date().getTime()-y},y=new Date().getTime())}).call(this)}).call(this)}).call(this,m("_process"))},{_process:278}],253:[function(m,G,Y){G.exports=function(w,y,e){var t,n,o={};if(typeof y=="string"&&(y=v(y)),Array.isArray(y)){var r={};for(n=0;n<y.length;n++)r[y[n]]=!0;y=r}for(t in y)y[t]=v(y[t]);var g={};for(t in y){var c=y[t];if(Array.isArray(c))for(n=0;n<c.length;n++){var a=c[n];if(e&&(g[a]=!0),a in w){if(o[t]=w[a],e)for(var h=n;h<c.length;h++)g[c[h]]=!0;break}}else t in w&&(y[t]&&(o[t]=w[t]),e&&(g[t]=!0))}if(e)for(t in w)g[t]||(o[t]=w[t]);return o};var d={};function v(w){return d[w]?d[w]:(typeof w=="string"&&(w=d[w]=w.split(/\s*,\s*|\s+/)),w)}},{}],254:[function(m,G,Y){G.exports=function(d,v,w,y){var e=d[0],t=d[1],n=!1;w===void 0&&(w=0),y===void 0&&(y=v.length);for(var o=y-w,r=0,g=o-1;r<o;g=r++){var c=v[r+w][0],a=v[r+w][1],h=v[g+w][0],l=v[g+w][1];a>t!=l>t&&e<(h-c)*(t-a)/(l-a)+c&&(n=!n)}return n}},{}],255:[function(m,G,Y){/*
 * @copyright 2016 Sean Connelly (@voidqk), http://syntheti.cc
 * @license MIT
 * @preserve Project Home: https://github.com/voidqk/polybooljs
 */var d,v=m("./lib/build-log"),w=m("./lib/epsilon"),y=m("./lib/intersecter"),e=m("./lib/segment-chainer"),t=m("./lib/segment-selector"),n=m("./lib/geojson"),o=!1,r=w();function g(c,a,h){var l=d.segments(c),s=d.segments(a),p=h(d.combine(l,s));return d.polygon(p)}d={buildLog:function(c){return c===!0?o=v():c===!1&&(o=!1),o!==!1&&o.list},epsilon:function(c){return r.epsilon(c)},segments:function(c){var a=y(!0,r,o);return c.regions.forEach(a.addRegion),{segments:a.calculate(c.inverted),inverted:c.inverted}},combine:function(c,a){return{combined:y(!1,r,o).calculate(c.segments,c.inverted,a.segments,a.inverted),inverted1:c.inverted,inverted2:a.inverted}},selectUnion:function(c){return{segments:t.union(c.combined,o),inverted:c.inverted1||c.inverted2}},selectIntersect:function(c){return{segments:t.intersect(c.combined,o),inverted:c.inverted1&&c.inverted2}},selectDifference:function(c){return{segments:t.difference(c.combined,o),inverted:c.inverted1&&!c.inverted2}},selectDifferenceRev:function(c){return{segments:t.differenceRev(c.combined,o),inverted:!c.inverted1&&c.inverted2}},selectXor:function(c){return{segments:t.xor(c.combined,o),inverted:c.inverted1!==c.inverted2}},polygon:function(c){return{regions:e(c.segments,r,o),inverted:c.inverted}},polygonFromGeoJSON:function(c){return n.toPolygon(d,c)},polygonToGeoJSON:function(c){return n.fromPolygon(d,r,c)},union:function(c,a){return g(c,a,d.selectUnion)},intersect:function(c,a){return g(c,a,d.selectIntersect)},difference:function(c,a){return g(c,a,d.selectDifference)},differenceRev:function(c,a){return g(c,a,d.selectDifferenceRev)},xor:function(c,a){return g(c,a,d.selectXor)}},typeof window=="object"&&(window.PolyBool=d),G.exports=d},{"./lib/build-log":256,"./lib/epsilon":257,"./lib/geojson":258,"./lib/intersecter":259,"./lib/segment-chainer":261,"./lib/segment-selector":262}],256:[function(m,G,Y){G.exports=function(){var d,v=0,w=!1;function y(e,t){return d.list.push({type:e,data:t?JSON.parse(JSON.stringify(t)):void 0}),d}return d={list:[],segmentId:function(){return v++},checkIntersection:function(e,t){return y("check",{seg1:e,seg2:t})},segmentChop:function(e,t){return y("div_seg",{seg:e,pt:t}),y("chop",{seg:e,pt:t})},statusRemove:function(e){return y("pop_seg",{seg:e})},segmentUpdate:function(e){return y("seg_update",{seg:e})},segmentNew:function(e,t){return y("new_seg",{seg:e,primary:t})},segmentRemove:function(e){return y("rem_seg",{seg:e})},tempStatus:function(e,t,n){return y("temp_status",{seg:e,above:t,below:n})},rewind:function(e){return y("rewind",{seg:e})},status:function(e,t,n){return y("status",{seg:e,above:t,below:n})},vert:function(e){return e===w?d:(w=e,y("vert",{x:e}))},log:function(e){return typeof e!="string"&&(e=JSON.stringify(e,!1,"  ")),y("log",{txt:e})},reset:function(){return y("reset")},selected:function(e){return y("selected",{segs:e})},chainStart:function(e){return y("chain_start",{seg:e})},chainRemoveHead:function(e,t){return y("chain_rem_head",{index:e,pt:t})},chainRemoveTail:function(e,t){return y("chain_rem_tail",{index:e,pt:t})},chainNew:function(e,t){return y("chain_new",{pt1:e,pt2:t})},chainMatch:function(e){return y("chain_match",{index:e})},chainClose:function(e){return y("chain_close",{index:e})},chainAddHead:function(e,t){return y("chain_add_head",{index:e,pt:t})},chainAddTail:function(e,t){return y("chain_add_tail",{index:e,pt:t})},chainConnect:function(e,t){return y("chain_con",{index1:e,index2:t})},chainReverse:function(e){return y("chain_rev",{index:e})},chainJoin:function(e,t){return y("chain_join",{index1:e,index2:t})},done:function(){return y("done")}}}},{}],257:[function(m,G,Y){G.exports=function(d){typeof d!="number"&&(d=1e-10);var v={epsilon:function(w){return typeof w=="number"&&(d=w),d},pointAboveOrOnLine:function(w,y,e){var t=y[0],n=y[1],o=e[0],r=e[1],g=w[0];return(o-t)*(w[1]-n)-(r-n)*(g-t)>=-d},pointBetween:function(w,y,e){var t=w[1]-y[1],n=e[0]-y[0],o=w[0]-y[0],r=e[1]-y[1],g=o*n+t*r;return!(g<d)&&!(g-(n*n+r*r)>-d)},pointsSameX:function(w,y){return Math.abs(w[0]-y[0])<d},pointsSameY:function(w,y){return Math.abs(w[1]-y[1])<d},pointsSame:function(w,y){return v.pointsSameX(w,y)&&v.pointsSameY(w,y)},pointsCompare:function(w,y){return v.pointsSameX(w,y)?v.pointsSameY(w,y)?0:w[1]<y[1]?-1:1:w[0]<y[0]?-1:1},pointsCollinear:function(w,y,e){var t=w[0]-y[0],n=w[1]-y[1],o=y[0]-e[0],r=y[1]-e[1];return Math.abs(t*r-o*n)<d},linesIntersect:function(w,y,e,t){var n=y[0]-w[0],o=y[1]-w[1],r=t[0]-e[0],g=t[1]-e[1],c=n*g-o*r;if(Math.abs(c)<d)return!1;var a=w[0]-e[0],h=w[1]-e[1],l=(r*h-g*a)/c,s=(n*h-o*a)/c,p={alongA:0,alongB:0,pt:[w[0]+l*n,w[1]+l*o]};return p.alongA=l<=-d?-2:l<d?-1:l-1<=-d?0:l-1<d?1:2,p.alongB=s<=-d?-2:s<d?-1:s-1<=-d?0:s-1<d?1:2,p},pointInsideRegion:function(w,y){for(var e=w[0],t=w[1],n=y[y.length-1][0],o=y[y.length-1][1],r=!1,g=0;g<y.length;g++){var c=y[g][0],a=y[g][1];a-t>d!=o-t>d&&(n-c)*(t-a)/(o-a)+c-e>d&&(r=!r),n=c,o=a}return r}};return v}},{}],258:[function(m,G,Y){var d={toPolygon:function(v,w){function y(n){if(n.length<=0)return v.segments({inverted:!1,regions:[]});function o(c){var a=c.slice(0,c.length-1);return v.segments({inverted:!1,regions:[a]})}for(var r=o(n[0]),g=1;g<n.length;g++)r=v.selectDifference(v.combine(r,o(n[g])));return r}if(w.type==="Polygon")return v.polygon(y(w.coordinates));if(w.type==="MultiPolygon"){for(var e=v.segments({inverted:!1,regions:[]}),t=0;t<w.coordinates.length;t++)e=v.selectUnion(v.combine(e,y(w.coordinates[t])));return v.polygon(e)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(v,w,y){function e(s,p){return w.pointInsideRegion([.5*(s[0][0]+s[1][0]),.5*(s[0][1]+s[1][1])],p)}function t(s){return{region:s,children:[]}}y=v.polygon(v.segments(y));var n=t(null);function o(s,p){for(var u=0;u<s.children.length;u++)if(e(p,(x=s.children[u]).region))return void o(x,p);var i=t(p);for(u=0;u<s.children.length;u++){var x;e((x=s.children[u]).region,p)&&(i.children.push(x),s.children.splice(u,1),u--)}s.children.push(i)}for(var r=0;r<y.regions.length;r++){var g=y.regions[r];g.length<3||o(n,g)}function c(s,p){for(var u=0,i=s[s.length-1][0],x=s[s.length-1][1],f=[],_=0;_<s.length;_++){var b=s[_][0],T=s[_][1];f.push([b,T]),u+=T*i-b*x,i=b,x=T}return u<0!==p&&f.reverse(),f.push([f[0][0],f[0][1]]),f}var a=[];function h(s){var p=[c(s.region,!1)];a.push(p);for(var u=0;u<s.children.length;u++)p.push(l(s.children[u]))}function l(s){for(var p=0;p<s.children.length;p++)h(s.children[p]);return c(s.region,!0)}for(r=0;r<n.children.length;r++)h(n.children[r]);return a.length<=0?{type:"Polygon",coordinates:[]}:a.length==1?{type:"Polygon",coordinates:a[0]}:{type:"MultiPolygon",coordinates:a}}};G.exports=d},{}],259:[function(m,G,Y){var d=m("./linked-list");G.exports=function(v,w,y){function e(c,a,h){return{id:y?y.segmentId():-1,start:c,end:a,myFill:{above:h.myFill.above,below:h.myFill.below},otherFill:null}}var t=d.create();function n(c,a){t.insertBefore(c,function(h){return function(l,s,p,u,i,x){var f=w.pointsCompare(s,i);return f!==0?f:w.pointsSame(p,x)?0:l!==u?l?1:-1:w.pointAboveOrOnLine(p,u?i:x,u?x:i)?1:-1}(c.isStart,c.pt,a,h.isStart,h.pt,h.other.pt)<0})}function o(c,a){var h=function(l,s){var p=d.node({isStart:!0,pt:l.start,seg:l,primary:s,other:null,status:null});return n(p,l.end),p}(c,a);return function(l,s,p){var u=d.node({isStart:!1,pt:s.end,seg:s,primary:p,other:l,status:null});l.other=u,n(u,l.pt)}(h,c,a),h}function r(c,a){var h=e(a,c.seg.end,c.seg);return function(l,s){y&&y.segmentChop(l.seg,s),l.other.remove(),l.seg.end=s,l.other.pt=s,n(l.other,l.pt)}(c,a),o(h,c.primary)}function g(c,a){var h=d.create();function l(I){return h.findTransition(function(P){var S,E,z,D,j,V;return S=I,E=P.ev,z=S.seg.start,D=S.seg.end,j=E.seg.start,V=E.seg.end,(w.pointsCollinear(z,j,V)?w.pointsCollinear(D,j,V)||w.pointAboveOrOnLine(D,j,V)?1:-1:w.pointAboveOrOnLine(z,j,V)?1:-1)>0})}function s(I,P){var S=I.seg,E=P.seg,z=S.start,D=S.end,j=E.start,V=E.end;y&&y.checkIntersection(S,E);var Z=w.linesIntersect(z,D,j,V);if(Z===!1){if(!w.pointsCollinear(z,D,j)||w.pointsSame(z,V)||w.pointsSame(D,j))return!1;var Q=w.pointsSame(z,j),X=w.pointsSame(D,V);if(Q&&X)return P;var $=!Q&&w.pointBetween(z,j,V),re=!X&&w.pointBetween(D,j,V);if(Q)return re?r(P,D):r(I,V),P;$&&(X||(re?r(P,D):r(I,V)),r(P,z))}else Z.alongA===0&&(Z.alongB===-1?r(I,j):Z.alongB===0?r(I,Z.pt):Z.alongB===1&&r(I,V)),Z.alongB===0&&(Z.alongA===-1?r(P,z):Z.alongA===0?r(P,Z.pt):Z.alongA===1&&r(P,D));return!1}for(var p=[];!t.isEmpty();){var u=t.getHead();if(y&&y.vert(u.pt[0]),u.isStart){let I=function(){if(x){var P=s(u,x);if(P)return P}return!!f&&s(u,f)};var A=I;y&&y.segmentNew(u.seg,u.primary);var i=l(u),x=i.before?i.before.ev:null,f=i.after?i.after.ev:null;y&&y.tempStatus(u.seg,!!x&&x.seg,!!f&&f.seg);var _,b=I();if(b){var T;v?(T=u.seg.myFill.below===null||u.seg.myFill.above!==u.seg.myFill.below)&&(b.seg.myFill.above=!b.seg.myFill.above):b.seg.otherFill=u.seg.myFill,y&&y.segmentUpdate(b.seg),u.other.remove(),u.remove()}if(t.getHead()!==u){y&&y.rewind(u.seg);continue}v?(T=u.seg.myFill.below===null||u.seg.myFill.above!==u.seg.myFill.below,u.seg.myFill.below=f?f.seg.myFill.above:c,u.seg.myFill.above=T?!u.seg.myFill.below:u.seg.myFill.below):u.seg.otherFill===null&&(_=f?u.primary===f.primary?f.seg.otherFill.above:f.seg.myFill.above:u.primary?a:c,u.seg.otherFill={above:_,below:_}),y&&y.status(u.seg,!!x&&x.seg,!!f&&f.seg),u.other.status=i.insert(d.node({ev:u}))}else{var k=u.status;if(k===null)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(h.exists(k.prev)&&h.exists(k.next)&&s(k.prev.ev,k.next.ev),y&&y.statusRemove(k.ev.seg),k.remove(),!u.primary){var L=u.seg.myFill;u.seg.myFill=u.seg.otherFill,u.seg.otherFill=L}p.push(u.seg)}t.getHead().remove()}return y&&y.done(),p}return v?{addRegion:function(c){for(var a,h,l,s=c[c.length-1],p=0;p<c.length;p++){a=s,s=c[p];var u=w.pointsCompare(a,s);u!==0&&o((h=u<0?a:s,l=u<0?s:a,{id:y?y.segmentId():-1,start:h,end:l,myFill:{above:null,below:null},otherFill:null}),!0)}},calculate:function(c){return g(c,!1)}}:{calculate:function(c,a,h,l){return c.forEach(function(s){o(e(s.start,s.end,s),!0)}),h.forEach(function(s){o(e(s.start,s.end,s),!1)}),g(a,l)}}}},{"./linked-list":260}],260:[function(m,G,Y){G.exports={create:function(){var d={root:{root:!0,next:null},exists:function(v){return v!==null&&v!==d.root},isEmpty:function(){return d.root.next===null},getHead:function(){return d.root.next},insertBefore:function(v,w){for(var y=d.root,e=d.root.next;e!==null;){if(w(e))return v.prev=e.prev,v.next=e,e.prev.next=v,void(e.prev=v);y=e,e=e.next}y.next=v,v.prev=y,v.next=null},findTransition:function(v){for(var w=d.root,y=d.root.next;y!==null&&!v(y);)w=y,y=y.next;return{before:w===d.root?null:w,after:y,insert:function(e){return e.prev=w,e.next=y,w.next=e,y!==null&&(y.prev=e),e}}}};return d},node:function(d){return d.prev=null,d.next=null,d.remove=function(){d.prev.next=d.next,d.next&&(d.next.prev=d.prev),d.prev=null,d.next=null},d}}},{}],261:[function(m,G,Y){G.exports=function(d,v,w){var y=[],e=[];return d.forEach(function(t){var n=t.start,o=t.end;if(v.pointsSame(n,o))console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");else{w&&w.chainStart(t);for(var r={index:0,matches_head:!1,matches_pt1:!1},g={index:0,matches_head:!1,matches_pt1:!1},c=r,a=0;a<y.length;a++){var h=(i=y[a])[0],l=(i[1],i[i.length-1]);if(i[i.length-2],v.pointsSame(h,n)){if(A(a,!0,!0))break}else if(v.pointsSame(h,o)){if(A(a,!0,!1))break}else if(v.pointsSame(l,n)){if(A(a,!1,!0))break}else if(v.pointsSame(l,o)&&A(a,!1,!1))break}if(c===r)return y.push([n,o]),void(w&&w.chainNew(n,o));if(c===g){w&&w.chainMatch(r.index);var s=r.index,p=r.matches_pt1?o:n,u=r.matches_head,i=y[s],x=u?i[0]:i[i.length-1],f=u?i[1]:i[i.length-2],_=u?i[i.length-1]:i[0],b=u?i[i.length-2]:i[1];return v.pointsCollinear(f,x,p)&&(u?(w&&w.chainRemoveHead(r.index,p),i.shift()):(w&&w.chainRemoveTail(r.index,p),i.pop()),x=f),v.pointsSame(_,p)?(y.splice(s,1),v.pointsCollinear(b,_,x)&&(u?(w&&w.chainRemoveTail(r.index,x),i.pop()):(w&&w.chainRemoveHead(r.index,x),i.shift())),w&&w.chainClose(r.index),void e.push(i)):void(u?(w&&w.chainAddHead(r.index,p),i.unshift(p)):(w&&w.chainAddTail(r.index,p),i.push(p)))}var T=r.index,k=g.index;w&&w.chainConnect(T,k);var L=y[T].length<y[k].length;r.matches_head?g.matches_head?L?(I(T),P(T,k)):(I(k),P(k,T)):P(k,T):g.matches_head?P(T,k):L?(I(T),P(k,T)):(I(k),P(T,k))}function A(S,E,z){return c.index=S,c.matches_head=E,c.matches_pt1=z,c===r?(c=g,!1):(c=null,!0)}function I(S){w&&w.chainReverse(S),y[S].reverse()}function P(S,E){var z=y[S],D=y[E],j=z[z.length-1],V=z[z.length-2],Z=D[0],Q=D[1];v.pointsCollinear(V,j,Z)&&(w&&w.chainRemoveTail(S,j),z.pop(),j=V),v.pointsCollinear(j,Z,Q)&&(w&&w.chainRemoveHead(E,Z),D.shift()),w&&w.chainJoin(S,E),y[S]=z.concat(D),y.splice(E,1)}}),e}},{}],262:[function(m,G,Y){function d(w,y,e){var t=[];return w.forEach(function(n){var o=(n.myFill.above?8:0)+(n.myFill.below?4:0)+(n.otherFill&&n.otherFill.above?2:0)+(n.otherFill&&n.otherFill.below?1:0);y[o]!==0&&t.push({id:e?e.segmentId():-1,start:n.start,end:n.end,myFill:{above:y[o]===1,below:y[o]===2},otherFill:null})}),e&&e.selected(t),t}var v={union:function(w,y){return d(w,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],y)},intersect:function(w,y){return d(w,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],y)},difference:function(w,y){return d(w,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],y)},differenceRev:function(w,y){return d(w,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],y)},xor:function(w,y){return d(w,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],y)}};G.exports=v},{}],263:[function(m,G,Y){var d=m("stream").Transform,v=m("stream-parser");function w(){d.call(this,{readableObjectMode:!0})}function y(e,t,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||"",this.name=this.constructor.name,this.message=e,t&&(this.code=t),n&&(this.statusCode=n)}w.prototype=Object.create(d.prototype),w.prototype.constructor=w,v(w.prototype),Y.ParserStream=w,Y.sliceEq=function(e,t,n){for(var o=t,r=0;r<n.length;)if(e[o++]!==n[r++])return!1;return!0},Y.str2arr=function(e,t){var n=[],o=0;if(t&&t==="hex")for(;o<e.length;)n.push(parseInt(e.slice(o,o+2),16)),o+=2;else for(;o<e.length;o++)n.push(255&e.charCodeAt(o));return n},Y.readUInt16LE=function(e,t){return e[t]|e[t+1]<<8},Y.readUInt16BE=function(e,t){return e[t+1]|e[t]<<8},Y.readUInt32LE=function(e,t){return e[t]|e[t+1]<<8|e[t+2]<<16|16777216*e[t+3]},Y.readUInt32BE=function(e,t){return e[t+3]|e[t+2]<<8|e[t+1]<<16|16777216*e[t]},y.prototype=Object.create(Error.prototype),y.prototype.constructor=y,Y.ProbeError=y},{stream:286,"stream-parser":302}],264:[function(m,G,Y){function d(y,e){var t=new Error(y);return t.code=e,t}function v(y){try{return decodeURIComponent(escape(y))}catch{return y}}function w(y,e,t){this.input=y.subarray(e,t),this.start=e;var n=String.fromCharCode.apply(null,this.input.subarray(0,4));if(n!=="II*\0"&&n!=="MM\0*")throw d("invalid TIFF signature","EBADDATA");this.big_endian=n[0]==="M"}w.prototype.each=function(y){this.aborted=!1;var e=this.read_uint32(4);for(this.ifds_to_read=[{id:0,offset:e}];this.ifds_to_read.length>0&&!this.aborted;){var t=this.ifds_to_read.shift();t.offset&&this.scan_ifd(t.id,t.offset,y)}},w.prototype.read_uint16=function(y){var e=this.input;if(y+2>e.length)throw d("unexpected EOF","EBADDATA");return this.big_endian?256*e[y]+e[y+1]:e[y]+256*e[y+1]},w.prototype.read_uint32=function(y){var e=this.input;if(y+4>e.length)throw d("unexpected EOF","EBADDATA");return this.big_endian?16777216*e[y]+65536*e[y+1]+256*e[y+2]+e[y+3]:e[y]+256*e[y+1]+65536*e[y+2]+16777216*e[y+3]},w.prototype.is_subifd_link=function(y,e){return y===0&&e===34665||y===0&&e===34853||y===34665&&e===40965},w.prototype.exif_format_length=function(y){switch(y){case 1:case 2:case 6:case 7:return 1;case 3:case 8:return 2;case 4:case 9:case 11:return 4;case 5:case 10:case 12:return 8;default:return 0}},w.prototype.exif_format_read=function(y,e){var t;switch(y){case 1:case 2:return t=this.input[e];case 6:return(t=this.input[e])|33554430*(128&t);case 3:return t=this.read_uint16(e);case 8:return(t=this.read_uint16(e))|131070*(32768&t);case 4:return t=this.read_uint32(e);case 9:return 0|(t=this.read_uint32(e));case 5:case 10:case 11:case 12:case 7:default:return null}},w.prototype.scan_ifd=function(y,e,t){var n=this.read_uint16(e);e+=2;for(var o=0;o<n;o++){var r=this.read_uint16(e),g=this.read_uint16(e+2),c=this.read_uint32(e+4),a=this.exif_format_length(g),h=c*a,l=h<=4?e+8:this.read_uint32(e+8),s=!1;if(l+h>this.input.length)throw d("unexpected EOF","EBADDATA");for(var p=[],u=l,i=0;i<c;i++,u+=a){var x=this.exif_format_read(g,u);if(x===null){p=null;break}p.push(x)}if(Array.isArray(p)&&g===2&&(p=v(String.fromCharCode.apply(null,p)))&&p[p.length-1]==="\0"&&(p=p.slice(0,-1)),this.is_subifd_link(y,r)&&Array.isArray(p)&&Number.isInteger(p[0])&&p[0]>0&&(this.ifds_to_read.push({id:r,offset:p[0]}),s=!0),t({is_big_endian:this.big_endian,ifd:y,tag:r,format:g,count:c,entry_offset:e+this.start,data_length:h,data_offset:l+this.start,value:p,is_subifd_link:s})===!1)return void(this.aborted=!0);e+=12}y===0&&this.ifds_to_read.push({id:1,offset:this.read_uint32(e)})},G.exports.ExifParser=w,G.exports.get_orientation=function(y){var e=0;try{return new w(y,0,y.length).each(function(t){if(t.ifd===0&&t.tag===274&&Array.isArray(t.value))return e=t.value[0],!1}),e}catch{return-1}}},{}],265:[function(m,G,Y){var d=m("./common").readUInt16BE,v=m("./common").readUInt32BE;function w(r,g){if(r.length<4+g)return null;var c=v(r,g);return r.length<c+g||c<8?null:{boxtype:String.fromCharCode.apply(null,r.slice(g+4,g+8)),data:r.slice(g+8,g+c),end:g+c}}function y(r,g){for(var c=0;;){var a=w(r,c);if(!a)break;switch(a.boxtype){case"ispe":g.sizes.push({width:v(a.data,4),height:v(a.data,8)});break;case"irot":g.transforms.push({type:"irot",value:3&a.data[0]});break;case"imir":g.transforms.push({type:"imir",value:1&a.data[0]})}c=a.end}}function e(r,g,c){for(var a=0,h=0;h<c;h++)a=256*a+(r[g+h]||0);return a}function t(r,g){for(var c=r[4]>>4&15,a=15&r[4],h=r[5]>>4&15,l=d(r,6),s=8,p=0;p<l;p++){var u=d(r,s),i=d(r,s+=2),x=e(r,s+=2,h),f=d(r,s+=h);if(s+=2,i===0&&f===1){var _=e(r,s,c),b=e(r,s+c,a);g.item_loc[u]={length:b,offset:_+x}}s+=f*(c+a)}}function n(r,g){for(var c=d(r,4),a=6,h=0;h<c;h++){var l=w(r,a);if(!l)break;if(l.boxtype==="infe"){for(var s=d(l.data,4),p="",u=8;u<l.data.length&&l.data[u];u++)p+=String.fromCharCode(l.data[u]);g.item_inf[p]=s}a=l.end}}function o(r,g){for(var c=0;;){var a=w(r,c);if(!a)break;a.boxtype==="ipco"&&y(a.data,g),c=a.end}}G.exports.unbox=w,G.exports.readSizeFromMeta=function(r){var g={sizes:[],transforms:[],item_inf:{},item_loc:{}};if(function(u,i){for(var x=4;;){var f=w(u,x);if(!f)break;f.boxtype==="iprp"&&o(f.data,i),f.boxtype==="iloc"&&t(f.data,i),f.boxtype==="iinf"&&n(f.data,i),x=f.end}}(r,g),g.sizes.length){var c,a,h,l=(c=g.sizes,a=c.reduce(function(u,i){return u.width>i.width||u.width===i.width&&u.height>i.height?u:i}),h=c.reduce(function(u,i){return u.height>i.height||u.height===i.height&&u.width>i.width?u:i}),a.width>h.height||a.width===h.height&&a.height>h.width?a:h),s=1;g.transforms.forEach(function(u){var i={1:6,2:5,3:8,4:7,5:4,6:3,7:2,8:1},x={1:4,2:3,3:2,4:1,5:6,6:5,7:8,8:7};if(u.type==="imir"&&(s=u.value===0?x[s]:i[s=i[s=x[s]]]),u.type==="irot")for(var f=0;f<u.value;f++)s=i[s]});var p=null;return g.item_inf.Exif&&(p=g.item_loc[g.item_inf.Exif]),{width:l.width,height:l.height,orientation:g.transforms.length?s:null,variants:g.sizes,exif_location:p}}},G.exports.getMimeType=function(r){var g=String.fromCharCode.apply(null,r.slice(0,4)),c={};c[g]=!0;for(var a=8;a<r.length;a+=4)c[String.fromCharCode.apply(null,r.slice(a,a+4))]=!0;if(c.mif1||c.msf1||c.miaf)return g==="avif"||g==="avis"||g==="avio"?{type:"avif",mime:"image/avif"}:g==="heic"||g==="heix"?{type:"heic",mime:"image/heic"}:g==="hevc"||g==="hevx"?{type:"heic",mime:"image/heic-sequence"}:c.avif||c.avis?{type:"avif",mime:"image/avif"}:c.heic||c.heix||c.hevc||c.hevx||c.heis?c.msf1?{type:"heif",mime:"image/heif-sequence"}:{type:"heif",mime:"image/heif"}:{type:"avif",mime:"image/avif"}}},{"./common":263}],266:[function(m,G,Y){var d=m("../common").str2arr,v=m("../common").sliceEq,w=m("../common").readUInt32BE,y=m("../miaf_utils"),e=m("../exif_utils"),t=d("ftyp");G.exports=function(n){if(v(n,4,t)){var o=y.unbox(n,0);if(o){var r=y.getMimeType(o.data);if(r){for(var g,c=o.end;;){var a=y.unbox(n,c);if(!a)break;if(c=a.end,a.boxtype==="mdat")return;if(a.boxtype==="meta"){g=a.data;break}}if(g){var h=y.readSizeFromMeta(g);if(h){var l={width:h.width,height:h.height,type:r.type,mime:r.mime,wUnits:"px",hUnits:"px"};if(h.variants.length>1&&(l.variants=h.variants),h.orientation&&(l.orientation=h.orientation),h.exif_location&&h.exif_location.offset+h.exif_location.length<=n.length){var s=w(n,h.exif_location.offset),p=n.slice(h.exif_location.offset+s+4,h.exif_location.offset+h.exif_location.length),u=e.get_orientation(p);u>0&&(l.orientation=u)}return l}}}}}}},{"../common":263,"../exif_utils":264,"../miaf_utils":265}],267:[function(m,G,Y){var d=m("../common").str2arr,v=m("../common").sliceEq,w=m("../common").readUInt16LE,y=d("BM");G.exports=function(e){if(!(e.length<26)&&v(e,0,y))return{width:w(e,18),height:w(e,22),type:"bmp",mime:"image/bmp",wUnits:"px",hUnits:"px"}}},{"../common":263}],268:[function(m,G,Y){var d=m("../common").str2arr,v=m("../common").sliceEq,w=m("../common").readUInt16LE,y=d("GIF87a"),e=d("GIF89a");G.exports=function(t){if(!(t.length<10)&&(v(t,0,y)||v(t,0,e)))return{width:w(t,6),height:w(t,8),type:"gif",mime:"image/gif",wUnits:"px",hUnits:"px"}}},{"../common":263}],269:[function(m,G,Y){var d=m("../common").readUInt16LE;G.exports=function(v){var w=d(v,0),y=d(v,2),e=d(v,4);if(w===0&&y===1&&e){for(var t=[],n={width:0,height:0},o=0;o<e;o++){var r=v[6+16*o]||256,g=v[6+16*o+1]||256,c={width:r,height:g};t.push(c),(r>n.width||g>n.height)&&(n=c)}return{width:n.width,height:n.height,variants:t,type:"ico",mime:"image/x-icon",wUnits:"px",hUnits:"px"}}}},{"../common":263}],270:[function(m,G,Y){var d=m("../common").readUInt16BE,v=m("../common").str2arr,w=m("../common").sliceEq,y=m("../exif_utils"),e=v("Exif\0\0");G.exports=function(t){if(!(t.length<2)&&t[0]===255&&t[1]===216&&t[2]===255)for(var n=2;;){for(;;){if(t.length-n<2)return;if(t[n++]===255)break}for(var o,r,g=t[n++];g===255;)g=t[n++];if(208<=g&&g<=217||g===1)o=0;else{if(!(192<=g&&g<=254)||t.length-n<2)return;o=d(t,n)-2,n+=2}if(g===217||g===218)return;if(g===225&&o>=10&&w(t,n,e)&&(r=y.get_orientation(t.slice(n+6,n+o))),o>=5&&192<=g&&g<=207&&g!==196&&g!==200&&g!==204){if(t.length-n<o)return;var c={width:d(t,n+3),height:d(t,n+1),type:"jpg",mime:"image/jpeg",wUnits:"px",hUnits:"px"};return r>0&&(c.orientation=r),c}n+=o}}},{"../common":263,"../exif_utils":264}],271:[function(m,G,Y){var d=m("../common").str2arr,v=m("../common").sliceEq,w=m("../common").readUInt32BE,y=d(`\x89PNG\r

`),e=d("IHDR");G.exports=function(t){if(!(t.length<24)&&v(t,0,y)&&v(t,12,e))return{width:w(t,16),height:w(t,20),type:"png",mime:"image/png",wUnits:"px",hUnits:"px"}}},{"../common":263}],272:[function(m,G,Y){var d=m("../common").str2arr,v=m("../common").sliceEq,w=m("../common").readUInt32BE,y=d("8BPS\0");G.exports=function(e){if(!(e.length<22)&&v(e,0,y))return{width:w(e,18),height:w(e,14),type:"psd",mime:"image/vnd.adobe.photoshop",wUnits:"px",hUnits:"px"}}},{"../common":263}],273:[function(m,G,Y){function d(r){return typeof r=="number"&&isFinite(r)&&r>0}var v=/<[-_.:a-zA-Z0-9][^>]*>/,w=/^<([-_.:a-zA-Z0-9]+:)?svg\s/,y=/[^-]\bwidth="([^%]+?)"|[^-]\bwidth='([^%]+?)'/,e=/\bheight="([^%]+?)"|\bheight='([^%]+?)'/,t=/\bview[bB]ox="(.+?)"|\bview[bB]ox='(.+?)'/,n=/in$|mm$|cm$|pt$|pc$|px$|em$|ex$/;function o(r){return n.test(r)?r.match(n)[0]:"px"}G.exports=function(r){if(function(_){var b,T=0,k=_.length;for(_[0]===239&&_[1]===187&&_[2]===191&&(T=3);T<k&&((b=_[T])===32||b===9||b===13||b===10);)T++;return T!==k&&_[T]===60}(r)){for(var g="",c=0;c<r.length;c++)g+=String.fromCharCode(r[c]);var a=(g.match(v)||[""])[0];if(w.test(a)){var h=function(_){var b=_.match(y),T=_.match(e),k=_.match(t);return{width:b&&(b[1]||b[2]),height:T&&(T[1]||T[2]),viewbox:k&&(k[1]||k[2])}}(a),l=parseFloat(h.width),s=parseFloat(h.height);if(h.width&&h.height)return!d(l)||!d(s)?void 0:{width:l,height:s,type:"svg",mime:"image/svg+xml",wUnits:o(h.width),hUnits:o(h.height)};var p=(h.viewbox||"").split(" "),u={width:p[2],height:p[3]},i=parseFloat(u.width),x=parseFloat(u.height);if(d(i)&&d(x)&&o(u.width)===o(u.height)){var f=i/x;return h.width?d(l)?{width:l,height:l/f,type:"svg",mime:"image/svg+xml",wUnits:o(h.width),hUnits:o(h.width)}:void 0:h.height?d(s)?{width:s*f,height:s,type:"svg",mime:"image/svg+xml",wUnits:o(h.height),hUnits:o(h.height)}:void 0:{width:i,height:x,type:"svg",mime:"image/svg+xml",wUnits:o(u.width),hUnits:o(u.height)}}}}}},{}],274:[function(m,G,Y){var d=m("../common").str2arr,v=m("../common").sliceEq,w=m("../common").readUInt16LE,y=m("../common").readUInt16BE,e=m("../common").readUInt32LE,t=m("../common").readUInt32BE,n=d("II*\0"),o=d("MM\0*");function r(a,h,l){return l?y(a,h):w(a,h)}function g(a,h,l){return l?t(a,h):e(a,h)}function c(a,h,l){var s=r(a,h+2,l);return g(a,h+4,l)!==1||s!==3&&s!==4?null:s===3?r(a,h+8,l):g(a,h+8,l)}G.exports=function(a){if(!(a.length<8)&&(v(a,0,n)||v(a,0,o))){var h=a[0]===77,l=g(a,4,h)-8;if(!(l<0)){var s=l+8;if(!(a.length-s<2)){var p=12*r(a,s+0,h);if(!(p<=0||(s+=2,a.length-s<p))){var u,i,x,f;for(u=0;u<p;u+=12)(f=r(a,s+u,h))===256?i=c(a,s+u,h):f===257&&(x=c(a,s+u,h));return i&&x?{width:i,height:x,type:"tiff",mime:"image/tiff",wUnits:"px",hUnits:"px"}:void 0}}}}}},{"../common":263}],275:[function(m,G,Y){var d=m("../common").str2arr,v=m("../common").sliceEq,w=m("../common").readUInt16LE,y=m("../common").readUInt32LE,e=m("../exif_utils"),t=d("RIFF"),n=d("WEBP");function o(c,a){if(c[a+3]===157&&c[a+4]===1&&c[a+5]===42)return{width:16383&w(c,a+6),height:16383&w(c,a+8),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}function r(c,a){if(c[a]===47){var h=y(c,a+1);return{width:1+(16383&h),height:1+(h>>14&16383),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}}function g(c,a){return{width:1+(c[a+6]<<16|c[a+5]<<8|c[a+4]),height:1+(c[a+9]<<a|c[a+8]<<8|c[a+7]),type:"webp",mime:"image/webp",wUnits:"px",hUnits:"px"}}G.exports=function(c){if(!(c.length<16)&&(v(c,0,t)||v(c,8,n))){var a=12,h=null,l=0,s=y(c,4)+8;if(!(s>c.length)){for(;a+8<s;)if(c[a]!==0){var p=String.fromCharCode.apply(null,c.slice(a,a+4)),u=y(c,a+4);p==="VP8 "&&u>=10?h=h||o(c,a+8):p==="VP8L"&&u>=9?h=h||r(c,a+8):p==="VP8X"&&u>=10?h=h||g(c,a+8):p==="EXIF"&&(l=e.get_orientation(c.slice(a+8,a+8+u)),a=1/0),a+=8+u}else a++;if(h)return l>0&&(h.orientation=l),h}}}},{"../common":263,"../exif_utils":264}],276:[function(m,G,Y){G.exports={avif:m("./parse_sync/avif"),bmp:m("./parse_sync/bmp"),gif:m("./parse_sync/gif"),ico:m("./parse_sync/ico"),jpeg:m("./parse_sync/jpeg"),png:m("./parse_sync/png"),psd:m("./parse_sync/psd"),svg:m("./parse_sync/svg"),tiff:m("./parse_sync/tiff"),webp:m("./parse_sync/webp")}},{"./parse_sync/avif":266,"./parse_sync/bmp":267,"./parse_sync/gif":268,"./parse_sync/ico":269,"./parse_sync/jpeg":270,"./parse_sync/png":271,"./parse_sync/psd":272,"./parse_sync/svg":273,"./parse_sync/tiff":274,"./parse_sync/webp":275}],277:[function(m,G,Y){var d=m("./lib/parsers_sync");G.exports=function(v){return function(w){for(var y=Object.keys(d),e=0;e<y.length;e++){var t=d[y[e]](w);if(t)return t}return null}(v)},G.exports.parsers=d},{"./lib/parsers_sync":276}],278:[function(m,G,Y){var d,v,w=G.exports={};function y(){throw new Error("setTimeout has not been defined")}function e(){throw new Error("clearTimeout has not been defined")}function t(s){if(d===setTimeout)return setTimeout(s,0);if((d===y||!d)&&setTimeout)return d=setTimeout,setTimeout(s,0);try{return d(s,0)}catch{try{return d.call(null,s,0)}catch{return d.call(this,s,0)}}}(function(){try{d=typeof setTimeout=="function"?setTimeout:y}catch{d=y}try{v=typeof clearTimeout=="function"?clearTimeout:e}catch{v=e}})();var n,o=[],r=!1,g=-1;function c(){r&&n&&(r=!1,n.length?o=n.concat(o):g=-1,o.length&&a())}function a(){if(!r){var s=t(c);r=!0;for(var p=o.length;p;){for(n=o,o=[];++g<p;)n&&n[g].run();g=-1,p=o.length}n=null,r=!1,function(u){if(v===clearTimeout)return clearTimeout(u);if((v===e||!v)&&clearTimeout)return v=clearTimeout,clearTimeout(u);try{v(u)}catch{try{return v.call(null,u)}catch{return v.call(this,u)}}}(s)}}function h(s,p){this.fun=s,this.array=p}function l(){}w.nextTick=function(s){var p=new Array(arguments.length-1);if(arguments.length>1)for(var u=1;u<arguments.length;u++)p[u-1]=arguments[u];o.push(new h(s,p)),o.length!==1||r||t(a)},h.prototype.run=function(){this.fun.apply(null,this.array)},w.title="browser",w.browser=!0,w.env={},w.argv=[],w.version="",w.versions={},w.on=l,w.addListener=l,w.once=l,w.off=l,w.removeListener=l,w.removeAllListeners=l,w.emit=l,w.prependListener=l,w.prependOnceListener=l,w.listeners=function(s){return[]},w.binding=function(s){throw new Error("process.binding is not supported")},w.cwd=function(){return"/"},w.chdir=function(s){throw new Error("process.chdir is not supported")},w.umask=function(){return 0}},{}],279:[function(m,G,Y){(function(d){(function(){for(var v=m("performance-now"),w=typeof window>"u"?d:window,y=["moz","webkit"],e="AnimationFrame",t=w["request"+e],n=w["cancel"+e]||w["cancelRequest"+e],o=0;!t&&o<y.length;o++)t=w[y[o]+"Request"+e],n=w[y[o]+"Cancel"+e]||w[y[o]+"CancelRequest"+e];if(!t||!n){var r=0,g=0,c=[];t=function(a){if(c.length===0){var h=v(),l=Math.max(0,1e3/60-(h-r));r=l+h,setTimeout(function(){var s=c.slice(0);c.length=0;for(var p=0;p<s.length;p++)if(!s[p].cancelled)try{s[p].callback(r)}catch(u){setTimeout(function(){throw u},0)}},Math.round(l))}return c.push({handle:++g,callback:a,cancelled:!1}),g},n=function(a){for(var h=0;h<c.length;h++)c[h].handle===a&&(c[h].cancelled=!0)}}G.exports=function(a){return t.call(w,a)},G.exports.cancel=function(){n.apply(w,arguments)},G.exports.polyfill=function(a){a||(a=w),a.requestAnimationFrame=t,a.cancelAnimationFrame=n}}).call(this)}).call(this,typeof Ka<"u"?Ka:typeof self<"u"?self:typeof window<"u"?window:{})},{"performance-now":252}],280:[function(m,G,Y){var d=m("array-bounds"),v=m("color-normalize"),w=m("update-diff"),y=m("pick-by-alias"),e=m("object-assign"),t=m("flatten-vertex-data"),n=m("to-float32"),o=n.float32,r=n.fract32;G.exports=function(c,a){if(typeof c=="function"?(a||(a={}),a.regl=c):a=c,a.length&&(a.positions=a),!(c=a.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var h,l,s,p,u,i,x=c._gl,f={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},_=[];return p=c.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),l=c.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),s=c.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),u=c.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),i=c.buffer({usage:"static",type:"float",data:g}),L(a),h=c({vert:`
		precision highp float;

		attribute vec2 position, positionFract;
		attribute vec4 error;
		attribute vec4 color;

		attribute vec2 direction, lineOffset, capOffset;

		uniform vec4 viewport;
		uniform float lineWidth, capSize;
		uniform vec2 scale, scaleFract, translate, translateFract;

		varying vec4 fragColor;

		void main() {
			fragColor = color / 255.;

			vec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;

			vec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;

			vec2 position = position + dxy;

			vec2 pos = (position + translate) * scale
				+ (positionFract + translateFract) * scale
				+ (position + translate) * scaleFract
				+ (positionFract + translateFract) * scaleFract;

			pos += pixelOffset / viewport.zw;

			gl_Position = vec4(pos * 2. - 1., 0, 1);
		}
		`,frag:`
		precision highp float;

		varying vec4 fragColor;

		uniform float opacity;

		void main() {
			gl_FragColor = fragColor;
			gl_FragColor.a *= opacity;
		}
		`,uniforms:{range:c.prop("range"),lineWidth:c.prop("lineWidth"),capSize:c.prop("capSize"),opacity:c.prop("opacity"),scale:c.prop("scale"),translate:c.prop("translate"),scaleFract:c.prop("scaleFract"),translateFract:c.prop("translateFract"),viewport:function(I,P){return[P.viewport.x,P.viewport.y,I.viewportWidth,I.viewportHeight]}},attributes:{color:{buffer:p,offset:function(I,P){return 4*P.offset},divisor:1},position:{buffer:l,offset:function(I,P){return 8*P.offset},divisor:1},positionFract:{buffer:s,offset:function(I,P){return 8*P.offset},divisor:1},error:{buffer:u,offset:function(I,P){return 16*P.offset},divisor:1},direction:{buffer:i,stride:24,offset:0},lineOffset:{buffer:i,stride:24,offset:8},capOffset:{buffer:i,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:c.prop("viewport")},viewport:c.prop("viewport"),stencil:!1,instances:c.prop("count"),count:g.length}),e(b,{update:L,draw:T,destroy:A,regl:c,gl:x,canvas:x.canvas,groups:_}),b;function b(I){I?L(I):I===null&&A(),T()}function T(I){if(typeof I=="number")return k(I);I&&!Array.isArray(I)&&(I=[I]),c._refresh(),_.forEach(function(P,S){P&&(I&&(I[S]?P.draw=!0:P.draw=!1),P.draw?k(S):P.draw=!0)})}function k(I){typeof I=="number"&&(I=_[I]),I!=null&&I&&I.count&&I.color&&I.opacity&&I.positions&&I.positions.length>1&&(I.scaleRatio=[I.scale[0]*I.viewport.width,I.scale[1]*I.viewport.height],h(I),I.after&&I.after(I))}function L(I){if(I){I.length!=null?typeof I[0]=="number"&&(I=[{positions:I}]):Array.isArray(I)||(I=[I]);var P=0,S=0;if(b.groups=_=I.map(function(Q,X){var $=_[X];return Q&&(typeof Q=="function"?Q={after:Q}:typeof Q[0]=="number"&&(Q={positions:Q}),Q=y(Q,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),$||(_[X]=$={id:X,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},Q=e({},f,Q)),w($,Q,[{lineWidth:function(re){return .5*+re},capSize:function(re){return .5*+re},opacity:parseFloat,errors:function(re){return re=t(re),S+=re.length,re},positions:function(re,H){return re=t(re,"float64"),H.count=Math.floor(re.length/2),H.bounds=d(re,2),H.offset=P,P+=H.count,re}},{color:function(re,H){var N=H.count;if(re||(re="transparent"),!Array.isArray(re)||typeof re[0]=="number"){var U=re;re=Array(N);for(var te=0;te<N;te++)re[te]=U}if(re.length<N)throw Error("Not enough colors");for(var B=new Uint8Array(4*N),K=0;K<N;K++){var J=v(re[K],"uint8");B.set(J,4*K)}return B},range:function(re,H,N){var U=H.bounds;return re||(re=U),H.scale=[1/(re[2]-re[0]),1/(re[3]-re[1])],H.translate=[-re[0],-re[1]],H.scaleFract=r(H.scale),H.translateFract=r(H.translate),re},viewport:function(re){var H;return Array.isArray(re)?H={x:re[0],y:re[1],width:re[2]-re[0],height:re[3]-re[1]}:re?(H={x:re.x||re.left||0,y:re.y||re.top||0},re.right?H.width=re.right-H.x:H.width=re.w||re.width||0,re.bottom?H.height=re.bottom-H.y:H.height=re.h||re.height||0):H={x:0,y:0,width:x.drawingBufferWidth,height:x.drawingBufferHeight},H}}])),$}),P||S){var E=_.reduce(function(Q,X,$){return Q+(X?X.count:0)},0),z=new Float64Array(2*E),D=new Uint8Array(4*E),j=new Float32Array(4*E);_.forEach(function(Q,X){if(Q){var $=Q.positions,re=Q.count,H=Q.offset,N=Q.color,U=Q.errors;re&&(D.set(N,4*H),j.set(U,4*H),z.set($,2*H))}});var V=o(z);l(V);var Z=r(z,V);s(Z),p(D),u(j)}}}function A(){l.destroy(),s.destroy(),p.destroy(),u.destroy(),i.destroy()}};var g=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]]},{"array-bounds":71,"color-normalize":89,"flatten-vertex-data":191,"object-assign":247,"pick-by-alias":253,"to-float32":314,"update-diff":330}],281:[function(m,G,Y){var d=m("color-normalize"),v=m("array-bounds"),w=m("object-assign"),y=m("glslify"),e=m("pick-by-alias"),t=m("flatten-vertex-data"),n=m("earcut"),o=m("array-normalize"),r=m("to-float32"),g=r.float32,c=r.fract32,a=m("es6-weak-map"),h=m("parse-rect"),l=m("array-find-index");function s(p,u){if(!(this instanceof s))return new s(p,u);if(typeof p=="function"?(u||(u={}),u.regl=p):u=p,u.length&&(u.positions=u),!(p=u.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=p._gl,this.regl=p,this.passes=[],this.shaders=s.shaders.has(p)?s.shaders.get(p):s.shaders.set(p,s.createShaders(p)).get(p),this.update(u)}G.exports=s,s.dashMult=2,s.maxPatternLength=256,s.precisionThreshold=3e6,s.maxPoints=1e4,s.maxLines=2048,s.shaders=new a,s.createShaders=function(p){var u,i=p.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),x={primitive:"triangle strip",instances:p.prop("count"),count:4,offset:0,uniforms:{miterMode:function(_,b){return b.join==="round"?2:1},miterLimit:p.prop("miterLimit"),scale:p.prop("scale"),scaleFract:p.prop("scaleFract"),translateFract:p.prop("translateFract"),translate:p.prop("translate"),thickness:p.prop("thickness"),dashTexture:p.prop("dashTexture"),opacity:p.prop("opacity"),pixelRatio:p.context("pixelRatio"),id:p.prop("id"),dashLength:p.prop("dashLength"),viewport:function(_,b){return[b.viewport.x,b.viewport.y,_.viewportWidth,_.viewportHeight]},depth:p.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(_,b){return!b.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:p.prop("viewport")},viewport:p.prop("viewport")},f=p(w({vert:y([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;
attribute vec4 color;
attribute float lineEnd, lineTop;

uniform vec2 scale, scaleFract, translate, translateFract;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;

varying vec4 fragColor;
varying vec2 tangent;

vec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {
	// the order is important
	return position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;
}

void main() {
	float lineStart = 1. - lineEnd;
	float lineOffset = lineTop * 2. - 1.;

	vec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);
	tangent = normalize(diff * scale * viewport.zw);
	vec2 normal = vec2(-tangent.y, tangent.x);

	vec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart
		+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd

		+ thickness * normal * .5 * lineOffset / viewport.zw;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
}
`]),frag:y([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;

void main() {
	float alpha = 1.;

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:i,divisor:0,stride:8,offset:0},lineTop:{buffer:i,divisor:0,stride:8,offset:4},aCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:p.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:p.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:p.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},x));try{u=p(w({cull:{enable:!0,face:"back"},vert:y([`precision highp float;
#define GLSLIFY 1

attribute vec2 aCoord, bCoord, nextCoord, prevCoord;
attribute vec4 aColor, bColor;
attribute float lineEnd, lineTop;

uniform vec2 scale, translate;
uniform float thickness, pixelRatio, id, depth;
uniform vec4 viewport;
uniform float miterLimit, miterMode;

varying vec4 fragColor;
varying vec4 startCutoff, endCutoff;
varying vec2 tangent;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

const float REVERSE_THRESHOLD = -.875;
const float MIN_DIFF = 1e-6;

// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead
// TODO: precalculate dot products, normalize things beforehead etc.
// TODO: refactor to rectangular algorithm

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

bool isNaN( float val ){
  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;
}

void main() {
	vec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;

  vec2 adjustedScale;
  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;
  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;

  vec2 scaleRatio = adjustedScale * viewport.zw;
	vec2 normalWidth = thickness / scaleRatio;

	float lineStart = 1. - lineEnd;
	float lineBot = 1. - lineTop;

	fragColor = (lineStart * aColor + lineEnd * bColor) / 255.;

	if (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;

	if (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);
	if (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);

	vec2 prevDiff = aCoord - prevCoord;
	vec2 currDiff = bCoord - aCoord;
	vec2 nextDiff = nextCoord - bCoord;

	vec2 prevTangent = normalize(prevDiff * scaleRatio);
	vec2 currTangent = normalize(currDiff * scaleRatio);
	vec2 nextTangent = normalize(nextDiff * scaleRatio);

	vec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);
	vec2 currNormal = vec2(-currTangent.y, currTangent.x);
	vec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);

	vec2 startJoinDirection = normalize(prevTangent - currTangent);
	vec2 endJoinDirection = normalize(currTangent - nextTangent);

	// collapsed/unidirectional segment cases
	// FIXME: there should be more elegant solution
	vec2 prevTanDiff = abs(prevTangent - currTangent);
	vec2 nextTanDiff = abs(nextTangent - currTangent);
	if (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {
		startJoinDirection = currNormal;
	}
	if (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {
		endJoinDirection = currNormal;
	}
	if (aCoord == bCoord) {
		endJoinDirection = startJoinDirection;
		currNormal = prevNormal;
		currTangent = prevTangent;
	}

	tangent = currTangent;

	//calculate join shifts relative to normals
	float startJoinShift = dot(currNormal, startJoinDirection);
	float endJoinShift = dot(currNormal, endJoinDirection);

	float startMiterRatio = abs(1. / startJoinShift);
	float endMiterRatio = abs(1. / endJoinShift);

	vec2 startJoin = startJoinDirection * startMiterRatio;
	vec2 endJoin = endJoinDirection * endMiterRatio;

	vec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;
	startTopJoin = sign(startJoinShift) * startJoin * .5;
	startBotJoin = -startTopJoin;

	endTopJoin = sign(endJoinShift) * endJoin * .5;
	endBotJoin = -endTopJoin;

	vec2 aTopCoord = aCoord + normalWidth * startTopJoin;
	vec2 bTopCoord = bCoord + normalWidth * endTopJoin;
	vec2 aBotCoord = aCoord + normalWidth * startBotJoin;
	vec2 bBotCoord = bCoord + normalWidth * endBotJoin;

	//miter anti-clipping
	float baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));
	float abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));

	//prevent close to reverse direction switch
	bool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);
	bool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);

	if (prevReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);
		aBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		aTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {
		//handle miter clipping
		bTopCoord -= normalWidth * endTopJoin;
		bTopCoord += normalize(endTopJoin * normalWidth) * baClipping;
	}

	if (nextReverse) {
		//make join rectangular
		vec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;
		float normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);
		bBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;
		bTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;
	}
	else if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {
		//handle miter clipping
		aBotCoord -= normalWidth * startBotJoin;
		aBotCoord += normalize(startBotJoin * normalWidth) * abClipping;
	}

	vec2 aTopPosition = (aTopCoord) * adjustedScale + translate;
	vec2 aBotPosition = (aBotCoord) * adjustedScale + translate;

	vec2 bTopPosition = (bTopCoord) * adjustedScale + translate;
	vec2 bBotPosition = (bBotCoord) * adjustedScale + translate;

	//position is normalized 0..1 coord on the screen
	vec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;

	startCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;
	endCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;

	gl_Position = vec4(position  * 2.0 - 1.0, depth, 1);

	enableStartMiter = step(dot(currTangent, prevTangent), .5);
	enableEndMiter = step(dot(currTangent, nextTangent), .5);

	//bevel miter cutoffs
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}

	//round miter cutoffs
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			vec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;
			startCutoff = vec4(aCoord, aCoord);
			startCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;
			startCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			startCutoff += viewport.xyxy;
			startCutoff += startMiterWidth.xyxy;
		}

		if (enableEndMiter == 1.) {
			vec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;
			endCutoff = vec4(bCoord, bCoord);
			endCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;
			endCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;
			endCutoff += viewport.xyxy;
			endCutoff += endMiterWidth.xyxy;
		}
	}
}
`]),frag:y([`precision highp float;
#define GLSLIFY 1

uniform float dashLength, pixelRatio, thickness, opacity, id, miterMode;
uniform sampler2D dashTexture;

varying vec4 fragColor;
varying vec2 tangent;
varying vec4 startCutoff, endCutoff;
varying vec2 startCoord, endCoord;
varying float enableStartMiter, enableEndMiter;

float distToLine(vec2 p, vec2 a, vec2 b) {
	vec2 diff = b - a;
	vec2 perp = normalize(vec2(-diff.y, diff.x));
	return dot(p - a, perp);
}

void main() {
	float alpha = 1., distToStart, distToEnd;
	float cutoff = thickness * .5;

	//bevel miter
	if (miterMode == 1.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToStart + 1., 0.), 1.);
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < -1.) {
				discard;
				return;
			}
			alpha *= min(max(distToEnd + 1., 0.), 1.);
		}
	}

	// round miter
	else if (miterMode == 2.) {
		if (enableStartMiter == 1.) {
			distToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);
			if (distToStart < 0.) {
				float radius = length(gl_FragCoord.xy - startCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}

		if (enableEndMiter == 1.) {
			distToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);
			if (distToEnd < 0.) {
				float radius = length(gl_FragCoord.xy - endCoord);

				if(radius > cutoff + .5) {
					discard;
					return;
				}

				alpha -= smoothstep(cutoff - .5, cutoff + .5, radius);
			}
		}
	}

	float t = fract(dot(tangent, gl_FragCoord.xy) / dashLength) * .5 + .25;
	float dash = texture2D(dashTexture, vec2(t, .5)).r;

	gl_FragColor = fragColor;
	gl_FragColor.a *= alpha * opacity * dash;
}
`]),attributes:{lineEnd:{buffer:i,divisor:0,stride:8,offset:0},lineTop:{buffer:i,divisor:0,stride:8,offset:4},aColor:{buffer:p.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:p.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:p.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},x))}catch{u=f}return{fill:p({primitive:"triangle",elements:function(_,b){return b.triangles},offset:0,vert:y([`precision highp float;
#define GLSLIFY 1

attribute vec2 position, positionFract;

uniform vec4 color;
uniform vec2 scale, scaleFract, translate, translateFract;
uniform float pixelRatio, id;
uniform vec4 viewport;
uniform float opacity;

varying vec4 fragColor;

const float MAX_LINES = 256.;

void main() {
	float depth = (MAX_LINES - 4. - id) / (MAX_LINES);

	vec2 position = position * scale + translate
       + positionFract * scale + translateFract
       + position * scaleFract
       + positionFract * scaleFract;

	gl_Position = vec4(position * 2.0 - 1.0, depth, 1);

	fragColor = color / 255.;
	fragColor.a *= opacity;
}
`]),frag:y([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
	gl_FragColor = fragColor;
}
`]),uniforms:{scale:p.prop("scale"),color:p.prop("fill"),scaleFract:p.prop("scaleFract"),translateFract:p.prop("translateFract"),translate:p.prop("translate"),opacity:p.prop("opacity"),pixelRatio:p.context("pixelRatio"),id:p.prop("id"),viewport:function(_,b){return[b.viewport.x,b.viewport.y,_.viewportWidth,_.viewportHeight]}},attributes:{position:{buffer:p.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:p.prop("positionFractBuffer"),stride:8,offset:8}},blend:x.blend,depth:{enable:!1},scissor:x.scissor,stencil:x.stencil,viewport:x.viewport}),rect:f,miter:u}},s.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},s.prototype.render=function(){for(var p,u=[],i=arguments.length;i--;)u[i]=arguments[i];u.length&&(p=this).update.apply(p,u),this.draw()},s.prototype.draw=function(){for(var p=this,u=[],i=arguments.length;i--;)u[i]=arguments[i];return(u.length?u:this.passes).forEach(function(x,f){var _;if(x&&Array.isArray(x))return(_=p).draw.apply(_,x);typeof x=="number"&&(x=p.passes[x]),x&&x.count>1&&x.opacity&&(p.regl._refresh(),x.fill&&x.triangles&&x.triangles.length>2&&p.shaders.fill(x),x.thickness&&(x.scale[0]*x.viewport.width>s.precisionThreshold||x.scale[1]*x.viewport.height>s.precisionThreshold||x.join==="rect"||!x.join&&(x.thickness<=2||x.count>=s.maxPoints)?p.shaders.rect(x):p.shaders.miter(x)))}),this},s.prototype.update=function(p){var u=this;if(p){p.length!=null?typeof p[0]=="number"&&(p=[{positions:p}]):Array.isArray(p)||(p=[p]);var i=this.regl,x=this.gl;if(p.forEach(function(k,L){var A=u.passes[L];if(k!==void 0)if(k!==null){if(typeof k[0]=="number"&&(k={positions:k}),k=e(k,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow",splitNull:"splitNull"}),A||(u.passes[L]=A={id:L,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:i.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:i.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:i.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:i.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},k=w({},s.defaults,k)),k.thickness!=null&&(A.thickness=parseFloat(k.thickness)),k.opacity!=null&&(A.opacity=parseFloat(k.opacity)),k.miterLimit!=null&&(A.miterLimit=parseFloat(k.miterLimit)),k.overlay!=null&&(A.overlay=!!k.overlay,L<s.maxLines&&(A.depth=2*(s.maxLines-1-L%s.maxLines)/s.maxLines-1)),k.join!=null&&(A.join=k.join),k.hole!=null&&(A.hole=k.hole),k.fill!=null&&(A.fill=k.fill?d(k.fill,"uint8"):null),k.viewport!=null&&(A.viewport=h(k.viewport)),A.viewport||(A.viewport=h([x.drawingBufferWidth,x.drawingBufferHeight])),k.close!=null&&(A.close=k.close),k.positions===null&&(k.positions=[]),k.positions){var I,P;if(k.positions.x&&k.positions.y){var S=k.positions.x,E=k.positions.y;P=A.count=Math.max(S.length,E.length),I=new Float64Array(2*P);for(var z=0;z<P;z++)I[2*z]=S[z],I[2*z+1]=E[z]}else I=t(k.positions,"float64"),P=A.count=Math.floor(I.length/2);var D=A.bounds=v(I,2);if(A.fill){for(var j=[],V={},Z=0,Q=0,X=0,$=A.count;Q<$;Q++){var re=I[2*Q],H=I[2*Q+1];isNaN(re)||isNaN(H)||re==null||H==null?(re=I[2*Z],H=I[2*Z+1],V[Q]=Z):Z=Q,j[X++]=re,j[X++]=H}if(k.splitNull){A.count-1 in V||(V[A.count]=A.count-1);var N=Object.keys(V).map(Number).sort(function(vt,jt){return vt-jt}),U=[],te=0,B=A.hole!=null?A.hole[0]:null;if(B!=null){var K=l(N,function(vt){return vt>=B});(N=N.slice(0,K)).push(B)}for(var J=function(vt){var jt=j.slice(2*te,2*N[vt]).concat(B?j.slice(2*B):[]),Gt=(A.hole||[]).map(function(Zt){return Zt-B+(N[vt]-te)}),$t=n(jt,Gt);$t=$t.map(function(Zt){return Zt+te+(Zt+te<N[vt]?0:B-N[vt])}),U.push.apply(U,$t),te=N[vt]+1},ee=0;ee<N.length;ee++)J(ee);for(var ne=0,se=U.length;ne<se;ne++)V[U[ne]]!=null&&(U[ne]=V[U[ne]]);A.triangles=U}else{for(var oe=n(j,A.hole||[]),me=0,ce=oe.length;me<ce;me++)V[oe[me]]!=null&&(oe[me]=V[oe[me]]);A.triangles=oe}}var ye=new Float64Array(I);o(ye,2,D);var Se=new Float64Array(2*P+6);A.close?I[0]===I[2*P-2]&&I[1]===I[2*P-1]?(Se[0]=ye[2*P-4],Se[1]=ye[2*P-3]):(Se[0]=ye[2*P-2],Se[1]=ye[2*P-1]):(Se[0]=ye[0],Se[1]=ye[1]),Se.set(ye,2),A.close?I[0]===I[2*P-2]&&I[1]===I[2*P-1]?(Se[2*P+2]=ye[2],Se[2*P+3]=ye[3],A.count-=1):(Se[2*P+2]=ye[0],Se[2*P+3]=ye[1],Se[2*P+4]=ye[2],Se[2*P+5]=ye[3]):(Se[2*P+2]=ye[2*P-2],Se[2*P+3]=ye[2*P-1],Se[2*P+4]=ye[2*P-2],Se[2*P+5]=ye[2*P-1]);var fe=g(Se);A.positionBuffer(fe);var ge=c(Se,fe);A.positionFractBuffer(ge)}if(k.range?A.range=k.range:A.range||(A.range=A.bounds),(k.range||k.positions)&&A.count){var Te=A.bounds,le=Te[2]-Te[0],ve=Te[3]-Te[1],Me=A.range[2]-A.range[0],we=A.range[3]-A.range[1];A.scale=[le/Me,ve/we],A.translate=[-A.range[0]/Me+Te[0]/Me||0,-A.range[1]/we+Te[1]/we||0],A.scaleFract=c(A.scale),A.translateFract=c(A.translate)}if(k.dashes){var de,Ie=0;if(!k.dashes||k.dashes.length<2)Ie=1,de=new Uint8Array([255,255,255,255,255,255,255,255]);else{Ie=0;for(var De=0;De<k.dashes.length;++De)Ie+=k.dashes[De];de=new Uint8Array(Ie*s.dashMult);for(var Oe=0,Ve=255,Fe=0;Fe<2;Fe++)for(var ze=0;ze<k.dashes.length;++ze){for(var Re=0,We=k.dashes[ze]*s.dashMult*.5;Re<We;++Re)de[Oe++]=Ve;Ve^=255}}A.dashLength=Ie,A.dashTexture({channels:1,data:de,width:de.length,height:1,mag:"linear",min:"linear"},0,0)}if(k.color){var $e=A.count,at=k.color;at||(at="transparent");var gt=new Uint8Array(4*$e+4);if(Array.isArray(at)&&typeof at[0]!="number"){for(var xt=0;xt<$e;xt++){var mt=d(at[xt],"uint8");gt.set(mt,4*xt)}gt.set(d(at[0],"uint8"),4*$e)}else for(var nt=d(at,"uint8"),Qe=0;Qe<$e+1;Qe++)gt.set(nt,4*Qe);A.colorBuffer({usage:"dynamic",type:"uint8",data:gt})}}else u.passes[L]=null}),p.length<this.passes.length){for(var f=p.length;f<this.passes.length;f++){var _=this.passes[f];_&&(_.colorBuffer.destroy(),_.positionBuffer.destroy(),_.dashTexture.destroy())}this.passes.length=p.length}for(var b=[],T=0;T<this.passes.length;T++)this.passes[T]!==null&&b.push(this.passes[T]);return this.passes=b,this}},s.prototype.destroy=function(){return this.passes.forEach(function(p){p.colorBuffer.destroy(),p.positionBuffer.destroy(),p.dashTexture.destroy()}),this.passes.length=0,this}},{"array-bounds":71,"array-find-index":72,"array-normalize":73,"color-normalize":89,earcut:129,"es6-weak-map":183,"flatten-vertex-data":191,glslify:227,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":314}],282:[function(m,G,Y){function d(f,_){return function(b){if(Array.isArray(b))return b}(f)||function(b,T){var k=b==null?null:typeof Symbol<"u"&&b[Symbol.iterator]||b["@@iterator"];if(k!=null){var L,A,I=[],P=!0,S=!1;try{for(k=k.call(b);!(P=(L=k.next()).done)&&(I.push(L.value),!T||I.length!==T);P=!0);}catch(E){S=!0,A=E}finally{try{P||k.return==null||k.return()}finally{if(S)throw A}}return I}}(f,_)||w(f,_)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function v(f){return function(_){if(Array.isArray(_))return y(_)}(f)||function(_){if(typeof Symbol<"u"&&_[Symbol.iterator]!=null||_["@@iterator"]!=null)return Array.from(_)}(f)||w(f)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function w(f,_){if(f){if(typeof f=="string")return y(f,_);var b=Object.prototype.toString.call(f).slice(8,-1);return b==="Object"&&f.constructor&&(b=f.constructor.name),b==="Map"||b==="Set"?Array.from(f):b==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(b)?y(f,_):void 0}}function y(f,_){(_==null||_>f.length)&&(_=f.length);for(var b=0,T=new Array(_);b<_;b++)T[b]=f[b];return T}var e=m("color-normalize"),t=m("array-bounds"),n=m("color-id"),o=m("@plotly/point-cluster"),r=m("object-assign"),g=m("glslify"),c=m("pick-by-alias"),a=m("update-diff"),h=m("flatten-vertex-data"),l=m("is-iexplorer"),s=m("to-float32"),p=m("parse-rect"),u=i;function i(f,_){var b=this;if(!(this instanceof i))return new i(f,_);typeof f=="function"?(_||(_={}),_.regl=f):(_=f,f=null),_&&_.length&&(_.positions=_);var T,k=(f=_.regl)._gl,L=[];this.tooManyColors=l,T=f.texture({data:new Uint8Array(1020),width:255,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),r(this,{regl:f,gl:k,groups:[],markerCache:[null],markerTextures:[null],palette:L,paletteIds:{},paletteTexture:T,maxColors:255,maxSize:100,canvas:k.canvas}),this.update(_);var A={uniforms:{constPointSize:!!_.constPointSize,opacity:f.prop("opacity"),paletteSize:function(S,E){return[b.tooManyColors?0:255,T.height]},pixelRatio:f.context("pixelRatio"),scale:f.prop("scale"),scaleFract:f.prop("scaleFract"),translate:f.prop("translate"),translateFract:f.prop("translateFract"),markerTexture:f.prop("markerTexture"),paletteTexture:T},attributes:{x:function(S,E){return E.xAttr||{buffer:E.positionBuffer,stride:8,offset:0}},y:function(S,E){return E.yAttr||{buffer:E.positionBuffer,stride:8,offset:4}},xFract:function(S,E){return E.xAttr?{constant:[0,0]}:{buffer:E.positionFractBuffer,stride:8,offset:0}},yFract:function(S,E){return E.yAttr?{constant:[0,0]}:{buffer:E.positionFractBuffer,stride:8,offset:4}},size:function(S,E){return E.size.length?{buffer:E.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(255*E.size/b.maxSize)]}},borderSize:function(S,E){return E.borderSize.length?{buffer:E.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(255*E.borderSize/b.maxSize)]}},colorId:function(S,E){return E.color.length?{buffer:E.colorBuffer,stride:b.tooManyColors?8:4,offset:0}:{constant:b.tooManyColors?L.slice(4*E.color,4*E.color+4):[E.color]}},borderColorId:function(S,E){return E.borderColor.length?{buffer:E.colorBuffer,stride:b.tooManyColors?8:4,offset:b.tooManyColors?4:2}:{constant:b.tooManyColors?L.slice(4*E.borderColor,4*E.borderColor+4):[E.borderColor]}},isActive:function(S,E){return E.activation===!0?{constant:[1]}:E.activation?E.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:f.prop("viewport")},viewport:f.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:f.prop("elements"),count:f.prop("count"),offset:f.prop("offset"),primitive:"points"},I=r({},A);I.frag=g([`precision highp float;
#define GLSLIFY 1

uniform float opacity;
uniform sampler2D markerTexture;

varying vec4 fragColor, fragBorderColor;
varying float fragWidth, fragBorderColorLevel, fragColorLevel;

float smoothStep(float x, float y) {
  return 1.0 / (1.0 + exp(50.0*(x - y)));
}

void main() {
  float dist = texture2D(markerTexture, gl_PointCoord).r, delta = fragWidth;

  // max-distance alpha
  if (dist < 0.003) discard;

  // null-border case
  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {
    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);
    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);
  }
  else {
    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);
    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);

    vec4 color = fragBorderColor;
    color.a *= borderColorAmt;
    color = mix(color, fragColor, colorAmt);
    color.a *= opacity;

    gl_FragColor = color;
  }

}
`]),I.vert=g([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 scale, scaleFract, translate, translateFract, paletteSize;
uniform sampler2D paletteTexture;

const float maxSize = 100.;
const float borderLevel = .5;

varying vec4 fragColor, fragBorderColor;
varying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = 2. * size * pointSizeScale;
  fragPointSize = size * pixelRatio;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragColor = color;
  fragBorderColor = borderColor;
  fragWidth = 1. / gl_PointSize;

  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);
  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);
}`]),this.drawMarker=f(I);var P=r({},A);P.frag=g([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

uniform float opacity;

float smoothStep(float edge0, float edge1, float x) {
	float t;
	t = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
	return t * t * (3.0 - 2.0 * t);
}

void main() {
	float radius, alpha = 1.0, delta = fragWidth;

	radius = length(2.0 * gl_PointCoord.xy - 1.0);

	if (radius > 1.0 + delta) {
		discard;
	}

	alpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);

	float borderRadius = fragBorderRadius;
	float ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);
	vec4 color = mix(fragColor, fragBorderColor, ratio);
	color.a *= alpha * opacity;
	gl_FragColor = color;
}
`]),P.vert=g([`precision highp float;
#define GLSLIFY 1

attribute float x, y, xFract, yFract;
attribute float size, borderSize;
attribute vec4 colorId, borderColorId;
attribute float isActive;

uniform bool constPointSize;
uniform float pixelRatio;
uniform vec2 paletteSize, scale, scaleFract, translate, translateFract;
uniform sampler2D paletteTexture;

const float maxSize = 100.;

varying vec4 fragColor, fragBorderColor;
varying float fragBorderRadius, fragWidth;

float pointSizeScale = (constPointSize) ? 2. : pixelRatio;

bool isDirect = (paletteSize.x < 1.);

vec4 getColor(vec4 id) {
  return isDirect ? id / 255. : texture2D(paletteTexture,
    vec2(
      (id.x + .5) / paletteSize.x,
      (id.y + .5) / paletteSize.y
    )
  );
}

void main() {
  // ignore inactive points
  if (isActive == 0.) return;

  vec2 position = vec2(x, y);
  vec2 positionFract = vec2(xFract, yFract);

  vec4 color = getColor(colorId);
  vec4 borderColor = getColor(borderColorId);

  float size = size * maxSize / 255.;
  float borderSize = borderSize * maxSize / 255.;

  gl_PointSize = (size + borderSize) * pointSizeScale;

  vec2 pos = (position + translate) * scale
      + (positionFract + translateFract) * scale
      + (position + translate) * scaleFract
      + (positionFract + translateFract) * scaleFract;

  gl_Position = vec4(pos * 2. - 1., 0., 1.);

  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);
  fragColor = color;
  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;
  fragWidth = 1. / gl_PointSize;
}
`]),l&&(P.frag=P.frag.replace("smoothstep","smoothStep"),I.frag=I.frag.replace("smoothstep","smoothStep")),this.drawCircle=f(P)}i.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},i.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},i.prototype.draw=function(){for(var f=this,_=arguments.length,b=new Array(_),T=0;T<_;T++)b[T]=arguments[T];var k=this.groups;if(b.length===1&&Array.isArray(b[0])&&(b[0][0]===null||Array.isArray(b[0][0]))&&(b=b[0]),this.regl._refresh(),b.length)for(var L=0;L<b.length;L++)this.drawItem(L,b[L]);else k.forEach(function(A,I){f.drawItem(I)});return this},i.prototype.drawItem=function(f,_){var b=this.groups,T=b[f];if(typeof _=="number"&&(f=_,T=b[_],_=null),T&&T.count&&T.opacity){T.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,T,_));for(var k=[],L=1;L<T.activation.length;L++)T.activation[L]&&(T.activation[L]===!0||T.activation[L].data.length)&&k.push.apply(k,v(this.getMarkerDrawOptions(L,T,_)));k.length&&this.drawMarker(k)}},i.prototype.getMarkerDrawOptions=function(f,_,b){var T=_.range,k=_.tree,L=_.viewport,A=_.activation,I=_.selectionBuffer,P=_.count;if(this.regl,!k)return b?[r({},_,{markerTexture:this.markerTextures[f],activation:A[f],count:b.length,elements:b,offset:0})]:[r({},_,{markerTexture:this.markerTextures[f],activation:A[f],offset:0})];var S=[],E=k.range(T,{lod:!0,px:[(T[2]-T[0])/L.width,(T[3]-T[1])/L.height]});if(b){for(var z=A[f].data,D=new Uint8Array(P),j=0;j<b.length;j++){var V=b[j];D[V]=z?z[V]:1}I.subdata(D)}for(var Z=E.length;Z--;){var Q=d(E[Z],2),X=Q[0],$=Q[1];S.push(r({},_,{markerTexture:this.markerTextures[f],activation:b?I:A[f],offset:X,count:$-X}))}return S},i.prototype.update=function(){for(var f=this,_=arguments.length,b=new Array(_),T=0;T<_;T++)b[T]=arguments[T];if(b.length){b.length===1&&Array.isArray(b[0])&&(b=b[0]);var k=this.groups,L=this.gl,A=this.regl,I=this.maxSize,P=this.maxColors,S=this.palette;this.groups=k=b.map(function(E,z){var D=k[z];if(E===void 0)return D;E===null?E={positions:null}:typeof E=="function"?E={ondraw:E}:typeof E[0]=="number"&&(E={positions:E}),(E=c(E,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"})).positions===null&&(E.positions=[]),E.tooManyColors!=null&&(f.tooManyColors=E.tooManyColors),D||(k[z]=D={id:z,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:A.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:A.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:A.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:A.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:A.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},E=r({},i.defaults,E)),E.positions&&!("marker"in E)&&(E.marker=D.marker,delete D.marker),E.marker&&!("positions"in E)&&(E.positions=D.positions,delete D.positions);var j=0,V=0;if(a(D,E,[{snap:!0,size:function(ce,ye){return ce==null&&(ce=i.defaults.size),j+=ce&&ce.length?1:0,ce},borderSize:function(ce,ye){return ce==null&&(ce=i.defaults.borderSize),j+=ce&&ce.length?1:0,ce},opacity:parseFloat,color:function(ce,ye){return ce==null&&(ce=i.defaults.color),ce=f.updateColor(ce),V++,ce},borderColor:function(ce,ye){return ce==null&&(ce=i.defaults.borderColor),ce=f.updateColor(ce),V++,ce},bounds:function(ce,ye,Se){return"range"in Se||(Se.range=null),ce},positions:function(ce,ye,Se){var fe=ye.snap,ge=ye.positionBuffer,Te=ye.positionFractBuffer,le=ye.selectionBuffer;if(ce.x||ce.y)return ce.x.length?ye.xAttr={buffer:A.buffer(ce.x),offset:0,stride:4,count:ce.x.length}:ye.xAttr={buffer:ce.x.buffer,offset:4*ce.x.offset||0,stride:4*(ce.x.stride||1),count:ce.x.count},ce.y.length?ye.yAttr={buffer:A.buffer(ce.y),offset:0,stride:4,count:ce.y.length}:ye.yAttr={buffer:ce.y.buffer,offset:4*ce.y.offset||0,stride:4*(ce.y.stride||1),count:ce.y.count},ye.count=Math.max(ye.xAttr.count,ye.yAttr.count),ce;ce=h(ce,"float64");var ve=ye.count=Math.floor(ce.length/2),Me=ye.bounds=ve?t(ce,2):null;if(Se.range||ye.range||(delete ye.range,Se.range=Me),Se.marker||ye.marker||(delete ye.marker,Se.marker=null),fe&&(fe===!0||ve>fe)?ye.tree=o(ce,{bounds:Me}):fe&&fe.length&&(ye.tree=fe),ye.tree){var we={primitive:"points",usage:"static",data:ye.tree,type:"uint32"};ye.elements?ye.elements(we):ye.elements=A.elements(we)}var de=s.float32(ce);return ge({data:de,usage:"dynamic"}),Te({data:s.fract32(ce,de),usage:"dynamic"}),le({data:new Uint8Array(ve),type:"uint8",usage:"stream"}),ce}},{marker:function(ce,ye,Se){var fe=ye.activation;if(fe.forEach(function(de){return de&&de.destroy&&de.destroy()}),fe.length=0,ce&&typeof ce[0]!="number"){for(var ge=[],Te=0,le=Math.min(ce.length,ye.count);Te<le;Te++){var ve=f.addMarker(ce[Te]);ge[ve]||(ge[ve]=new Uint8Array(ye.count)),ge[ve][Te]=1}for(var Me=0;Me<ge.length;Me++)if(ge[Me]){var we={data:ge[Me],type:"uint8",usage:"static"};fe[Me]?fe[Me](we):fe[Me]=A.buffer(we),fe[Me].data=ge[Me]}}else fe[f.addMarker(ce)]=!0;return ce},range:function(ce,ye,Se){var fe=ye.bounds;if(fe)return ce||(ce=fe),ye.scale=[1/(ce[2]-ce[0]),1/(ce[3]-ce[1])],ye.translate=[-ce[0],-ce[1]],ye.scaleFract=s.fract(ye.scale),ye.translateFract=s.fract(ye.translate),ce},viewport:function(ce){return p(ce||[L.drawingBufferWidth,L.drawingBufferHeight])}}]),j){var Z=D,Q=Z.count,X=Z.size,$=Z.borderSize,re=Z.sizeBuffer,H=new Uint8Array(2*Q);if(X.length||$.length)for(var N=0;N<Q;N++)H[2*N]=Math.round(255*(X[N]==null?X:X[N])/I),H[2*N+1]=Math.round(255*($[N]==null?$:$[N])/I);re({data:H,usage:"dynamic"})}if(V){var U,te=D,B=te.count,K=te.color,J=te.borderColor,ee=te.colorBuffer;if(f.tooManyColors){if(K.length||J.length){U=new Uint8Array(8*B);for(var ne=0;ne<B;ne++){var se=K[ne];U[8*ne]=S[4*se],U[8*ne+1]=S[4*se+1],U[8*ne+2]=S[4*se+2],U[8*ne+3]=S[4*se+3];var oe=J[ne];U[8*ne+4]=S[4*oe],U[8*ne+5]=S[4*oe+1],U[8*ne+6]=S[4*oe+2],U[8*ne+7]=S[4*oe+3]}}}else if(K.length||J.length){U=new Uint8Array(4*B+2);for(var me=0;me<B;me++)K[me]!=null&&(U[4*me]=K[me]%P,U[4*me+1]=Math.floor(K[me]/P)),J[me]!=null&&(U[4*me+2]=J[me]%P,U[4*me+3]=Math.floor(J[me]/P))}ee({data:U||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return D})}},i.prototype.addMarker=function(f){var _,b=this.markerTextures,T=this.regl,k=this.markerCache,L=f==null?0:k.indexOf(f);if(L>=0)return L;if(f instanceof Uint8Array||f instanceof Uint8ClampedArray)_=f;else{_=new Uint8Array(f.length);for(var A=0,I=f.length;A<I;A++)_[A]=255*f[A]}var P=Math.floor(Math.sqrt(_.length));return L=b.length,k.push(f),b.push(T.texture({channels:1,data:_,radius:P,mag:"linear",min:"linear"})),L},i.prototype.updateColor=function(f){var _=this.paletteIds,b=this.palette,T=this.maxColors;Array.isArray(f)||(f=[f]);var k=[];if(typeof f[0]=="number"){var L=[];if(Array.isArray(f))for(var A=0;A<f.length;A+=4)L.push(f.slice(A,A+4));else for(var I=0;I<f.length;I+=4)L.push(f.subarray(I,I+4));f=L}for(var P=0;P<f.length;P++){var S=f[P];S=e(S,"uint8");var E=n(S,!1);if(_[E]==null){var z=b.length;_[E]=Math.floor(z/4),b[z]=S[0],b[z+1]=S[1],b[z+2]=S[2],b[z+3]=S[3]}k[P]=_[E]}return!this.tooManyColors&&b.length>4*T&&(this.tooManyColors=!0),this.updatePalette(b),k.length===1?k[0]:k},i.prototype.updatePalette=function(f){if(!this.tooManyColors){var _=this.maxColors,b=this.paletteTexture,T=Math.ceil(.25*f.length/_);if(T>1)for(var k=.25*(f=f.slice()).length%_;k<T*_;k++)f.push(0,0,0,0);b.height<T&&b.resize(_,T),b.subimage({width:Math.min(.25*f.length,_),height:T,data:f},0,0)}},i.prototype.destroy=function(){return this.groups.forEach(function(f){f.sizeBuffer.destroy(),f.positionBuffer.destroy(),f.positionFractBuffer.destroy(),f.colorBuffer.destroy(),f.activation.forEach(function(_){return _&&_.destroy&&_.destroy()}),f.selectionBuffer.destroy(),f.elements&&f.elements.destroy()}),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach(function(f){return f&&f.destroy&&f.destroy()}),this};var x=m("object-assign");G.exports=function(f,_){var b=new u(f,_),T=b.render.bind(b);return x(T,{render:T,update:b.update.bind(b),draw:b.draw.bind(b),destroy:b.destroy.bind(b),regl:b.regl,gl:b.gl,canvas:b.gl.canvas,groups:b.groups,markers:b.markerCache,palette:b.palette}),T}},{"@plotly/point-cluster":59,"array-bounds":71,"color-id":87,"color-normalize":89,"flatten-vertex-data":191,glslify:227,"is-iexplorer":233,"object-assign":247,"parse-rect":249,"pick-by-alias":253,"to-float32":314,"update-diff":330}],283:[function(m,G,Y){var d=m("regl-scatter2d"),v=m("pick-by-alias"),w=m("array-bounds"),y=m("raf"),e=m("array-range"),t=m("parse-rect"),n=m("flatten-vertex-data");function o(a,h){if(!(this instanceof o))return new o(a);this.traces=[],this.passes={},this.regl=a,this.scatter=d(a),this.canvas=this.scatter.canvas}function r(a,h,l){return(a.id!=null?a.id:a)<<16|(255&h)<<8|255&l}function g(a,h,l){var s,p,u,i,x=a[h],f=a[l];return x.length>2?(x[0],x[2],s=x[1],p=x[3]):x.length?(s=x[0],p=x[1]):(x.x,s=x.y,x.x+x.width,p=x.y+x.height),f.length>2?(u=f[0],i=f[2],f[1],f[3]):f.length?(u=f[0],i=f[1]):(u=f.x,f.y,i=f.x+f.width,f.y+f.height),[u,s,i,p]}function c(a){if(typeof a=="number")return[a,a,a,a];if(a.length===2)return[a[0],a[1],a[0],a[1]];var h=t(a);return[h.x,h.y,h.x+h.width,h.y+h.height]}G.exports=o,o.prototype.render=function(){for(var a,h=this,l=[],s=arguments.length;s--;)l[s]=arguments[s];return l.length&&(a=this).update.apply(a,l),this.regl.attributes.preserveDrawingBuffer?this.draw():(this.dirty?this.planned==null&&(this.planned=y(function(){h.draw(),h.dirty=!0,h.planned=null})):(this.draw(),this.dirty=!0,y(function(){h.dirty=!1})),this)},o.prototype.update=function(){for(var a,h=[],l=arguments.length;l--;)h[l]=arguments[l];if(h.length){for(var s=0;s<h.length;s++)this.updateItem(s,h[s]);this.traces=this.traces.filter(Boolean);for(var p=[],u=0,i=0;i<this.traces.length;i++){for(var x=this.traces[i],f=this.traces[i].passes,_=0;_<f.length;_++)p.push(this.passes[f[_]]);x.passOffset=u,u+=x.passes.length}return(a=this.scatter).update.apply(a,p),this}},o.prototype.updateItem=function(a,h){var l=this.regl;if(h===null)return this.traces[a]=null,this;if(!h)return this;var s,p=v(h,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),u=this.traces[a]||(this.traces[a]={id:a,buffer:l.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:t([l._gl.drawingBufferWidth,l._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(p.color!=null&&(u.color=p.color),p.size!=null&&(u.size=p.size),p.marker!=null&&(u.marker=p.marker),p.borderColor!=null&&(u.borderColor=p.borderColor),p.borderSize!=null&&(u.borderSize=p.borderSize),p.opacity!=null&&(u.opacity=p.opacity),p.viewport&&(u.viewport=t(p.viewport)),p.diagonal!=null&&(u.diagonal=p.diagonal),p.upper!=null&&(u.upper=p.upper),p.lower!=null&&(u.lower=p.lower),p.data){u.buffer(n(p.data)),u.columns=p.data.length,u.count=p.data[0].length,u.bounds=[];for(var i=0;i<u.columns;i++)u.bounds[i]=w(p.data[i],1)}p.range&&(u.range=p.range,s=u.range&&typeof u.range[0]!="number"),p.domain&&(u.domain=p.domain);var x=!1;p.padding!=null&&(Array.isArray(p.padding)&&p.padding.length===u.columns&&typeof p.padding[p.padding.length-1]=="number"?(u.padding=p.padding.map(c),x=!0):u.padding=c(p.padding));var f=u.columns,_=u.count,b=u.viewport.width,T=u.viewport.height,k=u.viewport.x,L=u.viewport.y,A=b/f,I=T/f;u.passes=[];for(var P=0;P<f;P++)for(var S=0;S<f;S++)if((u.diagonal||S!==P)&&(u.upper||!(P>S))&&(u.lower||!(P<S))){var E=r(u.id,P,S),z=this.passes[E]||(this.passes[E]={});if(p.data&&(p.transpose?z.positions={x:{buffer:u.buffer,offset:S,count:_,stride:f},y:{buffer:u.buffer,offset:P,count:_,stride:f}}:z.positions={x:{buffer:u.buffer,offset:S*_,count:_},y:{buffer:u.buffer,offset:P*_,count:_}},z.bounds=g(u.bounds,P,S)),p.domain||p.viewport||p.data){var D=x?g(u.padding,P,S):u.padding;if(u.domain){var j=g(u.domain,P,S),V=j[0],Z=j[1],Q=j[2],X=j[3];z.viewport=[k+V*b+D[0],L+Z*T+D[1],k+Q*b-D[2],L+X*T-D[3]]}else z.viewport=[k+S*A+A*D[0],L+P*I+I*D[1],k+(S+1)*A-A*D[2],L+(P+1)*I-I*D[3]]}p.color&&(z.color=u.color),p.size&&(z.size=u.size),p.marker&&(z.marker=u.marker),p.borderSize&&(z.borderSize=u.borderSize),p.borderColor&&(z.borderColor=u.borderColor),p.opacity&&(z.opacity=u.opacity),p.range&&(z.range=s?g(u.range,P,S):u.range||z.bounds),u.passes.push(E)}return this},o.prototype.draw=function(){for(var a,h=[],l=arguments.length;l--;)h[l]=arguments[l];if(h.length){for(var s=[],p=0;p<h.length;p++)if(typeof h[p]=="number"){var u=this.traces[h[p]],i=u.passes,x=u.passOffset;s.push.apply(s,e(x,x+i.length))}else if(h[p].length){var f=h[p],_=this.traces[p],b=_.passes,T=_.passOffset;b=b.map(function(k,L){s[T+L]=f})}(a=this.scatter).draw.apply(a,s)}else this.scatter.draw();return this},o.prototype.destroy=function(){return this.traces.forEach(function(a){a.buffer&&a.buffer.destroy&&a.buffer.destroy()}),this.traces=null,this.passes=null,this.scatter.destroy(),this}},{"array-bounds":71,"array-range":74,"flatten-vertex-data":191,"parse-rect":249,"pick-by-alias":253,raf:279,"regl-scatter2d":282}],284:[function(m,G,Y){(function(d,v){typeof Y=="object"&&G!==void 0?G.exports=v():d.createREGL=v()})(this,function(){function d(pe,_e){this.id=K++,this.type=pe,this.data=_e}function v(pe){return"["+function _e(Be){if(Be.length===0)return[];var He=Be.charAt(0),Je=Be.charAt(Be.length-1);if(1<Be.length&&He===Je&&(He==='"'||He==="'"))return['"'+Be.substr(1,Be.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(He=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(Be))return _e(Be.substr(0,He.index)).concat(_e(He[1])).concat(_e(Be.substr(He.index+He[0].length)));if((He=Be.split(".")).length===1)return['"'+Be.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(Be=[],Je=0;Je<He.length;++Je)Be=Be.concat(_e(He[Je]));return Be}(pe).join("][")+"]"}function w(pe){return typeof pe=="string"?pe.split():pe}function y(pe){return typeof pe=="string"?document.querySelector(pe):pe}function e(pe){var _e,Be,He,Je,Ze=pe||{};pe={};var ct=[],lt=[],At=typeof window>"u"?1:window.devicePixelRatio,Ot=!1,it={},ht=function(Mt){},Ut=function(){};if(typeof Ze=="string"?_e=document.querySelector(Ze):typeof Ze=="object"&&(typeof Ze.nodeName=="string"&&typeof Ze.appendChild=="function"&&typeof Ze.getBoundingClientRect=="function"?_e=Ze:typeof Ze.drawArrays=="function"||typeof Ze.drawElements=="function"?He=(Je=Ze).canvas:("gl"in Ze?Je=Ze.gl:"canvas"in Ze?He=y(Ze.canvas):"container"in Ze&&(Be=y(Ze.container)),"attributes"in Ze&&(pe=Ze.attributes),"extensions"in Ze&&(ct=w(Ze.extensions)),"optionalExtensions"in Ze&&(lt=w(Ze.optionalExtensions)),"onDone"in Ze&&(ht=Ze.onDone),"profile"in Ze&&(Ot=!!Ze.profile),"pixelRatio"in Ze&&(At=+Ze.pixelRatio),"cachedCode"in Ze&&(it=Ze.cachedCode))),_e&&(_e.nodeName.toLowerCase()==="canvas"?He=_e:Be=_e),!Je){if(!He){if(!(_e=function(Mt,It,Le){function Xe(){var St=window.innerWidth,Vt=window.innerHeight;Mt!==document.body&&(St=(Vt=pt.getBoundingClientRect()).right-Vt.left,Vt=Vt.bottom-Vt.top),pt.width=Le*St,pt.height=Le*Vt}var ot,pt=document.createElement("canvas");return B(pt.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),Mt.appendChild(pt),Mt===document.body&&(pt.style.position="absolute",B(Mt.style,{margin:0,padding:0})),Mt!==document.body&&typeof ResizeObserver=="function"?(ot=new ResizeObserver(function(){setTimeout(Xe)})).observe(Mt):window.addEventListener("resize",Xe,!1),Xe(),{canvas:pt,onDestroy:function(){ot?ot.disconnect():window.removeEventListener("resize",Xe),Mt.removeChild(pt)}}}(Be||document.body,0,At)))return null;He=_e.canvas,Ut=_e.onDestroy}pe.premultipliedAlpha===void 0&&(pe.premultipliedAlpha=!0),Je=function(Mt,It){function Le(Xe){try{return Mt.getContext(Xe,It)}catch{return null}}return Le("webgl")||Le("experimental-webgl")||Le("webgl-experimental")}(He,pe)}return Je?{gl:Je,canvas:He,container:Be,extensions:ct,optionalExtensions:lt,pixelRatio:At,profile:Ot,cachedCode:it,onDone:ht,onDestroy:Ut}:(Ut(),ht("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function t(pe,_e){for(var Be=Array(pe),He=0;He<pe;++He)Be[He]=_e(He);return Be}function n(pe){var _e,Be;return _e=(65535<pe)<<4,_e|=Be=(255<(pe>>>=_e))<<3,(_e|=Be=(15<(pe>>>=Be))<<2)|(Be=(3<(pe>>>=Be))<<1)|pe>>>Be>>1}function o(){function pe(He){e:{for(var Je=16;268435456>=Je;Je*=16)if(He<=Je){He=Je;break e}He=0}return 0<(Je=Be[n(He)>>2]).length?Je.pop():new ArrayBuffer(He)}function _e(He){Be[n(He.byteLength)>>2].push(He)}var Be=t(8,function(){return[]});return{alloc:pe,free:_e,allocType:function(He,Je){var Ze=null;switch(He){case 5120:Ze=new Int8Array(pe(Je),0,Je);break;case 5121:Ze=new Uint8Array(pe(Je),0,Je);break;case 5122:Ze=new Int16Array(pe(2*Je),0,Je);break;case 5123:Ze=new Uint16Array(pe(2*Je),0,Je);break;case 5124:Ze=new Int32Array(pe(4*Je),0,Je);break;case 5125:Ze=new Uint32Array(pe(4*Je),0,Je);break;case 5126:Ze=new Float32Array(pe(4*Je),0,Je);break;default:return null}return Ze.length!==Je?Ze.subarray(0,Je):Ze},freeType:function(He){_e(He.buffer)}}}function r(pe){return!!pe&&typeof pe=="object"&&Array.isArray(pe.shape)&&Array.isArray(pe.stride)&&typeof pe.offset=="number"&&pe.shape.length===pe.stride.length&&(Array.isArray(pe.data)||me(pe.data))}function g(pe,_e,Be,He,Je,Ze){for(var ct=0;ct<_e;++ct)for(var lt=pe[ct],At=0;At<Be;++At)for(var Ot=lt[At],it=0;it<He;++it)Je[Ze++]=Ot[it]}function c(pe){return 0|Se[Object.prototype.toString.call(pe)]}function a(pe,_e){for(var Be=0;Be<_e.length;++Be)pe[Be]=_e[Be]}function h(pe,_e,Be,He,Je,Ze,ct){for(var lt=0,At=0;At<Be;++At)for(var Ot=0;Ot<He;++Ot)pe[lt++]=_e[Je*At+Ze*Ot+ct]}function l(pe,_e,Be,He){function Je(ht){this.id=At++,this.buffer=pe.createBuffer(),this.type=ht,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,Be.profile&&(this.stats={size:0})}function Ze(ht,Ut,Mt){ht.byteLength=Ut.byteLength,pe.bufferData(ht.type,Ut,Mt)}function ct(ht,Ut,Mt,It,Le,Xe){if(ht.usage=Mt,Array.isArray(Ut)){if(ht.dtype=It||5126,0<Ut.length)if(Array.isArray(Ut[0])){Le=le(Ut);for(var ot=It=1;ot<Le.length;++ot)It*=Le[ot];ht.dimension=It,Ze(ht,Ut=Te(Ut,Le,ht.dtype),Mt),Xe?ht.persistentData=Ut:se.freeType(Ut)}else typeof Ut[0]=="number"?(ht.dimension=Le,a(Le=se.allocType(ht.dtype,Ut.length),Ut),Ze(ht,Le,Mt),Xe?ht.persistentData=Le:se.freeType(Le)):me(Ut[0])&&(ht.dimension=Ut[0].length,ht.dtype=It||c(Ut[0])||5126,Ze(ht,Ut=Te(Ut,[Ut.length,Ut[0].length],ht.dtype),Mt),Xe?ht.persistentData=Ut:se.freeType(Ut))}else if(me(Ut))ht.dtype=It||c(Ut),ht.dimension=Le,Ze(ht,Ut,Mt),Xe&&(ht.persistentData=new Uint8Array(new Uint8Array(Ut.buffer)));else if(r(Ut)){Le=Ut.shape;var pt=Ut.stride,St=(ot=Ut.offset,0),Vt=0,Jt=0,qt=0;Le.length===1?(St=Le[0],Vt=1,Jt=pt[0],qt=0):Le.length===2&&(St=Le[0],Vt=Le[1],Jt=pt[0],qt=pt[1]),ht.dtype=It||c(Ut.data)||5126,ht.dimension=Vt,h(Le=se.allocType(ht.dtype,St*Vt),Ut.data,St,Vt,Jt,qt,ot),Ze(ht,Le,Mt),Xe?ht.persistentData=Le:se.freeType(Le)}else Ut instanceof ArrayBuffer&&(ht.dtype=5121,ht.dimension=Le,Ze(ht,Ut,Mt),Xe&&(ht.persistentData=new Uint8Array(new Uint8Array(Ut))))}function lt(ht){_e.bufferCount--,He(ht),pe.deleteBuffer(ht.buffer),ht.buffer=null,delete Ot[ht.id]}var At=0,Ot={};Je.prototype.bind=function(){pe.bindBuffer(this.type,this.buffer)},Je.prototype.destroy=function(){lt(this)};var it=[];return Be.profile&&(_e.getTotalBufferSize=function(){var ht=0;return Object.keys(Ot).forEach(function(Ut){ht+=Ot[Ut].stats.size}),ht}),{create:function(ht,Ut,Mt,It){function Le(ot){var pt=35044,St=null,Vt=0,Jt=0,qt=1;return Array.isArray(ot)||me(ot)||r(ot)||ot instanceof ArrayBuffer?St=ot:typeof ot=="number"?Vt=0|ot:ot&&("data"in ot&&(St=ot.data),"usage"in ot&&(pt=ge[ot.usage]),"type"in ot&&(Jt=fe[ot.type]),"dimension"in ot&&(qt=0|ot.dimension),"length"in ot&&(Vt=0|ot.length)),Xe.bind(),St?ct(Xe,St,pt,Jt,qt,It):(Vt&&pe.bufferData(Xe.type,Vt,pt),Xe.dtype=Jt||5121,Xe.usage=pt,Xe.dimension=qt,Xe.byteLength=Vt),Be.profile&&(Xe.stats.size=Xe.byteLength*ve[Xe.dtype]),Le}_e.bufferCount++;var Xe=new Je(Ut);return Ot[Xe.id]=Xe,Mt||Le(ht),Le._reglType="buffer",Le._buffer=Xe,Le.subdata=function(ot,pt){var St,Vt=0|(pt||0);if(Xe.bind(),me(ot)||ot instanceof ArrayBuffer)pe.bufferSubData(Xe.type,Vt,ot);else if(Array.isArray(ot)){if(0<ot.length)if(typeof ot[0]=="number"){var Jt=se.allocType(Xe.dtype,ot.length);a(Jt,ot),pe.bufferSubData(Xe.type,Vt,Jt),se.freeType(Jt)}else(Array.isArray(ot[0])||me(ot[0]))&&(St=le(ot),Jt=Te(ot,St,Xe.dtype),pe.bufferSubData(Xe.type,Vt,Jt),se.freeType(Jt))}else if(r(ot)){St=ot.shape;var qt=ot.stride,gr=Jt=0,Cr=0,mr=0;St.length===1?(Jt=St[0],gr=1,Cr=qt[0],mr=0):St.length===2&&(Jt=St[0],gr=St[1],Cr=qt[0],mr=qt[1]),St=Array.isArray(ot.data)?Xe.dtype:c(ot.data),h(St=se.allocType(St,Jt*gr),ot.data,Jt,gr,Cr,mr,ot.offset),pe.bufferSubData(Xe.type,Vt,St),se.freeType(St)}return Le},Be.profile&&(Le.stats=Xe.stats),Le.destroy=function(){lt(Xe)},Le},createStream:function(ht,Ut){var Mt=it.pop();return Mt||(Mt=new Je(ht)),Mt.bind(),ct(Mt,Ut,35040,0,1,!1),Mt},destroyStream:function(ht){it.push(ht)},clear:function(){ce(Ot).forEach(lt),it.forEach(lt)},getBuffer:function(ht){return ht&&ht._buffer instanceof Je?ht._buffer:null},restore:function(){ce(Ot).forEach(function(ht){ht.buffer=pe.createBuffer(),pe.bindBuffer(ht.type,ht.buffer),pe.bufferData(ht.type,ht.persistentData||ht.byteLength,ht.usage)})},_initBuffer:ct}}function s(pe,_e,Be,He){function Je(ht){this.id=At++,lt[this.id]=this,this.buffer=ht,this.primType=4,this.type=this.vertCount=0}function Ze(ht,Ut,Mt,It,Le,Xe,ot){var pt;if(ht.buffer.bind(),Ut?((pt=ot)||me(Ut)&&(!r(Ut)||me(Ut.data))||(pt=_e.oes_element_index_uint?5125:5123),Be._initBuffer(ht.buffer,Ut,Mt,pt,3)):(pe.bufferData(34963,Xe,Mt),ht.buffer.dtype=pt||5121,ht.buffer.usage=Mt,ht.buffer.dimension=3,ht.buffer.byteLength=Xe),pt=ot,!ot){switch(ht.buffer.dtype){case 5121:case 5120:pt=5121;break;case 5123:case 5122:pt=5123;break;case 5125:case 5124:pt=5125}ht.buffer.dtype=pt}ht.type=pt,0>(Ut=Le)&&(Ut=ht.buffer.byteLength,pt===5123?Ut>>=1:pt===5125&&(Ut>>=2)),ht.vertCount=Ut,Ut=It,0>It&&(Ut=4,(It=ht.buffer.dimension)===1&&(Ut=0),It===2&&(Ut=1),It===3&&(Ut=4)),ht.primType=Ut}function ct(ht){He.elementsCount--,delete lt[ht.id],ht.buffer.destroy(),ht.buffer=null}var lt={},At=0,Ot={uint8:5121,uint16:5123};_e.oes_element_index_uint&&(Ot.uint32=5125),Je.prototype.bind=function(){this.buffer.bind()};var it=[];return{create:function(ht,Ut){function Mt(Xe){if(Xe)if(typeof Xe=="number")It(Xe),Le.primType=4,Le.vertCount=0|Xe,Le.type=5121;else{var ot=null,pt=35044,St=-1,Vt=-1,Jt=0,qt=0;Array.isArray(Xe)||me(Xe)||r(Xe)?ot=Xe:("data"in Xe&&(ot=Xe.data),"usage"in Xe&&(pt=ge[Xe.usage]),"primitive"in Xe&&(St=Me[Xe.primitive]),"count"in Xe&&(Vt=0|Xe.count),"type"in Xe&&(qt=Ot[Xe.type]),"length"in Xe?Jt=0|Xe.length:(Jt=Vt,qt===5123||qt===5122?Jt*=2:qt!==5125&&qt!==5124||(Jt*=4))),Ze(Le,ot,pt,St,Vt,Jt,qt)}else It(),Le.primType=4,Le.vertCount=0,Le.type=5121;return Mt}var It=Be.create(null,34963,!0),Le=new Je(It._buffer);return He.elementsCount++,Mt(ht),Mt._reglType="elements",Mt._elements=Le,Mt.subdata=function(Xe,ot){return It.subdata(Xe,ot),Mt},Mt.destroy=function(){ct(Le)},Mt},createStream:function(ht){var Ut=it.pop();return Ut||(Ut=new Je(Be.create(null,34963,!0,!1)._buffer)),Ze(Ut,ht,35040,-1,-1,0,0),Ut},destroyStream:function(ht){it.push(ht)},getElements:function(ht){return typeof ht=="function"&&ht._elements instanceof Je?ht._elements:null},clear:function(){ce(lt).forEach(ct)}}}function p(pe){for(var _e=se.allocType(5123,pe.length),Be=0;Be<pe.length;++Be)if(isNaN(pe[Be]))_e[Be]=65535;else if(1/0===pe[Be])_e[Be]=31744;else if(-1/0===pe[Be])_e[Be]=64512;else{we[0]=pe[Be];var He=(Ze=de[0])>>>31<<15,Je=(Ze<<1>>>24)-127,Ze=Ze>>13&1023;_e[Be]=-24>Je?He:-14>Je?He+(Ze+1024>>-14-Je):15<Je?He+31744:He+(Je+15<<10)+Ze}return _e}function u(pe){return Array.isArray(pe)||me(pe)}function i(pe){return"[object "+pe+"]"}function x(pe){return Array.isArray(pe)&&(pe.length===0||typeof pe[0]=="number")}function f(pe){return!(!Array.isArray(pe)||pe.length===0||!u(pe[0]))}function _(pe){return Object.prototype.toString.call(pe)}function b(pe){if(!pe)return!1;var _e=_(pe);return 0<=at.indexOf(_e)||x(pe)||f(pe)||r(pe)}function T(pe,_e){pe.type===36193?(pe.data=p(_e),se.freeType(_e)):pe.data=_e}function k(pe,_e,Be,He,Je,Ze){if(pe=xt[pe]!==void 0?xt[pe]:Oe[pe]*gt[_e],Ze&&(pe*=6),Je){for(He=0;1<=Be;)He+=pe*Be*Be,Be/=2;return He}return pe*Be*He}function L(pe,_e,Be,He,Je,Ze,ct){function lt(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function At(Rt,or){Rt.internalformat=or.internalformat,Rt.format=or.format,Rt.type=or.type,Rt.compressed=or.compressed,Rt.premultiplyAlpha=or.premultiplyAlpha,Rt.flipY=or.flipY,Rt.unpackAlignment=or.unpackAlignment,Rt.colorSpace=or.colorSpace,Rt.width=or.width,Rt.height=or.height,Rt.channels=or.channels}function Ot(Rt,or){if(typeof or=="object"&&or){"premultiplyAlpha"in or&&(Rt.premultiplyAlpha=or.premultiplyAlpha),"flipY"in or&&(Rt.flipY=or.flipY),"alignment"in or&&(Rt.unpackAlignment=or.alignment),"colorSpace"in or&&(Rt.colorSpace=Vr[or.colorSpace]),"type"in or&&(Rt.type=Xr[or.type]);var wt=Rt.width,ir=Rt.height,ar=Rt.channels,Dr=!1;"shape"in or?(wt=or.shape[0],ir=or.shape[1],or.shape.length===3&&(ar=or.shape[2],Dr=!0)):("radius"in or&&(wt=ir=or.radius),"width"in or&&(wt=or.width),"height"in or&&(ir=or.height),"channels"in or&&(ar=or.channels,Dr=!0)),Rt.width=0|wt,Rt.height=0|ir,Rt.channels=0|ar,wt=!1,"format"in or&&(wt=or.format,ir=Rt.internalformat=cn[wt],Rt.format=bn[ir],wt in Xr&&!("type"in or)&&(Rt.type=Xr[wt]),wt in an&&(Rt.compressed=!0),wt=!0),!Dr&&wt?Rt.channels=Oe[Rt.format]:Dr&&!wt&&Rt.channels!==De[Rt.format]&&(Rt.format=Rt.internalformat=De[Rt.channels])}}function it(Rt){pe.pixelStorei(37440,Rt.flipY),pe.pixelStorei(37441,Rt.premultiplyAlpha),pe.pixelStorei(37443,Rt.colorSpace),pe.pixelStorei(3317,Rt.unpackAlignment)}function ht(){lt.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Ut(Rt,or){var wt=null;if(b(or)?wt=or:or&&(Ot(Rt,or),"x"in or&&(Rt.xOffset=0|or.x),"y"in or&&(Rt.yOffset=0|or.y),b(or.data)&&(wt=or.data)),or.copy){var ir=Je.viewportWidth,ar=Je.viewportHeight;Rt.width=Rt.width||ir-Rt.xOffset,Rt.height=Rt.height||ar-Rt.yOffset,Rt.needsCopy=!0}else if(wt){if(me(wt))Rt.channels=Rt.channels||4,Rt.data=wt,"type"in or||Rt.type!==5121||(Rt.type=0|Se[Object.prototype.toString.call(wt)]);else if(x(wt)){switch(Rt.channels=Rt.channels||4,ar=(ir=wt).length,Rt.type){case 5121:case 5123:case 5125:case 5126:(ar=se.allocType(Rt.type,ar)).set(ir),Rt.data=ar;break;case 36193:Rt.data=p(ir)}Rt.alignment=1,Rt.needsFree=!0}else if(r(wt)){ir=wt.data,Array.isArray(ir)||Rt.type!==5121||(Rt.type=0|Se[Object.prototype.toString.call(ir)]),ar=wt.shape;var Dr,Pr,Er,Ar,vr=wt.stride;ar.length===3?(Er=ar[2],Ar=vr[2]):Ar=Er=1,Dr=ar[0],Pr=ar[1],ar=vr[0],vr=vr[1],Rt.alignment=1,Rt.width=Dr,Rt.height=Pr,Rt.channels=Er,Rt.format=Rt.internalformat=De[Er],Rt.needsFree=!0,Dr=Ar,wt=wt.offset,Er=Rt.width,Ar=Rt.height,Pr=Rt.channels;for(var wr=se.allocType(Rt.type===36193?5126:Rt.type,Er*Ar*Pr),Mr=0,Lr=0;Lr<Ar;++Lr)for(var Zr=0;Zr<Er;++Zr)for(var Yr=0;Yr<Pr;++Yr)wr[Mr++]=ir[ar*Zr+vr*Lr+Dr*Yr+wt];T(Rt,wr)}else if(_(wt)===Ve||_(wt)===Fe||_(wt)===ze)_(wt)===Ve||_(wt)===Fe?Rt.element=wt:Rt.element=wt.canvas,Rt.width=Rt.element.width,Rt.height=Rt.element.height,Rt.channels=4;else if(_(wt)===Re)Rt.element=wt,Rt.width=wt.width,Rt.height=wt.height,Rt.channels=4;else if(_(wt)===We)Rt.element=wt,Rt.width=wt.naturalWidth,Rt.height=wt.naturalHeight,Rt.channels=4;else if(_(wt)===$e)Rt.element=wt,Rt.width=wt.videoWidth,Rt.height=wt.videoHeight,Rt.channels=4;else if(f(wt)){for(ir=Rt.width||wt[0].length,ar=Rt.height||wt.length,vr=Rt.channels,vr=u(wt[0][0])?vr||wt[0][0].length:vr||1,Dr=ye.shape(wt),Er=1,Ar=0;Ar<Dr.length;++Ar)Er*=Dr[Ar];Er=se.allocType(Rt.type===36193?5126:Rt.type,Er),ye.flatten(wt,Dr,"",Er),T(Rt,Er),Rt.alignment=1,Rt.width=ir,Rt.height=ar,Rt.channels=vr,Rt.format=Rt.internalformat=De[vr],Rt.needsFree=!0}}else Rt.width=Rt.width||1,Rt.height=Rt.height||1,Rt.channels=Rt.channels||4}function Mt(Rt,or,wt,ir,ar){var Dr=Rt.element,Pr=Rt.data,Er=Rt.internalformat,Ar=Rt.format,vr=Rt.type,wr=Rt.width,Mr=Rt.height;it(Rt),Dr?pe.texSubImage2D(or,ar,wt,ir,Ar,vr,Dr):Rt.compressed?pe.compressedTexSubImage2D(or,ar,wt,ir,Er,wr,Mr,Pr):Rt.needsCopy?(He(),pe.copyTexSubImage2D(or,ar,wt,ir,Rt.xOffset,Rt.yOffset,wr,Mr)):pe.texSubImage2D(or,ar,wt,ir,wr,Mr,Ar,vr,Pr)}function It(){return nn.pop()||new ht}function Le(Rt){Rt.needsFree&&se.freeType(Rt.data),ht.call(Rt),nn.push(Rt)}function Xe(){lt.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function ot(Rt,or,wt){var ir=Rt.images[0]=It();Rt.mipmask=1,ir.width=Rt.width=or,ir.height=Rt.height=wt,ir.channels=Rt.channels=4}function pt(Rt,or){var wt=null;if(b(or))At(wt=Rt.images[0]=It(),Rt),Ut(wt,or),Rt.mipmask=1;else if(Ot(Rt,or),Array.isArray(or.mipmap))for(var ir=or.mipmap,ar=0;ar<ir.length;++ar)At(wt=Rt.images[ar]=It(),Rt),wt.width>>=ar,wt.height>>=ar,Ut(wt,ir[ar]),Rt.mipmask|=1<<ar;else At(wt=Rt.images[0]=It(),Rt),Ut(wt,or),Rt.mipmask=1;At(Rt,Rt.images[0])}function St(Rt,or){for(var wt=Rt.images,ir=0;ir<wt.length&&wt[ir];++ir){var ar=wt[ir],Dr=or,Pr=ir,Er=ar.element,Ar=ar.data,vr=ar.internalformat,wr=ar.format,Mr=ar.type,Lr=ar.width,Zr=ar.height;it(ar),Er?pe.texImage2D(Dr,Pr,wr,wr,Mr,Er):ar.compressed?pe.compressedTexImage2D(Dr,Pr,vr,Lr,Zr,0,Ar):ar.needsCopy?(He(),pe.copyTexImage2D(Dr,Pr,wr,ar.xOffset,ar.yOffset,Lr,Zr,0)):pe.texImage2D(Dr,Pr,wr,Lr,Zr,0,wr,Mr,Ar||null)}}function Vt(){var Rt=pn.pop()||new Xe;lt.call(Rt);for(var or=Rt.mipmask=0;16>or;++or)Rt.images[or]=null;return Rt}function Jt(Rt){for(var or=Rt.images,wt=0;wt<or.length;++wt)or[wt]&&Le(or[wt]),or[wt]=null;pn.push(Rt)}function qt(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function gr(Rt,or){"min"in or&&(Rt.minFilter=Rr[or.min],0<=Ie.indexOf(Rt.minFilter)&&!("faces"in or)&&(Rt.genMipmaps=!0)),"mag"in or&&(Rt.magFilter=Ir[or.mag]);var wt=Rt.wrapS,ir=Rt.wrapT;if("wrap"in or){var ar=or.wrap;typeof ar=="string"?wt=ir=_r[ar]:Array.isArray(ar)&&(wt=_r[ar[0]],ir=_r[ar[1]])}else"wrapS"in or&&(wt=_r[or.wrapS]),"wrapT"in or&&(ir=_r[or.wrapT]);if(Rt.wrapS=wt,Rt.wrapT=ir,"anisotropic"in or&&(Rt.anisotropic=or.anisotropic),"mipmap"in or){switch(wt=!1,typeof or.mipmap){case"string":Rt.mipmapHint=dr[or.mipmap],wt=Rt.genMipmaps=!0;break;case"boolean":wt=Rt.genMipmaps=or.mipmap;break;case"object":Rt.genMipmaps=!1,wt=!0}!wt||"min"in or||(Rt.minFilter=9984)}}function Cr(Rt,or){pe.texParameteri(or,10241,Rt.minFilter),pe.texParameteri(or,10240,Rt.magFilter),pe.texParameteri(or,10242,Rt.wrapS),pe.texParameteri(or,10243,Rt.wrapT),_e.ext_texture_filter_anisotropic&&pe.texParameteri(or,34046,Rt.anisotropic),Rt.genMipmaps&&(pe.hint(33170,Rt.mipmapHint),pe.generateMipmap(or))}function mr(Rt){lt.call(this),this.mipmask=0,this.internalformat=6408,this.id=qn++,this.refCount=1,this.target=Rt,this.texture=pe.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new qt,ct.profile&&(this.stats={size:0})}function tr(Rt){pe.activeTexture(33984),pe.bindTexture(Rt.target,Rt.texture)}function nr(){var Rt=jr[0];Rt?pe.bindTexture(Rt.target,Rt.texture):pe.bindTexture(3553,null)}function Qt(Rt){var or=Rt.texture,wt=Rt.unit,ir=Rt.target;0<=wt&&(pe.activeTexture(33984+wt),pe.bindTexture(ir,null),jr[wt]=null),pe.deleteTexture(or),Rt.texture=null,Rt.params=null,Rt.pixels=null,Rt.refCount=0,delete sr[Rt.id],Ze.textureCount--}var dr={"don't care":4352,"dont care":4352,nice:4354,fast:4353},_r={repeat:10497,clamp:33071,mirror:33648},Ir={nearest:9728,linear:9729},Rr=B({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Ir),Vr={none:0,browser:37444},Xr={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},cn={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},an={};_e.ext_srgb&&(cn.srgb=35904,cn.srgba=35906),_e.oes_texture_float&&(Xr.float32=Xr.float=5126),_e.oes_texture_half_float&&(Xr.float16=Xr["half float"]=36193),_e.webgl_depth_texture&&(B(cn,{depth:6402,"depth stencil":34041}),B(Xr,{uint16:5123,uint32:5125,"depth stencil":34042})),_e.webgl_compressed_texture_s3tc&&B(an,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),_e.webgl_compressed_texture_atc&&B(an,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),_e.webgl_compressed_texture_pvrtc&&B(an,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),_e.webgl_compressed_texture_etc1&&(an["rgb etc1"]=36196);var zn=Array.prototype.slice.call(pe.getParameter(34467));Object.keys(an).forEach(function(Rt){var or=an[Rt];0<=zn.indexOf(or)&&(cn[Rt]=or)});var on=Object.keys(cn);Be.textureFormats=on;var Tn=[];Object.keys(cn).forEach(function(Rt){Tn[cn[Rt]]=Rt});var Mn=[];Object.keys(Xr).forEach(function(Rt){Mn[Xr[Rt]]=Rt});var ei=[];Object.keys(Ir).forEach(function(Rt){ei[Ir[Rt]]=Rt});var Hr=[];Object.keys(Rr).forEach(function(Rt){Hr[Rr[Rt]]=Rt});var ln=[];Object.keys(_r).forEach(function(Rt){ln[_r[Rt]]=Rt});var bn=on.reduce(function(Rt,or){var wt=cn[or];return wt===6409||wt===6406||wt===6409||wt===6410||wt===6402||wt===34041||_e.ext_srgb&&(wt===35904||wt===35906)?Rt[wt]=wt:wt===32855||0<=or.indexOf("rgba")?Rt[wt]=6408:Rt[wt]=6407,Rt},{}),nn=[],pn=[],qn=0,sr={},xr=Be.maxTextureUnits,jr=Array(xr).map(function(){return null});return B(mr.prototype,{bind:function(){this.bindCount+=1;var Rt=this.unit;if(0>Rt){for(var or=0;or<xr;++or){var wt=jr[or];if(wt){if(0<wt.bindCount)continue;wt.unit=-1}jr[or]=this,Rt=or;break}ct.profile&&Ze.maxTextureUnits<Rt+1&&(Ze.maxTextureUnits=Rt+1),this.unit=Rt,pe.activeTexture(33984+Rt),pe.bindTexture(this.target,this.texture)}return Rt},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&Qt(this)}}),ct.profile&&(Ze.getTotalTextureSize=function(){var Rt=0;return Object.keys(sr).forEach(function(or){Rt+=sr[or].stats.size}),Rt}),{create2D:function(Rt,or){function wt(ar,Dr){var Pr=ir.texInfo;qt.call(Pr);var Er=Vt();return typeof ar=="number"?ot(Er,0|ar,typeof Dr=="number"?0|Dr:0|ar):ar?(gr(Pr,ar),pt(Er,ar)):ot(Er,1,1),Pr.genMipmaps&&(Er.mipmask=(Er.width<<1)-1),ir.mipmask=Er.mipmask,At(ir,Er),ir.internalformat=Er.internalformat,wt.width=Er.width,wt.height=Er.height,tr(ir),St(Er,3553),Cr(Pr,3553),nr(),Jt(Er),ct.profile&&(ir.stats.size=k(ir.internalformat,ir.type,Er.width,Er.height,Pr.genMipmaps,!1)),wt.format=Tn[ir.internalformat],wt.type=Mn[ir.type],wt.mag=ei[Pr.magFilter],wt.min=Hr[Pr.minFilter],wt.wrapS=ln[Pr.wrapS],wt.wrapT=ln[Pr.wrapT],wt}var ir=new mr(3553);return sr[ir.id]=ir,Ze.textureCount++,wt(Rt,or),wt.subimage=function(ar,Dr,Pr,Er){Dr|=0,Pr|=0,Er|=0;var Ar=It();return At(Ar,ir),Ar.width=0,Ar.height=0,Ut(Ar,ar),Ar.width=Ar.width||(ir.width>>Er)-Dr,Ar.height=Ar.height||(ir.height>>Er)-Pr,tr(ir),Mt(Ar,3553,Dr,Pr,Er),nr(),Le(Ar),wt},wt.resize=function(ar,Dr){var Pr=0|ar,Er=0|Dr||Pr;if(Pr===ir.width&&Er===ir.height)return wt;wt.width=ir.width=Pr,wt.height=ir.height=Er,tr(ir);for(var Ar=0;ir.mipmask>>Ar;++Ar){var vr=Pr>>Ar,wr=Er>>Ar;if(!vr||!wr)break;pe.texImage2D(3553,Ar,ir.format,vr,wr,0,ir.format,ir.type,null)}return nr(),ct.profile&&(ir.stats.size=k(ir.internalformat,ir.type,Pr,Er,!1,!1)),wt},wt._reglType="texture2d",wt._texture=ir,ct.profile&&(wt.stats=ir.stats),wt.destroy=function(){ir.decRef()},wt},createCube:function(Rt,or,wt,ir,ar,Dr){function Pr(vr,wr,Mr,Lr,Zr,Yr){var rn,sn=Er.texInfo;for(qt.call(sn),rn=0;6>rn;++rn)Ar[rn]=Vt();if(typeof vr!="number"&&vr){if(typeof vr=="object")if(wr)pt(Ar[0],vr),pt(Ar[1],wr),pt(Ar[2],Mr),pt(Ar[3],Lr),pt(Ar[4],Zr),pt(Ar[5],Yr);else if(gr(sn,vr),Ot(Er,vr),"faces"in vr)for(vr=vr.faces,rn=0;6>rn;++rn)At(Ar[rn],Er),pt(Ar[rn],vr[rn]);else for(rn=0;6>rn;++rn)pt(Ar[rn],vr)}else for(vr=0|vr||1,rn=0;6>rn;++rn)ot(Ar[rn],vr,vr);for(At(Er,Ar[0]),Er.mipmask=sn.genMipmaps?(Ar[0].width<<1)-1:Ar[0].mipmask,Er.internalformat=Ar[0].internalformat,Pr.width=Ar[0].width,Pr.height=Ar[0].height,tr(Er),rn=0;6>rn;++rn)St(Ar[rn],34069+rn);for(Cr(sn,34067),nr(),ct.profile&&(Er.stats.size=k(Er.internalformat,Er.type,Pr.width,Pr.height,sn.genMipmaps,!0)),Pr.format=Tn[Er.internalformat],Pr.type=Mn[Er.type],Pr.mag=ei[sn.magFilter],Pr.min=Hr[sn.minFilter],Pr.wrapS=ln[sn.wrapS],Pr.wrapT=ln[sn.wrapT],rn=0;6>rn;++rn)Jt(Ar[rn]);return Pr}var Er=new mr(34067);sr[Er.id]=Er,Ze.cubeCount++;var Ar=Array(6);return Pr(Rt,or,wt,ir,ar,Dr),Pr.subimage=function(vr,wr,Mr,Lr,Zr){Mr|=0,Lr|=0,Zr|=0;var Yr=It();return At(Yr,Er),Yr.width=0,Yr.height=0,Ut(Yr,wr),Yr.width=Yr.width||(Er.width>>Zr)-Mr,Yr.height=Yr.height||(Er.height>>Zr)-Lr,tr(Er),Mt(Yr,34069+vr,Mr,Lr,Zr),nr(),Le(Yr),Pr},Pr.resize=function(vr){if((vr|=0)!==Er.width){Pr.width=Er.width=vr,Pr.height=Er.height=vr,tr(Er);for(var wr=0;6>wr;++wr)for(var Mr=0;Er.mipmask>>Mr;++Mr)pe.texImage2D(34069+wr,Mr,Er.format,vr>>Mr,vr>>Mr,0,Er.format,Er.type,null);return nr(),ct.profile&&(Er.stats.size=k(Er.internalformat,Er.type,Pr.width,Pr.height,!1,!0)),Pr}},Pr._reglType="textureCube",Pr._texture=Er,ct.profile&&(Pr.stats=Er.stats),Pr.destroy=function(){Er.decRef()},Pr},clear:function(){for(var Rt=0;Rt<xr;++Rt)pe.activeTexture(33984+Rt),pe.bindTexture(3553,null),jr[Rt]=null;ce(sr).forEach(Qt),Ze.cubeCount=0,Ze.textureCount=0},getTexture:function(Rt){return null},restore:function(){for(var Rt=0;Rt<xr;++Rt){var or=jr[Rt];or&&(or.bindCount=0,or.unit=-1,jr[Rt]=null)}ce(sr).forEach(function(wt){wt.texture=pe.createTexture(),pe.bindTexture(wt.target,wt.texture);for(var ir=0;32>ir;++ir)if((wt.mipmask&1<<ir)!=0)if(wt.target===3553)pe.texImage2D(3553,ir,wt.internalformat,wt.width>>ir,wt.height>>ir,0,wt.internalformat,wt.type,null);else for(var ar=0;6>ar;++ar)pe.texImage2D(34069+ar,ir,wt.internalformat,wt.width>>ir,wt.height>>ir,0,wt.internalformat,wt.type,null);Cr(wt.texInfo,wt.target)})},refresh:function(){for(var Rt=0;Rt<xr;++Rt){var or=jr[Rt];or&&(or.bindCount=0,or.unit=-1,jr[Rt]=null),pe.activeTexture(33984+Rt),pe.bindTexture(3553,null),pe.bindTexture(34067,null)}}}}function A(pe,_e,Be,He,Je,Ze){function ct(mr,tr,nr){this.target=mr,this.texture=tr,this.renderbuffer=nr;var Qt=mr=0;tr?(mr=tr.width,Qt=tr.height):nr&&(mr=nr.width,Qt=nr.height),this.width=mr,this.height=Qt}function lt(mr){mr&&(mr.texture&&mr.texture._texture.decRef(),mr.renderbuffer&&mr.renderbuffer._renderbuffer.decRef())}function At(mr,tr,nr){mr&&(mr.texture?mr.texture._texture.refCount+=1:mr.renderbuffer._renderbuffer.refCount+=1)}function Ot(mr,tr){tr&&(tr.texture?pe.framebufferTexture2D(36160,mr,tr.target,tr.texture._texture.texture,0):pe.framebufferRenderbuffer(36160,mr,36161,tr.renderbuffer._renderbuffer.renderbuffer))}function it(mr){var tr=3553,nr=null,Qt=null,dr=mr;return typeof mr=="object"&&(dr=mr.data,"target"in mr&&(tr=0|mr.target)),(mr=dr._reglType)==="texture2d"||mr==="textureCube"?nr=dr:mr==="renderbuffer"&&(Qt=dr,tr=36161),new ct(tr,nr,Qt)}function ht(mr,tr,nr,Qt,dr){return nr?((mr=He.create2D({width:mr,height:tr,format:Qt,type:dr}))._texture.refCount=0,new ct(3553,mr,null)):((mr=Je.create({width:mr,height:tr,format:Qt}))._renderbuffer.refCount=0,new ct(36161,null,mr))}function Ut(mr){return mr&&(mr.texture||mr.renderbuffer)}function Mt(mr,tr,nr){mr&&(mr.texture?mr.texture.resize(tr,nr):mr.renderbuffer&&mr.renderbuffer.resize(tr,nr),mr.width=tr,mr.height=nr)}function It(){this.id=gr++,Cr[this.id]=this,this.framebuffer=pe.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function Le(mr){mr.colorAttachments.forEach(lt),lt(mr.depthAttachment),lt(mr.stencilAttachment),lt(mr.depthStencilAttachment)}function Xe(mr){pe.deleteFramebuffer(mr.framebuffer),mr.framebuffer=null,Ze.framebufferCount--,delete Cr[mr.id]}function ot(mr){var tr;pe.bindFramebuffer(36160,mr.framebuffer);var nr=mr.colorAttachments;for(tr=0;tr<nr.length;++tr)Ot(36064+tr,nr[tr]);for(tr=nr.length;tr<Be.maxColorAttachments;++tr)pe.framebufferTexture2D(36160,36064+tr,3553,null,0);pe.framebufferTexture2D(36160,33306,3553,null,0),pe.framebufferTexture2D(36160,36096,3553,null,0),pe.framebufferTexture2D(36160,36128,3553,null,0),Ot(36096,mr.depthAttachment),Ot(36128,mr.stencilAttachment),Ot(33306,mr.depthStencilAttachment),pe.checkFramebufferStatus(36160),pe.isContextLost(),pe.bindFramebuffer(36160,St.next?St.next.framebuffer:null),St.cur=St.next,pe.getError()}function pt(mr,tr){function nr(dr,_r){var Ir,Rr=0,Vr=0,Xr=!0,cn=!0;Ir=null;var an=!0,zn="rgba",on="uint8",Tn=1,Mn=null,ei=null,Hr=null,ln=!1;typeof dr=="number"?(Rr=0|dr,Vr=0|_r||Rr):dr?("shape"in dr?(Rr=(Vr=dr.shape)[0],Vr=Vr[1]):("radius"in dr&&(Rr=Vr=dr.radius),"width"in dr&&(Rr=dr.width),"height"in dr&&(Vr=dr.height)),("color"in dr||"colors"in dr)&&(Ir=dr.color||dr.colors,Array.isArray(Ir)),Ir||("colorCount"in dr&&(Tn=0|dr.colorCount),"colorTexture"in dr&&(an=!!dr.colorTexture,zn="rgba4"),"colorType"in dr&&(on=dr.colorType,!an)&&(on==="half float"||on==="float16"?zn="rgba16f":on!=="float"&&on!=="float32"||(zn="rgba32f")),"colorFormat"in dr&&(zn=dr.colorFormat,0<=Vt.indexOf(zn)?an=!0:0<=Jt.indexOf(zn)&&(an=!1))),("depthTexture"in dr||"depthStencilTexture"in dr)&&(ln=!(!dr.depthTexture&&!dr.depthStencilTexture)),"depth"in dr&&(typeof dr.depth=="boolean"?Xr=dr.depth:(Mn=dr.depth,cn=!1)),"stencil"in dr&&(typeof dr.stencil=="boolean"?cn=dr.stencil:(ei=dr.stencil,Xr=!1)),"depthStencil"in dr&&(typeof dr.depthStencil=="boolean"?Xr=cn=dr.depthStencil:(Hr=dr.depthStencil,cn=Xr=!1))):Rr=Vr=1;var bn=null,nn=null,pn=null,qn=null;if(Array.isArray(Ir))bn=Ir.map(it);else if(Ir)bn=[it(Ir)];else for(bn=Array(Tn),Ir=0;Ir<Tn;++Ir)bn[Ir]=ht(Rr,Vr,an,zn,on);for(Rr=Rr||bn[0].width,Vr=Vr||bn[0].height,Mn?nn=it(Mn):Xr&&!cn&&(nn=ht(Rr,Vr,ln,"depth","uint32")),ei?pn=it(ei):cn&&!Xr&&(pn=ht(Rr,Vr,!1,"stencil","uint8")),Hr?qn=it(Hr):!Mn&&!ei&&cn&&Xr&&(qn=ht(Rr,Vr,ln,"depth stencil","depth stencil")),Xr=null,Ir=0;Ir<bn.length;++Ir)At(bn[Ir]),bn[Ir]&&bn[Ir].texture&&(cn=Qe[bn[Ir].texture._texture.format]*vt[bn[Ir].texture._texture.type],Xr===null&&(Xr=cn));return At(nn),At(pn),At(qn),Le(Qt),Qt.width=Rr,Qt.height=Vr,Qt.colorAttachments=bn,Qt.depthAttachment=nn,Qt.stencilAttachment=pn,Qt.depthStencilAttachment=qn,nr.color=bn.map(Ut),nr.depth=Ut(nn),nr.stencil=Ut(pn),nr.depthStencil=Ut(qn),nr.width=Qt.width,nr.height=Qt.height,ot(Qt),nr}var Qt=new It;return Ze.framebufferCount++,nr(mr,tr),B(nr,{resize:function(dr,_r){var Ir=Math.max(0|dr,1),Rr=Math.max(0|_r||Ir,1);if(Ir===Qt.width&&Rr===Qt.height)return nr;for(var Vr=Qt.colorAttachments,Xr=0;Xr<Vr.length;++Xr)Mt(Vr[Xr],Ir,Rr);return Mt(Qt.depthAttachment,Ir,Rr),Mt(Qt.stencilAttachment,Ir,Rr),Mt(Qt.depthStencilAttachment,Ir,Rr),Qt.width=nr.width=Ir,Qt.height=nr.height=Rr,ot(Qt),nr},_reglType:"framebuffer",_framebuffer:Qt,destroy:function(){Xe(Qt),Le(Qt)},use:function(dr){St.setFBO({framebuffer:nr},dr)}})}var St={cur:null,next:null,dirty:!1,setFBO:null},Vt=["rgba"],Jt=["rgba4","rgb565","rgb5 a1"];_e.ext_srgb&&Jt.push("srgba"),_e.ext_color_buffer_half_float&&Jt.push("rgba16f","rgb16f"),_e.webgl_color_buffer_float&&Jt.push("rgba32f");var qt=["uint8"];_e.oes_texture_half_float&&qt.push("half float","float16"),_e.oes_texture_float&&qt.push("float","float32");var gr=0,Cr={};return B(St,{getFramebuffer:function(mr){return typeof mr=="function"&&mr._reglType==="framebuffer"&&(mr=mr._framebuffer)instanceof It?mr:null},create:pt,createCube:function(mr){function tr(Qt){var dr,_r={color:null},Ir=0,Rr=null;dr="rgba";var Vr="uint8",Xr=1;if(typeof Qt=="number"?Ir=0|Qt:Qt?("shape"in Qt?Ir=Qt.shape[0]:("radius"in Qt&&(Ir=0|Qt.radius),"width"in Qt?Ir=0|Qt.width:"height"in Qt&&(Ir=0|Qt.height)),("color"in Qt||"colors"in Qt)&&(Rr=Qt.color||Qt.colors,Array.isArray(Rr)),Rr||("colorCount"in Qt&&(Xr=0|Qt.colorCount),"colorType"in Qt&&(Vr=Qt.colorType),"colorFormat"in Qt&&(dr=Qt.colorFormat)),"depth"in Qt&&(_r.depth=Qt.depth),"stencil"in Qt&&(_r.stencil=Qt.stencil),"depthStencil"in Qt&&(_r.depthStencil=Qt.depthStencil)):Ir=1,Rr)if(Array.isArray(Rr))for(Qt=[],dr=0;dr<Rr.length;++dr)Qt[dr]=Rr[dr];else Qt=[Rr];else for(Qt=Array(Xr),Rr={radius:Ir,format:dr,type:Vr},dr=0;dr<Xr;++dr)Qt[dr]=He.createCube(Rr);for(_r.color=Array(Qt.length),dr=0;dr<Qt.length;++dr)Xr=Qt[dr],Ir=Ir||Xr.width,_r.color[dr]={target:34069,data:Qt[dr]};for(dr=0;6>dr;++dr){for(Xr=0;Xr<Qt.length;++Xr)_r.color[Xr].target=34069+dr;0<dr&&(_r.depth=nr[0].depth,_r.stencil=nr[0].stencil,_r.depthStencil=nr[0].depthStencil),nr[dr]?nr[dr](_r):nr[dr]=pt(_r)}return B(tr,{width:Ir,height:Ir,color:Qt})}var nr=Array(6);return tr(mr),B(tr,{faces:nr,resize:function(Qt){var dr=0|Qt;if(dr===tr.width)return tr;var _r=tr.color;for(Qt=0;Qt<_r.length;++Qt)_r[Qt].resize(dr);for(Qt=0;6>Qt;++Qt)nr[Qt].resize(dr);return tr.width=tr.height=dr,tr},_reglType:"framebufferCube",destroy:function(){nr.forEach(function(Qt){Qt.destroy()})}})},clear:function(){ce(Cr).forEach(Xe)},restore:function(){St.cur=null,St.next=null,St.dirty=!0,ce(Cr).forEach(function(mr){mr.framebuffer=pe.createFramebuffer(),ot(mr)})}})}function I(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function P(pe,_e,Be,He,Je,Ze,ct){function lt(){this.id=++it,this.attributes=[],this.elements=null,this.ownsElements=!1,this.offset=this.count=0,this.instances=-1,this.primitive=4;var Mt=_e.oes_vertex_array_object;this.vao=Mt?Mt.createVertexArrayOES():null,ht[this.id]=this,this.buffers=[]}var At=Be.maxAttributes,Ot=Array(At);for(Be=0;Be<At;++Be)Ot[Be]=new I;var it=0,ht={},Ut={Record:I,scope:{},state:Ot,currentVAO:null,targetVAO:null,restore:_e.oes_vertex_array_object?function(){_e.oes_vertex_array_object&&ce(ht).forEach(function(Mt){Mt.refresh()})}:function(){},createVAO:function(Mt){function It(Xe){var ot;Array.isArray(Xe)?(ot=Xe,Le.elements&&Le.ownsElements&&Le.elements.destroy(),Le.elements=null,Le.ownsElements=!1,Le.offset=0,Le.count=0,Le.instances=-1,Le.primitive=4):(Xe.elements?(ot=Xe.elements,Le.ownsElements?(typeof ot=="function"&&ot._reglType==="elements"?Le.elements.destroy():Le.elements(ot),Le.ownsElements=!1):Ze.getElements(Xe.elements)?(Le.elements=Xe.elements,Le.ownsElements=!1):(Le.elements=Ze.create(Xe.elements),Le.ownsElements=!0)):(Le.elements=null,Le.ownsElements=!1),ot=Xe.attributes,Le.offset=0,Le.count=-1,Le.instances=-1,Le.primitive=4,Le.elements&&(Le.count=Le.elements._elements.vertCount,Le.primitive=Le.elements._elements.primType),"offset"in Xe&&(Le.offset=0|Xe.offset),"count"in Xe&&(Le.count=0|Xe.count),"instances"in Xe&&(Le.instances=0|Xe.instances),"primitive"in Xe&&(Le.primitive=Me[Xe.primitive])),Xe={};var pt=Le.attributes;pt.length=ot.length;for(var St=0;St<ot.length;++St){var Vt,Jt=ot[St],qt=pt[St]=new I,gr=Jt.data||Jt;Array.isArray(gr)||me(gr)||r(gr)?(Le.buffers[St]&&(Vt=Le.buffers[St],me(gr)&&Vt._buffer.byteLength>=gr.byteLength?Vt.subdata(gr):(Vt.destroy(),Le.buffers[St]=null)),Le.buffers[St]||(Vt=Le.buffers[St]=Je.create(Jt,34962,!1,!0)),qt.buffer=Je.getBuffer(Vt),qt.size=0|qt.buffer.dimension,qt.normalized=!1,qt.type=qt.buffer.dtype,qt.offset=0,qt.stride=0,qt.divisor=0,qt.state=1,Xe[St]=1):Je.getBuffer(Jt)?(qt.buffer=Je.getBuffer(Jt),qt.size=0|qt.buffer.dimension,qt.normalized=!1,qt.type=qt.buffer.dtype,qt.offset=0,qt.stride=0,qt.divisor=0,qt.state=1):Je.getBuffer(Jt.buffer)?(qt.buffer=Je.getBuffer(Jt.buffer),qt.size=0|(+Jt.size||qt.buffer.dimension),qt.normalized=!!Jt.normalized||!1,qt.type="type"in Jt?fe[Jt.type]:qt.buffer.dtype,qt.offset=0|(Jt.offset||0),qt.stride=0|(Jt.stride||0),qt.divisor=0|(Jt.divisor||0),qt.state=1):"x"in Jt&&(qt.x=+Jt.x||0,qt.y=+Jt.y||0,qt.z=+Jt.z||0,qt.w=+Jt.w||0,qt.state=2)}for(Vt=0;Vt<Le.buffers.length;++Vt)!Xe[Vt]&&Le.buffers[Vt]&&(Le.buffers[Vt].destroy(),Le.buffers[Vt]=null);return Le.refresh(),It}var Le=new lt;return He.vaoCount+=1,It.destroy=function(){for(var Xe=0;Xe<Le.buffers.length;++Xe)Le.buffers[Xe]&&Le.buffers[Xe].destroy();Le.buffers.length=0,Le.ownsElements&&(Le.elements.destroy(),Le.elements=null,Le.ownsElements=!1),Le.destroy()},It._vao=Le,It._reglType="vao",It(Mt)},getVAO:function(Mt){return typeof Mt=="function"&&Mt._vao?Mt._vao:null},destroyBuffer:function(Mt){for(var It=0;It<Ot.length;++It){var Le=Ot[It];Le.buffer===Mt&&(pe.disableVertexAttribArray(It),Le.buffer=null)}},setVAO:_e.oes_vertex_array_object?function(Mt){if(Mt!==Ut.currentVAO){var It=_e.oes_vertex_array_object;Mt?It.bindVertexArrayOES(Mt.vao):It.bindVertexArrayOES(null),Ut.currentVAO=Mt}}:function(Mt){if(Mt!==Ut.currentVAO){if(Mt)Mt.bindAttrs();else{for(var It=_e.angle_instanced_arrays,Le=0;Le<Ot.length;++Le){var Xe=Ot[Le];Xe.buffer?(pe.enableVertexAttribArray(Le),Xe.buffer.bind(),pe.vertexAttribPointer(Le,Xe.size,Xe.type,Xe.normalized,Xe.stride,Xe.offfset),It&&Xe.divisor&&It.vertexAttribDivisorANGLE(Le,Xe.divisor)):(pe.disableVertexAttribArray(Le),pe.vertexAttrib4f(Le,Xe.x,Xe.y,Xe.z,Xe.w))}ct.elements?pe.bindBuffer(34963,ct.elements.buffer.buffer):pe.bindBuffer(34963,null)}Ut.currentVAO=Mt}},clear:_e.oes_vertex_array_object?function(){ce(ht).forEach(function(Mt){Mt.destroy()})}:function(){}};return lt.prototype.bindAttrs=function(){for(var Mt=_e.angle_instanced_arrays,It=this.attributes,Le=0;Le<It.length;++Le){var Xe=It[Le];Xe.buffer?(pe.enableVertexAttribArray(Le),pe.bindBuffer(34962,Xe.buffer.buffer),pe.vertexAttribPointer(Le,Xe.size,Xe.type,Xe.normalized,Xe.stride,Xe.offset),Mt&&Xe.divisor&&Mt.vertexAttribDivisorANGLE(Le,Xe.divisor)):(pe.disableVertexAttribArray(Le),pe.vertexAttrib4f(Le,Xe.x,Xe.y,Xe.z,Xe.w))}for(Mt=It.length;Mt<At;++Mt)pe.disableVertexAttribArray(Mt);(Mt=Ze.getElements(this.elements))?pe.bindBuffer(34963,Mt.buffer.buffer):pe.bindBuffer(34963,null)},lt.prototype.refresh=function(){var Mt=_e.oes_vertex_array_object;Mt&&(Mt.bindVertexArrayOES(this.vao),this.bindAttrs(),Ut.currentVAO=null,Mt.bindVertexArrayOES(null))},lt.prototype.destroy=function(){if(this.vao){var Mt=_e.oes_vertex_array_object;this===Ut.currentVAO&&(Ut.currentVAO=null,Mt.bindVertexArrayOES(null)),Mt.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),ht[this.id]&&(delete ht[this.id],--He.vaoCount)},Ut}function S(pe,_e,Be,He){function Je(It,Le,Xe,ot){this.name=It,this.id=Le,this.location=Xe,this.info=ot}function Ze(It,Le){for(var Xe=0;Xe<It.length;++Xe)if(It[Xe].id===Le.id)return void(It[Xe].location=Le.location);It.push(Le)}function ct(It,Le,Xe){if(!(pt=(Xe=It===35632?Ot:it)[Le])){var ot=_e.str(Le),pt=pe.createShader(It);pe.shaderSource(pt,ot),pe.compileShader(pt),Xe[Le]=pt}return pt}function lt(It,Le){this.id=Mt++,this.fragId=It,this.vertId=Le,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,He.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function At(It,Le,Xe){var ot;ot=ct(35632,It.fragId);var pt=ct(35633,It.vertId);if(Le=It.program=pe.createProgram(),pe.attachShader(Le,ot),pe.attachShader(Le,pt),Xe)for(ot=0;ot<Xe.length;++ot)pt=Xe[ot],pe.bindAttribLocation(Le,pt[0],pt[1]);pe.linkProgram(Le),pt=pe.getProgramParameter(Le,35718),He.profile&&(It.stats.uniformsCount=pt);var St=It.uniforms;for(ot=0;ot<pt;++ot)if(Xe=pe.getActiveUniform(Le,ot))if(1<Xe.size)for(var Vt=0;Vt<Xe.size;++Vt){var Jt=Xe.name.replace("[0]","["+Vt+"]");Ze(St,new Je(Jt,_e.id(Jt),pe.getUniformLocation(Le,Jt),Xe))}else Ze(St,new Je(Xe.name,_e.id(Xe.name),pe.getUniformLocation(Le,Xe.name),Xe));for(pt=pe.getProgramParameter(Le,35721),He.profile&&(It.stats.attributesCount=pt),It=It.attributes,ot=0;ot<pt;++ot)(Xe=pe.getActiveAttrib(Le,ot))&&Ze(It,new Je(Xe.name,_e.id(Xe.name),pe.getAttribLocation(Le,Xe.name),Xe))}var Ot={},it={},ht={},Ut=[],Mt=0;return He.profile&&(Be.getMaxUniformsCount=function(){var It=0;return Ut.forEach(function(Le){Le.stats.uniformsCount>It&&(It=Le.stats.uniformsCount)}),It},Be.getMaxAttributesCount=function(){var It=0;return Ut.forEach(function(Le){Le.stats.attributesCount>It&&(It=Le.stats.attributesCount)}),It}),{clear:function(){var It=pe.deleteShader.bind(pe);ce(Ot).forEach(It),Ot={},ce(it).forEach(It),it={},Ut.forEach(function(Le){pe.deleteProgram(Le.program)}),Ut.length=0,ht={},Be.shaderCount=0},program:function(It,Le,Xe,ot){var pt=ht[Le];pt||(pt=ht[Le]={});var St=pt[It];if(St&&(St.refCount++,!ot))return St;var Vt=new lt(Le,It);return Be.shaderCount++,At(Vt,Xe,ot),St||(pt[It]=Vt),Ut.push(Vt),B(Vt,{destroy:function(){if(Vt.refCount--,0>=Vt.refCount){pe.deleteProgram(Vt.program);var Jt=Ut.indexOf(Vt);Ut.splice(Jt,1),Be.shaderCount--}0>=pt[Vt.vertId].refCount&&(pe.deleteShader(it[Vt.vertId]),delete it[Vt.vertId],delete ht[Vt.fragId][Vt.vertId]),Object.keys(ht[Vt.fragId]).length||(pe.deleteShader(Ot[Vt.fragId]),delete Ot[Vt.fragId],delete ht[Vt.fragId])}})},restore:function(){Ot={},it={};for(var It=0;It<Ut.length;++It)At(Ut[It],null,Ut[It].attributes.map(function(Le){return[Le.location,Le.name]}))},shader:ct,frag:-1,vert:-1}}function E(pe,_e,Be,He,Je,Ze,ct){function lt(At){var Ot;Ot=_e.next===null?5121:_e.next.colorAttachments[0].texture._texture.type;var it=0,ht=0,Ut=He.framebufferWidth,Mt=He.framebufferHeight,It=null;return me(At)?It=At:At&&(it=0|At.x,ht=0|At.y,Ut=0|(At.width||He.framebufferWidth-it),Mt=0|(At.height||He.framebufferHeight-ht),It=At.data||null),Be(),At=Ut*Mt*4,It||(Ot===5121?It=new Uint8Array(At):Ot===5126&&(It=It||new Float32Array(At))),pe.pixelStorei(3333,4),pe.readPixels(it,ht,Ut,Mt,6408,Ot,It),It}return function(At){return At&&"framebuffer"in At?function(Ot){var it;return _e.setFBO({framebuffer:Ot.framebuffer},function(){it=lt(Ot)}),it}(At):lt(At)}}function z(pe,_e){return pe>>>_e|pe<<32-_e}function D(pe,_e){var Be=(65535&pe)+(65535&_e);return(pe>>16)+(_e>>16)+(Be>>16)<<16|65535&Be}function j(pe){return Array.prototype.slice.call(pe)}function V(pe){return j(pe).join("")}function Z(pe){function _e(){var it=[],ht=[];return B(function(){it.push.apply(it,j(arguments))},{def:function(){var Ut="v"+Je++;return ht.push(Ut),0<arguments.length&&(it.push(Ut,"="),it.push.apply(it,j(arguments)),it.push(";")),Ut},toString:function(){return V([0<ht.length?"var "+ht.join(",")+";":"",V(it)])}})}function Be(){function it(Le,Xe){Ut(Le,Xe,"=",ht.def(Le,Xe),";")}var ht=_e(),Ut=_e(),Mt=ht.toString,It=Ut.toString;return B(function(){ht.apply(ht,j(arguments))},{def:ht.def,entry:ht,exit:Ut,save:it,set:function(Le,Xe,ot){it(Le,Xe),ht(Le,Xe,"=",ot,";")},toString:function(){return Mt()+It()}})}var He=pe&&pe.cache,Je=0,Ze=[],ct=[],lt=[],At=_e(),Ot={};return{global:At,link:function(it,ht){var Ut=ht&&ht.stable;if(!Ut){for(var Mt=0;Mt<ct.length;++Mt)if(ct[Mt]===it&&!lt[Mt])return Ze[Mt]}return Mt="g"+Je++,Ze.push(Mt),ct.push(it),lt.push(Ut),Mt},block:_e,proc:function(it,ht){function Ut(){var Xe="a"+Mt.length;return Mt.push(Xe),Xe}var Mt=[];ht=ht||0;for(var It=0;It<ht;++It)Ut();var Le=(It=Be()).toString;return Ot[it]=B(It,{arg:Ut,toString:function(){return V(["function(",Mt.join(),"){",Le(),"}"])}})},scope:Be,cond:function(){var it=V(arguments),ht=Be(),Ut=Be(),Mt=ht.toString,It=Ut.toString;return B(ht,{then:function(){return ht.apply(ht,j(arguments)),this},else:function(){return Ut.apply(Ut,j(arguments)),this},toString:function(){var Le=It();return Le&&(Le="else{"+Le+"}"),V(["if(",it,"){",Mt(),"}",Le])}})},compile:function(){var it=['"use strict";',At,"return {"];Object.keys(Ot).forEach(function(Mt){it.push('"',Mt,'":',Ot[Mt].toString(),",")}),it.push("}");var ht,Ut=V(it).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`);return He&&(ht=function(Mt){for(var It,Le="",Xe=0;Xe<Mt.length;Xe++)It=Mt.charCodeAt(Xe),Le+="0123456789abcdef".charAt(It>>>4&15)+"0123456789abcdef".charAt(15&It);return Le}(function(Mt){for(var It=Array(Mt.length>>2),Le=0;Le<It.length;Le++)It[Le]=0;for(Le=0;Le<8*Mt.length;Le+=8)It[Le>>5]|=(255&Mt.charCodeAt(Le/8))<<24-Le%32;var Xe,ot,pt,St,Vt,Jt,qt,gr,Cr,mr,tr,nr=8*Mt.length;for(Mt=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],Le=Array(64),It[nr>>5]|=128<<24-nr%32,It[15+(nr+64>>9<<4)]=nr,gr=0;gr<It.length;gr+=16){for(nr=Mt[0],Xe=Mt[1],ot=Mt[2],pt=Mt[3],St=Mt[4],Vt=Mt[5],Jt=Mt[6],qt=Mt[7],Cr=0;64>Cr;Cr++){var Qt;16>Cr?Le[Cr]=It[Cr+gr]:(mr=Cr,tr=D(tr=z(tr=Le[Cr-2],17)^z(tr,19)^tr>>>10,Le[Cr-7]),Qt=z(Qt=Le[Cr-15],7)^z(Qt,18)^Qt>>>3,Le[mr]=D(D(tr,Qt),Le[Cr-16])),mr=D(D(D(D(qt,mr=z(mr=St,6)^z(mr,11)^z(mr,25)),St&Vt^~St&Jt),jt[Cr]),Le[Cr]),tr=D(qt=z(qt=nr,2)^z(qt,13)^z(qt,22),nr&Xe^nr&ot^Xe&ot),qt=Jt,Jt=Vt,Vt=St,St=D(pt,mr),pt=ot,ot=Xe,Xe=nr,nr=D(mr,tr)}Mt[0]=D(nr,Mt[0]),Mt[1]=D(Xe,Mt[1]),Mt[2]=D(ot,Mt[2]),Mt[3]=D(pt,Mt[3]),Mt[4]=D(St,Mt[4]),Mt[5]=D(Vt,Mt[5]),Mt[6]=D(Jt,Mt[6]),Mt[7]=D(qt,Mt[7])}for(It="",Le=0;Le<32*Mt.length;Le+=8)It+=String.fromCharCode(Mt[Le>>5]>>>24-Le%32&255);return It}(function(Mt){for(var It,Le,Xe="",ot=-1;++ot<Mt.length;)It=Mt.charCodeAt(ot),Le=ot+1<Mt.length?Mt.charCodeAt(ot+1):0,55296<=It&&56319>=It&&56320<=Le&&57343>=Le&&(It=65536+((1023&It)<<10)+(1023&Le),ot++),127>=It?Xe+=String.fromCharCode(It):2047>=It?Xe+=String.fromCharCode(192|It>>>6&31,128|63&It):65535>=It?Xe+=String.fromCharCode(224|It>>>12&15,128|It>>>6&63,128|63&It):2097151>=It&&(Xe+=String.fromCharCode(240|It>>>18&7,128|It>>>12&63,128|It>>>6&63,128|63&It));return Xe}(Ut))),He[ht])?He[ht].apply(null,ct):(Ut=Function.apply(null,Ze.concat(Ut)),He&&(He[ht]=Ut),Ut.apply(null,ct))}}}function Q(pe){return Array.isArray(pe)||me(pe)||r(pe)}function X(pe){return pe.sort(function(_e,Be){return _e==="viewport"?-1:Be==="viewport"?1:_e<Be?-1:1})}function $(pe,_e,Be,He){this.thisDep=pe,this.contextDep=_e,this.propDep=Be,this.append=He}function re(pe){return pe&&!(pe.thisDep||pe.contextDep||pe.propDep)}function H(pe){return new $(!1,!1,!1,pe)}function N(pe,_e){var Be=pe.type;if(Be===0)return new $(!0,1<=(Be=pe.data.length),2<=Be,_e);if(Be===4)return new $((Be=pe.data).thisDep,Be.contextDep,Be.propDep,_e);if(Be===5)return new $(!1,!1,!1,_e);if(Be===6){for(var He=Be=!1,Je=!1,Ze=0;Ze<pe.data.length;++Ze){var ct=pe.data[Ze];ct.type===1?Je=!0:ct.type===2?He=!0:ct.type===3?Be=!0:ct.type===0?(Be=!0,1<=(ct=ct.data)&&(He=!0),2<=ct&&(Je=!0)):ct.type===4&&(Be=Be||ct.data.thisDep,He=He||ct.data.contextDep,Je=Je||ct.data.propDep)}return new $(Be,He,Je,_e)}return new $(Be===3,Be===2,Be===1,_e)}function U(pe,_e,Be,He,Je,Ze,ct,lt,At,Ot,it,ht,Ut,Mt,It,Le){function Xe(wt){return wt.replace(".","_")}function ot(wt,ir,ar){var Dr=Xe(wt);qn.push(wt),pn[Dr]=nn[Dr]=!!ar,sr[Dr]=ir}function pt(wt,ir,ar){var Dr=Xe(wt);qn.push(wt),Array.isArray(ar)?(nn[Dr]=ar.slice(),pn[Dr]=ar.slice()):nn[Dr]=pn[Dr]=ar,xr[Dr]=ir}function St(){var wt=Z({cache:It}),ir=wt.link,ar=wt.global;wt.id=or++,wt.batchId="0";var Dr=ir(jr),Pr=wt.shared={props:"a0"};Object.keys(jr).forEach(function(Mr){Pr[Mr]=ar.def(Dr,".",Mr)});var Er=wt.next={},Ar=wt.current={};Object.keys(xr).forEach(function(Mr){Array.isArray(nn[Mr])&&(Er[Mr]=ar.def(Pr.next,".",Mr),Ar[Mr]=ar.def(Pr.current,".",Mr))});var vr=wt.constants={};Object.keys(Rt).forEach(function(Mr){vr[Mr]=ar.def(JSON.stringify(Rt[Mr]))}),wt.invoke=function(Mr,Lr){switch(Lr.type){case 0:var Zr=["this",Pr.context,Pr.props,wt.batchId];return Mr.def(ir(Lr.data),".call(",Zr.slice(0,Math.max(Lr.data.length+1,4)),")");case 1:return Mr.def(Pr.props,Lr.data);case 2:return Mr.def(Pr.context,Lr.data);case 3:return Mr.def("this",Lr.data);case 4:return Lr.data.append(wt,Mr),Lr.data.ref;case 5:return Lr.data.toString();case 6:return Lr.data.map(function(Yr){return wt.invoke(Mr,Yr)})}},wt.attribCache={};var wr={};return wt.scopeAttrib=function(Mr){if((Mr=_e.id(Mr))in wr)return wr[Mr];var Lr=Ot.scope[Mr];return Lr||(Lr=Ot.scope[Mr]=new Mn),wr[Mr]=ir(Lr)},wt}function Vt(wt,ir){var ar=wt.static,Dr=wt.dynamic;if("framebuffer"in ar){var Pr=ar.framebuffer;return Pr?(Pr=lt.getFramebuffer(Pr),H(function(Ar,vr){var wr=Ar.link(Pr),Mr=Ar.shared;return vr.set(Mr.framebuffer,".next",wr),Mr=Mr.context,vr.set(Mr,".framebufferWidth",wr+".width"),vr.set(Mr,".framebufferHeight",wr+".height"),wr})):H(function(Ar,vr){var wr=Ar.shared;return vr.set(wr.framebuffer,".next","null"),wr=wr.context,vr.set(wr,".framebufferWidth",wr+".drawingBufferWidth"),vr.set(wr,".framebufferHeight",wr+".drawingBufferHeight"),"null"})}if("framebuffer"in Dr){var Er=Dr.framebuffer;return N(Er,function(Ar,vr){var wr=Ar.invoke(vr,Er),Mr=Ar.shared,Lr=Mr.framebuffer;return wr=vr.def(Lr,".getFramebuffer(",wr,")"),vr.set(Lr,".next",wr),Mr=Mr.context,vr.set(Mr,".framebufferWidth",wr+"?"+wr+".width:"+Mr+".drawingBufferWidth"),vr.set(Mr,".framebufferHeight",wr+"?"+wr+".height:"+Mr+".drawingBufferHeight"),wr})}return null}function Jt(wt,ir,ar){function Dr(Mr){if(Mr in Pr){var Lr=_e.id(Pr[Mr]);return(Mr=H(function(){return Lr})).id=Lr,Mr}if(Mr in Er){var Zr=Er[Mr];return N(Zr,function(Yr,rn){var sn=Yr.invoke(rn,Zr);return rn.def(Yr.shared.strings,".id(",sn,")")})}return null}var Pr=wt.static,Er=wt.dynamic,Ar=Dr("frag"),vr=Dr("vert"),wr=null;return re(Ar)&&re(vr)?(wr=it.program(vr.id,Ar.id,null,ar),wt=H(function(Mr,Lr){return Mr.link(wr)})):wt=new $(Ar&&Ar.thisDep||vr&&vr.thisDep,Ar&&Ar.contextDep||vr&&vr.contextDep,Ar&&Ar.propDep||vr&&vr.propDep,function(Mr,Lr){var Zr,Yr,rn=Mr.shared.shader;return Zr=Ar?Ar.append(Mr,Lr):Lr.def(rn,".","frag"),Yr=vr?vr.append(Mr,Lr):Lr.def(rn,".","vert"),Lr.def(rn+".program("+Yr+","+Zr+")")}),{frag:Ar,vert:vr,progVar:wt,program:wr}}function qt(wt,ir){function ar(sn,yn){if(sn in Dr){var kn=0|Dr[sn];return yn?Er.offset=kn:Er.instances=kn,H(function(Pn,Rn){return yn&&(Pn.OFFSET=kn),kn})}if(sn in Pr){var wn=Pr[sn];return N(wn,function(Pn,Rn){var Xn=Pn.invoke(Rn,wn);return yn&&(Pn.OFFSET=Xn),Xn})}if(yn){if(wr)return H(function(Pn,Rn){return Pn.OFFSET=0});if(Ar)return new $(vr.thisDep,vr.contextDep,vr.propDep,function(Pn,Rn){return Rn.def(Pn.shared.vao+".currentVAO?"+Pn.shared.vao+".currentVAO.offset:0")})}else if(Ar)return new $(vr.thisDep,vr.contextDep,vr.propDep,function(Pn,Rn){return Rn.def(Pn.shared.vao+".currentVAO?"+Pn.shared.vao+".currentVAO.instances:-1")});return null}var Dr=wt.static,Pr=wt.dynamic,Er={},Ar=!1,vr=function(){if("vao"in Dr){var sn=Dr.vao;return sn!==null&&Ot.getVAO(sn)===null&&(sn=Ot.createVAO(sn)),Ar=!0,Er.vao=sn,H(function(kn){var wn=Ot.getVAO(sn);return wn?kn.link(wn):"null"})}if("vao"in Pr){Ar=!0;var yn=Pr.vao;return N(yn,function(kn,wn){var Pn=kn.invoke(wn,yn);return wn.def(kn.shared.vao+".getVAO("+Pn+")")})}return null}(),wr=!1,Mr=function(){if("elements"in Dr){var sn=Dr.elements;if(Er.elements=sn,Q(sn)){var yn=Er.elements=Ze.create(sn,!0);sn=Ze.getElements(yn),wr=!0}else sn&&(sn=Ze.getElements(sn),wr=!0);return(yn=H(function(wn,Pn){if(sn){var Rn=wn.link(sn);return wn.ELEMENTS=Rn}return wn.ELEMENTS=null})).value=sn,yn}if("elements"in Pr){wr=!0;var kn=Pr.elements;return N(kn,function(wn,Pn){var Rn=(Xn=wn.shared).isBufferArgs,Xn=Xn.elements,Ai=wn.invoke(Pn,kn),Mi=Pn.def("null");return Rn=Pn.def(Rn,"(",Ai,")"),Ai=wn.cond(Rn).then(Mi,"=",Xn,".createStream(",Ai,");").else(Mi,"=",Xn,".getElements(",Ai,");"),Pn.entry(Ai),Pn.exit(wn.cond(Rn).then(Xn,".destroyStream(",Mi,");")),wn.ELEMENTS=Mi})}return Ar?new $(vr.thisDep,vr.contextDep,vr.propDep,function(wn,Pn){return Pn.def(wn.shared.vao+".currentVAO?"+wn.shared.elements+".getElements("+wn.shared.vao+".currentVAO.elements):null")}):null}(),Lr=ar("offset",!0),Zr=function(){if("primitive"in Dr){var sn=Dr.primitive;return Er.primitive=sn,H(function(kn,wn){return Me[sn]})}if("primitive"in Pr){var yn=Pr.primitive;return N(yn,function(kn,wn){var Pn=kn.constants.primTypes,Rn=kn.invoke(wn,yn);return wn.def(Pn,"[",Rn,"]")})}return wr?re(Mr)?Mr.value?H(function(kn,wn){return wn.def(kn.ELEMENTS,".primType")}):H(function(){return 4}):new $(Mr.thisDep,Mr.contextDep,Mr.propDep,function(kn,wn){var Pn=kn.ELEMENTS;return wn.def(Pn,"?",Pn,".primType:",4)}):Ar?new $(vr.thisDep,vr.contextDep,vr.propDep,function(kn,wn){return wn.def(kn.shared.vao+".currentVAO?"+kn.shared.vao+".currentVAO.primitive:4")}):null}(),Yr=function(){if("count"in Dr){var sn=0|Dr.count;return Er.count=sn,H(function(){return sn})}if("count"in Pr){var yn=Pr.count;return N(yn,function(kn,wn){return kn.invoke(wn,yn)})}return wr?re(Mr)?Mr?Lr?new $(Lr.thisDep,Lr.contextDep,Lr.propDep,function(kn,wn){return wn.def(kn.ELEMENTS,".vertCount-",kn.OFFSET)}):H(function(kn,wn){return wn.def(kn.ELEMENTS,".vertCount")}):H(function(){return-1}):new $(Mr.thisDep||Lr.thisDep,Mr.contextDep||Lr.contextDep,Mr.propDep||Lr.propDep,function(kn,wn){var Pn=kn.ELEMENTS;return kn.OFFSET?wn.def(Pn,"?",Pn,".vertCount-",kn.OFFSET,":-1"):wn.def(Pn,"?",Pn,".vertCount:-1")}):Ar?new $(vr.thisDep,vr.contextDep,vr.propDep,function(kn,wn){return wn.def(kn.shared.vao,".currentVAO?",kn.shared.vao,".currentVAO.count:-1")}):null}(),rn=ar("instances",!1);return{elements:Mr,primitive:Zr,count:Yr,instances:rn,offset:Lr,vao:vr,vaoActive:Ar,elementsActive:wr,static:Er}}function gr(wt,ir){var ar=wt.static,Dr=wt.dynamic,Pr={};return Object.keys(ar).forEach(function(Er){var Ar=ar[Er],vr=_e.id(Er),wr=new Mn;if(Q(Ar))wr.state=1,wr.buffer=Je.getBuffer(Je.create(Ar,34962,!1,!0)),wr.type=0;else if(Lr=Je.getBuffer(Ar))wr.state=1,wr.buffer=Lr,wr.type=0;else if("constant"in Ar){var Mr=Ar.constant;wr.buffer="null",wr.state=2,typeof Mr=="number"?wr.x=Mr:Gt.forEach(function(kn,wn){wn<Mr.length&&(wr[kn]=Mr[wn])})}else{var Lr=Q(Ar.buffer)?Je.getBuffer(Je.create(Ar.buffer,34962,!1,!0)):Je.getBuffer(Ar.buffer),Zr=0|Ar.offset,Yr=0|Ar.stride,rn=0|Ar.size,sn=!!Ar.normalized,yn=0;"type"in Ar&&(yn=fe[Ar.type]),Ar=0|Ar.divisor,wr.buffer=Lr,wr.state=1,wr.size=rn,wr.normalized=sn,wr.type=yn||Lr.dtype,wr.offset=Zr,wr.stride=Yr,wr.divisor=Ar}Pr[Er]=H(function(kn,wn){var Pn=kn.attribCache;if(vr in Pn)return Pn[vr];var Rn={isStream:!1};return Object.keys(wr).forEach(function(Xn){Rn[Xn]=wr[Xn]}),wr.buffer&&(Rn.buffer=kn.link(wr.buffer),Rn.type=Rn.type||Rn.buffer+".dtype"),Pn[vr]=Rn})}),Object.keys(Dr).forEach(function(Er){var Ar=Dr[Er];Pr[Er]=N(Ar,function(vr,wr){function Mr(Pn){wr(sn[Pn],"=",Lr,".",Pn,"|0;")}var Lr=vr.invoke(wr,Ar),Zr=vr.shared,Yr=vr.constants,rn=Zr.isBufferArgs,sn=(Zr=Zr.buffer,{isStream:wr.def(!1)}),yn=new Mn;yn.state=1,Object.keys(yn).forEach(function(Pn){sn[Pn]=wr.def(""+yn[Pn])});var kn=sn.buffer,wn=sn.type;return wr("if(",rn,"(",Lr,")){",sn.isStream,"=true;",kn,"=",Zr,".createStream(",34962,",",Lr,");",wn,"=",kn,".dtype;","}else{",kn,"=",Zr,".getBuffer(",Lr,");","if(",kn,"){",wn,"=",kn,".dtype;",'}else if("constant" in ',Lr,"){",sn.state,"=",2,";","if(typeof "+Lr+'.constant === "number"){',sn[Gt[0]],"=",Lr,".constant;",Gt.slice(1).map(function(Pn){return sn[Pn]}).join("="),"=0;","}else{",Gt.map(function(Pn,Rn){return sn[Pn]+"="+Lr+".constant.length>"+Rn+"?"+Lr+".constant["+Rn+"]:0;"}).join(""),"}}else{","if(",rn,"(",Lr,".buffer)){",kn,"=",Zr,".createStream(",34962,",",Lr,".buffer);","}else{",kn,"=",Zr,".getBuffer(",Lr,".buffer);","}",wn,'="type" in ',Lr,"?",Yr.glTypes,"[",Lr,".type]:",kn,".dtype;",sn.normalized,"=!!",Lr,".normalized;"),Mr("size"),Mr("offset"),Mr("stride"),Mr("divisor"),wr("}}"),wr.exit("if(",sn.isStream,"){",Zr,".destroyStream(",kn,");","}"),sn})}),Pr}function Cr(wt,ir,ar,Dr,Pr){function Er(yn){var kn=vr[yn];kn&&(Mr[yn]=kn)}var Ar=function(yn,kn){if(typeof(wn=yn.static).frag=="string"&&typeof wn.vert=="string"){if(0<Object.keys(kn.dynamic).length)return null;var wn=kn.static,Pn=Object.keys(wn);if(0<Pn.length&&typeof wn[Pn[0]]=="number"){for(var Rn=[],Xn=0;Xn<Pn.length;++Xn)Rn.push([0|wn[Pn[Xn]],Pn[Xn]]);return Rn}}return null}(wt,ir),vr=function(yn,kn,wn){function Pn(Mi){if(Mi in Rn){var Cn=Rn[Mi];Mi=!0;var ti,$n,Di=0|Cn.x,va=0|Cn.y;return"width"in Cn?ti=0|Cn.width:Mi=!1,"height"in Cn?$n=0|Cn.height:Mi=!1,new $(!Mi&&kn&&kn.thisDep,!Mi&&kn&&kn.contextDep,!Mi&&kn&&kn.propDep,function(vo,Wi){var Zi=vo.shared.context,no=ti;"width"in Cn||(no=Wi.def(Zi,".","framebufferWidth","-",Di));var Ni=$n;return"height"in Cn||(Ni=Wi.def(Zi,".","framebufferHeight","-",va)),[Di,va,no,Ni]})}if(Mi in Xn){var ja=Xn[Mi];return Mi=N(ja,function(vo,Wi){var Zi=vo.invoke(Wi,ja),no=vo.shared.context,Ni=Wi.def(Zi,".x|0"),yo=Wi.def(Zi,".y|0");return[Ni,yo,Wi.def('"width" in ',Zi,"?",Zi,".width|0:","(",no,".","framebufferWidth","-",Ni,")"),Zi=Wi.def('"height" in ',Zi,"?",Zi,".height|0:","(",no,".","framebufferHeight","-",yo,")")]}),kn&&(Mi.thisDep=Mi.thisDep||kn.thisDep,Mi.contextDep=Mi.contextDep||kn.contextDep,Mi.propDep=Mi.propDep||kn.propDep),Mi}return kn?new $(kn.thisDep,kn.contextDep,kn.propDep,function(vo,Wi){var Zi=vo.shared.context;return[0,0,Wi.def(Zi,".","framebufferWidth"),Wi.def(Zi,".","framebufferHeight")]}):null}var Rn=yn.static,Xn=yn.dynamic;if(yn=Pn("viewport")){var Ai=yn;yn=new $(yn.thisDep,yn.contextDep,yn.propDep,function(Mi,Cn){var ti=Ai.append(Mi,Cn),$n=Mi.shared.context;return Cn.set($n,".viewportWidth",ti[2]),Cn.set($n,".viewportHeight",ti[3]),ti})}return{viewport:yn,scissor_box:Pn("scissor.box")}}(wt,Zr=Vt(wt)),wr=qt(wt),Mr=function(yn,kn){var wn=yn.static,Pn=yn.dynamic,Rn={};return qn.forEach(function(Xn){function Ai(Cn,ti){if(Xn in wn){var $n=Cn(wn[Xn]);Rn[Mi]=H(function(){return $n})}else if(Xn in Pn){var Di=Pn[Xn];Rn[Mi]=N(Di,function(va,ja){return ti(va,ja,va.invoke(ja,Di))})}}var Mi=Xe(Xn);switch(Xn){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":return Ai(function(Cn){return Cn},function(Cn,ti,$n){return $n});case"depth.func":return Ai(function(Cn){return cr[Cn]},function(Cn,ti,$n){return ti.def(Cn.constants.compareFuncs,"[",$n,"]")});case"depth.range":return Ai(function(Cn){return Cn},function(Cn,ti,$n){return[ti.def("+",$n,"[0]"),ti=ti.def("+",$n,"[1]")]});case"blend.func":return Ai(function(Cn){return[Zt["srcRGB"in Cn?Cn.srcRGB:Cn.src],Zt["dstRGB"in Cn?Cn.dstRGB:Cn.dst],Zt["srcAlpha"in Cn?Cn.srcAlpha:Cn.src],Zt["dstAlpha"in Cn?Cn.dstAlpha:Cn.dst]]},function(Cn,ti,$n){function Di(Wi,Zi){return ti.def('"',Wi,Zi,'" in ',$n,"?",$n,".",Wi,Zi,":",$n,".",Wi)}Cn=Cn.constants.blendFuncs;var va=Di("src","RGB"),ja=Di("dst","RGB"),vo=(va=ti.def(Cn,"[",va,"]"),ti.def(Cn,"[",Di("src","Alpha"),"]"));return[va,ja=ti.def(Cn,"[",ja,"]"),vo,Cn=ti.def(Cn,"[",Di("dst","Alpha"),"]")]});case"blend.equation":return Ai(function(Cn){return typeof Cn=="string"?[ei[Cn],ei[Cn]]:typeof Cn=="object"?[ei[Cn.rgb],ei[Cn.alpha]]:void 0},function(Cn,ti,$n){var Di=Cn.constants.blendEquations,va=ti.def(),ja=ti.def();return(Cn=Cn.cond("typeof ",$n,'==="string"')).then(va,"=",ja,"=",Di,"[",$n,"];"),Cn.else(va,"=",Di,"[",$n,".rgb];",ja,"=",Di,"[",$n,".alpha];"),ti(Cn),[va,ja]});case"blend.color":return Ai(function(Cn){return t(4,function(ti){return+Cn[ti]})},function(Cn,ti,$n){return t(4,function(Di){return ti.def("+",$n,"[",Di,"]")})});case"stencil.mask":return Ai(function(Cn){return 0|Cn},function(Cn,ti,$n){return ti.def($n,"|0")});case"stencil.func":return Ai(function(Cn){return[cr[Cn.cmp||"keep"],Cn.ref||0,"mask"in Cn?Cn.mask:-1]},function(Cn,ti,$n){return[Cn=ti.def('"cmp" in ',$n,"?",Cn.constants.compareFuncs,"[",$n,".cmp]",":",7680),ti.def($n,".ref|0"),ti=ti.def('"mask" in ',$n,"?",$n,".mask|0:-1")]});case"stencil.opFront":case"stencil.opBack":return Ai(function(Cn){return[Xn==="stencil.opBack"?1029:1028,Dt[Cn.fail||"keep"],Dt[Cn.zfail||"keep"],Dt[Cn.zpass||"keep"]]},function(Cn,ti,$n){function Di(ja){return ti.def('"',ja,'" in ',$n,"?",va,"[",$n,".",ja,"]:",7680)}var va=Cn.constants.stencilOps;return[Xn==="stencil.opBack"?1029:1028,Di("fail"),Di("zfail"),Di("zpass")]});case"polygonOffset.offset":return Ai(function(Cn){return[0|Cn.factor,0|Cn.units]},function(Cn,ti,$n){return[ti.def($n,".factor|0"),ti=ti.def($n,".units|0")]});case"cull.face":return Ai(function(Cn){var ti=0;return Cn==="front"?ti=1028:Cn==="back"&&(ti=1029),ti},function(Cn,ti,$n){return ti.def($n,'==="front"?',1028,":",1029)});case"lineWidth":return Ai(function(Cn){return Cn},function(Cn,ti,$n){return $n});case"frontFace":return Ai(function(Cn){return Ne[Cn]},function(Cn,ti,$n){return ti.def($n+'==="cw"?2304:2305')});case"colorMask":return Ai(function(Cn){return Cn.map(function(ti){return!!ti})},function(Cn,ti,$n){return t(4,function(Di){return"!!"+$n+"["+Di+"]"})});case"sample.coverage":return Ai(function(Cn){return["value"in Cn?Cn.value:1,!!Cn.invert]},function(Cn,ti,$n){return[ti.def('"value" in ',$n,"?+",$n,".value:1"),ti=ti.def("!!",$n,".invert")]})}}),Rn}(wt),Lr=Jt(wt,0,Ar);Er("viewport"),Er(Xe("scissor.box"));var Zr,Yr=0<Object.keys(Mr).length;if((Zr={framebuffer:Zr,draw:wr,shader:Lr,state:Mr,dirty:Yr,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}}).profile=function(yn){var kn,wn=yn.static;if(yn=yn.dynamic,"profile"in wn){var Pn=!!wn.profile;(kn=H(function(Xn,Ai){return Pn})).enable=Pn}else if("profile"in yn){var Rn=yn.profile;kn=N(Rn,function(Xn,Ai){return Xn.invoke(Ai,Rn)})}return kn}(wt),Zr.uniforms=function(yn,kn){var wn=yn.static,Pn=yn.dynamic,Rn={};return Object.keys(wn).forEach(function(Xn){var Ai,Mi=wn[Xn];if(typeof Mi=="number"||typeof Mi=="boolean")Ai=H(function(){return Mi});else if(typeof Mi=="function"){var Cn=Mi._reglType;Cn==="texture2d"||Cn==="textureCube"?Ai=H(function(ti){return ti.link(Mi)}):Cn!=="framebuffer"&&Cn!=="framebufferCube"||(Ai=H(function(ti){return ti.link(Mi.color[0])}))}else u(Mi)&&(Ai=H(function(ti){return ti.global.def("[",t(Mi.length,function($n){return Mi[$n]}),"]")}));Ai.value=Mi,Rn[Xn]=Ai}),Object.keys(Pn).forEach(function(Xn){var Ai=Pn[Xn];Rn[Xn]=N(Ai,function(Mi,Cn){return Mi.invoke(Cn,Ai)})}),Rn}(ar),Zr.drawVAO=Zr.scopeVAO=wr.vao,!Zr.drawVAO&&Lr.program&&!Ar&&Be.angle_instanced_arrays&&wr.static.elements){var rn=!0;if(wt=Lr.program.attributes.map(function(yn){return yn=ir.static[yn],rn=rn&&!!yn,yn}),rn&&0<wt.length){var sn=Ot.getVAO(Ot.createVAO({attributes:wt,elements:wr.static.elements}));Zr.drawVAO=new $(null,null,null,function(yn,kn){return yn.link(sn)}),Zr.useVAO=!0}}return Ar?Zr.useVAO=!0:Zr.attributes=gr(ir),Zr.context=function(yn){var kn=yn.static,wn=yn.dynamic,Pn={};return Object.keys(kn).forEach(function(Rn){var Xn=kn[Rn];Pn[Rn]=H(function(Ai,Mi){return typeof Xn=="number"||typeof Xn=="boolean"?""+Xn:Ai.link(Xn)})}),Object.keys(wn).forEach(function(Rn){var Xn=wn[Rn];Pn[Rn]=N(Xn,function(Ai,Mi){return Ai.invoke(Mi,Xn)})}),Pn}(Dr),Zr}function mr(wt,ir,ar){var Dr=wt.shared.context,Pr=wt.scope();Object.keys(ar).forEach(function(Er){ir.save(Dr,"."+Er);var Ar=ar[Er].append(wt,ir);Array.isArray(Ar)?Pr(Dr,".",Er,"=[",Ar.join(),"];"):Pr(Dr,".",Er,"=",Ar,";")}),ir(Pr)}function tr(wt,ir,ar,Dr){var Pr,Er=(vr=wt.shared).gl,Ar=vr.framebuffer;ln&&(Pr=ir.def(vr.extensions,".webgl_draw_buffers"));var vr=(wr=wt.constants).drawBuffer,wr=wr.backBuffer;wt=ar?ar.append(wt,ir):ir.def(Ar,".next"),Dr||ir("if(",wt,"!==",Ar,".cur){"),ir("if(",wt,"){",Er,".bindFramebuffer(",36160,",",wt,".framebuffer);"),ln&&ir(Pr,".drawBuffersWEBGL(",vr,"[",wt,".colorAttachments.length]);"),ir("}else{",Er,".bindFramebuffer(",36160,",null);"),ln&&ir(Pr,".drawBuffersWEBGL(",wr,");"),ir("}",Ar,".cur=",wt,";"),Dr||ir("}")}function nr(wt,ir,ar){var Dr=wt.shared,Pr=Dr.gl,Er=wt.current,Ar=wt.next,vr=Dr.current,wr=Dr.next,Mr=wt.cond(vr,".dirty");qn.forEach(function(Lr){var Zr,Yr;if(!((Lr=Xe(Lr))in ar.state))if(Lr in Ar){Zr=Ar[Lr],Yr=Er[Lr];var rn=t(nn[Lr].length,function(sn){return Mr.def(Zr,"[",sn,"]")});Mr(wt.cond(rn.map(function(sn,yn){return sn+"!=="+Yr+"["+yn+"]"}).join("||")).then(Pr,".",xr[Lr],"(",rn,");",rn.map(function(sn,yn){return Yr+"["+yn+"]="+sn}).join(";"),";"))}else Zr=Mr.def(wr,".",Lr),rn=wt.cond(Zr,"!==",vr,".",Lr),Mr(rn),Lr in sr?rn(wt.cond(Zr).then(Pr,".enable(",sr[Lr],");").else(Pr,".disable(",sr[Lr],");"),vr,".",Lr,"=",Zr,";"):rn(Pr,".",xr[Lr],"(",Zr,");",vr,".",Lr,"=",Zr,";")}),Object.keys(ar.state).length===0&&Mr(vr,".dirty=false;"),ir(Mr)}function Qt(wt,ir,ar,Dr){var Pr,Er=wt.shared,Ar=wt.current,vr=Er.current,wr=Er.gl;X(Object.keys(ar)).forEach(function(Mr){var Lr=ar[Mr];if(!Dr||Dr(Lr)){var Zr=Lr.append(wt,ir);if(sr[Mr]){var Yr=sr[Mr];re(Lr)?(Pr=wt.link(Zr,{stable:!0}),ir(wt.cond(Pr).then(wr,".enable(",Yr,");").else(wr,".disable(",Yr,");")),ir(vr,".",Mr,"=",Pr,";")):(ir(wt.cond(Zr).then(wr,".enable(",Yr,");").else(wr,".disable(",Yr,");")),ir(vr,".",Mr,"=",Zr,";"))}else if(u(Zr)){var rn=Ar[Mr];ir(wr,".",xr[Mr],"(",Zr,");",Zr.map(function(sn,yn){return rn+"["+yn+"]="+sn}).join(";"),";")}else re(Lr)?(Pr=wt.link(Zr,{stable:!0}),ir(wr,".",xr[Mr],"(",Pr,");",vr,".",Mr,"=",Pr,";")):ir(wr,".",xr[Mr],"(",Zr,");",vr,".",Mr,"=",Zr,";")}})}function dr(wt,ir){Hr&&(wt.instancing=ir.def(wt.shared.extensions,".angle_instanced_arrays"))}function _r(wt,ir,ar,Dr,Pr){function Er(){return typeof performance>"u"?"Date.now()":"performance.now()"}function Ar(yn){yn(Mr=ir.def(),"=",Er(),";"),typeof Pr=="string"?yn(Yr,".count+=",Pr,";"):yn(Yr,".count++;"),Mt&&(Dr?yn(Lr=ir.def(),"=",sn,".getNumPendingQueries();"):yn(sn,".beginQuery(",Yr,");"))}function vr(yn){yn(Yr,".cpuTime+=",Er(),"-",Mr,";"),Mt&&(Dr?yn(sn,".pushScopeStats(",Lr,",",sn,".getNumPendingQueries(),",Yr,");"):yn(sn,".endQuery();"))}function wr(yn){var kn=ir.def(rn,".profile");ir(rn,".profile=",yn,";"),ir.exit(rn,".profile=",kn,";")}var Mr,Lr,Zr=wt.shared,Yr=wt.stats,rn=Zr.current,sn=Zr.timer;if(ar=ar.profile){if(re(ar))return void(ar.enable?(Ar(ir),vr(ir.exit),wr("true")):wr("false"));wr(ar=ar.append(wt,ir))}else ar=ir.def(rn,".profile");Ar(Zr=wt.block()),ir("if(",ar,"){",Zr,"}"),vr(wt=wt.block()),ir.exit("if(",ar,"){",wt,"}")}function Ir(wt,ir,ar,Dr,Pr){function Er(vr,wr,Mr){function Lr(){ir("if(!",sn,".buffer){",Yr,".enableVertexAttribArray(",rn,");}");var Pn,Rn=Mr.type;Pn=Mr.size?ir.def(Mr.size,"||",wr):wr,ir("if(",sn,".type!==",Rn,"||",sn,".size!==",Pn,"||",wn.map(function(Xn){return sn+"."+Xn+"!=="+Mr[Xn]}).join("||"),"){",Yr,".bindBuffer(",34962,",",yn,".buffer);",Yr,".vertexAttribPointer(",[rn,Pn,Rn,Mr.normalized,Mr.stride,Mr.offset],");",sn,".type=",Rn,";",sn,".size=",Pn,";",wn.map(function(Xn){return sn+"."+Xn+"="+Mr[Xn]+";"}).join(""),"}"),Hr&&(Rn=Mr.divisor,ir("if(",sn,".divisor!==",Rn,"){",wt.instancing,".vertexAttribDivisorANGLE(",[rn,Rn],");",sn,".divisor=",Rn,";}"))}function Zr(){ir("if(",sn,".buffer){",Yr,".disableVertexAttribArray(",rn,");",sn,".buffer=null;","}if(",Gt.map(function(Pn,Rn){return sn+"."+Pn+"!=="+kn[Rn]}).join("||"),"){",Yr,".vertexAttrib4f(",rn,",",kn,");",Gt.map(function(Pn,Rn){return sn+"."+Pn+"="+kn[Rn]+";"}).join(""),"}")}var Yr=Ar.gl,rn=ir.def(vr,".location"),sn=ir.def(Ar.attributes,"[",rn,"]");vr=Mr.state;var yn=Mr.buffer,kn=[Mr.x,Mr.y,Mr.z,Mr.w],wn=["buffer","normalized","offset","stride"];vr===1?Lr():vr===2?Zr():(ir("if(",vr,"===",1,"){"),Lr(),ir("}else{"),Zr(),ir("}"))}var Ar=wt.shared;Dr.forEach(function(vr){var wr,Mr=vr.name,Lr=ar.attributes[Mr];if(Lr){if(!Pr(Lr))return;wr=Lr.append(wt,ir)}else{if(!Pr(Ye))return;var Zr=wt.scopeAttrib(Mr);wr={},Object.keys(new Mn).forEach(function(Yr){wr[Yr]=ir.def(Zr,".",Yr)})}Er(wt.link(vr),function(Yr){switch(Yr){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}(vr.info.type),wr)})}function Rr(wt,ir,ar,Dr,Pr,Er){for(var Ar,vr=wt.shared,wr=vr.gl,Mr=0;Mr<Dr.length;++Mr){var Lr,Zr=(sn=Dr[Mr]).name,Yr=sn.info.type,rn=ar.uniforms[Zr],sn=wt.link(sn)+".location";if(rn){if(!Pr(rn))continue;if(re(rn)){if(Zr=rn.value,Yr===35678||Yr===35680)ir(wr,".uniform1i(",sn,",",(Yr=wt.link(Zr._texture||Zr.color[0]._texture))+".bind());"),ir.exit(Yr,".unbind();");else if(Yr===35674||Yr===35675||Yr===35676)rn=2,Yr===35675?rn=3:Yr===35676&&(rn=4),ir(wr,".uniformMatrix",rn,"fv(",sn,",false,",Zr=wt.global.def("new Float32Array(["+Array.prototype.slice.call(Zr)+"])"),");");else{switch(Yr){case 5126:Ar="1f";break;case 35664:Ar="2f";break;case 35665:Ar="3f";break;case 35666:Ar="4f";break;case 35670:case 5124:Ar="1i";break;case 35671:case 35667:Ar="2i";break;case 35672:case 35668:Ar="3i";break;case 35673:Ar="4i";break;case 35669:Ar="4i"}ir(wr,".uniform",Ar,"(",sn,",",u(Zr)?Array.prototype.slice.call(Zr):Zr,");")}continue}Lr=rn.append(wt,ir)}else{if(!Pr(Ye))continue;Lr=ir.def(vr.uniforms,"[",_e.id(Zr),"]")}switch(Yr===35678?ir("if(",Lr,"&&",Lr,'._reglType==="framebuffer"){',Lr,"=",Lr,".color[0];","}"):Yr===35680&&ir("if(",Lr,"&&",Lr,'._reglType==="framebufferCube"){',Lr,"=",Lr,".color[0];","}"),Zr=1,Yr){case 35678:case 35680:Yr=ir.def(Lr,"._texture"),ir(wr,".uniform1i(",sn,",",Yr,".bind());"),ir.exit(Yr,".unbind();");continue;case 5124:case 35670:Ar="1i";break;case 35667:case 35671:Ar="2i",Zr=2;break;case 35668:case 35672:Ar="3i",Zr=3;break;case 35669:case 35673:Ar="4i",Zr=4;break;case 5126:Ar="1f";break;case 35664:Ar="2f",Zr=2;break;case 35665:Ar="3f",Zr=3;break;case 35666:Ar="4f",Zr=4;break;case 35674:Ar="Matrix2fv";break;case 35675:Ar="Matrix3fv";break;case 35676:Ar="Matrix4fv"}if(Ar.charAt(0)==="M"){ir(wr,".uniform",Ar,"(",sn,","),sn=Math.pow(Yr-35674+2,2);var yn=wt.global.def("new Float32Array(",sn,")");Array.isArray(Lr)?ir("false,(",t(sn,function(wn){return yn+"["+wn+"]="+Lr[wn]}),",",yn,")"):ir("false,(Array.isArray(",Lr,")||",Lr," instanceof Float32Array)?",Lr,":(",t(sn,function(wn){return yn+"["+wn+"]="+Lr+"["+wn+"]"}),",",yn,")"),ir(");")}else{if(1<Zr){Yr=[];var kn=[];for(rn=0;rn<Zr;++rn)Array.isArray(Lr)?kn.push(Lr[rn]):kn.push(ir.def(Lr+"["+rn+"]")),Er&&Yr.push(ir.def());Er&&ir("if(!",wt.batchId,"||",Yr.map(function(wn,Pn){return wn+"!=="+kn[Pn]}).join("||"),"){",Yr.map(function(wn,Pn){return wn+"="+kn[Pn]+";"}).join("")),ir(wr,".uniform",Ar,"(",sn,",",kn.join(","),");")}else Er&&(Yr=ir.def(),ir("if(!",wt.batchId,"||",Yr,"!==",Lr,"){",Yr,"=",Lr,";")),ir(wr,".uniform",Ar,"(",sn,",",Lr,");");Er&&ir("}")}}}function Vr(wt,ir,ar,Dr){function Pr(Rn){var Xn=Yr[Rn];return Xn?Xn.contextDep&&Dr.contextDynamic||Xn.propDep?Xn.append(wt,ar):Xn.append(wt,ir):ir.def(Zr,".",Rn)}function Er(){function Rn(){ar(wr,".drawElementsInstancedANGLE(",[sn,kn,wn,yn+"<<(("+wn+"-5121)>>1)",vr],");")}function Xn(){ar(wr,".drawArraysInstancedANGLE(",[sn,yn,kn,vr],");")}rn&&rn!=="null"?Pn?Rn():(ar("if(",rn,"){"),Rn(),ar("}else{"),Xn(),ar("}")):Xn()}function Ar(){function Rn(){ar(Lr+".drawElements("+[sn,kn,wn,yn+"<<(("+wn+"-5121)>>1)"]+");")}function Xn(){ar(Lr+".drawArrays("+[sn,yn,kn]+");")}rn&&rn!=="null"?Pn?Rn():(ar("if(",rn,"){"),Rn(),ar("}else{"),Xn(),ar("}")):Xn()}var vr,wr,Mr=wt.shared,Lr=Mr.gl,Zr=Mr.draw,Yr=Dr.draw,rn=function(){var Rn=Yr.elements,Xn=ir;return Rn?((Rn.contextDep&&Dr.contextDynamic||Rn.propDep)&&(Xn=ar),Rn=Rn.append(wt,Xn),Yr.elementsActive&&Xn("if("+Rn+")"+Lr+".bindBuffer(34963,"+Rn+".buffer.buffer);")):(Rn=Xn.def(),Xn(Rn,"=",Zr,".","elements",";","if(",Rn,"){",Lr,".bindBuffer(",34963,",",Rn,".buffer.buffer);}","else if(",Mr.vao,".currentVAO){",Rn,"=",wt.shared.elements+".getElements("+Mr.vao,".currentVAO.elements);",bn?"":"if("+Rn+")"+Lr+".bindBuffer(34963,"+Rn+".buffer.buffer);","}")),Rn}(),sn=Pr("primitive"),yn=Pr("offset"),kn=function(){var Rn=Yr.count,Xn=ir;return Rn?((Rn.contextDep&&Dr.contextDynamic||Rn.propDep)&&(Xn=ar),Rn=Rn.append(wt,Xn)):Rn=Xn.def(Zr,".","count"),Rn}();if(typeof kn=="number"){if(kn===0)return}else ar("if(",kn,"){"),ar.exit("}");Hr&&(vr=Pr("instances"),wr=wt.instancing);var wn=rn+".type",Pn=Yr.elements&&re(Yr.elements)&&!Yr.vaoActive;Hr&&(typeof vr!="number"||0<=vr)?typeof vr=="string"?(ar("if(",vr,">0){"),Er(),ar("}else if(",vr,"<0){"),Ar(),ar("}")):Er():Ar()}function Xr(wt,ir,ar,Dr,Pr){return Pr=(ir=St()).proc("body",Pr),Hr&&(ir.instancing=Pr.def(ir.shared.extensions,".angle_instanced_arrays")),wt(ir,Pr,ar,Dr),ir.compile().body}function cn(wt,ir,ar,Dr){dr(wt,ir),ar.useVAO?ar.drawVAO?ir(wt.shared.vao,".setVAO(",ar.drawVAO.append(wt,ir),");"):ir(wt.shared.vao,".setVAO(",wt.shared.vao,".targetVAO);"):(ir(wt.shared.vao,".setVAO(null);"),Ir(wt,ir,ar,Dr.attributes,function(){return!0})),Rr(wt,ir,ar,Dr.uniforms,function(){return!0},!1),Vr(wt,ir,ir,ar)}function an(wt,ir,ar,Dr){function Pr(){return!0}wt.batchId="a1",dr(wt,ir),Ir(wt,ir,ar,Dr.attributes,Pr),Rr(wt,ir,ar,Dr.uniforms,Pr,!1),Vr(wt,ir,ir,ar)}function zn(wt,ir,ar,Dr){function Pr(Zr){return Zr.contextDep&&Ar||Zr.propDep}function Er(Zr){return!Pr(Zr)}dr(wt,ir);var Ar=ar.contextDep,vr=ir.def(),wr=ir.def();wt.shared.props=wr,wt.batchId=vr;var Mr=wt.scope(),Lr=wt.scope();ir(Mr.entry,"for(",vr,"=0;",vr,"<","a1",";++",vr,"){",wr,"=","a0","[",vr,"];",Lr,"}",Mr.exit),ar.needsContext&&mr(wt,Lr,ar.context),ar.needsFramebuffer&&tr(wt,Lr,ar.framebuffer),Qt(wt,Lr,ar.state,Pr),ar.profile&&Pr(ar.profile)&&_r(wt,Lr,ar,!1,!0),Dr?(ar.useVAO?ar.drawVAO?Pr(ar.drawVAO)?Lr(wt.shared.vao,".setVAO(",ar.drawVAO.append(wt,Lr),");"):Mr(wt.shared.vao,".setVAO(",ar.drawVAO.append(wt,Mr),");"):Mr(wt.shared.vao,".setVAO(",wt.shared.vao,".targetVAO);"):(Mr(wt.shared.vao,".setVAO(null);"),Ir(wt,Mr,ar,Dr.attributes,Er),Ir(wt,Lr,ar,Dr.attributes,Pr)),Rr(wt,Mr,ar,Dr.uniforms,Er,!1),Rr(wt,Lr,ar,Dr.uniforms,Pr,!0),Vr(wt,Mr,Lr,ar)):(ir=wt.global.def("{}"),Dr=ar.shader.progVar.append(wt,Lr),wr=Lr.def(Dr,".id"),Mr=Lr.def(ir,"[",wr,"]"),Lr(wt.shared.gl,".useProgram(",Dr,".program);","if(!",Mr,"){",Mr,"=",ir,"[",wr,"]=",wt.link(function(Zr){return Xr(an,wt,ar,Zr,2)}),"(",Dr,");}",Mr,".call(this,a0[",vr,"],",vr,");"))}function on(wt,ir){function ar(vr){var wr=ir.shader[vr];wr&&(wr=wr.append(wt,Dr),isNaN(wr)?Dr.set(Pr.shader,"."+vr,wr):Dr.set(Pr.shader,"."+vr,wt.link(wr,{stable:!0})))}var Dr=wt.proc("scope",3);wt.batchId="a2";var Pr=wt.shared,Er=Pr.current;if(mr(wt,Dr,ir.context),ir.framebuffer&&ir.framebuffer.append(wt,Dr),X(Object.keys(ir.state)).forEach(function(vr){var wr=ir.state[vr],Mr=wr.append(wt,Dr);u(Mr)?Mr.forEach(function(Lr,Zr){isNaN(Lr)?Dr.set(wt.next[vr],"["+Zr+"]",Lr):Dr.set(wt.next[vr],"["+Zr+"]",wt.link(Lr,{stable:!0}))}):re(wr)?Dr.set(Pr.next,"."+vr,wt.link(Mr,{stable:!0})):Dr.set(Pr.next,"."+vr,Mr)}),_r(wt,Dr,ir,!0,!0),["elements","offset","count","instances","primitive"].forEach(function(vr){var wr=ir.draw[vr];wr&&(wr=wr.append(wt,Dr),isNaN(wr)?Dr.set(Pr.draw,"."+vr,wr):Dr.set(Pr.draw,"."+vr,wt.link(wr),{stable:!0}))}),Object.keys(ir.uniforms).forEach(function(vr){var wr=ir.uniforms[vr].append(wt,Dr);Array.isArray(wr)&&(wr="["+wr.map(function(Mr){return isNaN(Mr)?Mr:wt.link(Mr,{stable:!0})})+"]"),Dr.set(Pr.uniforms,"["+wt.link(_e.id(vr),{stable:!0})+"]",wr)}),Object.keys(ir.attributes).forEach(function(vr){var wr=ir.attributes[vr].append(wt,Dr),Mr=wt.scopeAttrib(vr);Object.keys(new Mn).forEach(function(Lr){Dr.set(Mr,"."+Lr,wr[Lr])})}),ir.scopeVAO){var Ar=ir.scopeVAO.append(wt,Dr);isNaN(Ar)?Dr.set(Pr.vao,".targetVAO",Ar):Dr.set(Pr.vao,".targetVAO",wt.link(Ar,{stable:!0}))}ar("vert"),ar("frag"),0<Object.keys(ir.state).length&&(Dr(Er,".dirty=true;"),Dr.exit(Er,".dirty=true;")),Dr("a1(",wt.shared.context,",a0,",wt.batchId,");")}function Tn(wt,ir,ar){var Dr=ir.static[ar];if(Dr&&function(Lr){if(typeof Lr=="object"&&!u(Lr)){for(var Zr=Object.keys(Lr),Yr=0;Yr<Zr.length;++Yr)if(J.isDynamic(Lr[Zr[Yr]]))return!0;return!1}}(Dr)){var Pr=wt.global,Er=Object.keys(Dr),Ar=!1,vr=!1,wr=!1,Mr=wt.global.def("{}");Er.forEach(function(Lr){var Zr=Dr[Lr];if(J.isDynamic(Zr))typeof Zr=="function"&&(Zr=Dr[Lr]=J.unbox(Zr)),Lr=N(Zr,null),Ar=Ar||Lr.thisDep,wr=wr||Lr.propDep,vr=vr||Lr.contextDep;else{switch(Pr(Mr,".",Lr,"="),typeof Zr){case"number":Pr(Zr);break;case"string":Pr('"',Zr,'"');break;case"object":Array.isArray(Zr)&&Pr("[",Zr.join(),"]");break;default:Pr(wt.link(Zr))}Pr(";")}}),ir.dynamic[ar]=new J.DynamicVariable(4,{thisDep:Ar,contextDep:vr,propDep:wr,ref:Mr,append:function(Lr,Zr){Er.forEach(function(Yr){var rn=Dr[Yr];J.isDynamic(rn)&&(rn=Lr.invoke(Zr,rn),Zr(Mr,".",Yr,"=",rn,";"))})}}),delete ir.static[ar]}}var Mn=Ot.Record,ei={add:32774,subtract:32778,"reverse subtract":32779};Be.ext_blend_minmax&&(ei.min=32775,ei.max=32776);var Hr=Be.angle_instanced_arrays,ln=Be.webgl_draw_buffers,bn=Be.oes_vertex_array_object,nn={dirty:!0,profile:Le.profile},pn={},qn=[],sr={},xr={};ot("dither",3024),ot("blend.enable",3042),pt("blend.color","blendColor",[0,0,0,0]),pt("blend.equation","blendEquationSeparate",[32774,32774]),pt("blend.func","blendFuncSeparate",[1,0,1,0]),ot("depth.enable",2929,!0),pt("depth.func","depthFunc",513),pt("depth.range","depthRange",[0,1]),pt("depth.mask","depthMask",!0),pt("colorMask","colorMask",[!0,!0,!0,!0]),ot("cull.enable",2884),pt("cull.face","cullFace",1029),pt("frontFace","frontFace",2305),pt("lineWidth","lineWidth",1),ot("polygonOffset.enable",32823),pt("polygonOffset.offset","polygonOffset",[0,0]),ot("sample.alpha",32926),ot("sample.enable",32928),pt("sample.coverage","sampleCoverage",[1,!1]),ot("stencil.enable",2960),pt("stencil.mask","stencilMask",-1),pt("stencil.func","stencilFunc",[519,0,-1]),pt("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),pt("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),ot("scissor.enable",3089),pt("scissor.box","scissor",[0,0,pe.drawingBufferWidth,pe.drawingBufferHeight]),pt("viewport","viewport",[0,0,pe.drawingBufferWidth,pe.drawingBufferHeight]);var jr={gl:pe,context:Ut,strings:_e,next:pn,current:nn,draw:ht,elements:Ze,buffer:Je,shader:it,attributes:Ot.state,vao:Ot,uniforms:At,framebuffer:lt,extensions:Be,timer:Mt,isBufferArgs:Q},Rt={primTypes:Me,compareFuncs:cr,blendFuncs:Zt,blendEquations:ei,stencilOps:Dt,glTypes:fe,orientationType:Ne};ln&&(Rt.backBuffer=[1029],Rt.drawBuffer=t(He.maxDrawbuffers,function(wt){return wt===0?[0]:t(wt,function(ir){return 36064+ir})}));var or=0;return{next:pn,current:nn,procs:function(){var wt=St(),ir=wt.proc("poll"),ar=wt.proc("refresh"),Dr=wt.block();ir(Dr),ar(Dr);var Pr,Er=(wr=wt.shared).gl,Ar=wr.next,vr=wr.current;Dr(vr,".dirty=false;"),tr(wt,ir),tr(wt,ar,null,!0),Hr&&(Pr=wt.link(Hr)),Be.oes_vertex_array_object&&ar(wt.link(Be.oes_vertex_array_object),".bindVertexArrayOES(null);");var wr=ar.def(wr.attributes),Mr=ar.def(0),Lr=wt.cond(Mr,".buffer");Lr.then(Er,".enableVertexAttribArray(i);",Er,".bindBuffer(",34962,",",Mr,".buffer.buffer);",Er,".vertexAttribPointer(i,",Mr,".size,",Mr,".type,",Mr,".normalized,",Mr,".stride,",Mr,".offset);").else(Er,".disableVertexAttribArray(i);",Er,".vertexAttrib4f(i,",Mr,".x,",Mr,".y,",Mr,".z,",Mr,".w);",Mr,".buffer=null;");var Zr=wt.link(He.maxAttributes,{stable:!0});return ar("for(var i=0;i<",Zr,";++i){",Mr,"=",wr,"[i];",Lr,"}"),Hr&&ar("for(var i=0;i<",Zr,";++i){",Pr,".vertexAttribDivisorANGLE(i,",wr,"[i].divisor);","}"),ar(wt.shared.vao,".currentVAO=null;",wt.shared.vao,".setVAO(",wt.shared.vao,".targetVAO);"),Object.keys(sr).forEach(function(Yr){var rn=sr[Yr],sn=Dr.def(Ar,".",Yr),yn=wt.block();yn("if(",sn,"){",Er,".enable(",rn,")}else{",Er,".disable(",rn,")}",vr,".",Yr,"=",sn,";"),ar(yn),ir("if(",sn,"!==",vr,".",Yr,"){",yn,"}")}),Object.keys(xr).forEach(function(Yr){var rn,sn,yn=xr[Yr],kn=nn[Yr],wn=wt.block();wn(Er,".",yn,"("),u(kn)?(yn=kn.length,rn=wt.global.def(Ar,".",Yr),sn=wt.global.def(vr,".",Yr),wn(t(yn,function(Pn){return rn+"["+Pn+"]"}),");",t(yn,function(Pn){return sn+"["+Pn+"]="+rn+"["+Pn+"];"}).join("")),ir("if(",t(yn,function(Pn){return rn+"["+Pn+"]!=="+sn+"["+Pn+"]"}).join("||"),"){",wn,"}")):(rn=Dr.def(Ar,".",Yr),sn=Dr.def(vr,".",Yr),wn(rn,");",vr,".",Yr,"=",rn,";"),ir("if(",rn,"!==",sn,"){",wn,"}")),ar(wn)}),wt.compile()}(),compile:function(wt,ir,ar,Dr,Pr){var Er=St();Er.stats=Er.link(Pr),Object.keys(ir.static).forEach(function(vr){Tn(Er,ir,vr)}),$t.forEach(function(vr){Tn(Er,wt,vr)});var Ar=Cr(wt,ir,ar,Dr);return Ar.shader.program&&(Ar.shader.program.attributes.sort(function(vr,wr){return vr.name<wr.name?-1:1}),Ar.shader.program.uniforms.sort(function(vr,wr){return vr.name<wr.name?-1:1})),function(vr,wr){var Mr=vr.proc("draw",1);dr(vr,Mr),mr(vr,Mr,wr.context),tr(vr,Mr,wr.framebuffer),nr(vr,Mr,wr),Qt(vr,Mr,wr.state),_r(vr,Mr,wr,!1,!0);var Lr=wr.shader.progVar.append(vr,Mr);if(Mr(vr.shared.gl,".useProgram(",Lr,".program);"),wr.shader.program)cn(vr,Mr,wr,wr.shader.program);else{Mr(vr.shared.vao,".setVAO(null);");var Zr=vr.global.def("{}"),Yr=Mr.def(Lr,".id"),rn=Mr.def(Zr,"[",Yr,"]");Mr(vr.cond(rn).then(rn,".call(this,a0);").else(rn,"=",Zr,"[",Yr,"]=",vr.link(function(sn){return Xr(cn,vr,wr,sn,1)}),"(",Lr,");",rn,".call(this,a0);"))}0<Object.keys(wr.state).length&&Mr(vr.shared.current,".dirty=true;"),vr.shared.vao&&Mr(vr.shared.vao,".setVAO(null);")}(Er,Ar),on(Er,Ar),function(vr,wr){function Mr(kn){return kn.contextDep&&Zr||kn.propDep}var Lr=vr.proc("batch",2);vr.batchId="0",dr(vr,Lr);var Zr=!1,Yr=!0;Object.keys(wr.context).forEach(function(kn){Zr=Zr||wr.context[kn].propDep}),Zr||(mr(vr,Lr,wr.context),Yr=!1);var rn=!1;if((sn=wr.framebuffer)?(sn.propDep?Zr=rn=!0:sn.contextDep&&Zr&&(rn=!0),rn||tr(vr,Lr,sn)):tr(vr,Lr,null),wr.state.viewport&&wr.state.viewport.propDep&&(Zr=!0),nr(vr,Lr,wr),Qt(vr,Lr,wr.state,function(kn){return!Mr(kn)}),wr.profile&&Mr(wr.profile)||_r(vr,Lr,wr,!1,"a1"),wr.contextDep=Zr,wr.needsContext=Yr,wr.needsFramebuffer=rn,(Yr=wr.shader.progVar).contextDep&&Zr||Yr.propDep)zn(vr,Lr,wr,null);else if(Yr=Yr.append(vr,Lr),Lr(vr.shared.gl,".useProgram(",Yr,".program);"),wr.shader.program)zn(vr,Lr,wr,wr.shader.program);else{Lr(vr.shared.vao,".setVAO(null);");var sn=vr.global.def("{}"),yn=(rn=Lr.def(Yr,".id"),Lr.def(sn,"[",rn,"]"));Lr(vr.cond(yn).then(yn,".call(this,a0,a1);").else(yn,"=",sn,"[",rn,"]=",vr.link(function(kn){return Xr(zn,vr,wr,kn,2)}),"(",Yr,");",yn,".call(this,a0,a1);"))}0<Object.keys(wr.state).length&&Lr(vr.shared.current,".dirty=true;"),vr.shared.vao&&Lr(vr.shared.vao,".setVAO(null);")}(Er,Ar),B(Er.compile(),{destroy:function(){Ar.shader.program.destroy()}})}}}function te(pe,_e){for(var Be=0;Be<pe.length;++Be)if(pe[Be]===_e)return Be;return-1}var B=function(pe,_e){for(var Be=Object.keys(_e),He=0;He<Be.length;++He)pe[Be[He]]=_e[Be[He]];return pe},K=0,J={DynamicVariable:d,define:function(pe,_e){return new d(pe,v(_e+""))},isDynamic:function(pe){return typeof pe=="function"&&!pe._reglType||pe instanceof d},unbox:function pe(_e,Be){return typeof _e=="function"?new d(0,_e):typeof _e=="number"||typeof _e=="boolean"?new d(5,_e):Array.isArray(_e)?new d(6,_e.map(function(He,Je){return pe(He)})):_e instanceof d?_e:void 0},accessor:v},ee={next:typeof requestAnimationFrame=="function"?function(pe){return requestAnimationFrame(pe)}:function(pe){return setTimeout(pe,16)},cancel:typeof cancelAnimationFrame=="function"?function(pe){return cancelAnimationFrame(pe)}:clearTimeout},ne=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date},se=o();se.zero=o();var oe=function(pe,_e){var Be=1;_e.ext_texture_filter_anisotropic&&(Be=pe.getParameter(34047));var He=1,Je=1;_e.webgl_draw_buffers&&(He=pe.getParameter(34852),Je=pe.getParameter(36063));var Ze=!!_e.oes_texture_float;if(Ze){Ze=pe.createTexture(),pe.bindTexture(3553,Ze),pe.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var ct=pe.createFramebuffer();if(pe.bindFramebuffer(36160,ct),pe.framebufferTexture2D(36160,36064,3553,Ze,0),pe.bindTexture(3553,null),pe.checkFramebufferStatus(36160)!==36053)Ze=!1;else{pe.viewport(0,0,1,1),pe.clearColor(1,0,0,1),pe.clear(16384);var lt=se.allocType(5126,4);pe.readPixels(0,0,1,1,6408,5126,lt),pe.getError()?Ze=!1:(pe.deleteFramebuffer(ct),pe.deleteTexture(Ze),Ze=lt[0]===1),se.freeType(lt)}}return lt=!0,typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(lt=pe.createTexture(),ct=se.allocType(5121,36),pe.activeTexture(33984),pe.bindTexture(34067,lt),pe.texImage2D(34069,0,6408,3,3,0,6408,5121,ct),se.freeType(ct),pe.bindTexture(34067,null),pe.deleteTexture(lt),lt=!pe.getError()),{colorBits:[pe.getParameter(3410),pe.getParameter(3411),pe.getParameter(3412),pe.getParameter(3413)],depthBits:pe.getParameter(3414),stencilBits:pe.getParameter(3415),subpixelBits:pe.getParameter(3408),extensions:Object.keys(_e).filter(function(At){return!!_e[At]}),maxAnisotropic:Be,maxDrawbuffers:He,maxColorAttachments:Je,pointSizeDims:pe.getParameter(33901),lineWidthDims:pe.getParameter(33902),maxViewportDims:pe.getParameter(3386),maxCombinedTextureUnits:pe.getParameter(35661),maxCubeMapSize:pe.getParameter(34076),maxRenderbufferSize:pe.getParameter(34024),maxTextureUnits:pe.getParameter(34930),maxTextureSize:pe.getParameter(3379),maxAttributes:pe.getParameter(34921),maxVertexUniforms:pe.getParameter(36347),maxVertexTextureUnits:pe.getParameter(35660),maxVaryingVectors:pe.getParameter(36348),maxFragmentUniforms:pe.getParameter(36349),glsl:pe.getParameter(35724),renderer:pe.getParameter(7937),vendor:pe.getParameter(7936),version:pe.getParameter(7938),readFloat:Ze,npotTextureCube:lt}},me=function(pe){return pe instanceof Uint8Array||pe instanceof Uint16Array||pe instanceof Uint32Array||pe instanceof Int8Array||pe instanceof Int16Array||pe instanceof Int32Array||pe instanceof Float32Array||pe instanceof Float64Array||pe instanceof Uint8ClampedArray},ce=function(pe){return Object.keys(pe).map(function(_e){return pe[_e]})},ye={shape:function(pe){for(var _e=[];pe.length;pe=pe[0])_e.push(pe.length);return _e},flatten:function(pe,_e,Be,He){var Je=1;if(_e.length)for(var Ze=0;Ze<_e.length;++Ze)Je*=_e[Ze];else Je=0;switch(Be=He||se.allocType(Be,Je),_e.length){case 0:break;case 1:for(He=_e[0],_e=0;_e<He;++_e)Be[_e]=pe[_e];break;case 2:for(He=_e[0],_e=_e[1],Ze=Je=0;Ze<He;++Ze)for(var ct=pe[Ze],lt=0;lt<_e;++lt)Be[Je++]=ct[lt];break;case 3:g(pe,_e[0],_e[1],_e[2],Be,0);break;default:(function At(Ot,it,ht,Ut,Mt){for(var It=1,Le=ht+1;Le<it.length;++Le)It*=it[Le];var Xe=it[ht];if(it.length-ht==4){var ot=it[ht+1],pt=it[ht+2];for(it=it[ht+3],Le=0;Le<Xe;++Le)g(Ot[Le],ot,pt,it,Ut,Mt),Mt+=It}else for(Le=0;Le<Xe;++Le)At(Ot[Le],it,ht+1,Ut,Mt),Mt+=It})(pe,_e,0,Be,0)}return Be}},Se={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},fe={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},ge={dynamic:35048,stream:35040,static:35044},Te=ye.flatten,le=ye.shape,ve=[];ve[5120]=1,ve[5122]=2,ve[5124]=4,ve[5121]=1,ve[5123]=2,ve[5125]=4,ve[5126]=4;var Me={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},we=new Float32Array(1),de=new Uint32Array(we.buffer),Ie=[9984,9986,9985,9987],De=[0,6409,6410,6407,6408],Oe={};Oe[6409]=Oe[6406]=Oe[6402]=1,Oe[34041]=Oe[6410]=2,Oe[6407]=Oe[35904]=3,Oe[6408]=Oe[35906]=4;var Ve=i("HTMLCanvasElement"),Fe=i("OffscreenCanvas"),ze=i("CanvasRenderingContext2D"),Re=i("ImageBitmap"),We=i("HTMLImageElement"),$e=i("HTMLVideoElement"),at=Object.keys(Se).concat([Ve,Fe,ze,Re,We,$e]),gt=[];gt[5121]=1,gt[5126]=4,gt[36193]=2,gt[5123]=2,gt[5125]=4;var xt=[];xt[32854]=2,xt[32855]=2,xt[36194]=2,xt[34041]=4,xt[33776]=.5,xt[33777]=.5,xt[33778]=1,xt[33779]=1,xt[35986]=.5,xt[35987]=1,xt[34798]=1,xt[35840]=.5,xt[35841]=.25,xt[35842]=.5,xt[35843]=.25,xt[36196]=.5;var mt=[];mt[32854]=2,mt[32855]=2,mt[36194]=2,mt[33189]=2,mt[36168]=1,mt[34041]=4,mt[35907]=4,mt[34836]=16,mt[34842]=8,mt[34843]=6;var nt=function(pe,_e,Be,He,Je){function Ze(ht){this.id=Ot++,this.refCount=1,this.renderbuffer=ht,this.format=32854,this.height=this.width=0,Je.profile&&(this.stats={size:0})}function ct(ht){var Ut=ht.renderbuffer;pe.bindRenderbuffer(36161,null),pe.deleteRenderbuffer(Ut),ht.renderbuffer=null,ht.refCount=0,delete it[ht.id],He.renderbufferCount--}var lt={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};_e.ext_srgb&&(lt.srgba=35907),_e.ext_color_buffer_half_float&&(lt.rgba16f=34842,lt.rgb16f=34843),_e.webgl_color_buffer_float&&(lt.rgba32f=34836);var At=[];Object.keys(lt).forEach(function(ht){At[lt[ht]]=ht});var Ot=0,it={};return Ze.prototype.decRef=function(){0>=--this.refCount&&ct(this)},Je.profile&&(He.getTotalRenderbufferSize=function(){var ht=0;return Object.keys(it).forEach(function(Ut){ht+=it[Ut].stats.size}),ht}),{create:function(ht,Ut){function Mt(Le,Xe){var ot=0,pt=0,St=32854;if(typeof Le=="object"&&Le?("shape"in Le?(ot=0|(pt=Le.shape)[0],pt=0|pt[1]):("radius"in Le&&(ot=pt=0|Le.radius),"width"in Le&&(ot=0|Le.width),"height"in Le&&(pt=0|Le.height)),"format"in Le&&(St=lt[Le.format])):typeof Le=="number"?(ot=0|Le,pt=typeof Xe=="number"?0|Xe:ot):Le||(ot=pt=1),ot!==It.width||pt!==It.height||St!==It.format)return Mt.width=It.width=ot,Mt.height=It.height=pt,It.format=St,pe.bindRenderbuffer(36161,It.renderbuffer),pe.renderbufferStorage(36161,St,ot,pt),Je.profile&&(It.stats.size=mt[It.format]*It.width*It.height),Mt.format=At[It.format],Mt}var It=new Ze(pe.createRenderbuffer());return it[It.id]=It,He.renderbufferCount++,Mt(ht,Ut),Mt.resize=function(Le,Xe){var ot=0|Le,pt=0|Xe||ot;return ot===It.width&&pt===It.height||(Mt.width=It.width=ot,Mt.height=It.height=pt,pe.bindRenderbuffer(36161,It.renderbuffer),pe.renderbufferStorage(36161,It.format,ot,pt),Je.profile&&(It.stats.size=mt[It.format]*It.width*It.height)),Mt},Mt._reglType="renderbuffer",Mt._renderbuffer=It,Je.profile&&(Mt.stats=It.stats),Mt.destroy=function(){It.decRef()},Mt},clear:function(){ce(it).forEach(ct)},restore:function(){ce(it).forEach(function(ht){ht.renderbuffer=pe.createRenderbuffer(),pe.bindRenderbuffer(36161,ht.renderbuffer),pe.renderbufferStorage(36161,ht.format,ht.width,ht.height)}),pe.bindRenderbuffer(36161,null)}}},Qe=[];Qe[6408]=4,Qe[6407]=3;var vt=[];vt[5121]=1,vt[5126]=4,vt[36193]=2;var jt=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Gt=["x","y","z","w"],$t="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),Zt={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},cr={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},Dt={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Ne={cw:2304,ccw:2305},Ye=new $(!1,!1,!1,function(){});return function(pe){function _e(){if(an.length===0)Vt&&Vt.update(),Mn=null;else{Mn=ee.next(_e),it();for(var Hr=an.length-1;0<=Hr;--Hr){var ln=an[Hr];ln&&ln(Cr,null,0)}Mt.flush(),Vt&&Vt.update()}}function Be(){!Mn&&0<an.length&&(Mn=ee.next(_e))}function He(){Mn&&(ee.cancel(_e),Mn=null)}function Je(Hr){Hr.preventDefault(),He(),zn.forEach(function(ln){ln()})}function Ze(Hr){Mt.getError(),Le.restore(),dr.restore(),tr.restore(),_r.restore(),Ir.restore(),Rr.restore(),Qt.restore(),Vt&&Vt.restore(),Vr.procs.refresh(),Be(),on.forEach(function(ln){ln()})}function ct(Hr){function ln(wt,ir){var ar={},Dr={};return Object.keys(wt).forEach(function(Pr){var Er=wt[Pr];if(J.isDynamic(Er))Dr[Pr]=J.unbox(Er,Pr);else{if(ir&&Array.isArray(Er)){for(var Ar=0;Ar<Er.length;++Ar)if(J.isDynamic(Er[Ar]))return void(Dr[Pr]=J.unbox(Er,Pr))}ar[Pr]=Er}}),{dynamic:Dr,static:ar}}var bn=ln(Hr.context||{},!0),nn=ln(Hr.uniforms||{},!0),pn=ln(Hr.attributes||{},!1);Hr=ln(function(wt){function ir(Dr){if(Dr in ar){var Pr=ar[Dr];delete ar[Dr],Object.keys(Pr).forEach(function(Er){ar[Dr+"."+Er]=Pr[Er]})}}var ar=B({},wt);return delete ar.uniforms,delete ar.attributes,delete ar.context,delete ar.vao,"stencil"in ar&&ar.stencil.op&&(ar.stencil.opBack=ar.stencil.opFront=ar.stencil.op,delete ar.stencil.op),ir("blend"),ir("depth"),ir("cull"),ir("stencil"),ir("polygonOffset"),ir("scissor"),ir("sample"),"vao"in wt&&(ar.vao=wt.vao),ar}(Hr),!1);var qn={gpuTime:0,cpuTime:0,count:0},sr=Vr.compile(Hr,pn,nn,bn,qn),xr=sr.draw,jr=sr.batch,Rt=sr.scope,or=[];return B(function(wt,ir){var ar;if(typeof wt=="function")return Rt.call(this,null,wt,0);if(typeof ir=="function")if(typeof wt=="number")for(ar=0;ar<wt;++ar)Rt.call(this,null,ir,ar);else{if(!Array.isArray(wt))return Rt.call(this,wt,ir,0);for(ar=0;ar<wt.length;++ar)Rt.call(this,wt[ar],ir,ar)}else if(typeof wt=="number"){if(0<wt)return jr.call(this,function(Dr){for(;or.length<Dr;)or.push(null);return or}(0|wt),0|wt)}else{if(!Array.isArray(wt))return xr.call(this,wt);if(wt.length)return jr.call(this,wt,wt.length)}},{stats:qn,destroy:function(){sr.destroy()}})}function lt(Hr,ln){var bn=0;Vr.procs.poll();var nn=ln.color;nn&&(Mt.clearColor(+nn[0]||0,+nn[1]||0,+nn[2]||0,+nn[3]||0),bn|=16384),"depth"in ln&&(Mt.clearDepth(+ln.depth),bn|=256),"stencil"in ln&&(Mt.clearStencil(0|ln.stencil),bn|=1024),Mt.clear(bn)}function At(Hr){return an.push(Hr),Be(),{cancel:function(){var ln=te(an,Hr);an[ln]=function bn(){var nn=te(an,bn);an[nn]=an[an.length-1],--an.length,0>=an.length&&He()}}}}function Ot(){var Hr=Xr.viewport,ln=Xr.scissor_box;Hr[0]=Hr[1]=ln[0]=ln[1]=0,Cr.viewportWidth=Cr.framebufferWidth=Cr.drawingBufferWidth=Hr[2]=ln[2]=Mt.drawingBufferWidth,Cr.viewportHeight=Cr.framebufferHeight=Cr.drawingBufferHeight=Hr[3]=ln[3]=Mt.drawingBufferHeight}function it(){Cr.tick+=1,Cr.time=Ut(),Ot(),Vr.procs.poll()}function ht(){_r.refresh(),Ot(),Vr.procs.refresh(),Vt&&Vt.update()}function Ut(){return(ne()-Jt)/1e3}if(!(pe=e(pe)))return null;var Mt=pe.gl,It=Mt.getContextAttributes();Mt.isContextLost();var Le=function(Hr,ln){function bn(sr){var xr;sr=sr.toLowerCase();try{xr=nn[sr]=Hr.getExtension(sr)}catch{}return!!xr}for(var nn={},pn=0;pn<ln.extensions.length;++pn){var qn=ln.extensions[pn];if(!bn(qn))return ln.onDestroy(),ln.onDone('"'+qn+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return ln.optionalExtensions.forEach(bn),{extensions:nn,restore:function(){Object.keys(nn).forEach(function(sr){if(nn[sr]&&!bn(sr))throw Error("(regl): error restoring extension "+sr)})}}}(Mt,pe);if(!Le)return null;var Xe=function(){var Hr={"":0},ln=[""];return{id:function(bn){var nn=Hr[bn];return nn||(nn=Hr[bn]=ln.length,ln.push(bn),nn)},str:function(bn){return ln[bn]}}}(),ot={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},pt=pe.cachedCode||{},St=Le.extensions,Vt=function(Hr,ln){function bn(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function nn(or,wt,ir){var ar=sr.pop()||new bn;ar.startQueryIndex=or,ar.endQueryIndex=wt,ar.sum=0,ar.stats=ir,xr.push(ar)}if(!ln.ext_disjoint_timer_query)return null;var pn=[],qn=[],sr=[],xr=[],jr=[],Rt=[];return{beginQuery:function(or){var wt=pn.pop()||ln.ext_disjoint_timer_query.createQueryEXT();ln.ext_disjoint_timer_query.beginQueryEXT(35007,wt),qn.push(wt),nn(qn.length-1,qn.length,or)},endQuery:function(){ln.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:nn,update:function(){var or,wt;if((or=qn.length)!==0){Rt.length=Math.max(Rt.length,or+1),jr.length=Math.max(jr.length,or+1),jr[0]=0;var ir=Rt[0]=0;for(wt=or=0;wt<qn.length;++wt){var ar=qn[wt];ln.ext_disjoint_timer_query.getQueryObjectEXT(ar,34919)?(ir+=ln.ext_disjoint_timer_query.getQueryObjectEXT(ar,34918),pn.push(ar)):qn[or++]=ar,jr[wt+1]=ir,Rt[wt+1]=or}for(qn.length=or,wt=or=0;wt<xr.length;++wt){var Dr=(ir=xr[wt]).startQueryIndex;ar=ir.endQueryIndex,ir.sum+=jr[ar]-jr[Dr],Dr=Rt[Dr],(ar=Rt[ar])===Dr?(ir.stats.gpuTime+=ir.sum/1e6,sr.push(ir)):(ir.startQueryIndex=Dr,ir.endQueryIndex=ar,xr[or++]=ir)}xr.length=or}},getNumPendingQueries:function(){return qn.length},clear:function(){pn.push.apply(pn,qn);for(var or=0;or<pn.length;or++)ln.ext_disjoint_timer_query.deleteQueryEXT(pn[or]);qn.length=0,pn.length=0},restore:function(){qn.length=0,pn.length=0}}}(0,St),Jt=ne(),qt=Mt.drawingBufferWidth,gr=Mt.drawingBufferHeight,Cr={tick:0,time:0,viewportWidth:qt,viewportHeight:gr,framebufferWidth:qt,framebufferHeight:gr,drawingBufferWidth:qt,drawingBufferHeight:gr,pixelRatio:pe.pixelRatio},mr=(qt={elements:null,primitive:4,count:-1,offset:0,instances:-1},oe(Mt,St)),tr=l(Mt,ot,pe,function(Hr){return Qt.destroyBuffer(Hr)}),nr=s(Mt,St,tr,ot),Qt=P(Mt,St,mr,ot,tr,nr,qt),dr=S(Mt,Xe,ot,pe),_r=L(Mt,St,mr,function(){Vr.procs.poll()},Cr,ot,pe),Ir=nt(Mt,St,0,ot,pe),Rr=A(Mt,St,mr,_r,Ir,ot),Vr=U(Mt,Xe,St,mr,tr,nr,0,Rr,{},Qt,dr,qt,Cr,Vt,pt,pe),Xr=(Xe=E(Mt,Rr,Vr.procs.poll,Cr),Vr.next),cn=Mt.canvas,an=[],zn=[],on=[],Tn=[pe.onDestroy],Mn=null;cn&&(cn.addEventListener("webglcontextlost",Je,!1),cn.addEventListener("webglcontextrestored",Ze,!1));var ei=Rr.setFBO=ct({framebuffer:J.define.call(null,1,"framebuffer")});return ht(),It=B(ct,{clear:function(Hr){if("framebuffer"in Hr)if(Hr.framebuffer&&Hr.framebuffer_reglType==="framebufferCube")for(var ln=0;6>ln;++ln)ei(B({framebuffer:Hr.framebuffer.faces[ln]},Hr),lt);else ei(Hr,lt);else lt(0,Hr)},prop:J.define.bind(null,1),context:J.define.bind(null,2),this:J.define.bind(null,3),draw:ct({}),buffer:function(Hr){return tr.create(Hr,34962,!1,!1)},elements:function(Hr){return nr.create(Hr,!1)},texture:_r.create2D,cube:_r.createCube,renderbuffer:Ir.create,framebuffer:Rr.create,framebufferCube:Rr.createCube,vao:Qt.createVAO,attributes:It,frame:At,on:function(Hr,ln){var bn;switch(Hr){case"frame":return At(ln);case"lost":bn=zn;break;case"restore":bn=on;break;case"destroy":bn=Tn}return bn.push(ln),{cancel:function(){for(var nn=0;nn<bn.length;++nn)if(bn[nn]===ln){bn[nn]=bn[bn.length-1],bn.pop();break}}}},limits:mr,hasExtension:function(Hr){return 0<=mr.extensions.indexOf(Hr.toLowerCase())},read:Xe,destroy:function(){an.length=0,He(),cn&&(cn.removeEventListener("webglcontextlost",Je),cn.removeEventListener("webglcontextrestored",Ze)),dr.clear(),Rr.clear(),Ir.clear(),Qt.clear(),_r.clear(),nr.clear(),tr.clear(),Vt&&Vt.clear(),Tn.forEach(function(Hr){Hr()})},_gl:Mt,_refresh:ht,poll:function(){it(),Vt&&Vt.update()},now:Ut,stats:ot,getCachedCode:function(){return pt},preloadCachedCode:function(Hr){Object.entries(Hr).forEach(function(ln){pt[ln[0]]=ln[1]})}}),pe.onDone(null,It),It}})},{}],285:[function(m,G,Y){var d=m("buffer"),v=d.Buffer;function w(e,t){for(var n in e)t[n]=e[n]}function y(e,t,n){return v(e,t,n)}v.from&&v.alloc&&v.allocUnsafe&&v.allocUnsafeSlow?G.exports=d:(w(d,Y),Y.Buffer=y),y.prototype=Object.create(v.prototype),w(v,y),y.from=function(e,t,n){if(typeof e=="number")throw new TypeError("Argument must not be a number");return v(e,t,n)},y.alloc=function(e,t,n){if(typeof e!="number")throw new TypeError("Argument must be a number");var o=v(e);return t!==void 0?typeof n=="string"?o.fill(t,n):o.fill(t):o.fill(0),o},y.allocUnsafe=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return v(e)},y.allocUnsafeSlow=function(e){if(typeof e!="number")throw new TypeError("Argument must be a number");return d.SlowBuffer(e)}},{buffer:85}],286:[function(m,G,Y){G.exports=v;var d=m("events").EventEmitter;function v(){d.call(this)}m("inherits")(v,d),v.Readable=m("readable-stream/lib/_stream_readable.js"),v.Writable=m("readable-stream/lib/_stream_writable.js"),v.Duplex=m("readable-stream/lib/_stream_duplex.js"),v.Transform=m("readable-stream/lib/_stream_transform.js"),v.PassThrough=m("readable-stream/lib/_stream_passthrough.js"),v.finished=m("readable-stream/lib/internal/streams/end-of-stream.js"),v.pipeline=m("readable-stream/lib/internal/streams/pipeline.js"),v.Stream=v,v.prototype.pipe=function(w,y){var e=this;function t(h){w.writable&&w.write(h)===!1&&e.pause&&e.pause()}function n(){e.readable&&e.resume&&e.resume()}e.on("data",t),w.on("drain",n),w._isStdio||y&&y.end===!1||(e.on("end",r),e.on("close",g));var o=!1;function r(){o||(o=!0,w.end())}function g(){o||(o=!0,typeof w.destroy=="function"&&w.destroy())}function c(h){if(a(),d.listenerCount(this,"error")===0)throw h}function a(){e.removeListener("data",t),w.removeListener("drain",n),e.removeListener("end",r),e.removeListener("close",g),e.removeListener("error",c),w.removeListener("error",c),e.removeListener("end",a),e.removeListener("close",a),w.removeListener("close",a)}return e.on("error",c),w.on("error",c),e.on("end",a),e.on("close",a),w.on("close",a),w.emit("pipe",e),w}},{events:84,inherits:231,"readable-stream/lib/_stream_duplex.js":288,"readable-stream/lib/_stream_passthrough.js":289,"readable-stream/lib/_stream_readable.js":290,"readable-stream/lib/_stream_transform.js":291,"readable-stream/lib/_stream_writable.js":292,"readable-stream/lib/internal/streams/end-of-stream.js":296,"readable-stream/lib/internal/streams/pipeline.js":298}],287:[function(m,G,Y){var d={};function v(y,e,t){t||(t=Error);var n=function(o){var r,g;function c(a,h,l){return o.call(this,function(s,p,u){return typeof e=="string"?e:e(s,p,u)}(a,h,l))||this}return g=o,(r=c).prototype=Object.create(g.prototype),r.prototype.constructor=r,r.__proto__=g,c}(t);n.prototype.name=t.name,n.prototype.code=y,d[y]=n}function w(y,e){if(Array.isArray(y)){var t=y.length;return y=y.map(function(n){return String(n)}),t>2?"one of ".concat(e," ").concat(y.slice(0,t-1).join(", "),", or ")+y[t-1]:t===2?"one of ".concat(e," ").concat(y[0]," or ").concat(y[1]):"of ".concat(e," ").concat(y[0])}return"of ".concat(e," ").concat(String(y))}v("ERR_INVALID_OPT_VALUE",function(y,e){return'The value "'+e+'" is invalid for option "'+y+'"'},TypeError),v("ERR_INVALID_ARG_TYPE",function(y,e,t){var n,o,r;if(typeof e=="string"&&(o="not ",e.substr(0,o.length)===o)?(n="must not be",e=e.replace(/^not /,"")):n="must be",function(c,a,h){return(h===void 0||h>c.length)&&(h=c.length),c.substring(h-a.length,h)===a}(y," argument"))r="The ".concat(y," ").concat(n," ").concat(w(e,"type"));else{var g=function(c,a,h){return typeof h!="number"&&(h=0),!(h+a.length>c.length)&&c.indexOf(a,h)!==-1}(y,".")?"property":"argument";r='The "'.concat(y,'" ').concat(g," ").concat(n," ").concat(w(e,"type"))}return r+=". Received type ".concat(typeof t)},TypeError),v("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),v("ERR_METHOD_NOT_IMPLEMENTED",function(y){return"The "+y+" method is not implemented"}),v("ERR_STREAM_PREMATURE_CLOSE","Premature close"),v("ERR_STREAM_DESTROYED",function(y){return"Cannot call "+y+" after a stream was destroyed"}),v("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),v("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),v("ERR_STREAM_WRITE_AFTER_END","write after end"),v("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),v("ERR_UNKNOWN_ENCODING",function(y){return"Unknown encoding: "+y},TypeError),v("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),G.exports.codes=d},{}],288:[function(m,G,Y){(function(d){(function(){var v=Object.keys||function(c){var a=[];for(var h in c)a.push(h);return a};G.exports=o;var w=m("./_stream_readable"),y=m("./_stream_writable");m("inherits")(o,w);for(var e=v(y.prototype),t=0;t<e.length;t++){var n=e[t];o.prototype[n]||(o.prototype[n]=y.prototype[n])}function o(c){if(!(this instanceof o))return new o(c);w.call(this,c),y.call(this,c),this.allowHalfOpen=!0,c&&(c.readable===!1&&(this.readable=!1),c.writable===!1&&(this.writable=!1),c.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",r)))}function r(){this._writableState.ended||d.nextTick(g,this)}function g(c){c.end()}Object.defineProperty(o.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(o.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(o.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(o.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(c){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=c,this._writableState.destroyed=c)}})}).call(this)}).call(this,m("_process"))},{"./_stream_readable":290,"./_stream_writable":292,_process:278,inherits:231}],289:[function(m,G,Y){G.exports=v;var d=m("./_stream_transform");function v(w){if(!(this instanceof v))return new v(w);d.call(this,w)}m("inherits")(v,d),v.prototype._transform=function(w,y,e){e(null,w)}},{"./_stream_transform":291,inherits:231}],290:[function(m,G,Y){(function(d,v){(function(){var w;G.exports=k,k.ReadableState=T,m("events").EventEmitter;var y=function(H,N){return H.listeners(N).length},e=m("./internal/streams/stream"),t=m("buffer").Buffer,n=v.Uint8Array||function(){},o,r=m("util");o=r&&r.debuglog?r.debuglog("stream"):function(){};var g,c,a,h=m("./internal/streams/buffer_list"),l=m("./internal/streams/destroy"),s=m("./internal/streams/state").getHighWaterMark,p=m("../errors").codes,u=p.ERR_INVALID_ARG_TYPE,i=p.ERR_STREAM_PUSH_AFTER_EOF,x=p.ERR_METHOD_NOT_IMPLEMENTED,f=p.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;m("inherits")(k,e);var _=l.errorOrDestroy,b=["error","close","destroy","pause","resume"];function T(H,N,U){w=w||m("./_stream_duplex"),H=H||{},typeof U!="boolean"&&(U=N instanceof w),this.objectMode=!!H.objectMode,U&&(this.objectMode=this.objectMode||!!H.readableObjectMode),this.highWaterMark=s(this,H,"readableHighWaterMark",U),this.buffer=new h,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=H.emitClose!==!1,this.autoDestroy=!!H.autoDestroy,this.destroyed=!1,this.defaultEncoding=H.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,H.encoding&&(g||(g=m("string_decoder/").StringDecoder),this.decoder=new g(H.encoding),this.encoding=H.encoding)}function k(H){if(w=w||m("./_stream_duplex"),!(this instanceof k))return new k(H);var N=this instanceof w;this._readableState=new T(H,this,N),this.readable=!0,H&&(typeof H.read=="function"&&(this._read=H.read),typeof H.destroy=="function"&&(this._destroy=H.destroy)),e.call(this)}function L(H,N,U,te,B){o("readableAddChunk",N);var K,J=H._readableState;if(N===null)J.reading=!1,function(ee,ne){if(o("onEofChunk"),!ne.ended){if(ne.decoder){var se=ne.decoder.end();se&&se.length&&(ne.buffer.push(se),ne.length+=ne.objectMode?1:se.length)}ne.ended=!0,ne.sync?P(ee):(ne.needReadable=!1,ne.emittedReadable||(ne.emittedReadable=!0,S(ee)))}}(H,J);else if(B||(K=function(ee,ne){var se;oe=ne,t.isBuffer(oe)||oe instanceof n||typeof ne=="string"||ne===void 0||ee.objectMode||(se=new u("chunk",["string","Buffer","Uint8Array"],ne));var oe;return se}(J,N)),K)_(H,K);else if(J.objectMode||N&&N.length>0)if(typeof N=="string"||J.objectMode||Object.getPrototypeOf(N)===t.prototype||(N=function(ee){return t.from(ee)}(N)),te)J.endEmitted?_(H,new f):A(H,J,N,!0);else if(J.ended)_(H,new i);else{if(J.destroyed)return!1;J.reading=!1,J.decoder&&!U?(N=J.decoder.write(N),J.objectMode||N.length!==0?A(H,J,N,!1):E(H,J)):A(H,J,N,!1)}else te||(J.reading=!1,E(H,J));return!J.ended&&(J.length<J.highWaterMark||J.length===0)}function A(H,N,U,te){N.flowing&&N.length===0&&!N.sync?(N.awaitDrain=0,H.emit("data",U)):(N.length+=N.objectMode?1:U.length,te?N.buffer.unshift(U):N.buffer.push(U),N.needReadable&&P(H)),E(H,N)}Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(H){this._readableState&&(this._readableState.destroyed=H)}}),k.prototype.destroy=l.destroy,k.prototype._undestroy=l.undestroy,k.prototype._destroy=function(H,N){N(H)},k.prototype.push=function(H,N){var U,te=this._readableState;return te.objectMode?U=!0:typeof H=="string"&&((N=N||te.defaultEncoding)!==te.encoding&&(H=t.from(H,N),N=""),U=!0),L(this,H,N,!1,U)},k.prototype.unshift=function(H){return L(this,H,null,!0,!1)},k.prototype.isPaused=function(){return this._readableState.flowing===!1},k.prototype.setEncoding=function(H){g||(g=m("string_decoder/").StringDecoder);var N=new g(H);this._readableState.decoder=N,this._readableState.encoding=this._readableState.decoder.encoding;for(var U=this._readableState.buffer.head,te="";U!==null;)te+=N.write(U.data),U=U.next;return this._readableState.buffer.clear(),te!==""&&this._readableState.buffer.push(te),this._readableState.length=te.length,this};function I(H,N){return H<=0||N.length===0&&N.ended?0:N.objectMode?1:H!=H?N.flowing&&N.length?N.buffer.head.data.length:N.length:(H>N.highWaterMark&&(N.highWaterMark=function(U){return U>=1073741824?U=1073741824:(U--,U|=U>>>1,U|=U>>>2,U|=U>>>4,U|=U>>>8,U|=U>>>16,U++),U}(H)),H<=N.length?H:N.ended?N.length:(N.needReadable=!0,0))}function P(H){var N=H._readableState;o("emitReadable",N.needReadable,N.emittedReadable),N.needReadable=!1,N.emittedReadable||(o("emitReadable",N.flowing),N.emittedReadable=!0,d.nextTick(S,H))}function S(H){var N=H._readableState;o("emitReadable_",N.destroyed,N.length,N.ended),N.destroyed||!N.length&&!N.ended||(H.emit("readable"),N.emittedReadable=!1),N.needReadable=!N.flowing&&!N.ended&&N.length<=N.highWaterMark,Z(H)}function E(H,N){N.readingMore||(N.readingMore=!0,d.nextTick(z,H,N))}function z(H,N){for(;!N.reading&&!N.ended&&(N.length<N.highWaterMark||N.flowing&&N.length===0);){var U=N.length;if(o("maybeReadMore read 0"),H.read(0),U===N.length)break}N.readingMore=!1}function D(H){var N=H._readableState;N.readableListening=H.listenerCount("readable")>0,N.resumeScheduled&&!N.paused?N.flowing=!0:H.listenerCount("data")>0&&H.resume()}function j(H){o("readable nexttick read 0"),H.read(0)}function V(H,N){o("resume",N.reading),N.reading||H.read(0),N.resumeScheduled=!1,H.emit("resume"),Z(H),N.flowing&&!N.reading&&H.read(0)}function Z(H){var N=H._readableState;for(o("flow",N.flowing);N.flowing&&H.read()!==null;);}function Q(H,N){return N.length===0?null:(N.objectMode?U=N.buffer.shift():!H||H>=N.length?(U=N.decoder?N.buffer.join(""):N.buffer.length===1?N.buffer.first():N.buffer.concat(N.length),N.buffer.clear()):U=N.buffer.consume(H,N.decoder),U);var U}function X(H){var N=H._readableState;o("endReadable",N.endEmitted),N.endEmitted||(N.ended=!0,d.nextTick($,N,H))}function $(H,N){if(o("endReadableNT",H.endEmitted,H.length),!H.endEmitted&&H.length===0&&(H.endEmitted=!0,N.readable=!1,N.emit("end"),H.autoDestroy)){var U=N._writableState;(!U||U.autoDestroy&&U.finished)&&N.destroy()}}function re(H,N){for(var U=0,te=H.length;U<te;U++)if(H[U]===N)return U;return-1}k.prototype.read=function(H){o("read",H),H=parseInt(H,10);var N=this._readableState,U=H;if(H!==0&&(N.emittedReadable=!1),H===0&&N.needReadable&&((N.highWaterMark!==0?N.length>=N.highWaterMark:N.length>0)||N.ended))return o("read: emitReadable",N.length,N.ended),N.length===0&&N.ended?X(this):P(this),null;if((H=I(H,N))===0&&N.ended)return N.length===0&&X(this),null;var te,B=N.needReadable;return o("need readable",B),(N.length===0||N.length-H<N.highWaterMark)&&o("length less than watermark",B=!0),N.ended||N.reading?o("reading or ended",B=!1):B&&(o("do read"),N.reading=!0,N.sync=!0,N.length===0&&(N.needReadable=!0),this._read(N.highWaterMark),N.sync=!1,N.reading||(H=I(U,N))),(te=H>0?Q(H,N):null)===null?(N.needReadable=N.length<=N.highWaterMark,H=0):(N.length-=H,N.awaitDrain=0),N.length===0&&(N.ended||(N.needReadable=!0),U!==H&&N.ended&&X(this)),te!==null&&this.emit("data",te),te},k.prototype._read=function(H){_(this,new x("_read()"))},k.prototype.pipe=function(H,N){var U=this,te=this._readableState;switch(te.pipesCount){case 0:te.pipes=H;break;case 1:te.pipes=[te.pipes,H];break;default:te.pipes.push(H)}te.pipesCount+=1,o("pipe count=%d opts=%j",te.pipesCount,N);var B=(!N||N.end!==!1)&&H!==d.stdout&&H!==d.stderr?J:ye;function K(Se,fe){o("onunpipe"),Se===U&&fe&&fe.hasUnpiped===!1&&(fe.hasUnpiped=!0,o("cleanup"),H.removeListener("close",me),H.removeListener("finish",ce),H.removeListener("drain",ee),H.removeListener("error",oe),H.removeListener("unpipe",K),U.removeListener("end",J),U.removeListener("end",ye),U.removeListener("data",se),ne=!0,!te.awaitDrain||H._writableState&&!H._writableState.needDrain||ee())}function J(){o("onend"),H.end()}te.endEmitted?d.nextTick(B):U.once("end",B),H.on("unpipe",K);var ee=function(Se){return function(){var fe=Se._readableState;o("pipeOnDrain",fe.awaitDrain),fe.awaitDrain&&fe.awaitDrain--,fe.awaitDrain===0&&y(Se,"data")&&(fe.flowing=!0,Z(Se))}}(U);H.on("drain",ee);var ne=!1;function se(Se){o("ondata");var fe=H.write(Se);o("dest.write",fe),fe===!1&&((te.pipesCount===1&&te.pipes===H||te.pipesCount>1&&re(te.pipes,H)!==-1)&&!ne&&(o("false write response, pause",te.awaitDrain),te.awaitDrain++),U.pause())}function oe(Se){o("onerror",Se),ye(),H.removeListener("error",oe),y(H,"error")===0&&_(H,Se)}function me(){H.removeListener("finish",ce),ye()}function ce(){o("onfinish"),H.removeListener("close",me),ye()}function ye(){o("unpipe"),U.unpipe(H)}return U.on("data",se),function(Se,fe,ge){if(typeof Se.prependListener=="function")return Se.prependListener(fe,ge);Se._events&&Se._events[fe]?Array.isArray(Se._events[fe])?Se._events[fe].unshift(ge):Se._events[fe]=[ge,Se._events[fe]]:Se.on(fe,ge)}(H,"error",oe),H.once("close",me),H.once("finish",ce),H.emit("pipe",U),te.flowing||(o("pipe resume"),U.resume()),H},k.prototype.unpipe=function(H){var N=this._readableState,U={hasUnpiped:!1};if(N.pipesCount===0)return this;if(N.pipesCount===1)return H&&H!==N.pipes||(H||(H=N.pipes),N.pipes=null,N.pipesCount=0,N.flowing=!1,H&&H.emit("unpipe",this,U)),this;if(!H){var te=N.pipes,B=N.pipesCount;N.pipes=null,N.pipesCount=0,N.flowing=!1;for(var K=0;K<B;K++)te[K].emit("unpipe",this,{hasUnpiped:!1});return this}var J=re(N.pipes,H);return J===-1||(N.pipes.splice(J,1),N.pipesCount-=1,N.pipesCount===1&&(N.pipes=N.pipes[0]),H.emit("unpipe",this,U)),this},k.prototype.on=function(H,N){var U=e.prototype.on.call(this,H,N),te=this._readableState;return H==="data"?(te.readableListening=this.listenerCount("readable")>0,te.flowing!==!1&&this.resume()):H==="readable"&&(te.endEmitted||te.readableListening||(te.readableListening=te.needReadable=!0,te.flowing=!1,te.emittedReadable=!1,o("on readable",te.length,te.reading),te.length?P(this):te.reading||d.nextTick(j,this))),U},k.prototype.addListener=k.prototype.on,k.prototype.removeListener=function(H,N){var U=e.prototype.removeListener.call(this,H,N);return H==="readable"&&d.nextTick(D,this),U},k.prototype.removeAllListeners=function(H){var N=e.prototype.removeAllListeners.apply(this,arguments);return H!=="readable"&&H!==void 0||d.nextTick(D,this),N},k.prototype.resume=function(){var H=this._readableState;return H.flowing||(o("resume"),H.flowing=!H.readableListening,function(N,U){U.resumeScheduled||(U.resumeScheduled=!0,d.nextTick(V,N,U))}(this,H)),H.paused=!1,this},k.prototype.pause=function(){return o("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(o("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},k.prototype.wrap=function(H){var N=this,U=this._readableState,te=!1;for(var B in H.on("end",function(){if(o("wrapped end"),U.decoder&&!U.ended){var J=U.decoder.end();J&&J.length&&N.push(J)}N.push(null)}),H.on("data",function(J){o("wrapped data"),U.decoder&&(J=U.decoder.write(J)),U.objectMode&&J==null||(U.objectMode||J&&J.length)&&(N.push(J)||(te=!0,H.pause()))}),H)this[B]===void 0&&typeof H[B]=="function"&&(this[B]=function(J){return function(){return H[J].apply(H,arguments)}}(B));for(var K=0;K<b.length;K++)H.on(b[K],this.emit.bind(this,b[K]));return this._read=function(J){o("wrapped _read",J),te&&(te=!1,H.resume())},this},typeof Symbol=="function"&&(k.prototype[Symbol.asyncIterator]=function(){return c===void 0&&(c=m("./internal/streams/async_iterator")),c(this)}),Object.defineProperty(k.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(k.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(k.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(H){this._readableState&&(this._readableState.flowing=H)}}),k._fromList=Q,Object.defineProperty(k.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(k.from=function(H,N){return a===void 0&&(a=m("./internal/streams/from")),a(k,H,N)})}).call(this)}).call(this,m("_process"),typeof Ka<"u"?Ka:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":287,"./_stream_duplex":288,"./internal/streams/async_iterator":293,"./internal/streams/buffer_list":294,"./internal/streams/destroy":295,"./internal/streams/from":297,"./internal/streams/state":299,"./internal/streams/stream":300,_process:278,buffer:85,events:84,inherits:231,"string_decoder/":301,util:83}],291:[function(m,G,Y){G.exports=o;var d=m("../errors").codes,v=d.ERR_METHOD_NOT_IMPLEMENTED,w=d.ERR_MULTIPLE_CALLBACK,y=d.ERR_TRANSFORM_ALREADY_TRANSFORMING,e=d.ERR_TRANSFORM_WITH_LENGTH_0,t=m("./_stream_duplex");function n(c,a){var h=this._transformState;h.transforming=!1;var l=h.writecb;if(l===null)return this.emit("error",new w);h.writechunk=null,h.writecb=null,a!=null&&this.push(a),l(c);var s=this._readableState;s.reading=!1,(s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}function o(c){if(!(this instanceof o))return new o(c);t.call(this,c),this._transformState={afterTransform:n.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,c&&(typeof c.transform=="function"&&(this._transform=c.transform),typeof c.flush=="function"&&(this._flush=c.flush)),this.on("prefinish",r)}function r(){var c=this;typeof this._flush!="function"||this._readableState.destroyed?g(this,null,null):this._flush(function(a,h){g(c,a,h)})}function g(c,a,h){if(a)return c.emit("error",a);if(h!=null&&c.push(h),c._writableState.length)throw new e;if(c._transformState.transforming)throw new y;return c.push(null)}m("inherits")(o,t),o.prototype.push=function(c,a){return this._transformState.needTransform=!1,t.prototype.push.call(this,c,a)},o.prototype._transform=function(c,a,h){h(new v("_transform()"))},o.prototype._write=function(c,a,h){var l=this._transformState;if(l.writecb=h,l.writechunk=c,l.writeencoding=a,!l.transforming){var s=this._readableState;(l.needTransform||s.needReadable||s.length<s.highWaterMark)&&this._read(s.highWaterMark)}},o.prototype._read=function(c){var a=this._transformState;a.writechunk===null||a.transforming?a.needTransform=!0:(a.transforming=!0,this._transform(a.writechunk,a.writeencoding,a.afterTransform))},o.prototype._destroy=function(c,a){t.prototype._destroy.call(this,c,function(h){a(h)})}},{"../errors":287,"./_stream_duplex":288,inherits:231}],292:[function(m,G,Y){(function(d,v){(function(){function w(z){var D=this;this.next=null,this.entry=null,this.finish=function(){(function(j,V,Z){var Q=j.entry;for(j.entry=null;Q;){var X=Q.callback;V.pendingcb--,X(Z),Q=Q.next}V.corkedRequestsFree.next=j})(D,z)}}var y;G.exports=k,k.WritableState=T;var e={deprecate:m("util-deprecate")},t=m("./internal/streams/stream"),n=m("buffer").Buffer,o=v.Uint8Array||function(){},r,g=m("./internal/streams/destroy"),c=m("./internal/streams/state").getHighWaterMark,a=m("../errors").codes,h=a.ERR_INVALID_ARG_TYPE,l=a.ERR_METHOD_NOT_IMPLEMENTED,s=a.ERR_MULTIPLE_CALLBACK,p=a.ERR_STREAM_CANNOT_PIPE,u=a.ERR_STREAM_DESTROYED,i=a.ERR_STREAM_NULL_VALUES,x=a.ERR_STREAM_WRITE_AFTER_END,f=a.ERR_UNKNOWN_ENCODING,_=g.errorOrDestroy;function b(){}function T(z,D,j){y=y||m("./_stream_duplex"),z=z||{},typeof j!="boolean"&&(j=D instanceof y),this.objectMode=!!z.objectMode,j&&(this.objectMode=this.objectMode||!!z.writableObjectMode),this.highWaterMark=c(this,z,"writableHighWaterMark",j),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var V=z.decodeStrings===!1;this.decodeStrings=!V,this.defaultEncoding=z.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Z){(function(Q,X){var $=Q._writableState,re=$.sync,H=$.writecb;if(typeof H!="function")throw new s;if(function(U){U.writing=!1,U.writecb=null,U.length-=U.writelen,U.writelen=0}($),X)(function(U,te,B,K,J){--te.pendingcb,B?(d.nextTick(J,K),d.nextTick(E,U,te),U._writableState.errorEmitted=!0,_(U,K)):(J(K),U._writableState.errorEmitted=!0,_(U,K),E(U,te))})(Q,$,re,X,H);else{var N=P($)||Q.destroyed;N||$.corked||$.bufferProcessing||!$.bufferedRequest||I(Q,$),re?d.nextTick(A,Q,$,N,H):A(Q,$,N,H)}})(D,Z)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=z.emitClose!==!1,this.autoDestroy=!!z.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new w(this)}function k(z){var D=this instanceof(y=y||m("./_stream_duplex"));if(!D&&!r.call(k,this))return new k(z);this._writableState=new T(z,this,D),this.writable=!0,z&&(typeof z.write=="function"&&(this._write=z.write),typeof z.writev=="function"&&(this._writev=z.writev),typeof z.destroy=="function"&&(this._destroy=z.destroy),typeof z.final=="function"&&(this._final=z.final)),t.call(this)}function L(z,D,j,V,Z,Q,X){D.writelen=V,D.writecb=X,D.writing=!0,D.sync=!0,D.destroyed?D.onwrite(new u("write")):j?z._writev(Z,D.onwrite):z._write(Z,Q,D.onwrite),D.sync=!1}function A(z,D,j,V){j||function(Z,Q){Q.length===0&&Q.needDrain&&(Q.needDrain=!1,Z.emit("drain"))}(z,D),D.pendingcb--,V(),E(z,D)}function I(z,D){D.bufferProcessing=!0;var j=D.bufferedRequest;if(z._writev&&j&&j.next){var V=D.bufferedRequestCount,Z=new Array(V),Q=D.corkedRequestsFree;Q.entry=j;for(var X=0,$=!0;j;)Z[X]=j,j.isBuf||($=!1),j=j.next,X+=1;Z.allBuffers=$,L(z,D,!0,D.length,Z,"",Q.finish),D.pendingcb++,D.lastBufferedRequest=null,Q.next?(D.corkedRequestsFree=Q.next,Q.next=null):D.corkedRequestsFree=new w(D),D.bufferedRequestCount=0}else{for(;j;){var re=j.chunk,H=j.encoding,N=j.callback;if(L(z,D,!1,D.objectMode?1:re.length,re,H,N),j=j.next,D.bufferedRequestCount--,D.writing)break}j===null&&(D.lastBufferedRequest=null)}D.bufferedRequest=j,D.bufferProcessing=!1}function P(z){return z.ending&&z.length===0&&z.bufferedRequest===null&&!z.finished&&!z.writing}function S(z,D){z._final(function(j){D.pendingcb--,j&&_(z,j),D.prefinished=!0,z.emit("prefinish"),E(z,D)})}function E(z,D){var j=P(D);if(j&&(function(Z,Q){Q.prefinished||Q.finalCalled||(typeof Z._final!="function"||Q.destroyed?(Q.prefinished=!0,Z.emit("prefinish")):(Q.pendingcb++,Q.finalCalled=!0,d.nextTick(S,Z,Q)))}(z,D),D.pendingcb===0&&(D.finished=!0,z.emit("finish"),D.autoDestroy))){var V=z._readableState;(!V||V.autoDestroy&&V.endEmitted)&&z.destroy()}return j}m("inherits")(k,t),T.prototype.getBuffer=function(){for(var z=this.bufferedRequest,D=[];z;)D.push(z),z=z.next;return D},function(){try{Object.defineProperty(T.prototype,"buffer",{get:e.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(r=Function.prototype[Symbol.hasInstance],Object.defineProperty(k,Symbol.hasInstance,{value:function(z){return!!r.call(this,z)||this===k&&z&&z._writableState instanceof T}})):r=function(z){return z instanceof this},k.prototype.pipe=function(){_(this,new p)},k.prototype.write=function(z,D,j){var V,Z=this._writableState,Q=!1,X=!Z.objectMode&&(V=z,n.isBuffer(V)||V instanceof o);return X&&!n.isBuffer(z)&&(z=function($){return n.from($)}(z)),typeof D=="function"&&(j=D,D=null),X?D="buffer":D||(D=Z.defaultEncoding),typeof j!="function"&&(j=b),Z.ending?function($,re){var H=new x;_($,H),d.nextTick(re,H)}(this,j):(X||function($,re,H,N){var U;return H===null?U=new i:typeof H=="string"||re.objectMode||(U=new h("chunk",["string","Buffer"],H)),!U||(_($,U),d.nextTick(N,U),!1)}(this,Z,z,j))&&(Z.pendingcb++,Q=function($,re,H,N,U,te){if(!H){var B=function(ne,se,oe){return ne.objectMode||ne.decodeStrings===!1||typeof se!="string"||(se=n.from(se,oe)),se}(re,N,U);N!==B&&(H=!0,U="buffer",N=B)}var K=re.objectMode?1:N.length;re.length+=K;var J=re.length<re.highWaterMark;if(J||(re.needDrain=!0),re.writing||re.corked){var ee=re.lastBufferedRequest;re.lastBufferedRequest={chunk:N,encoding:U,isBuf:H,callback:te,next:null},ee?ee.next=re.lastBufferedRequest:re.bufferedRequest=re.lastBufferedRequest,re.bufferedRequestCount+=1}else L($,re,!1,K,N,U,te);return J}(this,Z,X,z,D,j)),Q},k.prototype.cork=function(){this._writableState.corked++},k.prototype.uncork=function(){var z=this._writableState;z.corked&&(z.corked--,z.writing||z.corked||z.bufferProcessing||!z.bufferedRequest||I(this,z))},k.prototype.setDefaultEncoding=function(z){if(typeof z=="string"&&(z=z.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((z+"").toLowerCase())>-1))throw new f(z);return this._writableState.defaultEncoding=z,this},Object.defineProperty(k.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(k.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),k.prototype._write=function(z,D,j){j(new l("_write()"))},k.prototype._writev=null,k.prototype.end=function(z,D,j){var V=this._writableState;return typeof z=="function"?(j=z,z=null,D=null):typeof D=="function"&&(j=D,D=null),z!=null&&this.write(z,D),V.corked&&(V.corked=1,this.uncork()),V.ending||function(Z,Q,X){Q.ending=!0,E(Z,Q),X&&(Q.finished?d.nextTick(X):Z.once("finish",X)),Q.ended=!0,Z.writable=!1}(this,V,j),this},Object.defineProperty(k.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(z){this._writableState&&(this._writableState.destroyed=z)}}),k.prototype.destroy=g.destroy,k.prototype._undestroy=g.undestroy,k.prototype._destroy=function(z,D){D(z)}}).call(this)}).call(this,m("_process"),typeof Ka<"u"?Ka:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":287,"./_stream_duplex":288,"./internal/streams/destroy":295,"./internal/streams/state":299,"./internal/streams/stream":300,_process:278,buffer:85,inherits:231,"util-deprecate":331}],293:[function(m,G,Y){(function(d){(function(){var v;function w(u,i,x){return i in u?Object.defineProperty(u,i,{value:x,enumerable:!0,configurable:!0,writable:!0}):u[i]=x,u}var y=m("./end-of-stream"),e=Symbol("lastResolve"),t=Symbol("lastReject"),n=Symbol("error"),o=Symbol("ended"),r=Symbol("lastPromise"),g=Symbol("handlePromise"),c=Symbol("stream");function a(u,i){return{value:u,done:i}}function h(u){var i=u[e];if(i!==null){var x=u[c].read();x!==null&&(u[r]=null,u[e]=null,u[t]=null,i(a(x,!1)))}}function l(u){d.nextTick(h,u)}var s=Object.getPrototypeOf(function(){}),p=Object.setPrototypeOf((w(v={get stream(){return this[c]},next:function(){var u=this,i=this[n];if(i!==null)return Promise.reject(i);if(this[o])return Promise.resolve(a(void 0,!0));if(this[c].destroyed)return new Promise(function(b,T){d.nextTick(function(){u[n]?T(u[n]):b(a(void 0,!0))})});var x,f=this[r];if(f)x=new Promise(function(b,T){return function(k,L){b.then(function(){T[o]?k(a(void 0,!0)):T[g](k,L)},L)}}(f,this));else{var _=this[c].read();if(_!==null)return Promise.resolve(a(_,!1));x=new Promise(this[g])}return this[r]=x,x}},Symbol.asyncIterator,function(){return this}),w(v,"return",function(){var u=this;return new Promise(function(i,x){u[c].destroy(null,function(f){f?x(f):i(a(void 0,!0))})})}),v),s);G.exports=function(u){var i,x=Object.create(p,(w(i={},c,{value:u,writable:!0}),w(i,e,{value:null,writable:!0}),w(i,t,{value:null,writable:!0}),w(i,n,{value:null,writable:!0}),w(i,o,{value:u._readableState.endEmitted,writable:!0}),w(i,g,{value:function(f,_){var b=x[c].read();b?(x[r]=null,x[e]=null,x[t]=null,f(a(b,!1))):(x[e]=f,x[t]=_)},writable:!0}),i));return x[r]=null,y(u,function(f){if(f&&f.code!=="ERR_STREAM_PREMATURE_CLOSE"){var _=x[t];return _!==null&&(x[r]=null,x[e]=null,x[t]=null,_(f)),void(x[n]=f)}var b=x[e];b!==null&&(x[r]=null,x[e]=null,x[t]=null,b(a(void 0,!0))),x[o]=!0}),u.on("readable",l.bind(null,x)),x}}).call(this)}).call(this,m("_process"))},{"./end-of-stream":296,_process:278}],294:[function(m,G,Y){function d(n,o){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(n);o&&(g=g.filter(function(c){return Object.getOwnPropertyDescriptor(n,c).enumerable})),r.push.apply(r,g)}return r}function v(n,o,r){return o in n?Object.defineProperty(n,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[o]=r,n}function w(n,o){for(var r=0;r<o.length;r++){var g=o[r];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(n,g.key,g)}}var y=m("buffer").Buffer,e=m("util").inspect,t=e&&e.custom||"inspect";G.exports=function(){function n(){(function(g,c){if(!(g instanceof c))throw new TypeError("Cannot call a class as a function")})(this,n),this.head=null,this.tail=null,this.length=0}var o,r;return o=n,(r=[{key:"push",value:function(g){var c={data:g,next:null};this.length>0?this.tail.next=c:this.head=c,this.tail=c,++this.length}},{key:"unshift",value:function(g){var c={data:g,next:this.head};this.length===0&&(this.tail=c),this.head=c,++this.length}},{key:"shift",value:function(){if(this.length!==0){var g=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,g}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(g){if(this.length===0)return"";for(var c=this.head,a=""+c.data;c=c.next;)a+=g+c.data;return a}},{key:"concat",value:function(g){if(this.length===0)return y.alloc(0);for(var c,a,h,l=y.allocUnsafe(g>>>0),s=this.head,p=0;s;)c=s.data,a=l,h=p,y.prototype.copy.call(c,a,h),p+=s.data.length,s=s.next;return l}},{key:"consume",value:function(g,c){var a;return g<this.head.data.length?(a=this.head.data.slice(0,g),this.head.data=this.head.data.slice(g)):a=g===this.head.data.length?this.shift():c?this._getString(g):this._getBuffer(g),a}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(g){var c=this.head,a=1,h=c.data;for(g-=h.length;c=c.next;){var l=c.data,s=g>l.length?l.length:g;if(s===l.length?h+=l:h+=l.slice(0,g),(g-=s)==0){s===l.length?(++a,c.next?this.head=c.next:this.head=this.tail=null):(this.head=c,c.data=l.slice(s));break}++a}return this.length-=a,h}},{key:"_getBuffer",value:function(g){var c=y.allocUnsafe(g),a=this.head,h=1;for(a.data.copy(c),g-=a.data.length;a=a.next;){var l=a.data,s=g>l.length?l.length:g;if(l.copy(c,c.length-g,0,s),(g-=s)==0){s===l.length?(++h,a.next?this.head=a.next:this.head=this.tail=null):(this.head=a,a.data=l.slice(s));break}++h}return this.length-=h,c}},{key:t,value:function(g,c){return e(this,function(a){for(var h=1;h<arguments.length;h++){var l=arguments[h]!=null?arguments[h]:{};h%2?d(Object(l),!0).forEach(function(s){v(a,s,l[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(l)):d(Object(l)).forEach(function(s){Object.defineProperty(a,s,Object.getOwnPropertyDescriptor(l,s))})}return a}({},c,{depth:0,customInspect:!1}))}}])&&w(o.prototype,r),n}()},{buffer:85,util:83}],295:[function(m,G,Y){(function(d){(function(){function v(e,t){y(e,t),w(e)}function w(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function y(e,t){e.emit("error",t)}G.exports={destroy:function(e,t){var n=this,o=this._readableState&&this._readableState.destroyed,r=this._writableState&&this._writableState.destroyed;return o||r?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,d.nextTick(y,this,e)):d.nextTick(y,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(g){!t&&g?n._writableState?n._writableState.errorEmitted?d.nextTick(w,n):(n._writableState.errorEmitted=!0,d.nextTick(v,n,g)):d.nextTick(v,n,g):t?(d.nextTick(w,n),t(g)):d.nextTick(w,n)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,o=e._writableState;n&&n.autoDestroy||o&&o.autoDestroy?e.destroy(t):e.emit("error",t)}}}).call(this)}).call(this,m("_process"))},{_process:278}],296:[function(m,G,Y){var d=m("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function v(){}G.exports=function w(y,e,t){if(typeof e=="function")return w(y,null,e);e||(e={}),t=function(u){var i=!1;return function(){if(!i){i=!0;for(var x=arguments.length,f=new Array(x),_=0;_<x;_++)f[_]=arguments[_];u.apply(this,f)}}}(t||v);var n=e.readable||e.readable!==!1&&y.readable,o=e.writable||e.writable!==!1&&y.writable,r=function(){y.writable||c()},g=y._writableState&&y._writableState.finished,c=function(){o=!1,g=!0,n||t.call(y)},a=y._readableState&&y._readableState.endEmitted,h=function(){n=!1,a=!0,o||t.call(y)},l=function(u){t.call(y,u)},s=function(){var u;return n&&!a?(y._readableState&&y._readableState.ended||(u=new d),t.call(y,u)):o&&!g?(y._writableState&&y._writableState.ended||(u=new d),t.call(y,u)):void 0},p=function(){y.req.on("finish",c)};return function(u){return u.setHeader&&typeof u.abort=="function"}(y)?(y.on("complete",c),y.on("abort",s),y.req?p():y.on("request",p)):o&&!y._writableState&&(y.on("end",r),y.on("close",r)),y.on("end",h),y.on("finish",c),e.error!==!1&&y.on("error",l),y.on("close",s),function(){y.removeListener("complete",c),y.removeListener("abort",s),y.removeListener("request",p),y.req&&y.req.removeListener("finish",c),y.removeListener("end",r),y.removeListener("close",r),y.removeListener("finish",c),y.removeListener("end",h),y.removeListener("error",l),y.removeListener("close",s)}}},{"../../../errors":287}],297:[function(m,G,Y){G.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],298:[function(m,G,Y){var d,v=m("../../../errors").codes,w=v.ERR_MISSING_ARGS,y=v.ERR_STREAM_DESTROYED;function e(g){if(g)throw g}function t(g,c,a,h){h=function(p){var u=!1;return function(){u||(u=!0,p.apply(void 0,arguments))}}(h);var l=!1;g.on("close",function(){l=!0}),d===void 0&&(d=m("./end-of-stream")),d(g,{readable:c,writable:a},function(p){if(p)return h(p);l=!0,h()});var s=!1;return function(p){if(!l&&!s)return s=!0,function(u){return u.setHeader&&typeof u.abort=="function"}(g)?g.abort():typeof g.destroy=="function"?g.destroy():void h(p||new y("pipe"))}}function n(g){g()}function o(g,c){return g.pipe(c)}function r(g){return g.length?typeof g[g.length-1]!="function"?e:g.pop():e}G.exports=function(){for(var g=arguments.length,c=new Array(g),a=0;a<g;a++)c[a]=arguments[a];var h,l=r(c);if(Array.isArray(c[0])&&(c=c[0]),c.length<2)throw new w("streams");var s=c.map(function(p,u){var i=u<c.length-1;return t(p,i,u>0,function(x){h||(h=x),x&&s.forEach(n),i||(s.forEach(n),l(h))})});return c.reduce(o)}},{"../../../errors":287,"./end-of-stream":296}],299:[function(m,G,Y){var d=m("../../../errors").codes.ERR_INVALID_OPT_VALUE;G.exports={getHighWaterMark:function(v,w,y,e){var t=function(n,o,r){return n.highWaterMark!=null?n.highWaterMark:o?n[r]:null}(w,e,y);if(t!=null){if(!isFinite(t)||Math.floor(t)!==t||t<0)throw new d(e?y:"highWaterMark",t);return Math.floor(t)}return v.objectMode?16:16384}}},{"../../../errors":287}],300:[function(m,G,Y){G.exports=m("events").EventEmitter},{events:84}],301:[function(m,G,Y){var d=m("safe-buffer").Buffer,v=d.isEncoding||function(a){switch((a=""+a)&&a.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function w(a){var h;switch(this.encoding=function(l){var s=function(p){if(!p)return"utf8";for(var u;;)switch(p){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return p;default:if(u)return;p=(""+p).toLowerCase(),u=!0}}(l);if(typeof s!="string"&&(d.isEncoding===v||!v(l)))throw new Error("Unknown encoding: "+l);return s||l}(a),this.encoding){case"utf16le":this.text=t,this.end=n,h=4;break;case"utf8":this.fillLast=e,h=4;break;case"base64":this.text=o,this.end=r,h=3;break;default:return this.write=g,void(this.end=c)}this.lastNeed=0,this.lastTotal=0,this.lastChar=d.allocUnsafe(h)}function y(a){return a<=127?0:a>>5==6?2:a>>4==14?3:a>>3==30?4:a>>6==2?-1:-2}function e(a){var h=this.lastTotal-this.lastNeed,l=function(s,p,u){if((192&p[0])!=128)return s.lastNeed=0,"\uFFFD";if(s.lastNeed>1&&p.length>1){if((192&p[1])!=128)return s.lastNeed=1,"\uFFFD";if(s.lastNeed>2&&p.length>2&&(192&p[2])!=128)return s.lastNeed=2,"\uFFFD"}}(this,a);return l!==void 0?l:this.lastNeed<=a.length?(a.copy(this.lastChar,h,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(a.copy(this.lastChar,h,0,a.length),void(this.lastNeed-=a.length))}function t(a,h){if((a.length-h)%2==0){var l=a.toString("utf16le",h);if(l){var s=l.charCodeAt(l.length-1);if(s>=55296&&s<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=a[a.length-2],this.lastChar[1]=a[a.length-1],l.slice(0,-1)}return l}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=a[a.length-1],a.toString("utf16le",h,a.length-1)}function n(a){var h=a&&a.length?this.write(a):"";if(this.lastNeed){var l=this.lastTotal-this.lastNeed;return h+this.lastChar.toString("utf16le",0,l)}return h}function o(a,h){var l=(a.length-h)%3;return l===0?a.toString("base64",h):(this.lastNeed=3-l,this.lastTotal=3,l===1?this.lastChar[0]=a[a.length-1]:(this.lastChar[0]=a[a.length-2],this.lastChar[1]=a[a.length-1]),a.toString("base64",h,a.length-l))}function r(a){var h=a&&a.length?this.write(a):"";return this.lastNeed?h+this.lastChar.toString("base64",0,3-this.lastNeed):h}function g(a){return a.toString(this.encoding)}function c(a){return a&&a.length?this.write(a):""}Y.StringDecoder=w,w.prototype.write=function(a){if(a.length===0)return"";var h,l;if(this.lastNeed){if((h=this.fillLast(a))===void 0)return"";l=this.lastNeed,this.lastNeed=0}else l=0;return l<a.length?h?h+this.text(a,l):this.text(a,l):h||""},w.prototype.end=function(a){var h=a&&a.length?this.write(a):"";return this.lastNeed?h+"\uFFFD":h},w.prototype.text=function(a,h){var l=function(p,u,i){var x=u.length-1;if(x<i)return 0;var f=y(u[x]);return f>=0?(f>0&&(p.lastNeed=f-1),f):--x<i||f===-2?0:(f=y(u[x]))>=0?(f>0&&(p.lastNeed=f-2),f):--x<i||f===-2?0:(f=y(u[x]))>=0?(f>0&&(f===2?f=0:p.lastNeed=f-3),f):0}(this,a,h);if(!this.lastNeed)return a.toString("utf8",h);this.lastTotal=l;var s=a.length-(l-this.lastNeed);return a.copy(this.lastChar,0,s),a.toString("utf8",h,s)},w.prototype.fillLast=function(a){if(this.lastNeed<=a.length)return a.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);a.copy(this.lastChar,this.lastTotal-this.lastNeed,0,a.length),this.lastNeed-=a.length}},{"safe-buffer":285}],302:[function(m,G,Y){(function(d,v){(function(){var w=m("assert"),y=m("debug")("stream-parser");G.exports=function(l){var s=l&&typeof l._transform=="function",p=l&&typeof l._write=="function";if(!s&&!p)throw new Error("must pass a Writable or Transform stream in");y("extending Parser into stream"),l._bytes=t,l._skipBytes=n,s&&(l._passthrough=o),s?l._transform=g:l._write=r};function e(l){y("initializing parser stream"),l._parserBytesLeft=0,l._parserBuffers=[],l._parserBuffered=0,l._parserState=-1,l._parserCallback=null,typeof l.push=="function"&&(l._parserOutput=l.push.bind(l)),l._parserInit=!0}function t(l,s){w(!this._parserCallback,'there is already a "callback" set!'),w(isFinite(l)&&l>0,'can only buffer a finite number of bytes > 0, got "'+l+'"'),this._parserInit||e(this),y("buffering %o bytes",l),this._parserBytesLeft=l,this._parserCallback=s,this._parserState=0}function n(l,s){w(!this._parserCallback,'there is already a "callback" set!'),w(l>0,'can only skip > 0 bytes, got "'+l+'"'),this._parserInit||e(this),y("skipping %o bytes",l),this._parserBytesLeft=l,this._parserCallback=s,this._parserState=1}function o(l,s){w(!this._parserCallback,'There is already a "callback" set!'),w(l>0,'can only pass through > 0 bytes, got "'+l+'"'),this._parserInit||e(this),y("passing through %o bytes",l),this._parserBytesLeft=l,this._parserCallback=s,this._parserState=2}function r(l,s,p){this._parserInit||e(this),y("write(%o bytes)",l.length),typeof s=="function"&&(p=s),a(this,l,null,p)}function g(l,s,p){this._parserInit||e(this),y("transform(%o bytes)",l.length),typeof s!="function"&&(s=this._parserOutput),a(this,l,s,p)}function c(l,s,p,u){if(l._parserBytesLeft-=s.length,y("%o bytes left for stream piece",l._parserBytesLeft),l._parserState===0?(l._parserBuffers.push(s),l._parserBuffered+=s.length):l._parserState===2&&p(s),l._parserBytesLeft!==0)return u;var i=l._parserCallback;if(i&&l._parserState===0&&l._parserBuffers.length>1&&(s=v.concat(l._parserBuffers,l._parserBuffered)),l._parserState!==0&&(s=null),l._parserCallback=null,l._parserBuffered=0,l._parserState=-1,l._parserBuffers.splice(0),i){var x=[];s&&x.push(s),p&&x.push(p);var f=i.length>x.length;f&&x.push(h(u));var _=i.apply(l,x);if(!f||u===_)return u}}var a=h(function l(s,p,u,i){return s._parserBytesLeft<=0?i(new Error("got data but not currently parsing anything")):p.length<=s._parserBytesLeft?function(){return c(s,p,u,i)}:function(){var x=p.slice(0,s._parserBytesLeft);return c(s,x,u,function(f){return f?i(f):p.length>x.length?function(){return l(s,p.slice(x.length),u,i)}:void 0})}});function h(l){return function(){for(var s=l.apply(this,arguments);typeof s=="function";)s=s();return s}}}).call(this)}).call(this,m("_process"),m("buffer").Buffer)},{_process:278,assert:75,buffer:85,debug:303}],303:[function(m,G,Y){(function(d){(function(){function v(){var w;try{w=Y.storage.debug}catch{}return!w&&d!==void 0&&"env"in d&&(w=d.env.DEBUG),w}(Y=G.exports=m("./debug")).log=function(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},Y.formatArgs=function(w){var y=this.useColors;if(w[0]=(y?"%c":"")+this.namespace+(y?" %c":" ")+w[0]+(y?"%c ":" ")+"+"+Y.humanize(this.diff),!!y){var e="color: "+this.color;w.splice(1,0,e,"color: inherit");var t=0,n=0;w[0].replace(/%[a-zA-Z%]/g,function(o){o!=="%%"&&(t++,o==="%c"&&(n=t))}),w.splice(n,0,e)}},Y.save=function(w){try{w==null?Y.storage.removeItem("debug"):Y.storage.debug=w}catch{}},Y.load=v,Y.useColors=function(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},Y.storage=typeof chrome<"u"&&chrome.storage!==void 0?chrome.storage.local:function(){try{return window.localStorage}catch{}}(),Y.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],Y.formatters.j=function(w){try{return JSON.stringify(w)}catch(y){return"[UnexpectedJSONParseError]: "+y.message}},Y.enable(v())}).call(this)}).call(this,m("_process"))},{"./debug":304,_process:278}],304:[function(m,G,Y){var d;function v(w){function y(){if(y.enabled){var e=y,t=+new Date,n=t-(d||t);e.diff=n,e.prev=d,e.curr=t,d=t;for(var o=new Array(arguments.length),r=0;r<o.length;r++)o[r]=arguments[r];o[0]=Y.coerce(o[0]),typeof o[0]!="string"&&o.unshift("%O");var g=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(a,h){if(a==="%%")return a;g++;var l=Y.formatters[h];if(typeof l=="function"){var s=o[g];a=l.call(e,s),o.splice(g,1),g--}return a}),Y.formatArgs.call(e,o);var c=y.log||Y.log||console.log.bind(console);c.apply(e,o)}}return y.namespace=w,y.enabled=Y.enabled(w),y.useColors=Y.useColors(),y.color=function(e){var t,n=0;for(t in e)n=(n<<5)-n+e.charCodeAt(t),n|=0;return Y.colors[Math.abs(n)%Y.colors.length]}(w),typeof Y.init=="function"&&Y.init(y),y}(Y=G.exports=v.debug=v.default=v).coerce=function(w){return w instanceof Error?w.stack||w.message:w},Y.disable=function(){Y.enable("")},Y.enable=function(w){Y.save(w),Y.names=[],Y.skips=[];for(var y=(typeof w=="string"?w:"").split(/[\s,]+/),e=y.length,t=0;t<e;t++)y[t]&&((w=y[t].replace(/\*/g,".*?"))[0]==="-"?Y.skips.push(new RegExp("^"+w.substr(1)+"$")):Y.names.push(new RegExp("^"+w+"$")))},Y.enabled=function(w){var y,e;for(y=0,e=Y.skips.length;y<e;y++)if(Y.skips[y].test(w))return!1;for(y=0,e=Y.names.length;y<e;y++)if(Y.names[y].test(w))return!0;return!1},Y.humanize=m("ms"),Y.names=[],Y.skips=[],Y.formatters={}},{ms:305}],305:[function(m,G,Y){var d=1e3,v=6e4,w=60*v,y=24*w;function e(t,n,o){if(!(t<n))return t<1.5*n?Math.floor(t/n)+" "+o:Math.ceil(t/n)+" "+o+"s"}G.exports=function(t,n){n=n||{};var o,r=typeof t;if(r==="string"&&t.length>0)return function(g){if(!((g=String(g)).length>100)){var c=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(g);if(!!c){var a=parseFloat(c[1]);switch((c[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*a;case"days":case"day":case"d":return a*y;case"hours":case"hour":case"hrs":case"hr":case"h":return a*w;case"minutes":case"minute":case"mins":case"min":case"m":return a*v;case"seconds":case"second":case"secs":case"sec":case"s":return a*d;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return a;default:return}}}}(t);if(r==="number"&&isNaN(t)===!1)return n.long?e(o=t,y,"day")||e(o,w,"hour")||e(o,v,"minute")||e(o,d,"second")||o+" ms":function(g){return g>=y?Math.round(g/y)+"d":g>=w?Math.round(g/w)+"h":g>=v?Math.round(g/v)+"m":g>=d?Math.round(g/d)+"s":g+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},{}],306:[function(m,G,Y){var d=m("parenthesis");G.exports=function(v,w,y){if(v==null)throw Error("First argument should be a string");if(w==null)throw Error("Separator should be a string or a RegExp");y?(typeof y=="string"||Array.isArray(y))&&(y={ignore:y}):y={},y.escape==null&&(y.escape=!0),y.ignore==null?y.ignore=["[]","()","{}","<>",'""',"''","``","\u201C\u201D","\xAB\xBB"]:(typeof y.ignore=="string"&&(y.ignore=[y.ignore]),y.ignore=y.ignore.map(function(c){return c.length===1&&(c+=c),c}));var e=d.parse(v,{flat:!0,brackets:y.ignore}),t=e[0].split(w);if(y.escape){for(var n=[],o=0;o<t.length;o++){var r=t[o],g=t[o+1];r[r.length-1]==="\\"&&r[r.length-2]!=="\\"?(n.push(r+w+g),o++):n.push(r)}t=n}for(o=0;o<t.length;o++)e[0]=t[o],t[o]=d.stringify(e,{flat:!0});return t}},{parenthesis:248}],307:[function(m,G,Y){G.exports=function(d){for(var v=d.length,w=new Array(v),y=new Array(v),e=new Array(v),t=new Array(v),n=new Array(v),o=new Array(v),r=0;r<v;++r)w[r]=-1,y[r]=0,e[r]=!1,t[r]=0,n[r]=-1,o[r]=[];var g,c=0,a=[],h=[];function l(u){var i=[u],x=[u];for(w[u]=y[u]=c,e[u]=!0,c+=1;x.length>0;){u=x[x.length-1];var f=d[u];if(t[u]<f.length){for(var _=t[u];_<f.length;++_){var b=f[_];if(w[b]<0){w[b]=y[b]=c,e[b]=!0,c+=1,i.push(b),x.push(b);break}e[b]&&(y[u]=0|Math.min(y[u],y[b])),n[b]>=0&&o[u].push(n[b])}t[u]=_}else{if(y[u]===w[u]){var T=[],k=[],L=0;for(_=i.length-1;_>=0;--_){var A=i[_];if(e[A]=!1,T.push(A),k.push(o[A]),L+=o[A].length,n[A]=a.length,A===u){i.length=_;break}}a.push(T);var I=new Array(L);for(_=0;_<k.length;_++)for(var P=0;P<k[_].length;P++)I[--L]=k[_][P];h.push(I)}x.pop()}}}for(r=0;r<v;++r)w[r]<0&&l(r);for(r=0;r<h.length;r++){var s=h[r];if(s.length!==0){s.sort(function(u,i){return u-i}),g=[s[0]];for(var p=1;p<s.length;p++)s[p]!==s[p-1]&&g.push(s[p]);h[r]=g}}return{components:a,adjacencyList:h}}},{}],308:[function(m,G,Y){Object.defineProperty(Y,"__esModule",{value:!0});var d=function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(o,r){var g=[],c=!0,a=!1,h=void 0;try{for(var l,s=o[Symbol.iterator]();!(c=(l=s.next()).done)&&(g.push(l.value),!r||g.length!==r);c=!0);}catch(p){a=!0,h=p}finally{try{!c&&s.return&&s.return()}finally{if(a)throw h}}return g}(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")},v=2*Math.PI,w=function(t,n,o,r,g,c,a){var h=t.x,l=t.y;return{x:r*(h*=n)-g*(l*=o)+c,y:g*h+r*l+a}},y=function(t,n){var o=n===1.5707963267948966?.551915024494:n===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(n/4),r=Math.cos(t),g=Math.sin(t),c=Math.cos(t+n),a=Math.sin(t+n);return[{x:r-g*o,y:g+r*o},{x:c+a*o,y:a-c*o},{x:c,y:a}]},e=function(t,n,o,r){var g=t*o+n*r;return g>1&&(g=1),g<-1&&(g=-1),(t*r-n*o<0?-1:1)*Math.acos(g)};Y.default=function(t){var n=t.px,o=t.py,r=t.cx,g=t.cy,c=t.rx,a=t.ry,h=t.xAxisRotation,l=h===void 0?0:h,s=t.largeArcFlag,p=s===void 0?0:s,u=t.sweepFlag,i=u===void 0?0:u,x=[];if(c===0||a===0)return[];var f=Math.sin(l*v/360),_=Math.cos(l*v/360),b=_*(n-r)/2+f*(o-g)/2,T=-f*(n-r)/2+_*(o-g)/2;if(b===0&&T===0)return[];c=Math.abs(c),a=Math.abs(a);var k=Math.pow(b,2)/Math.pow(c,2)+Math.pow(T,2)/Math.pow(a,2);k>1&&(c*=Math.sqrt(k),a*=Math.sqrt(k));var L=function(V,Z,Q,X,$,re,H,N,U,te,B,K){var J=Math.pow($,2),ee=Math.pow(re,2),ne=Math.pow(B,2),se=Math.pow(K,2),oe=J*ee-J*se-ee*ne;oe<0&&(oe=0),oe/=J*se+ee*ne;var me=(oe=Math.sqrt(oe)*(H===N?-1:1))*$/re*K,ce=oe*-re/$*B,ye=te*me-U*ce+(V+Q)/2,Se=U*me+te*ce+(Z+X)/2,fe=(B-me)/$,ge=(K-ce)/re,Te=(-B-me)/$,le=(-K-ce)/re,ve=e(1,0,fe,ge),Me=e(fe,ge,Te,le);return N===0&&Me>0&&(Me-=v),N===1&&Me<0&&(Me+=v),[ye,Se,ve,Me]}(n,o,r,g,c,a,p,i,f,_,b,T),A=d(L,4),I=A[0],P=A[1],S=A[2],E=A[3],z=Math.abs(E)/(v/4);Math.abs(1-z)<1e-7&&(z=1);var D=Math.max(Math.ceil(z),1);E/=D;for(var j=0;j<D;j++)x.push(y(S,E)),S+=E;return x.map(function(V){var Z=w(V[0],c,a,_,f,I,P),Q=Z.x,X=Z.y,$=w(V[1],c,a,_,f,I,P),re=$.x,H=$.y,N=w(V[2],c,a,_,f,I,P);return{x1:Q,y1:X,x2:re,y2:H,x:N.x,y:N.y}})},G.exports=Y.default},{}],309:[function(m,G,Y){var d=m("parse-svg-path"),v=m("abs-svg-path"),w=m("normalize-svg-path"),y=m("is-svg-path"),e=m("assert");G.exports=function(t){if(Array.isArray(t)&&t.length===1&&typeof t[0]=="string"&&(t=t[0]),typeof t=="string"&&(e(y(t),"String is not an SVG path."),t=d(t)),e(Array.isArray(t),"Argument should be a string or an array of path segments."),t=v(t),!(t=w(t)).length)return[0,0,0,0];for(var n=[1/0,1/0,-1/0,-1/0],o=0,r=t.length;o<r;o++)for(var g=t[o].slice(1),c=0;c<g.length;c+=2)g[c+0]<n[0]&&(n[0]=g[c+0]),g[c+1]<n[1]&&(n[1]=g[c+1]),g[c+0]>n[2]&&(n[2]=g[c+0]),g[c+1]>n[3]&&(n[3]=g[c+1]);return n}},{"abs-svg-path":70,assert:75,"is-svg-path":238,"normalize-svg-path":310,"parse-svg-path":250}],310:[function(m,G,Y){G.exports=function(y){for(var e,t=[],n=0,o=0,r=0,g=0,c=null,a=null,h=0,l=0,s=0,p=y.length;s<p;s++){var u=y[s],i=u[0];switch(i){case"M":r=u[1],g=u[2];break;case"A":var x=d({px:h,py:l,cx:u[6],cy:u[7],rx:u[1],ry:u[2],xAxisRotation:u[3],largeArcFlag:u[4],sweepFlag:u[5]});if(!x.length)continue;for(var f,_=0;_<x.length;_++)f=x[_],u=["C",f.x1,f.y1,f.x2,f.y2,f.x,f.y],_<x.length-1&&t.push(u);break;case"S":var b=h,T=l;e!="C"&&e!="S"||(b+=b-n,T+=T-o),u=["C",b,T,u[1],u[2],u[3],u[4]];break;case"T":e=="Q"||e=="T"?(c=2*h-c,a=2*l-a):(c=h,a=l),u=w(h,l,c,a,u[1],u[2]);break;case"Q":c=u[1],a=u[2],u=w(h,l,u[1],u[2],u[3],u[4]);break;case"L":u=v(h,l,u[1],u[2]);break;case"H":u=v(h,l,u[1],l);break;case"V":u=v(h,l,h,u[1]);break;case"Z":u=v(h,l,r,g)}e=i,h=u[u.length-2],l=u[u.length-1],u.length>4?(n=u[u.length-4],o=u[u.length-3]):(n=h,o=l),t.push(u)}return t};var d=m("svg-arc-to-cubic-bezier");function v(y,e,t,n){return["C",y,e,t,n,t,n]}function w(y,e,t,n,o,r){return["C",y/3+2/3*t,e/3+2/3*n,o/3+2/3*t,r/3+2/3*n,o,r]}},{"svg-arc-to-cubic-bezier":308}],311:[function(m,G,Y){var d,v=m("svg-path-bounds"),w=m("parse-svg-path"),y=m("draw-svg-path"),e=m("is-svg-path"),t=m("bitmap-sdf"),n=document.createElement("canvas"),o=n.getContext("2d");G.exports=function(r,g){if(!e(r))throw Error("Argument should be valid svg path string");g||(g={});var c,a;g.shape?(c=g.shape[0],a=g.shape[1]):(c=n.width=g.w||g.width||200,a=n.height=g.h||g.height||200);var h=Math.min(c,a),l=g.stroke||0,s=g.viewbox||g.viewBox||v(r),p=[c/(s[2]-s[0]),a/(s[3]-s[1])],u=Math.min(p[0]||0,p[1]||0)/2;if(o.fillStyle="black",o.fillRect(0,0,c,a),o.fillStyle="white",l&&(typeof l!="number"&&(l=1),o.strokeStyle=l>0?"white":"black",o.lineWidth=Math.abs(l)),o.translate(.5*c,.5*a),o.scale(u,u),function(){if(d!=null)return d;var f=document.createElement("canvas").getContext("2d");if(f.canvas.width=f.canvas.height=1,!window.Path2D)return d=!1;var _=new Path2D("M0,0h1v1h-1v-1Z");f.fillStyle="black",f.fill(_);var b=f.getImageData(0,0,1,1);return d=b&&b.data&&b.data[3]===255}()){var i=new Path2D(r);o.fill(i),l&&o.stroke(i)}else{var x=w(r);y(o,x),o.fill(),l&&o.stroke()}return o.setTransform(1,0,0,1,0,0),t(o,{cutoff:g.cutoff!=null?g.cutoff:.5,radius:g.radius!=null?g.radius:.5*h})}},{"bitmap-sdf":82,"draw-svg-path":126,"is-svg-path":238,"parse-svg-path":250,"svg-path-bounds":309}],312:[function(m,G,Y){(function(d,v){(function(){var w=m("process/browser.js").nextTick,y=Function.prototype.apply,e=Array.prototype.slice,t={},n=0;function o(r,g){this._id=r,this._clearFn=g}Y.setTimeout=function(){return new o(y.call(setTimeout,window,arguments),clearTimeout)},Y.setInterval=function(){return new o(y.call(setInterval,window,arguments),clearInterval)},Y.clearTimeout=Y.clearInterval=function(r){r.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(window,this._id)},Y.enroll=function(r,g){clearTimeout(r._idleTimeoutId),r._idleTimeout=g},Y.unenroll=function(r){clearTimeout(r._idleTimeoutId),r._idleTimeout=-1},Y._unrefActive=Y.active=function(r){clearTimeout(r._idleTimeoutId);var g=r._idleTimeout;g>=0&&(r._idleTimeoutId=setTimeout(function(){r._onTimeout&&r._onTimeout()},g))},Y.setImmediate=typeof d=="function"?d:function(r){var g=n++,c=!(arguments.length<2)&&e.call(arguments,1);return t[g]=!0,w(function(){t[g]&&(c?r.apply(null,c):r.call(null),Y.clearImmediate(g))}),g},Y.clearImmediate=typeof v=="function"?v:function(r){delete t[r]}}).call(this)}).call(this,m("timers").setImmediate,m("timers").clearImmediate)},{"process/browser.js":278,timers:312}],313:[function(m,G,Y){(function(d){var v=/^\s+/,w=/\s+$/,y=0,e=d.round,t=d.min,n=d.max,o=d.random;function r(U,te){if(te=te||{},(U=U||"")instanceof r)return U;if(!(this instanceof r))return new r(U,te);var B=function(K){var J={r:0,g:0,b:0},ee=1,ne=null,se=null,oe=null,me=!1,ce=!1;typeof K=="string"&&(K=function(ge){ge=ge.replace(v,"").replace(w,"").toLowerCase();var Te,le=!1;if(I[ge])ge=I[ge],le=!0;else if(ge=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};return(Te=H.rgb.exec(ge))?{r:Te[1],g:Te[2],b:Te[3]}:(Te=H.rgba.exec(ge))?{r:Te[1],g:Te[2],b:Te[3],a:Te[4]}:(Te=H.hsl.exec(ge))?{h:Te[1],s:Te[2],l:Te[3]}:(Te=H.hsla.exec(ge))?{h:Te[1],s:Te[2],l:Te[3],a:Te[4]}:(Te=H.hsv.exec(ge))?{h:Te[1],s:Te[2],v:Te[3]}:(Te=H.hsva.exec(ge))?{h:Te[1],s:Te[2],v:Te[3],a:Te[4]}:(Te=H.hex8.exec(ge))?{r:D(Te[1]),g:D(Te[2]),b:D(Te[3]),a:Q(Te[4]),format:le?"name":"hex8"}:(Te=H.hex6.exec(ge))?{r:D(Te[1]),g:D(Te[2]),b:D(Te[3]),format:le?"name":"hex"}:(Te=H.hex4.exec(ge))?{r:D(Te[1]+""+Te[1]),g:D(Te[2]+""+Te[2]),b:D(Te[3]+""+Te[3]),a:Q(Te[4]+""+Te[4]),format:le?"name":"hex8"}:(Te=H.hex3.exec(ge))?{r:D(Te[1]+""+Te[1]),g:D(Te[2]+""+Te[2]),b:D(Te[3]+""+Te[3]),format:le?"name":"hex"}:!1}(K)),typeof K=="object"&&(N(K.r)&&N(K.g)&&N(K.b)?(ye=K.r,Se=K.g,fe=K.b,J={r:255*E(ye,255),g:255*E(Se,255),b:255*E(fe,255)},me=!0,ce=String(K.r).substr(-1)==="%"?"prgb":"rgb"):N(K.h)&&N(K.s)&&N(K.v)?(ne=V(K.s),se=V(K.v),J=function(ge,Te,le){ge=6*E(ge,360),Te=E(Te,100),le=E(le,100);var ve=d.floor(ge),Me=ge-ve,we=le*(1-Te),de=le*(1-Me*Te),Ie=le*(1-(1-Me)*Te),De=ve%6;return{r:255*[le,de,we,we,Ie,le][De],g:255*[Ie,le,le,de,we,we][De],b:255*[we,we,Ie,le,le,de][De]}}(K.h,ne,se),me=!0,ce="hsv"):N(K.h)&&N(K.s)&&N(K.l)&&(ne=V(K.s),oe=V(K.l),J=function(ge,Te,le){var ve,Me,we;function de(Oe,Ve,Fe){return Fe<0&&(Fe+=1),Fe>1&&(Fe-=1),Fe<1/6?Oe+6*(Ve-Oe)*Fe:Fe<.5?Ve:Fe<2/3?Oe+(Ve-Oe)*(2/3-Fe)*6:Oe}if(ge=E(ge,360),Te=E(Te,100),le=E(le,100),Te===0)ve=Me=we=le;else{var Ie=le<.5?le*(1+Te):le+Te-le*Te,De=2*le-Ie;ve=de(De,Ie,ge+1/3),Me=de(De,Ie,ge),we=de(De,Ie,ge-1/3)}return{r:255*ve,g:255*Me,b:255*we}}(K.h,ne,oe),me=!0,ce="hsl"),K.hasOwnProperty("a")&&(ee=K.a));var ye,Se,fe;return ee=S(ee),{ok:me,format:K.format||ce,r:t(255,n(J.r,0)),g:t(255,n(J.g,0)),b:t(255,n(J.b,0)),a:ee}}(U);this._originalInput=U,this._r=B.r,this._g=B.g,this._b=B.b,this._a=B.a,this._roundA=e(100*this._a)/100,this._format=te.format||B.format,this._gradientType=te.gradientType,this._r<1&&(this._r=e(this._r)),this._g<1&&(this._g=e(this._g)),this._b<1&&(this._b=e(this._b)),this._ok=B.ok,this._tc_id=y++}function g(U,te,B){U=E(U,255),te=E(te,255),B=E(B,255);var K,J,ee=n(U,te,B),ne=t(U,te,B),se=(ee+ne)/2;if(ee==ne)K=J=0;else{var oe=ee-ne;switch(J=se>.5?oe/(2-ee-ne):oe/(ee+ne),ee){case U:K=(te-B)/oe+(te<B?6:0);break;case te:K=(B-U)/oe+2;break;case B:K=(U-te)/oe+4}K/=6}return{h:K,s:J,l:se}}function c(U,te,B){U=E(U,255),te=E(te,255),B=E(B,255);var K,J,ee=n(U,te,B),ne=t(U,te,B),se=ee,oe=ee-ne;if(J=ee===0?0:oe/ee,ee==ne)K=0;else{switch(ee){case U:K=(te-B)/oe+(te<B?6:0);break;case te:K=(B-U)/oe+2;break;case B:K=(U-te)/oe+4}K/=6}return{h:K,s:J,v:se}}function a(U,te,B,K){var J=[j(e(U).toString(16)),j(e(te).toString(16)),j(e(B).toString(16))];return K&&J[0].charAt(0)==J[0].charAt(1)&&J[1].charAt(0)==J[1].charAt(1)&&J[2].charAt(0)==J[2].charAt(1)?J[0].charAt(0)+J[1].charAt(0)+J[2].charAt(0):J.join("")}function h(U,te,B,K){return[j(Z(K)),j(e(U).toString(16)),j(e(te).toString(16)),j(e(B).toString(16))].join("")}function l(U,te){te=te===0?0:te||10;var B=r(U).toHsl();return B.s-=te/100,B.s=z(B.s),r(B)}function s(U,te){te=te===0?0:te||10;var B=r(U).toHsl();return B.s+=te/100,B.s=z(B.s),r(B)}function p(U){return r(U).desaturate(100)}function u(U,te){te=te===0?0:te||10;var B=r(U).toHsl();return B.l+=te/100,B.l=z(B.l),r(B)}function i(U,te){te=te===0?0:te||10;var B=r(U).toRgb();return B.r=n(0,t(255,B.r-e(-te/100*255))),B.g=n(0,t(255,B.g-e(-te/100*255))),B.b=n(0,t(255,B.b-e(-te/100*255))),r(B)}function x(U,te){te=te===0?0:te||10;var B=r(U).toHsl();return B.l-=te/100,B.l=z(B.l),r(B)}function f(U,te){var B=r(U).toHsl(),K=(B.h+te)%360;return B.h=K<0?360+K:K,r(B)}function _(U){var te=r(U).toHsl();return te.h=(te.h+180)%360,r(te)}function b(U){var te=r(U).toHsl(),B=te.h;return[r(U),r({h:(B+120)%360,s:te.s,l:te.l}),r({h:(B+240)%360,s:te.s,l:te.l})]}function T(U){var te=r(U).toHsl(),B=te.h;return[r(U),r({h:(B+90)%360,s:te.s,l:te.l}),r({h:(B+180)%360,s:te.s,l:te.l}),r({h:(B+270)%360,s:te.s,l:te.l})]}function k(U){var te=r(U).toHsl(),B=te.h;return[r(U),r({h:(B+72)%360,s:te.s,l:te.l}),r({h:(B+216)%360,s:te.s,l:te.l})]}function L(U,te,B){te=te||6,B=B||30;var K=r(U).toHsl(),J=360/B,ee=[r(U)];for(K.h=(K.h-(J*te>>1)+720)%360;--te;)K.h=(K.h+J)%360,ee.push(r(K));return ee}function A(U,te){te=te||6;for(var B=r(U).toHsv(),K=B.h,J=B.s,ee=B.v,ne=[],se=1/te;te--;)ne.push(r({h:K,s:J,v:ee})),ee=(ee+se)%1;return ne}r.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var U=this.toRgb();return(299*U.r+587*U.g+114*U.b)/1e3},getLuminance:function(){var U,te,B,K=this.toRgb();return U=K.r/255,te=K.g/255,B=K.b/255,.2126*(U<=.03928?U/12.92:d.pow((U+.055)/1.055,2.4))+.7152*(te<=.03928?te/12.92:d.pow((te+.055)/1.055,2.4))+.0722*(B<=.03928?B/12.92:d.pow((B+.055)/1.055,2.4))},setAlpha:function(U){return this._a=S(U),this._roundA=e(100*this._a)/100,this},toHsv:function(){var U=c(this._r,this._g,this._b);return{h:360*U.h,s:U.s,v:U.v,a:this._a}},toHsvString:function(){var U=c(this._r,this._g,this._b),te=e(360*U.h),B=e(100*U.s),K=e(100*U.v);return this._a==1?"hsv("+te+", "+B+"%, "+K+"%)":"hsva("+te+", "+B+"%, "+K+"%, "+this._roundA+")"},toHsl:function(){var U=g(this._r,this._g,this._b);return{h:360*U.h,s:U.s,l:U.l,a:this._a}},toHslString:function(){var U=g(this._r,this._g,this._b),te=e(360*U.h),B=e(100*U.s),K=e(100*U.l);return this._a==1?"hsl("+te+", "+B+"%, "+K+"%)":"hsla("+te+", "+B+"%, "+K+"%, "+this._roundA+")"},toHex:function(U){return a(this._r,this._g,this._b,U)},toHexString:function(U){return"#"+this.toHex(U)},toHex8:function(U){return function(te,B,K,J,ee){var ne=[j(e(te).toString(16)),j(e(B).toString(16)),j(e(K).toString(16)),j(Z(J))];return ee&&ne[0].charAt(0)==ne[0].charAt(1)&&ne[1].charAt(0)==ne[1].charAt(1)&&ne[2].charAt(0)==ne[2].charAt(1)&&ne[3].charAt(0)==ne[3].charAt(1)?ne[0].charAt(0)+ne[1].charAt(0)+ne[2].charAt(0)+ne[3].charAt(0):ne.join("")}(this._r,this._g,this._b,this._a,U)},toHex8String:function(U){return"#"+this.toHex8(U)},toRgb:function(){return{r:e(this._r),g:e(this._g),b:e(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+e(this._r)+", "+e(this._g)+", "+e(this._b)+")":"rgba("+e(this._r)+", "+e(this._g)+", "+e(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:e(100*E(this._r,255))+"%",g:e(100*E(this._g,255))+"%",b:e(100*E(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+e(100*E(this._r,255))+"%, "+e(100*E(this._g,255))+"%, "+e(100*E(this._b,255))+"%)":"rgba("+e(100*E(this._r,255))+"%, "+e(100*E(this._g,255))+"%, "+e(100*E(this._b,255))+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":!(this._a<1)&&(P[a(this._r,this._g,this._b,!0)]||!1)},toFilter:function(U){var te="#"+h(this._r,this._g,this._b,this._a),B=te,K=this._gradientType?"GradientType = 1, ":"";if(U){var J=r(U);B="#"+h(J._r,J._g,J._b,J._a)}return"progid:DXImageTransform.Microsoft.gradient("+K+"startColorstr="+te+",endColorstr="+B+")"},toString:function(U){var te=!!U;U=U||this._format;var B=!1,K=this._a<1&&this._a>=0;return te||!K||U!=="hex"&&U!=="hex6"&&U!=="hex3"&&U!=="hex4"&&U!=="hex8"&&U!=="name"?(U==="rgb"&&(B=this.toRgbString()),U==="prgb"&&(B=this.toPercentageRgbString()),U!=="hex"&&U!=="hex6"||(B=this.toHexString()),U==="hex3"&&(B=this.toHexString(!0)),U==="hex4"&&(B=this.toHex8String(!0)),U==="hex8"&&(B=this.toHex8String()),U==="name"&&(B=this.toName()),U==="hsl"&&(B=this.toHslString()),U==="hsv"&&(B=this.toHsvString()),B||this.toHexString()):U==="name"&&this._a===0?this.toName():this.toRgbString()},clone:function(){return r(this.toString())},_applyModification:function(U,te){var B=U.apply(null,[this].concat([].slice.call(te)));return this._r=B._r,this._g=B._g,this._b=B._b,this.setAlpha(B._a),this},lighten:function(){return this._applyModification(u,arguments)},brighten:function(){return this._applyModification(i,arguments)},darken:function(){return this._applyModification(x,arguments)},desaturate:function(){return this._applyModification(l,arguments)},saturate:function(){return this._applyModification(s,arguments)},greyscale:function(){return this._applyModification(p,arguments)},spin:function(){return this._applyModification(f,arguments)},_applyCombination:function(U,te){return U.apply(null,[this].concat([].slice.call(te)))},analogous:function(){return this._applyCombination(L,arguments)},complement:function(){return this._applyCombination(_,arguments)},monochromatic:function(){return this._applyCombination(A,arguments)},splitcomplement:function(){return this._applyCombination(k,arguments)},triad:function(){return this._applyCombination(b,arguments)},tetrad:function(){return this._applyCombination(T,arguments)}},r.fromRatio=function(U,te){if(typeof U=="object"){var B={};for(var K in U)U.hasOwnProperty(K)&&(B[K]=K==="a"?U[K]:V(U[K]));U=B}return r(U,te)},r.equals=function(U,te){return!(!U||!te)&&r(U).toRgbString()==r(te).toRgbString()},r.random=function(){return r.fromRatio({r:o(),g:o(),b:o()})},r.mix=function(U,te,B){B=B===0?0:B||50;var K=r(U).toRgb(),J=r(te).toRgb(),ee=B/100;return r({r:(J.r-K.r)*ee+K.r,g:(J.g-K.g)*ee+K.g,b:(J.b-K.b)*ee+K.b,a:(J.a-K.a)*ee+K.a})},r.readability=function(U,te){var B=r(U),K=r(te);return(d.max(B.getLuminance(),K.getLuminance())+.05)/(d.min(B.getLuminance(),K.getLuminance())+.05)},r.isReadable=function(U,te,B){var K,J,ee=r.readability(U,te);switch(J=!1,(K=function(ne){var se,oe;return se=((ne=ne||{level:"AA",size:"small"}).level||"AA").toUpperCase(),oe=(ne.size||"small").toLowerCase(),se!=="AA"&&se!=="AAA"&&(se="AA"),oe!=="small"&&oe!=="large"&&(oe="small"),{level:se,size:oe}}(B)).level+K.size){case"AAsmall":case"AAAlarge":J=ee>=4.5;break;case"AAlarge":J=ee>=3;break;case"AAAsmall":J=ee>=7}return J},r.mostReadable=function(U,te,B){var K,J,ee,ne,se=null,oe=0;J=(B=B||{}).includeFallbackColors,ee=B.level,ne=B.size;for(var me=0;me<te.length;me++)(K=r.readability(U,te[me]))>oe&&(oe=K,se=r(te[me]));return r.isReadable(U,se,{level:ee,size:ne})||!J?se:(B.includeFallbackColors=!1,r.mostReadable(U,["#fff","#000"],B))};var I=r.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},P=r.hexNames=function(U){var te={};for(var B in U)U.hasOwnProperty(B)&&(te[U[B]]=B);return te}(I);function S(U){return U=parseFloat(U),(isNaN(U)||U<0||U>1)&&(U=1),U}function E(U,te){(function(K){return typeof K=="string"&&K.indexOf(".")!=-1&&parseFloat(K)===1})(U)&&(U="100%");var B=function(K){return typeof K=="string"&&K.indexOf("%")!=-1}(U);return U=t(te,n(0,parseFloat(U))),B&&(U=parseInt(U*te,10)/100),d.abs(U-te)<1e-6?1:U%te/parseFloat(te)}function z(U){return t(1,n(0,U))}function D(U){return parseInt(U,16)}function j(U){return U.length==1?"0"+U:""+U}function V(U){return U<=1&&(U=100*U+"%"),U}function Z(U){return d.round(255*parseFloat(U)).toString(16)}function Q(U){return D(U)/255}var X,$,re,H=($="[\\s|\\(]+("+(X="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+X+")[,|\\s]+("+X+")\\s*\\)?",re="[\\s|\\(]+("+X+")[,|\\s]+("+X+")[,|\\s]+("+X+")[,|\\s]+("+X+")\\s*\\)?",{CSS_UNIT:new RegExp(X),rgb:new RegExp("rgb"+$),rgba:new RegExp("rgba"+re),hsl:new RegExp("hsl"+$),hsla:new RegExp("hsla"+re),hsv:new RegExp("hsv"+$),hsva:new RegExp("hsva"+re),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function N(U){return!!H.CSS_UNIT.exec(U)}G!==void 0&&G.exports?G.exports=r:window.tinycolor=r})(Math)},{}],314:[function(m,G,Y){G.exports=v,G.exports.float32=G.exports.float=v,G.exports.fract32=G.exports.fract=function(w,y){if(w.length){if(w instanceof Float32Array)return new Float32Array(w.length);y instanceof Float32Array||(y=v(w));for(var e=0,t=y.length;e<t;e++)y[e]=w[e]-y[e];return y}return v(w-v(w))};var d=new Float32Array(1);function v(w){return w.length?w instanceof Float32Array?w:new Float32Array(w):(d[0]=w,d[0])}},{}],315:[function(m,G,Y){var d=m("parse-unit");G.exports=w;function v(y,e){var t=d(getComputedStyle(y).getPropertyValue(e));return t[0]*w(t[1],y)}function w(y,e){switch(e=e||document.body,y=(y||"px").trim().toLowerCase(),e!==window&&e!==document||(e=document.body),y){case"%":return e.clientHeight/100;case"ch":case"ex":return function(t,n){var o=document.createElement("div");o.style["font-size"]="128"+t,n.appendChild(o);var r=v(o,"font-size")/128;return n.removeChild(o),r}(y,e);case"em":return v(e,"font-size");case"rem":return v(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return 96;case"cm":return 96/2.54;case"mm":return 96/25.4;case"pt":return 96/72;case"pc":return 16}return 1}},{"parse-unit":251}],316:[function(m,G,Y){(function(d,v){v(typeof Y=="object"&&G!==void 0?Y:(d=d||self).topojson=d.topojson||{})})(this,function(d){function v(h){return h}function w(h){if(h==null)return v;var l,s,p=h.scale[0],u=h.scale[1],i=h.translate[0],x=h.translate[1];return function(f,_){_||(l=s=0);var b=2,T=f.length,k=new Array(T);for(k[0]=(l+=f[0])*p+i,k[1]=(s+=f[1])*u+x;b<T;)k[b]=f[b],++b;return k}}function y(h){var l,s=w(h.transform),p=1/0,u=p,i=-p,x=-p;function f(b){(b=s(b))[0]<p&&(p=b[0]),b[0]>i&&(i=b[0]),b[1]<u&&(u=b[1]),b[1]>x&&(x=b[1])}function _(b){switch(b.type){case"GeometryCollection":b.geometries.forEach(_);break;case"Point":f(b.coordinates);break;case"MultiPoint":b.coordinates.forEach(f)}}for(l in h.arcs.forEach(function(b){for(var T,k=-1,L=b.length;++k<L;)(T=s(b[k],k))[0]<p&&(p=T[0]),T[0]>i&&(i=T[0]),T[1]<u&&(u=T[1]),T[1]>x&&(x=T[1])}),h.objects)_(h.objects[l]);return[p,u,i,x]}function e(h,l){var s=l.id,p=l.bbox,u=l.properties==null?{}:l.properties,i=t(h,l);return s==null&&p==null?{type:"Feature",properties:u,geometry:i}:p==null?{type:"Feature",id:s,properties:u,geometry:i}:{type:"Feature",id:s,bbox:p,properties:u,geometry:i}}function t(h,l){var s=w(h.transform),p=h.arcs;function u(b,T){T.length&&T.pop();for(var k=p[b<0?~b:b],L=0,A=k.length;L<A;++L)T.push(s(k[L],L));b<0&&function(I,P){for(var S,E=I.length,z=E-P;z<--E;)S=I[z],I[z++]=I[E],I[E]=S}(T,A)}function i(b){return s(b)}function x(b){for(var T=[],k=0,L=b.length;k<L;++k)u(b[k],T);return T.length<2&&T.push(T[0]),T}function f(b){for(var T=x(b);T.length<4;)T.push(T[0]);return T}function _(b){return b.map(f)}return function b(T){var k,L=T.type;switch(L){case"GeometryCollection":return{type:L,geometries:T.geometries.map(b)};case"Point":k=i(T.coordinates);break;case"MultiPoint":k=T.coordinates.map(i);break;case"LineString":k=x(T.arcs);break;case"MultiLineString":k=T.arcs.map(x);break;case"Polygon":k=_(T.arcs);break;case"MultiPolygon":k=T.arcs.map(_);break;default:return null}return{type:L,coordinates:k}}(l)}function n(h,l){var s={},p={},u={},i=[],x=-1;function f(_,b){for(var T in _){var k=_[T];delete b[k.start],delete k.start,delete k.end,k.forEach(function(L){s[L<0?~L:L]=1}),i.push(k)}}return l.forEach(function(_,b){var T,k=h.arcs[_<0?~_:_];k.length<3&&!k[1][0]&&!k[1][1]&&(T=l[++x],l[x]=_,l[b]=T)}),l.forEach(function(_){var b,T,k=function(S){var E,z=h.arcs[S<0?~S:S],D=z[0];return h.transform?(E=[0,0],z.forEach(function(j){E[0]+=j[0],E[1]+=j[1]})):E=z[z.length-1],S<0?[E,D]:[D,E]}(_),L=k[0],A=k[1];if(b=u[L])if(delete u[b.end],b.push(_),b.end=A,T=p[A]){delete p[T.start];var I=T===b?b:b.concat(T);p[I.start=b.start]=u[I.end=T.end]=I}else p[b.start]=u[b.end]=b;else if(b=p[A])if(delete p[b.start],b.unshift(_),b.start=L,T=u[L]){delete u[T.end];var P=T===b?b:T.concat(b);p[P.start=T.start]=u[P.end=b.end]=P}else p[b.start]=u[b.end]=b;else p[(b=[_]).start=L]=u[b.end=A]=b}),f(u,p),f(p,u),l.forEach(function(_){s[_<0?~_:_]||i.push([_])}),i}function o(h,l,s){var p,u,i;if(arguments.length>1)p=r(h,l,s);else for(u=0,p=new Array(i=h.arcs.length);u<i;++u)p[u]=u;return{type:"MultiLineString",arcs:n(h,p)}}function r(h,l,s){var p,u=[],i=[];function x(b){var T=b<0?~b:b;(i[T]||(i[T]=[])).push({i:b,g:p})}function f(b){b.forEach(x)}function _(b){b.forEach(f)}return function b(T){switch(p=T,T.type){case"GeometryCollection":T.geometries.forEach(b);break;case"LineString":f(T.arcs);break;case"MultiLineString":case"Polygon":_(T.arcs);break;case"MultiPolygon":(function(k){k.forEach(_)})(T.arcs)}}(l),i.forEach(s==null?function(b){u.push(b[0].i)}:function(b){s(b[0].g,b[b.length-1].g)&&u.push(b[0].i)}),u}function g(h,l){var s={},p=[],u=[];function i(f){f.forEach(function(_){_.forEach(function(b){(s[b=b<0?~b:b]||(s[b]=[])).push(f)})}),p.push(f)}function x(f){return function(_){for(var b,T=-1,k=_.length,L=_[k-1],A=0;++T<k;)b=L,L=_[T],A+=b[0]*L[1]-b[1]*L[0];return Math.abs(A)}(t(h,{type:"Polygon",arcs:[f]}).coordinates[0])}return l.forEach(function f(_){switch(_.type){case"GeometryCollection":_.geometries.forEach(f);break;case"Polygon":i(_.arcs);break;case"MultiPolygon":_.arcs.forEach(i)}}),p.forEach(function(f){if(!f._){var _=[],b=[f];for(f._=1,u.push(_);f=b.pop();)_.push(f),f.forEach(function(T){T.forEach(function(k){s[k<0?~k:k].forEach(function(L){L._||(L._=1,b.push(L))})})})}}),p.forEach(function(f){delete f._}),{type:"MultiPolygon",arcs:u.map(function(f){var _,b=[];if(f.forEach(function(I){I.forEach(function(P){P.forEach(function(S){s[S<0?~S:S].length<2&&b.push(S)})})}),(_=(b=n(h,b)).length)>1)for(var T,k,L=1,A=x(b[0]);L<_;++L)(T=x(b[L]))>A&&(k=b[0],b[0]=b[L],b[L]=k,A=T);return b}).filter(function(f){return f.length>0})}}function c(h,l){for(var s=0,p=h.length;s<p;){var u=s+p>>>1;h[u]<l?s=u+1:p=u}return s}function a(h){if(h==null)return v;var l,s,p=h.scale[0],u=h.scale[1],i=h.translate[0],x=h.translate[1];return function(f,_){_||(l=s=0);var b=2,T=f.length,k=new Array(T),L=Math.round((f[0]-i)/p),A=Math.round((f[1]-x)/u);for(k[0]=L-l,l=L,k[1]=A-s,s=A;b<T;)k[b]=f[b],++b;return k}}d.bbox=y,d.feature=function(h,l){return typeof l=="string"&&(l=h.objects[l]),l.type==="GeometryCollection"?{type:"FeatureCollection",features:l.geometries.map(function(s){return e(h,s)})}:e(h,l)},d.merge=function(h){return t(h,g.apply(this,arguments))},d.mergeArcs=g,d.mesh=function(h){return t(h,o.apply(this,arguments))},d.meshArcs=o,d.neighbors=function(h){var l={},s=h.map(function(){return[]});function p(I,P){I.forEach(function(S){S<0&&(S=~S);var E=l[S];E?E.push(P):l[S]=[P]})}function u(I,P){I.forEach(function(S){p(S,P)})}var i={LineString:p,MultiLineString:u,Polygon:u,MultiPolygon:function(I,P){I.forEach(function(S){u(S,P)})}};for(var x in h.forEach(function I(P,S){P.type==="GeometryCollection"?P.geometries.forEach(function(E){I(E,S)}):P.type in i&&i[P.type](P.arcs,S)}),l)for(var f=l[x],_=f.length,b=0;b<_;++b)for(var T=b+1;T<_;++T){var k,L=f[b],A=f[T];(k=s[L])[x=c(k,A)]!==A&&k.splice(x,0,A),(k=s[A])[x=c(k,L)]!==L&&k.splice(x,0,L)}return s},d.quantize=function(h,l){if(h.transform)throw new Error("already quantized");if(l&&l.scale)f=h.bbox;else{if(!((s=Math.floor(l))>=2))throw new Error("n must be \u22652");var s,p=(f=h.bbox||y(h))[0],u=f[1],i=f[2],x=f[3];l={scale:[i-p?(i-p)/(s-1):1,x-u?(x-u)/(s-1):1],translate:[p,u]}}var f,_,b=a(l),T=h.objects,k={};function L(I){return b(I)}function A(I){var P;switch(I.type){case"GeometryCollection":P={type:"GeometryCollection",geometries:I.geometries.map(A)};break;case"Point":P={type:"Point",coordinates:L(I.coordinates)};break;case"MultiPoint":P={type:"MultiPoint",coordinates:I.coordinates.map(L)};break;default:return I}return I.id!=null&&(P.id=I.id),I.bbox!=null&&(P.bbox=I.bbox),I.properties!=null&&(P.properties=I.properties),P}for(_ in T)k[_]=A(T[_]);return{type:"Topology",bbox:f,transform:l,objects:k,arcs:h.arcs.map(function(I){var P,S=0,E=1,z=I.length,D=new Array(z);for(D[0]=b(I[0],0);++S<z;)((P=b(I[S],S))[0]||P[1])&&(D[E++]=P);return E===1&&(D[E++]=[0,0]),D.length=E,D})}},d.transform=w,d.untransform=a,Object.defineProperty(d,"__esModule",{value:!0})})},{}],317:[function(m,G,Y){var d=m("../prototype/is");G.exports=function(v){if(typeof v!="function"||!hasOwnProperty.call(v,"length"))return!1;try{if(typeof v.length!="number"||typeof v.call!="function"||typeof v.apply!="function")return!1}catch{return!1}return!d(v)}},{"../prototype/is":324}],318:[function(m,G,Y){var d=m("../value/is"),v=m("../object/is"),w=m("../string/coerce"),y=m("./to-short-string"),e=function(t,n){return t.replace("%v",y(n))};G.exports=function(t,n,o){if(!v(o))throw new TypeError(e(n,t));if(!d(t)){if("default"in o)return o.default;if(o.isOptional)return null}var r=w(o.errorMessage);throw d(r)||(r=n),new TypeError(e(r,t))}},{"../object/is":321,"../string/coerce":325,"../value/is":327,"./to-short-string":320}],319:[function(m,G,Y){G.exports=function(d){try{return d.toString()}catch{try{return String(d)}catch{return null}}}},{}],320:[function(m,G,Y){var d=m("./safe-to-string"),v=/[\n\r\u2028\u2029]/g;G.exports=function(w){var y=d(w);return y===null?"<Non-coercible to string value>":(y.length>100&&(y=y.slice(0,99)+"\u2026"),y=y.replace(v,function(e){switch(e){case`
`:return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}}))}},{"./safe-to-string":319}],321:[function(m,G,Y){var d=m("../value/is"),v={object:!0,function:!0,undefined:!0};G.exports=function(w){return!!d(w)&&hasOwnProperty.call(v,typeof w)}},{"../value/is":327}],322:[function(m,G,Y){var d=m("../lib/resolve-exception"),v=m("./is");G.exports=function(w){return v(w)?w:d(w,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":318,"./is":323}],323:[function(m,G,Y){var d=m("../function/is"),v=/^\s*class[\s{/}]/,w=Function.prototype.toString;G.exports=function(y){return!!d(y)&&!v.test(w.call(y))}},{"../function/is":317}],324:[function(m,G,Y){var d=m("../object/is");G.exports=function(v){if(!d(v))return!1;try{return!!v.constructor&&v.constructor.prototype===v}catch{return!1}}},{"../object/is":321}],325:[function(m,G,Y){var d=m("../value/is"),v=m("../object/is"),w=Object.prototype.toString;G.exports=function(y){if(!d(y))return null;if(v(y)){var e=y.toString;if(typeof e!="function"||e===w)return null}try{return""+y}catch{return null}}},{"../object/is":321,"../value/is":327}],326:[function(m,G,Y){var d=m("../lib/resolve-exception"),v=m("./is");G.exports=function(w){return v(w)?w:d(w,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":318,"./is":327}],327:[function(m,G,Y){G.exports=function(d){return d!=null}},{}],328:[function(m,G,Y){(function(d){(function(){var v=m("bit-twiddle"),w=m("dup"),y=m("buffer").Buffer;d.__TYPEDARRAY_POOL||(d.__TYPEDARRAY_POOL={UINT8:w([32,0]),UINT16:w([32,0]),UINT32:w([32,0]),BIGUINT64:w([32,0]),INT8:w([32,0]),INT16:w([32,0]),INT32:w([32,0]),BIGINT64:w([32,0]),FLOAT:w([32,0]),DOUBLE:w([32,0]),DATA:w([32,0]),UINT8C:w([32,0]),BUFFER:w([32,0])});var e=typeof Uint8ClampedArray<"u",t=typeof BigUint64Array<"u",n=typeof BigInt64Array<"u",o=d.__TYPEDARRAY_POOL;o.UINT8C||(o.UINT8C=w([32,0])),o.BIGUINT64||(o.BIGUINT64=w([32,0])),o.BIGINT64||(o.BIGINT64=w([32,0])),o.BUFFER||(o.BUFFER=w([32,0]));var r=o.DATA,g=o.BUFFER;function c(A){if(A){var I=A.length||A.byteLength,P=v.log2(I);r[P].push(A)}}function a(A){A=v.nextPow2(A);var I=v.log2(A),P=r[I];return P.length>0?P.pop():new ArrayBuffer(A)}function h(A){return new Uint8Array(a(A),0,A)}function l(A){return new Uint16Array(a(2*A),0,A)}function s(A){return new Uint32Array(a(4*A),0,A)}function p(A){return new Int8Array(a(A),0,A)}function u(A){return new Int16Array(a(2*A),0,A)}function i(A){return new Int32Array(a(4*A),0,A)}function x(A){return new Float32Array(a(4*A),0,A)}function f(A){return new Float64Array(a(8*A),0,A)}function _(A){return e?new Uint8ClampedArray(a(A),0,A):h(A)}function b(A){return t?new BigUint64Array(a(8*A),0,A):null}function T(A){return n?new BigInt64Array(a(8*A),0,A):null}function k(A){return new DataView(a(A),0,A)}function L(A){A=v.nextPow2(A);var I=v.log2(A),P=g[I];return P.length>0?P.pop():new y(A)}Y.free=function(A){if(y.isBuffer(A))g[v.log2(A.length)].push(A);else{if(Object.prototype.toString.call(A)!=="[object ArrayBuffer]"&&(A=A.buffer),!A)return;var I=A.length||A.byteLength,P=0|v.log2(I);r[P].push(A)}},Y.freeUint8=Y.freeUint16=Y.freeUint32=Y.freeBigUint64=Y.freeInt8=Y.freeInt16=Y.freeInt32=Y.freeBigInt64=Y.freeFloat32=Y.freeFloat=Y.freeFloat64=Y.freeDouble=Y.freeUint8Clamped=Y.freeDataView=function(A){c(A.buffer)},Y.freeArrayBuffer=c,Y.freeBuffer=function(A){g[v.log2(A.length)].push(A)},Y.malloc=function(A,I){if(I===void 0||I==="arraybuffer")return a(A);switch(I){case"uint8":return h(A);case"uint16":return l(A);case"uint32":return s(A);case"int8":return p(A);case"int16":return u(A);case"int32":return i(A);case"float":case"float32":return x(A);case"double":case"float64":return f(A);case"uint8_clamped":return _(A);case"bigint64":return T(A);case"biguint64":return b(A);case"buffer":return L(A);case"data":case"dataview":return k(A);default:return null}return null},Y.mallocArrayBuffer=a,Y.mallocUint8=h,Y.mallocUint16=l,Y.mallocUint32=s,Y.mallocInt8=p,Y.mallocInt16=u,Y.mallocInt32=i,Y.mallocFloat32=Y.mallocFloat=x,Y.mallocFloat64=Y.mallocDouble=f,Y.mallocUint8Clamped=_,Y.mallocBigUint64=b,Y.mallocBigInt64=T,Y.mallocDataView=k,Y.mallocBuffer=L,Y.clearCache=function(){for(var A=0;A<32;++A)o.UINT8[A].length=0,o.UINT16[A].length=0,o.UINT32[A].length=0,o.INT8[A].length=0,o.INT16[A].length=0,o.INT32[A].length=0,o.FLOAT[A].length=0,o.DOUBLE[A].length=0,o.BIGUINT64[A].length=0,o.BIGINT64[A].length=0,o.UINT8C[A].length=0,r[A].length=0,g[A].length=0}}).call(this)}).call(this,typeof Ka<"u"?Ka:typeof self<"u"?self:typeof window<"u"?window:{})},{"bit-twiddle":81,buffer:85,dup:128}],329:[function(m,G,Y){var d=/[\'\"]/;G.exports=function(v){return v?(d.test(v.charAt(0))&&(v=v.substr(1)),d.test(v.charAt(v.length-1))&&(v=v.substr(0,v.length-1)),v):""}},{}],330:[function(m,G,Y){G.exports=function(d,v,w){Array.isArray(w)||(w=[].slice.call(arguments,2));for(var y=0,e=w.length;y<e;y++){var t=w[y];for(var n in t)if((v[n]===void 0||Array.isArray(v[n])||d[n]!==v[n])&&n in v){var o;if(t[n]===!0)o=v[n];else if(t[n]===!1||typeof t[n]=="function"&&(o=t[n](v[n],d,v))===void 0)continue;d[n]=o}}return d}},{}],331:[function(m,G,Y){(function(d){(function(){function v(w){try{if(!d.localStorage)return!1}catch{return!1}var y=d.localStorage[w];return y!=null&&String(y).toLowerCase()==="true"}G.exports=function(w,y){if(v("noDeprecation"))return w;var e=!1;return function(){if(!e){if(v("throwDeprecation"))throw new Error(y);v("traceDeprecation")?console.trace(y):console.warn(y),e=!0}return w.apply(this,arguments)}}}).call(this)}).call(this,typeof Ka<"u"?Ka:typeof self<"u"?self:typeof window<"u"?window:{})},{}],332:[function(m,G,Y){var d=m("get-canvas-context");G.exports=function(v){return d("webgl",v)}},{"get-canvas-context":194}],333:[function(m,G,Y){var d=m("../main"),v=m("object-assign"),w=d.instance();function y(c){this.local=this.regionalOptions[c||""]||this.regionalOptions[""]}y.prototype=new d.baseCalendar,v(y.prototype,{name:"Chinese",jdEpoch:17214255e-1,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(c,a){if(typeof c=="string"){var h=c.match(t);return h?h[0]:""}var l=this._validateYear(c),s=c.month(),p=""+this.toChineseMonth(l,s);return a&&p.length<2&&(p="0"+p),this.isIntercalaryMonth(l,s)&&(p+="i"),p},monthNames:function(c){if(typeof c=="string"){var a=c.match(n);return a?a[0]:""}var h=this._validateYear(c),l=c.month(),s=["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"][this.toChineseMonth(h,l)-1];return this.isIntercalaryMonth(h,l)&&(s="\u95F0"+s),s},monthNamesShort:function(c){if(typeof c=="string"){var a=c.match(o);return a?a[0]:""}var h=this._validateYear(c),l=c.month(),s=["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"][this.toChineseMonth(h,l)-1];return this.isIntercalaryMonth(h,l)&&(s="\u95F0"+s),s},parseMonth:function(c,a){c=this._validateYear(c);var h,l=parseInt(a);if(isNaN(l))a[0]==="\u95F0"&&(h=!0,a=a.substring(1)),a[a.length-1]==="\u6708"&&(a=a.substring(0,a.length-1)),l=1+["\u4E00","\u4E8C","\u4E09","\u56DB","\u4E94","\u516D","\u4E03","\u516B","\u4E5D","\u5341","\u5341\u4E00","\u5341\u4E8C"].indexOf(a);else{var s=a[a.length-1];h=s==="i"||s==="I"}return this.toMonthIndex(c,l,h)},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(c,a){if(c.year&&(c=c.year()),typeof c!="number"||c<1888||c>2111)throw a.replace(/\{0\}/,this.local.name);return c},toMonthIndex:function(c,a,h){var l=this.intercalaryMonth(c);if(h&&a!==l||a<1||a>12)throw d.local.invalidMonth.replace(/\{0\}/,this.local.name);return l?!h&&a<=l?a-1:a:a-1},toChineseMonth:function(c,a){c.year&&(a=(c=c.year()).month());var h=this.intercalaryMonth(c);if(a<0||a>(h?12:11))throw d.local.invalidMonth.replace(/\{0\}/,this.local.name);return h?a<h?a+1:a:a+1},intercalaryMonth:function(c){return c=this._validateYear(c),r[c-r[0]]>>13},isIntercalaryMonth:function(c,a){c.year&&(a=(c=c.year()).month());var h=this.intercalaryMonth(c);return!!h&&h===a},leapYear:function(c){return this.intercalaryMonth(c)!==0},weekOfYear:function(c,a,h){var l,s=this._validateYear(c,d.local.invalidyear),p=g[s-g[0]],u=p>>9&4095,i=p>>5&15,x=31&p;(l=w.newDate(u,i,x)).add(4-(l.dayOfWeek()||7),"d");var f=this.toJD(c,a,h)-l.toJD();return 1+Math.floor(f/7)},monthsInYear:function(c){return this.leapYear(c)?13:12},daysInMonth:function(c,a){c.year&&(a=c.month(),c=c.year()),c=this._validateYear(c);var h=r[c-r[0]];if(a>(h>>13?12:11))throw d.local.invalidMonth.replace(/\{0\}/,this.local.name);return h&1<<12-a?30:29},weekDay:function(c,a,h){return(this.dayOfWeek(c,a,h)||7)<6},toJD:function(c,a,h){var l=this._validate(c,p,h,d.local.invalidDate);c=this._validateYear(l.year()),a=l.month(),h=l.day();var s=this.isIntercalaryMonth(c,a),p=this.toChineseMonth(c,a),u=function(i,x,f,_,b){var T,k,L;if(typeof i=="object")k=i,T=x||{};else{var A;if(!(typeof i=="number"&&i>=1888&&i<=2111))throw new Error("Lunar year outside range 1888-2111");if(!(typeof x=="number"&&x>=1&&x<=12))throw new Error("Lunar month outside range 1 - 12");if(!(typeof f=="number"&&f>=1&&f<=30))throw new Error("Lunar day outside range 1 - 30");typeof _=="object"?(A=!1,T=_):(A=!!_,T=b||{}),k={year:i,month:x,day:f,isIntercalary:A}}L=k.day-1;var I,P=r[k.year-r[0]],S=P>>13;I=S&&(k.month>S||k.isIntercalary)?k.month:k.month-1;for(var E=0;E<I;E++)L+=P&1<<12-E?30:29;var z=g[k.year-g[0]],D=new Date(z>>9&4095,(z>>5&15)-1,(31&z)+L);return T.year=D.getFullYear(),T.month=1+D.getMonth(),T.day=D.getDate(),T}(c,p,h,s);return w.toJD(u.year,u.month,u.day)},fromJD:function(c){var a=w.fromJD(c),h=function(s,p,u,i){var x,f;if(typeof s=="object")x=s,f=p||{};else{if(!(typeof s=="number"&&s>=1888&&s<=2111))throw new Error("Solar year outside range 1888-2111");if(!(typeof p=="number"&&p>=1&&p<=12))throw new Error("Solar month outside range 1 - 12");if(!(typeof u=="number"&&u>=1&&u<=31))throw new Error("Solar day outside range 1 - 31");x={year:s,month:p,day:u},f=i||{}}var _=g[x.year-g[0]],b=x.year<<9|x.month<<5|x.day;f.year=b>=_?x.year:x.year-1,_=g[f.year-g[0]];var T,k=new Date(_>>9&4095,(_>>5&15)-1,31&_),L=new Date(x.year,x.month-1,x.day);T=Math.round((L-k)/864e5);var A,I=r[f.year-r[0]];for(A=0;A<13;A++){var P=I&1<<12-A?30:29;if(T<P)break;T-=P}var S=I>>13;return!S||A<S?(f.isIntercalary=!1,f.month=1+A):A===S?(f.isIntercalary=!0,f.month=A):(f.isIntercalary=!1,f.month=A),f.day=1+T,f}(a.year(),a.month(),a.day()),l=this.toMonthIndex(h.year,h.month,h.isIntercalary);return this.newDate(h.year,l,h.day)},fromString:function(c){var a=c.match(e),h=this._validateYear(+a[1]),l=+a[2],s=!!a[3],p=this.toMonthIndex(h,l,s),u=+a[4];return this.newDate(h,p,u)},add:function(c,a,h){var l=c.year(),s=c.month(),p=this.isIntercalaryMonth(l,s),u=this.toChineseMonth(l,s),i=Object.getPrototypeOf(y.prototype).add.call(this,c,a,h);if(h==="y"){var x=i.year(),f=i.month(),_=this.isIntercalaryMonth(x,u),b=p&&_?this.toMonthIndex(x,u,!0):this.toMonthIndex(x,u,!1);b!==f&&i.month(b)}return i}});var e=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,t=/^\d?\d[iI]?/m,n=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?\u6708/m,o=/^\u95f0?\u5341?[\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]?/m;d.calendars.chinese=y;var r=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],g=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904]},{"../main":347,"object-assign":247}],334:[function(m,G,Y){var d=m("../main"),v=m("object-assign");function w(y){this.local=this.regionalOptions[y||""]||this.regionalOptions[""]}w.prototype=new d.baseCalendar,v(w.prototype,{name:"Coptic",jdEpoch:18250295e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(y){var e=this._validate(y,this.minMonth,this.minDay,d.local.invalidYear);return(y=e.year()+(e.year()<0?1:0))%4==3||y%4==-1},monthsInYear:function(y){return this._validate(y,this.minMonth,this.minDay,d.local.invalidYear||d.regionalOptions[""].invalidYear),13},weekOfYear:function(y,e,t){var n=this.newDate(y,e,t);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(y,e){var t=this._validate(y,e,this.minDay,d.local.invalidMonth);return this.daysPerMonth[t.month()-1]+(t.month()===13&&this.leapYear(t.year())?1:0)},weekDay:function(y,e,t){return(this.dayOfWeek(y,e,t)||7)<6},toJD:function(y,e,t){var n=this._validate(y,e,t,d.local.invalidDate);return(y=n.year())<0&&y++,n.day()+30*(n.month()-1)+365*(y-1)+Math.floor(y/4)+this.jdEpoch-1},fromJD:function(y){var e=Math.floor(y)+.5-this.jdEpoch,t=Math.floor((e-Math.floor((e+366)/1461))/365)+1;t<=0&&t--,e=Math.floor(y)+.5-this.newDate(t,1,1).toJD();var n=Math.floor(e/30)+1,o=e-30*(n-1)+1;return this.newDate(t,n,o)}}),d.calendars.coptic=w},{"../main":347,"object-assign":247}],335:[function(m,G,Y){var d=m("../main"),v=m("object-assign");function w(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}w.prototype=new d.baseCalendar,v(w.prototype,{name:"Discworld",jdEpoch:17214255e-1,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(e){return this._validate(e,this.minMonth,this.minDay,d.local.invalidYear),!1},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,d.local.invalidYear),13},daysInYear:function(e){return this._validate(e,this.minMonth,this.minDay,d.local.invalidYear),400},weekOfYear:function(e,t,n){var o=this.newDate(e,t,n);return o.add(-o.dayOfWeek(),"d"),Math.floor((o.dayOfYear()-1)/8)+1},daysInMonth:function(e,t){var n=this._validate(e,t,this.minDay,d.local.invalidMonth);return this.daysPerMonth[n.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(e,t,n){return(this._validate(e,t,n,d.local.invalidDate).day()+1)%8},weekDay:function(e,t,n){var o=this.dayOfWeek(e,t,n);return o>=2&&o<=6},extraInfo:function(e,t,n){var o=this._validate(e,t,n,d.local.invalidDate);return{century:y[Math.floor((o.year()-1)/100)+1]||""}},toJD:function(e,t,n){var o=this._validate(e,t,n,d.local.invalidDate);return e=o.year()+(o.year()<0?1:0),t=o.month(),(n=o.day())+(t>1?16:0)+(t>2?32*(t-2):0)+400*(e-1)+this.jdEpoch-1},fromJD:function(e){e=Math.floor(e+.5)-Math.floor(this.jdEpoch)-1;var t=Math.floor(e/400)+1;e-=400*(t-1),e+=e>15?16:0;var n=Math.floor(e/32)+1,o=e-32*(n-1)+1;return this.newDate(t<=0?t-1:t,n,o)}});var y={20:"Fruitbat",21:"Anchovy"};d.calendars.discworld=w},{"../main":347,"object-assign":247}],336:[function(m,G,Y){var d=m("../main"),v=m("object-assign");function w(y){this.local=this.regionalOptions[y||""]||this.regionalOptions[""]}w.prototype=new d.baseCalendar,v(w.prototype,{name:"Ethiopian",jdEpoch:17242205e-1,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(y){var e=this._validate(y,this.minMonth,this.minDay,d.local.invalidYear);return(y=e.year()+(e.year()<0?1:0))%4==3||y%4==-1},monthsInYear:function(y){return this._validate(y,this.minMonth,this.minDay,d.local.invalidYear||d.regionalOptions[""].invalidYear),13},weekOfYear:function(y,e,t){var n=this.newDate(y,e,t);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(y,e){var t=this._validate(y,e,this.minDay,d.local.invalidMonth);return this.daysPerMonth[t.month()-1]+(t.month()===13&&this.leapYear(t.year())?1:0)},weekDay:function(y,e,t){return(this.dayOfWeek(y,e,t)||7)<6},toJD:function(y,e,t){var n=this._validate(y,e,t,d.local.invalidDate);return(y=n.year())<0&&y++,n.day()+30*(n.month()-1)+365*(y-1)+Math.floor(y/4)+this.jdEpoch-1},fromJD:function(y){var e=Math.floor(y)+.5-this.jdEpoch,t=Math.floor((e-Math.floor((e+366)/1461))/365)+1;t<=0&&t--,e=Math.floor(y)+.5-this.newDate(t,1,1).toJD();var n=Math.floor(e/30)+1,o=e-30*(n-1)+1;return this.newDate(t,n,o)}}),d.calendars.ethiopian=w},{"../main":347,"object-assign":247}],337:[function(m,G,Y){var d=m("../main"),v=m("object-assign");function w(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function y(e,t){return e-t*Math.floor(e/t)}w.prototype=new d.baseCalendar,v(w.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,d.local.invalidYear);return this._leapYear(t.year())},_leapYear:function(e){return y(7*(e=e<0?e+1:e)+1,19)<7},monthsInYear:function(e){return this._validate(e,this.minMonth,this.minDay,d.local.invalidYear),this._leapYear(e.year?e.year():e)?13:12},weekOfYear:function(e,t,n){var o=this.newDate(e,t,n);return o.add(-o.dayOfWeek(),"d"),Math.floor((o.dayOfYear()-1)/7)+1},daysInYear:function(e){return e=this._validate(e,this.minMonth,this.minDay,d.local.invalidYear).year(),this.toJD(e===-1?1:e+1,7,1)-this.toJD(e,7,1)},daysInMonth:function(e,t){return e.year&&(t=e.month(),e=e.year()),this._validate(e,t,this.minDay,d.local.invalidMonth),t===12&&this.leapYear(e)||t===8&&y(this.daysInYear(e),10)===5?30:t===9&&y(this.daysInYear(e),10)===3?29:this.daysPerMonth[t-1]},weekDay:function(e,t,n){return this.dayOfWeek(e,t,n)!==6},extraInfo:function(e,t,n){var o=this._validate(e,t,n,d.local.invalidDate);return{yearType:(this.leapYear(o)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(o)%10-3]}},toJD:function(e,t,n){var o=this._validate(e,t,n,d.local.invalidDate);e=o.year(),t=o.month(),n=o.day();var r=e<=0?e+1:e,g=this.jdEpoch+this._delay1(r)+this._delay2(r)+n+1;if(t<7){for(var c=7;c<=this.monthsInYear(e);c++)g+=this.daysInMonth(e,c);for(c=1;c<t;c++)g+=this.daysInMonth(e,c)}else for(c=7;c<t;c++)g+=this.daysInMonth(e,c);return g},_delay1:function(e){var t=Math.floor((235*e-234)/19),n=12084+13753*t,o=29*t+Math.floor(n/25920);return y(3*(o+1),7)<3&&o++,o},_delay2:function(e){var t=this._delay1(e-1),n=this._delay1(e);return this._delay1(e+1)-n==356?2:n-t==382?1:0},fromJD:function(e){e=Math.floor(e)+.5;for(var t=Math.floor(98496*(e-this.jdEpoch)/35975351)-1;e>=this.toJD(t===-1?1:t+1,7,1);)t++;for(var n=e<this.toJD(t,1,1)?7:1;e>this.toJD(t,n,this.daysInMonth(t,n));)n++;var o=e-this.toJD(t,n,1)+1;return this.newDate(t,n,o)}}),d.calendars.hebrew=w},{"../main":347,"object-assign":247}],338:[function(m,G,Y){var d=m("../main"),v=m("object-assign");function w(y){this.local=this.regionalOptions[y||""]||this.regionalOptions[""]}w.prototype=new d.baseCalendar,v(w.prototype,{name:"Islamic",jdEpoch:19484395e-1,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-kham\u012Bs","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(y){return(11*this._validate(y,this.minMonth,this.minDay,d.local.invalidYear).year()+14)%30<11},weekOfYear:function(y,e,t){var n=this.newDate(y,e,t);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(y){return this.leapYear(y)?355:354},daysInMonth:function(y,e){var t=this._validate(y,e,this.minDay,d.local.invalidMonth);return this.daysPerMonth[t.month()-1]+(t.month()===12&&this.leapYear(t.year())?1:0)},weekDay:function(y,e,t){return this.dayOfWeek(y,e,t)!==5},toJD:function(y,e,t){var n=this._validate(y,e,t,d.local.invalidDate);return y=n.year(),e=n.month(),y=y<=0?y+1:y,(t=n.day())+Math.ceil(29.5*(e-1))+354*(y-1)+Math.floor((3+11*y)/30)+this.jdEpoch-1},fromJD:function(y){y=Math.floor(y)+.5;var e=Math.floor((30*(y-this.jdEpoch)+10646)/10631);e=e<=0?e-1:e;var t=Math.min(12,Math.ceil((y-29-this.toJD(e,1,1))/29.5)+1),n=y-this.toJD(e,t,1)+1;return this.newDate(e,t,n)}}),d.calendars.islamic=w},{"../main":347,"object-assign":247}],339:[function(m,G,Y){var d=m("../main"),v=m("object-assign");function w(y){this.local=this.regionalOptions[y||""]||this.regionalOptions[""]}w.prototype=new d.baseCalendar,v(w.prototype,{name:"Julian",jdEpoch:17214235e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(y){var e=this._validate(y,this.minMonth,this.minDay,d.local.invalidYear);return(y=e.year()<0?e.year()+1:e.year())%4==0},weekOfYear:function(y,e,t){var n=this.newDate(y,e,t);return n.add(4-(n.dayOfWeek()||7),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInMonth:function(y,e){var t=this._validate(y,e,this.minDay,d.local.invalidMonth);return this.daysPerMonth[t.month()-1]+(t.month()===2&&this.leapYear(t.year())?1:0)},weekDay:function(y,e,t){return(this.dayOfWeek(y,e,t)||7)<6},toJD:function(y,e,t){var n=this._validate(y,e,t,d.local.invalidDate);return y=n.year(),e=n.month(),t=n.day(),y<0&&y++,e<=2&&(y--,e+=12),Math.floor(365.25*(y+4716))+Math.floor(30.6001*(e+1))+t-1524.5},fromJD:function(y){var e=Math.floor(y+.5)+1524,t=Math.floor((e-122.1)/365.25),n=Math.floor(365.25*t),o=Math.floor((e-n)/30.6001),r=o-Math.floor(o<14?1:13),g=t-Math.floor(r>2?4716:4715),c=e-n-Math.floor(30.6001*o);return g<=0&&g--,this.newDate(g,r,c)}}),d.calendars.julian=w},{"../main":347,"object-assign":247}],340:[function(m,G,Y){var d=m("../main"),v=m("object-assign");function w(t){this.local=this.regionalOptions[t||""]||this.regionalOptions[""]}function y(t,n){return t-n*Math.floor(t/n)}function e(t,n){return y(t-1,n)+1}w.prototype=new d.baseCalendar,v(w.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(t){return this._validate(t,this.minMonth,this.minDay,d.local.invalidYear),!1},formatYear:function(t){t=this._validate(t,this.minMonth,this.minDay,d.local.invalidYear).year();var n=Math.floor(t/400);return t%=400,t+=t<0?400:0,n+"."+Math.floor(t/20)+"."+t%20},forYear:function(t){if((t=t.split(".")).length<3)throw"Invalid Mayan year";for(var n=0,o=0;o<t.length;o++){var r=parseInt(t[o],10);if(Math.abs(r)>19||o>0&&r<0)throw"Invalid Mayan year";n=20*n+r}return n},monthsInYear:function(t){return this._validate(t,this.minMonth,this.minDay,d.local.invalidYear),18},weekOfYear:function(t,n,o){return this._validate(t,n,o,d.local.invalidDate),0},daysInYear:function(t){return this._validate(t,this.minMonth,this.minDay,d.local.invalidYear),360},daysInMonth:function(t,n){return this._validate(t,n,this.minDay,d.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(t,n,o){return this._validate(t,n,o,d.local.invalidDate).day()},weekDay:function(t,n,o){return this._validate(t,n,o,d.local.invalidDate),!0},extraInfo:function(t,n,o){var r=this._validate(t,n,o,d.local.invalidDate).toJD(),g=this._toHaab(r),c=this._toTzolkin(r);return{haabMonthName:this.local.haabMonths[g[0]-1],haabMonth:g[0],haabDay:g[1],tzolkinDayName:this.local.tzolkinMonths[c[0]-1],tzolkinDay:c[0],tzolkinTrecena:c[1]}},_toHaab:function(t){var n=y((t-=this.jdEpoch)+8+340,365);return[Math.floor(n/20)+1,y(n,20)]},_toTzolkin:function(t){return[e((t-=this.jdEpoch)+20,20),e(t+4,13)]},toJD:function(t,n,o){var r=this._validate(t,n,o,d.local.invalidDate);return r.day()+20*r.month()+360*r.year()+this.jdEpoch},fromJD:function(t){t=Math.floor(t)+.5-this.jdEpoch;var n=Math.floor(t/360);t%=360,t+=t<0?360:0;var o=Math.floor(t/20),r=t%20;return this.newDate(n,o,r)}}),d.calendars.mayan=w},{"../main":347,"object-assign":247}],341:[function(m,G,Y){var d=m("../main"),v=m("object-assign");function w(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}w.prototype=new d.baseCalendar;var y=d.instance("gregorian");v(w.prototype,{name:"Nanakshahi",jdEpoch:22576735e-1,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,d.local.invalidYear||d.regionalOptions[""].invalidYear);return y.leapYear(t.year()+(t.year()<1?1:0)+1469)},weekOfYear:function(e,t,n){var o=this.newDate(e,t,n);return o.add(1-(o.dayOfWeek()||7),"d"),Math.floor((o.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var n=this._validate(e,t,this.minDay,d.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===12&&this.leapYear(n.year())?1:0)},weekDay:function(e,t,n){return(this.dayOfWeek(e,t,n)||7)<6},toJD:function(e,t,n){var o=this._validate(e,t,n,d.local.invalidMonth);(e=o.year())<0&&e++;for(var r=o.day(),g=1;g<o.month();g++)r+=this.daysPerMonth[g-1];return r+y.toJD(e+1468,3,13)},fromJD:function(e){e=Math.floor(e+.5);for(var t=Math.floor((e-(this.jdEpoch-1))/366);e>=this.toJD(t+1,1,1);)t++;for(var n=e-Math.floor(this.toJD(t,1,1)+.5)+1,o=1;n>this.daysInMonth(t,o);)n-=this.daysInMonth(t,o),o++;return this.newDate(t,o,n)}}),d.calendars.nanakshahi=w},{"../main":347,"object-assign":247}],342:[function(m,G,Y){var d=m("../main"),v=m("object-assign");function w(y){this.local=this.regionalOptions[y||""]||this.regionalOptions[""]}w.prototype=new d.baseCalendar,v(w.prototype,{name:"Nepali",jdEpoch:17007095e-1,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(y){return this.daysInYear(y)!==this.daysPerYear},weekOfYear:function(y,e,t){var n=this.newDate(y,e,t);return n.add(-n.dayOfWeek(),"d"),Math.floor((n.dayOfYear()-1)/7)+1},daysInYear:function(y){if(y=this._validate(y,this.minMonth,this.minDay,d.local.invalidYear).year(),this.NEPALI_CALENDAR_DATA[y]===void 0)return this.daysPerYear;for(var e=0,t=this.minMonth;t<=12;t++)e+=this.NEPALI_CALENDAR_DATA[y][t];return e},daysInMonth:function(y,e){return y.year&&(e=y.month(),y=y.year()),this._validate(y,e,this.minDay,d.local.invalidMonth),this.NEPALI_CALENDAR_DATA[y]===void 0?this.daysPerMonth[e-1]:this.NEPALI_CALENDAR_DATA[y][e]},weekDay:function(y,e,t){return this.dayOfWeek(y,e,t)!==6},toJD:function(y,e,t){var n=this._validate(y,e,t,d.local.invalidDate);y=n.year(),e=n.month(),t=n.day();var o=d.instance(),r=0,g=e,c=y;this._createMissingCalendarData(y);var a=y-(g>9||g===9&&t>=this.NEPALI_CALENDAR_DATA[c][0]?56:57);for(e!==9&&(r=t,g--);g!==9;)g<=0&&(g=12,c--),r+=this.NEPALI_CALENDAR_DATA[c][g],g--;return e===9?(r+=t-this.NEPALI_CALENDAR_DATA[c][0])<0&&(r+=o.daysInYear(a)):r+=this.NEPALI_CALENDAR_DATA[c][9]-this.NEPALI_CALENDAR_DATA[c][0],o.newDate(a,1,1).add(r,"d").toJD()},fromJD:function(y){var e=d.instance().fromJD(y),t=e.year(),n=e.dayOfYear(),o=t+56;this._createMissingCalendarData(o);for(var r=9,g=this.NEPALI_CALENDAR_DATA[o][0],c=this.NEPALI_CALENDAR_DATA[o][r]-g+1;n>c;)++r>12&&(r=1,o++),c+=this.NEPALI_CALENDAR_DATA[o][r];var a=this.NEPALI_CALENDAR_DATA[o][r]-(c-n);return this.newDate(o,r,a)},_createMissingCalendarData:function(y){var e=this.daysPerMonth.slice(0);e.unshift(17);for(var t=y-1;t<y+2;t++)this.NEPALI_CALENDAR_DATA[t]===void 0&&(this.NEPALI_CALENDAR_DATA[t]=e)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),d.calendars.nepali=w},{"../main":347,"object-assign":247}],343:[function(m,G,Y){var d=m("../main"),v=m("object-assign");function w(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}function y(e,t){return e-t*Math.floor(e/t)}w.prototype=new d.baseCalendar,v(w.prototype,{name:"Persian",jdEpoch:19483205e-1,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","Ch\xE6harshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","Ch\xE6","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,d.local.invalidYear);return 682*((t.year()-(t.year()>0?474:473))%2820+474+38)%2816<682},weekOfYear:function(e,t,n){var o=this.newDate(e,t,n);return o.add(-(o.dayOfWeek()+1)%7,"d"),Math.floor((o.dayOfYear()-1)/7)+1},daysInMonth:function(e,t){var n=this._validate(e,t,this.minDay,d.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===12&&this.leapYear(n.year())?1:0)},weekDay:function(e,t,n){return this.dayOfWeek(e,t,n)!==5},toJD:function(e,t,n){var o=this._validate(e,t,n,d.local.invalidDate);e=o.year(),t=o.month(),n=o.day();var r=e-(e>=0?474:473),g=474+y(r,2820);return n+(t<=7?31*(t-1):30*(t-1)+6)+Math.floor((682*g-110)/2816)+365*(g-1)+1029983*Math.floor(r/2820)+this.jdEpoch-1},fromJD:function(e){var t=(e=Math.floor(e)+.5)-this.toJD(475,1,1),n=Math.floor(t/1029983),o=y(t,1029983),r=2820;if(o!==1029982){var g=Math.floor(o/366),c=y(o,366);r=Math.floor((2134*g+2816*c+2815)/1028522)+g+1}var a=r+2820*n+474;a=a<=0?a-1:a;var h=e-this.toJD(a,1,1)+1,l=h<=186?Math.ceil(h/31):Math.ceil((h-6)/30),s=e-this.toJD(a,l,1)+1;return this.newDate(a,l,s)}}),d.calendars.persian=w,d.calendars.jalali=w},{"../main":347,"object-assign":247}],344:[function(m,G,Y){var d=m("../main"),v=m("object-assign"),w=d.instance();function y(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}y.prototype=new d.baseCalendar,v(y.prototype,{name:"Taiwan",jdEpoch:24194025e-1,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,d.local.invalidYear);return e=this._t2gYear(t.year()),w.leapYear(e)},weekOfYear:function(e,t,n){var o=this._validate(e,this.minMonth,this.minDay,d.local.invalidYear);return e=this._t2gYear(o.year()),w.weekOfYear(e,o.month(),o.day())},daysInMonth:function(e,t){var n=this._validate(e,t,this.minDay,d.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===2&&this.leapYear(n.year())?1:0)},weekDay:function(e,t,n){return(this.dayOfWeek(e,t,n)||7)<6},toJD:function(e,t,n){var o=this._validate(e,t,n,d.local.invalidDate);return e=this._t2gYear(o.year()),w.toJD(e,o.month(),o.day())},fromJD:function(e){var t=w.fromJD(e),n=this._g2tYear(t.year());return this.newDate(n,t.month(),t.day())},_t2gYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)},_g2tYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)}}),d.calendars.taiwan=y},{"../main":347,"object-assign":247}],345:[function(m,G,Y){var d=m("../main"),v=m("object-assign"),w=d.instance();function y(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}y.prototype=new d.baseCalendar,v(y.prototype,{name:"Thai",jdEpoch:15230985e-1,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,d.local.invalidYear);return e=this._t2gYear(t.year()),w.leapYear(e)},weekOfYear:function(e,t,n){var o=this._validate(e,this.minMonth,this.minDay,d.local.invalidYear);return e=this._t2gYear(o.year()),w.weekOfYear(e,o.month(),o.day())},daysInMonth:function(e,t){var n=this._validate(e,t,this.minDay,d.local.invalidMonth);return this.daysPerMonth[n.month()-1]+(n.month()===2&&this.leapYear(n.year())?1:0)},weekDay:function(e,t,n){return(this.dayOfWeek(e,t,n)||7)<6},toJD:function(e,t,n){var o=this._validate(e,t,n,d.local.invalidDate);return e=this._t2gYear(o.year()),w.toJD(e,o.month(),o.day())},fromJD:function(e){var t=w.fromJD(e),n=this._g2tYear(t.year());return this.newDate(n,t.month(),t.day())},_t2gYear:function(e){return e-this.yearsOffset-(e>=1&&e<=this.yearsOffset?1:0)},_g2tYear:function(e){return e+this.yearsOffset+(e>=-this.yearsOffset&&e<=-1?1:0)}}),d.calendars.thai=y},{"../main":347,"object-assign":247}],346:[function(m,G,Y){var d=m("../main"),v=m("object-assign");function w(e){this.local=this.regionalOptions[e||""]||this.regionalOptions[""]}w.prototype=new d.baseCalendar,v(w.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-Thal\u0101th\u0101\u2019","Yawm al-Arba\u2018\u0101\u2019","Yawm al-Kham\u012Bs","Yawm al-Jum\u2018a","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(e){var t=this._validate(e,this.minMonth,this.minDay,d.local.invalidYear);return this.daysInYear(t.year())===355},weekOfYear:function(e,t,n){var o=this.newDate(e,t,n);return o.add(-o.dayOfWeek(),"d"),Math.floor((o.dayOfYear()-1)/7)+1},daysInYear:function(e){for(var t=0,n=1;n<=12;n++)t+=this.daysInMonth(e,n);return t},daysInMonth:function(e,t){for(var n=this._validate(e,t,this.minDay,d.local.invalidMonth).toJD()-24e5+.5,o=0,r=0;r<y.length;r++){if(y[r]>n)return y[o]-y[o-1];o++}return 30},weekDay:function(e,t,n){return this.dayOfWeek(e,t,n)!==5},toJD:function(e,t,n){var o=this._validate(e,t,n,d.local.invalidDate),r=12*(o.year()-1)+o.month()-15292;return o.day()+y[r-1]-1+24e5-.5},fromJD:function(e){for(var t=e-24e5+.5,n=0,o=0;o<y.length&&!(y[o]>t);o++)n++;var r=n+15292,g=Math.floor((r-1)/12),c=g+1,a=r-12*g,h=t-y[n-1]+1;return this.newDate(c,a,h)},isValid:function(e,t,n){var o=d.baseCalendar.prototype.isValid.apply(this,arguments);return o&&(o=(e=e.year!=null?e.year:e)>=1276&&e<=1500),o},_validate:function(e,t,n,o){var r=d.baseCalendar.prototype._validate.apply(this,arguments);if(r.year<1276||r.year>1500)throw o.replace(/\{0\}/,this.local.name);return r}}),d.calendars.ummalqura=w;var y=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":347,"object-assign":247}],347:[function(m,G,Y){var d=m("object-assign");function v(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}function w(o,r,g,c){if(this._calendar=o,this._year=r,this._month=g,this._day=c,this._calendar._validateLevel===0&&!this._calendar.isValid(this._year,this._month,this._day))throw(n.local.invalidDate||n.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function y(o,r){return"000000".substring(0,r-(o=""+o).length)+o}function e(){this.shortYearCutoff="+10"}function t(o){this.local=this.regionalOptions[o]||this.regionalOptions[""]}d(v.prototype,{instance:function(o,r){o=(o||"gregorian").toLowerCase(),r=r||"";var g=this._localCals[o+"-"+r];if(!g&&this.calendars[o]&&(g=new this.calendars[o](r),this._localCals[o+"-"+r]=g),!g)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,o);return g},newDate:function(o,r,g,c,a){return(c=(o!=null&&o.year?o.calendar():typeof c=="string"?this.instance(c,a):c)||this.instance()).newDate(o,r,g)},substituteDigits:function(o){return function(r){return(r+"").replace(/[0-9]/g,function(g){return o[g]})}},substituteChineseDigits:function(o,r){return function(g){for(var c="",a=0;g>0;){var h=g%10;c=(h===0?"":o[h]+r[a])+c,a++,g=Math.floor(g/10)}return c.indexOf(o[1]+r[1])===0&&(c=c.substr(1)),c||o[0]}}}),d(w.prototype,{newDate:function(o,r,g){return this._calendar.newDate(o==null?this:o,r,g)},year:function(o){return arguments.length===0?this._year:this.set(o,"y")},month:function(o){return arguments.length===0?this._month:this.set(o,"m")},day:function(o){return arguments.length===0?this._day:this.set(o,"d")},date:function(o,r,g){if(!this._calendar.isValid(o,r,g))throw(n.local.invalidDate||n.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=o,this._month=r,this._day=g,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(o,r){return this._calendar.add(this,o,r)},set:function(o,r){return this._calendar.set(this,o,r)},compareTo:function(o){if(this._calendar.name!==o._calendar.name)throw(n.local.differentCalendars||n.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,o._calendar.local.name);var r=this._year!==o._year?this._year-o._year:this._month!==o._month?this.monthOfYear()-o.monthOfYear():this._day-o._day;return r===0?0:r<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(o){return this._calendar.fromJD(o)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(o){return this._calendar.fromJSDate(o)},toString:function(){return(this.year()<0?"-":"")+y(Math.abs(this.year()),4)+"-"+y(this.month(),2)+"-"+y(this.day(),2)}}),d(e.prototype,{_validateLevel:0,newDate:function(o,r,g){return o==null?this.today():(o.year&&(this._validate(o,r,g,n.local.invalidDate||n.regionalOptions[""].invalidDate),g=o.day(),r=o.month(),o=o.year()),new w(this,o,r,g))},today:function(){return this.fromJSDate(new Date)},epoch:function(o){return this._validate(o,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear).year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(o){var r=this._validate(o,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return(r.year()<0?"-":"")+y(Math.abs(r.year()),4)},monthsInYear:function(o){return this._validate(o,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear),12},monthOfYear:function(o,r){var g=this._validate(o,r,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth);return(g.month()+this.monthsInYear(g)-this.firstMonth)%this.monthsInYear(g)+this.minMonth},fromMonthOfYear:function(o,r){var g=(r+this.firstMonth-2*this.minMonth)%this.monthsInYear(o)+this.minMonth;return this._validate(o,g,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth),g},daysInYear:function(o){var r=this._validate(o,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return this.leapYear(r)?366:365},dayOfYear:function(o,r,g){var c=this._validate(o,r,g,n.local.invalidDate||n.regionalOptions[""].invalidDate);return c.toJD()-this.newDate(c.year(),this.fromMonthOfYear(c.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(o,r,g){var c=this._validate(o,r,g,n.local.invalidDate||n.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(c))+2)%this.daysInWeek()},extraInfo:function(o,r,g){return this._validate(o,r,g,n.local.invalidDate||n.regionalOptions[""].invalidDate),{}},add:function(o,r,g){return this._validate(o,this.minMonth,this.minDay,n.local.invalidDate||n.regionalOptions[""].invalidDate),this._correctAdd(o,this._add(o,r,g),r,g)},_add:function(o,r,g){if(this._validateLevel++,g==="d"||g==="w"){var c=o.toJD()+r*(g==="w"?this.daysInWeek():1),a=o.calendar().fromJD(c);return this._validateLevel--,[a.year(),a.month(),a.day()]}try{var h=o.year()+(g==="y"?r:0),l=o.monthOfYear()+(g==="m"?r:0);a=o.day(),g==="y"?(o.month()!==this.fromMonthOfYear(h,l)&&(l=this.newDate(h,o.month(),this.minDay).monthOfYear()),l=Math.min(l,this.monthsInYear(h)),a=Math.min(a,this.daysInMonth(h,this.fromMonthOfYear(h,l)))):g==="m"&&(function(p){for(;l<p.minMonth;)h--,l+=p.monthsInYear(h);for(var u=p.monthsInYear(h);l>u-1+p.minMonth;)h++,l-=u,u=p.monthsInYear(h)}(this),a=Math.min(a,this.daysInMonth(h,this.fromMonthOfYear(h,l))));var s=[h,this.fromMonthOfYear(h,l),a];return this._validateLevel--,s}catch(p){throw this._validateLevel--,p}},_correctAdd:function(o,r,g,c){if(!(this.hasYearZero||c!=="y"&&c!=="m"||r[0]!==0&&o.year()>0==r[0]>0)){var a={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[c],h=g<0?-1:1;r=this._add(o,g*a[0]+h*a[1],a[2])}return o.date(r[0],r[1],r[2])},set:function(o,r,g){this._validate(o,this.minMonth,this.minDay,n.local.invalidDate||n.regionalOptions[""].invalidDate);var c=g==="y"?r:o.year(),a=g==="m"?r:o.month(),h=g==="d"?r:o.day();return g!=="y"&&g!=="m"||(h=Math.min(h,this.daysInMonth(c,a))),o.date(c,a,h)},isValid:function(o,r,g){this._validateLevel++;var c=this.hasYearZero||o!==0;if(c){var a=this.newDate(o,r,this.minDay);c=r>=this.minMonth&&r-this.minMonth<this.monthsInYear(a)&&g>=this.minDay&&g-this.minDay<this.daysInMonth(a)}return this._validateLevel--,c},toJSDate:function(o,r,g){var c=this._validate(o,r,g,n.local.invalidDate||n.regionalOptions[""].invalidDate);return n.instance().fromJD(this.toJD(c)).toJSDate()},fromJSDate:function(o){return this.fromJD(n.instance().fromJSDate(o).toJD())},_validate:function(o,r,g,c){if(o.year){if(this._validateLevel===0&&this.name!==o.calendar().name)throw(n.local.differentCalendars||n.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,o.calendar().local.name);return o}try{if(this._validateLevel++,this._validateLevel===1&&!this.isValid(o,r,g))throw c.replace(/\{0\}/,this.local.name);var a=this.newDate(o,r,g);return this._validateLevel--,a}catch(h){throw this._validateLevel--,h}}}),t.prototype=new e,d(t.prototype,{name:"Gregorian",jdEpoch:17214255e-1,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(o){var r=this._validate(o,this.minMonth,this.minDay,n.local.invalidYear||n.regionalOptions[""].invalidYear);return(o=r.year()+(r.year()<0?1:0))%4==0&&(o%100!=0||o%400==0)},weekOfYear:function(o,r,g){var c=this.newDate(o,r,g);return c.add(4-(c.dayOfWeek()||7),"d"),Math.floor((c.dayOfYear()-1)/7)+1},daysInMonth:function(o,r){var g=this._validate(o,r,this.minDay,n.local.invalidMonth||n.regionalOptions[""].invalidMonth);return this.daysPerMonth[g.month()-1]+(g.month()===2&&this.leapYear(g.year())?1:0)},weekDay:function(o,r,g){return(this.dayOfWeek(o,r,g)||7)<6},toJD:function(o,r,g){var c=this._validate(o,r,g,n.local.invalidDate||n.regionalOptions[""].invalidDate);o=c.year(),r=c.month(),g=c.day(),o<0&&o++,r<3&&(r+=12,o--);var a=Math.floor(o/100),h=2-a+Math.floor(a/4);return Math.floor(365.25*(o+4716))+Math.floor(30.6001*(r+1))+g+h-1524.5},fromJD:function(o){var r=Math.floor(o+.5),g=Math.floor((r-186721625e-2)/36524.25),c=(g=r+1+g-Math.floor(g/4))+1524,a=Math.floor((c-122.1)/365.25),h=Math.floor(365.25*a),l=Math.floor((c-h)/30.6001),s=c-h-Math.floor(30.6001*l),p=l-(l>13.5?13:1),u=a-(p>2.5?4716:4715);return u<=0&&u--,this.newDate(u,p,s)},toJSDate:function(o,r,g){var c=this._validate(o,r,g,n.local.invalidDate||n.regionalOptions[""].invalidDate),a=new Date(c.year(),c.month()-1,c.day());return a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a.setHours(a.getHours()>12?a.getHours()+2:0),a},fromJSDate:function(o){return this.newDate(o.getFullYear(),o.getMonth()+1,o.getDate())}});var n=G.exports=new v;n.cdate=w,n.baseCalendar=e,n.calendars.gregorian=t},{"object-assign":247}],348:[function(m,G,Y){var d=m("object-assign"),v=m("./main");d(v.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),v.local=v.regionalOptions[""],d(v.cdate.prototype,{formatDate:function(w,y){return typeof w!="string"&&(y=w,w=""),this._calendar.formatDate(w||"",this,y)}}),d(v.baseCalendar.prototype,{UNIX_EPOCH:v.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:86400,TICKS_EPOCH:v.instance().jdEpoch,TICKS_PER_DAY:864e9,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(w,y,e){if(typeof w!="string"&&(e=y,y=w,w=""),!y)return"";if(y.calendar()!==this)throw v.local.invalidFormat||v.regionalOptions[""].invalidFormat;w=w||this.local.dateFormat;for(var t,n,o,r,g=(e=e||{}).dayNamesShort||this.local.dayNamesShort,c=e.dayNames||this.local.dayNames,a=e.monthNumbers||this.local.monthNumbers,h=e.monthNamesShort||this.local.monthNamesShort,l=e.monthNames||this.local.monthNames,s=(e.calculateWeek||this.local.calculateWeek,function(L,A){for(var I=1;k+I<w.length&&w.charAt(k+I)===L;)I++;return k+=I-1,Math.floor(I/(A||1))>1}),p=function(L,A,I,P){var S=""+A;if(s(L,P))for(;S.length<I;)S="0"+S;return S},u=this,i=function(L){return typeof a=="function"?a.call(u,L,s("m")):_(p("m",L.month(),2))},x=function(L,A){return A?typeof l=="function"?l.call(u,L):l[L.month()-u.minMonth]:typeof h=="function"?h.call(u,L):h[L.month()-u.minMonth]},f=this.local.digits,_=function(L){return e.localNumbers&&f?f(L):L},b="",T=!1,k=0;k<w.length;k++)if(T)w.charAt(k)!=="'"||s("'")?b+=w.charAt(k):T=!1;else switch(w.charAt(k)){case"d":b+=_(p("d",y.day(),2));break;case"D":b+=(t="D",n=y.dayOfWeek(),o=g,r=c,s(t)?r[n]:o[n]);break;case"o":b+=p("o",y.dayOfYear(),3);break;case"w":b+=p("w",y.weekOfYear(),2);break;case"m":b+=i(y);break;case"M":b+=x(y,s("M"));break;case"y":b+=s("y",2)?y.year():(y.year()%100<10?"0":"")+y.year()%100;break;case"Y":s("Y",2),b+=y.formatYear();break;case"J":b+=y.toJD();break;case"@":b+=(y.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":b+=(y.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":s("'")?b+="'":T=!0;break;default:b+=w.charAt(k)}return b},parseDate:function(w,y,e){if(y==null)throw v.local.invalidArguments||v.regionalOptions[""].invalidArguments;if((y=typeof y=="object"?y.toString():y+"")==="")return null;w=w||this.local.dateFormat;var t=(e=e||{}).shortYearCutoff||this.shortYearCutoff;t=typeof t!="string"?t:this.today().year()%100+parseInt(t,10);for(var n=e.dayNamesShort||this.local.dayNamesShort,o=e.dayNames||this.local.dayNames,r=e.parseMonth||this.local.parseMonth,g=e.monthNumbers||this.local.monthNumbers,c=e.monthNamesShort||this.local.monthNamesShort,a=e.monthNames||this.local.monthNames,h=-1,l=-1,s=-1,p=-1,u=-1,i=!1,x=!1,f=function(z,D){for(var j=1;P+j<w.length&&w.charAt(P+j)===z;)j++;return P+=j-1,Math.floor(j/(D||1))>1},_=function(z,D){var j=f(z,D),V=[2,3,j?4:2,j?4:2,10,11,20]["oyYJ@!".indexOf(z)+1],Z=new RegExp("^-?\\d{1,"+V+"}"),Q=y.substring(I).match(Z);if(!Q)throw(v.local.missingNumberAt||v.regionalOptions[""].missingNumberAt).replace(/\{0\}/,I);return I+=Q[0].length,parseInt(Q[0],10)},b=this,T=function(){if(typeof g=="function"){f("m");var z=g.call(b,y.substring(I));return I+=z.length,z}return _("m")},k=function(z,D,j,V){for(var Z=f(z,V)?j:D,Q=0;Q<Z.length;Q++)if(y.substr(I,Z[Q].length).toLowerCase()===Z[Q].toLowerCase())return I+=Z[Q].length,Q+b.minMonth;throw(v.local.unknownNameAt||v.regionalOptions[""].unknownNameAt).replace(/\{0\}/,I)},L=function(){if(typeof a=="function"){var z=f("M")?a.call(b,y.substring(I)):c.call(b,y.substring(I));return I+=z.length,z}return k("M",c,a)},A=function(){if(y.charAt(I)!==w.charAt(P))throw(v.local.unexpectedLiteralAt||v.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,I);I++},I=0,P=0;P<w.length;P++)if(x)w.charAt(P)!=="'"||f("'")?A():x=!1;else switch(w.charAt(P)){case"d":p=_("d");break;case"D":k("D",n,o);break;case"o":u=_("o");break;case"w":_("w");break;case"m":s=T();break;case"M":s=L();break;case"y":var S=P;i=!f("y",2),P=S,l=_("y",2);break;case"Y":l=_("Y",2);break;case"J":h=_("J")+.5,y.charAt(I)==="."&&(I++,_("J"));break;case"@":h=_("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":h=_("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":I=y.length;break;case"'":f("'")?A():x=!0;break;default:A()}if(I<y.length)throw v.local.unexpectedText||v.regionalOptions[""].unexpectedText;if(l===-1?l=this.today().year():l<100&&i&&(l+=t===-1?1900:this.today().year()-this.today().year()%100-(l<=t?0:100)),typeof s=="string"&&(s=r.call(this,l,s)),u>-1){s=1,p=u;for(var E=this.daysInMonth(l,s);p>E;E=this.daysInMonth(l,s))s++,p-=E}return h>-1?this.fromJD(h):this.newDate(l,s,p)},determineDate:function(w,y,e,t,n){e&&typeof e!="object"&&(n=t,t=e,e=null),typeof t!="string"&&(n=t,t="");var o=this;return y=y?y.newDate():null,w=w==null?y:typeof w=="string"?function(r){try{return o.parseDate(t,r,n)}catch{}for(var g=((r=r.toLowerCase()).match(/^c/)&&e?e.newDate():null)||o.today(),c=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,a=c.exec(r);a;)g.add(parseInt(a[1],10),a[2]||"d"),a=c.exec(r);return g}(w):typeof w=="number"?isNaN(w)||w===1/0||w===-1/0?y:o.today().add(w,"d"):o.newDate(w)}})},{"./main":347,"object-assign":247}],349:[function(m,G,Y){G.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],350:[function(m,G,Y){var d=m("./arrow_paths"),v=m("../../plots/font_attributes"),w=m("../../plots/cartesian/constants"),y=m("../../plot_api/plot_template").templatedArray;m("../../constants/axis_placeable_objects"),G.exports=y("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:v({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:d.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:d.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",w.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",w.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",w.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",w.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:v({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../constants/axis_placeable_objects":484,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573,"../../plots/font_attributes":594,"./arrow_paths":349}],351:[function(m,G,Y){var d=m("../../lib"),v=m("../../plots/cartesian/axes"),w=m("./draw").draw;function y(t){var n=t._fullLayout;d.filterVisible(n.annotations).forEach(function(o){var r=v.getFromId(t,o.xref),g=v.getFromId(t,o.yref),c=v.getRefType(o.xref),a=v.getRefType(o.yref);o._extremes={},c==="range"&&e(o,r),a==="range"&&e(o,g)})}function e(t,n){var o,r=n._id,g=r.charAt(0),c=t[g],a=t["a"+g],h=t[g+"ref"],l=t["a"+g+"ref"],s=t["_"+g+"padplus"],p=t["_"+g+"padminus"],u={x:1,y:-1}[g]*t[g+"shift"],i=3*t.arrowsize*t.arrowwidth||0,x=i+u,f=i-u,_=3*t.startarrowsize*t.arrowwidth||0,b=_+u,T=_-u;if(l===h){var k=v.findExtremes(n,[n.r2c(c)],{ppadplus:x,ppadminus:f}),L=v.findExtremes(n,[n.r2c(a)],{ppadplus:Math.max(s,b),ppadminus:Math.max(p,T)});o={min:[k.min[0],L.min[0]],max:[k.max[0],L.max[0]]}}else b=a?b+a:b,T=a?T-a:T,o=v.findExtremes(n,[n.r2c(c)],{ppadplus:Math.max(s,x,b),ppadminus:Math.max(p,f,T)});t._extremes[r]=o}G.exports=function(t){var n=t._fullLayout;if(d.filterVisible(n.annotations).length&&t._fullData.length)return d.syncOrAsync([w,y],t)}},{"../../lib":515,"../../plots/cartesian/axes":566,"./draw":356}],352:[function(m,G,Y){var d=m("../../lib"),v=m("../../registry"),w=m("../../plot_api/plot_template").arrayEditor;function y(t,n){var o,r,g,c,a,h,l,s=t._fullLayout.annotations,p=[],u=[],i=[],x=(n||[]).length;for(o=0;o<s.length;o++)if(c=(g=s[o]).clicktoshow){for(r=0;r<x;r++)if(h=(a=n[r]).xaxis,l=a.yaxis,h._id===g.xref&&l._id===g.yref&&h.d2r(a.x)===e(g._xclick,h)&&l.d2r(a.y)===e(g._yclick,l)){(g.visible?c==="onout"?u:i:p).push(o);break}r===x&&g.visible&&c==="onout"&&u.push(o)}return{on:p,off:u,explicitOff:i}}function e(t,n){return n.type==="log"?n.l2r(t):n.d2r(t)}G.exports={hasClickToShow:function(t,n){var o=y(t,n);return o.on.length>0||o.explicitOff.length>0},onClick:function(t,n){var o,r,g=y(t,n),c=g.on,a=g.off.concat(g.explicitOff),h={},l=t._fullLayout.annotations;if(!(!c.length&&!a.length)){for(o=0;o<c.length;o++)(r=w(t.layout,"annotations",l[c[o]])).modifyItem("visible",!0),d.extendFlat(h,r.getUpdateObj());for(o=0;o<a.length;o++)(r=w(t.layout,"annotations",l[a[o]])).modifyItem("visible",!1),d.extendFlat(h,r.getUpdateObj());return v.call("update",t,{},h)}}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647}],353:[function(m,G,Y){var d=m("../../lib"),v=m("../color");G.exports=function(w,y,e,t){t("opacity");var n=t("bgcolor"),o=t("bordercolor"),r=v.opacity(o);t("borderpad");var g=t("borderwidth"),c=t("showarrow");if(t("text",c?" ":e._dfltTitle.annotation),t("textangle"),d.coerceFont(t,"font",e.font),t("width"),t("align"),t("height")&&t("valign"),c){var a,h,l=t("arrowside");l.indexOf("end")!==-1&&(a=t("arrowhead"),h=t("arrowsize")),l.indexOf("start")!==-1&&(t("startarrowhead",a),t("startarrowsize",h)),t("arrowcolor",r?y.bordercolor:v.defaultLine),t("arrowwidth",2*(r&&g||1)),t("standoff"),t("startstandoff")}var s=t("hovertext"),p=e.hoverlabel||{};if(s){var u=t("hoverlabel.bgcolor",p.bgcolor||(v.opacity(n)?v.rgb(n):v.defaultLine)),i=t("hoverlabel.bordercolor",p.bordercolor||v.contrast(u));d.coerceFont(t,"hoverlabel.font",{family:p.font.family,size:p.font.size,color:p.font.color||i})}t("captureevents",!!s)}},{"../../lib":515,"../color":367}],354:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../lib/to_log_range");G.exports=function(w,y,e,t){y=y||{};var n=e==="log"&&y.type==="linear",o=e==="linear"&&y.type==="log";if(n||o)for(var r,g,c=w._fullLayout.annotations,a=y._id.charAt(0),h=0;h<c.length;h++)r=c[h],g="annotations["+h+"].",r[a+"ref"]===y._id&&l(a),r["a"+a+"ref"]===y._id&&l("a"+a);function l(s){var p=r[s],u=null;u=n?v(p,y.range):Math.pow(10,p),d(u)||(u=null),t(g+s,u)}}},{"../../lib/to_log_range":543,"fast-isnumeric":190}],355:[function(m,G,Y){var d=m("../../lib"),v=m("../../plots/cartesian/axes"),w=m("../../plots/array_container_defaults"),y=m("./common_defaults"),e=m("./attributes");function t(n,o,r){function g(L,A){return d.coerce(n,o,e,L,A)}var c=g("visible"),a=g("clicktoshow");if(c||a){y(n,o,r,g);for(var h=o.showarrow,l=["x","y"],s=[-10,-30],p={_fullLayout:r},u=0;u<2;u++){var i=l[u],x=v.coerceRef(n,o,p,i,"","paper");if(x!=="paper"&&v.getFromId(p,x)._annIndices.push(o._index),v.coercePosition(o,p,g,x,i,.5),h){var f="a"+i,_=v.coerceRef(n,o,p,f,"pixel",["pixel","paper"]);_!=="pixel"&&_!==x&&(_=o[f]="pixel");var b=_==="pixel"?s[u]:.4;v.coercePosition(o,p,g,_,f,b)}g(i+"anchor"),g(i+"shift")}if(d.noneOrAll(n,o,["x","y"]),h&&d.noneOrAll(n,o,["ax","ay"]),a){var T=g("xclick"),k=g("yclick");o._xclick=T===void 0?o.x:v.cleanPosition(T,p,o.xref),o._yclick=k===void 0?o.y:v.cleanPosition(k,p,o.yref)}}}G.exports=function(n,o){w(n,o,{name:"annotations",handleItemDefaults:t})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":350,"./common_defaults":353}],356:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../registry"),w=m("../../plots/plots"),y=m("../../lib"),e=y.strTranslate,t=m("../../plots/cartesian/axes"),n=m("../color"),o=m("../drawing"),r=m("../fx"),g=m("../../lib/svg_text_utils"),c=m("../../lib/setcursor"),a=m("../dragelement"),h=m("../../plot_api/plot_template").arrayEditor,l=m("./draw_arrow_head");function s(i,x){var f=i._fullLayout.annotations[x]||{},_=t.getFromId(i,f.xref),b=t.getFromId(i,f.yref);_&&_.setScale(),b&&b.setScale(),u(i,f,x,!1,_,b)}function p(i,x,f,_,b){var T=b[f],k=b[f+"ref"],L=f.indexOf("y")!==-1,A=t.getRefType(k)==="domain",I=L?_.h:_.w;return i?A?T+(L?-x:x)/i._length:i.p2r(i.r2p(T)+x):T+(L?-x:x)/I}function u(i,x,f,_,b,T){var k,L,A=i._fullLayout,I=i._fullLayout._size,P=i._context.edits;_?(k="annotation-"+_,L=_+".annotations"):(k="annotation",L="annotations");var S=h(i.layout,L,x),E=S.modifyBase,z=S.modifyItem,D=S.getUpdateObj;A._infolayer.selectAll("."+k+'[data-index="'+f+'"]').remove();var j="clip"+A._uid+"_ann"+f;if(x._input&&x.visible!==!1){var V={x:{},y:{}},Z=+x.textangle||0,Q=A._infolayer.append("g").classed(k,!0).attr("data-index",String(f)).style("opacity",x.opacity),X=Q.append("g").classed("annotation-text-g",!0),$=P[x.showarrow?"annotationTail":"annotationPosition"],re=x.captureevents||P.annotationText||$,H=X.append("g").style("pointer-events",re?"all":null).call(c,"pointer").on("click",function(){i._dragging=!1,i.emit("plotly_clickannotation",oe(d.event))});x.hovertext&&H.on("mouseover",function(){var ye=x.hoverlabel,Se=ye.font,fe=this.getBoundingClientRect(),ge=i.getBoundingClientRect();r.loneHover({x0:fe.left-ge.left,x1:fe.right-ge.left,y:(fe.top+fe.bottom)/2-ge.top,text:x.hovertext,color:ye.bgcolor,borderColor:ye.bordercolor,fontFamily:Se.family,fontSize:Se.size,fontColor:Se.color},{container:A._hoverlayer.node(),outerContainer:A._paper.node(),gd:i})}).on("mouseout",function(){r.loneUnhover(A._hoverlayer.node())});var N=x.borderwidth,U=x.borderpad,te=N+U,B=H.append("rect").attr("class","bg").style("stroke-width",N+"px").call(n.stroke,x.bordercolor).call(n.fill,x.bgcolor),K=x.width||x.height,J=A._topclips.selectAll("#"+j).data(K?[0]:[]);J.enter().append("clipPath").classed("annclip",!0).attr("id",j).append("rect"),J.exit().remove();var ee=x.font,ne=A._meta?y.templateString(x.text,A._meta):x.text,se=H.append("text").classed("annotation-text",!0).text(ne);P.annotationText?se.call(g.makeEditable,{delegate:H,gd:i}).call(me).on("edit",function(ye){x.text=ye,this.call(me),z("text",ye),b&&b.autorange&&E(b._name+".autorange",!0),T&&T.autorange&&E(T._name+".autorange",!0),v.call("_guiRelayout",i,D())}):se.call(me)}else d.selectAll("#"+j).remove();function oe(ye){var Se={index:f,annotation:x._input,fullAnnotation:x,event:ye};return _&&(Se.subplotId=_),Se}function me(ye){return ye.call(o.font,ee).attr({"text-anchor":{left:"start",right:"end"}[x.align]||"middle"}),g.convertToTspans(ye,i,ce),ye}function ce(){var ye=se.selectAll("a");ye.size()===1&&ye.text()===se.text()&&H.insert("a",":first-child").attr({"xlink:xlink:href":ye.attr("xlink:href"),"xlink:xlink:show":ye.attr("xlink:show")}).style({cursor:"pointer"}).node().appendChild(B.node());var Se=H.select(".annotation-text-math-group"),fe=!Se.empty(),ge=o.bBox((fe?Se:se).node()),Te=ge.width,le=ge.height,ve=x.width||Te,Me=x.height||le,we=Math.round(ve+2*te),de=Math.round(Me+2*te);function Ie(it,ht){return ht==="auto"&&(ht=it<1/3?"left":it>2/3?"right":"center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[ht]}for(var De=!1,Oe=["x","y"],Ve=0;Ve<Oe.length;Ve++){var Fe,ze,Re,We,$e,at=Oe[Ve],gt=x[at+"ref"]||at,xt=x["a"+at+"ref"],mt={x:b,y:T}[at],nt=(Z+(at==="x"?0:-90))*Math.PI/180,Qe=we*Math.cos(nt),vt=de*Math.sin(nt),jt=Math.abs(Qe)+Math.abs(vt),Gt=x[at+"anchor"],$t=x[at+"shift"]*(at==="x"?1:-1),Zt=V[at],cr=t.getRefType(gt);if(mt&&cr!=="domain"){var Dt=mt.r2fraction(x[at]);(Dt<0||Dt>1)&&(xt===gt?((Dt=mt.r2fraction(x["a"+at]))<0||Dt>1)&&(De=!0):De=!0),Fe=mt._offset+mt.r2p(x[at]),We=.5}else{var Ne=cr==="domain";at==="x"?(Re=x[at],Fe=Ne?mt._offset+mt._length*Re:Fe=I.l+I.w*Re):(Re=1-x[at],Fe=Ne?mt._offset+mt._length*Re:Fe=I.t+I.h*Re),We=x.showarrow?.5:Re}if(x.showarrow){Zt.head=Fe;var Ye=x["a"+at];if($e=Qe*Ie(.5,x.xanchor)-vt*Ie(.5,x.yanchor),xt===gt){var pe=t.getRefType(xt);pe==="domain"?(at==="y"&&(Ye=1-Ye),Zt.tail=mt._offset+mt._length*Ye):pe==="paper"?at==="y"?(Ye=1-Ye,Zt.tail=I.t+I.h*Ye):Zt.tail=I.l+I.w*Ye:Zt.tail=mt._offset+mt.r2p(Ye),ze=$e}else Zt.tail=Fe+Ye,ze=$e+Ye;Zt.text=Zt.tail+$e;var _e=A[at==="x"?"width":"height"];if(gt==="paper"&&(Zt.head=y.constrain(Zt.head,1,_e-1)),xt==="pixel"){var Be=-Math.max(Zt.tail-3,Zt.text),He=Math.min(Zt.tail+3,Zt.text)-_e;Be>0?(Zt.tail+=Be,Zt.text+=Be):He>0&&(Zt.tail-=He,Zt.text-=He)}Zt.tail+=$t,Zt.head+=$t}else ze=$e=jt*Ie(We,Gt),Zt.text=Fe+$e;Zt.text+=$t,$e+=$t,ze+=$t,x["_"+at+"padplus"]=jt/2+ze,x["_"+at+"padminus"]=jt/2-ze,x["_"+at+"size"]=jt,x["_"+at+"shift"]=$e}if(De)H.remove();else{var Je=0,Ze=0;if(x.align!=="left"&&(Je=(ve-Te)*(x.align==="center"?.5:1)),x.valign!=="top"&&(Ze=(Me-le)*(x.valign==="middle"?.5:1)),fe)Se.select("svg").attr({x:te+Je-1,y:te+Ze}).call(o.setClipUrl,K?j:null,i);else{var ct=te+Ze-ge.top,lt=te+Je-ge.left;se.call(g.positionText,lt,ct).call(o.setClipUrl,K?j:null,i)}J.select("rect").call(o.setRect,te,te,ve,Me),B.call(o.setRect,N/2,N/2,we-N,de-N),H.call(o.setTranslate,Math.round(V.x.text-we/2),Math.round(V.y.text-de/2)),X.attr({transform:"rotate("+Z+","+V.x.text+","+V.y.text+")"});var At,Ot=function(it,ht){Q.selectAll(".annotation-arrow-g").remove();var Ut=V.x.head,Mt=V.y.head,It=V.x.tail+it,Le=V.y.tail+ht,Xe=V.x.text+it,ot=V.y.text+ht,pt=y.rotationXYMatrix(Z,Xe,ot),St=y.apply2DTransform(pt),Vt=y.apply2DTransform2(pt),Jt=+B.attr("width"),qt=+B.attr("height"),gr=Xe-.5*Jt,Cr=gr+Jt,mr=ot-.5*qt,tr=mr+qt,nr=[[gr,mr,gr,tr],[gr,tr,Cr,tr],[Cr,tr,Cr,mr],[Cr,mr,gr,mr]].map(Vt);if(!nr.reduce(function(Tn,Mn){return Tn^!!y.segmentsIntersect(Ut,Mt,Ut+1e6,Mt+1e6,Mn[0],Mn[1],Mn[2],Mn[3])},!1)){nr.forEach(function(Tn){var Mn=y.segmentsIntersect(It,Le,Ut,Mt,Tn[0],Tn[1],Tn[2],Tn[3]);Mn&&(It=Mn.x,Le=Mn.y)});var Qt=x.arrowwidth,dr=x.arrowcolor,_r=x.arrowside,Ir=Q.append("g").style({opacity:n.opacity(dr)}).classed("annotation-arrow-g",!0),Rr=Ir.append("path").attr("d","M"+It+","+Le+"L"+Ut+","+Mt).style("stroke-width",Qt+"px").call(n.stroke,n.rgb(dr));if(l(Rr,_r,x),P.annotationPosition&&Rr.node().parentNode&&!_){var Vr=Ut,Xr=Mt;if(x.standoff){var cn=Math.sqrt(Math.pow(Ut-It,2)+Math.pow(Mt-Le,2));Vr+=x.standoff*(It-Ut)/cn,Xr+=x.standoff*(Le-Mt)/cn}var an,zn,on=Ir.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(It-Vr)+","+(Le-Xr),transform:e(Vr,Xr)}).style("stroke-width",Qt+6+"px").call(n.stroke,"rgba(0,0,0,0)").call(n.fill,"rgba(0,0,0,0)");a.init({element:on.node(),gd:i,prepFn:function(){var Tn=o.getTranslate(H);an=Tn.x,zn=Tn.y,b&&b.autorange&&E(b._name+".autorange",!0),T&&T.autorange&&E(T._name+".autorange",!0)},moveFn:function(Tn,Mn){var ei=St(an,zn),Hr=ei[0]+Tn,ln=ei[1]+Mn;H.call(o.setTranslate,Hr,ln),z("x",p(b,Tn,"x",I,x)),z("y",p(T,Mn,"y",I,x)),x.axref===x.xref&&z("ax",p(b,Tn,"ax",I,x)),x.ayref===x.yref&&z("ay",p(T,Mn,"ay",I,x)),Ir.attr("transform",e(Tn,Mn)),X.attr({transform:"rotate("+Z+","+Hr+","+ln+")"})},doneFn:function(){v.call("_guiRelayout",i,D());var Tn=document.querySelector(".js-notes-box-panel");Tn&&Tn.redraw(Tn.selectedObj)}})}}};x.showarrow&&Ot(0,0),$&&a.init({element:H.node(),gd:i,prepFn:function(){At=X.attr("transform")},moveFn:function(it,ht){var Ut="pointer";if(x.showarrow)x.axref===x.xref?z("ax",p(b,it,"ax",I,x)):z("ax",x.ax+it),x.ayref===x.yref?z("ay",p(T,ht,"ay",I.w,x)):z("ay",x.ay+ht),Ot(it,ht);else{if(_)return;var Mt,It;if(b)Mt=p(b,it,"x",I,x);else{var Le=x._xsize/I.w,Xe=x.x+(x._xshift-x.xshift)/I.w-Le/2;Mt=a.align(Xe+it/I.w,Le,0,1,x.xanchor)}if(T)It=p(T,ht,"y",I,x);else{var ot=x._ysize/I.h,pt=x.y-(x._yshift+x.yshift)/I.h-ot/2;It=a.align(pt-ht/I.h,ot,0,1,x.yanchor)}z("x",Mt),z("y",It),b&&T||(Ut=a.getCursor(b?.5:Mt,T?.5:It,x.xanchor,x.yanchor))}X.attr({transform:e(it,ht)+At}),c(H,Ut)},clickFn:function(it,ht){x.captureevents&&i.emit("plotly_clickannotation",oe(ht))},doneFn:function(){c(H),v.call("_guiRelayout",i,D());var it=document.querySelector(".js-notes-box-panel");it&&it.redraw(it.selectedObj)}})}}}G.exports={draw:function(i){var x=i._fullLayout;x._infolayer.selectAll(".annotation").remove();for(var f=0;f<x.annotations.length;f++)x.annotations[f].visible&&s(i,f);return w.previousPromises(i)},drawOne:s,drawRaw:u}},{"../../lib":515,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/cartesian/axes":566,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../fx":407,"./draw_arrow_head":357,"@plotly/d3":58}],357:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../color"),w=m("./arrow_paths"),y=m("../../lib"),e=y.strScale,t=y.strRotate,n=y.strTranslate;G.exports=function(o,r,g){var c,a,h,l,s=o.node(),p=w[g.arrowhead||0],u=w[g.startarrowhead||0],i=(g.arrowwidth||1)*(g.arrowsize||1),x=(g.arrowwidth||1)*(g.startarrowsize||1),f=r.indexOf("start")>=0,_=r.indexOf("end")>=0,b=p.backoff*i+g.standoff,T=u.backoff*x+g.startstandoff;if(s.nodeName==="line"){c={x:+o.attr("x1"),y:+o.attr("y1")},a={x:+o.attr("x2"),y:+o.attr("y2")};var k=c.x-a.x,L=c.y-a.y;if(l=(h=Math.atan2(L,k))+Math.PI,b&&T&&b+T>Math.sqrt(k*k+L*L))return void Q();if(b){if(b*b>k*k+L*L)return void Q();var A=b*Math.cos(h),I=b*Math.sin(h);a.x+=A,a.y+=I,o.attr({x2:a.x,y2:a.y})}if(T){if(T*T>k*k+L*L)return void Q();var P=T*Math.cos(h),S=T*Math.sin(h);c.x-=P,c.y-=S,o.attr({x1:c.x,y1:c.y})}}else if(s.nodeName==="path"){var E=s.getTotalLength(),z="";if(E<b+T)return void Q();var D=s.getPointAtLength(0),j=s.getPointAtLength(.1);h=Math.atan2(D.y-j.y,D.x-j.x),c=s.getPointAtLength(Math.min(T,E)),z="0px,"+T+"px,";var V=s.getPointAtLength(E),Z=s.getPointAtLength(E-.1);l=Math.atan2(V.y-Z.y,V.x-Z.x),a=s.getPointAtLength(Math.max(0,E-b)),z+=E-(z?T+b:b)+"px,"+E+"px",o.style("stroke-dasharray",z)}function Q(){o.style("stroke-dasharray","0px,100px")}function X($,re,H,N){$.path&&($.noRotate&&(H=0),d.select(s.parentNode).append("path").attr({class:o.attr("class"),d:$.path,transform:n(re.x,re.y)+t(180*H/Math.PI)+e(N)}).style({fill:v.rgb(g.arrowcolor),"stroke-width":0}))}f&&X(u,c,h,x),_&&X(p,a,l,i)}},{"../../lib":515,"../color":367,"./arrow_paths":349,"@plotly/d3":58}],358:[function(m,G,Y){var d=m("./draw"),v=m("./click");G.exports={moduleType:"component",name:"annotations",layoutAttributes:m("./attributes"),supplyLayoutDefaults:m("./defaults"),includeBasePlot:m("../../plots/cartesian/include_components")("annotations"),calcAutorange:m("./calc_autorange"),draw:d.draw,drawOne:d.drawOne,drawRaw:d.drawRaw,hasClickToShow:v.hasClickToShow,onClick:v.onClick,convertCoords:m("./convert_coords")}},{"../../plots/cartesian/include_components":577,"./attributes":350,"./calc_autorange":351,"./click":352,"./convert_coords":354,"./defaults":355,"./draw":356}],359:[function(m,G,Y){var d=m("../annotations/attributes"),v=m("../../plot_api/edit_types").overrideAll,w=m("../../plot_api/plot_template").templatedArray;G.exports=v(w("annotation",{visible:d.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:d.xanchor,xshift:d.xshift,yanchor:d.yanchor,yshift:d.yshift,text:d.text,textangle:d.textangle,font:d.font,width:d.width,height:d.height,opacity:d.opacity,align:d.align,valign:d.valign,bgcolor:d.bgcolor,bordercolor:d.bordercolor,borderpad:d.borderpad,borderwidth:d.borderwidth,showarrow:d.showarrow,arrowcolor:d.arrowcolor,arrowhead:d.arrowhead,startarrowhead:d.startarrowhead,arrowside:d.arrowside,arrowsize:d.arrowsize,startarrowsize:d.startarrowsize,arrowwidth:d.arrowwidth,standoff:d.standoff,startstandoff:d.startstandoff,hovertext:d.hovertext,hoverlabel:d.hoverlabel,captureevents:d.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../annotations/attributes":350}],360:[function(m,G,Y){var d=m("../../lib"),v=m("../../plots/cartesian/axes");function w(y,e){var t=e.fullSceneLayout.domain,n=e.fullLayout._size,o={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};y._xa={},d.extendFlat(y._xa,o),v.setConvert(y._xa),y._xa._offset=n.l+t.x[0]*n.w,y._xa.l2p=function(){return .5*(1+y._pdata[0]/y._pdata[3])*n.w*(t.x[1]-t.x[0])},y._ya={},d.extendFlat(y._ya,o),v.setConvert(y._ya),y._ya._offset=n.t+(1-t.y[1])*n.h,y._ya.l2p=function(){return .5*(1-y._pdata[1]/y._pdata[3])*n.h*(t.y[1]-t.y[0])}}G.exports=function(y){for(var e=y.fullSceneLayout.annotations,t=0;t<e.length;t++)w(e[t],y);y.fullLayout._infolayer.selectAll(".annotation-"+y.id).remove()}},{"../../lib":515,"../../plots/cartesian/axes":566}],361:[function(m,G,Y){var d=m("../../lib"),v=m("../../plots/cartesian/axes"),w=m("../../plots/array_container_defaults"),y=m("../annotations/common_defaults"),e=m("./attributes");function t(n,o,r,g){function c(h,l){return d.coerce(n,o,e,h,l)}function a(h){var l=h+"axis",s={_fullLayout:{}};return s._fullLayout[l]=r[l],v.coercePosition(o,s,c,h,h,.5)}c("visible")&&(y(n,o,g.fullLayout,c),a("x"),a("y"),a("z"),d.noneOrAll(n,o,["x","y","z"]),o.xref="x",o.yref="y",o.zref="z",c("xanchor"),c("yanchor"),c("xshift"),c("yshift"),o.showarrow&&(o.axref="pixel",o.ayref="pixel",c("ax",-10),c("ay",-30),d.noneOrAll(n,o,["ax","ay"])))}G.exports=function(n,o,r){w(n,o,{name:"annotations",handleItemDefaults:t,fullLayout:r.fullLayout})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../annotations/common_defaults":353,"./attributes":359}],362:[function(m,G,Y){var d=m("../annotations/draw").drawRaw,v=m("../../plots/gl3d/project"),w=["x","y","z"];G.exports=function(y){for(var e=y.fullSceneLayout,t=y.dataScale,n=e.annotations,o=0;o<n.length;o++){for(var r=n[o],g=!1,c=0;c<3;c++){var a=w[c],h=r[a],l=e[a+"axis"].r2fraction(h);if(l<0||l>1){g=!0;break}}g?y.fullLayout._infolayer.select(".annotation-"+y.id+'[data-index="'+o+'"]').remove():(r._pdata=v(y.glplot.cameraParams,[e.xaxis.r2l(r.x)*t[0],e.yaxis.r2l(r.y)*t[1],e.zaxis.r2l(r.z)*t[2]]),d(y.graphDiv,r,o,y.id,r._xa,r._ya))}}},{"../../plots/gl3d/project":616,"../annotations/draw":356}],363:[function(m,G,Y){var d=m("../../registry"),v=m("../../lib");G.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:m("./attributes")}}},layoutAttributes:m("./attributes"),handleDefaults:m("./defaults"),includeBasePlot:function(w,y){var e=d.subplotsRegistry.gl3d;if(!!e)for(var t=e.attrRegex,n=Object.keys(w),o=0;o<n.length;o++){var r=n[o];t.test(r)&&(w[r].annotations||[]).length&&(v.pushUnique(y._basePlotModules,e),v.pushUnique(y._subplots.gl3d,r))}},convert:m("./convert"),draw:m("./draw")}},{"../../lib":515,"../../registry":647,"./attributes":359,"./convert":360,"./defaults":361,"./draw":362}],364:[function(m,G,Y){G.exports=m("world-calendars/dist/main"),m("world-calendars/dist/plus"),m("world-calendars/dist/calendars/chinese"),m("world-calendars/dist/calendars/coptic"),m("world-calendars/dist/calendars/discworld"),m("world-calendars/dist/calendars/ethiopian"),m("world-calendars/dist/calendars/hebrew"),m("world-calendars/dist/calendars/islamic"),m("world-calendars/dist/calendars/julian"),m("world-calendars/dist/calendars/mayan"),m("world-calendars/dist/calendars/nanakshahi"),m("world-calendars/dist/calendars/nepali"),m("world-calendars/dist/calendars/persian"),m("world-calendars/dist/calendars/taiwan"),m("world-calendars/dist/calendars/thai"),m("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":333,"world-calendars/dist/calendars/coptic":334,"world-calendars/dist/calendars/discworld":335,"world-calendars/dist/calendars/ethiopian":336,"world-calendars/dist/calendars/hebrew":337,"world-calendars/dist/calendars/islamic":338,"world-calendars/dist/calendars/julian":339,"world-calendars/dist/calendars/mayan":340,"world-calendars/dist/calendars/nanakshahi":341,"world-calendars/dist/calendars/nepali":342,"world-calendars/dist/calendars/persian":343,"world-calendars/dist/calendars/taiwan":344,"world-calendars/dist/calendars/thai":345,"world-calendars/dist/calendars/ummalqura":346,"world-calendars/dist/main":347,"world-calendars/dist/plus":348}],365:[function(m,G,Y){var d=m("./calendars"),v=m("../../lib"),w=m("../../constants/numerical"),y=w.EPOCHJD,e=w.ONEDAY,t={valType:"enumerated",values:v.sortObjectKeys(d.calendars),editType:"calc",dflt:"gregorian"},n=function(u,i,x,f){var _={};return _[x]=t,v.coerce(u,i,_,x,f)},o={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:"##",w:"##",c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}},r={};function g(u){var i=r[u];return i||(i=r[u]=d.instance(u))}function c(u){return v.extendFlat({},t,{description:u})}function a(u){return"Sets the calendar system to use with `"+u+"` date data."}var h={xcalendar:c(a("x"))},l=v.extendFlat({},h,{ycalendar:c(a("y"))}),s=v.extendFlat({},l,{zcalendar:c(a("z"))}),p=c(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));G.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:l,bar:l,box:l,heatmap:l,contour:l,histogram:l,histogram2d:l,histogram2dcontour:l,scatter3d:s,surface:s,mesh3d:s,scattergl:l,ohlc:h,candlestick:h},layout:{calendar:c(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:p},yaxis:{calendar:p},scene:{xaxis:{calendar:p},yaxis:{calendar:p},zaxis:{calendar:p}},polar:{radialaxis:{calendar:p}}},transforms:{filter:{valuecalendar:c(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:c(["WARNING: All transforms are deprecated and may be removed from the API in next major version.","Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:t,handleDefaults:n,handleTraceDefaults:function(u,i,x,f){for(var _=0;_<x.length;_++)n(u,i,x[_]+"calendar",f.calendar)},CANONICAL_SUNDAY:{chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},CANONICAL_TICK:{chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},DFLTRANGE:{chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},getCal:g,worldCalFmt:function(u,i,x){for(var f,_,b,T,k,L=Math.floor((i+.05)/e)+y,A=g(x).fromJD(L),I=0;(I=u.indexOf("%",I))!==-1;)(f=u.charAt(I+1))==="0"||f==="-"||f==="_"?(b=3,_=u.charAt(I+2),f==="_"&&(f="-")):(_=f,f="0",b=2),(T=o[_])?(k=T==="##"?"##":A.formatDate(T[f]),u=u.substr(0,I)+k+u.substr(I+b),I+=k.length):I+=b;return u}}},{"../../constants/numerical":491,"../../lib":515,"./calendars":364}],366:[function(m,G,Y){Y.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],Y.defaultLine="#444",Y.lightLine="#eee",Y.background="#fff",Y.borderLine="#BEC8D9",Y.lightFraction=1e3/11},{}],367:[function(m,G,Y){var d=m("tinycolor2"),v=m("fast-isnumeric"),w=m("../../lib/array").isTypedArray,y=G.exports={},e=m("./attributes");y.defaults=e.defaults;var t=y.defaultLine=e.defaultLine;y.lightLine=e.lightLine;var n=y.background=e.background;function o(r){if(v(r)||typeof r!="string")return r;var g=r.trim();if(g.substr(0,3)!=="rgb")return r;var c=g.match(/^rgba?\s*\(([^()]*)\)$/);if(!c)return r;var a=c[1].trim().split(/\s*[\s,]\s*/),h=g.charAt(3)==="a"&&a.length===4;if(!h&&a.length!==3)return r;for(var l=0;l<a.length;l++){if(!a[l].length||(a[l]=Number(a[l]),!(a[l]>=0)))return r;if(l===3)a[l]>1&&(a[l]=1);else if(a[l]>=1)return r}var s=Math.round(255*a[0])+", "+Math.round(255*a[1])+", "+Math.round(255*a[2]);return h?"rgba("+s+", "+a[3]+")":"rgb("+s+")"}y.tinyRGB=function(r){var g=r.toRgb();return"rgb("+Math.round(g.r)+", "+Math.round(g.g)+", "+Math.round(g.b)+")"},y.rgb=function(r){return y.tinyRGB(d(r))},y.opacity=function(r){return r?d(r).getAlpha():0},y.addOpacity=function(r,g){var c=d(r).toRgb();return"rgba("+Math.round(c.r)+", "+Math.round(c.g)+", "+Math.round(c.b)+", "+g+")"},y.combine=function(r,g){var c=d(r).toRgb();if(c.a===1)return d(r).toRgbString();var a=d(g||n).toRgb(),h=a.a===1?a:{r:255*(1-a.a)+a.r*a.a,g:255*(1-a.a)+a.g*a.a,b:255*(1-a.a)+a.b*a.a},l={r:h.r*(1-c.a)+c.r*c.a,g:h.g*(1-c.a)+c.g*c.a,b:h.b*(1-c.a)+c.b*c.a};return d(l).toRgbString()},y.contrast=function(r,g,c){var a=d(r);return a.getAlpha()!==1&&(a=d(y.combine(r,n))),(a.isDark()?g?a.lighten(g):n:c?a.darken(c):t).toString()},y.stroke=function(r,g){var c=d(g);r.style({stroke:y.tinyRGB(c),"stroke-opacity":c.getAlpha()})},y.fill=function(r,g){var c=d(g);r.style({fill:y.tinyRGB(c),"fill-opacity":c.getAlpha()})},y.clean=function(r){if(r&&typeof r=="object"){var g,c,a,h,l=Object.keys(r);for(g=0;g<l.length;g++)if(h=r[a=l[g]],a.substr(a.length-5)==="color")if(Array.isArray(h))for(c=0;c<h.length;c++)h[c]=o(h[c]);else r[a]=o(h);else if(a.substr(a.length-10)==="colorscale"&&Array.isArray(h))for(c=0;c<h.length;c++)Array.isArray(h[c])&&(h[c][1]=o(h[c][1]));else if(Array.isArray(h)){var s=h[0];if(!Array.isArray(s)&&s&&typeof s=="object")for(c=0;c<h.length;c++)y.clean(h[c])}else h&&typeof h=="object"&&!w(h)&&y.clean(h)}}},{"../../lib/array":497,"./attributes":366,"fast-isnumeric":190,tinycolor2:313}],368:[function(m,G,Y){var d=m("../../plots/cartesian/layout_attributes"),v=m("../../plots/font_attributes"),w=m("../../lib/extend").extendFlat,y=m("../../plot_api/edit_types").overrideAll;G.exports=y({orientation:{valType:"enumerated",values:["h","v"],dflt:"v"},thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"]},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"]},ypad:{valType:"number",min:0,dflt:10},outlinecolor:d.linecolor,outlinewidth:d.linewidth,bordercolor:d.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:d.tickmode,nticks:d.nticks,tick0:d.tick0,dtick:d.dtick,tickvals:d.tickvals,ticktext:d.ticktext,ticks:w({},d.ticks,{dflt:""}),ticklabeloverflow:w({},d.ticklabeloverflow,{}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside"},ticklen:d.ticklen,tickwidth:d.tickwidth,tickcolor:d.tickcolor,ticklabelstep:d.ticklabelstep,showticklabels:d.showticklabels,tickfont:v({}),tickangle:d.tickangle,tickformat:d.tickformat,tickformatstops:d.tickformatstops,tickprefix:d.tickprefix,showtickprefix:d.showtickprefix,ticksuffix:d.ticksuffix,showticksuffix:d.showticksuffix,separatethousands:d.separatethousands,exponentformat:d.exponentformat,minexponent:d.minexponent,showexponent:d.showexponent,title:{text:{valType:"string"},font:v({}),side:{valType:"enumerated",values:["right","top","bottom"]}},_deprecated:{title:{valType:"string"},titlefont:v({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/layout_attributes":579,"../../plots/font_attributes":594}],369:[function(m,G,Y){G.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],370:[function(m,G,Y){var d=m("../../lib"),v=m("../../plot_api/plot_template"),w=m("../../plots/cartesian/tick_value_defaults"),y=m("../../plots/cartesian/tick_mark_defaults"),e=m("../../plots/cartesian/tick_label_defaults"),t=m("../../plots/cartesian/prefix_suffix_defaults"),n=m("./attributes");G.exports=function(o,r,g){var c=v.newContainer(r,"colorbar"),a=o.colorbar||{};function h(L,A){return d.coerce(a,c,n,L,A)}var l=g.margin||{t:0,b:0,l:0,r:0},s=g.width-l.l-l.r,p=g.height-l.t-l.b,u=h("orientation")==="v",i=h("thicknessmode");h("thickness",i==="fraction"?30/(u?s:p):30);var x=h("lenmode");h("len",x==="fraction"?1:u?p:s),h("x",u?1.02:.5),h("xanchor",u?"left":"center"),h("xpad"),h("y",u?.5:1.02),h("yanchor",u?"middle":"bottom"),h("ypad"),d.noneOrAll(a,c,["x","y"]),h("outlinecolor"),h("outlinewidth"),h("bordercolor"),h("borderwidth"),h("bgcolor");var f=d.coerce(a,c,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:u?["outside","inside","outside top","inside top","outside bottom","inside bottom"]:["outside","inside","outside left","inside left","outside right","inside right"]}},"ticklabelposition");h("ticklabeloverflow",f.indexOf("inside")!==-1?"hide past domain":"hide past div"),w(a,c,h,"linear");var _=g.font,b={outerTicks:!1,font:_};f.indexOf("inside")!==-1&&(b.bgColor="black"),t(a,c,h,"linear",b),e(a,c,h,"linear",b),y(a,c,h,"linear",b),h("title.text",g._dfltTitle.colorbar);var T=c.tickfont,k=d.extendFlat({},T,{color:_.color,size:d.bigFont(T.size)});d.coerceFont(h,"title.font",k),h("title.side",u?"top":"right")}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_mark_defaults":588,"../../plots/cartesian/tick_value_defaults":589,"./attributes":368}],371:[function(m,G,Y){var d=m("@plotly/d3"),v=m("tinycolor2"),w=m("../../plots/plots"),y=m("../../registry"),e=m("../../plots/cartesian/axes"),t=m("../dragelement"),n=m("../../lib"),o=n.strTranslate,r=m("../../lib/extend").extendFlat,g=m("../../lib/setcursor"),c=m("../drawing"),a=m("../color"),h=m("../titles"),l=m("../../lib/svg_text_utils"),s=m("../colorscale/helpers").flipScale,p=m("../../plots/cartesian/axis_defaults"),u=m("../../plots/cartesian/position_defaults"),i=m("../../plots/cartesian/layout_attributes"),x=m("../../constants/alignment"),f=x.LINE_SPACING,_=x.FROM_TL,b=x.FROM_BR,T=m("./constants").cn;G.exports={draw:function(k){var L=k._fullLayout._infolayer.selectAll("g."+T.colorbar).data(function(A){var I,P,S,E,z=A._fullLayout,D=A.calcdata,j=[];function V(K){return r(K,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function Z(){typeof E.calc=="function"?E.calc(A,S,I):(I._fillgradient=P.reversescale?s(P.colorscale):P.colorscale,I._zrange=[P[E.min],P[E.max]])}for(var Q=0;Q<D.length;Q++){var X=D[Q],$=(S=X[0].trace)._module.colorbar;if(S.visible===!0&&$)for(var re=Array.isArray($),H=re?$:[$],N=0;N<H.length;N++){var U=(E=H[N]).container;(P=U?S[U]:S)&&P.showscale&&((I=V(P.colorbar))._id="cb"+S.uid+(re&&U?"-"+U:""),I._traceIndex=S.index,I._propPrefix=(U?U+".":"")+"colorbar.",I._meta=S._meta,Z(),j.push(I))}}for(var te in z._colorAxes)if((P=z[te]).showscale){var B=z._colorAxes[te];(I=V(P.colorbar))._id="cb"+te,I._propPrefix=te+".colorbar.",I._meta=z._meta,E={min:"cmin",max:"cmax"},B[0]!=="heatmap"&&(S=B[1],E.calc=S._module.colorbar.calc),Z(),j.push(I)}return j}(k),function(A){return A._id});L.enter().append("g").attr("class",function(A){return A._id}).classed(T.colorbar,!0),L.each(function(A){var I=d.select(this);n.ensureSingle(I,"rect",T.cbbg),n.ensureSingle(I,"g",T.cbfills),n.ensureSingle(I,"g",T.cblines),n.ensureSingle(I,"g",T.cbaxis,function(S){S.classed(T.crisp,!0)}),n.ensureSingle(I,"g",T.cbtitleunshift,function(S){S.append("g").classed(T.cbtitle,!0)}),n.ensureSingle(I,"rect",T.cboutline);var P=function(S,E,z){var D=E.orientation==="v",j=E.len,V=E.lenmode,Z=E.thickness,Q=E.thicknessmode,X=E.outlinewidth,$=E.borderwidth,re=E.bgcolor,H=E.xanchor,N=E.yanchor,U=E.xpad,te=E.ypad,B=E.x,K=D?E.y:1-E.y,J=z._fullLayout,ee=J._size,ne=E._fillcolor,se=E._line,oe=E.title,me=oe.side,ce=E._zrange||d.extent((typeof ne=="function"?ne:se.color).domain()),ye=typeof se.color=="function"?se.color:function(){return se.color},Se=typeof ne=="function"?ne:function(){return ne},fe=E._levels,ge=function(cr,Dt,Ne){var Ye,pe,_e=Dt._levels,Be=[],He=[],Je=_e.end+_e.size/100,Ze=_e.size,ct=1.001*Ne[0]-.001*Ne[1],lt=1.001*Ne[1]-.001*Ne[0];for(pe=0;pe<1e5&&(Ye=_e.start+pe*Ze,!(Ze>0?Ye>=Je:Ye<=Je));pe++)Ye>ct&&Ye<lt&&Be.push(Ye);if(Dt._fillgradient)He=[0];else if(typeof Dt._fillcolor=="function"){var At=Dt._filllevels;if(At)for(Je=At.end+At.size/100,Ze=At.size,pe=0;pe<1e5&&(Ye=At.start+pe*Ze,!(Ze>0?Ye>=Je:Ye<=Je));pe++)Ye>Ne[0]&&Ye<Ne[1]&&He.push(Ye);else(He=Be.map(function(Ot){return Ot-_e.size/2})).push(He[He.length-1]+_e.size)}else Dt._fillcolor&&typeof Dt._fillcolor=="string"&&(He=[0]);return _e.size<0&&(Be.reverse(),He.reverse()),{line:Be,fill:He}}(0,E,ce),Te=ge.fill,le=ge.line,ve=Math.round(Z*(Q==="fraction"?D?ee.w:ee.h:1)),Me=ve/(D?ee.w:ee.h),we=Math.round(j*(V==="fraction"?D?ee.h:ee.w:1)),de=we/(D?ee.h:ee.w),Ie=Math.round(D?B*ee.w+U:K*ee.h+te),De={center:.5,right:1}[H]||0,Oe={top:1,middle:.5}[N]||0,Ve=D?B-De*Me:K-Oe*Me,Fe=D?K-Oe*de:B-De*de,ze=Math.round(D?ee.h*(1-Fe):ee.w*Fe);E._lenFrac=de,E._thickFrac=Me,E._uFrac=Ve,E._vFrac=Fe;var Re=E._axis=function(cr,Dt,Ne){var Ye=cr._fullLayout,pe=Dt.orientation==="v",_e={type:"linear",range:Ne,tickmode:Dt.tickmode,nticks:Dt.nticks,tick0:Dt.tick0,dtick:Dt.dtick,tickvals:Dt.tickvals,ticktext:Dt.ticktext,ticks:Dt.ticks,ticklen:Dt.ticklen,tickwidth:Dt.tickwidth,tickcolor:Dt.tickcolor,showticklabels:Dt.showticklabels,ticklabelposition:Dt.ticklabelposition,ticklabeloverflow:Dt.ticklabeloverflow,ticklabelstep:Dt.ticklabelstep,tickfont:Dt.tickfont,tickangle:Dt.tickangle,tickformat:Dt.tickformat,exponentformat:Dt.exponentformat,minexponent:Dt.minexponent,separatethousands:Dt.separatethousands,showexponent:Dt.showexponent,showtickprefix:Dt.showtickprefix,tickprefix:Dt.tickprefix,showticksuffix:Dt.showticksuffix,ticksuffix:Dt.ticksuffix,title:Dt.title,showline:!0,anchor:"free",side:pe?"right":"bottom",position:1},Be=pe?"y":"x",He={type:"linear",_id:Be+Dt._id},Je={letter:Be,font:Ye.font,noHover:!0,noTickson:!0,noTicklabelmode:!0,calendar:Ye.calendar};function Ze(ct,lt){return n.coerce(_e,He,i,ct,lt)}return p(_e,He,Ze,Je,Ye),u(_e,He,Ze,Je),He}(z,E,ce);Re.position=Me+(D?B+U/ee.w:K+te/ee.h);var We=["top","bottom"].indexOf(me)!==-1;if(D&&We&&(Re.title.side=me,Re.titlex=B+U/ee.w,Re.titley=Fe+(oe.side==="top"?de-te/ee.h:te/ee.h)),D||We||(Re.title.side=me,Re.titley=K+te/ee.h,Re.titlex=Fe+U/ee.w),se.color&&E.tickmode==="auto"){Re.tickmode="linear",Re.tick0=fe.start;var $e=fe.size,at=n.constrain(we/50,4,15)+1,gt=(ce[1]-ce[0])/((E.nticks||at)*$e);if(gt>1){var xt=Math.pow(10,Math.floor(Math.log(gt)/Math.LN10));$e*=xt*n.roundUp(gt/xt,[2,5,10]),(Math.abs(fe.start)/fe.size+1e-6)%1<2e-6&&(Re.tick0=0)}Re.dtick=$e}Re.domain=D?[Fe+te/ee.h,Fe+de-te/ee.h]:[Fe+U/ee.w,Fe+de-U/ee.w],Re.setScale(),S.attr("transform",o(Math.round(ee.l),Math.round(ee.t)));var mt,nt=S.select("."+T.cbtitleunshift).attr("transform",o(-Math.round(ee.l),-Math.round(ee.t))),Qe=Re.ticklabelposition,vt=Re.title.font.size,jt=S.select("."+T.cbaxis),Gt=0,$t=0;function Zt(cr,Dt){var Ne={propContainer:Re,propName:E._propPrefix+"title",traceIndex:E._traceIndex,_meta:E._meta,placeholder:J._dfltTitle.colorbar,containerGroup:S.select("."+T.cbtitle)},Ye=cr.charAt(0)==="h"?cr.substr(1):"h"+cr;S.selectAll("."+Ye+",."+Ye+"-math-group").remove(),h.draw(z,cr,r(Ne,Dt||{}))}return n.syncOrAsync([w.previousPromises,function(){var cr,Dt;(D&&We||!D&&!We)&&(me==="top"&&(cr=U+ee.l+ee.w*B,Dt=te+ee.t+ee.h*(1-Fe-de)+3+.75*vt),me==="bottom"&&(cr=U+ee.l+ee.w*B,Dt=te+ee.t+ee.h*(1-Fe)-3-.25*vt),me==="right"&&(Dt=te+ee.t+ee.h*K+3+.75*vt,cr=U+ee.l+ee.w*Fe),Zt(Re._id+"title",{attributes:{x:cr,y:Dt,"text-anchor":D?"start":"middle"}}))},function(){if(!D&&!We||D&&We){var cr,Dt=S.select("."+T.cbtitle),Ne=Dt.select("text"),Ye=[-X/2,X/2],pe=Dt.select(".h"+Re._id+"title-math-group").node(),_e=15.6;if(Ne.node()&&(_e=parseInt(Ne.node().style.fontSize,10)*f),pe?(cr=c.bBox(pe),$t=cr.width,(Gt=cr.height)>_e&&(Ye[1]-=(Gt-_e)/2)):Ne.node()&&!Ne.classed(T.jsPlaceholder)&&(cr=c.bBox(Ne.node()),$t=cr.width,Gt=cr.height),D){if(Gt){if(Gt+=5,me==="top")Re.domain[1]-=Gt/ee.h,Ye[1]*=-1;else{Re.domain[0]+=Gt/ee.h;var Be=l.lineCount(Ne);Ye[1]+=(1-Be)*_e}Dt.attr("transform",o(Ye[0],Ye[1])),Re.setScale()}}else $t&&(me==="right"&&(Re.domain[0]+=($t+vt/2)/ee.w),Dt.attr("transform",o(Ye[0],Ye[1])),Re.setScale())}S.selectAll("."+T.cbfills+",."+T.cblines).attr("transform",D?o(0,Math.round(ee.h*(1-Re.domain[1]))):o(Math.round(ee.w*Re.domain[0]),0)),jt.attr("transform",D?o(0,Math.round(-ee.t)):o(Math.round(-ee.l),0));var He=S.select("."+T.cbfills).selectAll("rect."+T.cbfill).attr("style","").data(Te);He.enter().append("rect").classed(T.cbfill,!0).style("stroke","none"),He.exit().remove();var Je=ce.map(Re.c2p).map(Math.round).sort(function(Ot,it){return Ot-it});He.each(function(Ot,it){var ht=[it===0?ce[0]:(Te[it]+Te[it-1])/2,it===Te.length-1?ce[1]:(Te[it]+Te[it+1])/2].map(Re.c2p).map(Math.round);D&&(ht[1]=n.constrain(ht[1]+(ht[1]>ht[0])?1:-1,Je[0],Je[1]));var Ut=d.select(this).attr(D?"x":"y",Ie).attr(D?"y":"x",d.min(ht)).attr(D?"width":"height",Math.max(ve,2)).attr(D?"height":"width",Math.max(d.max(ht)-d.min(ht),2));if(E._fillgradient)c.gradient(Ut,z,E._id,D?"vertical":"horizontalreversed",E._fillgradient,"fill");else{var Mt=Se(Ot).replace("e-","");Ut.attr("fill",v(Mt).toHexString())}});var Ze=S.select("."+T.cblines).selectAll("path."+T.cbline).data(se.color&&se.width?le:[]);Ze.enter().append("path").classed(T.cbline,!0),Ze.exit().remove(),Ze.each(function(Ot){var it=Ie,ht=Math.round(Re.c2p(Ot))+se.width/2%1;d.select(this).attr("d","M"+(D?it+","+ht:ht+","+it)+(D?"h":"v")+ve).call(c.lineGroupStyle,se.width,ye(Ot),se.dash)}),jt.selectAll("g."+Re._id+"tick,path").remove();var ct=Ie+ve+(X||0)/2-(E.ticks==="outside"?1:0),lt=e.calcTicks(Re),At=e.getTickSigns(Re)[2];return e.drawTicks(z,Re,{vals:Re.ticks==="inside"?e.clipEnds(Re,lt):lt,layer:jt,path:e.makeTickPath(Re,ct,At),transFn:e.makeTransTickFn(Re)}),e.drawLabels(z,Re,{vals:lt,layer:jt,transFn:e.makeTransTickLabelFn(Re),labelFns:e.makeLabelFns(Re,ct)})},function(){if(D&&!We||!D&&We){var cr,Dt,Ne=Re.position||0,Ye=Re._offset+Re._length/2;if(me==="right")Dt=Ye,cr=ee.l+ee.w*Ne+10+vt*(Re.showticklabels?1:.5);else if(cr=Ye,me==="bottom"&&(Dt=ee.t+ee.h*Ne+10+(Qe.indexOf("inside")===-1?Re.tickfont.size:0)+(Re.ticks!=="intside"&&E.ticklen||0)),me==="top"){var pe=oe.text.split("<br>").length;Dt=ee.t+ee.h*Ne+10-ve-f*vt*pe}Zt((D?"h":"v")+Re._id+"title",{avoid:{selection:d.select(z).selectAll("g."+Re._id+"tick"),side:me,offsetTop:D?0:ee.t,offsetLeft:D?ee.l:0,maxShift:D?J.width:J.height},attributes:{x:cr,y:Dt,"text-anchor":"middle"},transform:{rotate:D?-90:0,offset:0}})}},w.previousPromises,function(){var cr,Dt=ve+X/2;Qe.indexOf("inside")===-1&&(cr=c.bBox(jt.node()),Dt+=D?cr.width:cr.height),mt=nt.select("text");var Ne=0,Ye=D&&me==="top",pe=!D&&me==="right",_e=0;if(mt.node()&&!mt.classed(T.jsPlaceholder)){var Be,He=nt.select(".h"+Re._id+"title-math-group").node();He&&(D&&We||!D&&!We)?(Ne=(cr=c.bBox(He)).width,Be=cr.height):(Ne=(cr=c.bBox(nt.node())).right-ee.l-(D?Ie:ze),Be=cr.bottom-ee.t-(D?ze:Ie),D||me!=="top"||(Dt+=cr.height,_e=cr.height)),pe&&(mt.attr("transform",o(Ne/2+vt/2,0)),Ne*=2),Dt=Math.max(Dt,D?Ne:Be)}var Je=2*(D?U:te)+Dt+$+X/2,Ze=0;!D&&oe.text&&N==="bottom"&&K<=0&&(Je+=Ze=Je/2,_e+=Ze),J._hColorbarMoveTitle=Ze,J._hColorbarMoveCBTitle=_e;var ct=$+X;S.select("."+T.cbbg).attr("x",(D?Ie:ze)-ct/2-(D?U:0)).attr("y",(D?ze:Ie)-(D?we:te+_e-Ze)).attr(D?"width":"height",Math.max(Je-Ze,2)).attr(D?"height":"width",Math.max(we+ct,2)).call(a.fill,re).call(a.stroke,E.bordercolor).style("stroke-width",$);var lt=pe?Math.max(Ne-10,0):0;if(S.selectAll("."+T.cboutline).attr("x",(D?Ie:ze+U)+lt).attr("y",(D?ze+te-we:Ie)+(Ye?Gt:0)).attr(D?"width":"height",Math.max(ve,2)).attr(D?"height":"width",Math.max(we-(D?2*te+Gt:2*U+lt),2)).call(a.stroke,E.outlinecolor).style({fill:"none","stroke-width":X}),S.attr("transform",o(ee.l-(D?De*Je:0),ee.t-(D?0:(1-Oe)*Je-_e))),!D&&($||v(re).getAlpha()&&!v.equals(J.paper_bgcolor,re))){var At=jt.selectAll("text"),Ot=At[0].length,it=S.select("."+T.cbbg).node(),ht=c.bBox(it),Ut=c.getTranslate(S);At.each(function(St,Vt){var Jt=Ot-1;if(Vt===0||Vt===Jt){var qt,gr=c.bBox(this),Cr=c.getTranslate(this);if(Vt===Jt){var mr=gr.right+Cr.x;(qt=ht.right+Ut.x+ze-$-2+B-mr)>0&&(qt=0)}else if(Vt===0){var tr=gr.left+Cr.x;(qt=ht.left+Ut.x+ze+$+2-tr)<0&&(qt=0)}qt&&(Ot<3?this.setAttribute("transform","translate("+qt+",0) "+this.getAttribute("transform")):this.setAttribute("visibility","hidden"))}})}var Mt={},It=_[H],Le=b[H],Xe=_[N],ot=b[N],pt=Je-ve;D?(V==="pixels"?(Mt.y=K,Mt.t=we*Xe,Mt.b=we*ot):(Mt.t=Mt.b=0,Mt.yt=K+j*Xe,Mt.yb=K-j*ot),Q==="pixels"?(Mt.x=B,Mt.l=Je*It,Mt.r=Je*Le):(Mt.l=pt*It,Mt.r=pt*Le,Mt.xl=B-Z*It,Mt.xr=B+Z*Le)):(V==="pixels"?(Mt.x=B,Mt.l=we*It,Mt.r=we*Le):(Mt.l=Mt.r=0,Mt.xl=B+j*It,Mt.xr=B-j*Le),Q==="pixels"?(Mt.y=1-K,Mt.t=Je*Xe,Mt.b=Je*ot):(Mt.t=pt*Xe,Mt.b=pt*ot,Mt.yt=K-Z*Xe,Mt.yb=K+Z*ot)),w.autoMargin(z,E._id,Mt)}],z)}(I,A,k);P&&P.then&&(k._promises||[]).push(P),k._context.edits.colorbarPosition&&function(S,E,z){var D,j,V,Z=E.orientation==="v",Q=z._fullLayout._size;t.init({element:S.node(),gd:z,prepFn:function(){D=S.attr("transform"),g(S)},moveFn:function(X,$){S.attr("transform",D+o(X,$)),j=t.align((Z?E._uFrac:E._vFrac)+X/Q.w,Z?E._thickFrac:E._lenFrac,0,1,E.xanchor),V=t.align((Z?E._vFrac:1-E._uFrac)-$/Q.h,Z?E._lenFrac:E._thickFrac,0,1,E.yanchor);var re=t.getCursor(j,V,E.xanchor,E.yanchor);g(S,re)},doneFn:function(){if(g(S),j!==void 0&&V!==void 0){var X={};X[E._propPrefix+"x"]=j,X[E._propPrefix+"y"]=V,E._traceIndex!==void 0?y.call("_guiRestyle",z,X,E._traceIndex):y.call("_guiRelayout",z,X)}}})}(I,A,k)}),L.exit().each(function(A){w.autoMargin(k,A._id)}).remove(),L.order()}}},{"../../constants/alignment":483,"../../lib":515,"../../lib/extend":505,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_defaults":568,"../../plots/cartesian/layout_attributes":579,"../../plots/cartesian/position_defaults":582,"../../plots/plots":628,"../../registry":647,"../color":367,"../colorscale/helpers":378,"../dragelement":386,"../drawing":389,"../titles":476,"./constants":369,"@plotly/d3":58,tinycolor2:313}],372:[function(m,G,Y){var d=m("../../lib");G.exports=function(v){return d.isPlainObject(v.colorbar)}},{"../../lib":515}],373:[function(m,G,Y){G.exports={moduleType:"component",name:"colorbar",attributes:m("./attributes"),supplyDefaults:m("./defaults"),draw:m("./draw").draw,hasColorbar:m("./has_colorbar")}},{"./attributes":368,"./defaults":370,"./draw":371,"./has_colorbar":372}],374:[function(m,G,Y){var d=m("../colorbar/attributes"),v=m("../../lib/regex").counter,w=m("../../lib/sort_object_keys"),y=m("./scales.js").scales;w(y);function e(t){return"`"+t+"`"}G.exports=function(t,n){t=t||"";var o,r=(n=n||{}).cLetter||"c",g=("onlyIfNumerical"in n?n.onlyIfNumerical:Boolean(t),"noScale"in n?n.noScale:t==="marker.line"),c="showScaleDflt"in n?n.showScaleDflt:r==="z",a=typeof n.colorscaleDflt=="string"?y[n.colorscaleDflt]:null,h=n.editTypeOverride||"",l=t?t+".":"";"colorAttr"in n?(o=n.colorAttr,n.colorAttr):e(l+(o={z:"z",c:"color"}[r]));var s=r+"auto",p=r+"min",u=r+"max",i=r+"mid",x={};x[p]=x[u]=void 0;var f={};f[s]=!1;var _={};return o==="color"&&(_.color={valType:"color",arrayOk:!0,editType:h||"style"},n.anim&&(_.color.anim=!0)),_[s]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:x},_[p]={valType:"number",dflt:null,editType:h||"plot",impliedEdits:f},_[u]={valType:"number",dflt:null,editType:h||"plot",impliedEdits:f},_[i]={valType:"number",dflt:null,editType:"calc",impliedEdits:x},_.colorscale={valType:"colorscale",editType:"calc",dflt:a,impliedEdits:{autocolorscale:!1}},_.autocolorscale={valType:"boolean",dflt:n.autoColorDflt!==!1,editType:"calc",impliedEdits:{colorscale:void 0}},_.reversescale={valType:"boolean",dflt:!1,editType:"plot"},g||(_.showscale={valType:"boolean",dflt:c,editType:"calc"},_.colorbar=d),n.noColorAxis||(_.coloraxis={valType:"subplotid",regex:v("coloraxis"),dflt:null,editType:"calc"}),_}},{"../../lib/regex":532,"../../lib/sort_object_keys":538,"../colorbar/attributes":368,"./scales.js":382}],375:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("./helpers").extractOpts;G.exports=function(y,e,t){var n,o=y._fullLayout,r=t.vals,g=t.containerStr,c=g?v.nestedProperty(e,g).get():e,a=w(c),h=a.auto!==!1,l=a.min,s=a.max,p=a.mid,u=function(){return v.aggNums(Math.min,null,r)},i=function(){return v.aggNums(Math.max,null,r)};l===void 0?l=u():h&&(l=c._colorAx&&d(l)?Math.min(l,u()):u()),s===void 0?s=i():h&&(s=c._colorAx&&d(s)?Math.max(s,i()):i()),h&&p!==void 0&&(s-p>p-l?l=p-(s-p):s-p<p-l&&(s=p+(p-l))),l===s&&(l-=.5,s+=.5),a._sync("min",l),a._sync("max",s),a.autocolorscale&&(n=l*s<0?o.colorscale.diverging:l>=0?o.colorscale.sequential:o.colorscale.sequentialminus,a._sync("colorscale",n))}},{"../../lib":515,"./helpers":378,"fast-isnumeric":190}],376:[function(m,G,Y){var d=m("../../lib"),v=m("./helpers").hasColorscale,w=m("./helpers").extractOpts;G.exports=function(y,e){function t(h,l){var s=h["_"+l];s!==void 0&&(h[l]=s)}function n(h,l){var s=l.container?d.nestedProperty(h,l.container).get():h;if(s)if(s.coloraxis)s._colorAx=e[s.coloraxis];else{var p=w(s),u=p.auto;(u||p.min===void 0)&&t(s,l.min),(u||p.max===void 0)&&t(s,l.max),p.autocolorscale&&t(s,"colorscale")}}for(var o=0;o<y.length;o++){var r=y[o],g=r._module.colorbar;if(g)if(Array.isArray(g))for(var c=0;c<g.length;c++)n(r,g[c]);else n(r,g);v(r,"marker.line")&&n(r,{container:"marker.line",min:"cmin",max:"cmax"})}for(var a in e._colorAxes)n(e[a],{min:"cmin",max:"cmax"})}},{"../../lib":515,"./helpers":378}],377:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("../colorbar/has_colorbar"),y=m("../colorbar/defaults"),e=m("./scales").isValid,t=m("../../registry").traceIs;function n(o,r){var g=r.slice(0,r.length-1);return r?v.nestedProperty(o,g).get()||{}:o}G.exports=function o(r,g,c,a,h){var l=h.prefix,s=h.cLetter,p="_module"in g,u=n(r,l),i=n(g,l),x=n(g._template||{},l)||{},f=function(){return delete r.coloraxis,delete g.coloraxis,o(r,g,c,a,h)};if(p){var _=c._colorAxes||{},b=a(l+"coloraxis");if(b){var T=t(g,"contour")&&v.nestedProperty(g,"contours.coloring").get()||"heatmap",k=_[b];return void(k?(k[2].push(f),k[0]!==T&&(k[0]=!1,v.warn(["Ignoring coloraxis:",b,"setting","as it is linked to incompatible colorscales."].join(" ")))):_[b]=[T,g,[f]])}}var L=u[s+"min"],A=u[s+"max"],I=d(L)&&d(A)&&L<A;a(l+s+"auto",!I)?a(l+s+"mid"):(a(l+s+"min"),a(l+s+"max"));var P,S,E=u.colorscale,z=x.colorscale;E!==void 0&&(P=!e(E)),z!==void 0&&(P=!e(z)),a(l+"autocolorscale",P),a(l+"colorscale"),a(l+"reversescale"),l!=="marker.line."&&(l&&p&&(S=w(u)),a(l+"showscale",S)&&(l&&x&&(i._template=x),y(u,i,c)))}},{"../../lib":515,"../../registry":647,"../colorbar/defaults":370,"../colorbar/has_colorbar":372,"./scales":382,"fast-isnumeric":190}],378:[function(m,G,Y){var d=m("@plotly/d3"),v=m("tinycolor2"),w=m("fast-isnumeric"),y=m("../../lib"),e=m("../color"),t=m("./scales").isValid,n=["showscale","autocolorscale","colorscale","reversescale","colorbar"],o=["min","max","mid","auto"];function r(l){var s,p,u,i=l._colorAx,x=i||l,f={};for(p=0;p<n.length;p++)f[u=n[p]]=x[u];if(i)for(s="c",p=0;p<o.length;p++)f[u=o[p]]=x["c"+u];else{var _;for(p=0;p<o.length;p++)((_="c"+(u=o[p]))in x||(_="z"+u)in x)&&(f[u]=x[_]);s=_.charAt(0)}return f._sync=function(b,T){var k=o.indexOf(b)!==-1?s+b:b;x[k]=x["_"+k]=T},f}function g(l){for(var s=r(l),p=s.min,u=s.max,i=s.reversescale?c(s.colorscale):s.colorscale,x=i.length,f=new Array(x),_=new Array(x),b=0;b<x;b++){var T=i[b];f[b]=p+T[0]*(u-p),_[b]=T[1]}return{domain:f,range:_}}function c(l){for(var s=l.length,p=new Array(s),u=s-1,i=0;u>=0;u--,i++){var x=l[u];p[i]=[1-x[0],x[1]]}return p}function a(l,s){s=s||{};for(var p=l.domain,u=l.range,i=u.length,x=new Array(i),f=0;f<i;f++){var _=v(u[f]).toRgb();x[f]=[_.r,_.g,_.b,_.a]}var b,T=d.scale.linear().domain(p).range(x).clamp(!0),k=s.noNumericCheck,L=s.returnArray;return(b=k&&L?T:k?function(A){return h(T(A))}:L?function(A){return w(A)?T(A):v(A).isValid()?A:e.defaultLine}:function(A){return w(A)?h(T(A)):v(A).isValid()?A:e.defaultLine}).domain=T.domain,b.range=function(){return u},b}function h(l){var s={r:l[0],g:l[1],b:l[2],a:l[3]};return v(s).toRgbString()}G.exports={hasColorscale:function(l,s,p){var u=s?y.nestedProperty(l,s).get()||{}:l,i=u[p||"color"],x=!1;if(y.isArrayOrTypedArray(i)){for(var f=0;f<i.length;f++)if(w(i[f])){x=!0;break}}return y.isPlainObject(u)&&(x||u.showscale===!0||w(u.cmin)&&w(u.cmax)||t(u.colorscale)||y.isPlainObject(u.colorbar))},extractOpts:r,extractScale:g,flipScale:c,makeColorScaleFunc:a,makeColorScaleFuncFromTrace:function(l,s){return a(g(l),s)}}},{"../../lib":515,"../color":367,"./scales":382,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],379:[function(m,G,Y){var d=m("./scales"),v=m("./helpers");G.exports={moduleType:"component",name:"colorscale",attributes:m("./attributes"),layoutAttributes:m("./layout_attributes"),supplyLayoutDefaults:m("./layout_defaults"),handleDefaults:m("./defaults"),crossTraceDefaults:m("./cross_trace_defaults"),calc:m("./calc"),scales:d.scales,defaultScale:d.defaultScale,getScale:d.get,isValidScale:d.isValid,hasColorscale:v.hasColorscale,extractOpts:v.extractOpts,extractScale:v.extractScale,flipScale:v.flipScale,makeColorScaleFunc:v.makeColorScaleFunc,makeColorScaleFuncFromTrace:v.makeColorScaleFuncFromTrace}},{"./attributes":374,"./calc":375,"./cross_trace_defaults":376,"./defaults":377,"./helpers":378,"./layout_attributes":380,"./layout_defaults":381,"./scales":382}],380:[function(m,G,Y){var d=m("../../lib/extend").extendFlat,v=m("./attributes"),w=m("./scales").scales;G.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:w.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:w.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:w.RdBu,editType:"calc"}},coloraxis:d({_isSubplotObj:!0,editType:"calc"},v("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":505,"./attributes":374,"./scales":382}],381:[function(m,G,Y){var d=m("../../lib"),v=m("../../plot_api/plot_template"),w=m("./layout_attributes"),y=m("./defaults");G.exports=function(e,t){function n(s,p){return d.coerce(e,t,w,s,p)}n("colorscale.sequential"),n("colorscale.sequentialminus"),n("colorscale.diverging");var o,r,g=t._colorAxes;function c(s,p){return d.coerce(o,r,w.coloraxis,s,p)}for(var a in g){var h=g[a];if(h[0])o=e[a]||{},(r=v.newContainer(t,a,"coloraxis"))._name=a,y(o,r,t,c,{prefix:"",cLetter:"c"});else{for(var l=0;l<h[2].length;l++)h[2][l]();delete t._colorAxes[a]}}}},{"../../lib":515,"../../plot_api/plot_template":555,"./defaults":377,"./layout_attributes":380}],382:[function(m,G,Y){var d=m("tinycolor2"),v={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},w=v.RdBu;function y(e){var t=0;if(!Array.isArray(e)||e.length<2||!e[0]||!e[e.length-1]||+e[0][0]!=0||+e[e.length-1][0]!=1)return!1;for(var n=0;n<e.length;n++){var o=e[n];if(o.length!==2||+o[0]<t||!d(o[1]).isValid())return!1;t=+o[0]}return!0}G.exports={scales:v,defaultScale:w,get:function(e,t){if(t||(t=w),!e)return t;function n(){try{e=v[e]||JSON.parse(e)}catch{e=t}}return typeof e=="string"&&(n(),typeof e=="string"&&n()),y(e)?e:t},isValid:function(e){return v[e]!==void 0||y(e)}}},{tinycolor2:313}],383:[function(m,G,Y){G.exports=function(d,v,w,y,e){var t=(d-w)/(y-w),n=t+v/(y-w),o=(t+n)/2;return e==="left"||e==="bottom"?t:e==="center"||e==="middle"?o:e==="right"||e==="top"?n:t<2/3-o?t:n>4/3-o?n:o}},{}],384:[function(m,G,Y){var d=m("../../lib"),v=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];G.exports=function(w,y,e,t){return w=e==="left"?0:e==="center"?1:e==="right"?2:d.constrain(Math.floor(3*w),0,2),y=t==="bottom"?0:t==="middle"?1:t==="top"?2:d.constrain(Math.floor(3*y),0,2),v[y][w]}},{"../../lib":515}],385:[function(m,G,Y){Y.selectMode=function(d){return d==="lasso"||d==="select"},Y.drawMode=function(d){return d==="drawclosedpath"||d==="drawopenpath"||d==="drawline"||d==="drawrect"||d==="drawcircle"},Y.openMode=function(d){return d==="drawline"||d==="drawopenpath"},Y.rectMode=function(d){return d==="select"||d==="drawline"||d==="drawrect"||d==="drawcircle"},Y.freeMode=function(d){return d==="lasso"||d==="drawclosedpath"||d==="drawopenpath"},Y.selectingOrDrawing=function(d){return Y.freeMode(d)||Y.rectMode(d)}},{}],386:[function(m,G,Y){var d=m("mouse-event-offset"),v=m("has-hover"),w=m("has-passive-events"),y=m("../../lib").removeElement,e=m("../../plots/cartesian/constants"),t=G.exports={};t.align=m("./align"),t.getCursor=m("./cursor");var n=m("./unhover");function o(){var g=document.createElement("div");g.className="dragcover";var c=g.style;return c.position="fixed",c.left=0,c.right=0,c.top=0,c.bottom=0,c.zIndex=999999999,c.background="none",document.body.appendChild(g),g}function r(g){return d(g.changedTouches?g.changedTouches[0]:g,document.body)}t.unhover=n.wrapped,t.unhoverRaw=n.raw,t.init=function(g){var c,a,h,l,s,p,u,i,x=g.gd,f=1,_=x._context.doubleClickDelay,b=g.element;x._mouseDownTime||(x._mouseDownTime=0),b.style.pointerEvents="all",b.onmousedown=k,w?(b._ontouchstart&&b.removeEventListener("touchstart",b._ontouchstart),b._ontouchstart=k,b.addEventListener("touchstart",k,{passive:!1})):b.ontouchstart=k;var T=g.clampFn||function(I,P,S){return Math.abs(I)<S&&(I=0),Math.abs(P)<S&&(P=0),[I,P]};function k(I){x._dragged=!1,x._dragging=!0;var P=r(I);c=P[0],a=P[1],u=I.target,p=I,i=I.buttons===2||I.ctrlKey,I.clientX===void 0&&I.clientY===void 0&&(I.clientX=c,I.clientY=a),(h=new Date().getTime())-x._mouseDownTime<_?f+=1:(f=1,x._mouseDownTime=h),g.prepFn&&g.prepFn(I,c,a),v&&!i?(s=o()).style.cursor=window.getComputedStyle(b).cursor:v||(s=document,l=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(b).cursor),document.addEventListener("mouseup",A),document.addEventListener("touchend",A),g.dragmode!==!1&&(I.preventDefault(),document.addEventListener("mousemove",L),document.addEventListener("touchmove",L,{passive:!1}))}function L(I){I.preventDefault();var P=r(I),S=g.minDrag||e.MINDRAG,E=T(P[0]-c,P[1]-a,S),z=E[0],D=E[1];(z||D)&&(x._dragged=!0,t.unhover(x,I)),x._dragged&&g.moveFn&&!i&&(x._dragdata={element:b,dx:z,dy:D},g.moveFn(z,D))}function A(I){if(delete x._dragdata,g.dragmode!==!1&&(I.preventDefault(),document.removeEventListener("mousemove",L),document.removeEventListener("touchmove",L)),document.removeEventListener("mouseup",A),document.removeEventListener("touchend",A),v?y(s):l&&(s.documentElement.style.cursor=l,l=null),x._dragging){if(x._dragging=!1,new Date().getTime()-x._mouseDownTime>_&&(f=Math.max(f-1,1)),x._dragged)g.doneFn&&g.doneFn();else if(g.clickFn&&g.clickFn(f,p),!i){var P;try{P=new MouseEvent("click",I)}catch{var S=r(I);(P=document.createEvent("MouseEvents")).initMouseEvent("click",I.bubbles,I.cancelable,I.view,I.detail,I.screenX,I.screenY,S[0],S[1],I.ctrlKey,I.altKey,I.shiftKey,I.metaKey,I.button,I.relatedTarget)}u.dispatchEvent(P)}x._dragging=!1,x._dragged=!1}else x._dragged=!1}},t.coverSlip=o},{"../../lib":515,"../../plots/cartesian/constants":573,"./align":383,"./cursor":384,"./unhover":387,"has-hover":228,"has-passive-events":229,"mouse-event-offset":242}],387:[function(m,G,Y){var d=m("../../lib/events"),v=m("../../lib/throttle"),w=m("../../lib/dom").getGraphDiv,y=m("../fx/constants"),e=G.exports={};e.wrapped=function(t,n,o){(t=w(t))._fullLayout&&v.clear(t._fullLayout._uid+y.HOVERID),e.raw(t,n,o)},e.raw=function(t,n){var o=t._fullLayout,r=t._hoverdata;n||(n={}),n.target&&!t._dragged&&d.triggerHandler(t,"plotly_beforehover",n)===!1||(o._hoverlayer.selectAll("g").remove(),o._hoverlayer.selectAll("line").remove(),o._hoverlayer.selectAll("circle").remove(),t._hoverdata=void 0,n.target&&r&&t.emit("plotly_unhover",{event:n,points:r}))}},{"../../lib/dom":503,"../../lib/events":504,"../../lib/throttle":542,"../fx/constants":401}],388:[function(m,G,Y){Y.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"},Y.pattern={shape:{valType:"enumerated",values:["","/","\\","x","-","|","+","."],dflt:"",arrayOk:!0,editType:"style"},fillmode:{valType:"enumerated",values:["replace","overlay"],dflt:"replace",editType:"style"},bgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgcolor:{valType:"color",arrayOk:!0,editType:"style"},fgopacity:{valType:"number",editType:"style",min:0,max:1},size:{valType:"number",min:0,dflt:8,arrayOk:!0,editType:"style"},solidity:{valType:"number",min:0,max:1,dflt:.3,arrayOk:!0,editType:"style"},editType:"style"}},{}],389:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../lib"),w=v.numberFormat,y=m("fast-isnumeric"),e=m("tinycolor2"),t=m("../../registry"),n=m("../color"),o=m("../colorscale"),r=v.strTranslate,g=m("../../lib/svg_text_utils"),c=m("../../constants/xmlns_namespaces"),a=m("../../constants/alignment").LINE_SPACING,h=m("../../constants/interactions").DESELECTDIM,l=m("../../traces/scatter/subtypes"),s=m("../../traces/scatter/make_bubble_size_func"),p=m("../../components/fx/helpers").appendArrayPointValue,u=G.exports={};function i(fe,ge,Te){var le=ge.fillpattern,ve=le&&u.getPatternAttr(le.shape,0,"");if(ve){var Me=u.getPatternAttr(le.bgcolor,0,null),we=u.getPatternAttr(le.fgcolor,0,null),de=le.fgopacity,Ie=u.getPatternAttr(le.size,0,8),De=u.getPatternAttr(le.solidity,0,.3),Oe=ge.uid;u.pattern(fe,"point",Te,Oe,ve,Ie,De,void 0,le.fillmode,Me,we,de)}else ge.fillcolor&&fe.call(n.fill,ge.fillcolor)}u.font=function(fe,ge,Te,le){v.isPlainObject(ge)&&(le=ge.color,Te=ge.size,ge=ge.family),ge&&fe.style("font-family",ge),Te+1&&fe.style("font-size",Te+"px"),le&&fe.call(n.fill,le)},u.setPosition=function(fe,ge,Te){fe.attr("x",ge).attr("y",Te)},u.setSize=function(fe,ge,Te){fe.attr("width",ge).attr("height",Te)},u.setRect=function(fe,ge,Te,le,ve){fe.call(u.setPosition,ge,Te).call(u.setSize,le,ve)},u.translatePoint=function(fe,ge,Te,le){var ve=Te.c2p(fe.x),Me=le.c2p(fe.y);return!!(y(ve)&&y(Me)&&ge.node())&&(ge.node().nodeName==="text"?ge.attr("x",ve).attr("y",Me):ge.attr("transform",r(ve,Me)),!0)},u.translatePoints=function(fe,ge,Te){fe.each(function(le){var ve=d.select(this);u.translatePoint(le,ve,ge,Te)})},u.hideOutsideRangePoint=function(fe,ge,Te,le,ve,Me){ge.attr("display",Te.isPtWithinRange(fe,ve)&&le.isPtWithinRange(fe,Me)?null:"none")},u.hideOutsideRangePoints=function(fe,ge){if(ge._hasClipOnAxisFalse){var Te=ge.xaxis,le=ge.yaxis;fe.each(function(ve){var Me=ve[0].trace,we=Me.xcalendar,de=Me.ycalendar,Ie=t.traceIs(Me,"bar-like")?".bartext":".point,.textpoint";fe.selectAll(Ie).each(function(De){u.hideOutsideRangePoint(De,d.select(this),Te,le,we,de)})})}},u.crispRound=function(fe,ge,Te){return ge&&y(ge)?fe._context.staticPlot?ge:ge<1?1:Math.round(ge):Te||0},u.singleLineStyle=function(fe,ge,Te,le,ve){ge.style("fill","none");var Me=(((fe||[])[0]||{}).trace||{}).line||{},we=Te||Me.width||0,de=ve||Me.dash||"";n.stroke(ge,le||Me.color),u.dashLine(ge,de,we)},u.lineGroupStyle=function(fe,ge,Te,le){fe.style("fill","none").each(function(ve){var Me=(((ve||[])[0]||{}).trace||{}).line||{},we=ge||Me.width||0,de=le||Me.dash||"";d.select(this).call(n.stroke,Te||Me.color).call(u.dashLine,de,we)})},u.dashLine=function(fe,ge,Te){Te=+Te||0,ge=u.dashStyle(ge,Te),fe.style({"stroke-dasharray":ge,"stroke-width":Te+"px"})},u.dashStyle=function(fe,ge){ge=+ge||1;var Te=Math.max(ge,3);return fe==="solid"?fe="":fe==="dot"?fe=Te+"px,"+Te+"px":fe==="dash"?fe=3*Te+"px,"+3*Te+"px":fe==="longdash"?fe=5*Te+"px,"+5*Te+"px":fe==="dashdot"?fe=3*Te+"px,"+Te+"px,"+Te+"px,"+Te+"px":fe==="longdashdot"&&(fe=5*Te+"px,"+2*Te+"px,"+Te+"px,"+2*Te+"px"),fe},u.singleFillStyle=function(fe,ge){var Te=d.select(fe.node());i(fe,((Te.data()[0]||[])[0]||{}).trace||{},ge)},u.fillGroupStyle=function(fe,ge){fe.style("stroke-width",0).each(function(Te){var le=d.select(this);Te[0].trace&&i(le,Te[0].trace,ge)})};var x=m("./symbol_defs");u.symbolNames=[],u.symbolFuncs=[],u.symbolBackOffs=[],u.symbolNeedLines={},u.symbolNoDot={},u.symbolNoFill={},u.symbolList=[],Object.keys(x).forEach(function(fe){var ge=x[fe],Te=ge.n;u.symbolList.push(Te,String(Te),fe,Te+100,String(Te+100),fe+"-open"),u.symbolNames[Te]=fe,u.symbolFuncs[Te]=ge.f,u.symbolBackOffs[Te]=ge.backoff||0,ge.needLine&&(u.symbolNeedLines[Te]=!0),ge.noDot?u.symbolNoDot[Te]=!0:u.symbolList.push(Te+200,String(Te+200),fe+"-dot",Te+300,String(Te+300),fe+"-open-dot"),ge.noFill&&(u.symbolNoFill[Te]=!0)});var f=u.symbolNames.length;function _(fe,ge,Te,le){var ve=fe%100;return u.symbolFuncs[ve](ge,Te,le)+(fe>=200?"M0,0.5L0.5,0L0,-0.5L-0.5,0Z":"")}u.symbolNumber=function(fe){if(y(fe))fe=+fe;else if(typeof fe=="string"){var ge=0;fe.indexOf("-open")>0&&(ge=100,fe=fe.replace("-open","")),fe.indexOf("-dot")>0&&(ge+=200,fe=fe.replace("-dot","")),(fe=u.symbolNames.indexOf(fe))>=0&&(fe+=ge)}return fe%100>=f||fe>=400?0:Math.floor(Math.max(fe,0))};var b={x1:1,x2:0,y1:0,y2:0},T={x1:0,x2:0,y1:1,y2:0},k=w("~f"),L={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:b},horizontalreversed:{node:"linearGradient",attrs:b,reversed:!0},vertical:{node:"linearGradient",attrs:T},verticalreversed:{node:"linearGradient",attrs:T,reversed:!0}};u.gradient=function(fe,ge,Te,le,ve,Me){for(var we=ve.length,de=L[le],Ie=new Array(we),De=0;De<we;De++)de.reversed?Ie[we-1-De]=[k(100*(1-ve[De][0])),ve[De][1]]:Ie[De]=[k(100*ve[De][0]),ve[De][1]];var Oe=ge._fullLayout,Ve="g"+Oe._uid+"-"+Te,Fe=Oe._defs.select(".gradients").selectAll("#"+Ve).data([le+Ie.join(";")],v.identity);Fe.exit().remove(),Fe.enter().append(de.node).each(function(){var ze=d.select(this);de.attrs&&ze.attr(de.attrs),ze.attr("id",Ve);var Re=ze.selectAll("stop").data(Ie);Re.exit().remove(),Re.enter().append("stop"),Re.each(function(We){var $e=e(We[1]);d.select(this).attr({offset:We[0]+"%","stop-color":n.tinyRGB($e),"stop-opacity":$e.getAlpha()})})}),fe.style(Me,H(Ve,ge)).style(Me+"-opacity",null),fe.classed("gradient_filled",!0)},u.pattern=function(fe,ge,Te,le,ve,Me,we,de,Ie,De,Oe,Ve){var Fe=ge==="legend";de&&(Ie==="overlay"?(De=de,Oe=n.contrast(De)):(De=void 0,Oe=de));var ze,Re,We,$e,at,gt,xt,mt,nt,Qe,vt,jt=Te._fullLayout,Gt="p"+jt._uid+"-"+le,$t={},Zt=e(Oe),cr=n.tinyRGB(Zt),Dt=Ve*Zt.getAlpha();switch(ve){case"/":ze=Me*Math.sqrt(2),Re=Me*Math.sqrt(2),gt="path",$t={d:We="M-"+ze/4+","+Re/4+"l"+ze/2+",-"+Re/2+"M0,"+Re+"L"+ze+",0M"+ze/4*3+","+Re/4*5+"l"+ze/2+",-"+Re/2,opacity:Dt,stroke:cr,"stroke-width":($e=we*Me)+"px"};break;case"\\":ze=Me*Math.sqrt(2),Re=Me*Math.sqrt(2),gt="path",$t={d:We="M"+ze/4*3+",-"+Re/4+"l"+ze/2+","+Re/2+"M0,0L"+ze+","+Re+"M-"+ze/4+","+Re/4*3+"l"+ze/2+","+Re/2,opacity:Dt,stroke:cr,"stroke-width":($e=we*Me)+"px"};break;case"x":ze=Me*Math.sqrt(2),Re=Me*Math.sqrt(2),We="M-"+ze/4+","+Re/4+"l"+ze/2+",-"+Re/2+"M0,"+Re+"L"+ze+",0M"+ze/4*3+","+Re/4*5+"l"+ze/2+",-"+Re/2+"M"+ze/4*3+",-"+Re/4+"l"+ze/2+","+Re/2+"M0,0L"+ze+","+Re+"M-"+ze/4+","+Re/4*3+"l"+ze/2+","+Re/2,$e=Me-Me*Math.sqrt(1-we),gt="path",$t={d:We,opacity:Dt,stroke:cr,"stroke-width":$e+"px"};break;case"|":gt="path",gt="path",$t={d:We="M"+(ze=Me)/2+",0L"+ze/2+","+(Re=Me),opacity:Dt,stroke:cr,"stroke-width":($e=we*Me)+"px"};break;case"-":gt="path",gt="path",$t={d:We="M0,"+(Re=Me)/2+"L"+(ze=Me)+","+Re/2,opacity:Dt,stroke:cr,"stroke-width":($e=we*Me)+"px"};break;case"+":gt="path",We="M"+(ze=Me)/2+",0L"+ze/2+","+(Re=Me)+"M0,"+Re/2+"L"+ze+","+Re/2,$e=Me-Me*Math.sqrt(1-we),gt="path",$t={d:We,opacity:Dt,stroke:cr,"stroke-width":$e+"px"};break;case".":ze=Me,Re=Me,we<Math.PI/4?at=Math.sqrt(we*Me*Me/Math.PI):(xt=we,mt=Math.PI/4,nt=1,Qe=Me/2,vt=Me/Math.sqrt(2),at=Qe+(vt-Qe)*(xt-mt)/(nt-mt)),gt="circle",$t={cx:ze/2,cy:Re/2,r:at,opacity:Dt,fill:cr}}var Ne=[ve||"noSh",De||"noBg",Oe||"noFg",Me,we].join(";"),Ye=jt._defs.select(".patterns").selectAll("#"+Gt).data([Ne],v.identity);Ye.exit().remove(),Ye.enter().append("pattern").each(function(){var pe=d.select(this);if(pe.attr({id:Gt,width:ze+"px",height:Re+"px",patternUnits:"userSpaceOnUse",patternTransform:Fe?"scale(0.8)":""}),De){var _e=e(De),Be=n.tinyRGB(_e),He=_e.getAlpha(),Je=pe.selectAll("rect").data([0]);Je.exit().remove(),Je.enter().append("rect").attr({width:ze+"px",height:Re+"px",fill:Be,"fill-opacity":He})}var Ze=pe.selectAll(gt).data([0]);Ze.exit().remove(),Ze.enter().append(gt).attr($t)}),fe.style("fill",H(Gt,Te)).style("fill-opacity",null),fe.classed("pattern_filled",!0)},u.initGradients=function(fe){var ge=fe._fullLayout;v.ensureSingle(ge._defs,"g","gradients").selectAll("linearGradient,radialGradient").remove(),d.select(fe).selectAll(".gradient_filled").classed("gradient_filled",!1)},u.initPatterns=function(fe){var ge=fe._fullLayout;v.ensureSingle(ge._defs,"g","patterns").selectAll("pattern").remove(),d.select(fe).selectAll(".pattern_filled").classed("pattern_filled",!1)},u.getPatternAttr=function(fe,ge,Te){return fe&&v.isArrayOrTypedArray(fe)?ge<fe.length?fe[ge]:Te:fe},u.pointStyle=function(fe,ge,Te){if(fe.size()){var le=u.makePointStyleFns(ge);fe.each(function(ve){u.singlePointStyle(ve,d.select(this),ge,le,Te)})}},u.singlePointStyle=function(fe,ge,Te,le,ve){var Me=Te.marker,we=Me.line;if(ge.style("opacity",le.selectedOpacityFn?le.selectedOpacityFn(fe):fe.mo===void 0?Me.opacity:fe.mo),le.ms2mrc){var de;de=fe.ms==="various"||Me.size==="various"?3:le.ms2mrc(fe.ms),fe.mrc=de,le.selectedSizeFn&&(de=fe.mrc=le.selectedSizeFn(fe));var Ie=u.symbolNumber(fe.mx||Me.symbol)||0;fe.om=Ie%200>=100;var De=Se(fe,Te),Oe=te(fe,Te);ge.attr("d",_(Ie,de,De,Oe))}var Ve,Fe,ze,Re=!1;if(fe.so)ze=we.outlierwidth,Fe=we.outliercolor,Ve=Me.outliercolor;else{var We=(we||{}).width;ze=(fe.mlw+1||We+1||(fe.trace?(fe.trace.marker.line||{}).width:0)+1)-1||0,Fe="mlc"in fe?fe.mlcc=le.lineScale(fe.mlc):v.isArrayOrTypedArray(we.color)?n.defaultLine:we.color,v.isArrayOrTypedArray(Me.color)&&(Ve=n.defaultLine,Re=!0),Ve="mc"in fe?fe.mcc=le.markerScale(fe.mc):Me.color||"rgba(0,0,0,0)",le.selectedColorFn&&(Ve=le.selectedColorFn(fe))}if(fe.om)ge.call(n.stroke,Ve).style({"stroke-width":(ze||1)+"px",fill:"none"});else{ge.style("stroke-width",(fe.isBlank?0:ze)+"px");var $e=Me.gradient,at=fe.mgt;at?Re=!0:at=$e&&$e.type,v.isArrayOrTypedArray(at)&&(at=at[0],L[at]||(at=0));var gt=Me.pattern,xt=gt&&u.getPatternAttr(gt.shape,fe.i,"");if(at&&at!=="none"){var mt=fe.mgc;mt?Re=!0:mt=$e.color;var nt=Te.uid;Re&&(nt+="-"+fe.i),u.gradient(ge,ve,nt,at,[[0,mt],[1,Ve]],"fill")}else if(xt){var Qe=u.getPatternAttr(gt.bgcolor,fe.i,null),vt=u.getPatternAttr(gt.fgcolor,fe.i,null),jt=gt.fgopacity,Gt=u.getPatternAttr(gt.size,fe.i,8),$t=u.getPatternAttr(gt.solidity,fe.i,.3),Zt=fe.mcc||v.isArrayOrTypedArray(gt.shape)||v.isArrayOrTypedArray(gt.bgcolor)||v.isArrayOrTypedArray(gt.size)||v.isArrayOrTypedArray(gt.solidity),cr=Te.uid;Zt&&(cr+="-"+fe.i),u.pattern(ge,"point",ve,cr,xt,Gt,$t,fe.mcc,gt.fillmode,Qe,vt,jt)}else n.fill(ge,Ve);ze&&n.stroke(ge,Fe)}},u.makePointStyleFns=function(fe){var ge={},Te=fe.marker;return ge.markerScale=u.tryColorscale(Te,""),ge.lineScale=u.tryColorscale(Te,"line"),t.traceIs(fe,"symbols")&&(ge.ms2mrc=l.isBubble(fe)?s(fe):function(){return(Te.size||6)/2}),fe.selectedpoints&&v.extendFlat(ge,u.makeSelectedPointStyleFns(fe)),ge},u.makeSelectedPointStyleFns=function(fe){var ge={},Te=fe.selected||{},le=fe.unselected||{},ve=fe.marker||{},Me=Te.marker||{},we=le.marker||{},de=ve.opacity,Ie=Me.opacity,De=we.opacity,Oe=Ie!==void 0,Ve=De!==void 0;(v.isArrayOrTypedArray(de)||Oe||Ve)&&(ge.selectedOpacityFn=function(mt){var nt=mt.mo===void 0?ve.opacity:mt.mo;return mt.selected?Oe?Ie:nt:Ve?De:h*nt});var Fe=ve.color,ze=Me.color,Re=we.color;(ze||Re)&&(ge.selectedColorFn=function(mt){var nt=mt.mcc||Fe;return mt.selected?ze||nt:Re||nt});var We=ve.size,$e=Me.size,at=we.size,gt=$e!==void 0,xt=at!==void 0;return t.traceIs(fe,"symbols")&&(gt||xt)&&(ge.selectedSizeFn=function(mt){var nt=mt.mrc||We/2;return mt.selected?gt?$e/2:nt:xt?at/2:nt}),ge},u.makeSelectedTextStyleFns=function(fe){var ge={},Te=fe.selected||{},le=fe.unselected||{},ve=fe.textfont||{},Me=Te.textfont||{},we=le.textfont||{},de=ve.color,Ie=Me.color,De=we.color;return ge.selectedTextColorFn=function(Oe){var Ve=Oe.tc||de;return Oe.selected?Ie||Ve:De||(Ie?Ve:n.addOpacity(Ve,h))},ge},u.selectedPointStyle=function(fe,ge){if(fe.size()&&ge.selectedpoints){var Te=u.makeSelectedPointStyleFns(ge),le=ge.marker||{},ve=[];Te.selectedOpacityFn&&ve.push(function(Me,we){Me.style("opacity",Te.selectedOpacityFn(we))}),Te.selectedColorFn&&ve.push(function(Me,we){n.fill(Me,Te.selectedColorFn(we))}),Te.selectedSizeFn&&ve.push(function(Me,we){var de=we.mx||le.symbol||0,Ie=Te.selectedSizeFn(we);Me.attr("d",_(u.symbolNumber(de),Ie,Se(we,ge),te(we,ge))),we.mrc2=Ie}),ve.length&&fe.each(function(Me){for(var we=d.select(this),de=0;de<ve.length;de++)ve[de](we,Me)})}},u.tryColorscale=function(fe,ge){var Te=ge?v.nestedProperty(fe,ge).get():fe;if(Te){var le=Te.color;if((Te.colorscale||Te._colorAx)&&v.isArrayOrTypedArray(le))return o.makeColorScaleFuncFromTrace(Te)}return v.identity};var A={start:1,end:-1,middle:0,bottom:1,top:-1};function I(fe,ge,Te,le,ve){var Me=d.select(fe.node().parentNode),we=ge.indexOf("top")!==-1?"top":ge.indexOf("bottom")!==-1?"bottom":"middle",de=ge.indexOf("left")!==-1?"end":ge.indexOf("right")!==-1?"start":"middle",Ie=le?le/.8+1:0,De=(g.lineCount(fe)-1)*a+1,Oe=A[de]*Ie,Ve=.75*Te+A[we]*Ie+(A[we]-1)*De*Te/2;fe.attr("text-anchor",de),ve||Me.attr("transform",r(Oe,Ve))}function P(fe,ge){var Te=fe.ts||ge.textfont.size;return y(Te)&&Te>0?Te:0}u.textPointStyle=function(fe,ge,Te){if(fe.size()){var le;if(ge.selectedpoints){var ve=u.makeSelectedTextStyleFns(ge);le=ve.selectedTextColorFn}var Me=ge.texttemplate,we=Te._fullLayout;fe.each(function(de){var Ie=d.select(this),De=Me?v.extractOption(de,ge,"txt","texttemplate"):v.extractOption(de,ge,"tx","text");if(De||De===0){if(Me){var Oe=ge._module.formatLabels,Ve=Oe?Oe(de,ge,we):{},Fe={};p(Fe,ge,de.i);var ze=ge._meta||{};De=v.texttemplateString(De,Ve,we._d3locale,Fe,de,ze)}var Re=de.tp||ge.textposition,We=P(de,ge),$e=le?le(de):de.tc||ge.textfont.color;Ie.call(u.font,de.tf||ge.textfont.family,We,$e).text(De).call(g.convertToTspans,Te).call(I,Re,We,de.mrc)}else Ie.remove()})}},u.selectedTextStyle=function(fe,ge){if(fe.size()&&ge.selectedpoints){var Te=u.makeSelectedTextStyleFns(ge);fe.each(function(le){var ve=d.select(this),Me=Te.selectedTextColorFn(le),we=le.tp||ge.textposition,de=P(le,ge);n.fill(ve,Me);var Ie=t.traceIs(ge,"bar-like");I(ve,we,de,le.mrc2||le.mrc,Ie)})}};var S,E;function z(fe,ge,Te){return Te&&(fe=X(fe)),ge?j(fe[1]):D(fe[0])}function D(fe){var ge=d.round(fe,2);return S=ge,ge}function j(fe){var ge=d.round(fe,2);return E=ge,ge}function V(fe,ge,Te,le){var ve=fe[0]-ge[0],Me=fe[1]-ge[1],we=Te[0]-ge[0],de=Te[1]-ge[1],Ie=Math.pow(ve*ve+Me*Me,.25),De=Math.pow(we*we+de*de,.25),Oe=(De*De*ve-Ie*Ie*we)*le,Ve=(De*De*Me-Ie*Ie*de)*le,Fe=3*De*(Ie+De),ze=3*Ie*(Ie+De);return[[D(ge[0]+(Fe&&Oe/Fe)),j(ge[1]+(Fe&&Ve/Fe))],[D(ge[0]-(ze&&Oe/ze)),j(ge[1]-(ze&&Ve/ze))]]}u.smoothopen=function(fe,ge){if(fe.length<3)return"M"+fe.join("L");var Te,le="M"+fe[0],ve=[];for(Te=1;Te<fe.length-1;Te++)ve.push(V(fe[Te-1],fe[Te],fe[Te+1],ge));for(le+="Q"+ve[0][0]+" "+fe[1],Te=2;Te<fe.length-1;Te++)le+="C"+ve[Te-2][1]+" "+ve[Te-1][0]+" "+fe[Te];return le+="Q"+ve[fe.length-3][1]+" "+fe[fe.length-1]},u.smoothclosed=function(fe,ge){if(fe.length<3)return"M"+fe.join("L")+"Z";var Te,le="M"+fe[0],ve=fe.length-1,Me=[V(fe[ve],fe[0],fe[1],ge)];for(Te=1;Te<ve;Te++)Me.push(V(fe[Te-1],fe[Te],fe[Te+1],ge));for(Me.push(V(fe[ve-1],fe[ve],fe[0],ge)),Te=1;Te<=ve;Te++)le+="C"+Me[Te-1][1]+" "+Me[Te][0]+" "+fe[Te];return le+="C"+Me[ve][1]+" "+Me[0][0]+" "+fe[0]+"Z"};var Z={hv:function(fe,ge,Te){return"H"+D(ge[0])+"V"+z(ge,1,Te)},vh:function(fe,ge,Te){return"V"+j(ge[1])+"H"+z(ge,0,Te)},hvh:function(fe,ge,Te){return"H"+D((fe[0]+ge[0])/2)+"V"+j(ge[1])+"H"+z(ge,0,Te)},vhv:function(fe,ge,Te){return"V"+j((fe[1]+ge[1])/2)+"H"+D(ge[0])+"V"+z(ge,1,Te)}},Q=function(fe,ge,Te){return"L"+z(ge,0,Te)+","+z(ge,1,Te)};function X(fe,ge){var Te=fe.backoff,le=fe.trace,ve=fe.d,Me=fe.i;if(Te&&le&&le.marker&&le.marker.angle%360==0&&le.line&&le.line.shape!=="spline"){var we=v.isArrayOrTypedArray(Te),de=fe,Ie=ge?ge[0]:S||0,De=ge?ge[1]:E||0,Oe=de[0],Ve=de[1],Fe=Oe-Ie,ze=Ve-De,Re=Math.atan2(ze,Fe),We=we?Te[Me]:Te;if(We==="auto"){var $e=de.i;le.type==="scatter"&&$e--;var at=de.marker;We=at?u.symbolBackOffs[u.symbolNumber(at.symbol)]*at.size:0,We+=u.getMarkerStandoff(ve[$e],le)||0}var gt=Oe-We*Math.cos(Re),xt=Ve-We*Math.sin(Re);(gt<=Oe&&gt>=Ie||gt>=Oe&&gt<=Ie)&&(xt<=Ve&&xt>=De||xt>=Ve&&xt<=De)&&(fe=[gt,xt])}return fe}u.steps=function(fe){var ge=Z[fe]||Q;return function(Te){for(var le="M"+D(Te[0][0])+","+j(Te[0][1]),ve=Te.length,Me=1;Me<ve;Me++)le+=ge(Te[Me-1],Te[Me],Me===ve-1);return le}},u.applyBackoff=X,u.makeTester=function(){var fe=v.ensureSingleById(d.select("body"),"svg","js-plotly-tester",function(Te){Te.attr(c.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})}),ge=v.ensureSingle(fe,"path","js-reference-point",function(Te){Te.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})});u.tester=fe,u.testref=ge},u.savedBBoxes={};var $=0;function re(fe){var ge=fe.getAttribute("data-unformatted");if(ge!==null)return ge+fe.getAttribute("data-math")+fe.getAttribute("text-anchor")+fe.getAttribute("style")}function H(fe,ge){if(!fe)return null;var Te=ge._context,le=Te._exportedPlot?"":Te._baseUrl||"";return le?"url('"+le+"#"+fe+"')":"url(#"+fe+")"}u.bBox=function(fe,ge,Te){var le,ve,Me;if(Te||(Te=re(fe)),Te){if(le=u.savedBBoxes[Te])return v.extendFlat({},le)}else if(fe.childNodes.length===1){var we=fe.childNodes[0];if(Te=re(we)){var de=+we.getAttribute("x")||0,Ie=+we.getAttribute("y")||0,De=we.getAttribute("transform");if(!De){var Oe=u.bBox(we,!1,Te);return de&&(Oe.left+=de,Oe.right+=de),Ie&&(Oe.top+=Ie,Oe.bottom+=Ie),Oe}if(Te+="~"+de+"~"+Ie+"~"+De,le=u.savedBBoxes[Te])return v.extendFlat({},le)}}ge?ve=fe:(Me=u.tester.node(),ve=fe.cloneNode(!0),Me.appendChild(ve)),d.select(ve).attr("transform",null).call(g.positionText,0,0);var Ve=ve.getBoundingClientRect(),Fe=u.testref.node().getBoundingClientRect();ge||Me.removeChild(ve);var ze={height:Ve.height,width:Ve.width,left:Ve.left-Fe.left,top:Ve.top-Fe.top,right:Ve.right-Fe.left,bottom:Ve.bottom-Fe.top};return $>=1e4&&(u.savedBBoxes={},$=0),Te&&(u.savedBBoxes[Te]=ze),$++,v.extendFlat({},ze)},u.setClipUrl=function(fe,ge,Te){fe.attr("clip-path",H(ge,Te))},u.getTranslate=function(fe){var ge=(fe[fe.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,function(Te,le,ve){return[le,ve].join(" ")}).split(" ");return{x:+ge[0]||0,y:+ge[1]||0}},u.setTranslate=function(fe,ge,Te){var le=fe.attr?"attr":"getAttribute",ve=fe.attr?"attr":"setAttribute",Me=fe[le]("transform")||"";return ge=ge||0,Te=Te||0,Me=Me.replace(/(\btranslate\(.*?\);?)/,"").trim(),Me=(Me+=r(ge,Te)).trim(),fe[ve]("transform",Me),Me},u.getScale=function(fe){var ge=(fe[fe.attr?"attr":"getAttribute"]("transform")||"").replace(/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,function(Te,le,ve){return[le,ve].join(" ")}).split(" ");return{x:+ge[0]||1,y:+ge[1]||1}},u.setScale=function(fe,ge,Te){var le=fe.attr?"attr":"getAttribute",ve=fe.attr?"attr":"setAttribute",Me=fe[le]("transform")||"";return ge=ge||1,Te=Te||1,Me=Me.replace(/(\bscale\(.*?\);?)/,"").trim(),Me=(Me+="scale("+ge+","+Te+")").trim(),fe[ve]("transform",Me),Me};var N=/\s*sc.*/;u.setPointGroupScale=function(fe,ge,Te){if(ge=ge||1,Te=Te||1,fe){var le=ge===1&&Te===1?"":"scale("+ge+","+Te+")";fe.each(function(){var ve=(this.getAttribute("transform")||"").replace(N,"");ve=(ve+=le).trim(),this.setAttribute("transform",ve)})}};var U=/translate\([^)]*\)\s*$/;function te(fe,ge){var Te;return fe&&(Te=fe.mf),Te===void 0&&(Te=ge.marker&&ge.marker.standoff||0),ge._geo||ge._xA?Te:-Te}u.setTextPointsScale=function(fe,ge,Te){fe&&fe.each(function(){var le,ve=d.select(this),Me=ve.select("text");if(Me.node()){var we=parseFloat(Me.attr("x")||0),de=parseFloat(Me.attr("y")||0),Ie=(ve.attr("transform")||"").match(U);le=ge===1&&Te===1?[]:[r(we,de),"scale("+ge+","+Te+")",r(-we,-de)],Ie&&le.push(Ie),ve.attr("transform",le.join(""))}})},u.getMarkerStandoff=te;var B,K,J,ee,ne,se,oe=Math.atan2,me=Math.cos,ce=Math.sin;function ye(fe,ge){var Te=ge[0],le=ge[1];return[Te*me(fe)-le*ce(fe),Te*ce(fe)+le*me(fe)]}function Se(fe,ge){var Te,le,ve=fe.ma;ve===void 0&&(ve=ge.marker.angle||0);var Me=ge.marker.angleref;if(Me==="previous"||Me==="north"){if(ge._geo){var we=ge._geo.project(fe.lonlat);Te=we[0],le=we[1]}else{var de=ge._xA,Ie=ge._yA;if(!de||!Ie)return 90;Te=de.c2p(fe.x),le=Ie.c2p(fe.y)}if(ge._geo){var De,Oe=fe.lonlat[0],Ve=fe.lonlat[1],Fe=ge._geo.project([Oe,Ve+1e-5]),ze=ge._geo.project([Oe+1e-5,Ve]),Re=oe(ze[1]-le,ze[0]-Te),We=oe(Fe[1]-le,Fe[0]-Te);if(Me==="north")De=ve/180*Math.PI;else if(Me==="previous"){var $e=Oe/180*Math.PI,at=Ve/180*Math.PI,gt=B/180*Math.PI,xt=K/180*Math.PI,mt=gt-$e,nt=me(xt)*ce(mt),Qe=ce(xt)*me(at)-me(xt)*ce(at)*me(mt);De=-oe(nt,Qe)-Math.PI,B=Oe,K=Ve}var vt=ye(Re,[me(De),0]),jt=ye(We,[ce(De),0]);ve=oe(vt[1]+jt[1],vt[0]+jt[0])/Math.PI*180,Me!=="previous"||se===ge.uid&&fe.i===ne+1||(ve=null)}if(Me==="previous"&&!ge._geo)if(se===ge.uid&&fe.i===ne+1&&y(Te)&&y(le)){var Gt=Te-J,$t=le-ee,Zt=ge.line&&ge.line.shape||"",cr=Zt.slice(Zt.length-1);cr==="h"&&($t=0),cr==="v"&&(Gt=0),ve+=oe($t,Gt)/Math.PI*180+90}else ve=null}return J=Te,ee=le,ne=fe.i,se=ge.uid,ve}u.getMarkerAngle=Se},{"../../components/fx/helpers":403,"../../constants/alignment":483,"../../constants/interactions":490,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../registry":647,"../../traces/scatter/make_bubble_size_func":953,"../../traces/scatter/subtypes":961,"../color":367,"../colorscale":379,"./symbol_defs":390,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],390:[function(m,G,Y){var d,v,w,y,e=m("parse-svg-path"),t=m("@plotly/d3").round,n=Math.sqrt(2),o=Math.sqrt(3),r=Math.PI,g=Math.cos,c=Math.sin;function a(l){return l===null}function h(l,s,p){if(!(l&&l%360!=0||s))return p;if(w===l&&y===s&&d===p)return v;function u(E,z){var D=g(E),j=c(E),V=z[0],Z=z[1]+(s||0);return[V*D-Z*j,V*j+Z*D]}w=l,y=s,d=p;for(var i=l/180*r,x=0,f=0,_=e(p),b="",T=0;T<_.length;T++){var k=_[T],L=k[0],A=x,I=f;if(L==="M"||L==="L")x=+k[1],f=+k[2];else if(L==="m"||L==="l")x+=+k[1],f+=+k[2];else if(L==="H")x=+k[1];else if(L==="h")x+=+k[1];else if(L==="V")f=+k[1];else if(L==="v")f+=+k[1];else if(L==="A"){x=+k[1],f=+k[2];var P=u(i,[+k[6],+k[7]]);k[6]=P[0],k[7]=P[1],k[3]=+k[3]+l}L!=="H"&&L!=="V"||(L="L"),L!=="h"&&L!=="v"||(L="l"),L!=="m"&&L!=="l"||(x-=A,f-=I);var S=u(i,[x,f]);L!=="H"&&L!=="V"||(L="L"),L!=="M"&&L!=="L"&&L!=="m"&&L!=="l"||(k[1]=S[0],k[2]=S[1]),k[0]=L,b+=k[0]+k.slice(1).join(",")}return v=b,b}G.exports={circle:{n:0,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(l,2),i="M"+u+",0A"+u+","+u+" 0 1,1 0,-"+u+"A"+u+","+u+" 0 0,1 "+u+",0Z";return p?h(s,p,i):i}},square:{n:1,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(l,2);return h(s,p,"M"+u+","+u+"H-"+u+"V-"+u+"H"+u+"Z")}},diamond:{n:2,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(1.3*l,2);return h(s,p,"M"+u+",0L0,"+u+"L-"+u+",0L0,-"+u+"Z")}},cross:{n:3,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(.4*l,2),i=t(1.2*l,2);return h(s,p,"M"+i+","+u+"H"+u+"V"+i+"H-"+u+"V"+u+"H-"+i+"V-"+u+"H-"+u+"V-"+i+"H"+u+"V-"+u+"H"+i+"Z")}},x:{n:4,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(.8*l/n,2),i="l"+u+","+u,x="l"+u+",-"+u,f="l-"+u+",-"+u,_="l-"+u+","+u;return h(s,p,"M0,"+u+i+x+f+x+f+_+f+_+i+_+i+"Z")}},"triangle-up":{n:5,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(2*l/o,2);return h(s,p,"M-"+u+","+t(l/2,2)+"H"+u+"L0,-"+t(l,2)+"Z")}},"triangle-down":{n:6,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(2*l/o,2);return h(s,p,"M-"+u+",-"+t(l/2,2)+"H"+u+"L0,"+t(l,2)+"Z")}},"triangle-left":{n:7,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(2*l/o,2);return h(s,p,"M"+t(l/2,2)+",-"+u+"V"+u+"L-"+t(l,2)+",0Z")}},"triangle-right":{n:8,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(2*l/o,2);return h(s,p,"M-"+t(l/2,2)+",-"+u+"V"+u+"L"+t(l,2)+",0Z")}},"triangle-ne":{n:9,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(.6*l,2),i=t(1.2*l,2);return h(s,p,"M-"+i+",-"+u+"H"+u+"V"+i+"Z")}},"triangle-se":{n:10,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(.6*l,2),i=t(1.2*l,2);return h(s,p,"M"+u+",-"+i+"V"+u+"H-"+i+"Z")}},"triangle-sw":{n:11,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(.6*l,2),i=t(1.2*l,2);return h(s,p,"M"+i+","+u+"H-"+u+"V-"+i+"Z")}},"triangle-nw":{n:12,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(.6*l,2),i=t(1.2*l,2);return h(s,p,"M-"+u+","+i+"V-"+u+"H"+i+"Z")}},pentagon:{n:13,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(.951*l,2),i=t(.588*l,2),x=t(-l,2),f=t(-.309*l,2);return h(s,p,"M"+u+","+f+"L"+i+","+t(.809*l,2)+"H-"+i+"L-"+u+","+f+"L0,"+x+"Z")}},hexagon:{n:14,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(l,2),i=t(l/2,2),x=t(l*o/2,2);return h(s,p,"M"+x+",-"+i+"V"+i+"L0,"+u+"L-"+x+","+i+"V-"+i+"L0,-"+u+"Z")}},hexagon2:{n:15,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(l,2),i=t(l/2,2),x=t(l*o/2,2);return h(s,p,"M-"+i+","+x+"H"+i+"L"+u+",0L"+i+",-"+x+"H-"+i+"L-"+u+",0Z")}},octagon:{n:16,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(.924*l,2),i=t(.383*l,2);return h(s,p,"M-"+i+",-"+u+"H"+i+"L"+u+",-"+i+"V"+i+"L"+i+","+u+"H-"+i+"L-"+u+","+i+"V-"+i+"Z")}},star:{n:17,f:function(l,s,p){if(a(s))return"M0,0Z";var u=1.4*l,i=t(.225*u,2),x=t(.951*u,2),f=t(.363*u,2),_=t(.588*u,2),b=t(-u,2),T=t(-.309*u,2),k=t(.118*u,2),L=t(.809*u,2);return h(s,p,"M"+i+","+T+"H"+x+"L"+f+","+k+"L"+_+","+L+"L0,"+t(.382*u,2)+"L-"+_+","+L+"L-"+f+","+k+"L-"+x+","+T+"H-"+i+"L0,"+b+"Z")}},hexagram:{n:18,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(.66*l,2),i=t(.38*l,2),x=t(.76*l,2);return h(s,p,"M-"+x+",0l-"+i+",-"+u+"h"+x+"l"+i+",-"+u+"l"+i+","+u+"h"+x+"l-"+i+","+u+"l"+i+","+u+"h-"+x+"l-"+i+","+u+"l-"+i+",-"+u+"h-"+x+"Z")}},"star-triangle-up":{n:19,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(l*o*.8,2),i=t(.8*l,2),x=t(1.6*l,2),f=t(4*l,2),_="A "+f+","+f+" 0 0 1 ";return h(s,p,"M-"+u+","+i+_+u+","+i+_+"0,-"+x+_+"-"+u+","+i+"Z")}},"star-triangle-down":{n:20,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(l*o*.8,2),i=t(.8*l,2),x=t(1.6*l,2),f=t(4*l,2),_="A "+f+","+f+" 0 0 1 ";return h(s,p,"M"+u+",-"+i+_+"-"+u+",-"+i+_+"0,"+x+_+u+",-"+i+"Z")}},"star-square":{n:21,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(1.1*l,2),i=t(2*l,2),x="A "+i+","+i+" 0 0 1 ";return h(s,p,"M-"+u+",-"+u+x+"-"+u+","+u+x+u+","+u+x+u+",-"+u+x+"-"+u+",-"+u+"Z")}},"star-diamond":{n:22,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(1.4*l,2),i=t(1.9*l,2),x="A "+i+","+i+" 0 0 1 ";return h(s,p,"M-"+u+",0"+x+"0,"+u+x+u+",0"+x+"0,-"+u+x+"-"+u+",0Z")}},"diamond-tall":{n:23,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(.7*l,2),i=t(1.4*l,2);return h(s,p,"M0,"+i+"L"+u+",0L0,-"+i+"L-"+u+",0Z")}},"diamond-wide":{n:24,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(1.4*l,2),i=t(.7*l,2);return h(s,p,"M0,"+i+"L"+u+",0L0,-"+i+"L-"+u+",0Z")}},hourglass:{n:25,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(l,2);return h(s,p,"M"+u+","+u+"H-"+u+"L"+u+",-"+u+"H-"+u+"Z")},noDot:!0},bowtie:{n:26,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(l,2);return h(s,p,"M"+u+","+u+"V-"+u+"L-"+u+","+u+"V-"+u+"Z")},noDot:!0},"circle-cross":{n:27,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(l,2);return h(s,p,"M0,"+u+"V-"+u+"M"+u+",0H-"+u+"M"+u+",0A"+u+","+u+" 0 1,1 0,-"+u+"A"+u+","+u+" 0 0,1 "+u+",0Z")},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(l,2),i=t(l/n,2);return h(s,p,"M"+i+","+i+"L-"+i+",-"+i+"M"+i+",-"+i+"L-"+i+","+i+"M"+u+",0A"+u+","+u+" 0 1,1 0,-"+u+"A"+u+","+u+" 0 0,1 "+u+",0Z")},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(l,2);return h(s,p,"M0,"+u+"V-"+u+"M"+u+",0H-"+u+"M"+u+","+u+"H-"+u+"V-"+u+"H"+u+"Z")},needLine:!0,noDot:!0},"square-x":{n:30,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(l,2);return h(s,p,"M"+u+","+u+"L-"+u+",-"+u+"M"+u+",-"+u+"L-"+u+","+u+"M"+u+","+u+"H-"+u+"V-"+u+"H"+u+"Z")},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(1.3*l,2);return h(s,p,"M"+u+",0L0,"+u+"L-"+u+",0L0,-"+u+"ZM0,-"+u+"V"+u+"M-"+u+",0H"+u)},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(1.3*l,2),i=t(.65*l,2);return h(s,p,"M"+u+",0L0,"+u+"L-"+u+",0L0,-"+u+"ZM-"+i+",-"+i+"L"+i+","+i+"M-"+i+","+i+"L"+i+",-"+i)},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(1.4*l,2);return h(s,p,"M0,"+u+"V-"+u+"M"+u+",0H-"+u)},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(l,2);return h(s,p,"M"+u+","+u+"L-"+u+",-"+u+"M"+u+",-"+u+"L-"+u+","+u)},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(1.2*l,2),i=t(.85*l,2);return h(s,p,"M0,"+u+"V-"+u+"M"+u+",0H-"+u+"M"+i+","+i+"L-"+i+",-"+i+"M"+i+",-"+i+"L-"+i+","+i)},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(l/2,2),i=t(l,2);return h(s,p,"M"+u+","+i+"V-"+i+"M"+(u-i)+",-"+i+"V"+i+"M"+i+","+u+"H-"+i+"M-"+i+","+(u-i)+"H"+i)},needLine:!0,noFill:!0},"y-up":{n:37,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(1.2*l,2),i=t(1.6*l,2),x=t(.8*l,2);return h(s,p,"M-"+u+","+x+"L0,0M"+u+","+x+"L0,0M0,-"+i+"L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(1.2*l,2),i=t(1.6*l,2),x=t(.8*l,2);return h(s,p,"M-"+u+",-"+x+"L0,0M"+u+",-"+x+"L0,0M0,"+i+"L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(1.2*l,2),i=t(1.6*l,2),x=t(.8*l,2);return h(s,p,"M"+x+","+u+"L0,0M"+x+",-"+u+"L0,0M-"+i+",0L0,0")},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(1.2*l,2),i=t(1.6*l,2),x=t(.8*l,2);return h(s,p,"M-"+x+","+u+"L0,0M-"+x+",-"+u+"L0,0M"+i+",0L0,0")},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(1.4*l,2);return h(s,p,"M"+u+",0H-"+u)},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(1.4*l,2);return h(s,p,"M0,"+u+"V-"+u)},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(l,2);return h(s,p,"M"+u+",-"+u+"L-"+u+","+u)},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(l,2);return h(s,p,"M"+u+","+u+"L-"+u+",-"+u)},needLine:!0,noDot:!0,noFill:!0},"arrow-up":{n:45,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(l,2);return h(s,p,"M0,0L-"+u+","+t(2*l,2)+"H"+u+"Z")},backoff:1,noDot:!0},"arrow-down":{n:46,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(l,2);return h(s,p,"M0,0L-"+u+",-"+t(2*l,2)+"H"+u+"Z")},noDot:!0},"arrow-left":{n:47,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(2*l,2),i=t(l,2);return h(s,p,"M0,0L"+u+",-"+i+"V"+i+"Z")},noDot:!0},"arrow-right":{n:48,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(2*l,2),i=t(l,2);return h(s,p,"M0,0L-"+u+",-"+i+"V"+i+"Z")},noDot:!0},"arrow-bar-up":{n:49,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(l,2);return h(s,p,"M-"+u+",0H"+u+"M0,0L-"+u+","+t(2*l,2)+"H"+u+"Z")},backoff:1,needLine:!0,noDot:!0},"arrow-bar-down":{n:50,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(l,2);return h(s,p,"M-"+u+",0H"+u+"M0,0L-"+u+",-"+t(2*l,2)+"H"+u+"Z")},needLine:!0,noDot:!0},"arrow-bar-left":{n:51,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(2*l,2),i=t(l,2);return h(s,p,"M0,-"+i+"V"+i+"M0,0L"+u+",-"+i+"V"+i+"Z")},needLine:!0,noDot:!0},"arrow-bar-right":{n:52,f:function(l,s,p){if(a(s))return"M0,0Z";var u=t(2*l,2),i=t(l,2);return h(s,p,"M0,-"+i+"V"+i+"M0,0L-"+u+",-"+i+"V"+i+"Z")},needLine:!0,noDot:!0},arrow:{n:53,f:function(l,s,p){if(a(s))return"M0,0Z";var u=r/2.5,i=2*l*g(u),x=2*l*c(u);return h(s,p,"M0,0L"+-i+","+x+"L"+i+","+x+"Z")},backoff:.9,noDot:!0},"arrow-wide":{n:54,f:function(l,s,p){if(a(s))return"M0,0Z";var u=r/4,i=2*l*g(u),x=2*l*c(u);return h(s,p,"M0,0L"+-i+","+x+"A "+2*l+","+2*l+" 0 0 1 "+i+","+x+"Z")},backoff:.4,noDot:!0}}},{"@plotly/d3":58,"parse-svg-path":250}],391:[function(m,G,Y){G.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],392:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../registry"),w=m("../../plots/cartesian/axes"),y=m("../../lib"),e=m("./compute_error");function t(n,o,r,g){var c=o["error_"+g]||{},a=[];if(c.visible&&["linear","log"].indexOf(r.type)!==-1){for(var h=e(c),l=0;l<n.length;l++){var s=n[l],p=s.i;if(p===void 0)p=l;else if(p===null)continue;var u=s[g];if(d(r.c2l(u))){var i=h(u,p);if(d(i[0])&&d(i[1])){var x=s[g+"s"]=u-i[0],f=s[g+"h"]=u+i[1];a.push(x,f)}}}var _=r._id,b=o._extremes[_],T=w.findExtremes(r,a,y.extendFlat({tozero:b.opts.tozero},{padded:!0}));b.min=b.min.concat(T.min),b.max=b.max.concat(T.max)}}G.exports=function(n){for(var o=n.calcdata,r=0;r<o.length;r++){var g=o[r],c=g[0].trace;if(c.visible===!0&&v.traceIs(c,"errorBarsOK")){var a=w.getFromId(n,c.xaxis),h=w.getFromId(n,c.yaxis);t(g,c,a,"x"),t(g,c,h,"y")}}}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./compute_error":393,"fast-isnumeric":190}],393:[function(m,G,Y){function d(v,w){return v==="percent"?function(y){return Math.abs(y*w/100)}:v==="constant"?function(){return Math.abs(w)}:v==="sqrt"?function(y){return Math.sqrt(Math.abs(y))}:void 0}G.exports=function(v){var w=v.type,y=v.symmetric;if(w==="data"){var e=v.array||[];if(y)return function(r,g){var c=+e[g];return[c,c]};var t=v.arrayminus||[];return function(r,g){var c=+e[g],a=+t[g];return isNaN(c)&&isNaN(a)?[NaN,NaN]:[a||0,c||0]}}var n=d(w,v.value),o=d(w,v.valueminus);return y||v.valueminus===void 0?function(r){var g=n(r);return[g,g]}:function(r){return[o(r),n(r)]}}},{}],394:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../registry"),w=m("../../lib"),y=m("../../plot_api/plot_template"),e=m("./attributes");G.exports=function(t,n,o,r){var g="error_"+r.axis,c=y.newContainer(n,g),a=t[g]||{};function h(u,i){return w.coerce(a,c,e,u,i)}if(h("visible",a.array!==void 0||a.value!==void 0||a.type==="sqrt")!==!1){var l=h("type","array"in a?"data":"percent"),s=!0;l!=="sqrt"&&(s=h("symmetric",!((l==="data"?"arrayminus":"valueminus")in a))),l==="data"?(h("array"),h("traceref"),s||(h("arrayminus"),h("tracerefminus"))):l!=="percent"&&l!=="constant"||(h("value"),s||h("valueminus"));var p="copy_"+r.inherit+"style";r.inherit&&(n["error_"+r.inherit]||{}).visible&&h(p,!(a.color||d(a.thickness)||d(a.width))),r.inherit&&c[p]||(h("color",o),h("thickness"),h("width",v.traceIs(n,"gl3d")?0:4))}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"./attributes":391,"fast-isnumeric":190}],395:[function(m,G,Y){var d=m("../../lib"),v=m("../../plot_api/edit_types").overrideAll,w=m("./attributes"),y={error_x:d.extendFlat({},w),error_y:d.extendFlat({},w)};delete y.error_x.copy_zstyle,delete y.error_y.copy_zstyle,delete y.error_y.copy_ystyle;var e={error_x:d.extendFlat({},w),error_y:d.extendFlat({},w),error_z:d.extendFlat({},w)};delete e.error_x.copy_ystyle,delete e.error_y.copy_ystyle,delete e.error_z.copy_ystyle,delete e.error_z.copy_zstyle,G.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:y,bar:y,histogram:y,scatter3d:v(e,"calc","nested"),scattergl:v(y,"calc","nested")}},supplyDefaults:m("./defaults"),calc:m("./calc"),makeComputeError:m("./compute_error"),plot:m("./plot"),style:m("./style"),hoverInfo:function(t,n,o){(n.error_y||{}).visible&&(o.yerr=t.yh-t.y,n.error_y.symmetric||(o.yerrneg=t.y-t.ys)),(n.error_x||{}).visible&&(o.xerr=t.xh-t.x,n.error_x.symmetric||(o.xerrneg=t.x-t.xs))}}},{"../../lib":515,"../../plot_api/edit_types":548,"./attributes":391,"./calc":392,"./compute_error":393,"./defaults":394,"./plot":396,"./style":397}],396:[function(m,G,Y){var d=m("@plotly/d3"),v=m("fast-isnumeric"),w=m("../drawing"),y=m("../../traces/scatter/subtypes");G.exports=function(e,t,n,o){var r=n.xaxis,g=n.yaxis,c=o&&o.duration>0;t.each(function(a){var h,l=a[0].trace,s=l.error_x||{},p=l.error_y||{};l.ids&&(h=function(f){return f.id});var u=y.hasMarkers(l)&&l.marker.maxdisplayed>0;p.visible||s.visible||(a=[]);var i=d.select(this).selectAll("g.errorbar").data(a,h);if(i.exit().remove(),a.length){s.visible||i.selectAll("path.xerror").remove(),p.visible||i.selectAll("path.yerror").remove(),i.style("opacity",1);var x=i.enter().append("g").classed("errorbar",!0);c&&x.style("opacity",0).transition().duration(o.duration).style("opacity",1),w.setClipUrl(i,n.layerClipId,e),i.each(function(f){var _=d.select(this),b=function(P,S,E){var z={x:S.c2p(P.x),y:E.c2p(P.y)};return P.yh!==void 0&&(z.yh=E.c2p(P.yh),z.ys=E.c2p(P.ys),v(z.ys)||(z.noYS=!0,z.ys=E.c2p(P.ys,!0))),P.xh!==void 0&&(z.xh=S.c2p(P.xh),z.xs=S.c2p(P.xs),v(z.xs)||(z.noXS=!0,z.xs=S.c2p(P.xs,!0))),z}(f,r,g);if(!u||f.vis){var T,k=_.select("path.yerror");if(p.visible&&v(b.x)&&v(b.yh)&&v(b.ys)){var L=p.width;T="M"+(b.x-L)+","+b.yh+"h"+2*L+"m-"+L+",0V"+b.ys,b.noYS||(T+="m-"+L+",0h"+2*L),k.size()?c&&(k=k.transition().duration(o.duration).ease(o.easing)):k=_.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0),k.attr("d",T)}else k.remove();var A=_.select("path.xerror");if(s.visible&&v(b.y)&&v(b.xh)&&v(b.xs)){var I=(s.copy_ystyle?p:s).width;T="M"+b.xh+","+(b.y-I)+"v"+2*I+"m0,-"+I+"H"+b.xs,b.noXS||(T+="m0,-"+I+"v"+2*I),A.size()?c&&(A=A.transition().duration(o.duration).ease(o.easing)):A=_.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0),A.attr("d",T)}else A.remove()}})}})}},{"../../traces/scatter/subtypes":961,"../drawing":389,"@plotly/d3":58,"fast-isnumeric":190}],397:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../color");G.exports=function(w){w.each(function(y){var e=y[0].trace,t=e.error_y||{},n=e.error_x||{},o=d.select(this);o.selectAll("path.yerror").style("stroke-width",t.thickness+"px").call(v.stroke,t.color),n.copy_ystyle&&(n=t),o.selectAll("path.xerror").style("stroke-width",n.thickness+"px").call(v.stroke,n.color)})}},{"../color":367,"@plotly/d3":58}],398:[function(m,G,Y){var d=m("../../plots/font_attributes"),v=m("./layout_attributes").hoverlabel,w=m("../../lib/extend").extendFlat;G.exports={hoverlabel:{bgcolor:w({},v.bgcolor,{arrayOk:!0}),bordercolor:w({},v.bordercolor,{arrayOk:!0}),font:d({arrayOk:!0,editType:"none"}),align:w({},v.align,{arrayOk:!0}),namelength:w({},v.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":505,"../../plots/font_attributes":594,"./layout_attributes":408}],399:[function(m,G,Y){var d=m("../../lib"),v=m("../../registry");function w(y,e,t,n){n=n||d.identity,Array.isArray(y)&&(e[0][t]=n(y))}G.exports=function(y){var e=y.calcdata,t=y._fullLayout;function n(a){return function(h){return d.coerceHoverinfo({hoverinfo:h},{_module:a._module},t)}}for(var o=0;o<e.length;o++){var r=e[o],g=r[0].trace;if(!v.traceIs(g,"pie-like")){var c=v.traceIs(g,"2dMap")?w:d.fillArray;c(g.hoverinfo,r,"hi",n(g)),g.hovertemplate&&c(g.hovertemplate,r,"ht"),g.hoverlabel&&(c(g.hoverlabel.bgcolor,r,"hbg"),c(g.hoverlabel.bordercolor,r,"hbc"),c(g.hoverlabel.font.size,r,"hts"),c(g.hoverlabel.font.color,r,"htc"),c(g.hoverlabel.font.family,r,"htf"),c(g.hoverlabel.namelength,r,"hnl"),c(g.hoverlabel.align,r,"hta"))}}}},{"../../lib":515,"../../registry":647}],400:[function(m,G,Y){var d=m("../../registry"),v=m("./hover").hover;G.exports=function(w,y,e){var t=d.getComponentMethod("annotations","onClick")(w,w._hoverdata);function n(){w.emit("plotly_click",{points:w._hoverdata,event:y})}e!==void 0&&v(w,y,e,!0),w._hoverdata&&y&&y.target&&(t&&t.then?t.then(n):n(),y.stopImmediatePropagation&&y.stopImmediatePropagation())}},{"../../registry":647,"./hover":404}],401:[function(m,G,Y){G.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],402:[function(m,G,Y){var d=m("../../lib"),v=m("./attributes"),w=m("./hoverlabel_defaults");G.exports=function(y,e,t,n){var o=d.extendFlat({},n.hoverlabel);e.hovertemplate&&(o.namelength=-1),w(y,e,function(r,g){return d.coerce(y,e,v,r,g)},o)}},{"../../lib":515,"./attributes":398,"./hoverlabel_defaults":405}],403:[function(m,G,Y){var d=m("../../lib");Y.getSubplot=function(n){return n.subplot||n.xaxis+n.yaxis||n.geo},Y.isTraceInSubplots=function(n,o){if(n.type==="splom"){for(var r=n.xaxes||[],g=n.yaxes||[],c=0;c<r.length;c++)for(var a=0;a<g.length;a++)if(o.indexOf(r[c]+g[a])!==-1)return!0;return!1}return o.indexOf(Y.getSubplot(n))!==-1},Y.flat=function(n,o){for(var r=new Array(n.length),g=0;g<n.length;g++)r[g]=o;return r},Y.p2c=function(n,o){for(var r=new Array(n.length),g=0;g<n.length;g++)r[g]=n[g].p2c(o);return r},Y.getDistanceFunction=function(n,o,r,g){return n==="closest"?g||Y.quadrature(o,r):n.charAt(0)==="x"?o:r},Y.getClosest=function(n,o,r){if(r.index!==!1)r.index>=0&&r.index<n.length?r.distance=0:r.index=!1;else for(var g=0;g<n.length;g++){var c=o(n[g]);c<=r.distance&&(r.index=g,r.distance=c)}return r},Y.inbox=function(n,o,r){return n*o<0||n===0?r:1/0},Y.quadrature=function(n,o){return function(r){var g=n(r),c=o(r);return Math.sqrt(g*g+c*c)}},Y.makeEventData=function(n,o,r){var g="index"in n?n.index:n.pointNumber,c={data:o._input,fullData:o,curveNumber:o.index,pointNumber:g};if(o._indexToPoints){var a=o._indexToPoints[g];a.length===1?c.pointIndex=a[0]:c.pointIndices=a}else c.pointIndex=g;return o._module.eventData?c=o._module.eventData(c,n,o,r,g):("xVal"in n?c.x=n.xVal:"x"in n&&(c.x=n.x),"yVal"in n?c.y=n.yVal:"y"in n&&(c.y=n.y),n.xa&&(c.xaxis=n.xa),n.ya&&(c.yaxis=n.ya),n.zLabelVal!==void 0&&(c.z=n.zLabelVal)),Y.appendArrayPointValue(c,o,g),c},Y.appendArrayPointValue=function(n,o,r){var g=o._arrayAttrs;if(g)for(var c=0;c<g.length;c++){var a=g[c],h=w(a);if(n[h]===void 0){var l=y(d.nestedProperty(o,a).get(),r);l!==void 0&&(n[h]=l)}}},Y.appendArrayMultiPointValues=function(n,o,r){var g=o._arrayAttrs;if(g)for(var c=0;c<g.length;c++){var a=g[c],h=w(a);if(n[h]===void 0){for(var l=d.nestedProperty(o,a).get(),s=new Array(r.length),p=0;p<r.length;p++)s[p]=y(l,r[p]);n[h]=s}}};var v={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function w(n){return v[n]||n}function y(n,o){return Array.isArray(o)?Array.isArray(n)&&Array.isArray(n[o[0]])?n[o[0]][o[1]]:void 0:n[o]}var e={x:!0,y:!0},t={"x unified":!0,"y unified":!0};Y.isUnifiedHover=function(n){return typeof n=="string"&&!!t[n]},Y.isXYhover=function(n){return typeof n=="string"&&!!e[n]}},{"../../lib":515}],404:[function(m,G,Y){var d=m("@plotly/d3"),v=m("fast-isnumeric"),w=m("tinycolor2"),y=m("../../lib"),e=y.strTranslate,t=y.strRotate,n=m("../../lib/events"),o=m("../../lib/svg_text_utils"),r=m("../../lib/override_cursor"),g=m("../drawing"),c=m("../color"),a=m("../dragelement"),h=m("../../plots/cartesian/axes"),l=m("../../registry"),s=m("./helpers"),p=m("./constants"),u=m("../legend/defaults"),i=m("../legend/draw"),x=p.YANGLE,f=Math.PI*x/180,_=1/Math.sin(f),b=Math.cos(f),T=Math.sin(f),k=p.HOVERARROWSIZE,L=p.HOVERTEXTPAD,A={box:!0,ohlc:!0,violin:!0,candlestick:!0},I={scatter:!0,scattergl:!0,splom:!0};function P(N){return[N.trace.index,N.index,N.x0,N.y0,N.name,N.attr,N.xa?N.xa._id:"",N.ya?N.ya._id:""].join(",")}Y.hover=function(N,U,te,B){N=y.getGraphDiv(N);var K=U.target;y.throttle(N._fullLayout._uid+p.HOVERID,p.HOVERMINTIME,function(){(function(J,ee,ne,se,oe){ne||(ne="xy");var me=Array.isArray(ne)?ne:[ne],ce=J._fullLayout,ye=ce._plots||[],Se=ye[ne],fe=ce._has("cartesian");if(Se){var ge=Se.overlays.map(function(Hr){return Hr.id});me=me.concat(ge)}for(var Te=me.length,le=new Array(Te),ve=new Array(Te),Me=!1,we=0;we<Te;we++){var de=me[we];if(ye[de])Me=!0,le[we]=ye[de].xaxis,ve[we]=ye[de].yaxis;else{if(!ce[de]||!ce[de]._subplot)return void y.warn("Unrecognized subplot: "+de);var Ie=ce[de]._subplot;le[we]=Ie.xaxis,ve[we]=Ie.yaxis}}var De=ee.hovermode||ce.hovermode;if(De&&!Me&&(De="closest"),["x","y","closest","x unified","y unified"].indexOf(De)===-1||!J.calcdata||J.querySelector(".zoombox")||J._dragging)return a.unhoverRaw(J,ee);var Oe=ce.hoverdistance;Oe===-1&&(Oe=1/0);var Ve=ce.spikedistance;Ve===-1&&(Ve=1/0);var Fe,ze,Re,We,$e,at,gt,xt,mt,nt,Qe,vt,jt,Gt=[],$t=[],Zt={hLinePoint:null,vLinePoint:null},cr=!1;if(Array.isArray(ee))for(De="array",Re=0;Re<ee.length;Re++)($e=J.calcdata[ee[Re].curveNumber||0])&&(at=$e[0].trace,$e[0].trace.hoverinfo!=="skip"&&($t.push($e),at.orientation==="h"&&(cr=!0)));else{for(We=0;We<J.calcdata.length;We++)$e=J.calcdata[We],(at=$e[0].trace).hoverinfo!=="skip"&&s.isTraceInSubplots(at,me)&&($t.push($e),at.orientation==="h"&&(cr=!0));var Dt,Ne;if(!oe)Dt="xpx"in ee?ee.xpx:le[0]._length/2,Ne="ypx"in ee?ee.ypx:ve[0]._length/2;else{if(n.triggerHandler(J,"plotly_beforehover",ee)===!1)return;var Ye=oe.getBoundingClientRect();Dt=ee.clientX-Ye.left,Ne=ee.clientY-Ye.top,ce._calcInverseTransform(J);var pe=y.apply3DTransform(ce._invTransform)(Dt,Ne);if(Dt=pe[0],Ne=pe[1],Dt<0||Dt>le[0]._length||Ne<0||Ne>ve[0]._length)return a.unhoverRaw(J,ee)}if(ee.pointerX=Dt+le[0]._offset,ee.pointerY=Ne+ve[0]._offset,Fe="xval"in ee?s.flat(me,ee.xval):s.p2c(le,Dt),ze="yval"in ee?s.flat(me,ee.yval):s.p2c(ve,Ne),!v(Fe[0])||!v(ze[0]))return y.warn("Fx.hover failed",ee,J),a.unhoverRaw(J,ee)}var _e=1/0;function Be(Hr,ln){for(We=0;We<$t.length;We++)if(($e=$t[We])&&$e[0]&&$e[0].trace&&(at=$e[0].trace).visible===!0&&at._length!==0&&["carpet","contourcarpet"].indexOf(at._module.name)===-1){if(at.type==="splom"?gt=me[xt=0]:(gt=s.getSubplot(at),xt=me.indexOf(gt)),mt=De,s.isUnifiedHover(mt)&&(mt=mt.charAt(0)),vt={cd:$e,trace:at,xa:le[xt],ya:ve[xt],maxHoverDistance:Oe,maxSpikeDistance:Ve,index:!1,distance:Math.min(_e,Oe),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:c.defaultLine,name:at.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},ce[gt]&&(vt.subplot=ce[gt]._subplot),ce._splomScenes&&ce._splomScenes[at.uid]&&(vt.scene=ce._splomScenes[at.uid]),jt=Gt.length,mt==="array"){var bn=ee[We];"pointNumber"in bn?(vt.index=bn.pointNumber,mt="closest"):(mt="","xval"in bn&&(nt=bn.xval,mt="x"),"yval"in bn&&(Qe=bn.yval,mt=mt?"closest":"y"))}else Hr!==void 0&&ln!==void 0?(nt=Hr,Qe=ln):(nt=Fe[xt],Qe=ze[xt]);if(Oe!==0)if(at._module&&at._module.hoverPoints){var nn=at._module.hoverPoints(vt,nt,Qe,mt,{finiteRange:!0,hoverLayer:ce._hoverlayer});if(nn)for(var pn,qn=0;qn<nn.length;qn++)pn=nn[qn],v(pn.x0)&&v(pn.y0)&&Gt.push(j(pn,De))}else y.log("Unrecognized trace type in hover:",at);if(De==="closest"&&Gt.length>jt&&(Gt.splice(0,jt),_e=Gt[0].distance),fe&&Ve!==0&&Gt.length===0){vt.distance=Ve,vt.index=!1;var sr=at._module.hoverPoints(vt,nt,Qe,"closest",{hoverLayer:ce._hoverlayer});if(sr&&(sr=sr.filter(function(ir){return ir.spikeDistance<=Ve})),sr&&sr.length){var xr,jr=sr.filter(function(ir){return ir.xa.showspikes&&ir.xa.spikesnap!=="hovered data"});if(jr.length){var Rt=jr[0];v(Rt.x0)&&v(Rt.y0)&&(xr=Je(Rt),(!Zt.vLinePoint||Zt.vLinePoint.spikeDistance>xr.spikeDistance)&&(Zt.vLinePoint=xr))}var or=sr.filter(function(ir){return ir.ya.showspikes&&ir.ya.spikesnap!=="hovered data"});if(or.length){var wt=or[0];v(wt.x0)&&v(wt.y0)&&(xr=Je(wt),(!Zt.hLinePoint||Zt.hLinePoint.spikeDistance>xr.spikeDistance)&&(Zt.hLinePoint=xr))}}}}}function He(Hr,ln,bn){for(var nn,pn=null,qn=1/0,sr=0;sr<Hr.length;sr++)nn=Hr[sr].spikeDistance,bn&&sr===0&&(nn=-1/0),nn<=qn&&nn<=ln&&(pn=Hr[sr],qn=nn);return pn}function Je(Hr){return Hr?{xa:Hr.xa,ya:Hr.ya,x:Hr.xSpike!==void 0?Hr.xSpike:(Hr.x0+Hr.x1)/2,y:Hr.ySpike!==void 0?Hr.ySpike:(Hr.y0+Hr.y1)/2,distance:Hr.distance,spikeDistance:Hr.spikeDistance,curveNumber:Hr.trace.index,color:Hr.color,pointNumber:Hr.index}:null}Be();var Ze={fullLayout:ce,container:ce._hoverlayer,event:ee},ct=J._spikepoints,lt={vLinePoint:Zt.vLinePoint,hLinePoint:Zt.hLinePoint};J._spikepoints=lt;var At=function(){Gt.sort(function(Hr,ln){return Hr.distance-ln.distance}),Gt=function(Hr,ln){for(var bn=ln.charAt(0),nn=[],pn=[],qn=[],sr=0;sr<Hr.length;sr++){var xr=Hr[sr];l.traceIs(xr.trace,"bar-like")||l.traceIs(xr.trace,"box-violin")?qn.push(xr):xr.trace[bn+"period"]?pn.push(xr):nn.push(xr)}return nn.concat(pn).concat(qn)}(Gt,De)};At();var Ot=De.charAt(0),it=(Ot==="x"||Ot==="y")&&Gt[0]&&I[Gt[0].trace.type];if(fe&&Ve!==0&&Gt.length!==0){var ht=He(Gt.filter(function(Hr){return Hr.ya.showspikes}),Ve,it);Zt.hLinePoint=Je(ht);var Ut=He(Gt.filter(function(Hr){return Hr.xa.showspikes}),Ve,it);Zt.vLinePoint=Je(Ut)}if(Gt.length===0){var Mt=a.unhoverRaw(J,ee);return!fe||Zt.hLinePoint===null&&Zt.vLinePoint===null||Z(ct)&&V(J,Zt,Ze),Mt}if(fe&&Z(ct)&&V(J,Zt,Ze),s.isXYhover(mt)&&Gt[0].length!==0&&Gt[0].trace.type!=="splom"){var It=Gt[0],Le=(Gt=A[It.trace.type]?Gt.filter(function(Hr){return Hr.trace.index===It.trace.index}):[It]).length,Xe=X("x",It,ce),ot=X("y",It,ce);Be(Xe,ot);var pt,St=[],Vt={},Jt=0,qt=function(Hr){var ln=A[Hr.trace.type]?P(Hr):Hr.trace.index;if(Vt[ln]){var bn=Vt[ln]-1,nn=St[bn];bn>0&&Math.abs(Hr.distance)<Math.abs(nn.distance)&&(St[bn]=Hr)}else Jt++,Vt[ln]=Jt,St.push(Hr)};for(pt=0;pt<Le;pt++)qt(Gt[pt]);for(pt=Gt.length-1;pt>Le-1;pt--)qt(Gt[pt]);Gt=St,At()}var gr=J._hoverdata,Cr=[],mr=$(J),tr=re(J);for(Re=0;Re<Gt.length;Re++){var nr=Gt[Re],Qt=s.makeEventData(nr,nr.trace,nr.cd);if(nr.hovertemplate!==!1){var dr=!1;nr.cd[nr.index]&&nr.cd[nr.index].ht&&(dr=nr.cd[nr.index].ht),nr.hovertemplate=dr||nr.trace.hovertemplate||!1}if(nr.xa&&nr.ya){var _r=nr.x0+nr.xa._offset,Ir=nr.x1+nr.xa._offset,Rr=nr.y0+nr.ya._offset,Vr=nr.y1+nr.ya._offset,Xr=Math.min(_r,Ir),cn=Math.max(_r,Ir),an=Math.min(Rr,Vr),zn=Math.max(Rr,Vr);Qt.bbox={x0:Xr+tr,x1:cn+tr,y0:an+mr,y1:zn+mr}}nr.eventData=[Qt],Cr.push(Qt)}J._hoverdata=Cr;var on=De==="y"&&($t.length>1||Gt.length>1)||De==="closest"&&cr&&Gt.length>1,Tn=c.combine(ce.plot_bgcolor||c.background,ce.paper_bgcolor),Mn=E(Gt,{gd:J,hovermode:De,rotateLabels:on,bgColor:Tn,container:ce._hoverlayer,outerContainer:ce._paper.node(),commonLabelOpts:ce.hoverlabel,hoverdistance:ce.hoverdistance});if(s.isUnifiedHover(De)||(function(Hr,ln,bn){var nn,pn,qn,sr,xr,jr,Rt,or=0,wt=1,ir=Hr.size(),ar=new Array(ir),Dr=0;function Pr(Yr){var rn=Yr[0],sn=Yr[Yr.length-1];if(pn=rn.pmin-rn.pos-rn.dp+rn.size,qn=sn.pos+sn.dp+sn.size-rn.pmax,pn>.01){for(xr=Yr.length-1;xr>=0;xr--)Yr[xr].dp+=pn;nn=!1}if(!(qn<.01)){if(pn<-.01){for(xr=Yr.length-1;xr>=0;xr--)Yr[xr].dp-=qn;nn=!1}if(nn){var yn=0;for(sr=0;sr<Yr.length;sr++)(jr=Yr[sr]).pos+jr.dp+jr.size>rn.pmax&&yn++;for(sr=Yr.length-1;sr>=0&&!(yn<=0);sr--)(jr=Yr[sr]).pos>rn.pmax-1&&(jr.del=!0,yn--);for(sr=0;sr<Yr.length&&!(yn<=0);sr++)if((jr=Yr[sr]).pos<rn.pmin+1)for(jr.del=!0,yn--,qn=2*jr.size,xr=Yr.length-1;xr>=0;xr--)Yr[xr].dp-=qn;for(sr=Yr.length-1;sr>=0&&!(yn<=0);sr--)(jr=Yr[sr]).pos+jr.dp+jr.size>rn.pmax&&(jr.del=!0,yn--)}}}for(Hr.each(function(Yr){var rn=Yr[ln],sn=rn._id.charAt(0)==="x",yn=rn.range;Dr===0&&yn&&yn[0]>yn[1]!==sn&&(wt=-1),ar[Dr++]=[{datum:Yr,traceIndex:Yr.trace.index,dp:0,pos:Yr.pos,posref:Yr.posref,size:Yr.by*(sn?_:1)/2,pmin:0,pmax:sn?bn.width:bn.height}]}),ar.sort(function(Yr,rn){return Yr[0].posref-rn[0].posref||wt*(rn[0].traceIndex-Yr[0].traceIndex)});!nn&&or<=ir;){for(or++,nn=!0,sr=0;sr<ar.length-1;){var Er=ar[sr],Ar=ar[sr+1],vr=Er[Er.length-1],wr=Ar[0];if((pn=vr.pos+vr.dp+vr.size-wr.pos-wr.dp+wr.size)>.01&&vr.pmin===wr.pmin&&vr.pmax===wr.pmax){for(xr=Ar.length-1;xr>=0;xr--)Ar[xr].dp+=pn;for(Er.push.apply(Er,Ar),ar.splice(sr+1,1),Rt=0,xr=Er.length-1;xr>=0;xr--)Rt+=Er[xr].dp;for(qn=Rt/Er.length,xr=Er.length-1;xr>=0;xr--)Er[xr].dp-=qn;nn=!1}else sr++}ar.forEach(Pr)}for(sr=ar.length-1;sr>=0;sr--){var Mr=ar[sr];for(xr=Mr.length-1;xr>=0;xr--){var Lr=Mr[xr],Zr=Lr.datum;Zr.offset=Lr.dp,Zr.del=Lr.del}}}(Mn,on?"xa":"ya",ce),D(Mn,on,ce._invScaleX,ce._invScaleY)),oe&&oe.tagName){var ei=l.getComponentMethod("annotations","hasClickToShow")(J,Cr);r(d.select(oe),ei?"pointer":"")}!oe||se||!function(Hr,ln,bn){if(!bn||bn.length!==Hr._hoverdata.length)return!0;for(var nn=bn.length-1;nn>=0;nn--){var pn=bn[nn],qn=Hr._hoverdata[nn];if(pn.curveNumber!==qn.curveNumber||String(pn.pointNumber)!==String(qn.pointNumber)||String(pn.pointNumbers)!==String(qn.pointNumbers))return!0}return!1}(J,0,gr)||(gr&&J.emit("plotly_unhover",{event:ee,points:gr}),J.emit("plotly_hover",{event:ee,points:J._hoverdata,xaxes:le,yaxes:ve,xvals:Fe,yvals:ze}))})(N,U,te,B,K)})},Y.loneHover=function(N,U){var te=!0;Array.isArray(N)||(te=!1,N=[N]);var B=U.gd,K=$(B),J=re(B),ee=E(N.map(function(oe){var me=oe._x0||oe.x0||oe.x||0,ce=oe._x1||oe.x1||oe.x||0,ye=oe._y0||oe.y0||oe.y||0,Se=oe._y1||oe.y1||oe.y||0,fe=oe.eventData;if(fe){var ge=Math.min(me,ce),Te=Math.max(me,ce),le=Math.min(ye,Se),ve=Math.max(ye,Se),Me=oe.trace;if(l.traceIs(Me,"gl3d")){var we=B._fullLayout[Me.scene]._scene.container,de=we.offsetLeft,Ie=we.offsetTop;ge+=de,Te+=de,le+=Ie,ve+=Ie}fe.bbox={x0:ge+J,x1:Te+J,y0:le+K,y1:ve+K},U.inOut_bbox&&U.inOut_bbox.push(fe.bbox)}else fe=!1;return{color:oe.color||c.defaultLine,x0:oe.x0||oe.x||0,x1:oe.x1||oe.x||0,y0:oe.y0||oe.y||0,y1:oe.y1||oe.y||0,xLabel:oe.xLabel,yLabel:oe.yLabel,zLabel:oe.zLabel,text:oe.text,name:oe.name,idealAlign:oe.idealAlign,borderColor:oe.borderColor,fontFamily:oe.fontFamily,fontSize:oe.fontSize,fontColor:oe.fontColor,nameLength:oe.nameLength,textAlign:oe.textAlign,trace:oe.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:oe.hovertemplate||!1,hovertemplateLabels:oe.hovertemplateLabels||!1,eventData:fe}}),{gd:B,hovermode:"closest",rotateLabels:!1,bgColor:U.bgColor||c.background,container:d.select(U.container),outerContainer:U.outerContainer||U.container}),ne=0,se=0;return ee.sort(function(oe,me){return oe.y0-me.y0}).each(function(oe,me){var ce=oe.y0-oe.by/2;oe.offset=ce-5<ne?ne-ce+5:0,ne=ce+oe.by+oe.offset,me===U.anchorIndex&&(se=oe.offset)}).each(function(oe){oe.offset-=se}),D(ee,!1,B._fullLayout._invScaleX,B._fullLayout._invScaleY),te?ee:ee.node()};var S=/<extra>([\s\S]*)<\/extra>/;function E(N,U){var te=U.gd,B=te._fullLayout,K=U.hovermode,J=U.rotateLabels,ee=U.bgColor,ne=U.container,se=U.outerContainer,oe=U.commonLabelOpts||{};if(N.length===0)return[[]];var me=U.fontFamily||p.HOVERFONT,ce=U.fontSize||p.HOVERFONTSIZE,ye=N[0],Se=ye.xa,fe=ye.ya,ge=K.charAt(0),Te=ye[ge+"Label"],le=H(te,se),ve=le.top,Me=le.width,we=le.height,de=Te!==void 0&&ye.distance<=U.hoverdistance&&(K==="x"||K==="y");if(de){var Ie,De,Oe=!0;for(Ie=0;Ie<N.length;Ie++)if(Oe&&N[Ie].zLabel===void 0&&(Oe=!1),De=N[Ie].hoverinfo||N[Ie].trace.hoverinfo){var Ve=Array.isArray(De)?De:De.split("+");if(Ve.indexOf("all")===-1&&Ve.indexOf(K)===-1){de=!1;break}}Oe&&(de=!1)}var Fe=ne.selectAll("g.axistext").data(de?[0]:[]);if(Fe.enter().append("g").classed("axistext",!0),Fe.exit().remove(),Fe.each(function(){var it=d.select(this),ht=y.ensureSingle(it,"path","",function(Ir){Ir.style({"stroke-width":"1px"})}),Ut=y.ensureSingle(it,"text","",function(Ir){Ir.attr("data-notex",1)}),Mt=oe.bgcolor||c.defaultLine,It=oe.bordercolor||c.contrast(Mt),Le=c.contrast(Mt),Xe={family:oe.font.family||me,size:oe.font.size||ce,color:oe.font.color||Le};ht.style({fill:Mt,stroke:It}),Ut.text(Te).call(g.font,Xe).call(o.positionText,0,0).call(o.convertToTspans,te),it.attr("transform","");var ot,pt,St=H(te,Ut.node());if(K==="x"){var Vt=Se.side==="top"?"-":"";Ut.attr("text-anchor","middle").call(o.positionText,0,Se.side==="top"?ve-St.bottom-k-L:ve-St.top+k+L),ot=Se._offset+(ye.x0+ye.x1)/2,pt=fe._offset+(Se.side==="top"?0:fe._length);var Jt=St.width/2+L;ot<Jt?(ot=Jt,ht.attr("d","M-"+(Jt-k)+",0L-"+(Jt-2*k)+","+Vt+k+"H"+(L+St.width/2)+"v"+Vt+(2*L+St.height)+"H-"+Jt+"V"+Vt+k+"Z")):ot>B.width-Jt?(ot=B.width-Jt,ht.attr("d","M"+(Jt-k)+",0L"+Jt+","+Vt+k+"v"+Vt+(2*L+St.height)+"H-"+Jt+"V"+Vt+k+"H"+(Jt-2*k)+"Z")):ht.attr("d","M0,0L"+k+","+Vt+k+"H"+(L+St.width/2)+"v"+Vt+(2*L+St.height)+"H-"+(L+St.width/2)+"V"+Vt+k+"H-"+k+"Z")}else{var qt,gr,Cr;fe.side==="right"?(qt="start",gr=1,Cr="",ot=Se._offset+Se._length):(qt="end",gr=-1,Cr="-",ot=Se._offset),pt=fe._offset+(ye.y0+ye.y1)/2,Ut.attr("text-anchor",qt),ht.attr("d","M0,0L"+Cr+k+","+k+"V"+(L+St.height/2)+"h"+Cr+(2*L+St.width)+"V-"+(L+St.height/2)+"H"+Cr+k+"V-"+k+"Z");var mr,tr=St.height/2,nr=ve-St.top-tr,Qt="clip"+B._uid+"commonlabel"+fe._id;if(ot<St.width+2*L+k){mr="M-"+(k+L)+"-"+tr+"h-"+(St.width-L)+"V"+tr+"h"+(St.width-L)+"Z";var dr=St.width-ot+L;o.positionText(Ut,dr,nr),qt==="end"&&Ut.selectAll("tspan").each(function(){var Ir=d.select(this),Rr=g.tester.append("text").text(Ir.text()).call(g.font,Xe),Vr=H(te,Rr.node());Math.round(Vr.width)<Math.round(St.width)&&Ir.attr("x",dr-Vr.width),Rr.remove()})}else o.positionText(Ut,gr*(L+k),nr),mr=null;var _r=B._topclips.selectAll("#"+Qt).data(mr?[0]:[]);_r.enter().append("clipPath").attr("id",Qt).append("path"),_r.exit().remove(),_r.select("path").attr("d",mr),g.setClipUrl(Ut,mr?Qt:null,te)}it.attr("transform",e(ot,pt))}),s.isUnifiedHover(K)){ne.selectAll("g.hovertext").remove();var ze=N.filter(function(it){return it.hoverinfo!=="none"});if(ze.length===0)return;var Re=B.hoverlabel,We=Re.font,$e={showlegend:!0,legend:{title:{text:Te,font:We},font:We,bgcolor:Re.bgcolor,bordercolor:Re.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:B.legend?B.legend.traceorder:void 0,orientation:"v"}},at={font:We};u($e,at,te._fullData);var gt=at.legend;gt.entries=[];for(var xt=0;xt<ze.length;xt++){var mt=ze[xt];if(mt.hoverinfo!=="none"){var nt=z(mt,!0,K,B,Te),Qe=nt[0],vt=nt[1];mt.name=vt,mt.text=vt!==""?vt+" : "+Qe:Qe;var jt=mt.cd[mt.index];jt&&(jt.mc&&(mt.mc=jt.mc),jt.mcc&&(mt.mc=jt.mcc),jt.mlc&&(mt.mlc=jt.mlc),jt.mlcc&&(mt.mlc=jt.mlcc),jt.mlw&&(mt.mlw=jt.mlw),jt.mrc&&(mt.mrc=jt.mrc),jt.dir&&(mt.dir=jt.dir)),mt._distinct=!0,gt.entries.push([mt])}}gt.entries.sort(function(it,ht){return it[0].trace.index-ht[0].trace.index}),gt.layer=ne,gt._inHover=!0,gt._groupTitleFont=Re.grouptitlefont,i(te,gt);var Gt,$t,Zt,cr,Dt=ne.select("g.legend"),Ne=H(te,Dt.node()),Ye=Ne.width+2*L,pe=Ne.height+2*L,_e=ze[0],Be=(_e.x0+_e.x1)/2,He=(_e.y0+_e.y1)/2,Je=!(l.traceIs(_e.trace,"bar-like")||l.traceIs(_e.trace,"box-violin"));ge==="y"?Je?($t=He-L,Gt=He+L):($t=Math.min.apply(null,ze.map(function(it){return Math.min(it.y0,it.y1)})),Gt=Math.max.apply(null,ze.map(function(it){return Math.max(it.y0,it.y1)}))):$t=Gt=y.mean(ze.map(function(it){return(it.y0+it.y1)/2}))-pe/2,ge==="x"?Je?(Zt=Be+L,cr=Be-L):(Zt=Math.max.apply(null,ze.map(function(it){return Math.max(it.x0,it.x1)})),cr=Math.min.apply(null,ze.map(function(it){return Math.min(it.x0,it.x1)}))):Zt=cr=y.mean(ze.map(function(it){return(it.x0+it.x1)/2}))-Ye/2;var Ze,ct,lt=Se._offset,At=fe._offset;return cr+=lt-Ye,$t+=At-pe,Ze=(Zt+=lt)+Ye<Me&&Zt>=0?Zt:cr+Ye<Me&&cr>=0?cr:lt+Ye<Me?lt:Zt-Be<Be-cr+Ye?Me-Ye:0,Ze+=L,ct=(Gt+=At)+pe<we&&Gt>=0?Gt:$t+pe<we&&$t>=0?$t:At+pe<we?At:Gt-He<He-$t+pe?we-pe:0,ct+=L,Dt.attr("transform",e(Ze-1,ct-1)),Dt}var Ot=ne.selectAll("g.hovertext").data(N,function(it){return P(it)});return Ot.enter().append("g").classed("hovertext",!0).each(function(){var it=d.select(this);it.append("rect").call(c.fill,c.addOpacity(ee,.8)),it.append("text").classed("name",!0),it.append("path").style("stroke-width","1px"),it.append("text").classed("nums",!0).call(g.font,me,ce)}),Ot.exit().remove(),Ot.each(function(it){var ht=d.select(this).attr("transform",""),Ut=it.color;Array.isArray(Ut)&&(Ut=Ut[it.eventData[0].pointNumber]);var Mt=it.bgcolor||Ut,It=c.combine(c.opacity(Mt)?Mt:c.defaultLine,ee),Le=c.combine(c.opacity(Ut)?Ut:c.defaultLine,ee),Xe=it.borderColor||c.contrast(It),ot=z(it,de,K,B,Te,ht),pt=ot[0],St=ot[1],Vt=ht.select("text.nums").call(g.font,it.fontFamily||me,it.fontSize||ce,it.fontColor||Xe).text(pt).attr("data-notex",1).call(o.positionText,0,0).call(o.convertToTspans,te),Jt=ht.select("text.name"),qt=0,gr=0;if(St&&St!==pt){Jt.call(g.font,it.fontFamily||me,it.fontSize||ce,Le).text(St).attr("data-notex",1).call(o.positionText,0,0).call(o.convertToTspans,te);var Cr=H(te,Jt.node());qt=Cr.width+2*L,gr=Cr.height+2*L}else Jt.remove(),ht.select("rect").remove();ht.select("path").style({fill:It,stroke:Xe});var mr=it.xa._offset+(it.x0+it.x1)/2,tr=it.ya._offset+(it.y0+it.y1)/2,nr=Math.abs(it.x1-it.x0),Qt=Math.abs(it.y1-it.y0),dr=H(te,Vt.node()),_r=dr.width/B._invScaleX,Ir=dr.height/B._invScaleY;it.ty0=(ve-dr.top)/B._invScaleY,it.bx=_r+2*L,it.by=Math.max(Ir+2*L,gr),it.anchor="start",it.txwidth=_r,it.tx2width=qt,it.offset=0;var Rr,Vr,Xr=(_r+k+L+qt)*B._invScaleX;if(J)it.pos=mr,Rr=tr+Qt/2+Xr<=we,Vr=tr-Qt/2-Xr>=0,it.idealAlign!=="top"&&Rr||!Vr?Rr?(tr+=Qt/2,it.anchor="start"):it.anchor="middle":(tr-=Qt/2,it.anchor="end");else if(it.pos=tr,Rr=mr+nr/2+Xr<=Me,Vr=mr-nr/2-Xr>=0,it.idealAlign!=="left"&&Rr||!Vr)if(Rr)mr+=nr/2,it.anchor="start";else{it.anchor="middle";var cn=Xr/2,an=mr+cn-Me,zn=mr-cn;an>0&&(mr-=an),zn<0&&(mr+=-zn)}else mr-=nr/2,it.anchor="end";Vt.attr("text-anchor",it.anchor),qt&&Jt.attr("text-anchor",it.anchor),ht.attr("transform",e(mr,tr)+(J?t(x):""))}),Ot}function z(N,U,te,B,K,J){var ee="",ne="";N.nameOverride!==void 0&&(N.name=N.nameOverride),N.name&&(N.trace._meta&&(N.name=y.templateString(N.name,N.trace._meta)),ee=Q(N.name,N.nameLength));var se=te.charAt(0),oe=se==="x"?"y":"x";N.zLabel!==void 0?(N.xLabel!==void 0&&(ne+="x: "+N.xLabel+"<br>"),N.yLabel!==void 0&&(ne+="y: "+N.yLabel+"<br>"),N.trace.type!=="choropleth"&&N.trace.type!=="choroplethmapbox"&&(ne+=(ne?"z: ":"")+N.zLabel)):U&&N[se+"Label"]===K?ne=N[oe+"Label"]||"":N.xLabel===void 0?N.yLabel!==void 0&&N.trace.type!=="scattercarpet"&&(ne=N.yLabel):ne=N.yLabel===void 0?N.xLabel:"("+N.xLabel+", "+N.yLabel+")",!N.text&&N.text!==0||Array.isArray(N.text)||(ne+=(ne?"<br>":"")+N.text),N.extraText!==void 0&&(ne+=(ne?"<br>":"")+N.extraText),J&&ne===""&&!N.hovertemplate&&(ee===""&&J.remove(),ne=ee);var me=N.hovertemplate||!1;if(me){var ce=N.hovertemplateLabels||N;N[se+"Label"]!==K&&(ce[se+"other"]=ce[se+"Val"],ce[se+"otherLabel"]=ce[se+"Label"]),ne=(ne=y.hovertemplateString(me,ce,B._d3locale,N.eventData[0]||{},N.trace._meta)).replace(S,function(ye,Se){return ee=Q(Se,N.nameLength),""})}return[ne,ee]}function D(N,U,te,B){var K=function(ee){return ee*te},J=function(ee){return ee*B};N.each(function(ee){var ne=d.select(this);if(ee.del)return ne.remove();var se=ne.select("text.nums"),oe=ee.anchor,me=oe==="end"?-1:1,ce={start:1,end:-1,middle:0}[oe],ye=ce*(k+L),Se=ye+ce*(ee.txwidth+L),fe=0,ge=ee.offset,Te=oe==="middle";Te&&(ye-=ee.tx2width/2,Se+=ee.txwidth/2+L),U&&(ge*=-T,fe=ee.offset*b),ne.select("path").attr("d",Te?"M-"+K(ee.bx/2+ee.tx2width/2)+","+J(ge-ee.by/2)+"h"+K(ee.bx)+"v"+J(ee.by)+"h-"+K(ee.bx)+"Z":"M0,0L"+K(me*k+fe)+","+J(k+ge)+"v"+J(ee.by/2-k)+"h"+K(me*ee.bx)+"v-"+J(ee.by)+"H"+K(me*k+fe)+"V"+J(ge-k)+"Z");var le=fe+ye,ve=ge+ee.ty0-ee.by/2+L,Me=ee.textAlign||"auto";Me!=="auto"&&(Me==="left"&&oe!=="start"?(se.attr("text-anchor","start"),le=Te?-ee.bx/2-ee.tx2width/2+L:-ee.bx-L):Me==="right"&&oe!=="end"&&(se.attr("text-anchor","end"),le=Te?ee.bx/2-ee.tx2width/2-L:ee.bx+L)),se.call(o.positionText,K(le),J(ve)),ee.tx2width&&(ne.select("text.name").call(o.positionText,K(Se+ce*L+fe),J(ge+ee.ty0-ee.by/2+L)),ne.select("rect").call(g.setRect,K(Se+(ce-1)*ee.tx2width/2+fe),J(ge-ee.by/2-1),K(ee.tx2width),J(ee.by+2)))})}function j(N,U){var te=N.index,B=N.trace||{},K=N.cd[0],J=N.cd[te]||{};function ee(ye){return ye||v(ye)&&ye===0}var ne=Array.isArray(te)?function(ye,Se){var fe=y.castOption(K,te,ye);return ee(fe)?fe:y.extractOption({},B,"",Se)}:function(ye,Se){return y.extractOption(J,B,ye,Se)};function se(ye,Se,fe){var ge=ne(Se,fe);ee(ge)&&(N[ye]=ge)}if(se("hoverinfo","hi","hoverinfo"),se("bgcolor","hbg","hoverlabel.bgcolor"),se("borderColor","hbc","hoverlabel.bordercolor"),se("fontFamily","htf","hoverlabel.font.family"),se("fontSize","hts","hoverlabel.font.size"),se("fontColor","htc","hoverlabel.font.color"),se("nameLength","hnl","hoverlabel.namelength"),se("textAlign","hta","hoverlabel.align"),N.posref=U==="y"||U==="closest"&&B.orientation==="h"?N.xa._offset+(N.x0+N.x1)/2:N.ya._offset+(N.y0+N.y1)/2,N.x0=y.constrain(N.x0,0,N.xa._length),N.x1=y.constrain(N.x1,0,N.xa._length),N.y0=y.constrain(N.y0,0,N.ya._length),N.y1=y.constrain(N.y1,0,N.ya._length),N.xLabelVal!==void 0&&(N.xLabel="xLabel"in N?N.xLabel:h.hoverLabelText(N.xa,N.xLabelVal,B.xhoverformat),N.xVal=N.xa.c2d(N.xLabelVal)),N.yLabelVal!==void 0&&(N.yLabel="yLabel"in N?N.yLabel:h.hoverLabelText(N.ya,N.yLabelVal,B.yhoverformat),N.yVal=N.ya.c2d(N.yLabelVal)),N.zLabelVal!==void 0&&N.zLabel===void 0&&(N.zLabel=String(N.zLabelVal)),!(isNaN(N.xerr)||N.xa.type==="log"&&N.xerr<=0)){var oe=h.tickText(N.xa,N.xa.c2l(N.xerr),"hover").text;N.xerrneg!==void 0?N.xLabel+=" +"+oe+" / -"+h.tickText(N.xa,N.xa.c2l(N.xerrneg),"hover").text:N.xLabel+=" \xB1 "+oe,U==="x"&&(N.distance+=1)}if(!(isNaN(N.yerr)||N.ya.type==="log"&&N.yerr<=0)){var me=h.tickText(N.ya,N.ya.c2l(N.yerr),"hover").text;N.yerrneg!==void 0?N.yLabel+=" +"+me+" / -"+h.tickText(N.ya,N.ya.c2l(N.yerrneg),"hover").text:N.yLabel+=" \xB1 "+me,U==="y"&&(N.distance+=1)}var ce=N.hoverinfo||N.trace.hoverinfo;return ce&&ce!=="all"&&((ce=Array.isArray(ce)?ce:ce.split("+")).indexOf("x")===-1&&(N.xLabel=void 0),ce.indexOf("y")===-1&&(N.yLabel=void 0),ce.indexOf("z")===-1&&(N.zLabel=void 0),ce.indexOf("text")===-1&&(N.text=void 0),ce.indexOf("name")===-1&&(N.name=void 0)),N}function V(N,U,te){var B,K,J=te.container,ee=te.fullLayout,ne=ee._size,se=te.event,oe=!!U.hLinePoint,me=!!U.vLinePoint;if(J.selectAll(".spikeline").remove(),me||oe){var ce=c.combine(ee.plot_bgcolor,ee.paper_bgcolor);if(oe){var ye,Se,fe=U.hLinePoint;B=fe&&fe.xa,(K=fe&&fe.ya).spikesnap==="cursor"?(ye=se.pointerX,Se=se.pointerY):(ye=B._offset+fe.x,Se=K._offset+fe.y);var ge,Te,le=w.readability(fe.color,ce)<1.5?c.contrast(ce):fe.color,ve=K.spikemode,Me=K.spikethickness,we=K.spikecolor||le,de=h.getPxPosition(N,K);if(ve.indexOf("toaxis")!==-1||ve.indexOf("across")!==-1){if(ve.indexOf("toaxis")!==-1&&(ge=de,Te=ye),ve.indexOf("across")!==-1){var Ie=K._counterDomainMin,De=K._counterDomainMax;K.anchor==="free"&&(Ie=Math.min(Ie,K.position),De=Math.max(De,K.position)),ge=ne.l+Ie*ne.w,Te=ne.l+De*ne.w}J.insert("line",":first-child").attr({x1:ge,x2:Te,y1:Se,y2:Se,"stroke-width":Me,stroke:we,"stroke-dasharray":g.dashStyle(K.spikedash,Me)}).classed("spikeline",!0).classed("crisp",!0),J.insert("line",":first-child").attr({x1:ge,x2:Te,y1:Se,y2:Se,"stroke-width":Me+2,stroke:ce}).classed("spikeline",!0).classed("crisp",!0)}ve.indexOf("marker")!==-1&&J.insert("circle",":first-child").attr({cx:de+(K.side!=="right"?Me:-Me),cy:Se,r:Me,fill:we}).classed("spikeline",!0)}if(me){var Oe,Ve,Fe=U.vLinePoint;B=Fe&&Fe.xa,K=Fe&&Fe.ya,B.spikesnap==="cursor"?(Oe=se.pointerX,Ve=se.pointerY):(Oe=B._offset+Fe.x,Ve=K._offset+Fe.y);var ze,Re,We=w.readability(Fe.color,ce)<1.5?c.contrast(ce):Fe.color,$e=B.spikemode,at=B.spikethickness,gt=B.spikecolor||We,xt=h.getPxPosition(N,B);if($e.indexOf("toaxis")!==-1||$e.indexOf("across")!==-1){if($e.indexOf("toaxis")!==-1&&(ze=xt,Re=Ve),$e.indexOf("across")!==-1){var mt=B._counterDomainMin,nt=B._counterDomainMax;B.anchor==="free"&&(mt=Math.min(mt,B.position),nt=Math.max(nt,B.position)),ze=ne.t+(1-nt)*ne.h,Re=ne.t+(1-mt)*ne.h}J.insert("line",":first-child").attr({x1:Oe,x2:Oe,y1:ze,y2:Re,"stroke-width":at,stroke:gt,"stroke-dasharray":g.dashStyle(B.spikedash,at)}).classed("spikeline",!0).classed("crisp",!0),J.insert("line",":first-child").attr({x1:Oe,x2:Oe,y1:ze,y2:Re,"stroke-width":at+2,stroke:ce}).classed("spikeline",!0).classed("crisp",!0)}$e.indexOf("marker")!==-1&&J.insert("circle",":first-child").attr({cx:Oe,cy:xt-(B.side!=="top"?at:-at),r:at,fill:gt}).classed("spikeline",!0)}}}function Z(N,U){return!U||U.vLinePoint!==N._spikepoints.vLinePoint||U.hLinePoint!==N._spikepoints.hLinePoint}function Q(N,U){return o.plainText(N||"",{len:U,allowedTags:["br","sub","sup","b","i","em"]})}function X(N,U,te){var B=U[N+"a"],K=U[N+"Val"],J=U.cd[0];if(B.type==="category")K=B._categoriesMap[K];else if(B.type==="date"){var ee=U.trace[N+"periodalignment"];if(ee){var ne=U.cd[U.index],se=ne[N+"Start"];se===void 0&&(se=ne[N]);var oe=ne[N+"End"];oe===void 0&&(oe=ne[N]);var me=oe-se;ee==="end"?K+=me:ee==="middle"&&(K+=me/2)}K=B.d2c(K)}return J&&J.t&&J.t.posLetter===B._id&&(te.boxmode!=="group"&&te.violinmode!=="group"||(K+=J.t.dPos)),K}function $(N){return N.offsetTop+N.clientTop}function re(N){return N.offsetLeft+N.clientLeft}function H(N,U){var te=N._fullLayout,B=U.getBoundingClientRect(),K=B.x,J=B.y,ee=K+B.width,ne=J+B.height,se=y.apply3DTransform(te._invTransform)(K,J),oe=y.apply3DTransform(te._invTransform)(ee,ne),me=se[0],ce=se[1],ye=oe[0],Se=oe[1];return{x:me,y:ce,width:ye-me,height:Se-ce,top:Math.min(ce,Se),left:Math.min(me,ye),right:Math.max(me,ye),bottom:Math.max(ce,Se)}}},{"../../lib":515,"../../lib/events":504,"../../lib/override_cursor":526,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../legend/defaults":419,"../legend/draw":420,"./constants":401,"./helpers":403,"@plotly/d3":58,"fast-isnumeric":190,tinycolor2:313}],405:[function(m,G,Y){var d=m("../../lib"),v=m("../color"),w=m("./helpers").isUnifiedHover;G.exports=function(y,e,t,n){n=n||{};var o=e.legend;function r(g){n.font[g]||(n.font[g]=o?e.legend.font[g]:e.font[g])}e&&w(e.hovermode)&&(n.font||(n.font={}),r("size"),r("family"),r("color"),o?(n.bgcolor||(n.bgcolor=v.combine(e.legend.bgcolor,e.paper_bgcolor)),n.bordercolor||(n.bordercolor=e.legend.bordercolor)):n.bgcolor||(n.bgcolor=e.paper_bgcolor)),t("hoverlabel.bgcolor",n.bgcolor),t("hoverlabel.bordercolor",n.bordercolor),t("hoverlabel.namelength",n.namelength),d.coerceFont(t,"hoverlabel.font",n.font),t("hoverlabel.align",n.align)}},{"../../lib":515,"../color":367,"./helpers":403}],406:[function(m,G,Y){var d=m("../../lib"),v=m("./layout_attributes");G.exports=function(w,y){function e(t,n){return y[t]!==void 0?y[t]:d.coerce(w,y,v,t,n)}return e("clickmode"),e("hovermode")}},{"../../lib":515,"./layout_attributes":408}],407:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../dragelement"),y=m("./helpers"),e=m("./layout_attributes"),t=m("./hover");G.exports={moduleType:"component",name:"fx",constants:m("./constants"),schema:{layout:e},attributes:m("./attributes"),layoutAttributes:e,supplyLayoutGlobalDefaults:m("./layout_global_defaults"),supplyDefaults:m("./defaults"),supplyLayoutDefaults:m("./layout_defaults"),calc:m("./calc"),getDistanceFunction:y.getDistanceFunction,getClosest:y.getClosest,inbox:y.inbox,quadrature:y.quadrature,appendArrayPointValue:y.appendArrayPointValue,castHoverOption:function(n,o,r){return v.castOption(n,o,"hoverlabel."+r)},castHoverinfo:function(n,o,r){return v.castOption(n,r,"hoverinfo",function(g){return v.coerceHoverinfo({hoverinfo:g},{_module:n._module},o)})},hover:t.hover,unhover:w.unhover,loneHover:t.loneHover,loneUnhover:function(n){var o=v.isD3Selection(n)?n:d.select(n);o.selectAll("g.hovertext").remove(),o.selectAll(".spikeline").remove()},click:m("./click")}},{"../../lib":515,"../dragelement":386,"./attributes":398,"./calc":399,"./click":400,"./constants":401,"./defaults":402,"./helpers":403,"./hover":404,"./layout_attributes":408,"./layout_defaults":409,"./layout_global_defaults":410,"@plotly/d3":58}],408:[function(m,G,Y){var d=m("./constants"),v=m("../../plots/font_attributes"),w=v({editType:"none"});w.family.dflt=d.HOVERFONT,w.size.dflt=d.HOVERFONTSIZE,G.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1,"x unified","y unified"],dflt:"closest",editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:-1,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:w,grouptitlefont:v({editType:"none"}),align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":594,"./constants":401}],409:[function(m,G,Y){var d=m("../../lib"),v=m("./layout_attributes"),w=m("./hovermode_defaults"),y=m("./hoverlabel_defaults");G.exports=function(e,t){function n(c,a){return d.coerce(e,t,v,c,a)}w(e,t)&&(n("hoverdistance"),n("spikedistance")),n("dragmode")==="select"&&n("selectdirection");var o=t._has("mapbox"),r=t._has("geo"),g=t._basePlotModules.length;t.dragmode==="zoom"&&((o||r)&&g===1||o&&r&&g===2)&&(t.dragmode="pan"),y(e,t,n),d.coerceFont(n,"hoverlabel.grouptitlefont",t.hoverlabel.font)}},{"../../lib":515,"./hoverlabel_defaults":405,"./hovermode_defaults":406,"./layout_attributes":408}],410:[function(m,G,Y){var d=m("../../lib"),v=m("./hoverlabel_defaults"),w=m("./layout_attributes");G.exports=function(y,e){v(y,e,function(t,n){return d.coerce(y,e,w,t,n)})}},{"../../lib":515,"./hoverlabel_defaults":405,"./layout_attributes":408}],411:[function(m,G,Y){var d=m("../../lib"),v=m("../../lib/regex").counter,w=m("../../plots/domain").attributes,y=m("../../plots/cartesian/constants").idRegex,e=m("../../plot_api/plot_template"),t={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[v("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[y.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[y.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:w({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function n(g,c,a){var h=c[a+"axes"],l=Object.keys((g._splomAxes||{})[a]||{});return Array.isArray(h)?h:l.length?l:void 0}function o(g,c,a,h,l,s){var p=c(g+"gap",a),u=c("domain."+g);c(g+"side",h);for(var i=new Array(l),x=u[0],f=(u[1]-x)/(l-p),_=f*(1-p),b=0;b<l;b++){var T=x+f*b;i[s?l-1-b:b]=[T,T+_]}return i}function r(g,c,a,h,l){var s,p=new Array(a);function u(i,x){c.indexOf(x)!==-1&&h[x]===void 0?(p[i]=x,h[x]=i):p[i]=""}if(Array.isArray(g))for(s=0;s<a;s++)u(s,g[s]);else for(u(0,l),s=1;s<a;s++)u(s,l+(s+1));return p}G.exports={moduleType:"component",name:"grid",schema:{layout:{grid:t}},layoutAttributes:t,sizeDefaults:function(g,c){var a=g.grid||{},h=n(c,a,"x"),l=n(c,a,"y");if(g.grid||h||l){var s,p,u=Array.isArray(a.subplots)&&Array.isArray(a.subplots[0]),i=Array.isArray(h),x=Array.isArray(l),f=i&&h!==a.xaxes&&x&&l!==a.yaxes;u?(s=a.subplots.length,p=a.subplots[0].length):(x&&(s=l.length),i&&(p=h.length));var _=e.newContainer(c,"grid"),b=S("rows",s),T=S("columns",p);if(b*T>1){!u&&!i&&!x&&S("pattern")==="independent"&&(u=!0),_._hasSubplotGrid=u;var k,L,A=S("roworder")==="top to bottom",I=u?.2:.1,P=u?.3:.1;f&&c._splomGridDflt&&(k=c._splomGridDflt.xside,L=c._splomGridDflt.yside),_._domains={x:o("x",S,I,k,T),y:o("y",S,P,L,b,A)}}else delete c.grid}function S(E,z){return d.coerce(a,_,t,E,z)}},contentDefaults:function(g,c){var a=c.grid;if(a&&a._domains){var h,l,s,p,u,i,x,f=g.grid||{},_=c._subplots,b=a._hasSubplotGrid,T=a.rows,k=a.columns,L=a.pattern==="independent",A=a._axisMap={};if(b){var I=f.subplots||[];i=a.subplots=new Array(T);var P=1;for(h=0;h<T;h++){var S=i[h]=new Array(k),E=I[h]||[];for(l=0;l<k;l++)if(L?(u=P===1?"xy":"x"+P+"y"+P,P++):u=E[l],S[l]="",_.cartesian.indexOf(u)!==-1){if(x=u.indexOf("y"),s=u.slice(0,x),p=u.slice(x),A[s]!==void 0&&A[s]!==l||A[p]!==void 0&&A[p]!==h)continue;S[l]=u,A[s]=l,A[p]=h}}}else{var z=n(c,f,"x"),D=n(c,f,"y");a.xaxes=r(z,_.xaxis,k,A,"x"),a.yaxes=r(D,_.yaxis,T,A,"y")}var j=a._anchors={},V=a.roworder==="top to bottom";for(var Z in A){var Q,X,$,re=Z.charAt(0),H=a[re+"side"];if(H.length<8)j[Z]="free";else if(re==="x"){if(H.charAt(0)==="t"===V?(Q=0,X=1,$=T):(Q=T-1,X=-1,$=-1),b){var N=A[Z];for(h=Q;h!==$;h+=X)if((u=i[h][N])&&(x=u.indexOf("y"),u.slice(0,x)===Z)){j[Z]=u.slice(x);break}}else for(h=Q;h!==$;h+=X)if(p=a.yaxes[h],_.cartesian.indexOf(Z+p)!==-1){j[Z]=p;break}}else if(H.charAt(0)==="l"?(Q=0,X=1,$=k):(Q=k-1,X=-1,$=-1),b){var U=A[Z];for(h=Q;h!==$;h+=X)if((u=i[U][h])&&(x=u.indexOf("y"),u.slice(x)===Z)){j[Z]=u.slice(0,x);break}}else for(h=Q;h!==$;h+=X)if(s=a.xaxes[h],_.cartesian.indexOf(s+Z)!==-1){j[Z]=s;break}}}}}},{"../../lib":515,"../../lib/regex":532,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573,"../../plots/domain":593}],412:[function(m,G,Y){var d=m("../../plots/cartesian/constants"),v=m("../../plot_api/plot_template").templatedArray;m("../../constants/axis_placeable_objects"),G.exports=v("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",d.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",d.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":484,"../../plot_api/plot_template":555,"../../plots/cartesian/constants":573}],413:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../lib/to_log_range");G.exports=function(w,y,e,t){y=y||{};var n=e==="log"&&y.type==="linear",o=e==="linear"&&y.type==="log";if(n||o){for(var r,g,c=w._fullLayout.images,a=y._id.charAt(0),h=0;h<c.length;h++)if(g="images["+h+"].",(r=c[h])[a+"ref"]===y._id){var l=r[a],s=r["size"+a],p=null,u=null;if(n){p=v(l,y.range);var i=s/Math.pow(10,p)/2;u=2*Math.log(i+Math.sqrt(1+i*i))/Math.LN10}else u=(p=Math.pow(10,l))*(Math.pow(10,s/2)-Math.pow(10,-s/2));d(p)?d(u)||(u=null):(p=null,u=null),t(g+a,p),t(g+"size"+a,u)}}}},{"../../lib/to_log_range":543,"fast-isnumeric":190}],414:[function(m,G,Y){var d=m("../../lib"),v=m("../../plots/cartesian/axes"),w=m("../../plots/array_container_defaults"),y=m("./attributes");function e(t,n,o){function r(p,u){return d.coerce(t,n,y,p,u)}var g=r("source");if(!r("visible",!!g))return n;r("layer"),r("xanchor"),r("yanchor"),r("sizex"),r("sizey"),r("sizing"),r("opacity");for(var c={_fullLayout:o},a=["x","y"],h=0;h<2;h++){var l=a[h],s=v.coerceRef(t,n,c,l,"paper",void 0);s!=="paper"&&v.getFromId(c,s)._imgIndices.push(n._index),v.coercePosition(n,c,r,s,l,0)}return n}G.exports=function(t,n){w(t,n,{name:"images",handleItemDefaults:e})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":412}],415:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../drawing"),w=m("../../plots/cartesian/axes"),y=m("../../plots/cartesian/axis_ids"),e=m("../../constants/xmlns_namespaces");G.exports=function(t){var n,o,r=t._fullLayout,g=[],c={},a=[];for(o=0;o<r.images.length;o++){var h=r.images[o];if(h.visible)if(h.layer==="below"&&h.xref!=="paper"&&h.yref!=="paper"){n=y.ref2id(h.xref)+y.ref2id(h.yref);var l=r._plots[n];if(!l){a.push(h);continue}l.mainplot&&(n=l.mainplot.id),c[n]||(c[n]=[]),c[n].push(h)}else h.layer==="above"?g.push(h):a.push(h)}var s={left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-.5},right:{sizing:"xMax",offset:-1}},p={top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-.5},bottom:{sizing:"YMax",offset:-1}};function u(k){var L=d.select(this);if(this._imgSrc!==k.source)if(L.attr("xmlns",e.svg),k.source&&k.source.slice(0,5)==="data:")L.attr("xlink:href",k.source),this._imgSrc=k.source;else{var A=new Promise(function(I){var P=new Image;function S(){L.remove(),I()}this.img=P,P.setAttribute("crossOrigin","anonymous"),P.onerror=S,P.onload=function(){var E=document.createElement("canvas");E.width=this.width,E.height=this.height,E.getContext("2d",{willReadFrequently:!0}).drawImage(this,0,0);var z=E.toDataURL("image/png");L.attr("xlink:href",z),I()},L.on("error",S),P.src=k.source,this._imgSrc=k.source}.bind(this));t._promises.push(A)}}function i(k){var L,A,I=d.select(this),P=w.getFromId(t,k.xref),S=w.getFromId(t,k.yref),E=w.getRefType(k.xref)==="domain",z=w.getRefType(k.yref)==="domain",D=r._size;L=P!==void 0?typeof k.xref=="string"&&E?P._length*k.sizex:Math.abs(P.l2p(k.sizex)-P.l2p(0)):k.sizex*D.w,A=S!==void 0?typeof k.yref=="string"&&z?S._length*k.sizey:Math.abs(S.l2p(k.sizey)-S.l2p(0)):k.sizey*D.h;var j,V,Z=L*s[k.xanchor].offset,Q=A*p[k.yanchor].offset,X=s[k.xanchor].sizing+p[k.yanchor].sizing;switch(j=P!==void 0?typeof k.xref=="string"&&E?P._length*k.x+P._offset:P.r2p(k.x)+P._offset:k.x*D.w+D.l,j+=Z,V=S!==void 0?typeof k.yref=="string"&&z?S._length*(1-k.y)+S._offset:S.r2p(k.y)+S._offset:D.h-k.y*D.h+D.t,V+=Q,k.sizing){case"fill":X+=" slice";break;case"stretch":X="none"}I.attr({x:j,y:V,width:L,height:A,preserveAspectRatio:X,opacity:k.opacity});var $=(P&&w.getRefType(k.xref)!=="domain"?P._id:"")+(S&&w.getRefType(k.yref)!=="domain"?S._id:"");v.setClipUrl(I,$?"clip"+r._uid+$:null,t)}var x=r._imageLowerLayer.selectAll("image").data(a),f=r._imageUpperLayer.selectAll("image").data(g);x.enter().append("image"),f.enter().append("image"),x.exit().remove(),f.exit().remove(),x.each(function(k){u.bind(this)(k),i.bind(this)(k)}),f.each(function(k){u.bind(this)(k),i.bind(this)(k)});var _=Object.keys(r._plots);for(o=0;o<_.length;o++){n=_[o];var b=r._plots[n];if(b.imagelayer){var T=b.imagelayer.selectAll("image").data(c[n]||[]);T.enter().append("image"),T.exit().remove(),T.each(function(k){u.bind(this)(k),i.bind(this)(k)})}}}},{"../../constants/xmlns_namespaces":492,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_ids":570,"../drawing":389,"@plotly/d3":58}],416:[function(m,G,Y){G.exports={moduleType:"component",name:"images",layoutAttributes:m("./attributes"),supplyLayoutDefaults:m("./defaults"),includeBasePlot:m("../../plots/cartesian/include_components")("images"),draw:m("./draw"),convertCoords:m("./convert_coords")}},{"../../plots/cartesian/include_components":577,"./attributes":412,"./convert_coords":413,"./defaults":414,"./draw":415}],417:[function(m,G,Y){var d=m("../../plots/font_attributes"),v=m("../color/attributes");G.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:v.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:d({editType:"legend"}),grouptitlefont:d({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},entrywidth:{valType:"number",min:0,editType:"legend"},entrywidthmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels",editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},groupclick:{valType:"enumerated",values:["toggleitem","togglegroup"],dflt:"togglegroup",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:d({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":594,"../color/attributes":366}],418:[function(m,G,Y){G.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}},{}],419:[function(m,G,Y){var d=m("../../registry"),v=m("../../lib"),w=m("../../plot_api/plot_template"),y=m("../../plots/attributes"),e=m("./attributes"),t=m("../../plots/layout_attributes"),n=m("./helpers");G.exports=function(o,r,g){var c,a=o.legend||{},h=w.newContainer(r,"legend");function l(S,E){return v.coerce(a,h,e,S,E)}for(var s=function(S,E){var z=c._input,D=c;return v.coerce(z,D,y,S,E)},p=r.font||{},u=v.coerceFont(l,"grouptitlefont",v.extendFlat({},p,{size:Math.round(1.1*p.size)})),i=0,x=!1,f="normal",_=0;_<g.length;_++)(c=g[_]).visible&&((c.showlegend||c._dfltShowLegend&&!(c._module&&c._module.attributes&&c._module.attributes.showlegend&&c._module.attributes.showlegend.dflt===!1))&&(i++,c.showlegend&&(x=!0,(d.traceIs(c,"pie-like")||c._input.showlegend===!0)&&i++),v.coerceFont(s,"legendgrouptitle.font",u)),(d.traceIs(c,"bar")&&r.barmode==="stack"||["tonextx","tonexty"].indexOf(c.fill)!==-1)&&(f=n.isGrouped({traceorder:f})?"grouped+reversed":"reversed"),c.legendgroup!==void 0&&c.legendgroup!==""&&(f=n.isReversed({traceorder:f})?"reversed+grouped":"grouped"));var b=v.coerce(o,r,t,"showlegend",x&&i>1);if(b===!1&&(r.legend=void 0),(b!==!1||a.uirevision)&&(l("uirevision",r.uirevision),b!==!1)){l("bgcolor",r.paper_bgcolor),l("bordercolor"),l("borderwidth");var T,k,L,A=v.coerceFont(l,"font",r.font),I=l("orientation")==="h";if(I?(T=0,d.getComponentMethod("rangeslider","isVisible")(o.xaxis)?(k=1.1,L="bottom"):(k=-.1,L="top")):(T=1.02,k=1,L="auto"),l("traceorder",f),n.isGrouped(r.legend)&&l("tracegroupgap"),l("entrywidth"),l("entrywidthmode"),l("itemsizing"),l("itemwidth"),l("itemclick"),l("itemdoubleclick"),l("groupclick"),l("x",T),l("xanchor"),l("y",k),l("yanchor",L),l("valign"),v.noneOrAll(a,h,["x","y"]),l("title.text")){l("title.side",I?"left":"top");var P=v.extendFlat({},A,{size:v.bigFont(A.size)});v.coerceFont(l,"title.font",P)}}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/attributes":562,"../../plots/layout_attributes":619,"../../registry":647,"./attributes":417,"./helpers":423}],420:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../plots/plots"),y=m("../../registry"),e=m("../../lib/events"),t=m("../dragelement"),n=m("../drawing"),o=m("../color"),r=m("../../lib/svg_text_utils"),g=m("./handle_click"),c=m("./constants"),a=m("../../constants/alignment"),h=a.LINE_SPACING,l=a.FROM_TL,s=a.FROM_BR,p=m("./get_legend_data"),u=m("./style"),i=m("./helpers");function x(I,P,S){var E=I[0],z=E.width,D=P.entrywidthmode,j=E.trace.legendwidth||P.entrywidth;return D==="fraction"?P._maxWidth*j:S+(j||z)}function f(I,P,S,E,z){var D=S.data()[0][0].trace,j={event:z,node:S.node(),curveNumber:D.index,expandedIndex:D._expandedIndex,data:I.data,layout:I.layout,frames:I._transitionData._frames,config:I._context,fullData:I._fullData,fullLayout:I._fullLayout};D._group&&(j.group=D._group),y.traceIs(D,"pie-like")&&(j.label=S.datum()[0].label),e.triggerHandler(I,"plotly_legendclick",j)!==!1&&(E===1?P._clickTimeout=setTimeout(function(){I._fullLayout&&g(S,I,E)},I._context.doubleClickDelay):E===2&&(P._clickTimeout&&clearTimeout(P._clickTimeout),I._legendMouseDownTime=0,e.triggerHandler(I,"plotly_legenddoubleclick",j)!==!1&&g(S,I,E)))}function _(I,P,S){var E,z,D=I.data()[0][0],j=D.trace,V=y.traceIs(j,"pie-like"),Z=!S._inHover&&P._context.edits.legendText&&!V,Q=S._maxNameLength;D.groupTitle?(E=D.groupTitle.text,z=D.groupTitle.font):(z=S.font,S.entries?E=D.text:(E=V?D.label:j.name,j._meta&&(E=v.templateString(E,j._meta))));var X=v.ensureSingle(I,"text","legendtext");X.attr("text-anchor","start").call(n.font,z).text(Z?b(E,Q):E);var $=S.itemwidth+2*c.itemGap;r.positionText(X,$,0),Z?X.call(r.makeEditable,{gd:P,text:E}).call(k,I,P,S).on("edit",function(re){this.text(b(re,Q)).call(k,I,P,S);var H=D.trace._fullInput||{},N={};if(y.hasTransform(H,"groupby")){var U=y.getTransformIndices(H,"groupby"),te=U[U.length-1],B=v.keyedContainer(H,"transforms["+te+"].styles","target","value.name");B.set(D.trace._group,re),N=B.constructUpdate()}else N.name=re;return y.call("_guiRestyle",P,N,j.index)}):k(X,I,P,S)}function b(I,P){var S=Math.max(4,P);if(I&&I.trim().length>=S/2)return I;for(var E=S-(I=I||"").length;E>0;E--)I+=" ";return I}function T(I,P){var S,E=P._context.doubleClickDelay,z=1,D=v.ensureSingle(I,"rect","legendtoggle",function(j){P._context.staticPlot||j.style("cursor","pointer").attr("pointer-events","all"),j.call(o.fill,"rgba(0,0,0,0)")});P._context.staticPlot||(D.on("mousedown",function(){(S=new Date().getTime())-P._legendMouseDownTime<E?z+=1:(z=1,P._legendMouseDownTime=S)}),D.on("mouseup",function(){if(!P._dragged&&!P._editing){var j=P._fullLayout.legend;new Date().getTime()-P._legendMouseDownTime>E&&(z=Math.max(z-1,1)),f(P,j,I,z,d.event)}}))}function k(I,P,S,E,z){E._inHover&&I.attr("data-notex",!0),r.convertToTspans(I,S,function(){(function(D,j,V,Z){var Q=D.data()[0][0];if(!V._inHover&&Q&&!Q.trace.showlegend)return void D.remove();var X=D.select("g[class*=math-group]"),$=X.node();V||(V=j._fullLayout.legend);var re,H=V.borderwidth;re=Z===1?V.title.font:Q.groupTitle?Q.groupTitle.font:V.font;var N,U,te=re.size*h;if($){var B=n.bBox($);N=B.height,U=B.width,Z===1?n.setTranslate(X,H,H+.75*N):n.setTranslate(X,0,.25*N)}else{var K=D.select(Z===1?".legendtitletext":".legendtext"),J=r.lineCount(K),ee=K.node();if(N=te*J,U=ee?n.bBox(ee).width:0,Z===1)V.title.side==="left"&&(U+=2*c.itemGap),r.positionText(K,H+c.titlePad,H+te);else{var ne=2*c.itemGap+V.itemwidth;Q.groupTitle&&(ne=c.itemGap,U-=V.itemwidth),r.positionText(K,ne,-te*((J-1)/2-.3))}}Z===1?(V._titleWidth=U,V._titleHeight=N):(Q.lineHeight=te,Q.height=Math.max(N,16)+3,Q.width=U)})(P,S,E,z)})}function L(I){return v.isRightAnchor(I)?"right":v.isCenterAnchor(I)?"center":"left"}function A(I){return v.isBottomAnchor(I)?"bottom":v.isMiddleAnchor(I)?"middle":"top"}G.exports=function(I,P){return P||(P=I._fullLayout.legend||{}),function(S,E){var z,D,j=S._fullLayout,V="legend"+j._uid,Z=E._inHover;if(Z?(z=E.layer,V+="-hover"):z=j._infolayer,!!z){if(S._legendMouseDownTime||(S._legendMouseDownTime=0),Z){if(!E.entries)return;D=p(E.entries,E)}else{if(!S.calcdata)return;D=j.showlegend&&p(S.calcdata,E)}var Q=j.hiddenlabels||[];if(!(Z||j.showlegend&&D.length))return z.selectAll(".legend").remove(),j._topdefs.select("#"+V).remove(),w.autoMargin(S,"legend");var X=v.ensureSingle(z,"g","legend",function(J){Z||J.attr("pointer-events","all")}),$=v.ensureSingleById(j._topdefs,"clipPath",V,function(J){J.append("rect")}),re=v.ensureSingle(X,"rect","bg",function(J){J.attr("shape-rendering","crispEdges")});re.call(o.stroke,E.bordercolor).call(o.fill,E.bgcolor).style("stroke-width",E.borderwidth+"px");var H=v.ensureSingle(X,"g","scrollbox"),N=E.title;if(E._titleWidth=0,E._titleHeight=0,N.text){var U=v.ensureSingle(H,"text","legendtitletext");U.attr("text-anchor","start").call(n.font,N.font).text(N.text),k(U,H,S,E,1)}else H.selectAll(".legendtitletext").remove();var te=v.ensureSingle(X,"rect","scrollbar",function(J){J.attr(c.scrollBarEnterAttrs).call(o.fill,c.scrollBarColor)}),B=H.selectAll("g.groups").data(D);B.enter().append("g").attr("class","groups"),B.exit().remove();var K=B.selectAll("g.traces").data(v.identity);K.enter().append("g").attr("class","traces"),K.exit().remove(),K.style("opacity",function(J){var ee=J[0].trace;return y.traceIs(ee,"pie-like")?Q.indexOf(J[0].label)!==-1?.5:1:ee.visible==="legendonly"?.5:1}).each(function(){d.select(this).call(_,S,E)}).call(u,S,E).each(function(){Z||d.select(this).call(T,S)}),v.syncOrAsync([w.previousPromises,function(){return function(J,ee,ne,se){var oe=J._fullLayout;se||(se=oe.legend);var me=oe._size,ce=i.isVertical(se),ye=i.isGrouped(se),Se=se.entrywidthmode==="fraction",fe=se.borderwidth,ge=2*fe,Te=c.itemGap,le=se.itemwidth+2*Te,ve=2*(fe+Te),Me=A(se),we=se.y<0||se.y===0&&Me==="top",de=se.y>1||se.y===1&&Me==="bottom",Ie=se.tracegroupgap,De={};se._maxHeight=Math.max(we||de?oe.height/2:me.h,30);var Oe=0;se._width=0,se._height=0;var Ve=function(Ye){var pe=0,_e=0,Be=Ye.title.side;return Be&&(Be.indexOf("left")!==-1&&(pe=Ye._titleWidth),Be.indexOf("top")!==-1&&(_e=Ye._titleHeight)),[pe,_e]}(se);if(ce)ne.each(function(Ye){var pe=Ye[0].height;n.setTranslate(this,fe+Ve[0],fe+Ve[1]+se._height+pe/2+Te),se._height+=pe,se._width=Math.max(se._width,Ye[0].width)}),Oe=le+se._width,se._width+=Te+le+ge,se._height+=ve,ye&&(ee.each(function(Ye,pe){n.setTranslate(this,0,pe*se.tracegroupgap)}),se._height+=(se._lgroupsLength-1)*se.tracegroupgap);else{var Fe=L(se),ze=se.x<0||se.x===0&&Fe==="right",Re=se.x>1||se.x===1&&Fe==="left",We=de||we,$e=oe.width/2;se._maxWidth=Math.max(ze?We&&Fe==="left"?me.l+me.w:$e:Re?We&&Fe==="right"?me.r+me.w:$e:me.w,2*le);var at=0,gt=0;ne.each(function(Ye){var pe=x(Ye,se,le);at=Math.max(at,pe),gt+=pe}),Oe=null;var xt=0;if(ye){var mt=0,nt=0,Qe=0;ee.each(function(){var Ye=0,pe=0;d.select(this).selectAll("g.traces").each(function(Be){var He=x(Be,se,le),Je=Be[0].height;n.setTranslate(this,Ve[0],Ve[1]+fe+Te+Je/2+pe),pe+=Je,Ye=Math.max(Ye,He),De[Be[0].trace.legendgroup]=Ye});var _e=Ye+Te;nt>0&&_e+fe+nt>se._maxWidth?(xt=Math.max(xt,nt),nt=0,Qe+=mt+Ie,mt=pe):mt=Math.max(mt,pe),n.setTranslate(this,nt,Qe),nt+=_e}),se._width=Math.max(xt,nt)+fe,se._height=Qe+mt+ve}else{var vt=ne.size(),jt=gt+ge+(vt-1)*Te<se._maxWidth,Gt=0,$t=0,Zt=0,cr=0;ne.each(function(Ye){var pe=Ye[0].height,_e=x(Ye,se,le),Be=jt?_e:at;Se||(Be+=Te),Be+fe+$t-Te>=se._maxWidth&&(xt=Math.max(xt,cr),$t=0,Zt+=Gt,se._height+=Gt,Gt=0),n.setTranslate(this,Ve[0]+fe+$t,Ve[1]+fe+Zt+pe/2+Te),cr=$t+_e+Te,$t+=Be,Gt=Math.max(Gt,pe)}),jt?(se._width=$t+ge,se._height=Gt+ve):(se._width=Math.max(xt,cr)+ge,se._height+=Gt+ve)}}se._width=Math.ceil(Math.max(se._width+Ve[0],se._titleWidth+2*(fe+c.titlePad))),se._height=Math.ceil(Math.max(se._height+Ve[1],se._titleHeight+2*(fe+c.itemGap))),se._effHeight=Math.min(se._height,se._maxHeight);var Dt=J._context.edits,Ne=Dt.legendText||Dt.legendPosition;ne.each(function(Ye){var pe=d.select(this).select(".legendtoggle"),_e=Ye[0].height,Be=Ye[0].trace.legendgroup,He=x(Ye,se,le);ye&&Be!==""&&(He=De[Be]);var Je=Ne?le:Oe||He;ce||Se||(Je+=Te/2),n.setRect(pe,0,-_e/2,Je,_e)})}(S,B,K,E)},function(){var J,ee,ne,se,oe=j._size,me=E.borderwidth;if(!Z){if(function(ze){var Re=ze._fullLayout.legend,We=L(Re),$e=A(Re);return w.autoMargin(ze,"legend",{x:Re.x,y:Re.y,l:Re._width*l[We],r:Re._width*s[We],b:Re._effHeight*s[$e],t:Re._effHeight*l[$e]})}(S))return;var ce=oe.l+oe.w*E.x-l[L(E)]*E._width,ye=oe.t+oe.h*(1-E.y)-l[A(E)]*E._effHeight;if(j.margin.autoexpand){var Se=ce,fe=ye;ce=v.constrain(ce,0,j.width-E._width),ye=v.constrain(ye,0,j.height-E._effHeight),ce!==Se&&v.log("Constrain legend.x to make legend fit inside graph"),ye!==fe&&v.log("Constrain legend.y to make legend fit inside graph")}n.setTranslate(X,ce,ye)}if(te.on(".drag",null),X.on("wheel",null),Z||E._height<=E._maxHeight||S._context.staticPlot){var ge=E._effHeight;Z&&(ge=E._height),re.attr({width:E._width-me,height:ge-me,x:me/2,y:me/2}),n.setTranslate(H,0,0),$.select("rect").attr({width:E._width-2*me,height:ge-2*me,x:me,y:me}),n.setClipUrl(H,V,S),n.setRect(te,0,0,0,0),delete E._scrollY}else{var Te,le,ve,Me=Math.max(c.scrollBarMinHeight,E._effHeight*E._effHeight/E._height),we=E._effHeight-Me-2*c.scrollBarMargin,de=E._height-E._effHeight,Ie=we/de,De=Math.min(E._scrollY||0,de);re.attr({width:E._width-2*me+c.scrollBarWidth+c.scrollBarMargin,height:E._effHeight-me,x:me/2,y:me/2}),$.select("rect").attr({width:E._width-2*me+c.scrollBarWidth+c.scrollBarMargin,height:E._effHeight-2*me,x:me,y:me+De}),n.setClipUrl(H,V,S),Fe(De,Me,Ie),X.on("wheel",function(){Fe(De=v.constrain(E._scrollY+d.event.deltaY/we*de,0,de),Me,Ie),De!==0&&De!==de&&d.event.preventDefault()});var Oe=d.behavior.drag().on("dragstart",function(){var ze=d.event.sourceEvent;Te=ze.type==="touchstart"?ze.changedTouches[0].clientY:ze.clientY,ve=De}).on("drag",function(){var ze=d.event.sourceEvent;ze.buttons===2||ze.ctrlKey||(le=ze.type==="touchmove"?ze.changedTouches[0].clientY:ze.clientY,Fe(De=function(Re,We,$e){var at=($e-We)/Ie+Re;return v.constrain(at,0,de)}(ve,Te,le),Me,Ie))});te.call(Oe);var Ve=d.behavior.drag().on("dragstart",function(){var ze=d.event.sourceEvent;ze.type==="touchstart"&&(Te=ze.changedTouches[0].clientY,ve=De)}).on("drag",function(){var ze=d.event.sourceEvent;ze.type==="touchmove"&&(le=ze.changedTouches[0].clientY,Fe(De=function(Re,We,$e){var at=(We-$e)/Ie+Re;return v.constrain(at,0,de)}(ve,Te,le),Me,Ie))});H.call(Ve)}function Fe(ze,Re,We){E._scrollY=S._fullLayout.legend._scrollY=ze,n.setTranslate(H,0,-ze),n.setRect(te,E._width,c.scrollBarMargin+ze*We,c.scrollBarWidth,Re),$.select("rect").attr("y",me+ze)}S._context.edits.legendPosition&&(X.classed("cursor-move",!0),t.init({element:X.node(),gd:S,prepFn:function(){var ze=n.getTranslate(X);ne=ze.x,se=ze.y},moveFn:function(ze,Re){var We=ne+ze,$e=se+Re;n.setTranslate(X,We,$e),J=t.align(We,0,oe.l,oe.l+oe.w,E.xanchor),ee=t.align($e,0,oe.t+oe.h,oe.t,E.yanchor)},doneFn:function(){J!==void 0&&ee!==void 0&&y.call("_guiRelayout",S,{"legend.x":J,"legend.y":ee})},clickFn:function(ze,Re){var We=z.selectAll("g.traces").filter(function(){var $e=this.getBoundingClientRect();return Re.clientX>=$e.left&&Re.clientX<=$e.right&&Re.clientY>=$e.top&&Re.clientY<=$e.bottom});We.size()>0&&f(S,X,We,ze,Re)}}))}],S)}}(I,P)}},{"../../constants/alignment":483,"../../lib":515,"../../lib/events":504,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"./constants":418,"./get_legend_data":421,"./handle_click":422,"./helpers":423,"./style":425,"@plotly/d3":58}],421:[function(m,G,Y){var d=m("../../registry"),v=m("./helpers");G.exports=function(w,y){var e,t,n=y._inHover,o=v.isGrouped(y),r=v.isReversed(y),g={},c=[],a=!1,h={},l=0,s=0;function p(D,j){if(D!==""&&v.isGrouped(y))c.indexOf(D)===-1?(c.push(D),a=!0,g[D]=[j]):g[D].push(j);else{var V="~~i"+l;c.push(V),g[V]=[j],l++}}for(e=0;e<w.length;e++){var u=w[e],i=u[0],x=i.trace,f=x.legendgroup;if(n||x.visible&&x.showlegend)if(d.traceIs(x,"pie-like"))for(h[f]||(h[f]={}),t=0;t<u.length;t++){var _=u[t].label;h[f][_]||(p(f,{label:_,color:u[t].color,i:u[t].i,trace:x,pts:u[t].pts}),h[f][_]=!0,s=Math.max(s,(_||"").length))}else p(f,i),s=Math.max(s,(x.name||"").length)}if(!c.length)return[];var b=!a||!o,T=[];for(e=0;e<c.length;e++){var k=g[c[e]];b?T.push(k[0]):T.push(k)}for(b&&(T=[T]),e=0;e<T.length;e++){var L=1/0;for(t=0;t<T[e].length;t++){var A=T[e][t].trace.legendrank;L>A&&(L=A)}T[e][0]._groupMinRank=L,T[e][0]._preGroupSort=e}var I=function(D,j){return D.trace.legendrank-j.trace.legendrank||D._preSort-j._preSort};for(T.forEach(function(D,j){D[0]._preGroupSort=j}),T.sort(function(D,j){return D[0]._groupMinRank-j[0]._groupMinRank||D[0]._preGroupSort-j[0]._preGroupSort}),e=0;e<T.length;e++){T[e].forEach(function(D,j){D._preSort=j}),T[e].sort(I);var P=T[e][0].trace,S=null;for(t=0;t<T[e].length;t++){var E=T[e][t].trace.legendgrouptitle;if(E&&E.text){S=E,n&&(E.font=y._groupTitleFont);break}}if(r&&T[e].reverse(),S){var z=!1;for(t=0;t<T[e].length;t++)if(d.traceIs(T[e][t].trace,"pie-like")){z=!0;break}T[e].unshift({i:-1,groupTitle:S,noClick:z,trace:{showlegend:P.showlegend,legendgroup:P.legendgroup,visible:y.groupclick==="toggleitem"||P.visible}})}for(t=0;t<T[e].length;t++)T[e][t]=[T[e][t]]}return y._lgroupsLength=T.length,y._maxNameLength=s,T}},{"../../registry":647,"./helpers":423}],422:[function(m,G,Y){var d=m("../../lib"),v=m("../../registry"),w=!0;G.exports=function(y,e,t){var n=e._fullLayout;if(!e._dragged&&!e._editing){var o,r=n.legend.itemclick,g=n.legend.itemdoubleclick,c=n.legend.groupclick;if(t===1&&r==="toggle"&&g==="toggleothers"&&w&&e.data&&e._context.showTips&&d.notifier(d._(e,"Double-click on legend to isolate one trace"),"long"),w=!1,t===1?o=r:t===2&&(o=g),o){var a=c==="togglegroup",h=n.hiddenlabels?n.hiddenlabels.slice():[],l=y.data()[0][0];if(!l.groupTitle||!l.noClick){var s,p,u,i,x,f=e._fullData,_=l.trace,b=_.legendgroup,T={},k=[],L=[],A=[];if(v.traceIs(_,"pie-like")){var I=l.label,P=h.indexOf(I);o==="toggle"?P===-1?h.push(I):h.splice(P,1):o==="toggleothers"&&(h=[],e.calcdata[0].forEach(function(U){I!==U.label&&h.push(U.label)}),e._fullLayout.hiddenlabels&&e._fullLayout.hiddenlabels.length===h.length&&P===-1&&(h=[])),v.call("_guiRelayout",e,"hiddenlabels",h)}else{var S,E=b&&b.length,z=[];if(E)for(s=0;s<f.length;s++)(S=f[s]).visible&&S.legendgroup===b&&z.push(s);if(o==="toggle"){var D;switch(_.visible){case!0:D="legendonly";break;case!1:D=!1;break;case"legendonly":D=!0}if(E)if(a)for(s=0;s<f.length;s++)f[s].visible!==!1&&f[s].legendgroup===b&&N(f[s],D);else N(_,D);else N(_,D)}else if(o==="toggleothers"){var j,V,Z,Q,X=!0;for(s=0;s<f.length;s++)if(j=f[s]===_,Z=f[s].showlegend!==!0,!(j||Z||(V=E&&f[s].legendgroup===b)||f[s].visible!==!0||v.traceIs(f[s],"notLegendIsolatable"))){X=!1;break}for(s=0;s<f.length;s++)if(f[s].visible!==!1&&!v.traceIs(f[s],"notLegendIsolatable"))switch(_.visible){case"legendonly":N(f[s],!0);break;case!0:Q=!!X||"legendonly",j=f[s]===_,Z=f[s].showlegend!==!0&&!f[s].legendgroup,V=j||E&&f[s].legendgroup===b,N(f[s],!(!V&&!Z)||Q)}}for(s=0;s<L.length;s++)if(u=L[s]){var $=u.constructUpdate(),re=Object.keys($);for(p=0;p<re.length;p++)i=re[p],(T[i]=T[i]||[])[A[s]]=$[i]}for(x=Object.keys(T),s=0;s<x.length;s++)for(i=x[s],p=0;p<k.length;p++)T[i].hasOwnProperty(p)||(T[i][p]=void 0);v.call("_guiRestyle",e,T,k)}}}}function H(U,te,B){var K=k.indexOf(U),J=T[te];return J||(J=T[te]=[]),k.indexOf(U)===-1&&(k.push(U),K=k.length-1),J[K]=B,K}function N(U,te){if(!l.groupTitle||a){var B=U._fullInput;if(v.hasTransform(B,"groupby")){var K=L[B.index];if(!K){var J=v.getTransformIndices(B,"groupby"),ee=J[J.length-1];K=d.keyedContainer(B,"transforms["+ee+"].styles","target","value.visible"),L[B.index]=K}var ne=K.get(U._group);ne===void 0&&(ne=!0),ne!==!1&&K.set(U._group,te),A[B.index]=H(B.index,"visible",B.visible!==!1)}else{var se=B.visible!==!1&&te;H(B.index,"visible",se)}}}}},{"../../lib":515,"../../registry":647}],423:[function(m,G,Y){Y.isGrouped=function(d){return(d.traceorder||"").indexOf("grouped")!==-1},Y.isVertical=function(d){return d.orientation!=="h"},Y.isReversed=function(d){return(d.traceorder||"").indexOf("reversed")!==-1}},{}],424:[function(m,G,Y){G.exports={moduleType:"component",name:"legend",layoutAttributes:m("./attributes"),supplyLayoutDefaults:m("./defaults"),draw:m("./draw"),style:m("./style")}},{"./attributes":417,"./defaults":419,"./draw":420,"./style":425}],425:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../registry"),w=m("../../lib"),y=w.strTranslate,e=m("../drawing"),t=m("../color"),n=m("../colorscale/helpers").extractOpts,o=m("../../traces/scatter/subtypes"),r=m("../../traces/pie/style_one"),g=m("../../traces/pie/helpers").castOption,c=m("./constants");function a(s,p){return(p?"radial":"horizontal")+(s?"":"reversed")}function h(s){var p=s[0].trace,u=p.contours,i=o.hasLines(p),x=o.hasMarkers(p),f=p.visible&&p.fill&&p.fill!=="none",_=!1,b=!1;if(u){var T=u.coloring;T==="lines"?_=!0:i=T==="none"||T==="heatmap"||u.showlines,u.type==="constraint"?f=u._operation!=="=":T!=="fill"&&T!=="heatmap"||(b=!0)}return{showMarker:x,showLine:i,showFill:f,showGradientLine:_,showGradientFill:b,anyLine:i||_,anyFill:f||b}}function l(s,p,u){return s&&w.isArrayOrTypedArray(s)?p:s>u?u:s}G.exports=function(s,p,u){var i=p._fullLayout;u||(u=i.legend);var x=u.itemsizing==="constant",f=u.itemwidth,_=(f+2*c.itemGap)/2,b=y(_,0),T=function(A,I,P,S){var E;if(A+1)E=A;else{if(!(I&&I.width>0))return 0;E=I.width}return x?S:Math.min(E,P)};function k(A,I,P){var S=A[0].trace,E=S.marker||{},z=E.line||{},D=P?S.visible&&S.type===P:v.traceIs(S,"bar"),j=d.select(I).select("g.legendpoints").selectAll("path.legend"+P).data(D?[A]:[]);j.enter().append("path").classed("legend"+P,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",b),j.exit().remove(),j.each(function(V){var Z=d.select(this),Q=V[0],X=T(Q.mlw,E.line,5,2);Z.style("stroke-width",X+"px");var $=Q.mcc;if(!u._inHover&&"mc"in Q){var re=n(E),H=re.mid;H===void 0&&(H=(re.max+re.min)/2),$=e.tryColorscale(E,"")(H)}var N=$||Q.mc||E.color,U=E.pattern,te=U&&e.getPatternAttr(U.shape,0,"");if(te){var B=e.getPatternAttr(U.bgcolor,0,null),K=e.getPatternAttr(U.fgcolor,0,null),J=U.fgopacity,ee=l(U.size,8,10),ne=l(U.solidity,.5,1),se="legend-"+S.uid;Z.call(e.pattern,"legend",p,se,te,ee,ne,$,U.fillmode,B,K,J)}else Z.call(t.fill,N);X&&t.stroke(Z,Q.mlc||z.color)})}function L(A,I,P){var S=A[0],E=S.trace,z=P?E.visible&&E.type===P:v.traceIs(E,P),D=d.select(I).select("g.legendpoints").selectAll("path.legend"+P).data(z?[A]:[]);if(D.enter().append("path").classed("legend"+P,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",b),D.exit().remove(),D.size()){var j=(E.marker||{}).line,V=T(g(j.width,S.pts),j,5,2),Z=w.minExtend(E,{marker:{line:{width:V}}});Z.marker.line.color=j.color;var Q=w.minExtend(S,{trace:Z});r(D,Q,Z)}}s.each(function(A){var I=d.select(this),P=w.ensureSingle(I,"g","layers");P.style("opacity",A[0].trace.opacity);var S=u.valign,E=A[0].lineHeight,z=A[0].height;if(S!=="middle"&&E&&z){var D={top:1,bottom:-1}[S]*(.5*(E-z+3));P.attr("transform",y(0,D))}else P.attr("transform",null);P.selectAll("g.legendfill").data([A]).enter().append("g").classed("legendfill",!0),P.selectAll("g.legendlines").data([A]).enter().append("g").classed("legendlines",!0);var j=P.selectAll("g.legendsymbols").data([A]);j.enter().append("g").classed("legendsymbols",!0),j.selectAll("g.legendpoints").data([A]).enter().append("g").classed("legendpoints",!0)}).each(function(A){var I,P=A[0].trace,S=[];if(P.visible)switch(P.type){case"histogram2d":case"heatmap":S=[["M-15,-2V4H15V-2Z"]],I=!0;break;case"choropleth":case"choroplethmapbox":S=[["M-6,-6V6H6V-6Z"]],I=!0;break;case"densitymapbox":S=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]],I="radial";break;case"cone":S=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]],I=!1;break;case"streamtube":S=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]],I=!1;break;case"surface":S=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]],I=!0;break;case"mesh3d":S=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],I=!1;break;case"volume":S=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],I=!0;break;case"isosurface":S=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]],I=!1}var E=d.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(S);E.enter().append("path").classed("legend3dandfriends",!0).attr("transform",b).style("stroke-miterlimit",1),E.exit().remove(),E.each(function(z,D){var j,V=d.select(this),Z=n(P),Q=Z.colorscale,X=Z.reversescale;if(Q){if(!I){var $=Q.length;j=D===0?Q[X?$-1:0][1]:D===1?Q[X?0:$-1][1]:Q[Math.floor(($-1)/2)][1]}}else{var re=P.vertexcolor||P.facecolor||P.color;j=w.isArrayOrTypedArray(re)?re[D]||re[0]:re}V.attr("d",z[0]),j?V.call(t.fill,j):V.call(function(H){if(H.size()){var N="legendfill-"+P.uid;e.gradient(H,p,N,a(X,I==="radial"),Q,"fill")}})})}).each(function(A){var I=A[0].trace,P=I.type==="waterfall";if(A[0]._distinct&&P){var S=A[0].trace[A[0].dir].marker;return A[0].mc=S.color,A[0].mlw=S.line.width,A[0].mlc=S.line.color,k(A,this,"waterfall")}var E=[];I.visible&&P&&(E=A[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var z=d.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(E);z.enter().append("path").classed("legendwaterfall",!0).attr("transform",b).style("stroke-miterlimit",1),z.exit().remove(),z.each(function(D){var j=d.select(this),V=I[D[0]].marker,Z=T(void 0,V.line,5,2);j.attr("d",D[1]).style("stroke-width",Z+"px").call(t.fill,V.color),Z&&j.call(t.stroke,V.line.color)})}).each(function(A){k(A,this,"funnel")}).each(function(A){k(A,this)}).each(function(A){var I=A[0].trace,P=d.select(this).select("g.legendpoints").selectAll("path.legendbox").data(I.visible&&v.traceIs(I,"box-violin")?[A]:[]);P.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform",b),P.exit().remove(),P.each(function(){var S=d.select(this);if(I.boxpoints!=="all"&&I.points!=="all"||t.opacity(I.fillcolor)!==0||t.opacity((I.line||{}).color)!==0){var E=T(void 0,I.line,5,2);S.style("stroke-width",E+"px").call(t.fill,I.fillcolor),E&&t.stroke(S,I.line.color)}else{var z=w.minExtend(I,{marker:{size:x?12:w.constrain(I.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});P.call(e.pointStyle,z,p)}})}).each(function(A){L(A,this,"funnelarea")}).each(function(A){L(A,this,"pie")}).each(function(A){var I,P,S=h(A),E=S.showFill,z=S.showLine,D=S.showGradientLine,j=S.showGradientFill,V=S.anyFill,Z=S.anyLine,Q=A[0],X=Q.trace,$=n(X),re=$.colorscale,H=$.reversescale,N=o.hasMarkers(X)||!V?"M5,0":Z?"M5,-2":"M5,-3",U=d.select(this),te=U.select(".legendfill").selectAll("path").data(E||j?[A]:[]);if(te.enter().append("path").classed("js-fill",!0),te.exit().remove(),te.attr("d",N+"h"+f+"v6h-"+f+"z").call(function(J){if(J.size())if(E)e.fillGroupStyle(J,p);else{var ee="legendfill-"+X.uid;e.gradient(J,p,ee,a(H),re,"fill")}}),z||D){var B=T(void 0,X.line,10,5);P=w.minExtend(X,{line:{width:B}}),I=[w.minExtend(Q,{trace:P})]}var K=U.select(".legendlines").selectAll("path").data(z||D?[I]:[]);K.enter().append("path").classed("js-line",!0),K.exit().remove(),K.attr("d",N+(D?"l"+f+",0.0001":"h"+f)).call(z?e.lineGroupStyle:function(J){if(J.size()){var ee="legendline-"+X.uid;e.lineGroupStyle(J),e.gradient(J,p,ee,a(H),re,"stroke")}})}).each(function(A){var I,P,S=h(A),E=S.anyFill,z=S.anyLine,D=S.showLine,j=S.showMarker,V=A[0],Z=V.trace,Q=!j&&!z&&!E&&o.hasText(Z);function X(K,J,ee,ne){var se=w.nestedProperty(Z,K).get(),oe=w.isArrayOrTypedArray(se)&&J?J(se):se;if(x&&oe&&ne!==void 0&&(oe=ne),ee){if(oe<ee[0])return ee[0];if(oe>ee[1])return ee[1]}return oe}function $(K){return V._distinct&&V.index&&K[V.index]?K[V.index]:K[0]}if(j||Q||D){var re={},H={};if(j){re.mc=X("marker.color",$),re.mx=X("marker.symbol",$),re.mo=X("marker.opacity",w.mean,[.2,1]),re.mlc=X("marker.line.color",$),re.mlw=X("marker.line.width",w.mean,[0,5],2),H.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var N=X("marker.size",w.mean,[2,16],12);re.ms=N,H.marker.size=N}D&&(H.line={width:X("line.width",$,[0,10],5)}),Q&&(re.tx="Aa",re.tp=X("textposition",$),re.ts=10,re.tc=X("textfont.color",$),re.tf=X("textfont.family",$)),I=[w.minExtend(V,re)],(P=w.minExtend(Z,H)).selectedpoints=null,P.texttemplate=null}var U=d.select(this).select("g.legendpoints"),te=U.selectAll("path.scatterpts").data(j?I:[]);te.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform",b),te.exit().remove(),te.call(e.pointStyle,P,p),j&&(I[0].mrc=3);var B=U.selectAll("g.pointtext").data(Q?I:[]);B.enter().append("g").classed("pointtext",!0).append("text").attr("transform",b),B.exit().remove(),B.selectAll("text").call(e.textPointStyle,P,p)}).each(function(A){var I=A[0].trace,P=d.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(I.visible&&I.type==="candlestick"?[A,A]:[]);P.enter().append("path").classed("legendcandle",!0).attr("d",function(S,E){return E?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"}).attr("transform",b).style("stroke-miterlimit",1),P.exit().remove(),P.each(function(S,E){var z=d.select(this),D=I[E?"increasing":"decreasing"],j=T(void 0,D.line,5,2);z.style("stroke-width",j+"px").call(t.fill,D.fillcolor),j&&t.stroke(z,D.line.color)})}).each(function(A){var I=A[0].trace,P=d.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(I.visible&&I.type==="ohlc"?[A,A]:[]);P.enter().append("path").classed("legendohlc",!0).attr("d",function(S,E){return E?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"}).attr("transform",b).style("stroke-miterlimit",1),P.exit().remove(),P.each(function(S,E){var z=d.select(this),D=I[E?"increasing":"decreasing"],j=T(void 0,D.line,5,2);z.style("fill","none").call(e.dashLine,D.line.dash,j),j&&t.stroke(z,D.line.color)})})}},{"../../lib":515,"../../registry":647,"../../traces/pie/helpers":915,"../../traces/pie/style_one":921,"../../traces/scatter/subtypes":961,"../color":367,"../colorscale/helpers":378,"../drawing":389,"./constants":418,"@plotly/d3":58}],426:[function(m,G,Y){m("./constants"),G.exports={editType:"modebar",orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},add:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"},remove:{valType:"string",arrayOk:!0,dflt:"",editType:"modebar"}}},{"./constants":428}],427:[function(m,G,Y){var d=m("../../registry"),v=m("../../plots/plots"),w=m("../../plots/cartesian/axis_ids"),y=m("../../fonts/ploticon"),e=m("../shapes/draw").eraseActiveShape,t=m("../../lib"),n=t._,o=G.exports={};function r(i,x){var f,_,b=x.currentTarget,T=b.getAttribute("data-attr"),k=b.getAttribute("data-val")||!0,L=i._fullLayout,A={},I=w.list(i,null,!0),P=L._cartesianSpikesEnabled;if(T==="zoom"){var S,E=k==="in"?.5:2,z=(1+E)/2,D=(1-E)/2;for(_=0;_<I.length;_++)if(!(f=I[_]).fixedrange)if(S=f._name,k==="auto")A[S+".autorange"]=!0;else if(k==="reset"){if(f._rangeInitial===void 0)A[S+".autorange"]=!0;else{var j=f._rangeInitial.slice();A[S+".range[0]"]=j[0],A[S+".range[1]"]=j[1]}f._showSpikeInitial!==void 0&&(A[S+".showspikes"]=f._showSpikeInitial,P!=="on"||f._showSpikeInitial||(P="off"))}else{var V=[f.r2l(f.range[0]),f.r2l(f.range[1])],Z=[z*V[0]+D*V[1],z*V[1]+D*V[0]];A[S+".range[0]"]=f.l2r(Z[0]),A[S+".range[1]"]=f.l2r(Z[1])}}else T!=="hovermode"||k!=="x"&&k!=="y"||(k=L._isHoriz?"y":"x",b.setAttribute("data-val",k)),A[T]=k;L._cartesianSpikesEnabled=P,d.call("_guiRelayout",i,A)}function g(i,x){for(var f=x.currentTarget,_=f.getAttribute("data-attr"),b=f.getAttribute("data-val")||!0,T=i._fullLayout._subplots.gl3d||[],k={},L=_.split("."),A=0;A<T.length;A++)k[T[A]+"."+L[1]]=b;var I=b==="pan"?b:"zoom";k.dragmode=I,d.call("_guiRelayout",i,k)}function c(i,x){for(var f=x.currentTarget.getAttribute("data-attr"),_=f==="resetLastSave",b=f==="resetDefault",T=i._fullLayout,k=T._subplots.gl3d||[],L={},A=0;A<k.length;A++){var I,P=k[A],S=P+".camera",E=P+".aspectratio",z=P+".aspectmode",D=T[P]._scene;_?(L[S+".up"]=D.viewInitial.up,L[S+".eye"]=D.viewInitial.eye,L[S+".center"]=D.viewInitial.center,I=!0):b&&(L[S+".up"]=null,L[S+".eye"]=null,L[S+".center"]=null,I=!0),I&&(L[E+".x"]=D.viewInitial.aspectratio.x,L[E+".y"]=D.viewInitial.aspectratio.y,L[E+".z"]=D.viewInitial.aspectratio.z,L[z]=D.viewInitial.aspectmode)}d.call("_guiRelayout",i,L)}function a(i,x){var f=x.currentTarget,_=f._previousVal,b=i._fullLayout,T=b._subplots.gl3d||[],k=["xaxis","yaxis","zaxis"],L={},A={};if(_)A=_,f._previousVal=null;else{for(var I=0;I<T.length;I++){var P=T[I],S=b[P],E=P+".hovermode";L[E]=S.hovermode,A[E]=!1;for(var z=0;z<3;z++){var D=k[z],j=P+"."+D+".showspikes";A[j]=!1,L[j]=S[D].showspikes}}f._previousVal=L}return A}function h(i,x){for(var f=x.currentTarget,_=f.getAttribute("data-attr"),b=f.getAttribute("data-val")||!0,T=i._fullLayout,k=T._subplots.geo||[],L=0;L<k.length;L++){var A=k[L],I=T[A];if(_==="zoom"){var P=I.projection.scale,S=b==="in"?2*P:.5*P;d.call("_guiRelayout",i,A+".projection.scale",S)}}_==="reset"&&u(i,"geo")}function l(i){var x=i._fullLayout;return!x.hovermode&&(x._has("cartesian")?x._isHoriz?"y":"x":"closest")}function s(i){var x=l(i);d.call("_guiRelayout",i,"hovermode",x)}function p(i,x){for(var f=x.currentTarget.getAttribute("data-val"),_=i._fullLayout,b=_._subplots.mapbox||[],T={},k=0;k<b.length;k++){var L=b[k],A=_[L].zoom,I=f==="in"?1.05*A:A/1.05;T[L+".zoom"]=I}d.call("_guiRelayout",i,T)}function u(i,x){for(var f=i._fullLayout,_=f._subplots[x]||[],b={},T=0;T<_.length;T++)for(var k=_[T],L=f[k]._subplot.viewInitial,A=Object.keys(L),I=0;I<A.length;I++){var P=A[I];b[k+"."+P]=L[P]}d.call("_guiRelayout",i,b)}o.toImage={name:"toImage",title:function(i){var x=(i._context.toImageButtonOptions||{}).format||"png";return n(i,x==="png"?"Download plot as a png":"Download plot")},icon:y.camera,click:function(i){var x=i._context.toImageButtonOptions,f={format:x.format||"png"};t.notifier(n(i,"Taking snapshot - this may take a few seconds"),"long"),f.format!=="svg"&&t.isIE()&&(t.notifier(n(i,"IE only supports svg.  Changing format to svg."),"long"),f.format="svg"),["filename","width","height","scale"].forEach(function(_){_ in x&&(f[_]=x[_])}),d.call("downloadImage",i,f).then(function(_){t.notifier(n(i,"Snapshot succeeded")+" - "+_,"long")}).catch(function(){t.notifier(n(i,"Sorry, there was a problem downloading your snapshot!"),"long")})}},o.sendDataToCloud={name:"sendDataToCloud",title:function(i){return n(i,"Edit in Chart Studio")},icon:y.disk,click:function(i){v.sendDataToCloud(i)}},o.editInChartStudio={name:"editInChartStudio",title:function(i){return n(i,"Edit in Chart Studio")},icon:y.pencil,click:function(i){v.sendDataToCloud(i)}},o.zoom2d={name:"zoom2d",_cat:"zoom",title:function(i){return n(i,"Zoom")},attr:"dragmode",val:"zoom",icon:y.zoombox,click:r},o.pan2d={name:"pan2d",_cat:"pan",title:function(i){return n(i,"Pan")},attr:"dragmode",val:"pan",icon:y.pan,click:r},o.select2d={name:"select2d",_cat:"select",title:function(i){return n(i,"Box Select")},attr:"dragmode",val:"select",icon:y.selectbox,click:r},o.lasso2d={name:"lasso2d",_cat:"lasso",title:function(i){return n(i,"Lasso Select")},attr:"dragmode",val:"lasso",icon:y.lasso,click:r},o.drawclosedpath={name:"drawclosedpath",title:function(i){return n(i,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:y.drawclosedpath,click:r},o.drawopenpath={name:"drawopenpath",title:function(i){return n(i,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:y.drawopenpath,click:r},o.drawline={name:"drawline",title:function(i){return n(i,"Draw line")},attr:"dragmode",val:"drawline",icon:y.drawline,click:r},o.drawrect={name:"drawrect",title:function(i){return n(i,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:y.drawrect,click:r},o.drawcircle={name:"drawcircle",title:function(i){return n(i,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:y.drawcircle,click:r},o.eraseshape={name:"eraseshape",title:function(i){return n(i,"Erase active shape")},icon:y.eraseshape,click:e},o.zoomIn2d={name:"zoomIn2d",_cat:"zoomin",title:function(i){return n(i,"Zoom in")},attr:"zoom",val:"in",icon:y.zoom_plus,click:r},o.zoomOut2d={name:"zoomOut2d",_cat:"zoomout",title:function(i){return n(i,"Zoom out")},attr:"zoom",val:"out",icon:y.zoom_minus,click:r},o.autoScale2d={name:"autoScale2d",_cat:"autoscale",title:function(i){return n(i,"Autoscale")},attr:"zoom",val:"auto",icon:y.autoscale,click:r},o.resetScale2d={name:"resetScale2d",_cat:"resetscale",title:function(i){return n(i,"Reset axes")},attr:"zoom",val:"reset",icon:y.home,click:r},o.hoverClosestCartesian={name:"hoverClosestCartesian",_cat:"hoverclosest",title:function(i){return n(i,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:y.tooltip_basic,gravity:"ne",click:r},o.hoverCompareCartesian={name:"hoverCompareCartesian",_cat:"hoverCompare",title:function(i){return n(i,"Compare data on hover")},attr:"hovermode",val:function(i){return i._fullLayout._isHoriz?"y":"x"},icon:y.tooltip_compare,gravity:"ne",click:r},o.zoom3d={name:"zoom3d",_cat:"zoom",title:function(i){return n(i,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:y.zoombox,click:g},o.pan3d={name:"pan3d",_cat:"pan",title:function(i){return n(i,"Pan")},attr:"scene.dragmode",val:"pan",icon:y.pan,click:g},o.orbitRotation={name:"orbitRotation",title:function(i){return n(i,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:y["3d_rotate"],click:g},o.tableRotation={name:"tableRotation",title:function(i){return n(i,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:y["z-axis"],click:g},o.resetCameraDefault3d={name:"resetCameraDefault3d",_cat:"resetCameraDefault",title:function(i){return n(i,"Reset camera to default")},attr:"resetDefault",icon:y.home,click:c},o.resetCameraLastSave3d={name:"resetCameraLastSave3d",_cat:"resetCameraLastSave",title:function(i){return n(i,"Reset camera to last save")},attr:"resetLastSave",icon:y.movie,click:c},o.hoverClosest3d={name:"hoverClosest3d",_cat:"hoverclosest",title:function(i){return n(i,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:y.tooltip_basic,gravity:"ne",click:function(i,x){var f=a(i,x);d.call("_guiRelayout",i,f)}},o.zoomInGeo={name:"zoomInGeo",_cat:"zoomin",title:function(i){return n(i,"Zoom in")},attr:"zoom",val:"in",icon:y.zoom_plus,click:h},o.zoomOutGeo={name:"zoomOutGeo",_cat:"zoomout",title:function(i){return n(i,"Zoom out")},attr:"zoom",val:"out",icon:y.zoom_minus,click:h},o.resetGeo={name:"resetGeo",_cat:"reset",title:function(i){return n(i,"Reset")},attr:"reset",val:null,icon:y.autoscale,click:h},o.hoverClosestGeo={name:"hoverClosestGeo",_cat:"hoverclosest",title:function(i){return n(i,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:y.tooltip_basic,gravity:"ne",click:s},o.hoverClosestGl2d={name:"hoverClosestGl2d",_cat:"hoverclosest",title:function(i){return n(i,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:y.tooltip_basic,gravity:"ne",click:s},o.hoverClosestPie={name:"hoverClosestPie",_cat:"hoverclosest",title:function(i){return n(i,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:y.tooltip_basic,gravity:"ne",click:s},o.resetViewSankey={name:"resetSankeyGroup",title:function(i){return n(i,"Reset view")},icon:y.home,click:function(i){for(var x={"node.groups":[],"node.x":[],"node.y":[]},f=0;f<i._fullData.length;f++){var _=i._fullData[f]._viewInitial;x["node.groups"].push(_.node.groups.slice()),x["node.x"].push(_.node.x.slice()),x["node.y"].push(_.node.y.slice())}d.call("restyle",i,x)}},o.toggleHover={name:"toggleHover",title:function(i){return n(i,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:y.tooltip_basic,gravity:"ne",click:function(i,x){var f=a(i,x);f.hovermode=l(i),d.call("_guiRelayout",i,f)}},o.resetViews={name:"resetViews",title:function(i){return n(i,"Reset views")},icon:y.home,click:function(i,x){var f=x.currentTarget;f.setAttribute("data-attr","zoom"),f.setAttribute("data-val","reset"),r(i,x),f.setAttribute("data-attr","resetLastSave"),c(i,x),u(i,"geo"),u(i,"mapbox")}},o.toggleSpikelines={name:"toggleSpikelines",title:function(i){return n(i,"Toggle Spike Lines")},icon:y.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(i){var x=i._fullLayout,f=x._cartesianSpikesEnabled;x._cartesianSpikesEnabled=f==="on"?"off":"on",d.call("_guiRelayout",i,function(_){for(var b=_._fullLayout._cartesianSpikesEnabled==="on",T=w.list(_,null,!0),k={},L=0;L<T.length;L++){var A=T[L];k[A._name+".showspikes"]=!!b||A._showSpikeInitial}return k}(i))}},o.resetViewMapbox={name:"resetViewMapbox",_cat:"resetView",title:function(i){return n(i,"Reset view")},attr:"reset",icon:y.home,click:function(i){u(i,"mapbox")}},o.zoomInMapbox={name:"zoomInMapbox",_cat:"zoomin",title:function(i){return n(i,"Zoom in")},attr:"zoom",val:"in",icon:y.zoom_plus,click:p},o.zoomOutMapbox={name:"zoomOutMapbox",_cat:"zoomout",title:function(i){return n(i,"Zoom out")},attr:"zoom",val:"out",icon:y.zoom_minus,click:p}},{"../../fonts/ploticon":494,"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../shapes/draw":462}],428:[function(m,G,Y){var d=m("./buttons"),v=Object.keys(d),w=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"],y=["v1hovermode","hoverclosest","hovercompare","togglehover","togglespikelines"].concat(w),e=[];v.forEach(function(t){(function(n){if(y.indexOf(n._cat||n.name)===-1){var o=n.name,r=(n._cat||n.name).toLowerCase();e.indexOf(o)===-1&&e.push(o),e.indexOf(r)===-1&&e.push(r)}})(d[t])}),e.sort(),G.exports={DRAW_MODES:w,backButtons:y,foreButtons:e}},{"./buttons":427}],429:[function(m,G,Y){var d=m("../../lib"),v=m("../color"),w=m("../../plot_api/plot_template"),y=m("./attributes");G.exports=function(e,t){var n=e.modebar||{},o=w.newContainer(t,"modebar");function r(c,a){return d.coerce(n,o,y,c,a)}r("orientation"),r("bgcolor",v.addOpacity(t.paper_bgcolor,.5));var g=v.contrast(v.rgb(t.modebar.bgcolor));r("color",v.addOpacity(g,.3)),r("activecolor",v.addOpacity(g,.7)),r("uirevision",t.uirevision),r("add"),r("remove")}},{"../../lib":515,"../../plot_api/plot_template":555,"../color":367,"./attributes":426}],430:[function(m,G,Y){G.exports={moduleType:"component",name:"modebar",layoutAttributes:m("./attributes"),supplyLayoutDefaults:m("./defaults"),manage:m("./manage")}},{"./attributes":426,"./defaults":429,"./manage":431}],431:[function(m,G,Y){var d=m("../../plots/cartesian/axis_ids"),v=m("../../traces/scatter/subtypes"),w=m("../../registry"),y=m("../fx/helpers").isUnifiedHover,e=m("./modebar"),t=m("./buttons"),n=m("./constants").DRAW_MODES,o=m("../../lib").extendDeep;G.exports=function(r){var g=r._fullLayout,c=r._context,a=g._modeBar;if(c.displayModeBar||c.watermark){if(!Array.isArray(c.modeBarButtonsToRemove))throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "));if(!Array.isArray(c.modeBarButtonsToAdd))throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "));var h,l=c.modeBarButtons;h=Array.isArray(l)&&l.length?function(s){for(var p=o([],s),u=0;u<p.length;u++)for(var i=p[u],x=0;x<i.length;x++){var f=i[x];if(typeof f=="string"){if(t[f]===void 0)throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "));p[u][x]=t[f]}}return p}(l):!c.displayModeBar&&c.watermark?[]:function(s){var p=s._fullLayout,u=s._fullData,i=s._context;function x(se,oe){if(typeof oe=="string"){if(oe.toLowerCase()===se.toLowerCase())return!0}else{var me=oe.name,ce=oe._cat||oe.name;if(me===se||ce===se.toLowerCase())return!0}return!1}var f=p.modebar.add;typeof f=="string"&&(f=[f]);var _=p.modebar.remove;typeof _=="string"&&(_=[_]);var b=i.modeBarButtonsToAdd.concat(f.filter(function(se){for(var oe=0;oe<i.modeBarButtonsToRemove.length;oe++)if(x(se,i.modeBarButtonsToRemove[oe]))return!1;return!0})),T=i.modeBarButtonsToRemove.concat(_.filter(function(se){for(var oe=0;oe<i.modeBarButtonsToAdd.length;oe++)if(x(se,i.modeBarButtonsToAdd[oe]))return!1;return!0})),k=p._has("cartesian"),L=p._has("gl3d"),A=p._has("geo"),I=p._has("pie"),P=p._has("funnelarea"),S=p._has("gl2d"),E=p._has("ternary"),z=p._has("mapbox"),D=p._has("polar"),j=p._has("smith"),V=p._has("sankey"),Z=function(se){for(var oe=d.list({_fullLayout:se},null,!0),me=0;me<oe.length;me++)if(!oe[me].fixedrange)return!1;return!0}(p),Q=y(p.hovermode),X=[];function $(se){if(se.length){for(var oe=[],me=0;me<se.length;me++){for(var ce=se[me],ye=t[ce],Se=ye.name.toLowerCase(),fe=(ye._cat||ye.name).toLowerCase(),ge=!1,Te=0;Te<T.length;Te++){var le=T[Te].toLowerCase();if(le===Se||le===fe){ge=!0;break}}ge||oe.push(t[ce])}X.push(oe)}}var re=["toImage"];i.showEditInChartStudio?re.push("editInChartStudio"):i.showSendToCloud&&re.push("sendDataToCloud"),$(re);var H=[],N=[],U=[],te=[];(k||S||I||P||E)+A+L+z+D+j>1?(N=["toggleHover"],U=["resetViews"]):A?(H=["zoomInGeo","zoomOutGeo"],N=["hoverClosestGeo"],U=["resetGeo"]):L?(N=["hoverClosest3d"],U=["resetCameraDefault3d","resetCameraLastSave3d"]):z?(H=["zoomInMapbox","zoomOutMapbox"],N=["toggleHover"],U=["resetViewMapbox"]):S?N=["hoverClosestGl2d"]:I?N=["hoverClosestPie"]:V?(N=["hoverClosestCartesian","hoverCompareCartesian"],U=["resetViewSankey"]):N=["toggleHover"],k&&(N=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),(function(se){for(var oe=0;oe<se.length;oe++)if(!w.traceIs(se[oe],"noHover"))return!1;return!0}(u)||Q)&&(N=[]),!k&&!S||Z||(H=["zoomIn2d","zoomOut2d","autoScale2d"],U[0]!=="resetViews"&&(U=["resetScale2d"])),L?te=["zoom3d","pan3d","orbitRotation","tableRotation"]:(k||S)&&!Z||E?te=["zoom2d","pan2d"]:z||A?te=["pan2d"]:D&&(te=["zoom2d"]),function(se){for(var oe=!1,me=0;me<se.length&&!oe;me++){var ce=se[me];ce._module&&ce._module.selectPoints&&(w.traceIs(ce,"scatter-like")?(v.hasMarkers(ce)||v.hasText(ce))&&(oe=!0):w.traceIs(ce,"box-violin")&&ce.boxpoints!=="all"&&ce.points!=="all"||(oe=!0))}return oe}(u)&&te.push("select2d","lasso2d");var B=[],K=function(se){B.indexOf(se)===-1&&N.indexOf(se)!==-1&&B.push(se)};if(Array.isArray(b)){for(var J=[],ee=0;ee<b.length;ee++){var ne=b[ee];typeof ne=="string"?(ne=ne.toLowerCase(),n.indexOf(ne)!==-1?(p._has("mapbox")||p._has("cartesian"))&&te.push(ne):ne==="togglespikelines"?K("toggleSpikelines"):ne==="togglehover"?K("toggleHover"):ne==="hovercompare"?K("hoverCompareCartesian"):ne==="hoverclosest"?(K("hoverClosestCartesian"),K("hoverClosestGeo"),K("hoverClosest3d"),K("hoverClosestGl2d"),K("hoverClosestPie")):ne==="v1hovermode"&&(K("toggleHover"),K("hoverClosestCartesian"),K("hoverCompareCartesian"),K("hoverClosestGeo"),K("hoverClosest3d"),K("hoverClosestGl2d"),K("hoverClosestPie"))):J.push(ne)}b=J}return $(te),$(H.concat(U)),$(B),function(se,oe){if(oe.length)if(Array.isArray(oe[0]))for(var me=0;me<oe.length;me++)se.push(oe[me]);else se.push(oe);return se}(X,b)}(r),a?a.update(r,h):g._modeBar=e(r,h)}else a&&(a.destroy(),delete g._modeBar)}},{"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../../traces/scatter/subtypes":961,"../fx/helpers":403,"./buttons":427,"./constants":428,"./modebar":432}],432:[function(m,G,Y){var d=m("@plotly/d3"),v=m("fast-isnumeric"),w=m("../../lib"),y=m("../../fonts/ploticon"),e=m("../../version").version,t=new DOMParser;function n(r){this.container=r.container,this.element=document.createElement("div"),this.update(r.graphInfo,r.buttons),this.container.appendChild(this.element)}var o=n.prototype;o.update=function(r,g){this.graphInfo=r;var c=this.graphInfo._context,a=this.graphInfo._fullLayout,h="modebar-"+a._uid;this.element.setAttribute("id",h),this._uid=h,this.element.className="modebar",c.displayModeBar==="hover"&&(this.element.className+=" modebar--hover ease-bg"),a.modebar.orientation==="v"&&(this.element.className+=" vertical",g=g.reverse());var l=a.modebar,s=c.displayModeBar==="hover"?".js-plotly-plot .plotly:hover ":"";w.deleteRelatedStyleRule(h),w.addRelatedStyleRule(h,s+"#"+h+" .modebar-group","background-color: "+l.bgcolor),w.addRelatedStyleRule(h,"#"+h+" .modebar-btn .icon path","fill: "+l.color),w.addRelatedStyleRule(h,"#"+h+" .modebar-btn:hover .icon path","fill: "+l.activecolor),w.addRelatedStyleRule(h,"#"+h+" .modebar-btn.active .icon path","fill: "+l.activecolor);var p=!this.hasButtons(g),u=this.hasLogo!==c.displaylogo,i=this.locale!==c.locale;if(this.locale=c.locale,(p||u||i)&&(this.removeAllButtons(),this.updateButtons(g),c.watermark||c.displaylogo)){var x=this.getLogo();c.watermark&&(x.className=x.className+" watermark"),a.modebar.orientation==="v"?this.element.insertBefore(x,this.element.childNodes[0]):this.element.appendChild(x),this.hasLogo=!0}this.updateActiveButton()},o.updateButtons=function(r){var g=this;this.buttons=r,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach(function(c){var a=g.createGroup();c.forEach(function(h){var l=h.name;if(!l)throw new Error("must provide button 'name' in button config");if(g.buttonsNames.indexOf(l)!==-1)throw new Error("button name '"+l+"' is taken");g.buttonsNames.push(l);var s=g.createButton(h);g.buttonElements.push(s),a.appendChild(s)}),g.element.appendChild(a)})},o.createGroup=function(){var r=document.createElement("div");return r.className="modebar-group",r},o.createButton=function(r){var g=this,c=document.createElement("a");c.setAttribute("rel","tooltip"),c.className="modebar-btn";var a=r.title;a===void 0?a=r.name:typeof a=="function"&&(a=a(this.graphInfo)),(a||a===0)&&c.setAttribute("data-title",a),r.attr!==void 0&&c.setAttribute("data-attr",r.attr);var h=r.val;if(h!==void 0&&(typeof h=="function"&&(h=h(this.graphInfo)),c.setAttribute("data-val",h)),typeof r.click!="function")throw new Error("must provide button 'click' function in button config");c.addEventListener("click",function(s){r.click(g.graphInfo,s),g.updateActiveButton(s.currentTarget)}),c.setAttribute("data-toggle",r.toggle||!1),r.toggle&&d.select(c).classed("active",!0);var l=r.icon;return typeof l=="function"?c.appendChild(l()):c.appendChild(this.createIcon(l||y.question)),c.setAttribute("data-gravity",r.gravity||"n"),c},o.createIcon=function(r){var g,c=v(r.height)?Number(r.height):r.ascent-r.descent,a="http://www.w3.org/2000/svg";if(r.path){(g=document.createElementNS(a,"svg")).setAttribute("viewBox",[0,0,r.width,c].join(" ")),g.setAttribute("class","icon");var h=document.createElementNS(a,"path");h.setAttribute("d",r.path),r.transform?h.setAttribute("transform",r.transform):r.ascent!==void 0&&h.setAttribute("transform","matrix(1 0 0 -1 0 "+r.ascent+")"),g.appendChild(h)}return r.svg&&(g=t.parseFromString(r.svg,"application/xml").childNodes[0]),g.setAttribute("height","1em"),g.setAttribute("width","1em"),g},o.updateActiveButton=function(r){var g=this.graphInfo._fullLayout,c=r!==void 0?r.getAttribute("data-attr"):null;this.buttonElements.forEach(function(a){var h=a.getAttribute("data-val")||!0,l=a.getAttribute("data-attr"),s=a.getAttribute("data-toggle")==="true",p=d.select(a);if(s)l===c&&p.classed("active",!p.classed("active"));else{var u=l===null?l:w.nestedProperty(g,l).get();p.classed("active",u===h)}})},o.hasButtons=function(r){var g=this.buttons;if(!g||r.length!==g.length)return!1;for(var c=0;c<r.length;++c){if(r[c].length!==g[c].length)return!1;for(var a=0;a<r[c].length;a++)if(r[c][a].name!==g[c][a].name)return!1}return!0},o.getLogo=function(){var r=this.createGroup(),g=document.createElement("a");return g.href="https://plotly.com/",g.target="_blank",g.setAttribute("data-title",w._(this.graphInfo,"Produced with Plotly.js")+" (v"+e+")"),g.className="modebar-btn plotlyjsicon modebar-btn--logo",g.appendChild(this.createIcon(y.newplotlylogo)),r.appendChild(g),r},o.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},o.destroy=function(){w.removeElement(this.container.querySelector(".modebar")),w.deleteRelatedStyleRule(this._uid)},G.exports=function(r,g){var c=r._fullLayout,a=new n({graphInfo:r,container:c._modebardiv.node(),buttons:g});return c._privateplot&&d.select(a.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),a}},{"../../fonts/ploticon":494,"../../lib":515,"../../version":1132,"@plotly/d3":58,"fast-isnumeric":190}],433:[function(m,G,Y){var d=m("../../plots/font_attributes"),v=m("../color/attributes"),w=(0,m("../../plot_api/plot_template").templatedArray)("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});G.exports={visible:{valType:"boolean",editType:"plot"},buttons:w,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:d({editType:"plot"}),bgcolor:{valType:"color",dflt:v.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:v.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":555,"../../plots/font_attributes":594,"../color/attributes":366}],434:[function(m,G,Y){G.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],435:[function(m,G,Y){var d=m("../../lib"),v=m("../color"),w=m("../../plot_api/plot_template"),y=m("../../plots/array_container_defaults"),e=m("./attributes"),t=m("./constants");function n(o,r,g,c){var a=c.calendar;function h(s,p){return d.coerce(o,r,e.buttons,s,p)}if(h("visible")){var l=h("step");l!=="all"&&(!a||a==="gregorian"||l!=="month"&&l!=="year"?h("stepmode"):r.stepmode="backward",h("count")),h("label")}}G.exports=function(o,r,g,c,a){var h=o.rangeselector||{},l=w.newContainer(r,"rangeselector");function s(i,x){return d.coerce(h,l,e,i,x)}if(s("visible",y(h,l,{name:"buttons",handleItemDefaults:n,calendar:a}).length>0)){var p=function(i,x,f){for(var _=f.filter(function(L){return x[L].anchor===i._id}),b=0,T=0;T<_.length;T++){var k=x[_[T]].domain;k&&(b=Math.max(k[1],b))}return[i.domain[0],b+t.yPad]}(r,g,c);s("x",p[0]),s("y",p[1]),d.noneOrAll(o,r,["x","y"]),s("xanchor"),s("yanchor"),d.coerceFont(s,"font",g.font);var u=s("bgcolor");s("activecolor",v.contrast(u,t.lightAmount,t.darkAmount)),s("bordercolor"),s("borderwidth")}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../color":367,"./attributes":433,"./constants":434}],436:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../registry"),w=m("../../plots/plots"),y=m("../color"),e=m("../drawing"),t=m("../../lib"),n=t.strTranslate,o=m("../../lib/svg_text_utils"),r=m("../../plots/cartesian/axis_ids"),g=m("../../constants/alignment"),c=g.LINE_SPACING,a=g.FROM_TL,h=g.FROM_BR,l=m("./constants"),s=m("./get_update_object");function p(x){return x._id}function u(x,f,_){var b=t.ensureSingle(x,"rect","selector-rect",function(T){T.attr("shape-rendering","crispEdges")});b.attr({rx:l.rx,ry:l.ry}),b.call(y.stroke,f.bordercolor).call(y.fill,function(T,k){return k._isActive||k._isHovered?T.activecolor:T.bgcolor}(f,_)).style("stroke-width",f.borderwidth+"px")}function i(x,f,_,b){t.ensureSingle(x,"text","selector-text",function(T){T.attr("text-anchor","middle")}).call(e.font,f.font).text(function(T,k){return T.label?k?t.templateString(T.label,k):T.label:T.step==="all"?"all":T.count+T.step.charAt(0)}(_,b._fullLayout._meta)).call(function(T){o.convertToTspans(T,b)})}G.exports=function(x){var f=x._fullLayout._infolayer.selectAll(".rangeselector").data(function(_){for(var b=r.list(_,"x",!0),T=[],k=0;k<b.length;k++){var L=b[k];L.rangeselector&&L.rangeselector.visible&&T.push(L)}return T}(x),p);f.enter().append("g").classed("rangeselector",!0),f.exit().remove(),f.style({cursor:"pointer","pointer-events":"all"}),f.each(function(_){var b=d.select(this),T=_,k=T.rangeselector,L=b.selectAll("g.button").data(t.filterVisible(k.buttons));L.enter().append("g").classed("button",!0),L.exit().remove(),L.each(function(A){var I=d.select(this),P=s(T,A);A._isActive=function(S,E,z){if(E.step==="all")return S.autorange===!0;var D=Object.keys(z);return S.range[0]===z[D[0]]&&S.range[1]===z[D[1]]}(T,A,P),I.call(u,k,A),I.call(i,k,A,x),I.on("click",function(){x._dragged||v.call("_guiRelayout",x,P)}),I.on("mouseover",function(){A._isHovered=!0,I.call(u,k,A)}),I.on("mouseout",function(){A._isHovered=!1,I.call(u,k,A)})}),function(A,I,P,S,E){var z=0,D=0,j=P.borderwidth;I.each(function(){var re=d.select(this).select(".selector-text"),H=P.font.size*c,N=Math.max(H*o.lineCount(re),16)+3;D=Math.max(D,N)}),I.each(function(){var re=d.select(this),H=re.select(".selector-rect"),N=re.select(".selector-text"),U=N.node()&&e.bBox(N.node()).width,te=P.font.size*c,B=o.lineCount(N),K=Math.max(U+10,l.minButtonWidth);re.attr("transform",n(j+z,j)),H.attr({x:0,y:0,width:K,height:D}),o.positionText(N,K/2,D/2-(B-1)*te/2+3),z+=K+5});var V=A._fullLayout._size,Z=V.l+V.w*P.x,Q=V.t+V.h*(1-P.y),X="left";t.isRightAnchor(P)&&(Z-=z,X="right"),t.isCenterAnchor(P)&&(Z-=z/2,X="center");var $="top";t.isBottomAnchor(P)&&(Q-=D,$="bottom"),t.isMiddleAnchor(P)&&(Q-=D/2,$="middle"),z=Math.ceil(z),D=Math.ceil(D),Z=Math.round(Z),Q=Math.round(Q),w.autoMargin(A,S+"-range-selector",{x:P.x,y:P.y,l:z*a[X],r:z*h[X],b:D*h[$],t:D*a[$]}),E.attr("transform",n(Z,Q))}(x,L,k,T._name,b)})}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../color":367,"../drawing":389,"./constants":434,"./get_update_object":437,"@plotly/d3":58}],437:[function(m,G,Y){var d=m("d3-time"),v=m("../../lib").titleCase;G.exports=function(w,y){var e=w._name,t={};if(y.step==="all")t[e+".autorange"]=!0;else{var n=function(o,r){var g,c=o.range,a=new Date(o.r2l(c[1])),h=r.step,l=d["utc"+v(h)],s=r.count;switch(r.stepmode){case"backward":g=o.l2r(+l.offset(a,-s));break;case"todate":var p=l.offset(a,-s);g=o.l2r(+l.ceil(p))}var u=c[1];return[g,u]}(w,y);t[e+".range[0]"]=n[0],t[e+".range[1]"]=n[1]}return t}},{"../../lib":515,"d3-time":122}],438:[function(m,G,Y){G.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:m("./attributes")}}},layoutAttributes:m("./attributes"),handleDefaults:m("./defaults"),draw:m("./draw")}},{"./attributes":433,"./defaults":435,"./draw":436}],439:[function(m,G,Y){var d=m("../color/attributes");G.exports={bgcolor:{valType:"color",dflt:d.background,editType:"plot"},bordercolor:{valType:"color",dflt:d.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":366}],440:[function(m,G,Y){var d=m("../../plots/cartesian/axis_ids").list,v=m("../../plots/cartesian/autorange").getAutoRange,w=m("./constants");G.exports=function(y){for(var e=d(y,"x",!0),t=0;t<e.length;t++){var n=e[t],o=n[w.name];o&&o.visible&&o.autorange&&(o._input.autorange=!0,o._input.range=o.range=v(y,n))}}},{"../../plots/cartesian/autorange":565,"../../plots/cartesian/axis_ids":570,"./constants":441}],441:[function(m,G,Y){G.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],442:[function(m,G,Y){var d=m("../../lib"),v=m("../../plot_api/plot_template"),w=m("../../plots/cartesian/axis_ids"),y=m("./attributes"),e=m("./oppaxis_attributes");G.exports=function(t,n,o){var r=t[o],g=n[o];if(r.rangeslider||n._requestRangeslider[g._id]){d.isPlainObject(r.rangeslider)||(r.rangeslider={});var c,a,h=r.rangeslider,l=v.newContainer(g,"rangeslider");if(b("visible")){b("bgcolor",n.plot_bgcolor),b("bordercolor"),b("borderwidth"),b("thickness"),b("autorange",!g.isValidRange(h.range)),b("range");var s=n._subplots;if(s)for(var p=s.cartesian.filter(function(k){return k.substr(0,k.indexOf("y"))===w.name2id(o)}).map(function(k){return k.substr(k.indexOf("y"),k.length)}),u=d.simpleMap(p,w.id2name),i=0;i<u.length;i++){var x=u[i];c=h[x]||{},a=v.newContainer(l,x,"yaxis");var f,_=n[x];c.range&&_.isValidRange(c.range)&&(f="fixed"),T("rangemode",f)!=="match"&&T("range",_.range.slice())}l._input=h}}function b(k,L){return d.coerce(h,l,y,k,L)}function T(k,L){return d.coerce(c,a,e,k,L)}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_ids":570,"./attributes":439,"./oppaxis_attributes":446}],443:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../registry"),w=m("../../plots/plots"),y=m("../../lib"),e=y.strTranslate,t=m("../drawing"),n=m("../color"),o=m("../titles"),r=m("../../plots/cartesian"),g=m("../../plots/cartesian/axis_ids"),c=m("../dragelement"),a=m("../../lib/setcursor"),h=m("./constants");function l(f,_,b,T){var k=y.ensureSingle(f,"rect",h.bgClassName,function(P){P.attr({x:0,y:0,"shape-rendering":"crispEdges"})}),L=T.borderwidth%2==0?T.borderwidth:T.borderwidth-1,A=-T._offsetShift,I=t.crispRound(_,T.borderwidth);k.attr({width:T._width+L,height:T._height+L,transform:e(A,A),"stroke-width":I}).call(n.stroke,T.bordercolor).call(n.fill,T.bgcolor)}function s(f,_,b,T){var k=_._fullLayout;y.ensureSingleById(k._topdefs,"clipPath",T._clipId,function(L){L.append("rect").attr({x:0,y:0})}).select("rect").attr({width:T._width,height:T._height})}function p(f,_,b,T){var k,L=_.calcdata,A=f.selectAll("g."+h.rangePlotClassName).data(b._subplotsWith,y.identity);A.enter().append("g").attr("class",function(I){return h.rangePlotClassName+" "+I}).call(t.setClipUrl,T._clipId,_),A.order(),A.exit().remove(),A.each(function(I,P){var S=d.select(this),E=P===0,z=g.getFromId(_,I,"y"),D=z._name,j=T[D],V={data:[],layout:{xaxis:{type:b.type,domain:[0,1],range:T.range.slice(),calendar:b.calendar},width:T._width,height:T._height,margin:{t:0,b:0,l:0,r:0}},_context:_._context};b.rangebreaks&&(V.layout.xaxis.rangebreaks=b.rangebreaks),V.layout[D]={type:z.type,domain:[0,1],range:j.rangemode!=="match"?j.range.slice():z.range.slice(),calendar:z.calendar},z.rangebreaks&&(V.layout[D].rangebreaks=z.rangebreaks),w.supplyDefaults(V);var Z=V._fullLayout.xaxis,Q=V._fullLayout[D];Z.clearCalc(),Z.setScale(),Q.clearCalc(),Q.setScale();var X={id:I,plotgroup:S,xaxis:Z,yaxis:Q,isRangePlot:!0};E?k=X:(X.mainplot="xy",X.mainplotinfo=k),r.rangePlot(_,X,function($,re){for(var H=[],N=0;N<$.length;N++){var U=$[N],te=U[0].trace;te.xaxis+te.yaxis===re&&H.push(U)}return H}(L,I))})}function u(f,_,b,T,k){y.ensureSingle(f,"rect",h.maskMinClassName,function(L){L.attr({x:0,y:0,"shape-rendering":"crispEdges"})}).attr("height",T._height).call(n.fill,h.maskColor),y.ensureSingle(f,"rect",h.maskMaxClassName,function(L){L.attr({y:0,"shape-rendering":"crispEdges"})}).attr("height",T._height).call(n.fill,h.maskColor),k.rangemode!=="match"&&(y.ensureSingle(f,"rect",h.maskMinOppAxisClassName,function(L){L.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",T._width).call(n.fill,h.maskOppAxisColor),y.ensureSingle(f,"rect",h.maskMaxOppAxisClassName,function(L){L.attr({y:0,"shape-rendering":"crispEdges"})}).attr("width",T._width).style("border-top",h.maskOppBorder).call(n.fill,h.maskOppAxisColor))}function i(f,_,b,T){_._context.staticPlot||y.ensureSingle(f,"rect",h.slideBoxClassName,function(k){k.attr({y:0,cursor:h.slideBoxCursor,"shape-rendering":"crispEdges"})}).attr({height:T._height,fill:h.slideBoxFill})}function x(f,_,b,T){var k=y.ensureSingle(f,"g",h.grabberMinClassName),L=y.ensureSingle(f,"g",h.grabberMaxClassName),A={x:0,width:h.handleWidth,rx:h.handleRadius,fill:n.background,stroke:n.defaultLine,"stroke-width":h.handleStrokeWidth,"shape-rendering":"crispEdges"},I={y:Math.round(T._height/4),height:Math.round(T._height/2)};y.ensureSingle(k,"rect",h.handleMinClassName,function(S){S.attr(A)}).attr(I),y.ensureSingle(L,"rect",h.handleMaxClassName,function(S){S.attr(A)}).attr(I);var P={width:h.grabAreaWidth,x:0,y:0,fill:h.grabAreaFill,cursor:_._context.staticPlot?void 0:h.grabAreaCursor};y.ensureSingle(k,"rect",h.grabAreaMinClassName,function(S){S.attr(P)}).attr("height",T._height),y.ensureSingle(L,"rect",h.grabAreaMaxClassName,function(S){S.attr(P)}).attr("height",T._height)}G.exports=function(f){for(var _=f._fullLayout,b=_._rangeSliderData,T=0;T<b.length;T++){var k=b[T][h.name];k._clipId=k._id+"-"+_._uid}var L=_._infolayer.selectAll("g."+h.containerClassName).data(b,function(A){return A._name});L.exit().each(function(A){var I=A[h.name];_._topdefs.select("#"+I._clipId).remove()}).remove(),b.length!==0&&(L.enter().append("g").classed(h.containerClassName,!0).attr("pointer-events","all"),L.each(function(A){var I=d.select(this),P=A[h.name],S=_[g.id2name(A.anchor)],E=P[g.id2name(A.anchor)];if(P.range){var z,D=y.simpleMap(P.range,A.r2l),j=y.simpleMap(A.range,A.r2l);z=j[0]<j[1]?[Math.min(D[0],j[0]),Math.max(D[1],j[1])]:[Math.max(D[0],j[0]),Math.min(D[1],j[1])],P.range=P._input.range=y.simpleMap(z,A.l2r)}A.cleanRange("rangeslider.range");var V=_._size,Z=A.domain;P._width=V.w*(Z[1]-Z[0]);var Q=Math.round(V.l+V.w*Z[0]),X=Math.round(V.t+V.h*(1-A._counterDomainMin)+(A.side==="bottom"?A._depth:0)+P._offsetShift+h.extraPad);I.attr("transform",e(Q,X)),P._rl=y.simpleMap(P.range,A.r2l);var $=P._rl[0],re=P._rl[1],H=re-$;if(P.p2d=function(se){return se/P._width*H+$},P.d2p=function(se){return(se-$)/H*P._width},A.rangebreaks){var N=A.locateBreaks($,re);if(N.length){var U,te,B=0;for(U=0;U<N.length;U++)B+=(te=N[U]).max-te.min;var K=P._width/(re-$-B),J=[-K*$];for(U=0;U<N.length;U++)te=N[U],J.push(J[J.length-1]-K*(te.max-te.min));for(P.d2p=function(se){for(var oe=J[0],me=0;me<N.length;me++){var ce=N[me];if(se>=ce.max)oe=J[me+1];else if(se<ce.min)break}return oe+K*se},U=0;U<N.length;U++)(te=N[U]).pmin=P.d2p(te.min),te.pmax=P.d2p(te.max);P.p2d=function(se){for(var oe=J[0],me=0;me<N.length;me++){var ce=N[me];if(se>=ce.pmax)oe=J[me+1];else if(se<ce.pmin)break}return(se-oe)/K}}}if(E.rangemode!=="match"){var ee=S.r2l(E.range[0]),ne=S.r2l(E.range[1])-ee;P.d2pOppAxis=function(se){return(se-ee)/ne*P._height}}I.call(l,f,A,P).call(s,f,A,P).call(p,f,A,P).call(u,f,A,P,E).call(i,f,A,P).call(x,f,A,P),function(se,oe,me,ce){if(oe._context.staticPlot)return;var ye=se.select("rect."+h.slideBoxClassName).node(),Se=se.select("rect."+h.grabAreaMinClassName).node(),fe=se.select("rect."+h.grabAreaMaxClassName).node();function ge(){var Te=d.event,le=Te.target,ve=Te.clientX||Te.touches[0].clientX,Me=ve-se.node().getBoundingClientRect().left,we=ce.d2p(me._rl[0]),de=ce.d2p(me._rl[1]),Ie=c.coverSlip();function De(Ve){var Fe,ze,Re,We=+(Ve.clientX||Ve.touches[0].clientX)-ve;switch(le){case ye:Re="ew-resize",Fe=we+We,ze=de+We;break;case Se:Re="col-resize",Fe=we+We,ze=de;break;case fe:Re="col-resize",Fe=we,ze=de+We;break;default:Re="ew-resize",Fe=Me,ze=Me+We}if(ze<Fe){var $e=ze;ze=Fe,Fe=$e}ce._pixelMin=Fe,ce._pixelMax=ze,a(d.select(Ie),Re),function(at,gt,xt,mt){function nt(jt){return xt.l2r(y.constrain(jt,mt._rl[0],mt._rl[1]))}var Qe=nt(mt.p2d(mt._pixelMin)),vt=nt(mt.p2d(mt._pixelMax));window.requestAnimationFrame(function(){v.call("_guiRelayout",gt,xt._name+".range",[Qe,vt])})}(0,oe,me,ce)}function Oe(){Ie.removeEventListener("mousemove",De),Ie.removeEventListener("mouseup",Oe),this.removeEventListener("touchmove",De),this.removeEventListener("touchend",Oe),y.removeElement(Ie)}this.addEventListener("touchmove",De),this.addEventListener("touchend",Oe),Ie.addEventListener("mousemove",De),Ie.addEventListener("mouseup",Oe)}se.on("mousedown",ge),se.on("touchstart",ge)}(I,f,A,P),function(se,oe,me,ce,ye,Se){var fe=h.handleWidth/2;function ge(Oe){return y.constrain(Oe,0,ce._width)}function Te(Oe){return y.constrain(Oe,0,ce._height)}function le(Oe){return y.constrain(Oe,-fe,ce._width+fe)}var ve=ge(ce.d2p(me._rl[0])),Me=ge(ce.d2p(me._rl[1]));if(se.select("rect."+h.slideBoxClassName).attr("x",ve).attr("width",Me-ve),se.select("rect."+h.maskMinClassName).attr("width",ve),se.select("rect."+h.maskMaxClassName).attr("x",Me).attr("width",ce._width-Me),Se.rangemode!=="match"){var we=ce._height-Te(ce.d2pOppAxis(ye._rl[1])),de=ce._height-Te(ce.d2pOppAxis(ye._rl[0]));se.select("rect."+h.maskMinOppAxisClassName).attr("x",ve).attr("height",we).attr("width",Me-ve),se.select("rect."+h.maskMaxOppAxisClassName).attr("x",ve).attr("y",de).attr("height",ce._height-de).attr("width",Me-ve),se.select("rect."+h.slideBoxClassName).attr("y",we).attr("height",de-we)}var Ie=Math.round(le(ve-fe))-.5,De=Math.round(le(Me-fe))+.5;se.select("g."+h.grabberMinClassName).attr("transform",e(Ie,.5)),se.select("g."+h.grabberMaxClassName).attr("transform",e(De,.5))}(I,0,A,P,S,E),A.side==="bottom"&&o.draw(f,A._id+"title",{propContainer:A,propName:A._name+".title",placeholder:_._dfltTitle.x,attributes:{x:A._offset+A._length/2,y:X+P._height+P._offsetShift+10+1.5*A.title.font.size,"text-anchor":"middle"}})}))}},{"../../lib":515,"../../lib/setcursor":536,"../../plots/cartesian":578,"../../plots/cartesian/axis_ids":570,"../../plots/plots":628,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"../titles":476,"./constants":441,"@plotly/d3":58}],444:[function(m,G,Y){var d=m("../../plots/cartesian/axis_ids"),v=m("../../lib/svg_text_utils"),w=m("./constants"),y=m("../../constants/alignment").LINE_SPACING,e=w.name;function t(n){var o=n&&n[e];return o&&o.visible}Y.isVisible=t,Y.makeData=function(n){var o=d.list({_fullLayout:n},"x",!0),r=n.margin,g=[];if(!n._has("gl2d"))for(var c=0;c<o.length;c++){var a=o[c];if(t(a)){g.push(a);var h=a[e];h._id=e+a._id,h._height=(n.height-r.b-r.t)*h.thickness,h._offsetShift=Math.floor(h.borderwidth/2)}}n._rangeSliderData=g},Y.autoMarginOpts=function(n,o){var r=n._fullLayout,g=o[e],c=o._id.charAt(0),a=0,h=0;return o.side==="bottom"&&(a=o._depth,o.title.text!==r._dfltTitle[c]&&(h=1.5*o.title.font.size+10+g._offsetShift,h+=(o.title.text.match(v.BR_TAG_ALL)||[]).length*o.title.font.size*y)),{x:0,y:o._counterDomainMin,l:0,r:0,t:0,b:g._height+a+Math.max(r.margin.b,h),pad:w.extraPad+2*g._offsetShift}}},{"../../constants/alignment":483,"../../lib/svg_text_utils":541,"../../plots/cartesian/axis_ids":570,"./constants":441}],445:[function(m,G,Y){var d=m("../../lib"),v=m("./attributes"),w=m("./oppaxis_attributes"),y=m("./helpers");G.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:d.extendFlat({},v,{yaxis:w})}}},layoutAttributes:m("./attributes"),handleDefaults:m("./defaults"),calcAutorange:m("./calc_autorange"),draw:m("./draw"),isVisible:y.isVisible,makeData:y.makeData,autoMarginOpts:y.autoMarginOpts}},{"../../lib":515,"./attributes":439,"./calc_autorange":440,"./defaults":442,"./draw":443,"./helpers":444,"./oppaxis_attributes":446}],446:[function(m,G,Y){G.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],447:[function(m,G,Y){var d=m("../annotations/attributes"),v=m("../../traces/scatter/attributes").line,w=m("../drawing/attributes").dash,y=m("../../lib/extend").extendFlat,e=m("../../plot_api/edit_types").overrideAll,t=m("../../plot_api/plot_template").templatedArray;m("../../constants/axis_placeable_objects"),G.exports=e(t("selection",{type:{valType:"enumerated",values:["rect","path"]},xref:y({},d.xref,{}),yref:y({},d.yref,{}),x0:{valType:"any"},x1:{valType:"any"},y0:{valType:"any"},y1:{valType:"any"},path:{valType:"string",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:.7,editType:"arraydraw"},line:{color:v.color,width:y({},v.width,{min:1,dflt:1}),dash:y({},w,{dflt:"dot"})}}),"arraydraw","from-root")},{"../../constants/axis_placeable_objects":484,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../annotations/attributes":350,"../drawing/attributes":388}],448:[function(m,G,Y){G.exports={BENDPX:1.5,MINSELECT:12,SELECTDELAY:100,SELECTID:"-select"}},{}],449:[function(m,G,Y){var d=m("../../lib"),v=m("../../plots/cartesian/axes"),w=m("../../plots/array_container_defaults"),y=m("./attributes"),e=m("../shapes/helpers");function t(n,o,r){function g(I,P){return d.coerce(n,o,y,I,P)}var c=g("path"),a=g("type",c?"path":"rect")!=="path";a&&delete o.path,g("opacity"),g("line.color"),g("line.width"),g("line.dash");for(var h=["x","y"],l=0;l<2;l++){var s,p,u,i=h[l],x={_fullLayout:r},f=v.coerceRef(n,o,x,i);if((s=v.getFromId(x,f))._selectionIndices.push(o._index),u=e.rangeToShapePosition(s),p=e.shapePositionToRange(s),a){var _=i+"0",b=i+"1",T=n[_],k=n[b];n[_]=p(n[_],!0),n[b]=p(n[b],!0),v.coercePosition(o,x,g,f,_),v.coercePosition(o,x,g,f,b);var L=o[_],A=o[b];L!==void 0&&A!==void 0&&(o[_]=u(L),o[b]=u(A),n[_]=T,n[b]=k)}}a&&d.noneOrAll(n,o,["x0","x1","y0","y1"])}G.exports=function(n,o){w(n,o,{name:"selections",handleItemDefaults:t});for(var r=o.selections,g=0;g<r.length;g++){var c=r[g];c&&c.path===void 0&&(c.x0!==void 0&&c.x1!==void 0&&c.y0!==void 0&&c.y1!==void 0||(o.selections[g]=null))}}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../shapes/helpers":469,"./attributes":447}],450:[function(m,G,Y){var d=m("../shapes/draw_newshape/helpers").readPaths,v=m("../shapes/display_outlines"),w=m("../shapes/handle_outline").clearOutlineControllers,y=m("../color"),e=m("../drawing"),t=m("../../plot_api/plot_template").arrayEditor,n=m("../shapes/helpers"),o=n.getPathString;function r(l){var s=l._fullLayout;for(var p in w(l),s._selectionLayer.selectAll("path").remove(),s._plots){var u=s._plots[p].selectionLayer;u&&u.selectAll("path").remove()}for(var i=0;i<s.selections.length;i++)c(l,i)}function g(l){return l._context.editSelection}function c(l,s){l._fullLayout._paperdiv.selectAll('.selectionlayer [data-index="'+s+'"]').remove();var p=n.makeSelectionsOptionsAndPlotinfo(l,s),u=p.options,i=p.plotinfo;u._input&&function(x){var f=o(l,u),_={"data-index":s,"fill-rule":"evenodd",d:f},b=u.opacity,T="rgba(0,0,0,0)",k=u.line.color||y.contrast(l._fullLayout.plot_bgcolor),L=u.line.width,A=u.line.dash;L||(L=5,A="solid");var I=g(l)&&l._fullLayout._activeSelectionIndex===s;I&&(T=l._fullLayout.activeselection.fillcolor,b=l._fullLayout.activeselection.opacity);for(var P=[],S=1;S>=0;S--){var E=x.append("path").attr(_).style("opacity",S?.1:b).call(y.stroke,k).call(y.fill,T).call(e.dashLine,S?"solid":A,S?4+L:L);if(a(E,l,u),I){var z=t(l.layout,"selections",u);E.style({cursor:"move"});var D={element:E.node(),plotinfo:i,gd:l,editHelpers:z,isActiveSelection:!0},j=d(f,l);v(j,E,D)}else E.style("pointer-events",S?"all":"none");P[S]=E}var V=P[0];P[1].node().addEventListener("click",function(){return function(Z,Q){if(!!g(Z)){var X=+Q.node().getAttribute("data-index");if(X>=0){if(X===Z._fullLayout._activeSelectionIndex)return void h(Z);Z._fullLayout._activeSelectionIndex=X,Z._fullLayout._deactivateSelection=h,r(Z)}}}(l,V)})}(l._fullLayout._selectionLayer)}function a(l,s,p){var u=p.xref+p.yref;e.setClipUrl(l,"clip"+s._fullLayout._uid+u,s)}function h(l){g(l)&&l._fullLayout._activeSelectionIndex>=0&&(w(l),delete l._fullLayout._activeSelectionIndex,r(l))}G.exports={draw:r,drawOne:c,activateLastSelection:function(l){if(!!g(l)){var s=l._fullLayout.selections.length-1;l._fullLayout._activeSelectionIndex=s,l._fullLayout._deactivateSelection=h,r(l)}}}},{"../../plot_api/plot_template":555,"../color":367,"../drawing":389,"../shapes/display_outlines":461,"../shapes/draw_newshape/helpers":466,"../shapes/handle_outline":468,"../shapes/helpers":469}],451:[function(m,G,Y){var d=m("../../drawing/attributes").dash,v=m("../../../lib/extend").extendFlat;G.exports={newselection:{mode:{valType:"enumerated",values:["immediate","gradual"],dflt:"immediate",editType:"none"},line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:1,dflt:1,editType:"none"},dash:v({},d,{dflt:"dot",editType:"none"}),editType:"none"},editType:"none"},activeselection:{fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":505,"../../drawing/attributes":388}],452:[function(m,G,Y){G.exports=function(d,v,w){w("newselection.mode"),w("newselection.line.width")&&(w("newselection.line.color"),w("newselection.line.dash")),w("activeselection.fillcolor"),w("activeselection.opacity")}},{}],453:[function(m,G,Y){var d=m("../../dragelement/helpers").selectMode,v=m("../../shapes/handle_outline").clearOutline,w=m("../../shapes/draw_newshape/helpers"),y=w.readPaths,e=w.writePaths,t=w.fixDatesForPaths;G.exports=function(n,o){if(n.length){var r=n[0][0];if(r){var g=r.getAttribute("d"),c=o.gd,a=c._fullLayout.newselection,h=o.plotinfo,l=h.xaxis,s=h.yaxis,p=o.isActiveSelection,u=o.dragmode,i=(c.layout||{}).selections||[];if(!d(u)&&p!==void 0){var x=c._fullLayout._activeSelectionIndex;if(x<i.length)switch(c._fullLayout.selections[x].type){case"rect":u="select";break;case"path":u="lasso"}}var f,_=y(g,c,h,p),b={xref:l._id,yref:s._id,opacity:a.opacity,line:{color:a.line.color,width:a.line.width,dash:a.line.dash}};_.length===1&&(f=_[0]),f&&f.length===5&&u==="select"?(b.type="rect",b.x0=f[0][1],b.y0=f[0][2],b.x1=f[2][1],b.y1=f[2][2]):(b.type="path",l&&s&&t(_,l,s),b.path=e(_),f=null),v(c);for(var T=o.editHelpers,k=(T||{}).modifyItem,L=[],A=0;A<i.length;A++){var I=c._fullLayout.selections[A];if(I){if(L[A]=I._input,p!==void 0&&A===c._fullLayout._activeSelectionIndex){var P=b;switch(I.type){case"rect":k("x0",P.x0),k("x1",P.x1),k("y0",P.y0),k("y1",P.y1);break;case"path":k("path",P.path)}}}else L[A]=I}return p===void 0?(L.push(b),L):T?T.getUpdateObj():{}}}}},{"../../dragelement/helpers":385,"../../shapes/draw_newshape/helpers":466,"../../shapes/handle_outline":468}],454:[function(m,G,Y){var d=m("../../lib").strTranslate;function v(w,y){switch(w.type){case"log":return w.p2d(y);case"date":return w.p2r(y,0,w.calendar);default:return w.p2r(y)}}G.exports={p2r:v,r2p:function(w,y){switch(w.type){case"log":return w.d2p(y);case"date":return w.r2p(y,0,w.calendar);default:return w.r2p(y)}},axValue:function(w){var y=w._id.charAt(0)==="y"?1:0;return function(e){return v(w,e[y])}},getTransform:function(w){return d(w.xaxis._offset,w.yaxis._offset)}}},{"../../lib":515}],455:[function(m,G,Y){var d=m("./draw"),v=m("./select");G.exports={moduleType:"component",name:"selections",layoutAttributes:m("./attributes"),supplyLayoutDefaults:m("./defaults"),supplyDrawNewSelectionDefaults:m("./draw_newselection/defaults"),includeBasePlot:m("../../plots/cartesian/include_components")("selections"),draw:d.draw,drawOne:d.drawOne,reselect:v.reselect,prepSelect:v.prepSelect,clearOutline:v.clearOutline,clearSelectionsCache:v.clearSelectionsCache,selectOnClick:v.selectOnClick}},{"../../plots/cartesian/include_components":577,"./attributes":447,"./defaults":449,"./draw":450,"./draw_newselection/defaults":452,"./select":456}],456:[function(m,G,Y){var d=m("polybooljs"),v=m("point-in-polygon/nested"),w=m("../../registry"),y=m("../drawing").dashStyle,e=m("../color"),t=m("../fx"),n=m("../fx/helpers").makeEventData,o=m("../dragelement/helpers"),r=o.freeMode,g=o.rectMode,c=o.drawMode,a=o.openMode,h=o.selectMode,l=m("../shapes/helpers"),s=m("../shapes/constants"),p=m("../shapes/display_outlines"),u=m("../shapes/handle_outline").clearOutline,i=m("../shapes/draw_newshape/helpers"),x=i.handleEllipse,f=i.readPaths,_=m("../shapes/draw_newshape/newshapes"),b=m("./draw_newselection/newselections"),T=m("./draw").activateLastSelection,k=m("../../lib"),L=k.sorterAsc,A=m("../../lib/polygon"),I=m("../../lib/throttle"),P=m("../../plots/cartesian/axis_ids").getFromId,S=m("../../lib/clear_gl_canvases"),E=m("../../plot_api/subroutines").redrawReglTraces,z=m("./constants"),D=z.MINSELECT,j=A.filter,V=A.tester,Z=m("./helpers"),Q=Z.p2r,X=Z.axValue,$=Z.getTransform;function re(Oe){return Oe.subplot!==void 0}function H(Oe,Ve,Fe,ze,Re,We,$e){var at,gt,xt,mt,nt,Qe,vt,jt,Gt,$t=Ve._hoverdata,Zt=Ve._fullLayout.clickmode.indexOf("event")>-1,cr=[];if(function(_e){return _e&&Array.isArray(_e)&&_e[0].hoverOnBox!==!0}($t)){B(Oe,Ve,We);var Dt=function(_e,Be){var He,Je,Ze=_e[0],ct=-1,lt=[];for(Je=0;Je<Be.length;Je++)if(He=Be[Je],Ze.fullData._expandedIndex===He.cd[0].trace._expandedIndex){if(Ze.hoverOnBox===!0)break;Ze.pointNumber!==void 0?ct=Ze.pointNumber:Ze.binNumber!==void 0&&(ct=Ze.binNumber,lt=Ze.pointNumbers);break}return{pointNumber:ct,pointNumbers:lt,searchInfo:He}}($t,at=ee(Ve,Fe,ze,Re));if(Dt.pointNumbers.length>0?function(_e,Be){var He,Je,Ze,ct=[];for(Ze=0;Ze<_e.length;Ze++)(He=_e[Ze]).cd[0].trace.selectedpoints&&He.cd[0].trace.selectedpoints.length>0&&ct.push(He);if(ct.length===1&&ct[0]===Be.searchInfo&&(Je=Be.searchInfo.cd[0].trace).selectedpoints.length===Be.pointNumbers.length){for(Ze=0;Ze<Be.pointNumbers.length;Ze++)if(Je.selectedpoints.indexOf(Be.pointNumbers[Ze])<0)return!1;return!0}return!1}(at,Dt):function(_e){var Be,He,Je,Ze=0;for(Je=0;Je<_e.length;Je++)if(Be=_e[Je],(He=Be.cd[0].trace).selectedpoints&&(He.selectedpoints.length>1||(Ze+=He.selectedpoints.length)>1))return!1;return Ze===1}(at)&&(Qe=se(Dt))){for($e&&$e.remove(),Gt=0;Gt<at.length;Gt++)(gt=at[Gt])._module.selectPoints(gt,!1);oe(Ve,at),K(We),Zt&&De(Ve)}else{for(vt=Oe.shiftKey&&(Qe!==void 0?Qe:se(Dt)),xt=function(_e,Be,He){return{pointNumber:_e,searchInfo:Be,subtract:!!He}}(Dt.pointNumber,Dt.searchInfo,vt),mt=te(We.selectionDefs.concat([xt])),Gt=0;Gt<at.length;Gt++)if(nt=ce(at[Gt]._module.selectPoints(at[Gt],mt),at[Gt]),cr.length)for(var Ne=0;Ne<nt.length;Ne++)cr.push(nt[Ne]);else cr=nt;if(oe(Ve,at,jt={points:cr}),xt&&We&&We.selectionDefs.push(xt),$e){var Ye=We.mergedPolygons,pe=a(We.dragmode);p(ye(Ye,pe),$e,We)}Zt&&Ie(Ve,jt)}}}function N(Oe){return"pointNumber"in Oe&&"searchInfo"in Oe}function U(Oe){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(Ve,Fe,ze,Re){var We=Oe.searchInfo.cd[0].trace._expandedIndex;return Re.cd[0].trace._expandedIndex===We&&ze===Oe.pointNumber},isRect:!1,degenerate:!1,subtract:!!Oe.subtract}}function te(Oe){if(Oe.length){for(var Ve=[],Fe=N(Oe[0])?0:Oe[0][0][0],ze=Fe,Re=N(Oe[0])?0:Oe[0][0][1],We=Re,$e=0;$e<Oe.length;$e++)if(N(Oe[$e]))Ve.push(U(Oe[$e]));else{var at=V(Oe[$e]);at.subtract=!!Oe[$e].subtract,Ve.push(at),Fe=Math.min(Fe,at.xmin),ze=Math.max(ze,at.xmax),Re=Math.min(Re,at.ymin),We=Math.max(We,at.ymax)}return{xmin:Fe,xmax:ze,ymin:Re,ymax:We,pts:[],contains:function(gt,xt,mt,nt){for(var Qe=!1,vt=0;vt<Ve.length;vt++)Ve[vt].contains(gt,xt,mt,nt)&&(Qe=!Ve[vt].subtract);return Qe},isRect:!1,degenerate:!1}}}function B(Oe,Ve,Fe){var ze=Ve._fullLayout,Re=Fe.plotinfo,We=Fe.dragmode,$e=ze._lastSelectedSubplot&&ze._lastSelectedSubplot===Re.id,at=(Oe.shiftKey||Oe.altKey)&&!(c(We)&&a(We));$e&&at&&Re.selection&&Re.selection.selectionDefs&&!Fe.selectionDefs?(Fe.selectionDefs=Re.selection.selectionDefs,Fe.mergedPolygons=Re.selection.mergedPolygons):at&&Re.selection||K(Fe),$e||(u(Ve),ze._lastSelectedSubplot=Re.id)}function K(Oe,Ve){var Fe=Oe.dragmode,ze=Oe.plotinfo,Re=Oe.gd;(function(nt){return nt._fullLayout._activeShapeIndex>=0})(Re)&&Re._fullLayout._deactivateShape(Re),function(nt){return nt._fullLayout._activeSelectionIndex>=0}(Re)&&Re._fullLayout._deactivateSelection(Re);var We=Re._fullLayout._zoomlayer,$e=c(Fe),at=h(Fe);if($e||at){var gt,xt,mt=We.selectAll(".select-outline-"+ze.id);mt&&Re._fullLayout._outlining&&($e&&(gt=_(mt,Oe)),gt&&w.call("_guiRelayout",Re,{shapes:gt}),at&&!re(Oe)&&(xt=b(mt,Oe)),xt&&(Re._fullLayout._noEmitSelectedAtStart=!0,w.call("_guiRelayout",Re,{selections:xt}).then(function(){Ve&&T(Re)})),Re._fullLayout._outlining=!1)}ze.selection={},ze.selection.selectionDefs=Oe.selectionDefs=[],ze.selection.mergedPolygons=Oe.mergedPolygons=[]}function J(Oe){return Oe._id}function ee(Oe,Ve,Fe,ze){if(!Oe.calcdata)return[];var Re,We,$e,at=[],gt=Ve.map(J),xt=Fe.map(J);for($e=0;$e<Oe.calcdata.length;$e++)if((We=(Re=Oe.calcdata[$e])[0].trace).visible===!0&&We._module&&We._module.selectPoints)if(!re({subplot:ze})||We.subplot!==ze&&We.geo!==ze)if(We.type==="splom"){if(We._xaxes[gt[0]]&&We._yaxes[xt[0]]){var mt=ne(We._module,Re,Ve[0],Fe[0]);mt.scene=Oe._fullLayout._splomScenes[We.uid],at.push(mt)}}else if(We.type==="sankey"){var nt=ne(We._module,Re,Ve[0],Fe[0]);at.push(nt)}else{if(gt.indexOf(We.xaxis)===-1||xt.indexOf(We.yaxis)===-1)continue;at.push(ne(We._module,Re,P(Oe,We.xaxis),P(Oe,We.yaxis)))}else at.push(ne(We._module,Re,Ve[0],Fe[0]));return at}function ne(Oe,Ve,Fe,ze){return{_module:Oe,cd:Ve,xaxis:Fe,yaxis:ze}}function se(Oe){var Ve=Oe.searchInfo.cd[0].trace,Fe=Oe.pointNumber,ze=Oe.pointNumbers,Re=ze.length>0?ze[0]:Fe;return!!Ve.selectedpoints&&Ve.selectedpoints.indexOf(Re)>-1}function oe(Oe,Ve,Fe){var ze,Re;for(ze=0;ze<Ve.length;ze++){var We=Ve[ze].cd[0].trace._fullInput,$e=Oe._fullLayout._tracePreGUI[We.uid]||{};$e.selectedpoints===void 0&&($e.selectedpoints=We._input.selectedpoints||null)}if(Fe){var at=Fe.points||[];for(ze=0;ze<Ve.length;ze++)(Re=Ve[ze].cd[0].trace)._input.selectedpoints=Re._fullInput.selectedpoints=[],Re._fullInput!==Re&&(Re.selectedpoints=[]);for(var gt=0;gt<at.length;gt++){var xt=at[gt],mt=xt.data,nt=xt.fullData,Qe=xt.pointIndex,vt=xt.pointIndices;vt?([].push.apply(mt.selectedpoints,vt),Re._fullInput!==Re&&[].push.apply(nt.selectedpoints,vt)):(mt.selectedpoints.push(Qe),Re._fullInput!==Re&&nt.selectedpoints.push(Qe))}}else for(ze=0;ze<Ve.length;ze++)delete(Re=Ve[ze].cd[0].trace).selectedpoints,delete Re._input.selectedpoints,Re._fullInput!==Re&&delete Re._fullInput.selectedpoints;(function(jt,Gt){for(var $t=!1,Zt=0;Zt<Gt.length;Zt++){var cr=Gt[Zt],Dt=cr.cd;w.traceIs(Dt[0].trace,"regl")&&($t=!0);var Ne=cr._module,Ye=Ne.styleOnSelect||Ne.style;Ye&&(Ye(jt,Dt,Dt[0].node3),Dt[0].nodeRangePlot3&&Ye(jt,Dt,Dt[0].nodeRangePlot3))}$t&&(S(jt),E(jt))})(Oe,Ve)}function me(Oe,Ve,Fe){for(var ze=(Fe?d.difference:d.union)({regions:Oe},{regions:[Ve]}).regions.reverse(),Re=0;Re<ze.length;Re++){var We=ze[Re];We.subtract=ve(We,ze.slice(0,Re))}return ze}function ce(Oe,Ve){if(Array.isArray(Oe))for(var Fe=Ve.cd,ze=Ve.cd[0].trace,Re=0;Re<Oe.length;Re++)Oe[Re]=n(Oe[Re],ze,Fe);return Oe}function ye(Oe,Ve){for(var Fe=[],ze=0;ze<Oe.length;ze++){Fe[ze]=[];for(var Re=0;Re<Oe[ze].length;Re++){Fe[ze][Re]=[],Fe[ze][Re][0]=Re?"L":"M";for(var We=0;We<Oe[ze][Re].length;We++)Fe[ze][Re].push(Oe[ze][Re][We])}Ve||Fe[ze].push(["Z",Fe[ze][0][1],Fe[ze][0][2]])}return Fe}function Se(Oe,Ve){for(var Fe,ze,Re=[],We=[],$e=0;$e<Ve.length;$e++){var at=Ve[$e];ze=at._module.selectPoints(at,Oe),We.push(ze),Fe=ce(ze,at),Re=Re.concat(Fe)}return Re}function fe(Oe,Ve,Fe,ze,Re){var We,$e,at,gt=!!ze;Re&&(We=Re.plotinfo,$e=Re.xaxes[0]._id,at=Re.yaxes[0]._id);var xt=[],mt=[],nt=le(Oe),Qe=Oe._fullLayout;if(We){var vt=Qe._zoomlayer,jt=Qe.dragmode,Gt=c(jt),$t=h(jt);if(Gt||$t){var Zt=P(Oe,$e,"x"),cr=P(Oe,at,"y");if(Zt&&cr){var Dt=vt.selectAll(".select-outline-"+We.id);if(Dt&&Oe._fullLayout._outlining&&Dt.length){for(var Ne=Dt[0][0].getAttribute("d"),Ye=f(Ne,Oe,We),pe=[],_e=0;_e<Ye.length;_e++){for(var Be=Ye[_e],He=[],Je=0;Je<Be.length;Je++)He.push([Me(Zt,Be[Je][1]),Me(cr,Be[Je][2])]);He.xref=$e,He.yref=at,He.subtract=ve(He,pe),pe.push(He)}nt=nt.concat(pe)}}}}var Ze=$e&&at?[$e+at]:Qe._subplots.cartesian;(function(Rr){var Vr=Rr.calcdata;if(!!Vr)for(var Xr=0;Xr<Vr.length;Xr++){var cn=Vr[Xr][0].trace,an=Rr._fullLayout._splomScenes;if(an){var zn=an[cn.uid];zn&&(zn.selectBatch=[])}}})(Oe);for(var ct={},lt=0;lt<Ze.length;lt++){var At=Ze[lt],Ot=At.indexOf("y"),it=At.slice(0,Ot),ht=At.slice(Ot),Ut=$e&&at?Fe:void 0;if(Ut=Te(nt,it,ht,Ut)){var Mt=ze;if(!gt){var It=P(Oe,it,"x"),Le=P(Oe,ht,"y");Mt=ee(Oe,[It],[Le],At);for(var Xe=0;Xe<Mt.length;Xe++){var ot=Mt[Xe],pt=ot.cd[0],St=pt.trace;if(ot._module.name==="scattergl"&&!pt.t.xpx){var Vt=St.x,Jt=St.y,qt=St._length;pt.t.xpx=[],pt.t.ypx=[];for(var gr=0;gr<qt;gr++)pt.t.xpx[gr]=It.c2p(Vt[gr]),pt.t.ypx[gr]=Le.c2p(Jt[gr])}ot._module.name==="splom"&&(ct[St.uid]||(ct[St.uid]=!0))}}var Cr=Se(Ut,Mt);xt=xt.concat(Cr),mt=mt.concat(Mt)}}var mr={points:xt};oe(Oe,mt,mr);var tr=Qe.clickmode.indexOf("event")>-1&&Ve;if(!We&&Ve){var nr=le(Oe,!0);if(nr.length){var Qt=nr[0].xref,dr=nr[0].yref;if(Qt&&dr){var _r=we(nr);de([P(Oe,Qt,"x"),P(Oe,dr,"y")])(mr,_r)}}Oe._fullLayout._noEmitSelectedAtStart?Oe._fullLayout._noEmitSelectedAtStart=!1:tr&&Ie(Oe,mr),Qe._reselect=!1}if(!We&&Qe._deselect){var Ir=Qe._deselect;(function(Rr,Vr,Xr){for(var cn=0;cn<Xr.length;cn++){var an=Xr[cn];if(an.xaxis&&an.xaxis._id===Rr&&an.yaxis&&an.yaxis._id===Vr)return!0}return!1})($e=Ir.xref,at=Ir.yref,mt)||ge(Oe,$e,at,ze),tr&&(mr.points.length?Ie(Oe,mr):De(Oe)),Qe._deselect=!1}return{eventData:mr,selectionTesters:Fe}}function ge(Oe,Ve,Fe,ze){ze=ee(Oe,[P(Oe,Ve,"x")],[P(Oe,Fe,"y")],Ve+Fe);for(var Re=0;Re<ze.length;Re++){var We=ze[Re];We._module.selectPoints(We,!1)}oe(Oe,ze)}function Te(Oe,Ve,Fe,ze){for(var Re,We=0;We<Oe.length;We++){var $e=Oe[We];Ve===$e.xref&&Fe===$e.yref&&(Re?ze=te(Re=me(Re,$e,!!$e.subtract)):(Re=[$e],ze=V($e)))}return ze}function le(Oe,Ve){for(var Fe=[],ze=Oe._fullLayout,Re=ze.selections,We=Re.length,$e=0;$e<We;$e++)if(!Ve||$e===ze._activeSelectionIndex){var at=Re[$e];if(at){var gt,xt,mt,nt,Qe,vt=at.xref,jt=at.yref,Gt=P(Oe,vt,"x"),$t=P(Oe,jt,"y");if(at.type==="rect"){Qe=[];var Zt=Me(Gt,at.x0),cr=Me(Gt,at.x1),Dt=Me($t,at.y0),Ne=Me($t,at.y1);Qe=[[Zt,Dt],[Zt,Ne],[cr,Ne],[cr,Dt]],gt=Math.min(Zt,cr),xt=Math.max(Zt,cr),mt=Math.min(Dt,Ne),nt=Math.max(Dt,Ne),Qe.xmin=gt,Qe.xmax=xt,Qe.ymin=mt,Qe.ymax=nt,Qe.xref=vt,Qe.yref=jt,Qe.subtract=!1,Qe.isRect=!0,Fe.push(Qe)}else if(at.type==="path")for(var Ye=at.path.split("Z"),pe=[],_e=0;_e<Ye.length;_e++){var Be=Ye[_e];if(Be){Be+="Z";var He=l.extractPathCoords(Be,s.paramIsX,"raw"),Je=l.extractPathCoords(Be,s.paramIsY,"raw");gt=1/0,xt=-1/0,mt=1/0,nt=-1/0,Qe=[];for(var Ze=0;Ze<He.length;Ze++){var ct=Me(Gt,He[Ze]),lt=Me($t,Je[Ze]);Qe.push([ct,lt]),gt=Math.min(ct,gt),xt=Math.max(ct,xt),mt=Math.min(lt,mt),nt=Math.max(lt,nt)}Qe.xmin=gt,Qe.xmax=xt,Qe.ymin=mt,Qe.ymax=nt,Qe.xref=vt,Qe.yref=jt,Qe.subtract=ve(Qe,pe),pe.push(Qe),Fe.push(Qe)}}}}return Fe}function ve(Oe,Ve){for(var Fe=!1,ze=0;ze<Ve.length;ze++)for(var Re=Ve[ze],We=0;We<Oe.length;We++)if(v(Oe[We],Re)){Fe=!Fe;break}return Fe}function Me(Oe,Ve){return Oe.type==="date"&&(Ve=Ve.replace("_"," ")),Oe.type==="log"?Oe.c2p(Ve):Oe.r2p(Ve,null,Oe.calendar)}function we(Oe){for(var Ve=Oe.length,Fe=[],ze=0;ze<Ve;ze++){var Re=Oe[ze];Fe=(Fe=Fe.concat(Re)).concat([Re[0]])}return function(We){return We.isRect=We.length===5&&We[0][0]===We[4][0]&&We[0][1]===We[4][1]&&We[0][0]===We[1][0]&&We[2][0]===We[3][0]&&We[0][1]===We[3][1]&&We[1][1]===We[2][1]||We[0][1]===We[1][1]&&We[2][1]===We[3][1]&&We[0][0]===We[3][0]&&We[1][0]===We[2][0],We.isRect&&(We.xmin=Math.min(We[0][0],We[2][0]),We.xmax=Math.max(We[0][0],We[2][0]),We.ymin=Math.min(We[0][1],We[2][1]),We.ymax=Math.max(We[0][1],We[2][1])),We}(Fe)}function de(Oe){return function(Ve,Fe){for(var ze,Re,We=0;We<Oe.length;We++){var $e=Oe[We],at=$e._id,gt=at.charAt(0);if(Fe.isRect){ze||(ze={});var xt=Fe[gt+"min"],mt=Fe[gt+"max"];xt!==void 0&&mt!==void 0&&(ze[at]=[Q($e,xt),Q($e,mt)].sort(L))}else Re||(Re={}),Re[at]=Fe.map(X($e))}ze&&(Ve.range=ze),Re&&(Ve.lassoPoints=Re)}}function Ie(Oe,Ve){Ve&&(Ve.selections=(Oe.layout||{}).selections||[]),Oe.emit("plotly_selected",Ve)}function De(Oe){Oe.emit("plotly_deselect",null)}G.exports={reselect:fe,prepSelect:function(Oe,Ve,Fe,ze,Re){var We=!re(ze),$e=r(Re),at=g(Re),gt=a(Re),xt=c(Re),mt=h(Re),nt=Re==="drawcircle",Qe=Re==="drawline"||nt,vt=ze.gd,jt=vt._fullLayout,Gt=mt&&jt.newselection.mode==="immediate"&&We,$t=jt._zoomlayer,Zt=ze.element.getBoundingClientRect(),cr=ze.plotinfo,Dt=$(cr),Ne=Ve-Zt.left,Ye=Fe-Zt.top;jt._calcInverseTransform(vt);var pe=k.apply3DTransform(jt._invTransform)(Ne,Ye);Ne=pe[0],Ye=pe[1];var _e,Be,He,Je,Ze,ct,lt,At=jt._invScaleX,Ot=jt._invScaleY,it=Ne,ht=Ye,Ut="M"+Ne+","+Ye,Mt=ze.xaxes[0],It=ze.yaxes[0],Le=Mt._length,Xe=It._length,ot=Oe.altKey&&!(c(Re)&&gt);B(Oe,vt,ze),$e&&(_e=j([[Ne,Ye]],z.BENDPX));var pt=$t.selectAll("path.select-outline-"+cr.id).data([1]),St=xt?jt.newshape:jt.newselection,Vt=xt&&!gt?St.fillcolor:"rgba(0,0,0,0)",Jt=St.line.color||(We?e.contrast(vt._fullLayout.plot_bgcolor):"#7f7f7f");pt.enter().append("path").attr("class","select-outline select-outline-"+cr.id).style({opacity:xt?St.opacity/2:1,"stroke-dasharray":y(St.line.dash,St.line.width),"stroke-width":St.line.width+"px","shape-rendering":"crispEdges"}).call(e.stroke,Jt).call(e.fill,Vt).attr("fill-rule","evenodd").classed("cursor-move",!!xt).attr("transform",Dt).attr("d",Ut+"Z");var qt=$t.append("path").attr("class","zoombox-corners").style({fill:e.background,stroke:e.defaultLine,"stroke-width":1}).attr("transform",Dt).attr("d","M0,0Z"),gr=jt._uid+z.SELECTID,Cr=[],mr=ee(vt,ze.xaxes,ze.yaxes,ze.subplot);Gt&&!Oe.shiftKey&&(ze._clearSubplotSelections=function(){if(We){var nr=Mt._id,Qt=It._id;ge(vt,nr,Qt,mr);for(var dr=(vt.layout||{}).selections||[],_r=[],Ir=!1,Rr=0;Rr<dr.length;Rr++){var Vr=jt.selections[Rr];Vr.xref!==nr||Vr.yref!==Qt?_r.push(dr[Rr]):Ir=!0}Ir&&(vt._fullLayout._noEmitSelectedAtStart=!0,w.call("_guiRelayout",vt,{selections:_r}))}});var tr=function(nr){return nr.plotinfo.fillRangeItems||de(nr.xaxes.concat(nr.yaxes))}(ze);ze.moveFn=function(nr,Qt){ze._clearSubplotSelections&&(ze._clearSubplotSelections(),ze._clearSubplotSelections=void 0),it=Math.max(0,Math.min(Le,At*nr+Ne)),ht=Math.max(0,Math.min(Xe,Ot*Qt+Ye));var dr=Math.abs(it-Ne),_r=Math.abs(ht-Ye);if(at){var Ir,Rr,Vr;if(mt){var Xr=jt.selectdirection;switch(Ir=Xr==="any"?_r<Math.min(.6*dr,D)?"h":dr<Math.min(.6*_r,D)?"v":"d":Xr){case"h":Rr=nt?Xe/2:0,Vr=Xe;break;case"v":Rr=nt?Le/2:0,Vr=Le}}if(xt)switch(jt.newshape.drawdirection){case"vertical":Ir="h",Rr=nt?Xe/2:0,Vr=Xe;break;case"horizontal":Ir="v",Rr=nt?Le/2:0,Vr=Le;break;case"ortho":dr<_r?(Ir="h",Rr=Ye,Vr=ht):(Ir="v",Rr=Ne,Vr=it);break;default:Ir="d"}Ir==="h"?((Je=Qe?x(nt,[it,Rr],[it,Vr]):[[Ne,Rr],[Ne,Vr],[it,Vr],[it,Rr]]).xmin=Qe?it:Math.min(Ne,it),Je.xmax=Qe?it:Math.max(Ne,it),Je.ymin=Math.min(Rr,Vr),Je.ymax=Math.max(Rr,Vr),qt.attr("d","M"+Je.xmin+","+(Ye-D)+"h-4v"+2*D+"h4ZM"+(Je.xmax-1)+","+(Ye-D)+"h4v"+2*D+"h-4Z")):Ir==="v"?((Je=Qe?x(nt,[Rr,ht],[Vr,ht]):[[Rr,Ye],[Rr,ht],[Vr,ht],[Vr,Ye]]).xmin=Math.min(Rr,Vr),Je.xmax=Math.max(Rr,Vr),Je.ymin=Qe?ht:Math.min(Ye,ht),Je.ymax=Qe?ht:Math.max(Ye,ht),qt.attr("d","M"+(Ne-D)+","+Je.ymin+"v-4h"+2*D+"v4ZM"+(Ne-D)+","+(Je.ymax-1)+"v4h"+2*D+"v-4Z")):Ir==="d"&&((Je=Qe?x(nt,[Ne,Ye],[it,ht]):[[Ne,Ye],[Ne,ht],[it,ht],[it,Ye]]).xmin=Math.min(Ne,it),Je.xmax=Math.max(Ne,it),Je.ymin=Math.min(Ye,ht),Je.ymax=Math.max(Ye,ht),qt.attr("d","M0,0Z"))}else $e&&(_e.addPt([it,ht]),Je=_e.filtered);if(ze.selectionDefs&&ze.selectionDefs.length?(He=me(ze.mergedPolygons,Je,ot),Je.subtract=ot,Be=te(ze.selectionDefs.concat([Je]))):(He=[Je],Be=V(Je)),p(ye(He,gt),pt,ze),mt){var cn,an=fe(vt,!1),zn=an.eventData?an.eventData.points.slice():[];an=fe(vt,!1,Be,mr,ze),Be=an.selectionTesters,lt=an.eventData,cn=_e?_e.filtered:we(He),I.throttle(gr,z.SELECTDELAY,function(){for(var on=(Cr=Se(Be,mr)).slice(),Tn=0;Tn<zn.length;Tn++){for(var Mn=zn[Tn],ei=!1,Hr=0;Hr<on.length;Hr++)if(on[Hr].curveNumber===Mn.curveNumber&&on[Hr].pointNumber===Mn.pointNumber){ei=!0;break}ei||on.push(Mn)}on.length&&(lt||(lt={}),lt.points=on),tr(lt,cn),function(ln,bn){ln.emit("plotly_selecting",bn)}(vt,lt)})}},ze.clickFn=function(nr,Qt){if(qt.remove(),vt._fullLayout._activeShapeIndex>=0)vt._fullLayout._deactivateShape(vt);else if(!xt){var dr=jt.clickmode;I.done(gr).then(function(){if(I.clear(gr),nr===2){for(pt.remove(),Ze=0;Ze<mr.length;Ze++)(ct=mr[Ze])._module.selectPoints(ct,!1);if(oe(vt,mr),K(ze),De(vt),mr.length){var _r=mr[0].xaxis,Ir=mr[0].yaxis;if(_r&&Ir){for(var Rr=[],Vr=vt._fullLayout.selections,Xr=0;Xr<Vr.length;Xr++){var cn=Vr[Xr];cn&&(cn.xref===_r._id&&cn.yref===Ir._id||Rr.push(cn))}Rr.length<Vr.length&&(vt._fullLayout._noEmitSelectedAtStart=!0,w.call("_guiRelayout",vt,{selections:Rr}))}}}else dr.indexOf("select")>-1&&H(Qt,vt,ze.xaxes,ze.yaxes,ze.subplot,ze,pt),dr==="event"&&Ie(vt,void 0);t.click(vt,Qt)}).catch(k.error)}},ze.doneFn=function(){qt.remove(),I.done(gr).then(function(){I.clear(gr),!Gt&&Je&&ze.selectionDefs&&(Je.subtract=ot,ze.selectionDefs.push(Je),ze.mergedPolygons.length=0,[].push.apply(ze.mergedPolygons,He)),(Gt||xt)&&K(ze,Gt),ze.doneFnCompleted&&ze.doneFnCompleted(Cr),mt&&Ie(vt,lt)}).catch(k.error)}},clearOutline:u,clearSelectionsCache:K,selectOnClick:H}},{"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/polygon":527,"../../lib/throttle":542,"../../plot_api/subroutines":556,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../color":367,"../dragelement/helpers":385,"../drawing":389,"../fx":407,"../fx/helpers":403,"../shapes/constants":459,"../shapes/display_outlines":461,"../shapes/draw_newshape/helpers":466,"../shapes/draw_newshape/newshapes":467,"../shapes/handle_outline":468,"../shapes/helpers":469,"./constants":448,"./draw":450,"./draw_newselection/newselections":453,"./helpers":454,"point-in-polygon/nested":254,polybooljs:255}],457:[function(m,G,Y){var d=m("../annotations/attributes"),v=m("../../traces/scatter/attributes").line,w=m("../drawing/attributes").dash,y=m("../../lib/extend").extendFlat,e=m("../../plot_api/plot_template").templatedArray;m("../../constants/axis_placeable_objects"),G.exports=e("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:y({},d.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:y({},d.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:y({},v.color,{editType:"arraydraw"}),width:y({},v.width,{editType:"calc+arraydraw"}),dash:y({},w,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":484,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../annotations/attributes":350,"../drawing/attributes":388}],458:[function(m,G,Y){var d=m("../../lib"),v=m("../../plots/cartesian/axes"),w=m("./constants"),y=m("./helpers");function e(r){return n(r.line.width,r.xsizemode,r.x0,r.x1,r.path,!1)}function t(r){return n(r.line.width,r.ysizemode,r.y0,r.y1,r.path,!0)}function n(r,g,c,a,h,l){var s=r/2,p=l;if(g==="pixel"){var u=h?y.extractPathCoords(h,l?w.paramIsY:w.paramIsX):[c,a],i=d.aggNums(Math.max,null,u),x=d.aggNums(Math.min,null,u),f=x<0?Math.abs(x)+s:s,_=i>0?i+s:s;return{ppad:s,ppadplus:p?f:_,ppadminus:p?_:f}}return{ppad:s}}function o(r,g,c,a,h){var l=r.type==="category"||r.type==="multicategory"?r.r2c:r.d2c;if(g!==void 0)return[l(g),l(c)];if(a){var s,p,u,i,x=1/0,f=-1/0,_=a.match(w.segmentRE);for(r.type==="date"&&(l=y.decodeDate(l)),s=0;s<_.length;s++)(p=h[_[s].charAt(0)].drawn)!==void 0&&(!(u=_[s].substr(1).match(w.paramRE))||u.length<p||((i=l(u[p]))<x&&(x=i),i>f&&(f=i)));return f>=x?[x,f]:void 0}}G.exports=function(r){var g=r._fullLayout,c=d.filterVisible(g.shapes);if(c.length&&r._fullData.length)for(var a=0;a<c.length;a++){var h,l,s=c[a];s._extremes={};var p=v.getRefType(s.xref),u=v.getRefType(s.yref);if(s.xref!=="paper"&&p!=="domain"){var i=s.xsizemode==="pixel"?s.xanchor:s.x0,x=s.xsizemode==="pixel"?s.xanchor:s.x1;(l=o(h=v.getFromId(r,s.xref),i,x,s.path,w.paramIsX))&&(s._extremes[h._id]=v.findExtremes(h,l,e(s)))}if(s.yref!=="paper"&&u!=="domain"){var f=s.ysizemode==="pixel"?s.yanchor:s.y0,_=s.ysizemode==="pixel"?s.yanchor:s.y1;(l=o(h=v.getFromId(r,s.yref),f,_,s.path,w.paramIsY))&&(s._extremes[h._id]=v.findExtremes(h,l,t(s)))}}}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":459,"./helpers":469}],459:[function(m,G,Y){G.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],460:[function(m,G,Y){var d=m("../../lib"),v=m("../../plots/cartesian/axes"),w=m("../../plots/array_container_defaults"),y=m("./attributes"),e=m("./helpers");function t(n,o,r){function g(E,z){return d.coerce(n,o,y,E,z)}if(g("visible")){var c=g("path"),a=g("type",c?"path":"rect")!=="path";a&&delete o.path,g("editable"),g("layer"),g("opacity"),g("fillcolor"),g("fillrule"),g("line.width")&&(g("line.color"),g("line.dash"));for(var h=g("xsizemode"),l=g("ysizemode"),s=["x","y"],p=0;p<2;p++){var u,i,x,f=s[p],_=f+"anchor",b=f==="x"?h:l,T={_fullLayout:r},k=v.coerceRef(n,o,T,f,void 0,"paper");if(v.getRefType(k)==="range"?((u=v.getFromId(T,k))._shapeIndices.push(o._index),x=e.rangeToShapePosition(u),i=e.shapePositionToRange(u)):i=x=d.identity,a){var L=f+"0",A=f+"1",I=n[L],P=n[A];n[L]=i(n[L],!0),n[A]=i(n[A],!0),b==="pixel"?(g(L,0),g(A,10)):(v.coercePosition(o,T,g,k,L,.25),v.coercePosition(o,T,g,k,A,.75)),o[L]=x(o[L]),o[A]=x(o[A]),n[L]=I,n[A]=P}if(b==="pixel"){var S=n[_];n[_]=i(n[_],!0),v.coercePosition(o,T,g,k,_,.25),o[_]=x(o[_]),n[_]=S}}a&&d.noneOrAll(n,o,["x0","x1","y0","y1"])}}G.exports=function(n,o){w(n,o,{name:"shapes",handleItemDefaults:t})}},{"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"./attributes":457,"./helpers":469}],461:[function(m,G,Y){var d=m("../../lib").strTranslate,v=m("../dragelement"),w=m("../dragelement/helpers"),y=w.drawMode,e=w.selectMode,t=m("../../registry"),n=m("../color"),o=m("./draw_newshape/constants"),r=o.i000,g=o.i090,c=o.i180,a=o.i270,h=m("./handle_outline").clearOutlineControllers,l=m("./draw_newshape/helpers"),s=l.pointsOnRectangle,p=l.pointsOnEllipse,u=l.writePaths,i=m("./draw_newshape/newshapes"),x=m("../selections/draw_newselection/newselections");function f(_,b){var T,k,L,A=_[b][1],I=_[b][2],P=_.length;return k=_[T=(b+1)%P][1],L=_[T][2],k===A&&L===I&&(k=_[T=(b+2)%P][1],L=_[T][2]),[T,k,L]}G.exports=function _(b,T,k,L){L||(L=0);var A=k.gd;function I(){_(b,T,k,L++),p(b[0])&&P({redrawing:!0})}function P(J){var ee={};k.isActiveShape!==void 0&&(k.isActiveShape=!1,ee=i(T,k)),k.isActiveSelection!==void 0&&(k.isActiveSelection=!1,ee=x(T,k),A._fullLayout._reselect=!0),Object.keys(ee).length&&t.call((J||{}).redrawing?"relayout":"_guiRelayout",A,ee)}var S,E,z,D,j,V=A._fullLayout._zoomlayer,Z=k.dragmode,Q=y(Z),X=e(Z);(Q||X)&&(A._fullLayout._outlining=!0),h(A),T.attr("d",u(b)),L||!k.isActiveShape&&!k.isActiveSelection||(j=function(J,ee){for(var ne=0;ne<ee.length;ne++){var se=ee[ne];J[ne]=[];for(var oe=0;oe<se.length;oe++){J[ne][oe]=[];for(var me=0;me<se[oe].length;me++)J[ne][oe][me]=se[oe][me]}}return J}([],b),function(J){S=[];for(var ee=0;ee<b.length;ee++){var ne=b[ee],se=s(ne),oe=!se&&p(ne);S[ee]=[];for(var me=ne.length,ce=0;ce<me;ce++)if(ne[ce][0]!=="Z"&&(!oe||ce===r||ce===g||ce===c||ce===a)){var ye,Se=se&&k.isActiveSelection;Se&&(ye=f(ne,ce));var fe=ne[ce][1],ge=ne[ce][2],Te=J.append(Se?"rect":"circle").attr("data-i",ee).attr("data-j",ce).style({fill:n.background,stroke:n.defaultLine,"stroke-width":1,"shape-rendering":"crispEdges"});if(Se){var le=ye[1]-fe,ve=ye[2]-ge,Me=ve?5:Math.max(Math.min(25,Math.abs(le)-5),5),we=le?5:Math.max(Math.min(25,Math.abs(ve)-5),5);Te.classed(ve?"cursor-ew-resize":"cursor-ns-resize",!0).attr("width",Me).attr("height",we).attr("x",fe-Me/2).attr("y",ge-we/2).attr("transform",d(le/2,ve/2))}else Te.classed("cursor-grab",!0).attr("r",5).attr("cx",fe).attr("cy",ge);S[ee][ce]={element:Te.node(),gd:A,prepFn:$,doneFn:H,clickFn:N},v.init(S[ee][ce])}}}(V.append("g").attr("class","outline-controllers")),function(){E=[],b.length&&(E[0]={element:T[0][0],gd:A,prepFn:te,doneFn:B,clickFn:K},v.init(E[0]))}());function $(J){z=+J.srcElement.getAttribute("data-i"),D=+J.srcElement.getAttribute("data-j"),S[z][D].moveFn=re}function re(J,ee){if(b.length){var ne=j[z][D][1],se=j[z][D][2],oe=b[z],me=oe.length;if(s(oe)){var ce=J,ye=ee;k.isActiveSelection&&(f(oe,D)[1]===oe[D][1]?ye=0:ce=0);for(var Se=0;Se<me;Se++)if(Se!==D){var fe=oe[Se];fe[1]===oe[D][1]&&(fe[1]=ne+ce),fe[2]===oe[D][2]&&(fe[2]=se+ye)}if(oe[D][1]=ne+ce,oe[D][2]=se+ye,!s(oe))for(var ge=0;ge<me;ge++)for(var Te=0;Te<oe[ge].length;Te++)oe[ge][Te]=j[z][ge][Te]}else oe[D][1]=ne+J,oe[D][2]=se+ee;I()}}function H(){P()}function N(J,ee){if(J===2){z=+ee.srcElement.getAttribute("data-i"),D=+ee.srcElement.getAttribute("data-j");var ne=b[z];s(ne)||p(ne)||function(){if(b.length&&b[z]&&b[z].length){for(var se=[],oe=0;oe<b[z].length;oe++)oe!==D&&se.push(b[z][oe]);se.length>1&&(se.length!==2||se[1][0]!=="Z")&&(D===0&&(se[0][0]="M"),b[z]=se,I(),P())}}()}}function U(J,ee){(function(ne,se){if(b.length)for(var oe=0;oe<b.length;oe++)for(var me=0;me<b[oe].length;me++)for(var ce=0;ce+2<b[oe][me].length;ce+=2)b[oe][me][ce+1]=j[oe][me][ce+1]+ne,b[oe][me][ce+2]=j[oe][me][ce+2]+se})(J,ee),I()}function te(J){(z=+J.srcElement.getAttribute("data-i"))||(z=0),E[z].moveFn=U}function B(){P()}function K(J){J===2&&function(ee){if(!!e(ee._fullLayout.dragmode)){h(ee);var ne=ee._fullLayout._activeSelectionIndex,se=(ee.layout||{}).selections||[];if(ne<se.length){for(var oe=[],me=0;me<se.length;me++)me!==ne&&oe.push(se[me]);delete ee._fullLayout._activeSelectionIndex;var ce=ee._fullLayout.selections[ne];ee._fullLayout._deselect={xref:ce.xref,yref:ce.yref},t.call("_guiRelayout",ee,{selections:oe})}}}(A)}}},{"../../lib":515,"../../registry":647,"../color":367,"../dragelement":386,"../dragelement/helpers":385,"../selections/draw_newselection/newselections":453,"./draw_newshape/constants":464,"./draw_newshape/helpers":466,"./draw_newshape/newshapes":467,"./handle_outline":468}],462:[function(m,G,Y){var d=m("../../registry"),v=m("../../lib"),w=m("../../plots/cartesian/axes"),y=m("./draw_newshape/helpers").readPaths,e=m("./display_outlines"),t=m("./handle_outline").clearOutlineControllers,n=m("../color"),o=m("../drawing"),r=m("../../plot_api/plot_template").arrayEditor,g=m("../dragelement"),c=m("../../lib/setcursor"),a=m("./constants"),h=m("./helpers"),l=h.getPathString;function s(b){var T=b._fullLayout;for(var k in T._shapeUpperLayer.selectAll("path").remove(),T._shapeLowerLayer.selectAll("path").remove(),T._plots){var L=T._plots[k].shapelayer;L&&L.selectAll("path").remove()}for(var A=0;A<T.shapes.length;A++)T.shapes[A].visible&&i(b,A)}function p(b){return!!b._fullLayout._outlining}function u(b){return!b._context.edits.shapePosition}function i(b,T){b._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+T+'"]').remove();var k=h.makeShapesOptionsAndPlotinfo(b,T),L=k.options,A=k.plotinfo;L._input&&L.visible!==!1&&(L.layer!=="below"?I(b._fullLayout._shapeUpperLayer):L.xref==="paper"||L.yref==="paper"?I(b._fullLayout._shapeLowerLayer):A._hadPlotinfo?I((A.mainplotinfo||A).shapelayer):I(b._fullLayout._shapeLowerLayer));function I(P){var S=l(b,L),E={"data-index":T,"fill-rule":L.fillrule,d:S},z=L.opacity,D=L.fillcolor,j=L.line.width?L.line.color:"rgba(0,0,0,0)",V=L.line.width,Z=L.line.dash;V||L.editable!==!0||(V=5,Z="solid");var Q=S[S.length-1]!=="Z",X=u(b)&&L.editable&&b._fullLayout._activeShapeIndex===T;X&&(D=Q?"rgba(0,0,0,0)":b._fullLayout.activeshape.fillcolor,z=b._fullLayout.activeshape.opacity);var $,re=P.append("path").attr(E).style("opacity",z).call(n.stroke,j).call(n.fill,D).call(o.dashLine,Z,V);if(x(re,b,L),(X||b._context.edits.shapePosition)&&($=r(b.layout,"shapes",L)),X){re.style({cursor:"move"});var H={element:re.node(),plotinfo:A,gd:b,editHelpers:$,isActiveShape:!0},N=y(S,b);e(N,re,H)}else b._context.edits.shapePosition?function(U,te,B,K,J,ee){var ne,se,oe,me,ce,ye,Se,fe,ge,Te,le,ve,Me,we,de,Ie,De=B.xsizemode==="pixel",Oe=B.ysizemode==="pixel",Ve=B.type==="line",Fe=B.type==="path",ze=ee.modifyItem,Re=w.getFromId(U,B.xref),We=w.getRefType(B.xref),$e=w.getFromId(U,B.yref),at=w.getRefType(B.yref),gt=h.getDataToPixel(U,Re,!1,We),xt=h.getDataToPixel(U,$e,!0,at),mt=h.getPixelToData(U,Re,!1,We),nt=h.getPixelToData(U,$e,!0,at),Qe=Ve?function(){var Dt=Math.max(B.line.width,10),Ne=J.append("g").attr("data-index",K);Ne.append("path").attr("d",te.attr("d")).style({cursor:"move","stroke-width":Dt,"stroke-opacity":"0"});var Ye={"fill-opacity":"0"},pe=Math.max(Dt/2,10);return Ne.append("circle").attr({"data-line-point":"start-point",cx:De?gt(B.xanchor)+B.x0:gt(B.x0),cy:Oe?xt(B.yanchor)-B.y0:xt(B.y0),r:pe}).style(Ye).classed("cursor-grab",!0),Ne.append("circle").attr({"data-line-point":"end-point",cx:De?gt(B.xanchor)+B.x1:gt(B.x1),cy:Oe?xt(B.yanchor)-B.y1:xt(B.y1),r:pe}).style(Ye).classed("cursor-grab",!0),Ne}():te,vt={element:Qe.node(),gd:U,prepFn:function(Dt){p(U)||(De&&(ce=gt(B.xanchor)),Oe&&(ye=xt(B.yanchor)),B.type==="path"?de=B.path:(ne=De?B.x0:gt(B.x0),se=Oe?B.y0:xt(B.y0),oe=De?B.x1:gt(B.x1),me=Oe?B.y1:xt(B.y1)),ne<oe?(ge=ne,Me="x0",Te=oe,we="x1"):(ge=oe,Me="x1",Te=ne,we="x0"),!Oe&&se<me||Oe&&se>me?(Se=se,le="y0",fe=me,ve="y1"):(Se=me,le="y1",fe=se,ve="y0"),jt(Dt),Zt(J,B),function(Ne,Ye,pe){var _e=Ye.xref,Be=Ye.yref,He=w.getFromId(pe,_e),Je=w.getFromId(pe,Be),Ze="";_e==="paper"||He.autorange||(Ze+=_e),Be==="paper"||Je.autorange||(Ze+=Be),o.setClipUrl(Ne,Ze?"clip"+pe._fullLayout._uid+Ze:null,pe)}(te,B,U),vt.moveFn=Ie==="move"?Gt:$t,vt.altKey=Dt.altKey)},doneFn:function(){p(U)||(c(te),cr(J),x(te,U,B),d.call("_guiRelayout",U,ee.getUpdateObj()))},clickFn:function(){p(U)||cr(J)}};function jt(Dt){if(p(U))Ie=null;else if(Ve)Ie=Dt.target.tagName==="path"?"move":Dt.target.attributes["data-line-point"].value==="start-point"?"resize-over-start-point":"resize-over-end-point";else{var Ne=vt.element.getBoundingClientRect(),Ye=Ne.right-Ne.left,pe=Ne.bottom-Ne.top,_e=Dt.clientX-Ne.left,Be=Dt.clientY-Ne.top,He=!Fe&&Ye>10&&pe>10&&!Dt.shiftKey?g.getCursor(_e/Ye,1-Be/pe):"move";c(te,He),Ie=He.split("-")[0]}}function Gt(Dt,Ne){if(B.type==="path"){var Ye=function(Be){return Be},pe=Ye,_e=Ye;De?ze("xanchor",B.xanchor=mt(ce+Dt)):(pe=function(Be){return mt(gt(Be)+Dt)},Re&&Re.type==="date"&&(pe=h.encodeDate(pe))),Oe?ze("yanchor",B.yanchor=nt(ye+Ne)):(_e=function(Be){return nt(xt(Be)+Ne)},$e&&$e.type==="date"&&(_e=h.encodeDate(_e))),ze("path",B.path=f(de,pe,_e))}else De?ze("xanchor",B.xanchor=mt(ce+Dt)):(ze("x0",B.x0=mt(ne+Dt)),ze("x1",B.x1=mt(oe+Dt))),Oe?ze("yanchor",B.yanchor=nt(ye+Ne)):(ze("y0",B.y0=nt(se+Ne)),ze("y1",B.y1=nt(me+Ne)));te.attr("d",l(U,B)),Zt(J,B)}function $t(Dt,Ne){if(Fe){var Ye=function(Le){return Le},pe=Ye,_e=Ye;De?ze("xanchor",B.xanchor=mt(ce+Dt)):(pe=function(Le){return mt(gt(Le)+Dt)},Re&&Re.type==="date"&&(pe=h.encodeDate(pe))),Oe?ze("yanchor",B.yanchor=nt(ye+Ne)):(_e=function(Le){return nt(xt(Le)+Ne)},$e&&$e.type==="date"&&(_e=h.encodeDate(_e))),ze("path",B.path=f(de,pe,_e))}else if(Ve){if(Ie==="resize-over-start-point"){var Be=ne+Dt,He=Oe?se-Ne:se+Ne;ze("x0",B.x0=De?Be:mt(Be)),ze("y0",B.y0=Oe?He:nt(He))}else if(Ie==="resize-over-end-point"){var Je=oe+Dt,Ze=Oe?me-Ne:me+Ne;ze("x1",B.x1=De?Je:mt(Je)),ze("y1",B.y1=Oe?Ze:nt(Ze))}}else{var ct=function(Le){return Ie.indexOf(Le)!==-1},lt=ct("n"),At=ct("s"),Ot=ct("w"),it=ct("e"),ht=lt?Se+Ne:Se,Ut=At?fe+Ne:fe,Mt=Ot?ge+Dt:ge,It=it?Te+Dt:Te;Oe&&(lt&&(ht=Se-Ne),At&&(Ut=fe-Ne)),(!Oe&&Ut-ht>10||Oe&&ht-Ut>10)&&(ze(le,B[le]=Oe?ht:nt(ht)),ze(ve,B[ve]=Oe?Ut:nt(Ut))),It-Mt>10&&(ze(Me,B[Me]=De?Mt:mt(Mt)),ze(we,B[we]=De?It:mt(It)))}te.attr("d",l(U,B)),Zt(J,B)}function Zt(Dt,Ne){(De||Oe)&&function(){var Ye=Ne.type!=="path",pe=Dt.selectAll(".visual-cue").data([0]);pe.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":1}).classed("visual-cue",!0);var _e=gt(De?Ne.xanchor:v.midRange(Ye?[Ne.x0,Ne.x1]:h.extractPathCoords(Ne.path,a.paramIsX))),Be=xt(Oe?Ne.yanchor:v.midRange(Ye?[Ne.y0,Ne.y1]:h.extractPathCoords(Ne.path,a.paramIsY)));if(_e=h.roundPositionForSharpStrokeRendering(_e,1),Be=h.roundPositionForSharpStrokeRendering(Be,1),De&&Oe){var He="M"+(_e-1-1)+","+(Be-1-1)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";pe.attr("d",He)}else if(De){var Je="M"+(_e-1-1)+","+(Be-9-1)+"v18 h2 v-18 Z";pe.attr("d",Je)}else{var Ze="M"+(_e-9-1)+","+(Be-1-1)+"h18 v2 h-18 Z";pe.attr("d",Ze)}}()}function cr(Dt){Dt.selectAll(".visual-cue").remove()}g.init(vt),Qe.node().onmousemove=jt}(b,re,L,T,P,$):L.editable===!0&&re.style("pointer-events",Q||n.opacity(D)*z<=.5?"stroke":"all");re.node().addEventListener("click",function(){return function(U,te){if(!!u(U)){var B=+te.node().getAttribute("data-index");if(B>=0){if(B===U._fullLayout._activeShapeIndex)return void _(U);U._fullLayout._activeShapeIndex=B,U._fullLayout._deactivateShape=_,s(U)}}}(b,re)})}}function x(b,T,k){var L=(k.xref+k.yref).replace(/paper/g,"").replace(/[xyz][1-9]* *domain/g,"");o.setClipUrl(b,L?"clip"+T._fullLayout._uid+L:null,T)}function f(b,T,k){return b.replace(a.segmentRE,function(L){var A=0,I=L.charAt(0),P=a.paramIsX[I],S=a.paramIsY[I],E=a.numParams[I];return I+L.substr(1).replace(a.paramRE,function(z){return A>=E||(P[A]?z=T(z):S[A]&&(z=k(z)),A++),z})})}function _(b){u(b)&&b._fullLayout._activeShapeIndex>=0&&(t(b),delete b._fullLayout._activeShapeIndex,s(b))}G.exports={draw:s,drawOne:i,eraseActiveShape:function(b){if(!!u(b)){t(b);var T=b._fullLayout._activeShapeIndex,k=(b.layout||{}).shapes||[];if(T<k.length){for(var L=[],A=0;A<k.length;A++)A!==T&&L.push(k[A]);delete b._fullLayout._activeShapeIndex,d.call("_guiRelayout",b,{shapes:L})}}}}},{"../../lib":515,"../../lib/setcursor":536,"../../plot_api/plot_template":555,"../../plots/cartesian/axes":566,"../../registry":647,"../color":367,"../dragelement":386,"../drawing":389,"./constants":459,"./display_outlines":461,"./draw_newshape/helpers":466,"./handle_outline":468,"./helpers":469}],463:[function(m,G,Y){var d=m("../../drawing/attributes").dash,v=m("../../../lib/extend").extendFlat;G.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:v({},d,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":505,"../../drawing/attributes":388}],464:[function(m,G,Y){G.exports={CIRCLE_SIDES:32,i000:0,i090:8,i180:16,i270:24,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}},{}],465:[function(m,G,Y){var d=m("../../color");G.exports=function(v,w,y){if(y("newshape.drawdirection"),y("newshape.layer"),y("newshape.fillcolor"),y("newshape.fillrule"),y("newshape.opacity"),y("newshape.line.width")){var e=(v||{}).plot_bgcolor||"#FFF";y("newshape.line.color",d.contrast(e)),y("newshape.line.dash")}y("activeshape.fillcolor"),y("activeshape.opacity")}},{"../../color":367}],466:[function(m,G,Y){var d=m("parse-svg-path"),v=m("./constants"),w=v.CIRCLE_SIDES,y=v.SQRT2,e=m("../../selections/helpers"),t=e.p2r,n=e.r2p,o=[0,3,4,5,6,1,2],r=[0,3,4,1,2];function g(a,h){return Math.abs(a-h)<=1e-6}function c(a,h){var l=h[1]-a[1],s=h[2]-a[2];return Math.sqrt(l*l+s*s)}Y.writePaths=function(a){var h=a.length;if(!h)return"M0,0Z";for(var l="",s=0;s<h;s++)for(var p=a[s].length,u=0;u<p;u++){var i=a[s][u][0];if(i==="Z")l+="Z";else for(var x=a[s][u].length,f=0;f<x;f++){var _=f;i==="Q"||i==="S"?_=r[f]:i==="C"&&(_=o[f]),l+=a[s][u][_],f>0&&f<x-1&&(l+=",")}}return l},Y.readPaths=function(a,h,l,s){var p,u,i,x=d(a),f=[],_=-1,b=0,T=0,k=function(){u=b,i=T};k();for(var L=0;L<x.length;L++){var A,I,P,S,E=[],z=x[L][0],D=z;switch(z){case"M":_++,f[_]=[],b=+x[L][1],T=+x[L][2],E.push([D,b,T]),k();break;case"Q":case"S":A=+x[L][1],P=+x[L][2],b=+x[L][3],T=+x[L][4],E.push([D,b,T,A,P]);break;case"C":A=+x[L][1],P=+x[L][2],I=+x[L][3],S=+x[L][4],b=+x[L][5],T=+x[L][6],E.push([D,b,T,A,P,I,S]);break;case"T":case"L":b=+x[L][1],T=+x[L][2],E.push([D,b,T]);break;case"H":D="L",b=+x[L][1],E.push([D,b,T]);break;case"V":D="L",T=+x[L][1],E.push([D,b,T]);break;case"A":D="L";var j=+x[L][1],V=+x[L][2];+x[L][4]||(j=-j,V=-V);var Z=b-j,Q=T;for(p=1;p<=w/2;p++){var X=2*Math.PI*p/w;E.push([D,Z+j*Math.cos(X),Q+V*Math.sin(X)])}break;case"Z":b===u&&T===i||(b=u,T=i,E.push([D,b,T]))}for(var $=(l||{}).domain,re=h._fullLayout._size,H=l&&l.xsizemode==="pixel",N=l&&l.ysizemode==="pixel",U=s===!1,te=0;te<E.length;te++){for(p=0;p+2<7;p+=2){var B=E[te][p+1],K=E[te][p+2];B!==void 0&&K!==void 0&&(b=B,T=K,l&&(l.xaxis&&l.xaxis.p2r?(U&&(B-=l.xaxis._offset),B=H?n(l.xaxis,l.xanchor)+B:t(l.xaxis,B)):(U&&(B-=re.l),$?B=$.x[0]+B/re.w:B/=re.w),l.yaxis&&l.yaxis.p2r?(U&&(K-=l.yaxis._offset),K=N?n(l.yaxis,l.yanchor)-K:t(l.yaxis,K)):(U&&(K-=re.t),K=$?$.y[1]-K/re.h:1-K/re.h)),E[te][p+1]=B,E[te][p+2]=K)}f[_].push(E[te].slice())}}return f},Y.pointsOnRectangle=function(a){if(a.length!==5)return!1;for(var h=1;h<3;h++)if(!g(a[0][h]-a[1][h],a[3][h]-a[2][h])||!g(a[0][h]-a[3][h],a[1][h]-a[2][h]))return!1;return!(!g(a[0][1],a[1][1])&&!g(a[0][1],a[3][1]))&&!!(c(a[0],a[1])*c(a[0],a[3]))},Y.pointsOnEllipse=function(a){var h=a.length;if(h!==w+1)return!1;h=w;for(var l=0;l<h;l++){var s=(2*h-l)%h,p=(h/2+s)%h,u=(h/2+l)%h;if(!g(c(a[l],a[u]),c(a[s],a[p])))return!1}return!0},Y.handleEllipse=function(a,h,l){if(!a)return[h,l];var s=Y.ellipseOver({x0:h[0],y0:h[1],x1:l[0],y1:l[1]}),p=(s.x1+s.x0)/2,u=(s.y1+s.y0)/2,i=(s.x1-s.x0)/2,x=(s.y1-s.y0)/2;i||(i=x/=y),x||(x=i/=y);for(var f=[],_=0;_<w;_++){var b=2*_*Math.PI/w;f.push([p+i*Math.cos(b),u+x*Math.sin(b)])}return f},Y.ellipseOver=function(a){var h=a.x0,l=a.y0,s=a.x1,p=a.y1,u=s-h,i=p-l,x=((h-=u)+s)/2,f=((l-=i)+p)/2;return{x0:x-(u*=y),y0:f-(i*=y),x1:x+u,y1:f+i}},Y.fixDatesForPaths=function(a,h,l){var s=h.type==="date",p=l.type==="date";if(!s&&!p)return a;for(var u=0;u<a.length;u++)for(var i=0;i<a[u].length;i++)for(var x=0;x+2<a[u][i].length;x+=2)s&&(a[u][i][x+1]=a[u][i][x+1].replace(" ","_")),p&&(a[u][i][x+2]=a[u][i][x+2].replace(" ","_"));return a}},{"../../selections/helpers":454,"./constants":464,"parse-svg-path":250}],467:[function(m,G,Y){var d=m("../../dragelement/helpers"),v=d.drawMode,w=d.openMode,y=m("./constants"),e=y.i000,t=y.i090,n=y.i180,o=y.i270,r=y.cos45,g=y.sin45,c=m("../../selections/helpers"),a=c.p2r,h=c.r2p,l=m(".././handle_outline").clearOutline,s=m("./helpers"),p=s.readPaths,u=s.writePaths,i=s.ellipseOver,x=s.fixDatesForPaths;G.exports=function(f,_){if(f.length){var b=f[0][0];if(b){var T=b.getAttribute("d"),k=_.gd,L=k._fullLayout.newshape,A=_.plotinfo,I=A.xaxis,P=A.yaxis,S=!!A.domain||!A.xaxis,E=!!A.domain||!A.yaxis,z=_.isActiveShape,D=_.dragmode,j=(k.layout||{}).shapes||[];if(!v(D)&&z!==void 0){var V=k._fullLayout._activeShapeIndex;if(V<j.length)switch(k._fullLayout.shapes[V].type){case"rect":D="drawrect";break;case"circle":D="drawcircle";break;case"line":D="drawline";break;case"path":var Z=j[V].path||"";D=Z[Z.length-1]==="Z"?"drawclosedpath":"drawopenpath"}}var Q,X=w(D),$=p(T,k,A,z),re={editable:!0,xref:S?"paper":I._id,yref:E?"paper":P._id,layer:L.layer,opacity:L.opacity,line:{color:L.line.color,width:L.line.width,dash:L.line.dash}};if(X||(re.fillcolor=L.fillcolor,re.fillrule=L.fillrule),$.length===1&&(Q=$[0]),Q&&Q.length===5&&D==="drawrect")re.type="rect",re.x0=Q[0][1],re.y0=Q[0][2],re.x1=Q[2][1],re.y1=Q[2][2];else if(Q&&D==="drawline")re.type="line",re.x0=Q[0][1],re.y0=Q[0][2],re.x1=Q[1][1],re.y1=Q[1][2];else if(Q&&D==="drawcircle"){re.type="circle";var H=Q[e][1],N=Q[t][1],U=Q[n][1],te=Q[o][1],B=Q[e][2],K=Q[t][2],J=Q[n][2],ee=Q[o][2],ne=A.xaxis&&(A.xaxis.type==="date"||A.xaxis.type==="log"),se=A.yaxis&&(A.yaxis.type==="date"||A.yaxis.type==="log");ne&&(H=h(A.xaxis,H),N=h(A.xaxis,N),U=h(A.xaxis,U),te=h(A.xaxis,te)),se&&(B=h(A.yaxis,B),K=h(A.yaxis,K),J=h(A.yaxis,J),ee=h(A.yaxis,ee));var oe=(N+te)/2,me=(B+J)/2,ce=i({x0:oe,y0:me,x1:oe+(te-N+U-H)/2*r,y1:me+(ee-K+J-B)/2*g});ne&&(ce.x0=a(A.xaxis,ce.x0),ce.x1=a(A.xaxis,ce.x1)),se&&(ce.y0=a(A.yaxis,ce.y0),ce.y1=a(A.yaxis,ce.y1)),re.x0=ce.x0,re.y0=ce.y0,re.x1=ce.x1,re.y1=ce.y1}else re.type="path",I&&P&&x($,I,P),re.path=u($),Q=null;l(k);for(var ye=_.editHelpers,Se=(ye||{}).modifyItem,fe=[],ge=0;ge<j.length;ge++){var Te=k._fullLayout.shapes[ge];if(fe[ge]=Te._input,z!==void 0&&ge===k._fullLayout._activeShapeIndex){var le=re;switch(Te.type){case"line":case"rect":case"circle":Se("x0",le.x0),Se("x1",le.x1),Se("y0",le.y0),Se("y1",le.y1);break;case"path":Se("path",le.path)}}}return z===void 0?(fe.push(re),fe):ye?ye.getUpdateObj():{}}}}},{"../../dragelement/helpers":385,"../../selections/helpers":454,".././handle_outline":468,"./constants":464,"./helpers":466}],468:[function(m,G,Y){G.exports={clearOutlineControllers:function(d){var v=d._fullLayout._zoomlayer;v&&v.selectAll(".outline-controllers").remove()},clearOutline:function(d){var v=d._fullLayout._zoomlayer;v&&v.selectAll(".select-outline").remove(),d._fullLayout._outlining=!1}}},{}],469:[function(m,G,Y){var d=m("./constants"),v=m("../../lib"),w=m("../../plots/cartesian/axes");Y.rangeToShapePosition=function(y){return y.type==="log"?y.r2d:function(e){return e}},Y.shapePositionToRange=function(y){return y.type==="log"?y.d2r:function(e){return e}},Y.decodeDate=function(y){return function(e){return e.replace&&(e=e.replace("_"," ")),y(e)}},Y.encodeDate=function(y){return function(e){return y(e).replace(" ","_")}},Y.extractPathCoords=function(y,e,t){var n=[];return y.match(d.segmentRE).forEach(function(o){var r=e[o.charAt(0)].drawn;if(r!==void 0){var g=o.substr(1).match(d.paramRE);if(g&&!(g.length<r)){var c=g[r],a=t?c:v.cleanNumber(c);n.push(a)}}}),n},Y.getDataToPixel=function(y,e,t,n){var o,r=y._fullLayout._size;if(e)if(n==="domain")o=function(c){return e._length*(t?1-c:c)+e._offset};else{var g=Y.shapePositionToRange(e);o=function(c){return e._offset+e.r2p(g(c,!0))},e.type==="date"&&(o=Y.decodeDate(o))}else o=t?function(c){return r.t+r.h*(1-c)}:function(c){return r.l+r.w*c};return o},Y.getPixelToData=function(y,e,t,n){var o,r=y._fullLayout._size;if(e)if(n==="domain")o=function(c){var a=(c-e._offset)/e._length;return t?1-a:a};else{var g=Y.rangeToShapePosition(e);o=function(c){return g(e.p2r(c-e._offset))}}else o=t?function(c){return 1-(c-r.t)/r.h}:function(c){return(c-r.l)/r.w};return o},Y.roundPositionForSharpStrokeRendering=function(y,e){var t=Math.round(e%2)===1,n=Math.round(y);return t?n+.5:n},Y.makeShapesOptionsAndPlotinfo=function(y,e){var t=y._fullLayout.shapes[e]||{},n=y._fullLayout._plots[t.xref+t.yref];return n?n._hadPlotinfo=!0:(n={},t.xref&&t.xref!=="paper"&&(n.xaxis=y._fullLayout[t.xref+"axis"]),t.yref&&t.yref!=="paper"&&(n.yaxis=y._fullLayout[t.yref+"axis"])),n.xsizemode=t.xsizemode,n.ysizemode=t.ysizemode,n.xanchor=t.xanchor,n.yanchor=t.yanchor,{options:t,plotinfo:n}},Y.makeSelectionsOptionsAndPlotinfo=function(y,e){var t=y._fullLayout.selections[e]||{},n=y._fullLayout._plots[t.xref+t.yref];return n?n._hadPlotinfo=!0:(n={},t.xref&&(n.xaxis=y._fullLayout[t.xref+"axis"]),t.yref&&(n.yaxis=y._fullLayout[t.yref+"axis"])),{options:t,plotinfo:n}},Y.getPathString=function(y,e){var t,n,o,r,g,c,a,h,l=e.type,s=w.getRefType(e.xref),p=w.getRefType(e.yref),u=w.getFromId(y,e.xref),i=w.getFromId(y,e.yref),x=y._fullLayout._size;if(u?s==="domain"?n=function(P){return u._offset+u._length*P}:(t=Y.shapePositionToRange(u),n=function(P){return u._offset+u.r2p(t(P,!0))}):n=function(P){return x.l+x.w*P},i?p==="domain"?r=function(P){return i._offset+i._length*(1-P)}:(o=Y.shapePositionToRange(i),r=function(P){return i._offset+i.r2p(o(P,!0))}):r=function(P){return x.t+x.h*(1-P)},l==="path")return u&&u.type==="date"&&(n=Y.decodeDate(n)),i&&i.type==="date"&&(r=Y.decodeDate(r)),function(P,S,E){var z=P.path,D=P.xsizemode,j=P.ysizemode,V=P.xanchor,Z=P.yanchor;return z.replace(d.segmentRE,function(Q){var X=0,$=Q.charAt(0),re=d.paramIsX[$],H=d.paramIsY[$],N=d.numParams[$],U=Q.substr(1).replace(d.paramRE,function(te){return re[X]?te=D==="pixel"?S(V)+Number(te):S(te):H[X]&&(te=j==="pixel"?E(Z)-Number(te):E(te)),++X>N&&(te="X"),te});return X>N&&(U=U.replace(/[\s,]*X.*/,""),v.log("Ignoring extra params in segment "+Q)),$+U})}(e,n,r);if(e.xsizemode==="pixel"){var f=n(e.xanchor);g=f+e.x0,c=f+e.x1}else g=n(e.x0),c=n(e.x1);if(e.ysizemode==="pixel"){var _=r(e.yanchor);a=_-e.y0,h=_-e.y1}else a=r(e.y0),h=r(e.y1);if(l==="line")return"M"+g+","+a+"L"+c+","+h;if(l==="rect")return"M"+g+","+a+"H"+c+"V"+h+"H"+g+"Z";var b=(g+c)/2,T=(a+h)/2,k=Math.abs(b-g),L=Math.abs(T-a),A="A"+k+","+L,I=b+k+","+T;return"M"+I+A+" 0 1,1 "+(b+","+(T-L))+A+" 0 0,1 "+I+"Z"}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":459}],470:[function(m,G,Y){var d=m("./draw");G.exports={moduleType:"component",name:"shapes",layoutAttributes:m("./attributes"),supplyLayoutDefaults:m("./defaults"),supplyDrawNewShapeDefaults:m("./draw_newshape/defaults"),includeBasePlot:m("../../plots/cartesian/include_components")("shapes"),calcAutorange:m("./calc_autorange"),draw:d.draw,drawOne:d.drawOne}},{"../../plots/cartesian/include_components":577,"./attributes":457,"./calc_autorange":458,"./defaults":460,"./draw":462,"./draw_newshape/defaults":465}],471:[function(m,G,Y){var d=m("../../plots/font_attributes"),v=m("../../plots/pad_attributes"),w=m("../../lib/extend").extendDeepAll,y=m("../../plot_api/edit_types").overrideAll,e=m("../../plots/animation_attributes"),t=m("../../plot_api/plot_template").templatedArray,n=m("./constants"),o=t("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});G.exports=y(t("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:o,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:w(v({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:e.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:d({})},font:d({}),activebgcolor:{valType:"color",dflt:n.gripBgActiveColor},bgcolor:{valType:"color",dflt:n.railBgColor},bordercolor:{valType:"color",dflt:n.railBorderColor},borderwidth:{valType:"number",min:0,dflt:n.railBorderWidth},ticklen:{valType:"number",min:0,dflt:n.tickLength},tickcolor:{valType:"color",dflt:n.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:n.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/animation_attributes":560,"../../plots/font_attributes":594,"../../plots/pad_attributes":627,"./constants":472}],472:[function(m,G,Y){G.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],473:[function(m,G,Y){var d=m("../../lib"),v=m("../../plots/array_container_defaults"),w=m("./attributes"),y=m("./constants").name,e=w.steps;function t(o,r,g){function c(p,u){return d.coerce(o,r,w,p,u)}for(var a=v(o,r,{name:"steps",handleItemDefaults:n}),h=0,l=0;l<a.length;l++)a[l].visible&&h++;if(h<2?r.visible=!1:c("visible")){r._stepCount=h;var s=r._visibleSteps=d.filterVisible(a);(a[c("active")]||{}).visible||(r.active=s[0]._index),c("x"),c("y"),d.noneOrAll(o,r,["x","y"]),c("xanchor"),c("yanchor"),c("len"),c("lenmode"),c("pad.t"),c("pad.r"),c("pad.b"),c("pad.l"),d.coerceFont(c,"font",g.font),c("currentvalue.visible")&&(c("currentvalue.xanchor"),c("currentvalue.prefix"),c("currentvalue.suffix"),c("currentvalue.offset"),d.coerceFont(c,"currentvalue.font",r.font)),c("transition.duration"),c("transition.easing"),c("bgcolor"),c("activebgcolor"),c("bordercolor"),c("borderwidth"),c("ticklen"),c("tickwidth"),c("tickcolor"),c("minorticklen")}}function n(o,r){function g(a,h){return d.coerce(o,r,e,a,h)}if(o.method==="skip"||Array.isArray(o.args)?g("visible"):r.visible=!1){g("method"),g("args");var c=g("label","step-"+r._index);g("value",c),g("execute")}}G.exports=function(o,r){v(o,r,{name:y,handleItemDefaults:t})}},{"../../lib":515,"../../plots/array_container_defaults":561,"./attributes":471,"./constants":472}],474:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../plots/plots"),w=m("../color"),y=m("../drawing"),e=m("../../lib"),t=e.strTranslate,n=m("../../lib/svg_text_utils"),o=m("../../plot_api/plot_template").arrayEditor,r=m("./constants"),g=m("../../constants/alignment"),c=g.LINE_SPACING,a=g.FROM_TL,h=g.FROM_BR;function l(E){return r.autoMarginIdRoot+E._index}function s(E){return E._index}function p(E,z){var D=y.tester.selectAll("g."+r.labelGroupClass).data(z._visibleSteps);D.enter().append("g").classed(r.labelGroupClass,!0);var j=0,V=0;D.each(function(te){var B=x(d.select(this),{step:te},z).node();if(B){var K=y.bBox(B);V=Math.max(V,K.height),j=Math.max(j,K.width)}}),D.remove();var Z=z._dims={};Z.inputAreaWidth=Math.max(r.railWidth,r.gripHeight);var Q=E._fullLayout._size;Z.lx=Q.l+Q.w*z.x,Z.ly=Q.t+Q.h*(1-z.y),z.lenmode==="fraction"?Z.outerLength=Math.round(Q.w*z.len):Z.outerLength=z.len,Z.inputAreaStart=0,Z.inputAreaLength=Math.round(Z.outerLength-z.pad.l-z.pad.r);var X=(Z.inputAreaLength-2*r.stepInset)/(z._stepCount-1),$=j+r.labelPadding;if(Z.labelStride=Math.max(1,Math.ceil($/X)),Z.labelHeight=V,Z.currentValueMaxWidth=0,Z.currentValueHeight=0,Z.currentValueTotalHeight=0,Z.currentValueMaxLines=1,z.currentvalue.visible){var re=y.tester.append("g");D.each(function(te){var B=u(re,z,te.label),K=B.node()&&y.bBox(B.node())||{width:0,height:0},J=n.lineCount(B);Z.currentValueMaxWidth=Math.max(Z.currentValueMaxWidth,Math.ceil(K.width)),Z.currentValueHeight=Math.max(Z.currentValueHeight,Math.ceil(K.height)),Z.currentValueMaxLines=Math.max(Z.currentValueMaxLines,J)}),Z.currentValueTotalHeight=Z.currentValueHeight+z.currentvalue.offset,re.remove()}Z.height=Z.currentValueTotalHeight+r.tickOffset+z.ticklen+r.labelOffset+Z.labelHeight+z.pad.t+z.pad.b;var H="left";e.isRightAnchor(z)&&(Z.lx-=Z.outerLength,H="right"),e.isCenterAnchor(z)&&(Z.lx-=Z.outerLength/2,H="center");var N="top";e.isBottomAnchor(z)&&(Z.ly-=Z.height,N="bottom"),e.isMiddleAnchor(z)&&(Z.ly-=Z.height/2,N="middle"),Z.outerLength=Math.ceil(Z.outerLength),Z.height=Math.ceil(Z.height),Z.lx=Math.round(Z.lx),Z.ly=Math.round(Z.ly);var U={y:z.y,b:Z.height*h[N],t:Z.height*a[N]};z.lenmode==="fraction"?(U.l=0,U.xl=z.x-z.len*a[H],U.r=0,U.xr=z.x+z.len*h[H]):(U.x=z.x,U.l=Z.outerLength*a[H],U.r=Z.outerLength*h[H]),v.autoMargin(E,l(z),U)}function u(E,z,D){if(z.currentvalue.visible){var j,V,Z=z._dims;switch(z.currentvalue.xanchor){case"right":j=Z.inputAreaLength-r.currentValueInset-Z.currentValueMaxWidth,V="left";break;case"center":j=.5*Z.inputAreaLength,V="middle";break;default:j=r.currentValueInset,V="left"}var Q=e.ensureSingle(E,"text",r.labelClass,function(U){U.attr({"text-anchor":V,"data-notex":1})}),X=z.currentvalue.prefix?z.currentvalue.prefix:"";if(typeof D=="string")X+=D;else{var $=z.steps[z.active].label,re=z._gd._fullLayout._meta;re&&($=e.templateString($,re)),X+=$}z.currentvalue.suffix&&(X+=z.currentvalue.suffix),Q.call(y.font,z.currentvalue.font).text(X).call(n.convertToTspans,z._gd);var H=n.lineCount(Q),N=(Z.currentValueMaxLines+1-H)*z.currentvalue.font.size*c;return n.positionText(Q,j,N),Q}}function i(E,z,D){e.ensureSingle(E,"rect",r.gripRectClass,function(j){j.call(T,z,E,D).style("pointer-events","all")}).attr({width:r.gripWidth,height:r.gripHeight,rx:r.gripRadius,ry:r.gripRadius}).call(w.stroke,D.bordercolor).call(w.fill,D.bgcolor).style("stroke-width",D.borderwidth+"px")}function x(E,z,D){var j=e.ensureSingle(E,"text",r.labelClass,function(Q){Q.attr({"text-anchor":"middle","data-notex":1})}),V=z.step.label,Z=D._gd._fullLayout._meta;return Z&&(V=e.templateString(V,Z)),j.call(y.font,D.font).text(V).call(n.convertToTspans,D._gd),j}function f(E,z){var D=e.ensureSingle(E,"g",r.labelsClass),j=z._dims,V=D.selectAll("g."+r.labelGroupClass).data(j.labelSteps);V.enter().append("g").classed(r.labelGroupClass,!0),V.exit().remove(),V.each(function(Z){var Q=d.select(this);Q.call(x,Z,z),y.setTranslate(Q,A(z,Z.fraction),r.tickOffset+z.ticklen+z.font.size*c+r.labelOffset+j.currentValueTotalHeight)})}function _(E,z,D,j,V){var Z=Math.round(j*(D._stepCount-1)),Q=D._visibleSteps[Z]._index;Q!==D.active&&b(E,z,D,Q,!0,V)}function b(E,z,D,j,V,Z){var Q=D.active;D.active=j,o(E.layout,r.name,D).applyUpdate("active",j);var X=D.steps[D.active];z.call(L,D,Z),z.call(u,D),E.emit("plotly_sliderchange",{slider:D,step:D.steps[D.active],interaction:V,previousActive:Q}),X&&X.method&&V&&(z._nextMethod?(z._nextMethod.step=X,z._nextMethod.doCallback=V,z._nextMethod.doTransition=Z):(z._nextMethod={step:X,doCallback:V,doTransition:Z},z._nextMethodRaf=window.requestAnimationFrame(function(){var $=z._nextMethod.step;$.method&&($.execute&&v.executeAPICommand(E,$.method,$.args),z._nextMethod=null,z._nextMethodRaf=null)})))}function T(E,z,D){var j=D.node(),V=d.select(z);function Z(){return D.data()[0]}function Q(){var X=Z();z.emit("plotly_sliderstart",{slider:X});var $=D.select("."+r.gripRectClass);d.event.stopPropagation(),d.event.preventDefault(),$.call(w.fill,X.activebgcolor);var re=I(X,d.mouse(j)[0]);function H(){var U=Z(),te=I(U,d.mouse(j)[0]);_(z,D,U,te,!1)}function N(){var U=Z();U._dragging=!1,$.call(w.fill,U.bgcolor),V.on("mouseup",null),V.on("mousemove",null),V.on("touchend",null),V.on("touchmove",null),z.emit("plotly_sliderend",{slider:U,step:U.steps[U.active]})}_(z,D,X,re,!0),X._dragging=!0,V.on("mousemove",H),V.on("touchmove",H),V.on("mouseup",N),V.on("touchend",N)}E.on("mousedown",Q),E.on("touchstart",Q)}function k(E,z){var D=E.selectAll("rect."+r.tickRectClass).data(z._visibleSteps),j=z._dims;D.enter().append("rect").classed(r.tickRectClass,!0),D.exit().remove(),D.attr({width:z.tickwidth+"px","shape-rendering":"crispEdges"}),D.each(function(V,Z){var Q=Z%j.labelStride==0,X=d.select(this);X.attr({height:Q?z.ticklen:z.minorticklen}).call(w.fill,z.tickcolor),y.setTranslate(X,A(z,Z/(z._stepCount-1))-.5*z.tickwidth,(Q?r.tickOffset:r.minorTickOffset)+j.currentValueTotalHeight)})}function L(E,z,D){for(var j=E.select("rect."+r.gripRectClass),V=0,Z=0;Z<z._stepCount;Z++)if(z._visibleSteps[Z]._index===z.active){V=Z;break}var Q=A(z,V/(z._stepCount-1));if(!z._invokingCommand){var X=j;D&&z.transition.duration>0&&(X=X.transition().duration(z.transition.duration).ease(z.transition.easing)),X.attr("transform",t(Q-.5*r.gripWidth,z._dims.currentValueTotalHeight))}}function A(E,z){var D=E._dims;return D.inputAreaStart+r.stepInset+(D.inputAreaLength-2*r.stepInset)*Math.min(1,Math.max(0,z))}function I(E,z){var D=E._dims;return Math.min(1,Math.max(0,(z-r.stepInset-D.inputAreaStart)/(D.inputAreaLength-2*r.stepInset-2*D.inputAreaStart)))}function P(E,z,D){var j=D._dims,V=e.ensureSingle(E,"rect",r.railTouchRectClass,function(Z){Z.call(T,z,E,D).style("pointer-events","all")});V.attr({width:j.inputAreaLength,height:Math.max(j.inputAreaWidth,r.tickOffset+D.ticklen+j.labelHeight)}).call(w.fill,D.bgcolor).attr("opacity",0),y.setTranslate(V,0,j.currentValueTotalHeight)}function S(E,z){var D=z._dims,j=D.inputAreaLength-2*r.railInset,V=e.ensureSingle(E,"rect",r.railRectClass);V.attr({width:j,height:r.railWidth,rx:r.railRadius,ry:r.railRadius,"shape-rendering":"crispEdges"}).call(w.stroke,z.bordercolor).call(w.fill,z.bgcolor).style("stroke-width",z.borderwidth+"px"),y.setTranslate(V,r.railInset,.5*(D.inputAreaWidth-r.railWidth)+D.currentValueTotalHeight)}G.exports=function(E){var z=E._fullLayout,D=function($,re){for(var H=$[r.name],N=[],U=0;U<H.length;U++){var te=H[U];te.visible&&(te._gd=re,N.push(te))}return N}(z,E),j=z._infolayer.selectAll("g."+r.containerClassName).data(D.length>0?[0]:[]);function V($){$._commandObserver&&($._commandObserver.remove(),delete $._commandObserver),v.autoMargin(E,l($))}if(j.enter().append("g").classed(r.containerClassName,!0).style("cursor","ew-resize"),j.exit().each(function(){d.select(this).selectAll("g."+r.groupClassName).each(V)}).remove(),D.length!==0){var Z=j.selectAll("g."+r.groupClassName).data(D,s);Z.enter().append("g").classed(r.groupClassName,!0),Z.exit().each(V).remove();for(var Q=0;Q<D.length;Q++){var X=D[Q];p(E,X)}Z.each(function($){var re=d.select(this);(function(H){var N=H._dims;N.labelSteps=[];for(var U=H._stepCount,te=0;te<U;te+=N.labelStride)N.labelSteps.push({fraction:te/(U-1),step:H._visibleSteps[te]})})($),v.manageCommandObserver(E,$,$._visibleSteps,function(H){var N=re.data()[0];N.active!==H.index&&(N._dragging||b(E,re,N,H.index,!1,!0))}),function(H,N,U){(U.steps[U.active]||{}).visible||(U.active=U._visibleSteps[0]._index),N.call(u,U).call(S,U).call(f,U).call(k,U).call(P,H,U).call(i,H,U);var te=U._dims;y.setTranslate(N,te.lx+U.pad.l,te.ly+U.pad.t),N.call(L,U,!1),N.call(u,U)}(E,d.select(this),$)})}}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/plots":628,"../color":367,"../drawing":389,"./constants":472,"@plotly/d3":58}],475:[function(m,G,Y){var d=m("./constants");G.exports={moduleType:"component",name:d.name,layoutAttributes:m("./attributes"),supplyLayoutDefaults:m("./defaults"),draw:m("./draw")}},{"./attributes":471,"./constants":472,"./defaults":473,"./draw":474}],476:[function(m,G,Y){var d=m("@plotly/d3"),v=m("fast-isnumeric"),w=m("../../plots/plots"),y=m("../../registry"),e=m("../../lib"),t=e.strTranslate,n=m("../drawing"),o=m("../color"),r=m("../../lib/svg_text_utils"),g=m("../../constants/interactions"),c=m("../../constants/alignment").OPPOSITE_SIDE,a=/ [XY][0-9]* /;G.exports={draw:function(h,l,s){var p,u=s.propContainer,i=s.propName,x=s.placeholder,f=s.traceIndex,_=s.avoid||{},b=s.attributes,T=s.transform,k=s.containerGroup,L=h._fullLayout,A=1,I=!1,P=u.title,S=(P&&P.text?P.text:"").trim(),E=P&&P.font?P.font:{},z=E.family,D=E.size,j=E.color;i==="title.text"?p="titleText":i.indexOf("axis")!==-1?p="axisTitleText":i.indexOf(!0)&&(p="colorbarTitleText");var V=h._context.edits[p];S===""?A=0:S.replace(a," % ")===x.replace(a," % ")&&(A=.2,I=!0,V||(S="")),s._meta?S=e.templateString(S,s._meta):L._meta&&(S=e.templateString(S,L._meta));var Z,Q=S||V;k||(k=e.ensureSingle(L._infolayer,"g","g-"+l),Z=L._hColorbarMoveTitle);var X=k.selectAll("text").data(Q?[0]:[]);if(X.enter().append("text"),X.text(S).attr("class",l),X.exit().remove(),!Q)return k;function $(N){e.syncOrAsync([re,H],N)}function re(N){var U;return!T&&Z&&(T={}),T?(U="",T.rotate&&(U+="rotate("+[T.rotate,b.x,b.y]+")"),(T.offset||Z)&&(U+=t(0,(T.offset||0)-(Z||0)))):U=null,N.attr("transform",U),N.style({"font-family":z,"font-size":d.round(D,2)+"px",fill:o.rgb(j),opacity:A*o.opacity(j),"font-weight":w.fontWeight}).attr(b).call(r.convertToTspans,h),w.previousPromises(h)}function H(N){var U=d.select(N.node().parentNode);if(_&&_.selection&&_.side&&S){U.attr("transform",null);var te=c[_.side],B=_.side==="left"||_.side==="top"?-1:1,K=v(_.pad)?_.pad:2,J=n.bBox(U.node()),ee={left:0,top:0,right:L.width,bottom:L.height},ne=_.maxShift||B*(ee[_.side]-J[_.side]),se=0;if(ne<0)se=ne;else{var oe=_.offsetLeft||0,me=_.offsetTop||0;J.left-=oe,J.right-=oe,J.top-=me,J.bottom-=me,_.selection.each(function(){var ye=n.bBox(this);e.bBoxIntersect(J,ye,K)&&(se=Math.max(se,B*(ye[_.side]-J[te])+K))}),se=Math.min(ne,se)}if(se>0||ne<0){var ce={left:[-se,0],right:[se,0],top:[0,-se],bottom:[0,se]}[_.side];U.attr("transform",t(ce[0],ce[1]))}}}return X.call($),V&&(S?X.on(".opacity",null):(A=0,I=!0,X.text(x).on("mouseover.opacity",function(){d.select(this).transition().duration(g.SHOW_PLACEHOLDER).style("opacity",1)}).on("mouseout.opacity",function(){d.select(this).transition().duration(g.HIDE_PLACEHOLDER).style("opacity",0)})),X.call(r.makeEditable,{gd:h}).on("edit",function(N){f!==void 0?y.call("_guiRestyle",h,i,N,f):y.call("_guiRelayout",h,i,N)}).on("cancel",function(){this.text(this.attr("data-unformatted")).call($)}).on("input",function(N){this.text(N||" ").call(r.positionText,b.x,b.y)})),X.classed("js-placeholder",I),k}}},{"../../constants/alignment":483,"../../constants/interactions":490,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"../color":367,"../drawing":389,"@plotly/d3":58,"fast-isnumeric":190}],477:[function(m,G,Y){var d=m("../../plots/font_attributes"),v=m("../color/attributes"),w=m("../../lib/extend").extendFlat,y=m("../../plot_api/edit_types").overrideAll,e=m("../../plots/pad_attributes"),t=m("../../plot_api/plot_template").templatedArray,n=t("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});G.exports=y(t("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:n,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:w(e({editType:"arraydraw"}),{}),font:d({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:v.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/font_attributes":594,"../../plots/pad_attributes":627,"../color/attributes":366}],478:[function(m,G,Y){G.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"\u25C4",right:"\u25BA",up:"\u25B2",down:"\u25BC"}}},{}],479:[function(m,G,Y){var d=m("../../lib"),v=m("../../plots/array_container_defaults"),w=m("./attributes"),y=m("./constants").name,e=w.buttons;function t(o,r,g){function c(a,h){return d.coerce(o,r,w,a,h)}c("visible",v(o,r,{name:"buttons",handleItemDefaults:n}).length>0)&&(c("active"),c("direction"),c("type"),c("showactive"),c("x"),c("y"),d.noneOrAll(o,r,["x","y"]),c("xanchor"),c("yanchor"),c("pad.t"),c("pad.r"),c("pad.b"),c("pad.l"),d.coerceFont(c,"font",g.font),c("bgcolor",g.paper_bgcolor),c("bordercolor"),c("borderwidth"))}function n(o,r){function g(c,a){return d.coerce(o,r,e,c,a)}g("visible",o.method==="skip"||Array.isArray(o.args))&&(g("method"),g("args"),g("args2"),g("label"),g("execute"))}G.exports=function(o,r){v(o,r,{name:y,handleItemDefaults:t})}},{"../../lib":515,"../../plots/array_container_defaults":561,"./attributes":477,"./constants":478}],480:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../plots/plots"),w=m("../color"),y=m("../drawing"),e=m("../../lib"),t=m("../../lib/svg_text_utils"),n=m("../../plot_api/plot_template").arrayEditor,o=m("../../constants/alignment").LINE_SPACING,r=m("./constants"),g=m("./scrollbox");function c(A){return A._index}function a(A,I){return+A.attr(r.menuIndexAttrName)===I._index}function h(A,I,P,S,E,z,D,j){I.active=D,n(A.layout,r.name,I).applyUpdate("active",D),I.type==="buttons"?s(A,S,null,null,I):I.type==="dropdown"&&(E.attr(r.menuIndexAttrName,"-1"),l(A,S,E,z,I),j||s(A,S,E,z,I))}function l(A,I,P,S,E){var z=e.ensureSingle(I,"g",r.headerClassName,function(X){X.style("pointer-events","all")}),D=E._dims,j=E.active,V=E.buttons[j]||r.blankHeaderOpts,Z={y:E.pad.t,yPad:0,x:E.pad.l,xPad:0,index:0},Q={width:D.headerWidth,height:D.headerHeight};z.call(p,E,V,A).call(k,E,Z,Q),e.ensureSingle(I,"text",r.headerArrowClassName,function(X){X.attr("text-anchor","end").call(y.font,E.font).text(r.arrowSymbol[E.direction])}).attr({x:D.headerWidth-r.arrowOffsetX+E.pad.l,y:D.headerHeight/2+r.textOffsetY+E.pad.t}),z.on("click",function(){P.call(L,String(a(P,E)?-1:E._index)),s(A,I,P,S,E)}),z.on("mouseover",function(){z.call(f)}),z.on("mouseout",function(){z.call(_,E)}),y.setTranslate(I,D.lx,D.ly)}function s(A,I,P,S,E){P||(P=I).attr("pointer-events","all");var z=function(U){return+U.attr(r.menuIndexAttrName)==-1}(P)&&E.type!=="buttons"?[]:E.buttons,D=E.type==="dropdown"?r.dropdownButtonClassName:r.buttonClassName,j=P.selectAll("g."+D).data(e.filterVisible(z)),V=j.enter().append("g").classed(D,!0),Z=j.exit();E.type==="dropdown"?(V.attr("opacity","0").transition().attr("opacity","1"),Z.transition().attr("opacity","0").remove()):Z.remove();var Q=0,X=0,$=E._dims,re=["up","down"].indexOf(E.direction)!==-1;E.type==="dropdown"&&(re?X=$.headerHeight+r.gapButtonHeader:Q=$.headerWidth+r.gapButtonHeader),E.type==="dropdown"&&E.direction==="up"&&(X=-r.gapButtonHeader+r.gapButton-$.openHeight),E.type==="dropdown"&&E.direction==="left"&&(Q=-r.gapButtonHeader+r.gapButton-$.openWidth);var H={x:$.lx+Q+E.pad.l,y:$.ly+X+E.pad.t,yPad:r.gapButton,xPad:r.gapButton,index:0},N={l:H.x+E.borderwidth,t:H.y+E.borderwidth};j.each(function(U,te){var B=d.select(this);B.call(p,E,U,A).call(k,E,H),B.on("click",function(){d.event.defaultPrevented||(U.execute&&(U.args2&&E.active===te?(h(A,E,0,I,P,S,-1),v.executeAPICommand(A,U.method,U.args2)):(h(A,E,0,I,P,S,te),v.executeAPICommand(A,U.method,U.args))),A.emit("plotly_buttonclicked",{menu:E,button:U,active:E.active}))}),B.on("mouseover",function(){B.call(f)}),B.on("mouseout",function(){B.call(_,E),j.call(x,E)})}),j.call(x,E),re?(N.w=Math.max($.openWidth,$.headerWidth),N.h=H.y-N.t):(N.w=H.x-N.l,N.h=Math.max($.openHeight,$.headerHeight)),N.direction=E.direction,S&&(j.size()?function(U,te,B,K,J,ee){var ne,se,oe,me=J.direction,ce=me==="up"||me==="down",ye=J._dims,Se=J.active;if(ce)for(se=0,oe=0;oe<Se;oe++)se+=ye.heights[oe]+r.gapButton;else for(ne=0,oe=0;oe<Se;oe++)ne+=ye.widths[oe]+r.gapButton;K.enable(ee,ne,se),K.hbar&&K.hbar.attr("opacity","0").transition().attr("opacity","1"),K.vbar&&K.vbar.attr("opacity","0").transition().attr("opacity","1")}(0,0,0,S,E,N):function(U){var te=!!U.hbar,B=!!U.vbar;te&&U.hbar.transition().attr("opacity","0").each("end",function(){te=!1,B||U.disable()}),B&&U.vbar.transition().attr("opacity","0").each("end",function(){B=!1,te||U.disable()})}(S))}function p(A,I,P,S){A.call(u,I).call(i,I,P,S)}function u(A,I){e.ensureSingle(A,"rect",r.itemRectClassName,function(P){P.attr({rx:r.rx,ry:r.ry,"shape-rendering":"crispEdges"})}).call(w.stroke,I.bordercolor).call(w.fill,I.bgcolor).style("stroke-width",I.borderwidth+"px")}function i(A,I,P,S){var E=e.ensureSingle(A,"text",r.itemTextClassName,function(j){j.attr({"text-anchor":"start","data-notex":1})}),z=P.label,D=S._fullLayout._meta;D&&(z=e.templateString(z,D)),E.call(y.font,I.font).text(z).call(t.convertToTspans,S)}function x(A,I){var P=I.active;A.each(function(S,E){var z=d.select(this);E===P&&I.showactive&&z.select("rect."+r.itemRectClassName).call(w.fill,r.activeColor)})}function f(A){A.select("rect."+r.itemRectClassName).call(w.fill,r.hoverColor)}function _(A,I){A.select("rect."+r.itemRectClassName).call(w.fill,I.bgcolor)}function b(A,I){var P=I._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},S=y.tester.selectAll("g."+r.dropdownButtonClassName).data(e.filterVisible(I.buttons));S.enter().append("g").classed(r.dropdownButtonClassName,!0);var E=["up","down"].indexOf(I.direction)!==-1;S.each(function(Q,X){var $=d.select(this);$.call(p,I,Q,A);var re=$.select("."+r.itemTextClassName),H=re.node()&&y.bBox(re.node()).width,N=Math.max(H+r.textPadX,r.minWidth),U=I.font.size*o,te=t.lineCount(re),B=Math.max(U*te,r.minHeight)+r.textOffsetY;B=Math.ceil(B),N=Math.ceil(N),P.widths[X]=N,P.heights[X]=B,P.height1=Math.max(P.height1,B),P.width1=Math.max(P.width1,N),E?(P.totalWidth=Math.max(P.totalWidth,N),P.openWidth=P.totalWidth,P.totalHeight+=B+r.gapButton,P.openHeight+=B+r.gapButton):(P.totalWidth+=N+r.gapButton,P.openWidth+=N+r.gapButton,P.totalHeight=Math.max(P.totalHeight,B),P.openHeight=P.totalHeight)}),E?P.totalHeight-=r.gapButton:P.totalWidth-=r.gapButton,P.headerWidth=P.width1+r.arrowPadX,P.headerHeight=P.height1,I.type==="dropdown"&&(E?(P.width1+=r.arrowPadX,P.totalHeight=P.height1):P.totalWidth=P.width1,P.totalWidth+=r.arrowPadX),S.remove();var z=P.totalWidth+I.pad.l+I.pad.r,D=P.totalHeight+I.pad.t+I.pad.b,j=A._fullLayout._size;P.lx=j.l+j.w*I.x,P.ly=j.t+j.h*(1-I.y);var V="left";e.isRightAnchor(I)&&(P.lx-=z,V="right"),e.isCenterAnchor(I)&&(P.lx-=z/2,V="center");var Z="top";e.isBottomAnchor(I)&&(P.ly-=D,Z="bottom"),e.isMiddleAnchor(I)&&(P.ly-=D/2,Z="middle"),P.totalWidth=Math.ceil(P.totalWidth),P.totalHeight=Math.ceil(P.totalHeight),P.lx=Math.round(P.lx),P.ly=Math.round(P.ly),v.autoMargin(A,T(I),{x:I.x,y:I.y,l:z*({right:1,center:.5}[V]||0),r:z*({left:1,center:.5}[V]||0),b:D*({top:1,middle:.5}[Z]||0),t:D*({bottom:1,middle:.5}[Z]||0)})}function T(A){return r.autoMarginIdRoot+A._index}function k(A,I,P,S){S=S||{};var E=A.select("."+r.itemRectClassName),z=A.select("."+r.itemTextClassName),D=I.borderwidth,j=P.index,V=I._dims;y.setTranslate(A,D+P.x,D+P.y);var Z=["up","down"].indexOf(I.direction)!==-1,Q=S.height||(Z?V.heights[j]:V.height1);E.attr({x:0,y:0,width:S.width||(Z?V.width1:V.widths[j]),height:Q});var X=I.font.size*o,$=(t.lineCount(z)-1)*X/2;t.positionText(z,r.textOffsetX,Q/2-$+r.textOffsetY),Z?P.y+=V.heights[j]+P.yPad:P.x+=V.widths[j]+P.xPad,P.index++}function L(A,I){A.attr(r.menuIndexAttrName,I||"-1").selectAll("g."+r.dropdownButtonClassName).remove()}G.exports=function(A){var I=A._fullLayout,P=e.filterVisible(I[r.name]);function S(X){v.autoMargin(A,T(X))}var E=I._menulayer.selectAll("g."+r.containerClassName).data(P.length>0?[0]:[]);if(E.enter().append("g").classed(r.containerClassName,!0).style("cursor","pointer"),E.exit().each(function(){d.select(this).selectAll("g."+r.headerGroupClassName).each(S)}).remove(),P.length!==0){var z=E.selectAll("g."+r.headerGroupClassName).data(P,c);z.enter().append("g").classed(r.headerGroupClassName,!0);for(var D=e.ensureSingle(E,"g",r.dropdownButtonGroupClassName,function(X){X.style("pointer-events","all")}),j=0;j<P.length;j++){var V=P[j];b(A,V)}var Z="updatemenus"+I._uid,Q=new g(A,D,Z);z.enter().size()&&(D.node().parentNode.appendChild(D.node()),D.call(L)),z.exit().each(function(X){D.call(L),S(X)}).remove(),z.each(function(X){var $=d.select(this),re=X.type==="dropdown"?D:null;v.manageCommandObserver(A,X,X.buttons,function(H){h(A,X,X.buttons[H.index],$,re,Q,H.index,!0)}),X.type==="dropdown"?(l(A,$,D,Q,X),a(D,X)&&s(A,$,D,Q,X)):s(A,$,null,null,X)})}}},{"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_template":555,"../../plots/plots":628,"../color":367,"../drawing":389,"./constants":478,"./scrollbox":482,"@plotly/d3":58}],481:[function(m,G,Y){arguments[4][475][0].apply(Y,arguments)},{"./attributes":477,"./constants":478,"./defaults":479,"./draw":480,dup:475}],482:[function(m,G,Y){G.exports=e;var d=m("@plotly/d3"),v=m("../color"),w=m("../drawing"),y=m("../../lib");function e(t,n,o){this.gd=t,this.container=n,this.id=o,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}e.barWidth=2,e.barLength=20,e.barRadius=2,e.barPad=1,e.barColor="#808BA4",e.prototype.enable=function(t,n,o){var r=this.gd._fullLayout,g=r.width,c=r.height;this.position=t;var a,h,l,s,p=this.position.l,u=this.position.w,i=this.position.t,x=this.position.h,f=this.position.direction,_=f==="down",b=f==="left",T=f==="up",k=u,L=x;_||b||f==="right"||T||(this.position.direction="down",_=!0),_||T?(h=(a=p)+k,_?(l=i,L=(s=Math.min(l+L,c))-l):L=(s=i+L)-(l=Math.max(s-L,0))):(s=(l=i)+L,b?k=(h=p+k)-(a=Math.max(h-k,0)):(a=p,k=(h=Math.min(a+k,g))-a)),this._box={l:a,t:l,w:k,h:L};var A=u>k,I=e.barLength+2*e.barPad,P=e.barWidth+2*e.barPad,S=p,E=i+x;E+P>c&&(E=c-P);var z=this.container.selectAll("rect.scrollbar-horizontal").data(A?[0]:[]);z.exit().on(".drag",null).remove(),z.enter().append("rect").classed("scrollbar-horizontal",!0).call(v.fill,e.barColor),A?(this.hbar=z.attr({rx:e.barRadius,ry:e.barRadius,x:S,y:E,width:I,height:P}),this._hbarXMin=S+I/2,this._hbarTranslateMax=k-I):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var D=x>L,j=e.barWidth+2*e.barPad,V=e.barLength+2*e.barPad,Z=p+u,Q=i;Z+j>g&&(Z=g-j);var X=this.container.selectAll("rect.scrollbar-vertical").data(D?[0]:[]);X.exit().on(".drag",null).remove(),X.enter().append("rect").classed("scrollbar-vertical",!0).call(v.fill,e.barColor),D?(this.vbar=X.attr({rx:e.barRadius,ry:e.barRadius,x:Z,y:Q,width:j,height:V}),this._vbarYMin=Q+V/2,this._vbarTranslateMax=L-V):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var $=this.id,re=a-.5,H=D?h+j+.5:h+.5,N=l-.5,U=A?s+P+.5:s+.5,te=r._topdefs.selectAll("#"+$).data(A||D?[0]:[]);if(te.exit().remove(),te.enter().append("clipPath").attr("id",$).append("rect"),A||D?(this._clipRect=te.select("rect").attr({x:Math.floor(re),y:Math.floor(N),width:Math.ceil(H)-Math.floor(re),height:Math.ceil(U)-Math.floor(N)}),this.container.call(w.setClipUrl,$,this.gd),this.bg.attr({x:p,y:i,width:u,height:x})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(w.setClipUrl,null),delete this._clipRect),A||D){var B=d.behavior.drag().on("dragstart",function(){d.event.sourceEvent.preventDefault()}).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(B);var K=d.behavior.drag().on("dragstart",function(){d.event.sourceEvent.preventDefault(),d.event.sourceEvent.stopPropagation()}).on("drag",this._onBarDrag.bind(this));A&&this.hbar.on(".drag",null).call(K),D&&this.vbar.on(".drag",null).call(K)}this.setTranslate(n,o)},e.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(w.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},e.prototype._onBoxDrag=function(){var t=this.translateX,n=this.translateY;this.hbar&&(t-=d.event.dx),this.vbar&&(n-=d.event.dy),this.setTranslate(t,n)},e.prototype._onBoxWheel=function(){var t=this.translateX,n=this.translateY;this.hbar&&(t+=d.event.deltaY),this.vbar&&(n+=d.event.deltaY),this.setTranslate(t,n)},e.prototype._onBarDrag=function(){var t=this.translateX,n=this.translateY;if(this.hbar){var o=t+this._hbarXMin,r=o+this._hbarTranslateMax;t=(y.constrain(d.event.x,o,r)-o)/(r-o)*(this.position.w-this._box.w)}if(this.vbar){var g=n+this._vbarYMin,c=g+this._vbarTranslateMax;n=(y.constrain(d.event.y,g,c)-g)/(c-g)*(this.position.h-this._box.h)}this.setTranslate(t,n)},e.prototype.setTranslate=function(t,n){var o=this.position.w-this._box.w,r=this.position.h-this._box.h;if(t=y.constrain(t||0,0,o),n=y.constrain(n||0,0,r),this.translateX=t,this.translateY=n,this.container.call(w.setTranslate,this._box.l-this.position.l-t,this._box.t-this.position.t-n),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+t-.5),y:Math.floor(this.position.t+n-.5)}),this.hbar){var g=t/o;this.hbar.call(w.setTranslate,t+g*this._hbarTranslateMax,n)}if(this.vbar){var c=n/r;this.vbar.call(w.setTranslate,t,n+c*this._vbarTranslateMax)}}},{"../../lib":515,"../color":367,"../drawing":389,"@plotly/d3":58}],483:[function(m,G,Y){G.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],484:[function(m,G,Y){G.exports={axisRefDescription:function(d,v,w){return["If set to a",d,"axis id (e.g. *"+d+"* or","*"+d+"2*), the `"+d+"` position refers to a",d,"coordinate. If set to *paper*, the `"+d+"`","position refers to the distance from the",v,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",v,"("+w+"). If set to a",d,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",v,"of the domain of that axis: e.g.,","*"+d+"2 domain* refers to the domain of the second",d," axis and a",d,"position of 0.5 refers to the","point between the",v,"and the",w,"of the domain of the","second",d,"axis."].join(" ")}}},{}],485:[function(m,G,Y){G.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:"\u25B2"},DECREASING:{COLOR:"#FF4136",SYMBOL:"\u25BC"}}},{}],486:[function(m,G,Y){G.exports={FORMAT_LINK:"https://github.com/d3/d3-format/tree/v1.4.5#d3-format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format/tree/v2.2.3#locale_format"}},{}],487:[function(m,G,Y){G.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],488:[function(m,G,Y){G.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],489:[function(m,G,Y){G.exports={circle:"\u25CF","circle-open":"\u25CB",square:"\u25A0","square-open":"\u25A1",diamond:"\u25C6","diamond-open":"\u25C7",cross:"+",x:"\u274C"}},{}],490:[function(m,G,Y){G.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],491:[function(m,G,Y){G.exports={BADNUM:void 0,FP_SAFE:1e-4*Number.MAX_VALUE,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:24405875e-1,ALMOST_EQUAL:.999999,LOG_CLIP:10,MINUS_SIGN:"\u2212"}},{}],492:[function(m,G,Y){Y.xmlns="http://www.w3.org/2000/xmlns/",Y.svg="http://www.w3.org/2000/svg",Y.xlink="http://www.w3.org/1999/xlink",Y.svgAttrs={xmlns:Y.svg,"xmlns:xlink":Y.xlink}},{}],493:[function(m,G,Y){Y.version=m("./version").version,m("native-promise-only"),m("../build/plotcss");for(var d=m("./registry"),v=Y.register=d.register,w=m("./plot_api"),y=Object.keys(w),e=0;e<y.length;e++){var t=y[e];t.charAt(0)!=="_"&&(Y[t]=w[t]),v({moduleType:"apiMethod",name:t,fn:w[t]})}v(m("./traces/scatter")),v([m("./components/legend"),m("./components/fx"),m("./components/annotations"),m("./components/annotations3d"),m("./components/selections"),m("./components/shapes"),m("./components/images"),m("./components/updatemenus"),m("./components/sliders"),m("./components/rangeslider"),m("./components/rangeselector"),m("./components/grid"),m("./components/errorbars"),m("./components/colorscale"),m("./components/colorbar"),m("./components/modebar")]),v([m("./locale-en"),m("./locale-en-us")]),window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)&&(v(window.PlotlyLocales),delete window.PlotlyLocales),Y.Icons=m("./fonts/ploticon");var n=m("./components/fx"),o=m("./plots/plots");Y.Plots={resize:o.resize,graphJson:o.graphJson,sendDataToCloud:o.sendDataToCloud},Y.Fx={hover:n.hover,unhover:n.unhover,loneHover:n.loneHover,loneUnhover:n.loneUnhover},Y.Snapshot=m("./snapshot"),Y.PlotSchema=m("./plot_api/plot_schema")},{"../build/plotcss":1,"./components/annotations":358,"./components/annotations3d":363,"./components/colorbar":373,"./components/colorscale":379,"./components/errorbars":395,"./components/fx":407,"./components/grid":411,"./components/images":416,"./components/legend":424,"./components/modebar":430,"./components/rangeselector":438,"./components/rangeslider":445,"./components/selections":455,"./components/shapes":470,"./components/sliders":475,"./components/updatemenus":481,"./fonts/ploticon":494,"./locale-en":546,"./locale-en-us":545,"./plot_api":550,"./plot_api/plot_schema":554,"./plots/plots":628,"./registry":647,"./snapshot":652,"./traces/scatter":948,"./version":1132,"native-promise-only":245}],494:[function(m,G,Y){G.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:["<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'>","<defs>"," <style>","  .cls-0{fill:#000;}","  .cls-1{fill:#FFF;}","  .cls-2{fill:#F26;}","  .cls-3{fill:#D69;}","  .cls-4{fill:#BAC;}","  .cls-5{fill:#9EF;}"," </style>","</defs>"," <title>plotly-logomark</title>"," <g id='symbol'>","  <rect class='cls-0' x='0' y='0' width='132' height='132' rx='18' ry='18'/>","  <circle class='cls-5' cx='102' cy='30' r='6'/>","  <circle class='cls-4' cx='78' cy='30' r='6'/>","  <circle class='cls-4' cx='78' cy='54' r='6'/>","  <circle class='cls-3' cx='54' cy='30' r='6'/>","  <circle class='cls-2' cx='30' cy='30' r='6'/>","  <circle class='cls-2' cx='30' cy='54' r='6'/>","  <path class='cls-1' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/>","  <path class='cls-1' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/>","  <path class='cls-1' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/>","  <path class='cls-1' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/>"," </g>","</svg>"].join("")}}},{}],495:[function(m,G,Y){Y.isLeftAnchor=function(d){return d.xanchor==="left"||d.xanchor==="auto"&&d.x<=1/3},Y.isCenterAnchor=function(d){return d.xanchor==="center"||d.xanchor==="auto"&&d.x>1/3&&d.x<2/3},Y.isRightAnchor=function(d){return d.xanchor==="right"||d.xanchor==="auto"&&d.x>=2/3},Y.isTopAnchor=function(d){return d.yanchor==="top"||d.yanchor==="auto"&&d.y>=2/3},Y.isMiddleAnchor=function(d){return d.yanchor==="middle"||d.yanchor==="auto"&&d.y>1/3&&d.y<2/3},Y.isBottomAnchor=function(d){return d.yanchor==="bottom"||d.yanchor==="auto"&&d.y<=1/3}},{}],496:[function(m,G,Y){var d=m("./mod"),v=d.mod,w=d.modHalf,y=Math.PI,e=2*y;function t(g){return Math.abs(g[1]-g[0])>e-1e-14}function n(g,c){return w(c-g,e)}function o(g,c){if(t(c))return!0;var a,h;c[0]<c[1]?(a=c[0],h=c[1]):(a=c[1],h=c[0]),(a=v(a,e))>(h=v(h,e))&&(h+=e);var l=v(g,e),s=l+e;return l>=a&&l<=h||s>=a&&s<=h}function r(g,c,a,h,l,s,p){l=l||0,s=s||0;var u,i,x,f,_,b=t([a,h]);function T(I,P){return[I*Math.cos(P)+l,s-I*Math.sin(P)]}b?(u=0,i=y,x=e):a<h?(u=a,x=h):(u=h,x=a),g<c?(f=g,_=c):(f=c,_=g);var k,L=Math.abs(x-u)<=y?0:1;function A(I,P,S){return"A"+[I,I]+" "+[0,L,S]+" "+T(I,P)}return b?k=f===null?"M"+T(_,u)+A(_,i,0)+A(_,x,0)+"Z":"M"+T(f,u)+A(f,i,0)+A(f,x,0)+"ZM"+T(_,u)+A(_,i,1)+A(_,x,1)+"Z":f===null?(k="M"+T(_,u)+A(_,x,0),p&&(k+="L0,0Z")):k="M"+T(f,u)+"L"+T(_,u)+A(_,x,0)+"L"+T(f,x)+A(f,u,1)+"Z",k}G.exports={deg2rad:function(g){return g/180*y},rad2deg:function(g){return g/y*180},angleDelta:n,angleDist:function(g,c){return Math.abs(n(g,c))},isFullCircle:t,isAngleInsideSector:o,isPtInsideSector:function(g,c,a,h){return!!o(c,h)&&(a[0]<a[1]?(l=a[0],s=a[1]):(l=a[1],s=a[0]),g>=l&&g<=s);var l,s},pathArc:function(g,c,a,h,l){return r(null,g,c,a,h,l,0)},pathSector:function(g,c,a,h,l){return r(null,g,c,a,h,l,1)},pathAnnulus:function(g,c,a,h,l,s){return r(g,c,a,h,l,s,1)}}},{"./mod":522}],497:[function(m,G,Y){var d=Array.isArray,v=ArrayBuffer,w=DataView;function y(n){return v.isView(n)&&!(n instanceof w)}function e(n){return d(n)||y(n)}function t(n,o,r){if(e(n)){if(e(n[0])){for(var g=r,c=0;c<n.length;c++)g=o(g,n[c].length);return g}return n.length}return 0}Y.isTypedArray=y,Y.isArrayOrTypedArray=e,Y.isArray1D=function(n){return!e(n[0])},Y.ensureArray=function(n,o){return d(n)||(n=[]),n.length=o,n},Y.concat=function(){var n,o,r,g,c,a,h,l,s=[],p=!0,u=0;for(r=0;r<arguments.length;r++)(a=(g=arguments[r]).length)&&(o?s.push(g):(o=g,c=a),d(g)?n=!1:(p=!1,u?n!==g.constructor&&(n=!1):n=g.constructor),u+=a);if(!u)return[];if(!s.length)return o;if(p)return o.concat.apply(o,s);if(n){for((h=new n(u)).set(o),r=0;r<s.length;r++)g=s[r],h.set(g,c),c+=g.length;return h}for(h=new Array(u),l=0;l<o.length;l++)h[l]=o[l];for(r=0;r<s.length;r++){for(g=s[r],l=0;l<g.length;l++)h[c+l]=g[l];c+=l}return h},Y.maxRowLength=function(n){return t(n,Math.max,0)},Y.minRowLength=function(n){return t(n,Math.min,1/0)}},{}],498:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../constants/numerical").BADNUM,w=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;G.exports=function(y){return typeof y=="string"&&(y=y.replace(w,"")),d(y)?Number(y):v}},{"../constants/numerical":491,"fast-isnumeric":190}],499:[function(m,G,Y){G.exports=function(d){var v=d._fullLayout;v._glcanvas&&v._glcanvas.size()&&v._glcanvas.each(function(w){w.regl&&w.regl.clear({color:!0,depth:!0})})}},{}],500:[function(m,G,Y){G.exports=function(d){d._responsiveChartHandler&&(window.removeEventListener("resize",d._responsiveChartHandler),delete d._responsiveChartHandler)}},{}],501:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("tinycolor2"),w=m("../plots/attributes"),y=m("../components/colorscale/scales"),e=m("../components/color"),t=m("../constants/interactions").DESELECTDIM,n=m("./nested_property"),o=m("./regex").counter,r=m("./mod").modHalf,g=m("./array").isArrayOrTypedArray;function c(a,h){var l=Y.valObjectMeta[h.valType];if(h.arrayOk&&g(a))return!0;if(l.validateFunction)return l.validateFunction(a,h);var s={},p=s,u={set:function(i){p=i}};return l.coerceFunction(a,u,s,h),p!==s}Y.valObjectMeta={data_array:{coerceFunction:function(a,h,l){g(a)?h.set(a):l!==void 0&&h.set(l)}},enumerated:{coerceFunction:function(a,h,l,s){s.coerceNumber&&(a=+a),s.values.indexOf(a)===-1?h.set(l):h.set(a)},validateFunction:function(a,h){h.coerceNumber&&(a=+a);for(var l=h.values,s=0;s<l.length;s++){var p=String(l[s]);if(p.charAt(0)==="/"&&p.charAt(p.length-1)==="/"){if(new RegExp(p.substr(1,p.length-2)).test(a))return!0}else if(a===l[s])return!0}return!1}},boolean:{coerceFunction:function(a,h,l){a===!0||a===!1?h.set(a):h.set(l)}},number:{coerceFunction:function(a,h,l,s){!d(a)||s.min!==void 0&&a<s.min||s.max!==void 0&&a>s.max?h.set(l):h.set(+a)}},integer:{coerceFunction:function(a,h,l,s){a%1||!d(a)||s.min!==void 0&&a<s.min||s.max!==void 0&&a>s.max?h.set(l):h.set(+a)}},string:{coerceFunction:function(a,h,l,s){if(typeof a!="string"){var p=typeof a=="number";s.strict!==!0&&p?h.set(String(a)):h.set(l)}else s.noBlank&&!a?h.set(l):h.set(a)}},color:{coerceFunction:function(a,h,l){v(a).isValid()?h.set(a):h.set(l)}},colorlist:{coerceFunction:function(a,h,l){Array.isArray(a)&&a.length&&a.every(function(s){return v(s).isValid()})?h.set(a):h.set(l)}},colorscale:{coerceFunction:function(a,h,l){h.set(y.get(a,l))}},angle:{coerceFunction:function(a,h,l){a==="auto"?h.set("auto"):d(a)?h.set(r(+a,360)):h.set(l)}},subplotid:{coerceFunction:function(a,h,l,s){var p=s.regex||o(l);typeof a=="string"&&p.test(a)?h.set(a):h.set(l)},validateFunction:function(a,h){var l=h.dflt;return a===l||typeof a=="string"&&!!o(l).test(a)}},flaglist:{coerceFunction:function(a,h,l,s){if((s.extras||[]).indexOf(a)===-1)if(typeof a=="string"){for(var p=a.split("+"),u=0;u<p.length;){var i=p[u];s.flags.indexOf(i)===-1||p.indexOf(i)<u?p.splice(u,1):u++}p.length?h.set(p.join("+")):h.set(l)}else h.set(l);else h.set(a)}},any:{coerceFunction:function(a,h,l){a===void 0?h.set(l):h.set(a)}},info_array:{coerceFunction:function(a,h,l,s){function p(E,z,D){var j,V={set:function(Z){j=Z}};return D===void 0&&(D=z.dflt),Y.valObjectMeta[z.valType].coerceFunction(E,V,D,z),j}var u=s.dimensions===2||s.dimensions==="1-2"&&Array.isArray(a)&&Array.isArray(a[0]);if(Array.isArray(a)){var i,x,f,_,b,T,k=s.items,L=[],A=Array.isArray(k),I=A&&u&&Array.isArray(k[0]),P=u&&A&&!I,S=A&&!P?k.length:a.length;if(l=Array.isArray(l)?l:[],u)for(i=0;i<S;i++)for(L[i]=[],f=Array.isArray(a[i])?a[i]:[],b=P?k.length:A?k[i].length:f.length,x=0;x<b;x++)_=P?k[x]:A?k[i][x]:k,(T=p(f[x],_,(l[i]||[])[x]))!==void 0&&(L[i][x]=T);else for(i=0;i<S;i++)(T=p(a[i],A?k[i]:k,l[i]))!==void 0&&(L[i]=T);h.set(L)}else h.set(l)},validateFunction:function(a,h){if(!Array.isArray(a))return!1;var l=h.items,s=Array.isArray(l),p=h.dimensions===2;if(!h.freeLength&&a.length!==l.length)return!1;for(var u=0;u<a.length;u++)if(p){if(!Array.isArray(a[u])||!h.freeLength&&a[u].length!==l[u].length)return!1;for(var i=0;i<a[u].length;i++)if(!c(a[u][i],s?l[u][i]:l))return!1}else if(!c(a[u],s?l[u]:l))return!1;return!0}}},Y.coerce=function(a,h,l,s,p){var u=n(l,s).get(),i=n(a,s),x=n(h,s),f=i.get(),_=h._template;if(f===void 0&&_&&(f=n(_,s).get(),_=0),p===void 0&&(p=u.dflt),u.arrayOk&&g(f))return x.set(f),f;var b=Y.valObjectMeta[u.valType].coerceFunction;b(f,x,p,u);var T=x.get();return _&&T===p&&!c(f,u)&&(b(f=n(_,s).get(),x,p,u),T=x.get()),T},Y.coerce2=function(a,h,l,s,p){var u=n(a,s),i=Y.coerce(a,h,l,s,p),x=u.get();return x!=null&&i},Y.coerceFont=function(a,h,l){var s={};return l=l||{},s.family=a(h+".family",l.family),s.size=a(h+".size",l.size),s.color=a(h+".color",l.color),s},Y.coercePattern=function(a,h,l,s){if(a(h+".shape")){a(h+".solidity"),a(h+".size");var p=a(h+".fillmode")==="overlay";if(!s){var u=a(h+".bgcolor",p?l:void 0);a(h+".fgcolor",p?e.contrast(u):l)}a(h+".fgopacity",p?.5:1)}},Y.coerceHoverinfo=function(a,h,l){var s,p=h._module.attributes,u=p.hoverinfo?p:w,i=u.hoverinfo;if(l._dataLength===1){var x=i.dflt==="all"?i.flags.slice():i.dflt.split("+");x.splice(x.indexOf("name"),1),s=x.join("+")}return Y.coerce(a,h,u,"hoverinfo",s)},Y.coerceSelectionMarkerOpacity=function(a,h){if(a.marker){var l,s,p=a.marker.opacity;p!==void 0&&(g(p)||a.selected||a.unselected||(l=p,s=t*p),h("selected.marker.opacity",l),h("unselected.marker.opacity",s))}},Y.validate=c},{"../components/color":367,"../components/colorscale/scales":382,"../constants/interactions":490,"../plots/attributes":562,"./array":497,"./mod":522,"./nested_property":523,"./regex":532,"fast-isnumeric":190,tinycolor2:313}],502:[function(m,G,Y){var d,v,w=m("d3-time-format").timeFormat,y=m("fast-isnumeric"),e=m("./loggers"),t=m("./mod").mod,n=m("../constants/numerical"),o=n.BADNUM,r=n.ONEDAY,g=n.ONEHOUR,c=n.ONEMIN,a=n.ONESEC,h=n.EPOCHJD,l=m("../registry"),s=m("d3-time-format").utcFormat,p=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,u=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,i=new Date().getFullYear()-70;function x(z){return z&&l.componentsRegistry.calendars&&typeof z=="string"&&z!=="gregorian"}function f(z,D){return String(z+Math.pow(10,D)).substr(1)}Y.dateTick0=function(z,D){var j=function(Z,Q){return x(Z)?Q?l.getComponentMethod("calendars","CANONICAL_SUNDAY")[Z]:l.getComponentMethod("calendars","CANONICAL_TICK")[Z]:Q?"2000-01-02":"2000-01-01"}(z,!!D);if(D<2)return j;var V=Y.dateTime2ms(j,z);return V+=r*(D-1),Y.ms2DateTime(V,0,z)},Y.dfltRange=function(z){return x(z)?l.getComponentMethod("calendars","DFLTRANGE")[z]:["2000-01-01","2001-01-01"]},Y.isJSDate=function(z){return typeof z=="object"&&z!==null&&typeof z.getTime=="function"},Y.dateTime2ms=function(z,D){if(Y.isJSDate(z)){var j=z.getTimezoneOffset()*c,V=(z.getUTCMinutes()-z.getMinutes())*c+(z.getUTCSeconds()-z.getSeconds())*a+(z.getUTCMilliseconds()-z.getMilliseconds());if(V){var Z=3*c;j=j-Z/2+t(V-j+Z/2,Z)}return(z=Number(z)-j)>=d&&z<=v?z:o}if(typeof z!="string"&&typeof z!="number")return o;z=String(z);var Q=x(D),X=z.charAt(0);!Q||X!=="G"&&X!=="g"||(z=z.substr(1),D="");var $=Q&&D.substr(0,7)==="chinese",re=z.match($?u:p);if(!re)return o;var H=re[1],N=re[3]||"1",U=Number(re[5]||1),te=Number(re[7]||0),B=Number(re[9]||0),K=Number(re[11]||0);if(Q){if(H.length===2)return o;var J;H=Number(H);try{var ee=l.getComponentMethod("calendars","getCal")(D);if($){var ne=N.charAt(N.length-1)==="i";N=parseInt(N,10),J=ee.newDate(H,ee.toMonthIndex(H,N,ne),U)}else J=ee.newDate(H,Number(N),U)}catch{return o}return J?(J.toJD()-h)*r+te*g+B*c+K*a:o}H=H.length===2?(Number(H)+2e3-i)%100+i:Number(H),N-=1;var se=new Date(Date.UTC(2e3,N,U,te,B));return se.setUTCFullYear(H),se.getUTCMonth()!==N||se.getUTCDate()!==U?o:se.getTime()+K*a},d=Y.MIN_MS=Y.dateTime2ms("-9999"),v=Y.MAX_MS=Y.dateTime2ms("9999-12-31 23:59:59.9999"),Y.isDateTime=function(z,D){return Y.dateTime2ms(z,D)!==o};var _=90*r,b=3*g,T=5*c;function k(z,D,j,V,Z){if((D||j||V||Z)&&(z+=" "+f(D,2)+":"+f(j,2),(V||Z)&&(z+=":"+f(V,2),Z))){for(var Q=4;Z%10==0;)Q-=1,Z/=10;z+="."+f(Z,Q)}return z}Y.ms2DateTime=function(z,D,j){if(typeof z!="number"||!(z>=d&&z<=v))return o;D||(D=0);var V,Z,Q,X,$,re,H=Math.floor(10*t(z+.05,1)),N=Math.round(z-H/10);if(x(j)){var U=Math.floor(N/r)+h,te=Math.floor(t(z,r));try{V=l.getComponentMethod("calendars","getCal")(j).fromJD(U).formatDate("yyyy-mm-dd")}catch{V=s("G%Y-%m-%d")(new Date(N))}if(V.charAt(0)==="-")for(;V.length<11;)V="-0"+V.substr(1);else for(;V.length<10;)V="0"+V;Z=D<_?Math.floor(te/g):0,Q=D<_?Math.floor(te%g/c):0,X=D<b?Math.floor(te%c/a):0,$=D<T?te%a*10+H:0}else re=new Date(N),V=s("%Y-%m-%d")(re),Z=D<_?re.getUTCHours():0,Q=D<_?re.getUTCMinutes():0,X=D<b?re.getUTCSeconds():0,$=D<T?10*re.getUTCMilliseconds()+H:0;return k(V,Z,Q,X,$)},Y.ms2DateTimeLocal=function(z){if(!(z>=d+r&&z<=v-r))return o;var D=Math.floor(10*t(z+.05,1)),j=new Date(Math.round(z-D/10));return k(w("%Y-%m-%d")(j),j.getHours(),j.getMinutes(),j.getSeconds(),10*j.getUTCMilliseconds()+D)},Y.cleanDate=function(z,D,j){if(z===o)return D;if(Y.isJSDate(z)||typeof z=="number"&&isFinite(z)){if(x(j))return e.error("JS Dates and milliseconds are incompatible with world calendars",z),D;if(!(z=Y.ms2DateTimeLocal(+z))&&D!==void 0)return D}else if(!Y.isDateTime(z,j))return e.error("unrecognized date",z),D;return z};var L=/%\d?f/g,A=/%h/g,I={1:"1",2:"1",3:"2",4:"2"};function P(z,D,j,V){z=z.replace(L,function(Q){var X=Math.min(+Q.charAt(1)||6,6);return(D/1e3%1+2).toFixed(X).substr(2).replace(/0+$/,"")||"0"});var Z=new Date(Math.floor(D+.05));if(z=z.replace(A,function(){return I[j("%q")(Z)]}),x(V))try{z=l.getComponentMethod("calendars","worldCalFmt")(z,D,V)}catch{return"Invalid"}return j(z)(Z)}var S=[59,59.9,59.99,59.999,59.9999];Y.formatDate=function(z,D,j,V,Z,Q){if(Z=x(Z)&&Z,!D)if(j==="y")D=Q.year;else if(j==="m")D=Q.month;else{if(j!=="d")return function(X,$){var re=t(X+.05,r),H=f(Math.floor(re/g),2)+":"+f(t(Math.floor(re/c),60),2);if($!=="M"){y($)||($=0);var N=(100+Math.min(t(X/a,60),S[$])).toFixed($).substr(1);$>0&&(N=N.replace(/0+$/,"").replace(/[\.]$/,"")),H+=":"+N}return H}(z,j)+`
`+P(Q.dayMonthYear,z,V,Z);D=Q.dayMonth+`
`+Q.year}return P(D,z,V,Z)};var E=3*r;Y.incrementMonth=function(z,D,j){j=x(j)&&j;var V=t(z,r);if(z=Math.round(z-V),j)try{var Z=Math.round(z/r)+h,Q=l.getComponentMethod("calendars","getCal")(j),X=Q.fromJD(Z);return D%12?Q.add(X,D,"m"):Q.add(X,D/12,"y"),(X.toJD()-h)*r+V}catch{e.error("invalid ms "+z+" in calendar "+j)}var $=new Date(z+E);return $.setUTCMonth($.getUTCMonth()+D)+V-E},Y.findExactDates=function(z,D){for(var j,V,Z=0,Q=0,X=0,$=0,re=x(D)&&l.getComponentMethod("calendars","getCal")(D),H=0;H<z.length;H++)if(V=z[H],y(V)){if(!(V%r))if(re)try{(j=re.fromJD(V/r+h)).day()===1?j.month()===1?Z++:Q++:X++}catch{}else(j=new Date(V)).getUTCDate()===1?j.getUTCMonth()===0?Z++:Q++:X++}else $++;X+=Q+=Z;var N=z.length-$;return{exactYears:Z/N,exactMonths:Q/N,exactDays:X/N}}},{"../constants/numerical":491,"../registry":647,"./loggers":519,"./mod":522,"d3-time-format":120,"fast-isnumeric":190}],503:[function(m,G,Y){var d=m("@plotly/d3"),v=m("./loggers"),w=m("./matrix"),y=m("gl-mat4");function e(g){var c=g&&g.parentNode;c&&c.removeChild(g)}function t(g,c,a){var h="plotly.js-style-"+g,l=document.getElementById(h);l||((l=document.createElement("style")).setAttribute("id",h),l.appendChild(document.createTextNode("")),document.head.appendChild(l));var s=l.sheet;s.insertRule?s.insertRule(c+"{"+a+"}",0):s.addRule?s.addRule(c,a,0):v.warn("addStyleRule failed")}function n(g){var c=window.getComputedStyle(g,null),a=c.getPropertyValue("-webkit-transform")||c.getPropertyValue("-moz-transform")||c.getPropertyValue("-ms-transform")||c.getPropertyValue("-o-transform")||c.getPropertyValue("transform");return a==="none"?null:a.replace("matrix","").replace("3d","").slice(1,-1).split(",").map(function(h){return+h})}function o(g){for(var c=[];r(g);)c.push(g),g=g.parentNode;return c}function r(g){return g&&(g instanceof Element||g instanceof HTMLElement)}G.exports={getGraphDiv:function(g){var c;if(typeof g=="string"){if((c=document.getElementById(g))===null)throw new Error("No DOM element with id '"+g+"' exists on the page.");return c}if(g==null)throw new Error("DOM element provided is null or undefined");return g},isPlotDiv:function(g){var c=d.select(g);return c.node()instanceof HTMLElement&&c.size()&&c.classed("js-plotly-plot")},removeElement:e,addStyleRule:function(g,c){t("global",g,c)},addRelatedStyleRule:t,deleteRelatedStyleRule:function(g){var c="plotly.js-style-"+g,a=document.getElementById(c);a&&e(a)},getFullTransformMatrix:function(g){var c=o(g),a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return c.forEach(function(h){var l=n(h);if(l){var s=w.convertCssMatrix(l);a=y.multiply(a,a,s)}}),a},getElementTransformMatrix:n,getElementAndAncestors:o,equalDomRects:function(g,c){return g&&c&&g.x===c.x&&g.y===c.y&&g.top===c.top&&g.left===c.left&&g.right===c.right&&g.bottom===c.bottom}}},{"./loggers":519,"./matrix":521,"@plotly/d3":58,"gl-mat4":210}],504:[function(m,G,Y){var d=m("events").EventEmitter,v={init:function(w){if(w._ev instanceof d)return w;var y=new d,e=new d;return w._ev=y,w._internalEv=e,w.on=y.on.bind(y),w.once=y.once.bind(y),w.removeListener=y.removeListener.bind(y),w.removeAllListeners=y.removeAllListeners.bind(y),w._internalOn=e.on.bind(e),w._internalOnce=e.once.bind(e),w._removeInternalListener=e.removeListener.bind(e),w._removeAllInternalListeners=e.removeAllListeners.bind(e),w.emit=function(t,n){typeof jQuery<"u"&&jQuery(w).trigger(t,n),y.emit(t,n),e.emit(t,n)},w},triggerHandler:function(w,y,e){var t,n;typeof jQuery<"u"&&(t=jQuery(w).triggerHandler(y,e));var o=w._ev;if(!o)return t;var r,g=o._events[y];if(!g)return t;function c(a){return a.listener?(o.removeListener(y,a.listener),a.fired?void 0:(a.fired=!0,a.listener.apply(o,[e]))):a.apply(o,[e])}for(g=Array.isArray(g)?g:[g],r=0;r<g.length-1;r++)c(g[r]);return n=c(g[r]),t!==void 0?t:n},purge:function(w){return delete w._ev,delete w.on,delete w.once,delete w.removeListener,delete w.removeAllListeners,delete w.emit,delete w._ev,delete w._internalEv,delete w._internalOn,delete w._internalOnce,delete w._removeInternalListener,delete w._removeAllInternalListeners,w}};G.exports=v},{events:84}],505:[function(m,G,Y){var d=m("./is_plain_object.js"),v=Array.isArray;function w(y,e,t,n){var o,r,g,c,a,h,l=y[0],s=y.length;if(s===2&&v(l)&&v(y[1])&&l.length===0){if(function(u,i){var x,f;for(x=0;x<u.length;x++){if((f=u[x])!==null&&typeof f=="object")return!1;f!==void 0&&(i[x]=f)}return!0}(y[1],l))return l;l.splice(0,l.length)}for(var p=1;p<s;p++)for(r in o=y[p])g=l[r],c=o[r],n&&v(c)?l[r]=c:e&&c&&(d(c)||(a=v(c)))?(a?(a=!1,h=g&&v(g)?g:[]):h=g&&d(g)?g:{},l[r]=w([h,c],e,t,n)):(c!==void 0||t)&&(l[r]=c);return l}Y.extendFlat=function(){return w(arguments,!1,!1,!1)},Y.extendDeep=function(){return w(arguments,!0,!1,!1)},Y.extendDeepAll=function(){return w(arguments,!0,!0,!1)},Y.extendDeepNoArrays=function(){return w(arguments,!0,!1,!0)}},{"./is_plain_object.js":516}],506:[function(m,G,Y){G.exports=function(d){for(var v={},w=[],y=0,e=0;e<d.length;e++){var t=d[e];v[t]!==1&&(v[t]=1,w[y++]=t)}return w}},{}],507:[function(m,G,Y){function d(w){return w.visible===!0}function v(w){var y=w[0].trace;return y.visible===!0&&y._length!==0}G.exports=function(w){for(var y,e=(y=w,Array.isArray(y)&&Array.isArray(y[0])&&y[0][0]&&y[0][0].trace?v:d),t=[],n=0;n<w.length;n++){var o=w[n];e(o)&&t.push(o)}return t}},{}],508:[function(m,G,Y){var d=m("@plotly/d3"),v=m("country-regex"),w=m("@turf/area"),y=m("@turf/centroid"),e=m("@turf/bbox"),t=m("./identity"),n=m("./loggers"),o=m("./is_plain_object"),r=m("./nested_property"),g=m("./polygon"),c=Object.keys(v),a={"ISO-3":t,"USA-states":t,"country names":function(l){for(var s=0;s<c.length;s++){var p=c[s];if(new RegExp(v[p]).test(l.trim().toLowerCase()))return p}return n.log("Unrecognized country name: "+l+"."),!1}};function h(l){var s=l.geojson,p=window.PlotlyGeoAssets||{},u=typeof s=="string"?p[s]:s;return o(u)?u:(n.error("Oops ... something went wrong when fetching "+s),!1)}G.exports={locationToFeature:function(l,s,p){if(!s||typeof s!="string")return!1;var u,i,x,f=a[l](s);if(f){if(l==="USA-states")for(u=[],x=0;x<p.length;x++)(i=p[x]).properties&&i.properties.gu&&i.properties.gu==="USA"&&u.push(i);else u=p;for(x=0;x<u.length;x++)if((i=u[x]).id===f)return i;n.log(["Location with id",f,"does not have a matching topojson feature at this resolution."].join(" "))}return!1},feature2polygons:function(l){var s,p,u,i,x=l.geometry,f=x.coordinates,_=l.id,b=[];function T(k){for(var L=0;L<k.length-1;L++)if(k[L][0]>0&&k[L+1][0]<0)return L;return null}switch(s=_==="RUS"||_==="FJI"?function(k){var L;if(T(k)===null)L=k;else for(L=new Array(k.length),i=0;i<k.length;i++)L[i]=[k[i][0]<0?k[i][0]+360:k[i][0],k[i][1]];b.push(g.tester(L))}:_==="ATA"?function(k){var L=T(k);if(L===null)return b.push(g.tester(k));var A=new Array(k.length+1),I=0;for(i=0;i<k.length;i++)i>L?A[I++]=[k[i][0]+360,k[i][1]]:i===L?(A[I++]=k[i],A[I++]=[k[i][0],-90]):A[I++]=k[i];var P=g.tester(A);P.pts.pop(),b.push(P)}:function(k){b.push(g.tester(k))},x.type){case"MultiPolygon":for(p=0;p<f.length;p++)for(u=0;u<f[p].length;u++)s(f[p][u]);break;case"Polygon":for(p=0;p<f.length;p++)s(f[p])}return b},getTraceGeojson:h,extractTraceFeature:function(l){var s=l[0].trace,p=h(s);if(!p)return!1;var u,i={},x=[];for(u=0;u<s._length;u++){var f=l[u];(f.loc||f.loc===0)&&(i[f.loc]=f)}function _(k){var L=r(k,s.featureidkey||"id").get(),A=i[L];if(A){var I=k.geometry;if(I.type==="Polygon"||I.type==="MultiPolygon"){var P={type:"Feature",id:L,geometry:I,properties:{}};P.properties.ct=function(S){var E,z=S.geometry;if(z.type==="MultiPolygon")for(var D=z.coordinates,j=0,V=0;V<D.length;V++){var Z={type:"Polygon",coordinates:D[V]},Q=w.default(Z);Q>j&&(j=Q,E=Z)}else E=z;return y.default(E).geometry.coordinates}(P),A.fIn=k,A.fOut=P,x.push(P)}else n.log(["Location",A.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}delete i[L]}switch(p.type){case"FeatureCollection":var b=p.features;for(u=0;u<b.length;u++)_(b[u]);break;case"Feature":_(p);break;default:return n.warn(["Invalid GeoJSON type",(p.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" ")),!1}for(var T in i)n.log(["Location *"+T+"*","does not have a matching feature with id-key","*"+s.featureidkey+"*."].join(" "));return x},fetchTraceGeoData:function(l){var s=window.PlotlyGeoAssets||{},p=[];function u(_){return new Promise(function(b,T){d.json(_,function(k,L){if(k){delete s[_];var A=k.status===404?'GeoJSON at URL "'+_+'" does not exist.':"Unexpected error while fetching from "+_;return T(new Error(A))}return s[_]=L,b(L)})})}function i(_){return new Promise(function(b,T){var k=0,L=setInterval(function(){return s[_]&&s[_]!=="pending"?(clearInterval(L),b(s[_])):k>100?(clearInterval(L),T("Unexpected error while fetching from "+_)):void k++},50)})}for(var x=0;x<l.length;x++){var f=l[x][0].trace.geojson;typeof f=="string"&&(s[f]?s[f]==="pending"&&p.push(i(f)):(s[f]="pending",p.push(u(f))))}return p},computeBbox:function(l){return e.default(l)}}},{"./identity":513,"./is_plain_object":516,"./loggers":519,"./nested_property":523,"./polygon":527,"@plotly/d3":58,"@turf/area":61,"@turf/bbox":64,"@turf/centroid":67,"country-regex":94}],509:[function(m,G,Y){var d=m("../constants/numerical").BADNUM;Y.calcTraceToLineCoords=function(v){for(var w=v[0].trace.connectgaps,y=[],e=[],t=0;t<v.length;t++){var n=v[t].lonlat;n[0]!==d?e.push(n):!w&&e.length>0&&(y.push(e),e=[])}return e.length>0&&y.push(e),y},Y.makeLine=function(v){return v.length===1?{type:"LineString",coordinates:v[0]}:{type:"MultiLineString",coordinates:v}},Y.makePolygon=function(v){if(v.length===1)return{type:"Polygon",coordinates:v};for(var w=new Array(v.length),y=0;y<v.length;y++)w[y]=[v[y]];return{type:"MultiPolygon",coordinates:w}},Y.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":491}],510:[function(m,G,Y){var d,v,w,y=m("./mod").mod;function e(n,o,r,g,c,a,h,l){var s=r-n,p=c-n,u=h-c,i=g-o,x=a-o,f=l-a,_=s*f-u*i;if(_===0)return null;var b=(p*f-u*x)/_,T=(p*i-s*x)/_;return T<0||T>1||b<0||b>1?null:{x:n+s*b,y:o+i*b}}function t(n,o,r,g,c){var a=g*n+c*o;if(a<0)return g*g+c*c;if(a>r){var h=g-n,l=c-o;return h*h+l*l}var s=g*o-c*n;return s*s/r}Y.segmentsIntersect=e,Y.segmentDistance=function(n,o,r,g,c,a,h,l){if(e(n,o,r,g,c,a,h,l))return 0;var s=r-n,p=g-o,u=h-c,i=l-a,x=s*s+p*p,f=u*u+i*i,_=Math.min(t(s,p,x,c-n,a-o),t(s,p,x,h-n,l-o),t(u,i,f,n-c,o-a),t(u,i,f,r-c,g-a));return Math.sqrt(_)},Y.getTextLocation=function(n,o,r,g){if(n===v&&g===w||(d={},v=n,w=g),d[r])return d[r];var c=n.getPointAtLength(y(r-g/2,o)),a=n.getPointAtLength(y(r+g/2,o)),h=Math.atan((a.y-c.y)/(a.x-c.x)),l=n.getPointAtLength(y(r,o)),s={x:(4*l.x+c.x+a.x)/6,y:(4*l.y+c.y+a.y)/6,theta:h};return d[r]=s,s},Y.clearLocationCache=function(){v=null},Y.getVisibleSegment=function(n,o,r){var g,c,a=o.left,h=o.right,l=o.top,s=o.bottom,p=0,u=n.getTotalLength(),i=u;function x(_){var b=n.getPointAtLength(_);_===0?g=b:_===u&&(c=b);var T=b.x<a?a-b.x:b.x>h?b.x-h:0,k=b.y<l?l-b.y:b.y>s?b.y-s:0;return Math.sqrt(T*T+k*k)}for(var f=x(p);f;){if((p+=f+r)>i)return;f=x(p)}for(f=x(i);f;){if(p>(i-=f+r))return;f=x(i)}return{min:p,max:i,len:i-p,total:u,isClosed:p===0&&i===u&&Math.abs(g.x-c.x)<.1&&Math.abs(g.y-c.y)<.1}},Y.findPointOnPath=function(n,o,r,g){for(var c,a,h,l=(g=g||{}).pathLength||n.getTotalLength(),s=g.tolerance||.001,p=g.iterationLimit||30,u=n.getPointAtLength(0)[r]>n.getPointAtLength(l)[r]?-1:1,i=0,x=0,f=l;i<p;){if(c=(x+f)/2,h=(a=n.getPointAtLength(c))[r]-o,Math.abs(h)<s)return a;u*h>0?f=c:x=c,i++}return a}},{"./mod":522}],511:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("tinycolor2"),w=m("color-normalize"),y=m("../components/colorscale"),e=m("../components/color/attributes").defaultLine,t=m("./array").isArrayOrTypedArray,n=w(e);function o(c,a){var h=c;return h[3]*=a,h}function r(c){if(d(c))return n;var a=w(c);return a.length?a:n}function g(c){return d(c)?c:1}G.exports={formatColor:function(c,a,h){var l,s,p,u,i,x=c.color,f=t(x),_=t(a),b=y.extractOpts(c),T=[];if(l=b.colorscale!==void 0?y.makeColorScaleFuncFromTrace(c):r,s=f?function(L,A){return L[A]===void 0?n:w(l(L[A]))}:r,p=_?function(L,A){return L[A]===void 0?1:g(L[A])}:g,f||_)for(var k=0;k<h;k++)u=s(x,k),i=p(a,k),T[k]=o(u,i);else T=o(w(x),a);return T},parseColorScale:function(c){var a=y.extractOpts(c),h=a.colorscale;return a.reversescale&&(h=y.flipScale(a.colorscale)),h.map(function(l){var s=l[0],p=v(l[1]).toRgb();return{index:s,rgb:[p.r,p.g,p.b,p.a]}})}}},{"../components/color/attributes":366,"../components/colorscale":379,"./array":497,"color-normalize":89,"fast-isnumeric":190,tinycolor2:313}],512:[function(m,G,Y){var d=m("./identity");function v(w){return[w]}G.exports={keyFun:function(w){return w.key},repeat:v,descend:d,wrap:v,unwrap:function(w){return w[0]}}},{"./identity":513}],513:[function(m,G,Y){G.exports=function(d){return d}},{}],514:[function(m,G,Y){G.exports=function(d,v){if(!v)return d;var w=1/Math.abs(v),y=w>1?(w*d+w*v)/w:d+v,e=String(y).length;if(e>16){var t=String(v).length;if(e>=String(d).length+t){var n=parseFloat(y).toPrecision(12);n.indexOf("e+")===-1&&(y=+n)}}return y}},{}],515:[function(m,G,Y){var d=m("@plotly/d3"),v=m("d3-time-format").utcFormat,w=m("d3-format").format,y=m("fast-isnumeric"),e=m("../constants/numerical"),t=e.FP_SAFE,n=-t,o=e.BADNUM,r=G.exports={};r.adjustFormat=function(H){return!H||/^\d[.]\df/.test(H)||/[.]\d%/.test(H)?H:H==="0.f"?"~f":/^\d%/.test(H)?"~%":/^\ds/.test(H)?"~s":!/^[~,.0$]/.test(H)&&/[&fps]/.test(H)?"~"+H:H};var g={};r.warnBadFormat=function(H){var N=String(H);g[N]||(g[N]=1,r.warn('encountered bad format: "'+N+'"'))},r.noFormat=function(H){return String(H)},r.numberFormat=function(H){var N;try{N=w(r.adjustFormat(H))}catch{return r.warnBadFormat(H),r.noFormat}return N},r.nestedProperty=m("./nested_property"),r.keyedContainer=m("./keyed_container"),r.relativeAttr=m("./relative_attr"),r.isPlainObject=m("./is_plain_object"),r.toLogRange=m("./to_log_range"),r.relinkPrivateKeys=m("./relink_private");var c=m("./array");r.isTypedArray=c.isTypedArray,r.isArrayOrTypedArray=c.isArrayOrTypedArray,r.isArray1D=c.isArray1D,r.ensureArray=c.ensureArray,r.concat=c.concat,r.maxRowLength=c.maxRowLength,r.minRowLength=c.minRowLength;var a=m("./mod");r.mod=a.mod,r.modHalf=a.modHalf;var h=m("./coerce");r.valObjectMeta=h.valObjectMeta,r.coerce=h.coerce,r.coerce2=h.coerce2,r.coerceFont=h.coerceFont,r.coercePattern=h.coercePattern,r.coerceHoverinfo=h.coerceHoverinfo,r.coerceSelectionMarkerOpacity=h.coerceSelectionMarkerOpacity,r.validate=h.validate;var l=m("./dates");r.dateTime2ms=l.dateTime2ms,r.isDateTime=l.isDateTime,r.ms2DateTime=l.ms2DateTime,r.ms2DateTimeLocal=l.ms2DateTimeLocal,r.cleanDate=l.cleanDate,r.isJSDate=l.isJSDate,r.formatDate=l.formatDate,r.incrementMonth=l.incrementMonth,r.dateTick0=l.dateTick0,r.dfltRange=l.dfltRange,r.findExactDates=l.findExactDates,r.MIN_MS=l.MIN_MS,r.MAX_MS=l.MAX_MS;var s=m("./search");r.findBin=s.findBin,r.sorterAsc=s.sorterAsc,r.sorterDes=s.sorterDes,r.distinctVals=s.distinctVals,r.roundUp=s.roundUp,r.sort=s.sort,r.findIndexOfMin=s.findIndexOfMin,r.sortObjectKeys=m("./sort_object_keys");var p=m("./stats");r.aggNums=p.aggNums,r.len=p.len,r.mean=p.mean,r.median=p.median,r.midRange=p.midRange,r.variance=p.variance,r.stdev=p.stdev,r.interp=p.interp;var u=m("./matrix");r.init2dArray=u.init2dArray,r.transposeRagged=u.transposeRagged,r.dot=u.dot,r.translationMatrix=u.translationMatrix,r.rotationMatrix=u.rotationMatrix,r.rotationXYMatrix=u.rotationXYMatrix,r.apply3DTransform=u.apply3DTransform,r.apply2DTransform=u.apply2DTransform,r.apply2DTransform2=u.apply2DTransform2,r.convertCssMatrix=u.convertCssMatrix,r.inverseTransformMatrix=u.inverseTransformMatrix;var i=m("./angles");r.deg2rad=i.deg2rad,r.rad2deg=i.rad2deg,r.angleDelta=i.angleDelta,r.angleDist=i.angleDist,r.isFullCircle=i.isFullCircle,r.isAngleInsideSector=i.isAngleInsideSector,r.isPtInsideSector=i.isPtInsideSector,r.pathArc=i.pathArc,r.pathSector=i.pathSector,r.pathAnnulus=i.pathAnnulus;var x=m("./anchor_utils");r.isLeftAnchor=x.isLeftAnchor,r.isCenterAnchor=x.isCenterAnchor,r.isRightAnchor=x.isRightAnchor,r.isTopAnchor=x.isTopAnchor,r.isMiddleAnchor=x.isMiddleAnchor,r.isBottomAnchor=x.isBottomAnchor;var f=m("./geometry2d");r.segmentsIntersect=f.segmentsIntersect,r.segmentDistance=f.segmentDistance,r.getTextLocation=f.getTextLocation,r.clearLocationCache=f.clearLocationCache,r.getVisibleSegment=f.getVisibleSegment,r.findPointOnPath=f.findPointOnPath;var _=m("./extend");r.extendFlat=_.extendFlat,r.extendDeep=_.extendDeep,r.extendDeepAll=_.extendDeepAll,r.extendDeepNoArrays=_.extendDeepNoArrays;var b=m("./loggers");r.log=b.log,r.warn=b.warn,r.error=b.error;var T=m("./regex");r.counterRegex=T.counter;var k=m("./throttle");r.throttle=k.throttle,r.throttleDone=k.done,r.clearThrottle=k.clear;var L=m("./dom");function A(H){var N={};for(var U in H)for(var te=H[U],B=0;B<te.length;B++)N[te[B]]=+U;return N}r.getGraphDiv=L.getGraphDiv,r.isPlotDiv=L.isPlotDiv,r.removeElement=L.removeElement,r.addStyleRule=L.addStyleRule,r.addRelatedStyleRule=L.addRelatedStyleRule,r.deleteRelatedStyleRule=L.deleteRelatedStyleRule,r.getFullTransformMatrix=L.getFullTransformMatrix,r.getElementTransformMatrix=L.getElementTransformMatrix,r.getElementAndAncestors=L.getElementAndAncestors,r.equalDomRects=L.equalDomRects,r.clearResponsive=m("./clear_responsive"),r.preserveDrawingBuffer=m("./preserve_drawing_buffer"),r.makeTraceGroups=m("./make_trace_groups"),r._=m("./localize"),r.notifier=m("./notifier"),r.filterUnique=m("./filter_unique"),r.filterVisible=m("./filter_visible"),r.pushUnique=m("./push_unique"),r.increment=m("./increment"),r.cleanNumber=m("./clean_number"),r.ensureNumber=function(H){return y(H)?(H=Number(H))>t||H<n?o:H:o},r.isIndex=function(H,N){return!(N!==void 0&&H>=N)&&y(H)&&H>=0&&H%1==0},r.noop=m("./noop"),r.identity=m("./identity"),r.repeat=function(H,N){for(var U=new Array(N),te=0;te<N;te++)U[te]=H;return U},r.swapAttrs=function(H,N,U,te){U||(U="x"),te||(te="y");for(var B=0;B<N.length;B++){var K=N[B],J=r.nestedProperty(H,K.replace("?",U)),ee=r.nestedProperty(H,K.replace("?",te)),ne=J.get();J.set(ee.get()),ee.set(ne)}},r.raiseToTop=function(H){H.parentNode.appendChild(H)},r.cancelTransition=function(H){return H.transition().duration(0)},r.constrain=function(H,N,U){return N>U?Math.max(U,Math.min(N,H)):Math.max(N,Math.min(U,H))},r.bBoxIntersect=function(H,N,U){return U=U||0,H.left<=N.right+U&&N.left<=H.right+U&&H.top<=N.bottom+U&&N.top<=H.bottom+U},r.simpleMap=function(H,N,U,te,B){for(var K=H.length,J=new Array(K),ee=0;ee<K;ee++)J[ee]=N(H[ee],U,te,B);return J},r.randstr=function H(N,U,te,B){if(te||(te=16),U===void 0&&(U=24),U<=0)return"0";var K,J,ee=Math.log(Math.pow(2,U))/Math.log(te),ne="";for(K=2;ee===1/0;K*=2)ee=Math.log(Math.pow(2,U/K))/Math.log(te)*K;var se=ee-Math.floor(ee);for(K=0;K<Math.floor(ee);K++)ne=Math.floor(Math.random()*te).toString(te)+ne;se&&(J=Math.pow(te,se),ne=Math.floor(Math.random()*J).toString(te)+ne);var oe=parseInt(ne,te);return N&&N[ne]||oe!==1/0&&oe>=Math.pow(2,U)?B>10?(r.warn("randstr failed uniqueness"),ne):H(N,U,te,(B||0)+1):ne},r.OptionControl=function(H,N){H||(H={}),N||(N="opt");var U={optionList:[],_newoption:function(te){te[N]=H,U[te.name]=te,U.optionList.push(te)}};return U["_"+N]=H,U},r.smooth=function(H,N){if((N=Math.round(N)||0)<2)return H;var U,te,B,K,J=H.length,ee=2*J,ne=2*N-1,se=new Array(ne),oe=new Array(J);for(U=0;U<ne;U++)se[U]=(1-Math.cos(Math.PI*(U+1)/N))/(2*N);for(U=0;U<J;U++){for(K=0,te=0;te<ne;te++)(B=U+te+1-N)<-J?B-=ee*Math.round(B/ee):B>=ee&&(B-=ee*Math.floor(B/ee)),B<0?B=-1-B:B>=J&&(B=ee-1-B),K+=H[B]*se[te];oe[U]=K}return oe},r.syncOrAsync=function(H,N,U){var te;function B(){return r.syncOrAsync(H,N,U)}for(;H.length;)if((te=(0,H.splice(0,1)[0])(N))&&te.then)return te.then(B);return U&&U(N)},r.stripTrailingSlash=function(H){return H.substr(-1)==="/"?H.substr(0,H.length-1):H},r.noneOrAll=function(H,N,U){if(H){var te,B=!1,K=!0;for(te=0;te<U.length;te++)H[U[te]]!=null?B=!0:K=!1;if(B&&!K)for(te=0;te<U.length;te++)H[U[te]]=N[U[te]]}},r.mergeArray=function(H,N,U,te){var B=typeof te=="function";if(r.isArrayOrTypedArray(H))for(var K=Math.min(H.length,N.length),J=0;J<K;J++){var ee=H[J];N[J][U]=B?te(ee):ee}},r.mergeArrayCastPositive=function(H,N,U){return r.mergeArray(H,N,U,function(te){var B=+te;return isFinite(B)&&B>0?B:0})},r.fillArray=function(H,N,U,te){if(te=te||r.identity,r.isArrayOrTypedArray(H))for(var B=0;B<N.length;B++)N[B][U]=te(H[B])},r.castOption=function(H,N,U,te){te=te||r.identity;var B=r.nestedProperty(H,U).get();return r.isArrayOrTypedArray(B)?Array.isArray(N)&&r.isArrayOrTypedArray(B[N[0]])?te(B[N[0]][N[1]]):te(B[N]):B},r.extractOption=function(H,N,U,te){if(U in H)return H[U];var B=r.nestedProperty(N,te).get();return Array.isArray(B)?void 0:B},r.tagSelected=function(H,N,U){var te,B,K=N.selectedpoints,J=N._indexToPoints;J&&(te=A(J));for(var ee=0;ee<K.length;ee++){var ne=K[ee];if(r.isIndex(ne)||r.isArrayOrTypedArray(ne)&&r.isIndex(ne[0])&&r.isIndex(ne[1])){var se=te?te[ne]:ne,oe=U?U[se]:se;(B=oe)!==void 0&&B<H.length&&(H[oe].selected=1)}}},r.selIndices2selPoints=function(H){var N=H.selectedpoints,U=H._indexToPoints;if(U){for(var te=A(U),B=[],K=0;K<N.length;K++){var J=N[K];if(r.isIndex(J)){var ee=te[J];r.isIndex(ee)&&B.push(ee)}}return B}return N},r.getTargetArray=function(H,N){var U=N.target;if(typeof U=="string"&&U){var te=r.nestedProperty(H,U).get();return!!Array.isArray(te)&&te}return!!Array.isArray(U)&&U},r.minExtend=function(H,N){var U={};typeof N!="object"&&(N={});var te,B,K,J=Object.keys(H);for(te=0;te<J.length;te++)K=H[B=J[te]],B.charAt(0)!=="_"&&typeof K!="function"&&(B==="module"?U[B]=K:Array.isArray(K)?U[B]=B==="colorscale"?K.slice():K.slice(0,3):r.isTypedArray(K)?U[B]=K.subarray(0,3):U[B]=K&&typeof K=="object"?r.minExtend(H[B],N[B]):K);for(J=Object.keys(N),te=0;te<J.length;te++)typeof(K=N[B=J[te]])=="object"&&B in U&&typeof U[B]=="object"||(U[B]=K);return U},r.titleCase=function(H){return H.charAt(0).toUpperCase()+H.substr(1)},r.containsAny=function(H,N){for(var U=0;U<N.length;U++)if(H.indexOf(N[U])!==-1)return!0;return!1},r.isIE=function(){return window.navigator.msSaveBlob!==void 0};var I=/Version\/[\d\.]+.*Safari/;r.isSafari=function(){return I.test(window.navigator.userAgent)};var P=/iPad|iPhone|iPod/;r.isIOS=function(){return P.test(window.navigator.userAgent)};var S=/Firefox\/(\d+)\.\d+/;r.getFirefoxVersion=function(){var H=S.exec(window.navigator.userAgent);if(H&&H.length===2){var N=parseInt(H[1]);if(!isNaN(N))return N}return null},r.isD3Selection=function(H){return H instanceof d.selection},r.ensureSingle=function(H,N,U,te){var B=H.select(N+(U?"."+U:""));if(B.size())return B;var K=H.append(N);return U&&K.classed(U,!0),te&&K.call(te),K},r.ensureSingleById=function(H,N,U,te){var B=H.select(N+"#"+U);if(B.size())return B;var K=H.append(N).attr("id",U);return te&&K.call(te),K},r.objectFromPath=function(H,N){for(var U,te=H.split("."),B=U={},K=0;K<te.length;K++){var J=te[K],ee=null,ne=te[K].match(/(.*)\[([0-9]+)\]/);ne?(J=ne[1],ee=ne[2],U=U[J]=[],K===te.length-1?U[ee]=N:U[ee]={},U=U[ee]):(K===te.length-1?U[J]=N:U[J]={},U=U[J])}return B};var E=/^([^\[\.]+)\.(.+)?/,z=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;r.expandObjectPaths=function(H){var N,U,te,B,K,J,ee;if(typeof H=="object"&&!Array.isArray(H))for(U in H)H.hasOwnProperty(U)&&((N=U.match(E))?(B=H[U],te=N[1],delete H[U],H[te]=r.extendDeepNoArrays(H[te]||{},r.objectFromPath(U,r.expandObjectPaths(B))[te])):(N=U.match(z))?(B=H[U],te=N[1],K=parseInt(N[2]),delete H[U],H[te]=H[te]||[],N[3]==="."?(ee=N[4],J=H[te][K]=H[te][K]||{},r.extendDeepNoArrays(J,r.objectFromPath(ee,r.expandObjectPaths(B)))):H[te][K]=r.expandObjectPaths(B)):H[U]=r.expandObjectPaths(H[U]));return H},r.numSeparate=function(H,N,U){if(U||(U=!1),typeof N!="string"||N.length===0)throw new Error("Separator string required for formatting!");typeof H=="number"&&(H=String(H));var te=/(\d+)(\d{3})/,B=N.charAt(0),K=N.charAt(1),J=H.split("."),ee=J[0],ne=J.length>1?B+J[1]:"";if(K&&(J.length>1||ee.length>4||U))for(;te.test(ee);)ee=ee.replace(te,"$1"+K+"$2");return ee+ne},r.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var D=/^\w*$/;r.templateString=function(H,N){var U={};return H.replace(r.TEMPLATE_STRING_REGEX,function(te,B){var K;return D.test(B)?K=N[B]:(U[B]=U[B]||r.nestedProperty(N,B).get,K=U[B]()),r.isValidTextValue(K)?K:""})};var j={max:10,count:0,name:"hovertemplate"};r.hovertemplateString=function(){return Q.apply(j,arguments)};var V={max:10,count:0,name:"texttemplate"};r.texttemplateString=function(){return Q.apply(V,arguments)};var Z=/^[:|\|]/;function Q(H,N,U){var te=this,B=arguments;N||(N={});var K={};return H.replace(r.TEMPLATE_STRING_REGEX,function(J,ee,ne){var se,oe,me,ce=ee==="_xother"||ee==="_yother",ye=ee==="_xother_"||ee==="_yother_",Se=ee==="xother_"||ee==="yother_",fe=ee==="xother"||ee==="yother"||ce||Se||ye,ge=ee;if((ce||ye)&&(ge=ge.substring(1)),(Se||ye)&&(ge=ge.substring(0,ge.length-1)),fe){if((se=N[ge])===void 0)return""}else for(me=3;me<B.length;me++)if(oe=B[me]){if(oe.hasOwnProperty(ge)){se=oe[ge];break}if(D.test(ge)||(se=r.nestedProperty(oe,ge).get(),(se=K[ge]||r.nestedProperty(oe,ge).get())&&(K[ge]=se)),se!==void 0)break}if(se===void 0&&te)return te.count<te.max&&(r.warn("Variable '"+ge+"' in "+te.name+" could not be found!"),se=J),te.count===te.max&&r.warn("Too many "+te.name+" warnings - additional warnings will be suppressed"),te.count++,J;if(ne){var Te;if(ne[0]===":"&&(se=(Te=U?U.numberFormat:r.numberFormat)(ne.replace(Z,""))(se)),ne[0]==="|"){Te=U?U.timeFormat:v;var le=r.dateTime2ms(se);se=r.formatDate(le,ne.replace(Z,""),!1,Te)}}else{var ve=ge+"Label";N.hasOwnProperty(ve)&&(se=N[ve])}return fe&&(se="("+se+")",(ce||ye)&&(se=" "+se),(Se||ye)&&(se+=" ")),se})}r.subplotSort=function(H,N){for(var U=Math.min(H.length,N.length)+1,te=0,B=0,K=0;K<U;K++){var J=H.charCodeAt(K)||0,ee=N.charCodeAt(K)||0,ne=J>=48&&J<=57,se=ee>=48&&ee<=57;if(ne&&(te=10*te+J-48),se&&(B=10*B+ee-48),!ne||!se){if(te!==B)return te-B;if(J!==ee)return J-ee}}return B-te};var X=2e9;r.seedPseudoRandom=function(){X=2e9},r.pseudoRandom=function(){var H=X;return X=(69069*X+1)%4294967296,Math.abs(X-H)<429496729?r.pseudoRandom():X/4294967296},r.fillText=function(H,N,U){var te=Array.isArray(U)?function(J){U.push(J)}:function(J){U.text=J},B=r.extractOption(H,N,"htx","hovertext");if(r.isValidTextValue(B))return te(B);var K=r.extractOption(H,N,"tx","text");return r.isValidTextValue(K)?te(K):void 0},r.isValidTextValue=function(H){return H||H===0},r.formatPercent=function(H,N){N=N||0;for(var U=(Math.round(100*H*Math.pow(10,N))*Math.pow(.1,N)).toFixed(N)+"%",te=0;te<N;te++)U.indexOf(".")!==-1&&(U=(U=U.replace("0%","%")).replace(".%","%"));return U},r.isHidden=function(H){var N=window.getComputedStyle(H).display;return!N||N==="none"},r.strTranslate=function(H,N){return H||N?"translate("+H+","+N+")":""},r.strRotate=function(H){return H?"rotate("+H+")":""},r.strScale=function(H){return H!==1?"scale("+H+")":""},r.getTextTransform=function(H){var N=H.noCenter,U=H.textX,te=H.textY,B=H.targetX,K=H.targetY,J=H.anchorX||0,ee=H.anchorY||0,ne=H.rotate,se=H.scale;return se?se>1&&(se=1):se=0,r.strTranslate(B-se*(U+J),K-se*(te+ee))+r.strScale(se)+(ne?"rotate("+ne+(N?"":" "+U+" "+te)+")":"")},r.setTransormAndDisplay=function(H,N){H.attr("transform",r.getTextTransform(N)),H.style("display",N.scale?null:"none")},r.ensureUniformFontSize=function(H,N){var U=r.extendFlat({},N);return U.size=Math.max(N.size,H._fullLayout.uniformtext.minsize||0),U},r.join2=function(H,N,U){var te=H.length;return te>1?H.slice(0,-1).join(N)+U+H[te-1]:H.join(N)},r.bigFont=function(H){return Math.round(1.2*H)};var $=r.getFirefoxVersion(),re=$!==null&&$<86;r.getPositionFromD3Event=function(){return re?[d.event.layerX,d.event.layerY]:[d.event.offsetX,d.event.offsetY]}},{"../constants/numerical":491,"./anchor_utils":495,"./angles":496,"./array":497,"./clean_number":498,"./clear_responsive":500,"./coerce":501,"./dates":502,"./dom":503,"./extend":505,"./filter_unique":506,"./filter_visible":507,"./geometry2d":510,"./identity":513,"./increment":514,"./is_plain_object":516,"./keyed_container":517,"./localize":518,"./loggers":519,"./make_trace_groups":520,"./matrix":521,"./mod":522,"./nested_property":523,"./noop":524,"./notifier":525,"./preserve_drawing_buffer":529,"./push_unique":530,"./regex":532,"./relative_attr":533,"./relink_private":534,"./search":535,"./sort_object_keys":538,"./stats":539,"./throttle":542,"./to_log_range":543,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],516:[function(m,G,Y){G.exports=function(d){return window&&window.process&&window.process.versions?Object.prototype.toString.call(d)==="[object Object]":Object.prototype.toString.call(d)==="[object Object]"&&Object.getPrototypeOf(d).hasOwnProperty("hasOwnProperty")}},{}],517:[function(m,G,Y){var d=m("./nested_property"),v=/^\w*$/;G.exports=function(w,y,e,t){var n,o,r;e=e||"name",t=t||"value";var g={};y&&y.length?(r=d(w,y),o=r.get()):o=w,y=y||"";var c={};if(o)for(n=0;n<o.length;n++)c[o[n][e]]=n;var a=v.test(t),h={set:function(l,s){var p=s===null?4:0;if(!o){if(!r||p===4)return;o=[],r.set(o)}var u=c[l];if(u===void 0){if(p===4)return;p|=3,u=o.length,c[l]=u}else s!==(a?o[u][t]:d(o[u],t).get())&&(p|=2);var i=o[u]=o[u]||{};return i[e]=l,a?i[t]=s:d(i,t).set(s),s!==null&&(p&=-5),g[u]=g[u]|p,h},get:function(l){if(o){var s=c[l];return s===void 0?void 0:a?o[s][t]:d(o[s],t).get()}},rename:function(l,s){var p=c[l];return p===void 0||(g[p]=1|g[p],c[s]=p,delete c[l],o[p][e]=s),h},remove:function(l){var s=c[l];if(s===void 0)return h;var p=o[s];if(Object.keys(p).length>2)return g[s]=2|g[s],h.set(l,null);if(a){for(n=s;n<o.length;n++)g[n]=3|g[n];for(n=s;n<o.length;n++)c[o[n][e]]--;o.splice(s,1),delete c[l]}else d(p,t).set(null),g[s]=6|g[s];return h},constructUpdate:function(){for(var l,s,p={},u=Object.keys(g),i=0;i<u.length;i++)s=u[i],l=y+"["+s+"]",o[s]?(1&g[s]&&(p[l+"."+e]=o[s][e]),2&g[s]&&(p[l+"."+t]=a?4&g[s]?null:o[s][t]:4&g[s]?null:d(o[s],t).get())):p[l]=null;return p}};return h}},{"./nested_property":523}],518:[function(m,G,Y){var d=m("../registry");G.exports=function(v,w){for(var y=v._context.locale,e=0;e<2;e++){for(var t=v._context.locales,n=0;n<2;n++){var o=(t[y]||{}).dictionary;if(o){var r=o[w];if(r)return r}t=d.localeRegistry}var g=y.split("-")[0];if(g===y)break;y=g}return w}},{"../registry":647}],519:[function(m,G,Y){var d=m("../plot_api/plot_config").dfltConfig,v=m("./notifier"),w=G.exports={};w.log=function(){var y;if(d.logging>1){var e=["LOG:"];for(y=0;y<arguments.length;y++)e.push(arguments[y]);console.trace.apply(console,e)}if(d.notifyOnLogging>1){var t=[];for(y=0;y<arguments.length;y++)t.push(arguments[y]);v(t.join("<br>"),"long")}},w.warn=function(){var y;if(d.logging>0){var e=["WARN:"];for(y=0;y<arguments.length;y++)e.push(arguments[y]);console.trace.apply(console,e)}if(d.notifyOnLogging>0){var t=[];for(y=0;y<arguments.length;y++)t.push(arguments[y]);v(t.join("<br>"),"stick")}},w.error=function(){var y;if(d.logging>0){var e=["ERROR:"];for(y=0;y<arguments.length;y++)e.push(arguments[y]);console.error.apply(console,e)}if(d.notifyOnLogging>0){var t=[];for(y=0;y<arguments.length;y++)t.push(arguments[y]);v(t.join("<br>"),"stick")}}},{"../plot_api/plot_config":553,"./notifier":525}],520:[function(m,G,Y){var d=m("@plotly/d3");G.exports=function(v,w,y){var e=v.selectAll("g."+y.replace(/\s/g,".")).data(w,function(n){return n[0].trace.uid});e.exit().remove(),e.enter().append("g").attr("class",y),e.order();var t=v.classed("rangeplot")?"nodeRangePlot3":"node3";return e.each(function(n){n[0][t]=d.select(this)}),e}},{"@plotly/d3":58}],521:[function(m,G,Y){var d=m("gl-mat4");Y.init2dArray=function(v,w){for(var y=new Array(v),e=0;e<v;e++)y[e]=new Array(w);return y},Y.transposeRagged=function(v){var w,y,e=0,t=v.length;for(w=0;w<t;w++)e=Math.max(e,v[w].length);var n=new Array(e);for(w=0;w<e;w++)for(n[w]=new Array(t),y=0;y<t;y++)n[w][y]=v[y][w];return n},Y.dot=function(v,w){if(!v.length||!w.length||v.length!==w.length)return null;var y,e,t=v.length;if(v[0].length)for(y=new Array(t),e=0;e<t;e++)y[e]=Y.dot(v[e],w);else if(w[0].length){var n=Y.transposeRagged(w);for(y=new Array(n.length),e=0;e<n.length;e++)y[e]=Y.dot(v,n[e])}else for(y=0,e=0;e<t;e++)y+=v[e]*w[e];return y},Y.translationMatrix=function(v,w){return[[1,0,v],[0,1,w],[0,0,1]]},Y.rotationMatrix=function(v){var w=v*Math.PI/180;return[[Math.cos(w),-Math.sin(w),0],[Math.sin(w),Math.cos(w),0],[0,0,1]]},Y.rotationXYMatrix=function(v,w,y){return Y.dot(Y.dot(Y.translationMatrix(w,y),Y.rotationMatrix(v)),Y.translationMatrix(-w,-y))},Y.apply3DTransform=function(v){return function(){var w=arguments,y=arguments.length===1?w[0]:[w[0],w[1],w[2]||0];return Y.dot(v,[y[0],y[1],y[2],1]).slice(0,3)}},Y.apply2DTransform=function(v){return function(){var w=arguments;w.length===3&&(w=w[0]);var y=arguments.length===1?w[0]:[w[0],w[1]];return Y.dot(v,[y[0],y[1],1]).slice(0,2)}},Y.apply2DTransform2=function(v){var w=Y.apply2DTransform(v);return function(y){return w(y.slice(0,2)).concat(w(y.slice(2,4)))}},Y.convertCssMatrix=function(v){if(v){var w=v.length;if(w===16)return v;if(w===6)return[v[0],v[1],0,0,v[2],v[3],0,0,0,0,1,0,v[4],v[5],0,1]}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},Y.inverseTransformMatrix=function(v){var w=[];return d.invert(w,v),[[w[0],w[1],w[2],w[3]],[w[4],w[5],w[6],w[7]],[w[8],w[9],w[10],w[11]],[w[12],w[13],w[14],w[15]]]}},{"gl-mat4":210}],522:[function(m,G,Y){G.exports={mod:function(d,v){var w=d%v;return w<0?w+v:w},modHalf:function(d,v){return Math.abs(d)>v/2?d-Math.round(d/v)*v:d}}},{}],523:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("./array").isArrayOrTypedArray;function w(g,c){return function(){var a,h,l,s,p,u=g;for(s=0;s<c.length-1;s++){if((a=c[s])===-1){for(h=!0,l=[],p=0;p<u.length;p++)l[p]=w(u[p],c.slice(s+1))(),l[p]!==l[0]&&(h=!1);return h?l[0]:l}if(typeof a=="number"&&!v(u)||typeof(u=u[a])!="object"||u===null)return}if(typeof u=="object"&&u!==null&&(l=u[c[s]])!==null)return l}}G.exports=function(g,c){if(d(c))c=String(c);else if(typeof c!="string"||c.substr(c.length-4)==="[-1]")throw"bad property string";for(var a,h,l,s=0,p=c.split(".");s<p.length;){if(a=String(p[s]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/)){if(a[1])p[s]=a[1];else{if(s!==0)throw"bad property string";p.splice(0,1)}for(h=a[2].substr(1,a[2].length-2).split("]["),l=0;l<h.length;l++)s++,p.splice(s,0,Number(h[l]))}s++}return typeof g!="object"?function(u,i,x){return{set:function(){throw"bad container"},get:function(){},astr:i,parts:x,obj:u}}(g,c,p):{set:t(g,p,c),get:w(g,p),astr:c,parts:p,obj:g}};var y=/(^|\.)args\[/;function e(g,c){return g===void 0||g===null&&!c.match(y)}function t(g,c,a){return function(h){var l,s,p=g,u="",i=e(h,a);for(s=0;s<c.length-1;s++){if(typeof(l=c[s])=="number"&&!v(p))throw"array index but container is not an array";if(l===-1){if(i=!o(p,c.slice(s+1),h,a))break;return}if(!r(p,l,c[s+1],i))break;if(typeof(p=p[l])!="object"||p===null)throw"container is not an object";u=n(u,l)}if(i){if(s===c.length-1&&(delete p[c[s]],Array.isArray(p)&&+c[s]==p.length-1))for(;p.length&&p[p.length-1]===void 0;)p.pop()}else p[c[s]]=h}}function n(g,c){var a=c;return d(c)?a="["+c+"]":g&&(a="."+c),g+a}function o(g,c,a,h){var l,s=v(a),p=!0,u=a,i=h.replace("-1",0),x=!s&&e(a,i),f=c[0];for(l=0;l<g.length;l++)i=h.replace("-1",l),s&&(x=e(u=a[l%a.length],i)),x&&(p=!1),r(g,l,f,x)&&t(g[l],c,h.replace("-1",l))(u);return p}function r(g,c,a,h){if(g[c]===void 0){if(h)return!1;g[c]=typeof a=="number"?[]:{}}return!0}},{"./array":497,"fast-isnumeric":190}],524:[function(m,G,Y){G.exports=function(){}},{}],525:[function(m,G,Y){var d=m("@plotly/d3"),v=m("fast-isnumeric"),w=[];G.exports=function(y,e){if(w.indexOf(y)===-1){w.push(y);var t=1e3;v(e)?t=e:e==="long"&&(t=3e3);var n=d.select("body").selectAll(".plotly-notifier").data([0]);n.enter().append("div").classed("plotly-notifier",!0),n.selectAll(".notifier-note").data(w).enter().append("div").classed("notifier-note",!0).style("opacity",0).each(function(r){var g=d.select(this);g.append("button").classed("notifier-close",!0).html("&times;").on("click",function(){g.transition().call(o)});for(var c=g.append("p"),a=r.split(/<br\s*\/?>/g),h=0;h<a.length;h++)h&&c.append("br"),c.append("span").text(a[h]);e==="stick"?g.transition().duration(350).style("opacity",1):g.transition().duration(700).style("opacity",1).transition().delay(t).call(o)})}function o(r){r.duration(700).style("opacity",0).each("end",function(g){var c=w.indexOf(g);c!==-1&&w.splice(c,1),d.select(this).remove()})}}},{"@plotly/d3":58,"fast-isnumeric":190}],526:[function(m,G,Y){var d=m("./setcursor"),v="data-savedcursor";G.exports=function(w,y){var e=w.attr(v);if(y){if(!e){for(var t=(w.attr("class")||"").split(" "),n=0;n<t.length;n++){var o=t[n];o.indexOf("cursor-")===0&&w.attr(v,o.substr(7)).classed(o,!1)}w.attr(v)||w.attr(v,"!!")}d(w,y)}else e&&(w.attr(v,null),e==="!!"?d(w):d(w,e))}},{"./setcursor":536}],527:[function(m,G,Y){var d=m("./matrix").dot,v=m("../constants/numerical").BADNUM,w=G.exports={};w.tester=function(y){var e,t=y.slice(),n=t[0][0],o=n,r=t[0][1],g=r;for(t[t.length-1][0]===t[0][0]&&t[t.length-1][1]===t[0][1]||t.push(t[0]),e=1;e<t.length;e++)n=Math.min(n,t[e][0]),o=Math.max(o,t[e][0]),r=Math.min(r,t[e][1]),g=Math.max(g,t[e][1]);var c,a=!1;t.length===5&&(t[0][0]===t[1][0]?t[2][0]===t[3][0]&&t[0][1]===t[3][1]&&t[1][1]===t[2][1]&&(a=!0,c=function(s){return s[0]===t[0][0]}):t[0][1]===t[1][1]&&t[2][1]===t[3][1]&&t[0][0]===t[3][0]&&t[1][0]===t[2][0]&&(a=!0,c=function(s){return s[1]===t[0][1]}));var h=!0,l=t[0];for(e=1;e<t.length;e++)if(l[0]!==t[e][0]||l[1]!==t[e][1]){h=!1;break}return{xmin:n,xmax:o,ymin:r,ymax:g,pts:t,contains:a?function(s,p){var u=s[0],i=s[1];return!(u===v||u<n||u>o||i===v||i<r||i>g)&&(!p||!c(s))}:function(s,p){var u=s[0],i=s[1];if(u===v||u<n||u>o||i===v||i<r||i>g)return!1;var x,f,_,b,T,k=t.length,L=t[0][0],A=t[0][1],I=0;for(x=1;x<k;x++)if(f=L,_=A,L=t[x][0],A=t[x][1],!(u<(b=Math.min(f,L))||u>Math.max(f,L)||i>Math.max(_,A)))if(i<Math.min(_,A))u!==b&&I++;else{if(i===(T=L===f?i:_+(u-f)*(A-_)/(L-f)))return x!==1||!p;i<=T&&u!==b&&I++}return I%2==1},isRect:a,degenerate:h}},w.isSegmentBent=function(y,e,t,n){var o,r,g,c=y[e],a=[y[t][0]-c[0],y[t][1]-c[1]],h=d(a,a),l=Math.sqrt(h),s=[-a[1]/l,a[0]/l];for(o=e+1;o<t;o++)if(r=[y[o][0]-c[0],y[o][1]-c[1]],(g=d(r,a))<0||g>h||Math.abs(d(r,s))>n)return!0;return!1},w.filter=function(y,e){var t=[y[0]],n=0,o=0;function r(g){y.push(g);var c=t.length,a=n;t.splice(o+1);for(var h=a+1;h<y.length;h++)(h===y.length-1||w.isSegmentBent(y,a,h+1,e))&&(t.push(y[h]),t.length<c-2&&(n=h,o=t.length-1),a=h)}return y.length>1&&r(y.pop()),{addPt:r,raw:y,filtered:t}}},{"../constants/numerical":491,"./matrix":521}],528:[function(m,G,Y){(function(d){(function(){var v=m("./show_no_webgl_msg"),w=m("regl");G.exports=function(y,e,t){var n=y._fullLayout,o=!0;return n._glcanvas.each(function(r){if(r.regl)r.regl.preloadCachedCode(t);else if(!r.pick||n._has("parcoords")){try{r.regl=w({canvas:this,attributes:{antialias:!r.pick,preserveDrawingBuffer:!0},pixelRatio:y._context.plotGlPixelRatio||d.devicePixelRatio,extensions:e||[],cachedCode:t||{}})}catch{o=!1}r.regl||(o=!1),o&&this.addEventListener("webglcontextlost",function(g){y&&y.emit&&y.emit("plotly_webglcontextlost",{event:g,layer:r.key})},!1)}}),o||v({container:n._glcontainer.node()}),o}}).call(this)}).call(this,typeof Ka<"u"?Ka:typeof self<"u"?self:typeof window<"u"?window:{})},{"./show_no_webgl_msg":537,regl:284}],529:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("is-mobile");G.exports=function(w){var y;if(typeof(y=w&&w.hasOwnProperty("userAgent")?w.userAgent:function(){var c;return typeof navigator<"u"&&(c=navigator.userAgent),c&&c.headers&&typeof c.headers["user-agent"]=="string"&&(c=c.headers["user-agent"]),c}())!="string")return!0;var e=v({ua:{headers:{"user-agent":y}},tablet:!0,featureDetect:!1});if(!e){for(var t=y.split(" "),n=1;n<t.length;n++)if(t[n].indexOf("Safari")!==-1)for(var o=n-1;o>-1;o--){var r=t[o];if(r.substr(0,8)==="Version/"){var g=r.substr(8).split(".")[0];if(d(g)&&(g=+g),g>=13)return!0}}}return e}},{"fast-isnumeric":190,"is-mobile":234}],530:[function(m,G,Y){G.exports=function(d,v){if(v instanceof RegExp){for(var w=v.toString(),y=0;y<d.length;y++)if(d[y]instanceof RegExp&&d[y].toString()===w)return d;d.push(v)}else!v&&v!==0||d.indexOf(v)!==-1||d.push(v);return d}},{}],531:[function(m,G,Y){var d=m("../lib"),v=m("../plot_api/plot_config").dfltConfig,w={add:function(y,e,t,n,o){var r,g;y.undoQueue=y.undoQueue||{index:0,queue:[],sequence:!1},g=y.undoQueue.index,y.autoplay?y.undoQueue.inSequence||(y.autoplay=!1):(!y.undoQueue.sequence||y.undoQueue.beginSequence?(r={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},y.undoQueue.queue.splice(g,y.undoQueue.queue.length-g,r),y.undoQueue.index+=1):r=y.undoQueue.queue[g-1],y.undoQueue.beginSequence=!1,r&&(r.undo.calls.unshift(e),r.undo.args.unshift(t),r.redo.calls.push(n),r.redo.args.push(o)),y.undoQueue.queue.length>v.queueLength&&(y.undoQueue.queue.shift(),y.undoQueue.index--))},startSequence:function(y){y.undoQueue=y.undoQueue||{index:0,queue:[],sequence:!1},y.undoQueue.sequence=!0,y.undoQueue.beginSequence=!0},stopSequence:function(y){y.undoQueue=y.undoQueue||{index:0,queue:[],sequence:!1},y.undoQueue.sequence=!1,y.undoQueue.beginSequence=!1},undo:function(y){var e,t;if(!(y.undoQueue===void 0||isNaN(y.undoQueue.index)||y.undoQueue.index<=0)){for(y.undoQueue.index--,e=y.undoQueue.queue[y.undoQueue.index],y.undoQueue.inSequence=!0,t=0;t<e.undo.calls.length;t++)w.plotDo(y,e.undo.calls[t],e.undo.args[t]);y.undoQueue.inSequence=!1,y.autoplay=!1}},redo:function(y){var e,t;if(!(y.undoQueue===void 0||isNaN(y.undoQueue.index)||y.undoQueue.index>=y.undoQueue.queue.length)){for(e=y.undoQueue.queue[y.undoQueue.index],y.undoQueue.inSequence=!0,t=0;t<e.redo.calls.length;t++)w.plotDo(y,e.redo.calls[t],e.redo.args[t]);y.undoQueue.inSequence=!1,y.autoplay=!1,y.undoQueue.index++}}};w.plotDo=function(y,e,t){y.autoplay=!0,t=function(n,o){for(var r,g=[],c=0;c<o.length;c++)r=o[c],g[c]=r===n?r:typeof r=="object"?Array.isArray(r)?d.extendDeep([],r):d.extendDeepAll({},r):r;return g}(y,t),e.apply(null,t)},G.exports=w},{"../lib":515,"../plot_api/plot_config":553}],532:[function(m,G,Y){Y.counter=function(d,v,w,y){var e=(v||"")+(w?"":"$"),t=y===!1?"":"^";return d==="xy"?new RegExp(t+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+e):new RegExp(t+d+"([2-9]|[1-9][0-9]+)?"+e)}},{}],533:[function(m,G,Y){var d=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,v=/^[^\.\[\]]+$/;G.exports=function(w,y){for(;y;){var e=w.match(d);if(e)w=e[1];else{if(!w.match(v))throw new Error("bad relativeAttr call:"+[w,y]);w=""}if(y.charAt(0)!=="^")break;y=y.slice(1)}return w&&y.charAt(0)!=="["?w+"."+y:w+y}},{}],534:[function(m,G,Y){var d=m("./array").isArrayOrTypedArray,v=m("./is_plain_object");G.exports=function w(y,e){for(var t in e){var n=e[t],o=y[t];if(o!==n)if(t.charAt(0)==="_"||typeof n=="function"){if(t in y)continue;y[t]=n}else if(d(n)&&d(o)&&v(n[0])){if(t==="customdata"||t==="ids")continue;for(var r=Math.min(n.length,o.length),g=0;g<r;g++)o[g]!==n[g]&&v(n[g])&&v(o[g])&&w(o[g],n[g])}else v(n)&&v(o)&&(w(o,n),Object.keys(o).length||delete y[t])}}},{"./array":497,"./is_plain_object":516}],535:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("./loggers"),w=m("./identity"),y=m("../constants/numerical").BADNUM;function e(r,g){return r<g}function t(r,g){return r<=g}function n(r,g){return r>g}function o(r,g){return r>=g}Y.findBin=function(r,g,c){if(d(g.start))return c?Math.ceil((r-g.start)/g.size-1e-9)-1:Math.floor((r-g.start)/g.size+1e-9);var a,h,l=0,s=g.length,p=0,u=s>1?(g[s-1]-g[0])/(s-1):1;for(h=u>=0?c?e:t:c?o:n,r+=1e-9*u*(c?-1:1)*(u>=0?1:-1);l<s&&p++<100;)h(g[a=Math.floor((l+s)/2)],r)?l=a+1:s=a;return p>90&&v.log("Long binary search..."),l-1},Y.sorterAsc=function(r,g){return r-g},Y.sorterDes=function(r,g){return g-r},Y.distinctVals=function(r){var g,c=r.slice();for(c.sort(Y.sorterAsc),g=c.length-1;g>-1&&c[g]===y;g--);for(var a,h=c[g]-c[0]||1,l=h/(g||1)/1e4,s=[],p=0;p<=g;p++){var u=c[p],i=u-a;a===void 0?(s.push(u),a=u):i>l&&(h=Math.min(h,i),s.push(u),a=u)}return{vals:s,minDiff:h}},Y.roundUp=function(r,g,c){for(var a,h=0,l=g.length-1,s=0,p=c?0:1,u=c?1:0,i=c?Math.ceil:Math.floor;h<l&&s++<100;)g[a=i((h+l)/2)]<=r?h=a+p:l=a-u;return g[h]},Y.sort=function(r,g){for(var c=0,a=0,h=1;h<r.length;h++){var l=g(r[h],r[h-1]);if(l<0?c=1:l>0&&(a=1),c&&a)return r.sort(g)}return a?r:r.reverse()},Y.findIndexOfMin=function(r,g){g=g||w;for(var c,a=1/0,h=0;h<r.length;h++){var l=g(r[h]);l<a&&(a=l,c=h)}return c}},{"../constants/numerical":491,"./identity":513,"./loggers":519,"fast-isnumeric":190}],536:[function(m,G,Y){G.exports=function(d,v){(d.attr("class")||"").split(" ").forEach(function(w){w.indexOf("cursor-")===0&&d.classed(w,!1)}),v&&d.classed("cursor-"+v,!0)}},{}],537:[function(m,G,Y){var d=m("../components/color"),v=function(){};G.exports=function(w){for(var y in w)typeof w[y]=="function"&&(w[y]=v);w.destroy=function(){w.container.parentNode.removeChild(w.container)};var e=document.createElement("div");e.className="no-webgl",e.style.cursor="pointer",e.style.fontSize="24px",e.style.color=d.defaults[0],e.style.position="absolute",e.style.left=e.style.top="0px",e.style.width=e.style.height="100%",e.style["background-color"]=d.lightLine,e.style["z-index"]=30;var t=document.createElement("p");return t.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",t.style.position="relative",t.style.top="50%",t.style.left="50%",t.style.height="30%",t.style.width="50%",t.style.margin="-15% 0 0 -25%",e.appendChild(t),w.container.appendChild(e),w.container.style.background="#FFFFFF",w.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":367}],538:[function(m,G,Y){G.exports=function(d){return Object.keys(d).sort()}},{}],539:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("./array").isArrayOrTypedArray;Y.aggNums=function(w,y,e,t){var n,o;if((!t||t>e.length)&&(t=e.length),d(y)||(y=!1),v(e[0])){for(o=new Array(t),n=0;n<t;n++)o[n]=Y.aggNums(w,y,e[n]);e=o}for(n=0;n<t;n++)d(y)?d(e[n])&&(y=w(+y,+e[n])):y=e[n];return y},Y.len=function(w){return Y.aggNums(function(y){return y+1},0,w)},Y.mean=function(w,y){return y||(y=Y.len(w)),Y.aggNums(function(e,t){return e+t},0,w)/y},Y.midRange=function(w){if(w!==void 0&&w.length!==0)return(Y.aggNums(Math.max,null,w)+Y.aggNums(Math.min,null,w))/2},Y.variance=function(w,y,e){return y||(y=Y.len(w)),d(e)||(e=Y.mean(w,y)),Y.aggNums(function(t,n){return t+Math.pow(n-e,2)},0,w)/y},Y.stdev=function(w,y,e){return Math.sqrt(Y.variance(w,y,e))},Y.median=function(w){var y=w.slice().sort();return Y.interp(y,.5)},Y.interp=function(w,y){if(!d(y))throw"n should be a finite number";if((y=y*w.length-.5)<0)return w[0];if(y>w.length-1)return w[w.length-1];var e=y%1;return e*w[Math.ceil(y)]+(1-e)*w[Math.floor(y)]}},{"./array":497,"fast-isnumeric":190}],540:[function(m,G,Y){var d=m("color-normalize");G.exports=function(v){return v?d(v):[0,0,0,1]}},{"color-normalize":89}],541:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../lib"),w=v.strTranslate,y=m("../constants/xmlns_namespaces"),e=m("../constants/alignment").LINE_SPACING,t=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;Y.convertToTspans=function(S,E,z){var D=S.text(),j=!S.attr("data-notex")&&E&&E._context.typesetMath&&typeof MathJax<"u"&&D.match(t),V=d.select(S.node().parentNode);if(!V.empty()){var Z=S.attr("class")?S.attr("class").split(" ")[0]:"text";return Z+="-math",V.selectAll("svg."+Z).remove(),V.selectAll("g."+Z+"-group").remove(),S.style("display",null).attr({"data-unformatted":D,"data-math":"N"}),j?(E&&E._promises||[]).push(new Promise(function(X){S.style("display","none");var $=parseInt(S.node().style.fontSize,10),re={fontSize:$};(function(H,N,U){var te,B,K,J,ee=parseInt((MathJax.version||"").split(".")[0]);if(ee!==2&&ee!==3)return void v.warn("No MathJax version:",MathJax.version);var ne=function(){var oe="math-output-"+v.randstr({},64),me=(J=d.select("body").append("div").attr({id:oe}).style({visibility:"hidden",position:"absolute","font-size":N.fontSize+"px"}).text(H.replace(n,"\\lt ").replace(o,"\\gt "))).node();return ee===2?MathJax.Hub.Typeset(me):MathJax.typeset([me])},se=function(){var oe=J.select(ee===2?".MathJax_SVG":".MathJax"),me=!oe.empty()&&J.select("svg").node();if(me){var ce,ye=me.getBoundingClientRect();ce=ee===2?d.select("body").select("#MathJax_SVG_glyphs"):oe.select("defs"),U(oe,ce,ye)}else v.log("There was an error in the tex syntax.",H),U();J.remove()};ee===2?MathJax.Hub.Queue(function(){return B=v.extendDeepAll({},MathJax.Hub.config),K=MathJax.Hub.processSectionDelay,MathJax.Hub.processSectionDelay!==void 0&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:r},displayAlign:"left"})},function(){if((te=MathJax.Hub.config.menuSettings.renderer)!=="SVG")return MathJax.Hub.setRenderer("SVG")},ne,se,function(){if(te!=="SVG")return MathJax.Hub.setRenderer(te)},function(){return K!==void 0&&(MathJax.Hub.processSectionDelay=K),MathJax.Hub.Config(B)}):ee===3&&(B=v.extendDeepAll({},MathJax.config),MathJax.config.tex||(MathJax.config.tex={}),MathJax.config.tex.inlineMath=r,(te=MathJax.config.startup.output)!=="svg"&&(MathJax.config.startup.output="svg"),MathJax.startup.defaultReady(),MathJax.startup.promise.then(function(){ne(),se(),te!=="svg"&&(MathJax.config.startup.output=te),MathJax.config=B}))})(j[2],re,function(H,N,U){V.selectAll("svg."+Z).remove(),V.selectAll("g."+Z+"-group").remove();var te=H&&H.select("svg");if(!te||!te.node())return Q(),void X();var B=V.append("g").classed(Z+"-group",!0).attr({"pointer-events":"none","data-unformatted":D,"data-math":"Y"});B.node().appendChild(te.node()),N&&N.node()&&te.node().insertBefore(N.node().cloneNode(!0),te.node().firstChild);var K=U.width,J=U.height;te.attr({class:Z,height:J,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var ee=S.node().style.fill||"black",ne=te.select("g");ne.attr({fill:ee,stroke:ee});var se=ne.node().getBoundingClientRect(),oe=se.width,me=se.height;(oe>K||me>J)&&(te.style("overflow","hidden"),oe=(se=te.node().getBoundingClientRect()).width,me=se.height);var ce=+S.attr("x"),ye=+S.attr("y"),Se=-($||S.node().getBoundingClientRect().height)/4;if(Z[0]==="y")B.attr({transform:"rotate("+[-90,ce,ye]+")"+w(-oe/2,Se-me/2)});else if(Z[0]==="l")ye=Se-me/2;else if(Z[0]==="a"&&Z.indexOf("atitle")!==0)ce=0,ye=Se;else{var fe=S.attr("text-anchor");ce-=oe*(fe==="middle"?.5:fe==="end"?1:0),ye=ye+Se-me/2}te.attr({x:ce,y:ye}),z&&z.call(S,B),X(B)})})):Q(),S}function Q(){V.empty()||(Z=S.attr("class")+"-math",V.select("svg."+Z).remove()),S.text("").style("white-space","pre"),function(X,$){$=$.replace(l," ");var re,H=!1,N=[],U=-1;function te(){U++;var le=document.createElementNS(y.svg,"tspan");d.select(le).attr({class:"line",dy:U*e+"em"}),X.appendChild(le),re=le;var ve=N;if(N=[{node:le}],ve.length>1)for(var Me=1;Me<ve.length;Me++)B(ve[Me])}function B(le){var ve,Me=le.type,we={};if(Me==="a"){ve="a";var de=le.target,Ie=le.href,De=le.popup;Ie&&(we={"xlink:xlink:show":de==="_blank"||de.charAt(0)!=="_"?"new":"replace",target:de,"xlink:xlink:href":Ie},De&&(we.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+De+'");return false;'))}else ve="tspan";le.style&&(we.style=le.style);var Oe=document.createElementNS(y.svg,ve);if(Me==="sup"||Me==="sub"){K(re,"\u200B"),re.appendChild(Oe);var Ve=document.createElementNS(y.svg,"tspan");K(Ve,"\u200B"),d.select(Ve).attr("dy",a[Me]),we.dy=c[Me],re.appendChild(Oe),re.appendChild(Ve)}else re.appendChild(Oe);d.select(Oe).attr(we),re=le.node=Oe,N.push(le)}function K(le,ve){le.appendChild(document.createTextNode(ve))}function J(le){if(N.length!==1){var ve=N.pop();le!==ve.type&&v.log("Start tag <"+ve.type+"> doesnt match end tag <"+le+">. Pretending it did match.",$),re=N[N.length-1].node}else v.log("Ignoring unexpected end tag </"+le+">.",$)}u.test($)?te():(re=X,N=[{node:X}]);for(var ee=$.split(s),ne=0;ne<ee.length;ne++){var se=ee[ne],oe=se.match(p),me=oe&&oe[2].toLowerCase(),ce=g[me];if(me==="br")te();else if(ce===void 0)K(re,A(se));else if(oe[1])J(me);else{var ye=oe[4],Se={type:me},fe=b(ye,i);if(fe?(fe=fe.replace(T,"$1 fill:"),ce&&(fe+=";"+ce)):ce&&(fe=ce),fe&&(Se.style=fe),me==="a"){H=!0;var ge=b(ye,x);if(ge){var Te=I(ge);Te&&(Se.href=Te,Se.target=b(ye,f)||"_blank",Se.popup=b(ye,_))}}B(Se)}}return H}(S.node(),D)&&S.style("pointer-events","all"),Y.positionText(S),z&&z.call(S)}};var n=/(<|&lt;|&#60;)/g,o=/(>|&gt;|&#62;)/g,r=[["$","$"],["\\(","\\)"]],g={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},c={sub:"0.3em",sup:"-0.6em"},a={sub:"-0.21em",sup:"0.42em"},h=["http:","https:","mailto:","",void 0,":"],l=Y.NEWLINES=/(\r\n?|\n)/g,s=/(<[^<>]*>)/,p=/<(\/?)([^ >]*)(\s+(.*))?>/i,u=/<br(\s+.*)?>/i;Y.BR_TAG_ALL=/<br(\s+.*)?>/gi;var i=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,x=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,f=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,_=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function b(S,E){if(!S)return null;var z=S.match(E),D=z&&(z[3]||z[4]);return D&&A(D)}var T=/(^|;)\s*color:/;Y.plainText=function(S,E){for(var z=(E=E||{}).len!==void 0&&E.len!==-1?E.len:1/0,D=E.allowedTags!==void 0?E.allowedTags:["br"],j=3,V=S.split(s),Z=[],Q="",X=0,$=0;$<V.length;$++){var re=V[$],H=re.match(p),N=H&&H[2].toLowerCase();if(N)D.indexOf(N)!==-1&&(Z.push(re),Q=N);else{var U=re.length;if(X+U<z)Z.push(re),X+=U;else if(X<z){var te=z-X;Q&&(Q!=="br"||te<=j||U<=j)&&Z.pop(),z>j?Z.push(re.substr(0,te-j)+"..."):Z.push(re.substr(0,te));break}Q=""}}return Z.join("")};var k={mu:"\u03BC",amp:"&",lt:"<",gt:">",nbsp:"\xA0",times:"\xD7",plusmn:"\xB1",deg:"\xB0"},L=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function A(S){return S.replace(L,function(E,z){return(z.charAt(0)==="#"?function(D){if(!(D>1114111)){var j=String.fromCodePoint;if(j)return j(D);var V=String.fromCharCode;return D<=65535?V(D):V(55232+(D>>10),D%1024+56320)}}(z.charAt(1)==="x"?parseInt(z.substr(2),16):parseInt(z.substr(1),10)):k[z])||E})}function I(S){var E=encodeURI(decodeURI(S)),z=document.createElement("a"),D=document.createElement("a");z.href=S,D.href=E;var j=z.protocol,V=D.protocol;return h.indexOf(j)!==-1&&h.indexOf(V)!==-1?E:""}function P(S,E,z){var D,j,V,Z=z.horizontalAlign,Q=z.verticalAlign||"top",X=S.node().getBoundingClientRect(),$=E.node().getBoundingClientRect();return j=Q==="bottom"?function(){return X.bottom-D.height}:Q==="middle"?function(){return X.top+(X.height-D.height)/2}:function(){return X.top},V=Z==="right"?function(){return X.right-D.width}:Z==="center"?function(){return X.left+(X.width-D.width)/2}:function(){return X.left},function(){D=this.node().getBoundingClientRect();var re=V()-$.left,H=j()-$.top,N=z.gd||{};if(z.gd){N._fullLayout._calcInverseTransform(N);var U=v.apply3DTransform(N._fullLayout._invTransform)(re,H);re=U[0],H=U[1]}return this.style({top:H+"px",left:re+"px","z-index":1e3}),this}}Y.convertEntities=A,Y.sanitizeHTML=function(S){S=S.replace(l," ");for(var E=document.createElement("p"),z=E,D=[],j=S.split(s),V=0;V<j.length;V++){var Z=j[V],Q=Z.match(p),X=Q&&Q[2].toLowerCase();if(X in g)if(Q[1])D.length&&(z=D.pop());else{var $=Q[4],re=b($,i),H=re?{style:re}:{};if(X==="a"){var N=b($,x);if(N){var U=I(N);if(U){H.href=U;var te=b($,f);te&&(H.target=te)}}}var B=document.createElement(X);z.appendChild(B),d.select(B).attr(H),z=B,D.push(B)}else z.appendChild(document.createTextNode(A(Z)))}return E.innerHTML},Y.lineCount=function(S){return S.selectAll("tspan.line").size()||1},Y.positionText=function(S,E,z){return S.each(function(){var D=d.select(this);function j(Q,X){return X===void 0?(X=D.attr(Q))===null&&(D.attr(Q,0),X=0):D.attr(Q,X),X}var V=j("x",E),Z=j("y",z);this.nodeName==="text"&&D.selectAll("tspan.line").attr({x:V,y:Z})})},Y.makeTextShadow=function(S){var E="1px ",z="1px ",D="1px ";return E+z+D+S+", -"+E+"-"+z+D+S+", "+E+"-"+z+D+S+", -"+E+z+D+S},Y.makeEditable=function(S,E){var z=E.gd,D=E.delegate,j=d.dispatch("edit","input","cancel"),V=D||S;if(S.style({"pointer-events":D?"none":"all"}),S.size()!==1)throw new Error("boo");function Z(){(function(){var re=d.select(z).select(".svg-container"),H=re.append("div"),N=S.node().style,U=parseFloat(N.fontSize||12),te=E.text;te===void 0&&(te=S.attr("data-unformatted")),H.classed("plugin-editable editable",!0).style({position:"absolute","font-family":N.fontFamily||"Arial","font-size":U,color:E.fill||N.fill||"black",opacity:1,"background-color":E.background||"transparent",outline:"#ffffff33 1px solid",margin:[-U/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(te).call(P(S,re,E)).on("blur",function(){z._editing=!1,S.text(this.textContent).style({opacity:1});var B,K=d.select(this).attr("class");(B=K?"."+K.split(" ")[0]+"-math-group":"[class*=-math-group]")&&d.select(S.node().parentNode).select(B).style({opacity:0});var J=this.textContent;d.select(this).transition().duration(0).remove(),d.select(document).on("mouseup",null),j.edit.call(S,J)}).on("focus",function(){var B=this;z._editing=!0,d.select(document).on("mouseup",function(){if(d.event.target===B)return!1;document.activeElement===H.node()&&H.node().blur()})}).on("keyup",function(){d.event.which===27?(z._editing=!1,S.style({opacity:1}),d.select(this).style({opacity:0}).on("blur",function(){return!1}).transition().remove(),j.cancel.call(S,this.textContent)):(j.input.call(S,this.textContent),d.select(this).call(P(S,re,E)))}).on("keydown",function(){d.event.which===13&&this.blur()}).call(Q)})(),S.style({opacity:0});var X,$=V.attr("class");(X=$?"."+$.split(" ")[0]+"-math-group":"[class*=-math-group]")&&d.select(S.node().parentNode).select(X).style({opacity:0})}function Q(X){var $=X.node(),re=document.createRange();re.selectNodeContents($);var H=window.getSelection();H.removeAllRanges(),H.addRange(re),$.focus()}return E.immediate?Z():V.on("click",Z),d.rebind(S,j,"on")}},{"../constants/alignment":483,"../constants/xmlns_namespaces":492,"../lib":515,"@plotly/d3":58}],542:[function(m,G,Y){var d={};function v(w){w&&w.timer!==null&&(clearTimeout(w.timer),w.timer=null)}Y.throttle=function(w,y,e){var t=d[w],n=Date.now();if(!t){for(var o in d)d[o].ts<n-6e4&&delete d[o];t=d[w]={ts:0,timer:null}}function r(){e(),t.ts=Date.now(),t.onDone&&(t.onDone(),t.onDone=null)}v(t),n>t.ts+y?r():t.timer=setTimeout(function(){r(),t.timer=null},y)},Y.done=function(w){var y=d[w];return y&&y.timer?new Promise(function(e){var t=y.onDone;y.onDone=function(){t&&t(),e(),y.onDone=null}}):Promise.resolve()},Y.clear=function(w){if(w)v(d[w]),delete d[w];else for(var y in d)Y.clear(y)}},{}],543:[function(m,G,Y){var d=m("fast-isnumeric");G.exports=function(v,w){if(v>0)return Math.log(v)/Math.LN10;var y=Math.log(Math.min(w[0],w[1]))/Math.LN10;return d(y)||(y=Math.log(Math.max(w[0],w[1]))/Math.LN10-6),y}},{"fast-isnumeric":190}],544:[function(m,G,Y){var d=G.exports={},v=m("../plots/geo/constants").locationmodeToLayer,w=m("topojson-client").feature;d.getTopojsonName=function(y){return[y.scope.replace(/ /g,"-"),"_",y.resolution.toString(),"m"].join("")},d.getTopojsonPath=function(y,e){return y+e+".json"},d.getTopojsonFeatures=function(y,e){var t=v[y.locationmode],n=e.objects[t];return w(e,n).features}},{"../plots/geo/constants":596,"topojson-client":316}],545:[function(m,G,Y){G.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],546:[function(m,G,Y){G.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],547:[function(m,G,Y){var d=m("../registry");G.exports=function(v){for(var w,y,e=d.layoutArrayContainers,t=d.layoutArrayRegexes,n=v.split("[")[0],o=0;o<t.length;o++)if((y=v.match(t[o]))&&y.index===0){w=y[0];break}if(w||(w=e[e.indexOf(n)]),!w)return!1;var r=v.substr(w.length);return r?!!(y=r.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/))&&{array:w,index:Number(y[1]),property:y[3]||""}:{array:w,index:"",property:""}}},{"../registry":647}],548:[function(m,G,Y){var d=m("../lib"),v=d.extendFlat,w=d.isPlainObject,y={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},e={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},t=y.flags.slice().concat(["fullReplot"]),n=e.flags.slice().concat("layoutReplot");function o(c){for(var a={},h=0;h<c.length;h++)a[c[h]]=!1;return a}function r(c,a,h){var l=v({},c);for(var s in l){var p=l[s];w(p)&&(l[s]=g(p,a,h,s))}return h==="from-root"&&(l.editType=a),l}function g(c,a,h,l){if(c.valType){var s=v({},c);if(s.editType=a,Array.isArray(c.items)){s.items=new Array(c.items.length);for(var p=0;p<c.items.length;p++)s.items[p]=g(c.items[p],a)}return s}return r(c,a,l.charAt(0)==="_"?"nested":"from-root")}G.exports={traces:y,layout:e,traceFlags:function(){return o(t)},layoutFlags:function(){return o(n)},update:function(c,a){var h=a.editType;if(h&&h!=="none")for(var l=h.split("+"),s=0;s<l.length;s++)c[l[s]]=!0},overrideAll:r}},{"../lib":515}],549:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("gl-mat4/fromQuat"),w=m("../registry"),y=m("../lib"),e=m("../plots/plots"),t=m("../plots/cartesian/axis_ids"),n=m("../components/color"),o=t.cleanId,r=t.getFromTrace,g=w.traceIs;function c(f,_){var b=f[_],T=_.charAt(0);b&&b!=="paper"&&(f[_]=o(b,T,!0))}function a(f){function _(b,T){var k=f[b],L=f.title&&f.title[T];k&&!L&&(f.title||(f.title={}),f.title[T]=f[b],delete f[b])}f&&(typeof f.title!="string"&&typeof f.title!="number"||(f.title={text:f.title}),_("titlefont","font"),_("titleposition","position"),_("titleside","side"),_("titleoffset","offset"))}function h(f){if(!y.isPlainObject(f))return!1;var _=f.name;return delete f.name,delete f.showlegend,(typeof _=="string"||typeof _=="number")&&String(_)}function l(f,_,b,T){if(b&&!T)return f;if(T&&!b||!f.trim())return _;if(!_.trim())return f;var k,L=Math.min(f.length,_.length);for(k=0;k<L&&f.charAt(k)===_.charAt(k);k++);return f.substr(0,k).trim()}function s(f){var _="middle",b="center";return typeof f=="string"&&(f.indexOf("top")!==-1?_="top":f.indexOf("bottom")!==-1&&(_="bottom"),f.indexOf("left")!==-1?b="left":f.indexOf("right")!==-1&&(b="right")),_+" "+b}function p(f,_){return _ in f&&typeof f[_]=="object"&&Object.keys(f[_]).length===0}Y.clearPromiseQueue=function(f){Array.isArray(f._promises)&&f._promises.length>0&&y.log("Clearing previous rejected promises from queue."),f._promises=[]},Y.cleanLayout=function(f){var _,b;f||(f={}),f.xaxis1&&(f.xaxis||(f.xaxis=f.xaxis1),delete f.xaxis1),f.yaxis1&&(f.yaxis||(f.yaxis=f.yaxis1),delete f.yaxis1),f.scene1&&(f.scene||(f.scene=f.scene1),delete f.scene1);var T=(e.subplotsRegistry.cartesian||{}).attrRegex,k=(e.subplotsRegistry.polar||{}).attrRegex,L=(e.subplotsRegistry.ternary||{}).attrRegex,A=(e.subplotsRegistry.gl3d||{}).attrRegex,I=Object.keys(f);for(_=0;_<I.length;_++){var P=I[_];if(T&&T.test(P)){var S=f[P];S.anchor&&S.anchor!=="free"&&(S.anchor=o(S.anchor)),S.overlaying&&(S.overlaying=o(S.overlaying)),S.type||(S.isdate?S.type="date":S.islog?S.type="log":S.isdate===!1&&S.islog===!1&&(S.type="linear")),S.autorange!=="withzero"&&S.autorange!=="tozero"||(S.autorange=!0,S.rangemode="tozero"),delete S.islog,delete S.isdate,delete S.categories,p(S,"domain")&&delete S.domain,S.autotick!==void 0&&(S.tickmode===void 0&&(S.tickmode=S.autotick?"auto":"linear"),delete S.autotick),a(S)}else if(k&&k.test(P))a(f[P].radialaxis);else if(L&&L.test(P)){var E=f[P];a(E.aaxis),a(E.baxis),a(E.caxis)}else if(A&&A.test(P)){var z=f[P],D=z.cameraposition;if(Array.isArray(D)&&D[0].length===4){var j=D[0],V=D[1],Z=D[2],Q=v([],j),X=[];for(b=0;b<3;++b)X[b]=V[b]+Z*Q[2+4*b];z.camera={eye:{x:X[0],y:X[1],z:X[2]},center:{x:V[0],y:V[1],z:V[2]},up:{x:0,y:0,z:1}},delete z.cameraposition}a(z.xaxis),a(z.yaxis),a(z.zaxis)}}var $=Array.isArray(f.annotations)?f.annotations.length:0;for(_=0;_<$;_++){var re=f.annotations[_];y.isPlainObject(re)&&(re.ref&&(re.ref==="paper"?(re.xref="paper",re.yref="paper"):re.ref==="data"&&(re.xref="x",re.yref="y"),delete re.ref),c(re,"xref"),c(re,"yref"))}var H=Array.isArray(f.shapes)?f.shapes.length:0;for(_=0;_<H;_++){var N=f.shapes[_];y.isPlainObject(N)&&(c(N,"xref"),c(N,"yref"))}var U=Array.isArray(f.images)?f.images.length:0;for(_=0;_<U;_++){var te=f.images[_];y.isPlainObject(te)&&(c(te,"xref"),c(te,"yref"))}var B=f.legend;return B&&(B.x>3?(B.x=1.02,B.xanchor="left"):B.x<-2&&(B.x=-.02,B.xanchor="right"),B.y>3?(B.y=1.02,B.yanchor="bottom"):B.y<-2&&(B.y=-.02,B.yanchor="top")),a(f),f.dragmode==="rotate"&&(f.dragmode="orbit"),n.clean(f),f.template&&f.template.layout&&Y.cleanLayout(f.template.layout),f},Y.cleanData=function(f){for(var _=0;_<f.length;_++){var b,T=f[_];if(T.type==="histogramy"&&"xbins"in T&&!("ybins"in T)&&(T.ybins=T.xbins,delete T.xbins),T.error_y&&"opacity"in T.error_y){var k=n.defaults,L=T.error_y.color||(g(T,"bar")?n.defaultLine:k[_%k.length]);T.error_y.color=n.addOpacity(n.rgb(L),n.opacity(L)*T.error_y.opacity),delete T.error_y.opacity}if("bardir"in T&&(T.bardir!=="h"||!g(T,"bar")&&T.type.substr(0,9)!=="histogram"||(T.orientation="h",Y.swapXYData(T)),delete T.bardir),T.type==="histogramy"&&Y.swapXYData(T),T.type!=="histogramx"&&T.type!=="histogramy"||(T.type="histogram"),"scl"in T&&!("colorscale"in T)&&(T.colorscale=T.scl,delete T.scl),"reversescl"in T&&!("reversescale"in T)&&(T.reversescale=T.reversescl,delete T.reversescl),T.xaxis&&(T.xaxis=o(T.xaxis,"x")),T.yaxis&&(T.yaxis=o(T.yaxis,"y")),g(T,"gl3d")&&T.scene&&(T.scene=e.subplotsRegistry.gl3d.cleanId(T.scene)),!g(T,"pie-like")&&!g(T,"bar-like"))if(Array.isArray(T.textposition))for(b=0;b<T.textposition.length;b++)T.textposition[b]=s(T.textposition[b]);else T.textposition&&(T.textposition=s(T.textposition));var A=w.getModule(T);if(A&&A.colorbar){var I=A.colorbar.container,P=I?T[I]:T;P&&P.colorscale&&(P.colorscale==="YIGnBu"&&(P.colorscale="YlGnBu"),P.colorscale==="YIOrRd"&&(P.colorscale="YlOrRd"))}if(T.type==="surface"&&y.isPlainObject(T.contours)){var S=["x","y","z"];for(b=0;b<S.length;b++){var E=T.contours[S[b]];y.isPlainObject(E)&&(E.highlightColor&&(E.highlightcolor=E.highlightColor,delete E.highlightColor),E.highlightWidth&&(E.highlightwidth=E.highlightWidth,delete E.highlightWidth))}}if(T.type==="candlestick"||T.type==="ohlc"){var z=(T.increasing||{}).showlegend!==!1,D=(T.decreasing||{}).showlegend!==!1,j=h(T.increasing),V=h(T.decreasing);if(j!==!1&&V!==!1){var Z=l(j,V,z,D);Z&&(T.name=Z)}else!j&&!V||T.name||(T.name=j||V)}if(Array.isArray(T.transforms)){var Q=T.transforms;for(b=0;b<Q.length;b++){var X=Q[b];if(y.isPlainObject(X))switch(X.type){case"filter":X.filtersrc&&(X.target=X.filtersrc,delete X.filtersrc),X.calendar&&(X.valuecalendar||(X.valuecalendar=X.calendar),delete X.calendar);break;case"groupby":if(X.styles=X.styles||X.style,X.styles&&!Array.isArray(X.styles)){var $=X.styles,re=Object.keys($);X.styles=[];for(var H=0;H<re.length;H++)X.styles.push({target:re[H],value:$[re[H]]})}}}}p(T,"line")&&delete T.line,"marker"in T&&(p(T.marker,"line")&&delete T.marker.line,p(T,"marker")&&delete T.marker),n.clean(T),T.autobinx&&(delete T.autobinx,delete T.xbins),T.autobiny&&(delete T.autobiny,delete T.ybins),a(T),T.colorbar&&a(T.colorbar),T.marker&&T.marker.colorbar&&a(T.marker.colorbar),T.line&&T.line.colorbar&&a(T.line.colorbar),T.aaxis&&a(T.aaxis),T.baxis&&a(T.baxis)}},Y.swapXYData=function(f){var _;if(y.swapAttrs(f,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(f.z)&&Array.isArray(f.z[0])&&(f.transpose?delete f.transpose:f.transpose=!0),f.error_x&&f.error_y){var b=f.error_y,T="copy_ystyle"in b?b.copy_ystyle:!(b.color||b.thickness||b.width);y.swapAttrs(f,["error_?.copy_ystyle"]),T&&y.swapAttrs(f,["error_?.color","error_?.thickness","error_?.width"])}if(typeof f.hoverinfo=="string"){var k=f.hoverinfo.split("+");for(_=0;_<k.length;_++)k[_]==="x"?k[_]="y":k[_]==="y"&&(k[_]="x");f.hoverinfo=k.join("+")}},Y.coerceTraceIndices=function(f,_){if(d(_))return[_];if(!Array.isArray(_)||!_.length)return f.data.map(function(k,L){return L});if(Array.isArray(_)){for(var b=[],T=0;T<_.length;T++)y.isIndex(_[T],f.data.length)?b.push(_[T]):y.warn("trace index (",_[T],") is not a number or is out of bounds");return b}return _},Y.manageArrayContainers=function(f,_,b){var T=f.obj,k=f.parts,L=k.length,A=k[L-1],I=d(A);if(I&&_===null){var P=k.slice(0,L-1).join(".");y.nestedProperty(T,P).get().splice(A,1)}else I&&f.get()===void 0&&f.get()===void 0&&(b[f.astr]=null),f.set(_)};var u=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function i(f){var _=f.search(u);if(_>0)return f.substr(0,_)}Y.hasParent=function(f,_){for(var b=i(_);b;){if(b in f)return!0;b=i(b)}return!1};var x=["x","y","z"];Y.clearAxisTypes=function(f,_,b){for(var T=0;T<_.length;T++)for(var k=f._fullData[T],L=0;L<3;L++){var A=r(f,k,x[L]);if(A&&A.type!=="log"){var I=A._name,P=A._id.substr(1);if(P.substr(0,5)==="scene"){if(b[P]!==void 0)continue;I=P+"."+I}var S=I+".type";b[I]===void 0&&b[S]===void 0&&y.nestedProperty(f.layout,S).set(null)}}}},{"../components/color":367,"../lib":515,"../plots/cartesian/axis_ids":570,"../plots/plots":628,"../registry":647,"fast-isnumeric":190,"gl-mat4/fromQuat":200}],550:[function(m,G,Y){var d=m("./plot_api");Y._doPlot=d._doPlot,Y.newPlot=d.newPlot,Y.restyle=d.restyle,Y.relayout=d.relayout,Y.redraw=d.redraw,Y.update=d.update,Y._guiRestyle=d._guiRestyle,Y._guiRelayout=d._guiRelayout,Y._guiUpdate=d._guiUpdate,Y._storeDirectGUIEdit=d._storeDirectGUIEdit,Y.react=d.react,Y.extendTraces=d.extendTraces,Y.prependTraces=d.prependTraces,Y.addTraces=d.addTraces,Y.deleteTraces=d.deleteTraces,Y.moveTraces=d.moveTraces,Y.purge=d.purge,Y.addFrames=d.addFrames,Y.deleteFrames=d.deleteFrames,Y.animate=d.animate,Y.setPlotConfig=d.setPlotConfig,Y.toImage=m("./to_image"),Y.validate=m("./validate"),Y.downloadImage=m("../snapshot/download");var v=m("./template_api");Y.makeTemplate=v.makeTemplate,Y.validateTemplate=v.validateTemplate},{"../snapshot/download":649,"./plot_api":552,"./template_api":557,"./to_image":558,"./validate":559}],551:[function(m,G,Y){var d=m("../lib/is_plain_object"),v=m("../lib/noop"),w=m("../lib/loggers"),y=m("../lib/search").sorterAsc,e=m("../registry");Y.containerArrayMatch=m("./container_array_match");var t=Y.isAddVal=function(o){return o==="add"||d(o)},n=Y.isRemoveVal=function(o){return o===null||o==="remove"};Y.applyContainerArrayChanges=function(o,r,g,c,a){var h=r.astr,l=e.getComponentMethod(h,"supplyLayoutDefaults"),s=e.getComponentMethod(h,"draw"),p=e.getComponentMethod(h,"drawOne"),u=c.replot||c.recalc||l===v||s===v,i=o.layout,x=o._fullLayout;if(g[""]){Object.keys(g).length>1&&w.warn("Full array edits are incompatible with other edits",h);var f=g[""][""];if(n(f))r.set(null);else{if(!Array.isArray(f))return w.warn("Unrecognized full array edit value",h,f),!0;r.set(f)}return!u&&(l(i,x),s(o),!0)}var _,b,T,k,L,A,I,P,S=Object.keys(g).map(Number).sort(y),E=r.get(),z=E||[],D=a(x,h).get(),j=[],V=-1,Z=z.length;for(_=0;_<S.length;_++)if(k=g[T=S[_]],L=Object.keys(k),A=k[""],I=t(A),T<0||T>z.length-(I?0:1))w.warn("index out of range",h,T);else if(A!==void 0)L.length>1&&w.warn("Insertion & removal are incompatible with edits to the same index.",h,T),n(A)?j.push(T):I?(A==="add"&&(A={}),z.splice(T,0,A),D&&D.splice(T,0,{})):w.warn("Unrecognized full object edit value",h,T,A),V===-1&&(V=T);else for(b=0;b<L.length;b++)P=h+"["+T+"].",a(z[T],L[b],P).set(k[L[b]]);for(_=j.length-1;_>=0;_--)z.splice(j[_],1),D&&D.splice(j[_],1);if(z.length?E||r.set(z):r.set(null),u)return!1;if(l(i,x),p!==v){var Q;if(V===-1)Q=S;else{for(Z=Math.max(z.length,Z),Q=[],_=0;_<S.length&&!((T=S[_])>=V);_++)Q.push(T);for(_=V;_<Z;_++)Q.push(_)}for(_=0;_<Q.length;_++)p(o,Q[_])}else s(o);return!0}},{"../lib/is_plain_object":516,"../lib/loggers":519,"../lib/noop":524,"../lib/search":535,"../registry":647,"./container_array_match":547}],552:[function(m,G,Y){var d=m("@plotly/d3"),v=m("fast-isnumeric"),w=m("has-hover"),y=m("../lib"),e=y.nestedProperty,t=m("../lib/events"),n=m("../lib/queue"),o=m("../registry"),r=m("./plot_schema"),g=m("../plots/plots"),c=m("../plots/cartesian/axes"),a=m("../components/drawing"),h=m("../components/color"),l=m("../plots/cartesian/graph_interact").initInteractions,s=m("../constants/xmlns_namespaces"),p=m("../components/selections").clearOutline,u=m("./plot_config").dfltConfig,i=m("./manage_arrays"),x=m("./helpers"),f=m("./subroutines"),_=m("./edit_types"),b=m("../plots/cartesian/constants").AX_NAME_PATTERN,T=0;function k(le){var ve=le._fullLayout;ve._redrawFromAutoMarginCount?ve._redrawFromAutoMarginCount--:le.emit("plotly_afterplot")}function L(le,ve){try{le._fullLayout._paper.style("background",ve)}catch(Me){y.error(Me)}}function A(le,ve){L(le,h.combine(ve,"white"))}function I(le,ve){if(!le._context){le._context=y.extendDeep({},u);var Me=d.select("base");le._context._baseUrl=Me.size()&&Me.attr("href")?window.location.href.split("#")[0]:""}var we,de,Ie,De=le._context;if(ve){for(de=Object.keys(ve),we=0;we<de.length;we++)(Ie=de[we])!=="editable"&&Ie!=="edits"&&Ie in De&&(Ie==="setBackground"&&ve[Ie]==="opaque"?De[Ie]=A:De[Ie]=ve[Ie]);ve.plot3dPixelRatio&&!De.plotGlPixelRatio&&(De.plotGlPixelRatio=De.plot3dPixelRatio);var Oe=ve.editable;if(Oe!==void 0)for(De.editable=Oe,de=Object.keys(De.edits),we=0;we<de.length;we++)De.edits[de[we]]=Oe;if(ve.edits)for(de=Object.keys(ve.edits),we=0;we<de.length;we++)(Ie=de[we])in De.edits&&(De.edits[Ie]=ve.edits[Ie]);De._exportedPlot=ve._exportedPlot}De.staticPlot&&(De.editable=!1,De.edits={},De.autosizable=!1,De.scrollZoom=!1,De.doubleClick=!1,De.showTips=!1,De.showLink=!1,De.displayModeBar=!1),De.displayModeBar!=="hover"||w||(De.displayModeBar=!0),De.setBackground!=="transparent"&&typeof De.setBackground=="function"||(De.setBackground=L),De._hasZeroHeight=De._hasZeroHeight||le.clientHeight===0,De._hasZeroWidth=De._hasZeroWidth||le.clientWidth===0;var Ve=De.scrollZoom,Fe=De._scrollZoom={};if(Ve===!0)Fe.cartesian=1,Fe.gl3d=1,Fe.geo=1,Fe.mapbox=1;else if(typeof Ve=="string"){var ze=Ve.split("+");for(we=0;we<ze.length;we++)Fe[ze[we]]=1}else Ve!==!1&&(Fe.gl3d=1,Fe.geo=1,Fe.mapbox=1)}function P(le,ve){var Me,we,de=ve+1,Ie=[];for(Me=0;Me<le.length;Me++)(we=le[Me])<0?Ie.push(de+we):Ie.push(we);return Ie}function S(le,ve,Me){var we,de;for(we=0;we<ve.length;we++){if((de=ve[we])!==parseInt(de,10))throw new Error("all values in "+Me+" must be integers");if(de>=le.data.length||de<-le.data.length)throw new Error(Me+" must be valid indices for gd.data.");if(ve.indexOf(de,we+1)>-1||de>=0&&ve.indexOf(-le.data.length+de)>-1||de<0&&ve.indexOf(le.data.length+de)>-1)throw new Error("each index in "+Me+" must be unique.")}}function E(le,ve,Me){if(!Array.isArray(le.data))throw new Error("gd.data must be an array.");if(ve===void 0)throw new Error("currentIndices is a required argument.");if(Array.isArray(ve)||(ve=[ve]),S(le,ve,"currentIndices"),Me===void 0||Array.isArray(Me)||(Me=[Me]),Me!==void 0&&S(le,Me,"newIndices"),Me!==void 0&&ve.length!==Me.length)throw new Error("current and new indices must be of equal length.")}function z(le,ve,Me,we,de){(function(We,$e,at,gt){var xt=y.isPlainObject(gt);if(!Array.isArray(We.data))throw new Error("gd.data must be an array");if(!y.isPlainObject($e))throw new Error("update must be a key:value object");if(at===void 0)throw new Error("indices must be an integer or array of integers");for(var mt in S(We,at,"indices"),$e){if(!Array.isArray($e[mt])||$e[mt].length!==at.length)throw new Error("attribute "+mt+" must be an array of length equal to indices array length");if(xt&&(!(mt in gt)||!Array.isArray(gt[mt])||gt[mt].length!==$e[mt].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}})(le,ve,Me,we);for(var Ie=function(We,$e,at,gt){var xt,mt,nt,Qe,vt,jt=y.isPlainObject(gt),Gt=[];for(var $t in Array.isArray(at)||(at=[at]),at=P(at,We.data.length-1),$e)for(var Zt=0;Zt<at.length;Zt++){if(xt=We.data[at[Zt]],mt=(nt=e(xt,$t)).get(),Qe=$e[$t][Zt],!y.isArrayOrTypedArray(Qe))throw new Error("attribute: "+$t+" index: "+Zt+" must be an array");if(!y.isArrayOrTypedArray(mt))throw new Error("cannot extend missing or non-array attribute: "+$t);if(mt.constructor!==Qe.constructor)throw new Error("cannot extend array with an array of a different type: "+$t);vt=jt?gt[$t][Zt]:gt,v(vt)||(vt=-1),Gt.push({prop:nt,target:mt,insert:Qe,maxp:Math.floor(vt)})}return Gt}(le,ve,Me,we),De={},Oe={},Ve=0;Ve<Ie.length;Ve++){var Fe=Ie[Ve].prop,ze=Ie[Ve].maxp,Re=de(Ie[Ve].target,Ie[Ve].insert,ze);Fe.set(Re[0]),Array.isArray(De[Fe.astr])||(De[Fe.astr]=[]),De[Fe.astr].push(Re[1]),Array.isArray(Oe[Fe.astr])||(Oe[Fe.astr]=[]),Oe[Fe.astr].push(Ie[Ve].target.length)}return{update:De,maxPoints:Oe}}function D(le,ve){var Me=new le.constructor(le.length+ve.length);return Me.set(le),Me.set(ve,le.length),Me}function j(le,ve,Me,we){le=y.getGraphDiv(le),x.clearPromiseQueue(le);var de={};if(typeof ve=="string")de[ve]=Me;else{if(!y.isPlainObject(ve))return y.warn("Restyle fail.",ve,Me,we),Promise.reject();de=y.extendFlat({},ve),we===void 0&&(we=Me)}Object.keys(de).length&&(le.changed=!0);var Ie=x.coerceTraceIndices(le,we),De=X(le,de,Ie),Oe=De.flags;Oe.calc&&(le.calcdata=void 0),Oe.clearAxisTypes&&x.clearAxisTypes(le,Ie,{});var Ve=[];Oe.fullReplot?Ve.push(Y._doPlot):(Ve.push(g.previousPromises),g.supplyDefaults(le),Oe.markerSize&&(g.doCalcdata(le),N(Ve)),Oe.style&&Ve.push(f.doTraceStyle),Oe.colorbars&&Ve.push(f.doColorBars),Ve.push(k)),Ve.push(g.rehover,g.redrag,g.reselect),n.add(le,j,[le,De.undoit,De.traces],j,[le,De.redoit,De.traces]);var Fe=y.syncOrAsync(Ve,le);return Fe&&Fe.then||(Fe=Promise.resolve()),Fe.then(function(){return le.emit("plotly_restyle",De.eventData),le})}function V(le){return le===void 0?null:le}function Z(le,ve){return ve?function(Me,we,de){var Ie=e(Me,we),De=Ie.set;return Ie.set=function(Oe){Q((de||"")+we,Ie.get(),Oe,le),De(Oe)},Ie}:e}function Q(le,ve,Me,we){if(Array.isArray(ve)||Array.isArray(Me))for(var de=Array.isArray(ve)?ve:[],Ie=Array.isArray(Me)?Me:[],De=Math.max(de.length,Ie.length),Oe=0;Oe<De;Oe++)Q(le+"["+Oe+"]",de[Oe],Ie[Oe],we);else if(y.isPlainObject(ve)||y.isPlainObject(Me)){var Ve=y.isPlainObject(ve)?ve:{},Fe=y.isPlainObject(Me)?Me:{},ze=y.extendFlat({},Ve,Fe);for(var Re in ze)Q(le+"."+Re,Ve[Re],Fe[Re],we)}else we[le]===void 0&&(we[le]=V(ve))}function X(le,ve,Me){var we,de=le._fullLayout,Ie=le._fullData,De=le.data,Oe=de._guiEditing,Ve=Z(de._preGUI,Oe),Fe=y.extendDeepAll({},ve);$(ve);var ze,Re=_.traceFlags(),We={},$e={};function at(){return Me.map(function(){})}function gt(ot){var pt=c.id2name(ot);ze.indexOf(pt)===-1&&ze.push(pt)}function xt(ot){return"LAYOUT"+ot+".autorange"}function mt(ot){return"LAYOUT"+ot+".range"}function nt(ot){for(var pt=ot;pt<Ie.length;pt++)if(Ie[pt]._input===De[ot])return Ie[pt]}function Qe(ot,pt,St){if(Array.isArray(ot))ot.forEach(function(qt){Qe(qt,pt,St)});else if(!(ot in ve)&&!x.hasParent(ve,ot)){var Vt;if(ot.substr(0,6)==="LAYOUT")Vt=Ve(le.layout,ot.replace("LAYOUT",""));else{var Jt=Me[St];Vt=Z(de._tracePreGUI[nt(Jt)._fullInput.uid],Oe)(De[Jt],ot)}ot in $e||($e[ot]=at()),$e[ot][St]===void 0&&($e[ot][St]=V(Vt.get())),pt!==void 0&&Vt.set(pt)}}function vt(ot){return function(pt){return Ie[pt][ot]}}function jt(ot){return function(pt,St){return pt===!1?Ie[Me[St]][ot]:null}}for(var Gt in ve){if(x.hasParent(ve,Gt))throw new Error("cannot set "+Gt+" and a parent attribute simultaneously");var $t,Zt,cr,Dt,Ne,Ye,pe=ve[Gt];if(Gt!=="autobinx"&&Gt!=="autobiny"||(Gt=Gt.charAt(Gt.length-1)+"bins",pe=Array.isArray(pe)?pe.map(jt(Gt)):pe===!1?Me.map(vt(Gt)):null),We[Gt]=pe,Gt.substr(0,6)!=="LAYOUT"){for($e[Gt]=at(),we=0;we<Me.length;we++)if($t=De[Me[we]],Zt=nt(Me[we]),Dt=(cr=Z(de._tracePreGUI[Zt._fullInput.uid],Oe)($t,Gt)).get(),(Ne=Array.isArray(pe)?pe[we%pe.length]:pe)!==void 0){var _e=cr.parts[cr.parts.length-1],Be=Gt.substr(0,Gt.length-_e.length-1),He=Be?Be+".":"",Je=Be?e(Zt,Be).get():Zt;if((Ye=r.getTraceValObject(Zt,cr.parts))&&Ye.impliedEdits&&Ne!==null)for(var Ze in Ye.impliedEdits)Qe(y.relativeAttr(Gt,Ze),Ye.impliedEdits[Ze],we);else if(_e!=="thicknessmode"&&_e!=="lenmode"||Dt===Ne||Ne!=="fraction"&&Ne!=="pixels"||!Je){if(Gt==="type"&&(Ne==="pie"!=(Dt==="pie")||Ne==="funnelarea"!=(Dt==="funnelarea"))){var ct="x",lt="y";Ne!=="bar"&&Dt!=="bar"||$t.orientation!=="h"||(ct="y",lt="x"),y.swapAttrs($t,["?","?src"],"labels",ct),y.swapAttrs($t,["d?","?0"],"label",ct),y.swapAttrs($t,["?","?src"],"values",lt),Dt==="pie"||Dt==="funnelarea"?(e($t,"marker.color").set(e($t,"marker.colors").get()),de._pielayer.selectAll("g.trace").remove()):o.traceIs($t,"cartesian")&&e($t,"marker.colors").set(e($t,"marker.color").get())}}else{var At=de._size,Ot=Je.orient,it=Ot==="top"||Ot==="bottom";if(_e==="thicknessmode"){var ht=it?At.h:At.w;Qe(He+"thickness",Je.thickness*(Ne==="fraction"?1/ht:ht),we)}else{var Ut=it?At.w:At.h;Qe(He+"len",Je.len*(Ne==="fraction"?1/Ut:Ut),we)}}if($e[Gt][we]=V(Dt),["swapxy","swapxyaxes","orientation","orientationaxes"].indexOf(Gt)!==-1){if(Gt==="orientation"){cr.set(Ne);var Mt=$t.x&&!$t.y?"h":"v";if((cr.get()||Mt)===Zt.orientation)continue}else Gt==="orientationaxes"&&($t.orientation={v:"h",h:"v"}[Zt.orientation]);x.swapXYData($t),Re.calc=Re.clearAxisTypes=!0}else g.dataArrayContainers.indexOf(cr.parts[0])!==-1?(x.manageArrayContainers(cr,Ne,$e),Re.calc=!0):(Ye?Ye.arrayOk&&!o.traceIs(Zt,"regl")&&(y.isArrayOrTypedArray(Ne)||y.isArrayOrTypedArray(Dt))?Re.calc=!0:_.update(Re,Ye):Re.calc=!0,cr.set(Ne))}if(["swapxyaxes","orientationaxes"].indexOf(Gt)!==-1&&c.swap(le,Me),Gt==="orientationaxes"){var It=e(le.layout,"hovermode"),Le=It.get();Le==="x"?It.set("y"):Le==="y"?It.set("x"):Le==="x unified"?It.set("y unified"):Le==="y unified"&&It.set("x unified")}if(["orientation","type"].indexOf(Gt)!==-1){for(ze=[],we=0;we<Me.length;we++){var Xe=De[Me[we]];o.traceIs(Xe,"cartesian")&&(gt(Xe.xaxis||"x"),gt(Xe.yaxis||"y"))}Qe(ze.map(xt),!0,0),Qe(ze.map(mt),[0,1],0)}}else cr=Ve(le.layout,Gt.replace("LAYOUT","")),$e[Gt]=[V(cr.get())],cr.set(Array.isArray(pe)?pe[0]:pe),Re.calc=!0}return(Re.calc||Re.plot)&&(Re.fullReplot=!0),{flags:Re,undoit:$e,redoit:We,traces:Me,eventData:y.extendDeepNoArrays([],[Fe,Me])}}function $(le){var ve,Me,we,de=y.counterRegex("axis",".title",!1,!1),Ie=/colorbar\.title$/,De=Object.keys(le);for(ve=0;ve<De.length;ve++)Me=De[ve],we=le[Me],Me!=="title"&&!de.test(Me)&&!Ie.test(Me)||typeof we!="string"&&typeof we!="number"?Me.indexOf("titlefont")>-1&&Me.indexOf("grouptitlefont")===-1?Oe(Me,Me.replace("titlefont","title.font")):Me.indexOf("titleposition")>-1?Oe(Me,Me.replace("titleposition","title.position")):Me.indexOf("titleside")>-1?Oe(Me,Me.replace("titleside","title.side")):Me.indexOf("titleoffset")>-1&&Oe(Me,Me.replace("titleoffset","title.offset")):Oe(Me,Me.replace("title","title.text"));function Oe(Ve,Fe){le[Fe]=le[Ve],delete le[Ve]}}function re(le,ve,Me){le=y.getGraphDiv(le),x.clearPromiseQueue(le);var we={};if(typeof ve=="string")we[ve]=Me;else{if(!y.isPlainObject(ve))return y.warn("Relayout fail.",ve,Me),Promise.reject();we=y.extendFlat({},ve)}Object.keys(we).length&&(le.changed=!0);var de=K(le,we),Ie=de.flags;Ie.calc&&(le.calcdata=void 0);var De=[g.previousPromises];Ie.layoutReplot?De.push(f.layoutReplot):Object.keys(we).length&&(H(le,Ie,de)||g.supplyDefaults(le),Ie.legend&&De.push(f.doLegend),Ie.layoutstyle&&De.push(f.layoutStyles),Ie.axrange&&N(De,de.rangesAltered),Ie.ticks&&De.push(f.doTicksRelayout),Ie.modebar&&De.push(f.doModeBar),Ie.camera&&De.push(f.doCamera),Ie.colorbars&&De.push(f.doColorBars),De.push(k)),De.push(g.rehover,g.redrag,g.reselect),n.add(le,re,[le,de.undoit],re,[le,de.redoit]);var Oe=y.syncOrAsync(De,le);return Oe&&Oe.then||(Oe=Promise.resolve(le)),Oe.then(function(){return le.emit("plotly_relayout",de.eventData),le})}function H(le,ve,Me){var we=le._fullLayout;if(!ve.axrange)return!1;for(var de in ve)if(de!=="axrange"&&ve[de])return!1;for(var Ie in Me.rangesAltered){var De=c.id2name(Ie),Oe=le.layout[De],Ve=we[De];if(Ve.autorange=Oe.autorange,Oe.range&&(Ve.range=Oe.range.slice()),Ve.cleanRange(),Ve._matchGroup){for(var Fe in Ve._matchGroup)if(Fe!==Ie){var ze=we[c.id2name(Fe)];ze.autorange=Ve.autorange,ze.range=Ve.range.slice(),ze._input.range=Ve.range.slice()}}}return!0}function N(le,ve){var Me=ve?function(we){var de=[];for(var Ie in ve){var De=c.getFromId(we,Ie);if(de.push(Ie),(De.ticklabelposition||"").indexOf("inside")!==-1&&De._anchorAxis&&de.push(De._anchorAxis._id),De._matchGroup)for(var Oe in De._matchGroup)ve[Oe]||de.push(Oe)}return c.draw(we,de,{skipTitle:!0})}:function(we){return c.draw(we,"redraw")};le.push(p,f.doAutoRangeAndConstraints,Me,f.drawData,f.finalDraw)}var U=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,te=/^[xyz]axis[0-9]*\.autorange$/,B=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function K(le,ve){var Me,we,de,Ie=le.layout,De=le._fullLayout,Oe=De._guiEditing,Ve=Z(De._preGUI,Oe),Fe=Object.keys(ve),ze=c.list(le),Re=y.extendDeepAll({},ve),We={};for($(ve),Fe=Object.keys(ve),we=0;we<Fe.length;we++)if(Fe[we].indexOf("allaxes")===0){for(de=0;de<ze.length;de++){var $e=ze[de]._id.substr(1),at=$e.indexOf("scene")!==-1?$e+".":"",gt=Fe[we].replace("allaxes",at+ze[de]._name);ve[gt]||(ve[gt]=ve[Fe[we]])}delete ve[Fe[we]]}var xt=_.layoutFlags(),mt={},nt={};function Qe(Jt,qt){if(Array.isArray(Jt))Jt.forEach(function(Cr){Qe(Cr,qt)});else if(!(Jt in ve)&&!x.hasParent(ve,Jt)){var gr=Ve(Ie,Jt);Jt in nt||(nt[Jt]=V(gr.get())),qt!==void 0&&gr.set(qt)}}var vt,jt={};function Gt(Jt){var qt=c.name2id(Jt.split(".")[0]);return jt[qt]=1,qt}for(var $t in ve){if(x.hasParent(ve,$t))throw new Error("cannot set "+$t+" and a parent attribute simultaneously");for(var Zt=Ve(Ie,$t),cr=ve[$t],Dt=Zt.parts.length-1;Dt>0&&typeof Zt.parts[Dt]!="string";)Dt--;var Ne=Zt.parts[Dt],Ye=Zt.parts[Dt-1]+"."+Ne,pe=Zt.parts.slice(0,Dt).join("."),_e=e(le.layout,pe).get(),Be=e(De,pe).get(),He=Zt.get();if(cr!==void 0){mt[$t]=cr,nt[$t]=Ne==="reverse"?cr:V(He);var Je=r.getLayoutValObject(De,Zt.parts);if(Je&&Je.impliedEdits&&cr!==null)for(var Ze in Je.impliedEdits)Qe(y.relativeAttr($t,Ze),Je.impliedEdits[Ze]);if(["width","height"].indexOf($t)!==-1)if(cr){Qe("autosize",null);var ct=$t==="height"?"width":"height";Qe(ct,De[ct])}else De[$t]=le._initialAutoSize[$t];else if($t==="autosize")Qe("width",cr?null:De.width),Qe("height",cr?null:De.height);else if(Ye.match(U))Gt(Ye),e(De,pe+"._inputRange").set(null);else if(Ye.match(te)){Gt(Ye),e(De,pe+"._inputRange").set(null);var lt=e(De,pe).get();lt._inputDomain&&(lt._input.domain=lt._inputDomain.slice())}else Ye.match(B)&&e(De,pe+"._inputDomain").set(null);if(Ne==="type"){vt=_e;var At=Be.type==="linear"&&cr==="log",Ot=Be.type==="log"&&cr==="linear";if(At||Ot){if(vt&&vt.range)if(Be.autorange)At&&(vt.range=vt.range[1]>vt.range[0]?[1,2]:[2,1]);else{var it=vt.range[0],ht=vt.range[1];At?(it<=0&&ht<=0&&Qe(pe+".autorange",!0),it<=0?it=ht/1e6:ht<=0&&(ht=it/1e6),Qe(pe+".range[0]",Math.log(it)/Math.LN10),Qe(pe+".range[1]",Math.log(ht)/Math.LN10)):(Qe(pe+".range[0]",Math.pow(10,it)),Qe(pe+".range[1]",Math.pow(10,ht)))}else Qe(pe+".autorange",!0);Array.isArray(De._subplots.polar)&&De._subplots.polar.length&&De[Zt.parts[0]]&&Zt.parts[1]==="radialaxis"&&delete De[Zt.parts[0]]._subplot.viewInitial["radialaxis.range"],o.getComponentMethod("annotations","convertCoords")(le,Be,cr,Qe),o.getComponentMethod("images","convertCoords")(le,Be,cr,Qe)}else Qe(pe+".autorange",!0),Qe(pe+".range",null);e(De,pe+"._inputRange").set(null)}else if(Ne.match(b)){var Ut=e(De,$t).get(),Mt=(cr||{}).type;Mt&&Mt!=="-"||(Mt="linear"),o.getComponentMethod("annotations","convertCoords")(le,Ut,Mt,Qe),o.getComponentMethod("images","convertCoords")(le,Ut,Mt,Qe)}var It=i.containerArrayMatch($t);if(It){Me=It.array,we=It.index;var Le=It.property,Xe=Je||{editType:"calc"};we!==""&&Le===""&&(i.isAddVal(cr)?nt[$t]=null:i.isRemoveVal(cr)?nt[$t]=(e(Ie,Me).get()||[])[we]:y.warn("unrecognized full object value",ve)),_.update(xt,Xe),We[Me]||(We[Me]={});var ot=We[Me][we];ot||(ot=We[Me][we]={}),ot[Le]=cr,delete ve[$t]}else Ne==="reverse"?(_e.range?_e.range.reverse():(Qe(pe+".autorange",!0),_e.range=[1,0]),Be.autorange?xt.calc=!0:xt.plot=!0):($t==="dragmode"&&(cr===!1&&He!==!1||cr!==!1&&He===!1)||De._has("scatter-like")&&De._has("regl")&&$t==="dragmode"&&(cr==="lasso"||cr==="select")&&He!=="lasso"&&He!=="select"||De._has("gl2d")?xt.plot=!0:Je?_.update(xt,Je):xt.calc=!0,Zt.set(cr))}}for(Me in We)i.applyContainerArrayChanges(le,Ve(Ie,Me),We[Me],xt,Ve)||(xt.plot=!0);for(var pt in jt){var St=(vt=c.getFromId(le,pt))&&vt._constraintGroup;if(St)for(var Vt in xt.calc=!0,St)jt[Vt]||(c.getFromId(le,Vt)._constraintShrinkable=!0)}return(J(le)||ve.height||ve.width)&&(xt.plot=!0),(xt.plot||xt.calc)&&(xt.layoutReplot=!0),{flags:xt,rangesAltered:jt,undoit:nt,redoit:mt,eventData:Re}}function J(le){var ve=le._fullLayout,Me=ve.width,we=ve.height;return le.layout.autosize&&g.plotAutoSize(le,le.layout,ve),ve.width!==Me||ve.height!==we}function ee(le,ve,Me,we){le=y.getGraphDiv(le),x.clearPromiseQueue(le),y.isPlainObject(ve)||(ve={}),y.isPlainObject(Me)||(Me={}),Object.keys(ve).length&&(le.changed=!0),Object.keys(Me).length&&(le.changed=!0);var de=x.coerceTraceIndices(le,we),Ie=X(le,y.extendFlat({},ve),de),De=Ie.flags,Oe=K(le,y.extendFlat({},Me)),Ve=Oe.flags;(De.calc||Ve.calc)&&(le.calcdata=void 0),De.clearAxisTypes&&x.clearAxisTypes(le,de,Me);var Fe=[];Ve.layoutReplot?Fe.push(f.layoutReplot):De.fullReplot?Fe.push(Y._doPlot):(Fe.push(g.previousPromises),H(le,Ve,Oe)||g.supplyDefaults(le),De.style&&Fe.push(f.doTraceStyle),(De.colorbars||Ve.colorbars)&&Fe.push(f.doColorBars),Ve.legend&&Fe.push(f.doLegend),Ve.layoutstyle&&Fe.push(f.layoutStyles),Ve.axrange&&N(Fe,Oe.rangesAltered),Ve.ticks&&Fe.push(f.doTicksRelayout),Ve.modebar&&Fe.push(f.doModeBar),Ve.camera&&Fe.push(f.doCamera),Fe.push(k)),Fe.push(g.rehover,g.redrag,g.reselect),n.add(le,ee,[le,Ie.undoit,Oe.undoit,Ie.traces],ee,[le,Ie.redoit,Oe.redoit,Ie.traces]);var ze=y.syncOrAsync(Fe,le);return ze&&ze.then||(ze=Promise.resolve(le)),ze.then(function(){return le.emit("plotly_update",{data:Ie.eventData,layout:Oe.eventData}),le})}function ne(le){return function(ve){ve._fullLayout._guiEditing=!0;var Me=le.apply(null,arguments);return ve._fullLayout._guiEditing=!1,Me}}var se=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],oe=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function me(le,ve){for(var Me=0;Me<ve.length;Me++){var we=ve[Me],de=le.match(we.pattern);if(de){var Ie=de[1]||"";return{head:Ie,tail:le.substr(Ie.length+1),attr:we.attr}}}}function ce(le,ve){var Me=e(ve,le).get();if(Me!==void 0)return Me;var we=le.split(".");for(we.pop();we.length>1;)if(we.pop(),(Me=e(ve,we.join(".")+".uirevision").get())!==void 0)return Me;return ve.uirevision}function ye(le,ve){for(var Me=0;Me<ve.length;Me++)if(ve[Me]._fullInput.uid===le)return Me;return-1}function Se(le,ve,Me){for(var we=0;we<ve.length;we++)if(ve[we].uid===le)return we;return!ve[Me]||ve[Me].uid?-1:Me}function fe(le,ve){var Me=y.isPlainObject(le),we=Array.isArray(le);return Me||we?(Me&&y.isPlainObject(ve)||we&&Array.isArray(ve))&&JSON.stringify(le)===JSON.stringify(ve):le===ve}function ge(le,ve,Me,we){var de,Ie,De,Oe=we.getValObject,Ve=we.flags,Fe=we.immutable,ze=we.inArray,Re=we.arrayIndex;function We(){var _e=de.editType;ze&&_e.indexOf("arraydraw")!==-1?y.pushUnique(Ve.arrays[ze],Re):(_.update(Ve,de),_e!=="none"&&Ve.nChanges++,we.transition&&de.anim&&Ve.nChangesAnim++,(U.test(De)||te.test(De))&&(Ve.rangesAltered[Me[0]]=1),B.test(De)&&e(ve,"_inputDomain").set(null),Ie==="datarevision"&&(Ve.newDataRevision=1))}function $e(_e){return _e.valType==="data_array"||_e.arrayOk}for(Ie in le){if(Ve.calc&&!we.transition)return;var at=le[Ie],gt=ve[Ie],xt=Me.concat(Ie);if(De=xt.join("."),Ie.charAt(0)!=="_"&&typeof at!="function"&&at!==gt){if((Ie==="tick0"||Ie==="dtick")&&Me[0]!=="geo"){var mt=ve.tickmode;if(mt==="auto"||mt==="array"||!mt)continue}if((Ie!=="range"||!ve.autorange)&&(Ie!=="zmin"&&Ie!=="zmax"||ve.type!=="contourcarpet")&&(de=Oe(xt))&&(!de._compareAsJSON||JSON.stringify(at)!==JSON.stringify(gt))){var nt,Qe=de.valType,vt=$e(de),jt=Array.isArray(at),Gt=Array.isArray(gt);if(jt&&Gt){var $t="_input_"+Ie,Zt=le[$t],cr=ve[$t];if(Array.isArray(Zt)&&Zt===cr)continue}if(gt===void 0)vt&&jt?Ve.calc=!0:We();else if(de._isLinkedToArray){var Dt=[],Ne=!1;ze||(Ve.arrays[Ie]=Dt);var Ye=Math.min(at.length,gt.length),pe=Math.max(at.length,gt.length);if(Ye!==pe){if(de.editType!=="arraydraw"){We();continue}Ne=!0}for(nt=0;nt<Ye;nt++)ge(at[nt],gt[nt],xt.concat(nt),y.extendFlat({inArray:Ie,arrayIndex:nt},we));if(Ne)for(nt=Ye;nt<pe;nt++)Dt.push(nt)}else!Qe&&y.isPlainObject(at)?ge(at,gt,xt,we):vt?jt&&Gt?(Fe&&(Ve.calc=!0),(Fe||we.newDataRevision)&&We()):jt!==Gt?Ve.calc=!0:We():jt&&Gt&&at.length===gt.length&&String(at)===String(gt)||We()}}}for(Ie in ve)if(!(Ie in le)&&Ie.charAt(0)!=="_"&&typeof ve[Ie]!="function"){if($e(de=Oe(Me.concat(Ie)))&&Array.isArray(ve[Ie]))return void(Ve.calc=!0);We()}}function Te(le){var ve=le._fullLayout,Me=le.getBoundingClientRect();if(!y.equalDomRects(Me,ve._lastBBox)){var we=ve._invTransform=y.inverseTransformMatrix(y.getFullTransformMatrix(le));ve._invScaleX=Math.sqrt(we[0][0]*we[0][0]+we[0][1]*we[0][1]+we[0][2]*we[0][2]),ve._invScaleY=Math.sqrt(we[1][0]*we[1][0]+we[1][1]*we[1][1]+we[1][2]*we[1][2]),ve._lastBBox=Me}}Y.animate=function(le,ve,Me){if(le=y.getGraphDiv(le),!y.isPlotDiv(le))throw new Error("This element is not a Plotly plot: "+le+". It's likely that you've failed to create a plot before animating it. For more details, see https://plotly.com/javascript/animations/");var we=le._transitionData;we._frameQueue||(we._frameQueue=[]);var de=(Me=g.supplyAnimationDefaults(Me)).transition,Ie=Me.frame;function De(Fe){return Array.isArray(de)?Fe>=de.length?de[0]:de[Fe]:de}function Oe(Fe){return Array.isArray(Ie)?Fe>=Ie.length?Ie[0]:Ie[Fe]:Ie}function Ve(Fe,ze){var Re=0;return function(){if(Fe&&++Re===ze)return Fe()}}return we._frameWaitingCnt===void 0&&(we._frameWaitingCnt=0),new Promise(function(Fe,ze){function Re(){we._currentFrame&&we._currentFrame.onComplete&&we._currentFrame.onComplete();var Zt=we._currentFrame=we._frameQueue.shift();if(Zt){var cr=Zt.name?Zt.name.toString():null;le._fullLayout._currentFrame=cr,we._lastFrameAt=Date.now(),we._timeToNext=Zt.frameOpts.duration,g.transition(le,Zt.frame.data,Zt.frame.layout,x.coerceTraceIndices(le,Zt.frame.traces),Zt.frameOpts,Zt.transitionOpts).then(function(){Zt.onComplete&&Zt.onComplete()}),le.emit("plotly_animatingframe",{name:cr,frame:Zt.frame,animation:{frame:Zt.frameOpts,transition:Zt.transitionOpts}})}else le.emit("plotly_animated"),window.cancelAnimationFrame(we._animationRaf),we._animationRaf=null}function We(){le.emit("plotly_animating"),we._lastFrameAt=-1/0,we._timeToNext=0,we._runningTransitions=0,we._currentFrame=null;var Zt=function(){we._animationRaf=window.requestAnimationFrame(Zt),Date.now()-we._lastFrameAt>we._timeToNext&&Re()};Zt()}var $e,at,gt=0;function xt(Zt){return Array.isArray(de)?gt>=de.length?Zt.transitionOpts=de[gt]:Zt.transitionOpts=de[0]:Zt.transitionOpts=de,gt++,Zt}var mt=[],nt=ve==null,Qe=Array.isArray(ve);if(!nt&&!Qe&&y.isPlainObject(ve))mt.push({type:"object",data:xt(y.extendFlat({},ve))});else if(nt||["string","number"].indexOf(typeof ve)!==-1)for($e=0;$e<we._frames.length;$e++)(at=we._frames[$e])&&(nt||String(at.group)===String(ve))&&mt.push({type:"byname",name:String(at.name),data:xt({name:at.name})});else if(Qe)for($e=0;$e<ve.length;$e++){var vt=ve[$e];["number","string"].indexOf(typeof vt)!==-1?(vt=String(vt),mt.push({type:"byname",name:vt,data:xt({name:vt})})):y.isPlainObject(vt)&&mt.push({type:"object",data:xt(y.extendFlat({},vt))})}for($e=0;$e<mt.length;$e++)if((at=mt[$e]).type==="byname"&&!we._frameHash[at.data.name])return y.warn('animate failure: frame not found: "'+at.data.name+'"'),void ze();["next","immediate"].indexOf(Me.mode)!==-1&&function(){if(we._frameQueue.length!==0){for(;we._frameQueue.length;){var Zt=we._frameQueue.pop();Zt.onInterrupt&&Zt.onInterrupt()}le.emit("plotly_animationinterrupted",[])}}(),Me.direction==="reverse"&&mt.reverse();var jt=le._fullLayout._currentFrame;if(jt&&Me.fromcurrent){var Gt=-1;for($e=0;$e<mt.length;$e++)if((at=mt[$e]).type==="byname"&&at.name===jt){Gt=$e;break}if(Gt>0&&Gt<mt.length-1){var $t=[];for($e=0;$e<mt.length;$e++)at=mt[$e],(mt[$e].type!=="byname"||$e>Gt)&&$t.push(at);mt=$t}}mt.length>0?function(Zt){if(Zt.length!==0){for(var cr=0;cr<Zt.length;cr++){var Dt;Dt=Zt[cr].type==="byname"?g.computeFrame(le,Zt[cr].name):Zt[cr].data;var Ne=Oe(cr),Ye=De(cr);Ye.duration=Math.min(Ye.duration,Ne.duration);var pe={frame:Dt,name:Zt[cr].name,frameOpts:Ne,transitionOpts:Ye};cr===Zt.length-1&&(pe.onComplete=Ve(Fe,2),pe.onInterrupt=ze),we._frameQueue.push(pe)}Me.mode==="immediate"&&(we._lastFrameAt=-1/0),we._animationRaf||We()}}(mt):(le.emit("plotly_animated"),Fe())})},Y.addFrames=function(le,ve,Me){if(le=y.getGraphDiv(le),ve==null)return Promise.resolve();if(!y.isPlotDiv(le))throw new Error("This element is not a Plotly plot: "+le+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plotly.com/javascript/animations/");var we,de,Ie,De,Oe=le._transitionData._frames,Ve=le._transitionData._frameHash;if(!Array.isArray(ve))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+ve);var Fe=Oe.length+2*ve.length,ze=[],Re={};for(we=ve.length-1;we>=0;we--)if(y.isPlainObject(ve[we])){var We=ve[we].name,$e=(Ve[We]||Re[We]||{}).name,at=ve[we].name,gt=Ve[$e]||Re[$e];$e&&at&&typeof at=="number"&&gt&&T<5&&(T++,y.warn('addFrames: overwriting frame "'+(Ve[$e]||Re[$e]).name+'" with a frame whose name of type "number" also equates to "'+$e+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),T===5&&y.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),Re[We]={name:We},ze.push({frame:g.supplyFrameDefaults(ve[we]),index:Me&&Me[we]!==void 0&&Me[we]!==null?Me[we]:Fe+we})}ze.sort(function($t,Zt){return $t.index>Zt.index?-1:$t.index<Zt.index?1:0});var xt=[],mt=[],nt=Oe.length;for(we=ze.length-1;we>=0;we--){if(typeof(de=ze[we].frame).name=="number"&&y.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!de.name)for(;Ve[de.name="frame "+le._transitionData._counter++];);if(Ve[de.name]){for(Ie=0;Ie<Oe.length&&(Oe[Ie]||{}).name!==de.name;Ie++);xt.push({type:"replace",index:Ie,value:de}),mt.unshift({type:"replace",index:Ie,value:Oe[Ie]})}else De=Math.max(0,Math.min(ze[we].index,nt)),xt.push({type:"insert",index:De,value:de}),mt.unshift({type:"delete",index:De}),nt++}var Qe=g.modifyFrames,vt=g.modifyFrames,jt=[le,mt],Gt=[le,xt];return n&&n.add(le,Qe,jt,vt,Gt),g.modifyFrames(le,xt)},Y.deleteFrames=function(le,ve){if(le=y.getGraphDiv(le),!y.isPlotDiv(le))throw new Error("This element is not a Plotly plot: "+le);var Me,we,de=le._transitionData._frames,Ie=[],De=[];if(!ve)for(ve=[],Me=0;Me<de.length;Me++)ve.push(Me);for((ve=ve.slice()).sort(),Me=ve.length-1;Me>=0;Me--)we=ve[Me],Ie.push({type:"delete",index:we}),De.unshift({type:"insert",index:we,value:de[we]});var Oe=g.modifyFrames,Ve=g.modifyFrames,Fe=[le,De],ze=[le,Ie];return n&&n.add(le,Oe,Fe,Ve,ze),g.modifyFrames(le,Ie)},Y.addTraces=function le(ve,Me,we){ve=y.getGraphDiv(ve);var de,Ie,De=[],Oe=Y.deleteTraces,Ve=le,Fe=[ve,De],ze=[ve,Me];for(function(Re,We,$e){var at,gt;if(!Array.isArray(Re.data))throw new Error("gd.data must be an array.");if(We===void 0)throw new Error("traces must be defined.");for(Array.isArray(We)||(We=[We]),at=0;at<We.length;at++)if(typeof(gt=We[at])!="object"||Array.isArray(gt)||gt===null)throw new Error("all values in traces array must be non-array objects");if($e===void 0||Array.isArray($e)||($e=[$e]),$e!==void 0&&$e.length!==We.length)throw new Error("if indices is specified, traces.length must equal indices.length")}(ve,Me,we),Array.isArray(Me)||(Me=[Me]),Me=Me.map(function(Re){return y.extendFlat({},Re)}),x.cleanData(Me),de=0;de<Me.length;de++)ve.data.push(Me[de]);for(de=0;de<Me.length;de++)De.push(-Me.length+de);if(we===void 0)return Ie=Y.redraw(ve),n.add(ve,Oe,Fe,Ve,ze),Ie;Array.isArray(we)||(we=[we]);try{E(ve,De,we)}catch(Re){throw ve.data.splice(ve.data.length-Me.length,Me.length),Re}return n.startSequence(ve),n.add(ve,Oe,Fe,Ve,ze),Ie=Y.moveTraces(ve,De,we),n.stopSequence(ve),Ie},Y.deleteTraces=function le(ve,Me){ve=y.getGraphDiv(ve);var we,de,Ie=[],De=Y.addTraces,Oe=le,Ve=[ve,Ie,Me],Fe=[ve,Me];if(Me===void 0)throw new Error("indices must be an integer or array of integers.");for(Array.isArray(Me)||(Me=[Me]),S(ve,Me,"indices"),(Me=P(Me,ve.data.length-1)).sort(y.sorterDes),we=0;we<Me.length;we+=1)de=ve.data.splice(Me[we],1)[0],Ie.push(de);var ze=Y.redraw(ve);return n.add(ve,De,Ve,Oe,Fe),ze},Y.extendTraces=function le(ve,Me,we,de){function Ie(Fe,ze,Re){var We,$e;if(y.isTypedArray(Fe))if(Re<0){var at=new Fe.constructor(0),gt=D(Fe,ze);Re<0?(We=gt,$e=at):(We=at,$e=gt)}else if(We=new Fe.constructor(Re),$e=new Fe.constructor(Fe.length+ze.length-Re),Re===ze.length)We.set(ze),$e.set(Fe);else if(Re<ze.length){var xt=ze.length-Re;We.set(ze.subarray(xt)),$e.set(Fe),$e.set(ze.subarray(0,xt),Fe.length)}else{var mt=Re-ze.length,nt=Fe.length-mt;We.set(Fe.subarray(nt)),We.set(ze,mt),$e.set(Fe.subarray(0,nt))}else We=Fe.concat(ze),$e=Re>=0&&Re<We.length?We.splice(0,We.length-Re):[];return[We,$e]}var De=z(ve=y.getGraphDiv(ve),Me,we,de,Ie),Oe=Y.redraw(ve),Ve=[ve,De.update,we,De.maxPoints];return n.add(ve,Y.prependTraces,Ve,le,arguments),Oe},Y.moveTraces=function le(ve,Me,we){var de,Ie=[],De=[],Oe=le,Ve=le,Fe=[ve=y.getGraphDiv(ve),we,Me],ze=[ve,Me,we];if(E(ve,Me,we),Me=Array.isArray(Me)?Me:[Me],we===void 0)for(we=[],de=0;de<Me.length;de++)we.push(-Me.length+de);for(we=Array.isArray(we)?we:[we],Me=P(Me,ve.data.length-1),we=P(we,ve.data.length-1),de=0;de<ve.data.length;de++)Me.indexOf(de)===-1&&Ie.push(ve.data[de]);for(de=0;de<Me.length;de++)De.push({newIndex:we[de],trace:ve.data[Me[de]]});for(De.sort(function(We,$e){return We.newIndex-$e.newIndex}),de=0;de<De.length;de+=1)Ie.splice(De[de].newIndex,0,De[de].trace);ve.data=Ie;var Re=Y.redraw(ve);return n.add(ve,Oe,Fe,Ve,ze),Re},Y.prependTraces=function le(ve,Me,we,de){function Ie(Fe,ze,Re){var We,$e;if(y.isTypedArray(Fe))if(Re<=0){var at=new Fe.constructor(0),gt=D(ze,Fe);Re<0?(We=gt,$e=at):(We=at,$e=gt)}else if(We=new Fe.constructor(Re),$e=new Fe.constructor(Fe.length+ze.length-Re),Re===ze.length)We.set(ze),$e.set(Fe);else if(Re<ze.length){var xt=ze.length-Re;We.set(ze.subarray(0,xt)),$e.set(ze.subarray(xt)),$e.set(Fe,xt)}else{var mt=Re-ze.length;We.set(ze),We.set(Fe.subarray(0,mt),ze.length),$e.set(Fe.subarray(mt))}else We=ze.concat(Fe),$e=Re>=0&&Re<We.length?We.splice(Re,We.length):[];return[We,$e]}var De=z(ve=y.getGraphDiv(ve),Me,we,de,Ie),Oe=Y.redraw(ve),Ve=[ve,De.update,we,De.maxPoints];return n.add(ve,Y.extendTraces,Ve,le,arguments),Oe},Y.newPlot=function(le,ve,Me,we){return le=y.getGraphDiv(le),g.cleanPlot([],{},le._fullData||[],le._fullLayout||{}),g.purge(le),Y._doPlot(le,ve,Me,we)},Y._doPlot=function(le,ve,Me,we){var de;if(le=y.getGraphDiv(le),t.init(le),y.isPlainObject(ve)){var Ie=ve;ve=Ie.data,Me=Ie.layout,we=Ie.config,de=Ie.frames}if(t.triggerHandler(le,"plotly_beforeplot",[ve,Me,we])===!1)return Promise.reject();ve||Me||y.isPlotDiv(le)||y.warn("Calling _doPlot as if redrawing but this container doesn't yet have a plot.",le),I(le,we),Me||(Me={}),d.select(le).classed("js-plotly-plot",!0),a.makeTester(),Array.isArray(le._promises)||(le._promises=[]);var De=(le.data||[]).length===0&&Array.isArray(ve);Array.isArray(ve)&&(x.cleanData(ve),De?le.data=ve:le.data.push.apply(le.data,ve),le.empty=!1),le.layout&&!De||(le.layout=x.cleanLayout(Me)),g.supplyDefaults(le);var Oe=le._fullLayout,Ve=Oe._has("cartesian");Oe._replotting=!0,(De||Oe._shouldCreateBgLayer)&&(function(mt){var nt=d.select(mt),Qe=mt._fullLayout;if(Qe._calcInverseTransform=Te,Qe._calcInverseTransform(mt),Qe._container=nt.selectAll(".plot-container").data([0]),Qe._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),Qe._paperdiv=Qe._container.selectAll(".svg-container").data([0]),Qe._paperdiv.enter().append("div").classed("user-select-none",!0).classed("svg-container",!0).style("position","relative"),Qe._glcontainer=Qe._paperdiv.selectAll(".gl-container").data([{}]),Qe._glcontainer.enter().append("div").classed("gl-container",!0),Qe._paperdiv.selectAll(".main-svg").remove(),Qe._paperdiv.select(".modebar-container").remove(),Qe._paper=Qe._paperdiv.insert("svg",":first-child").classed("main-svg",!0),Qe._toppaper=Qe._paperdiv.append("svg").classed("main-svg",!0),Qe._modebardiv=Qe._paperdiv.append("div"),delete Qe._modeBar,Qe._hoverpaper=Qe._paperdiv.append("svg").classed("main-svg",!0),!Qe._uid){var vt={};d.selectAll("defs").each(function(){this.id&&(vt[this.id.split("-")[1]]=1)}),Qe._uid=y.randstr(vt)}Qe._paperdiv.selectAll(".main-svg").attr(s.svgAttrs),Qe._defs=Qe._paper.append("defs").attr("id","defs-"+Qe._uid),Qe._clips=Qe._defs.append("g").classed("clips",!0),Qe._topdefs=Qe._toppaper.append("defs").attr("id","topdefs-"+Qe._uid),Qe._topclips=Qe._topdefs.append("g").classed("clips",!0),Qe._bgLayer=Qe._paper.append("g").classed("bglayer",!0),Qe._draggers=Qe._paper.append("g").classed("draglayer",!0);var jt=Qe._paper.append("g").classed("layer-below",!0);Qe._imageLowerLayer=jt.append("g").classed("imagelayer",!0),Qe._shapeLowerLayer=jt.append("g").classed("shapelayer",!0),Qe._cartesianlayer=Qe._paper.append("g").classed("cartesianlayer",!0),Qe._polarlayer=Qe._paper.append("g").classed("polarlayer",!0),Qe._smithlayer=Qe._paper.append("g").classed("smithlayer",!0),Qe._ternarylayer=Qe._paper.append("g").classed("ternarylayer",!0),Qe._geolayer=Qe._paper.append("g").classed("geolayer",!0),Qe._funnelarealayer=Qe._paper.append("g").classed("funnelarealayer",!0),Qe._pielayer=Qe._paper.append("g").classed("pielayer",!0),Qe._iciclelayer=Qe._paper.append("g").classed("iciclelayer",!0),Qe._treemaplayer=Qe._paper.append("g").classed("treemaplayer",!0),Qe._sunburstlayer=Qe._paper.append("g").classed("sunburstlayer",!0),Qe._indicatorlayer=Qe._toppaper.append("g").classed("indicatorlayer",!0),Qe._glimages=Qe._paper.append("g").classed("glimages",!0);var Gt=Qe._toppaper.append("g").classed("layer-above",!0);Qe._imageUpperLayer=Gt.append("g").classed("imagelayer",!0),Qe._shapeUpperLayer=Gt.append("g").classed("shapelayer",!0),Qe._selectionLayer=Qe._toppaper.append("g").classed("selectionlayer",!0),Qe._infolayer=Qe._toppaper.append("g").classed("infolayer",!0),Qe._menulayer=Qe._toppaper.append("g").classed("menulayer",!0),Qe._zoomlayer=Qe._toppaper.append("g").classed("zoomlayer",!0),Qe._hoverlayer=Qe._hoverpaper.append("g").classed("hoverlayer",!0),Qe._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),mt.emit("plotly_framework")}(le),Oe._shouldCreateBgLayer&&delete Oe._shouldCreateBgLayer),a.initGradients(le),a.initPatterns(le),De&&c.saveShowSpikeInitial(le);var Fe=!le.calcdata||le.calcdata.length!==(le._fullData||[]).length;Fe&&g.doCalcdata(le);for(var ze=0;ze<le.calcdata.length;ze++)le.calcdata[ze][0].trace=le._fullData[ze];le._context.responsive?le._responsiveChartHandler||(le._responsiveChartHandler=function(){y.isHidden(le)||g.resize(le)},window.addEventListener("resize",le._responsiveChartHandler)):y.clearResponsive(le);var Re=y.extendFlat({},Oe._size),We=0;function $e(){if(g.clearAutoMarginIds(le),f.drawMarginPushers(le),c.allowAutoMargin(le),Oe._has("pie"))for(var mt=le._fullData,nt=0;nt<mt.length;nt++){var Qe=mt[nt];Qe.type==="pie"&&Qe.automargin&&g.allowAutoMargin(le,"pie."+Qe.uid+".automargin")}return g.doAutoMargin(le),g.previousPromises(le)}function at(){le._transitioning||(f.doAutoRangeAndConstraints(le),De&&c.saveRangeInitial(le),o.getComponentMethod("rangeslider","calcAutorange")(le))}var gt=[g.previousPromises,function(){if(de)return Y.addFrames(le,de)},function mt(){for(var nt=Oe._basePlotModules,Qe=0;Qe<nt.length;Qe++)nt[Qe].drawFramework&&nt[Qe].drawFramework(le);!Oe._glcanvas&&Oe._has("gl")&&(Oe._glcanvas=Oe._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],function($t){return $t.key}),Oe._glcanvas.enter().append("canvas").attr("class",function($t){return"gl-canvas gl-canvas-"+$t.key.replace("Layer","")}).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"}));var vt=le._context.plotGlPixelRatio;if(Oe._glcanvas){Oe._glcanvas.attr("width",Oe.width*vt).attr("height",Oe.height*vt).style("width",Oe.width+"px").style("height",Oe.height+"px");var jt=Oe._glcanvas.data()[0].regl;if(jt&&(Math.floor(Oe.width*vt)!==jt._gl.drawingBufferWidth||Math.floor(Oe.height*vt)!==jt._gl.drawingBufferHeight)){var Gt="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(!We)return y.log(Gt+" Clearing graph and plotting again."),g.cleanPlot([],{},le._fullData,Oe),g.supplyDefaults(le),Oe=le._fullLayout,g.doCalcdata(le),We++,mt();y.error(Gt)}}return Oe.modebar.orientation==="h"?Oe._modebardiv.style("height",null).style("width","100%"):Oe._modebardiv.style("width",null).style("height",Oe.height+"px"),g.previousPromises(le)},$e,function(){if(g.didMarginChange(Re,Oe._size))return y.syncOrAsync([$e,f.layoutStyles],le)}];Ve&&gt.push(function(){if(Fe)return y.syncOrAsync([o.getComponentMethod("shapes","calcAutorange"),o.getComponentMethod("annotations","calcAutorange"),at],le);at()}),gt.push(f.layoutStyles),Ve&&gt.push(function(){return c.draw(le,De?"":"redraw")},function(mt){mt._fullLayout._insideTickLabelsAutorange&&re(mt,mt._fullLayout._insideTickLabelsAutorange).then(function(){mt._fullLayout._insideTickLabelsAutorange=void 0})}),gt.push(f.drawData,f.finalDraw,l,g.addLinks,g.rehover,g.redrag,g.reselect,g.doAutoMargin,function(mt){mt._fullLayout._insideTickLabelsAutorange&&De&&c.saveRangeInitial(mt,!0)},g.previousPromises);var xt=y.syncOrAsync(gt,le);return xt&&xt.then||(xt=Promise.resolve()),xt.then(function(){return k(le),le})},Y.purge=function(le){var ve=(le=y.getGraphDiv(le))._fullLayout||{},Me=le._fullData||[];return g.cleanPlot([],{},Me,ve),g.purge(le),t.purge(le),ve._container&&ve._container.remove(),delete le._context,le},Y.react=function(le,ve,Me,we){var de,Ie;le=y.getGraphDiv(le),x.clearPromiseQueue(le);var De=le._fullData,Oe=le._fullLayout;if(y.isPlotDiv(le)&&De&&Oe){if(y.isPlainObject(ve)){var Ve=ve;ve=Ve.data,Me=Ve.layout,we=Ve.config,de=Ve.frames}var Fe=!1;if(we){var ze=y.extendDeep({},le._context);le._context=void 0,I(le,we),Fe=function pe(_e,Be){var He;for(He in _e)if(He.charAt(0)!=="_"){var Je=_e[He],Ze=Be[He];if(Je!==Ze)if(y.isPlainObject(Je)&&y.isPlainObject(Ze)){if(pe(Je,Ze))return!0}else{if(!Array.isArray(Je)||!Array.isArray(Ze)||Je.length!==Ze.length)return!0;for(var ct=0;ct<Je.length;ct++)if(Je[ct]!==Ze[ct]&&(!y.isPlainObject(Je[ct])||!y.isPlainObject(Ze[ct])||pe(Je[ct],Ze[ct])))return!0}}}(ze,le._context)}le.data=ve||[],x.cleanData(le.data),le.layout=Me||{},x.cleanLayout(le.layout),function(pe,_e,Be,He){var Je,Ze,ct,lt,At,Ot,it,ht,Ut,Mt,It=He._preGUI,Le=[],Xe={},ot={};for(Je in It){if(At=me(Je,se)){if(Ut=At.head,Mt=At.tail,Ze=At.attr||Ut+".uirevision",(lt=(ct=e(He,Ze).get())&&ce(Ze,_e))&&lt===ct){if((Ot=It[Je])===null&&(Ot=void 0),fe(ht=(it=e(_e,Je)).get(),Ot)){ht===void 0&&Mt==="autorange"&&Le.push(Ut),it.set(V(e(He,Je).get()));continue}if(Mt==="autorange"||Mt.substr(0,6)==="range["){var pt=It[Ut+".range[0]"],St=It[Ut+".range[1]"],Vt=It[Ut+".autorange"];if(Vt||Vt===null&&pt===null&&St===null){if(!(Ut in Xe)){var Jt=e(_e,Ut).get();Xe[Ut]=Jt&&(Jt.autorange||Jt.autorange!==!1&&(!Jt.range||Jt.range.length!==2))}if(Xe[Ut]){it.set(V(e(He,Je).get()));continue}}}}}else y.warn("unrecognized GUI edit: "+Je);delete It[Je],At&&At.tail.substr(0,6)==="range["&&(ot[At.head]=1)}for(var qt=0;qt<Le.length;qt++){var gr=Le[qt];if(ot[gr]){var Cr=e(_e,gr).get();Cr&&delete Cr.autorange}}var mr=He._tracePreGUI;for(var tr in mr){var nr,Qt=mr[tr],dr=null;for(Je in Qt){if(!dr){var _r=ye(tr,Be);if(_r<0){delete mr[tr];break}var Ir=Se(tr,pe,(nr=Be[_r]._fullInput).index);if(Ir<0){delete mr[tr];break}dr=pe[Ir]}if(At=me(Je,oe)){if(At.attr?lt=(ct=e(He,At.attr).get())&&ce(At.attr,_e):(ct=nr.uirevision,(lt=dr.uirevision)===void 0&&(lt=_e.uirevision)),lt&&lt===ct&&((Ot=Qt[Je])===null&&(Ot=void 0),fe(ht=(it=e(dr,Je)).get(),Ot))){it.set(V(e(nr,Je).get()));continue}}else y.warn("unrecognized GUI edit: "+Je+" in trace uid "+tr);delete Qt[Je]}}}(le.data,le.layout,De,Oe),g.supplyDefaults(le,{skipUpdateCalc:!0});var Re=le._fullData,We=le._fullLayout,$e=We.datarevision===void 0,at=We.transition,gt=function(pe,_e,Be,He,Je){var Ze=_.layoutFlags();function ct(lt){return r.getLayoutValObject(Be,lt)}return Ze.arrays={},Ze.rangesAltered={},Ze.nChanges=0,Ze.nChangesAnim=0,ge(_e,Be,[],{getValObject:ct,flags:Ze,immutable:He,transition:Je,gd:pe}),(Ze.plot||Ze.calc)&&(Ze.layoutReplot=!0),Je&&Ze.nChanges&&Ze.nChangesAnim&&(Ze.anim=Ze.nChanges===Ze.nChangesAnim?"all":"some"),Ze}(le,Oe,We,$e,at),xt=gt.newDataRevision,mt=function(pe,_e,Be,He,Je,Ze){var ct=_e.length===Be.length;if(!Je&&!ct)return{fullReplot:!0,calc:!0};var lt,At,Ot=_.traceFlags();Ot.arrays={},Ot.nChanges=0,Ot.nChangesAnim=0;var it={getValObject:function(Ut){var Mt=r.getTraceValObject(At,Ut);return!At._module.animatable&&Mt.anim&&(Mt.anim=!1),Mt},flags:Ot,immutable:He,transition:Je,newDataRevision:Ze,gd:pe},ht={};for(lt=0;lt<_e.length;lt++)if(Be[lt]){if(At=Be[lt]._fullInput,g.hasMakesDataTransform(At)&&(At=Be[lt]),ht[At.uid])continue;ht[At.uid]=1,ge(_e[lt]._fullInput,At,[],it)}return(Ot.calc||Ot.plot)&&(Ot.fullReplot=!0),Je&&Ot.nChanges&&Ot.nChangesAnim&&(Ot.anim=Ot.nChanges===Ot.nChangesAnim&&ct?"all":"some"),Ot}(le,De,Re,$e,at,xt);if(J(le)&&(gt.layoutReplot=!0),mt.calc||gt.calc){le.calcdata=void 0;for(var nt=Object.getOwnPropertyNames(We),Qe=0;Qe<nt.length;Qe++){var vt=nt[Qe],jt=vt.substring(0,5);if(jt==="xaxis"||jt==="yaxis"){var Gt=We[vt]._emptyCategories;Gt&&Gt()}}}else g.supplyDefaultsUpdateCalc(le.calcdata,Re);var $t=[];if(de&&(le._transitionData={},g.createTransitionData(le),$t.push(function(){return Y.addFrames(le,de)})),We.transition&&!Fe&&(mt.anim||gt.anim))gt.ticks&&$t.push(f.doTicksRelayout),g.doCalcdata(le),f.doAutoRangeAndConstraints(le),$t.push(function(){return g.transitionFromReact(le,mt,gt,Oe)});else if(mt.fullReplot||gt.layoutReplot||Fe)le._fullLayout._skipDefaults=!0,$t.push(Y._doPlot);else{for(var Zt in gt.arrays){var cr=gt.arrays[Zt];if(cr.length){var Dt=o.getComponentMethod(Zt,"drawOne");if(Dt!==y.noop)for(var Ne=0;Ne<cr.length;Ne++)Dt(le,cr[Ne]);else{var Ye=o.getComponentMethod(Zt,"draw");if(Ye===y.noop)throw new Error("cannot draw components: "+Zt);Ye(le)}}}$t.push(g.previousPromises),mt.style&&$t.push(f.doTraceStyle),(mt.colorbars||gt.colorbars)&&$t.push(f.doColorBars),gt.legend&&$t.push(f.doLegend),gt.layoutstyle&&$t.push(f.layoutStyles),gt.axrange&&N($t),gt.ticks&&$t.push(f.doTicksRelayout),gt.modebar&&$t.push(f.doModeBar),gt.camera&&$t.push(f.doCamera),$t.push(k)}$t.push(g.rehover,g.redrag,g.reselect),(Ie=y.syncOrAsync($t,le))&&Ie.then||(Ie=Promise.resolve(le))}else Ie=Y.newPlot(le,ve,Me,we);return Ie.then(function(){return le.emit("plotly_react",{data:ve,layout:Me}),le})},Y.redraw=function(le){if(le=y.getGraphDiv(le),!y.isPlotDiv(le))throw new Error("This element is not a Plotly plot: "+le);return x.cleanData(le.data),x.cleanLayout(le.layout),le.calcdata=void 0,Y._doPlot(le).then(function(){return le.emit("plotly_redraw"),le})},Y.relayout=re,Y.restyle=j,Y.setPlotConfig=function(le){return y.extendFlat(u,le)},Y.update=ee,Y._guiRelayout=ne(re),Y._guiRestyle=ne(j),Y._guiUpdate=ne(ee),Y._storeDirectGUIEdit=function(le,ve,Me){for(var we in Me)Q(we,e(le,we).get(),Me[we],ve)}},{"../components/color":367,"../components/drawing":389,"../components/selections":455,"../constants/xmlns_namespaces":492,"../lib":515,"../lib/events":504,"../lib/queue":531,"../plots/cartesian/axes":566,"../plots/cartesian/constants":573,"../plots/cartesian/graph_interact":576,"../plots/plots":628,"../registry":647,"./edit_types":548,"./helpers":549,"./manage_arrays":551,"./plot_config":553,"./plot_schema":554,"./subroutines":556,"@plotly/d3":58,"fast-isnumeric":190,"has-hover":228}],553:[function(m,G,Y){var d={staticPlot:{valType:"boolean",dflt:!1},typesetMath:{valType:"boolean",dflt:!0},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},editSelection:{valType:"boolean",dflt:!0},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},v={};(function w(y,e){for(var t in y){var n=y[t];n.valType?e[t]=n.dflt:(e[t]||(e[t]={}),w(n,e[t]))}})(d,v),G.exports={configAttributes:d,dfltConfig:v}},{}],554:[function(m,G,Y){var d=m("../registry"),v=m("../lib"),w=m("../plots/attributes"),y=m("../plots/layout_attributes"),e=m("../plots/frame_attributes"),t=m("../plots/animation_attributes"),n=m("./plot_config").configAttributes,o=m("./edit_types"),r=v.extendDeepAll,g=v.isPlainObject,c=v.isArrayOrTypedArray,a=v.nestedProperty,h=v.valObjectMeta,l=["_isSubplotObj","_isLinkedToArray","_arrayAttrRegexps","_deprecated"];function s(b,T,k){if(!b)return!1;if(b._isLinkedToArray){if(p(T[k]))k++;else if(k<T.length)return!1}for(;k<T.length;k++){var L=b[T[k]];if(!g(L)||(b=L,k===T.length-1))break;if(b._isLinkedToArray){if(!p(T[++k]))return!1}else if(b.valType==="info_array"){var A=T[++k];if(!p(A))return!1;var I=b.items;if(Array.isArray(I)){if(A>=I.length)return!1;if(b.dimensions===2){if(k++,T.length===k)return b;var P=T[k];if(!p(P))return!1;b=I[A][P]}else b=I[A]}else b=I}}return b}function p(b){return b===Math.round(b)&&b>=0}function u(){var b,T,k={};for(b in r(k,y),d.subplotsRegistry)if((T=d.subplotsRegistry[b]).layoutAttributes)if(Array.isArray(T.attr))for(var L=0;L<T.attr.length;L++)f(k,T,T.attr[L]);else f(k,T,T.attr==="subplot"?T.name:T.attr);for(b in d.componentsRegistry){var A=(T=d.componentsRegistry[b]).schema;if(A&&(A.subplots||A.layout)){var I=A.subplots;if(I&&I.xaxis&&!I.yaxis)for(var P in I.xaxis)delete k.yaxis[P]}else T.name==="colorscale"?r(k,T.layoutAttributes):T.layoutAttributes&&_(k,T.layoutAttributes,T.name)}return{layoutAttributes:x(k)}}function i(){var b={frames:r({},e)};return x(b),b.frames}function x(b){return function(T){Y.crawl(T,function(k,L,A){Y.isValObject(k)?k.arrayOk!==!0&&k.valType!=="data_array"||(A[L+"src"]={valType:"string",editType:"none"}):g(k)&&(k.role="object")})}(b),function(T){Y.crawl(T,function(k,L,A){if(k){var I=k._isLinkedToArray;I&&(delete k._isLinkedToArray,A[L]={items:{}},A[L].items[I]=k,A[L].role="object")}})}(b),function(T){(function k(L){for(var A in L)if(g(L[A]))k(L[A]);else if(Array.isArray(L[A]))for(var I=0;I<L[A].length;I++)k(L[A][I]);else L[A]instanceof RegExp&&(L[A]=L[A].toString())})(T)}(b),b}function f(b,T,k){var L=a(b,k),A=r({},T.layoutAttributes);A._isSubplotObj=!0,L.set(A)}function _(b,T,k){var L=a(b,k);L.set(r(L.get()||{},T))}Y.IS_SUBPLOT_OBJ="_isSubplotObj",Y.IS_LINKED_TO_ARRAY="_isLinkedToArray",Y.DEPRECATED="_deprecated",Y.UNDERSCORE_ATTRS=l,Y.get=function(){var b={};d.allTypes.forEach(function(k){b[k]=function(L){var A,I;A=d.modules[L]._module,I=A.basePlotModule;var P={type:null},S=r({},w),E=r({},A.attributes);Y.crawl(E,function(j,V,Z,Q,X){a(S,X).set(void 0),j===void 0&&a(E,X).set(void 0)}),r(P,S),d.traceIs(L,"noOpacity")&&delete P.opacity,d.traceIs(L,"showLegend")||(delete P.showlegend,delete P.legendgroup),d.traceIs(L,"noHover")&&(delete P.hoverinfo,delete P.hoverlabel),A.selectPoints||delete P.selectedpoints,r(P,E),I.attributes&&r(P,I.attributes),P.type=L;var z={meta:A.meta||{},categories:A.categories||{},animatable:Boolean(A.animatable),type:L,attributes:x(P)};if(A.layoutAttributes){var D={};r(D,A.layoutAttributes),z.layoutAttributes=x(D)}return A.animatable||Y.crawl(z,function(j){Y.isValObject(j)&&"anim"in j&&delete j.anim}),z}(k)});var T={};return Object.keys(d.transformsRegistry).forEach(function(k){T[k]=function(L){var A=d.transformsRegistry[L],I=r({},A.attributes);return Object.keys(d.componentsRegistry).forEach(function(P){var S=d.componentsRegistry[P];S.schema&&S.schema.transforms&&S.schema.transforms[L]&&Object.keys(S.schema.transforms[L]).forEach(function(E){_(I,S.schema.transforms[L][E],E)})}),{attributes:x(I)}}(k)}),{defs:{valObjects:h,metaKeys:l.concat(["description","role","editType","impliedEdits"]),editType:{traces:o.traces,layout:o.layout},impliedEdits:{}},traces:b,layout:u(),transforms:T,frames:i(),animation:x(t),config:x(n)}},Y.crawl=function(b,T,k,L){var A=k||0;L=L||"",Object.keys(b).forEach(function(I){var P=b[I];if(l.indexOf(I)===-1){var S=(L?L+".":"")+I;T(P,I,b,A,S),Y.isValObject(P)||g(P)&&I!=="impliedEdits"&&Y.crawl(P,T,A+1,S)}})},Y.isValObject=function(b){return b&&b.valType!==void 0},Y.findArrayAttributes=function(b){var T,k,L=[],A=[],I=[];function P(j,V,Z,Q){A=A.slice(0,Q).concat([V]),I=I.slice(0,Q).concat([j&&j._isLinkedToArray]),j&&(j.valType==="data_array"||j.arrayOk===!0)&&!(A[Q-1]==="colorbar"&&(V==="ticktext"||V==="tickvals"))&&function X($,re,H){var N=$[A[re]],U=H+A[re];if(re===A.length-1)c(N)&&L.push(k+U);else if(I[re]){if(Array.isArray(N))for(var te=0;te<N.length;te++)g(N[te])&&X(N[te],re+1,U+"["+te+"].")}else g(N)&&X(N,re+1,U+".")}(T,0,"")}T=b,k="",Y.crawl(w,P),b._module&&b._module.attributes&&Y.crawl(b._module.attributes,P);var S=b.transforms;if(S)for(var E=0;E<S.length;E++){var z=S[E],D=z._module;D&&(k="transforms["+E+"].",T=z,Y.crawl(D.attributes,P))}return L},Y.getTraceValObject=function(b,T){var k,L,A=T[0],I=1;if(A==="transforms"){if(T.length===1)return w.transforms;var P=b.transforms;if(!Array.isArray(P)||!P.length)return!1;var S=T[1];if(!p(S)||S>=P.length)return!1;L=(k=(d.transformsRegistry[P[S].type]||{}).attributes)&&k[T[2]],I=3}else{var E=b._module;if(E||(E=(d.modules[b.type||w.type.dflt]||{})._module),!E)return!1;if(!(L=(k=E.attributes)&&k[A])){var z=E.basePlotModule;z&&z.attributes&&(L=z.attributes[A])}L||(L=w[A])}return s(L,T,I)},Y.getLayoutValObject=function(b,T){return s(function(k,L){var A,I,P,S,E=k._basePlotModules;if(E){var z;for(A=0;A<E.length;A++){if((P=E[A]).attrRegex&&P.attrRegex.test(L)){if(P.layoutAttrOverrides)return P.layoutAttrOverrides;!z&&P.layoutAttributes&&(z=P.layoutAttributes)}var D=P.baseLayoutAttrOverrides;if(D&&L in D)return D[L]}if(z)return z}var j=k._modules;if(j){for(A=0;A<j.length;A++)if((S=j[A].layoutAttributes)&&L in S)return S[L]}for(I in d.componentsRegistry){if((P=d.componentsRegistry[I]).name==="colorscale"&&L.indexOf("coloraxis")===0)return P.layoutAttributes[L];if(!P.schema&&L===P.name)return P.layoutAttributes}return L in y&&y[L]}(b,T[0]),T,1)}},{"../lib":515,"../plots/animation_attributes":560,"../plots/attributes":562,"../plots/frame_attributes":595,"../plots/layout_attributes":619,"../registry":647,"./edit_types":548,"./plot_config":553}],555:[function(m,G,Y){var d=m("../lib"),v=m("../plots/attributes"),w={name:{valType:"string",editType:"none"}};function y(t){return t&&typeof t=="string"}function e(t){var n=t.length-1;return t.charAt(n)!=="s"&&d.warn("bad argument to arrayDefaultKey: "+t),t.substr(0,t.length-1)+"defaults"}w.templateitemname={valType:"string",editType:"calc"},Y.templatedArray=function(t,n){return n._isLinkedToArray=t,n.name=w.name,n.templateitemname=w.templateitemname,n},Y.traceTemplater=function(t){var n,o,r={};for(n in t)o=t[n],Array.isArray(o)&&o.length&&(r[n]=0);return{newTrace:function(g){var c={type:n=d.coerce(g,{},v,"type"),_template:null};if(n in r){o=t[n];var a=r[n]%o.length;r[n]++,c._template=o[a]}return c}}},Y.newContainer=function(t,n,o){var r=t._template,g=r&&(r[n]||o&&r[o]);return d.isPlainObject(g)||(g=null),t[n]={_template:g}},Y.arrayTemplater=function(t,n,o){var r=t._template,g=r&&r[e(n)],c=r&&r[n];Array.isArray(c)&&c.length||(c=[]);var a={};return{newItem:function(h){var l={name:h.name,_input:h},s=l.templateitemname=h.templateitemname;if(!y(s))return l._template=g,l;for(var p=0;p<c.length;p++){var u=c[p];if(u.name===s)return a[s]=1,l._template=u,l}return l[o]=h[o]||!1,l._template=!1,l},defaultItems:function(){for(var h=[],l=0;l<c.length;l++){var s=c[l],p=s.name;if(y(p)&&!a[p]){var u={_template:s,name:p,_input:{_templateitemname:p}};u.templateitemname=s.templateitemname,h.push(u),a[p]=1}}return h}}},Y.arrayDefaultKey=e,Y.arrayEditor=function(t,n,o){var r=(d.nestedProperty(t,n).get()||[]).length,g=o._index,c=g>=r&&(o._input||{})._templateitemname;c&&(g=r);var a,h=n+"["+g+"]";function l(){a={},c&&(a[h]={},a[h].templateitemname=c)}function s(u,i){c?d.nestedProperty(a[h],u).set(i):a[h+"."+u]=i}function p(){var u=a;return l(),u}return l(),{modifyBase:function(u,i){a[u]=i},modifyItem:s,getUpdateObj:p,applyUpdate:function(u,i){u&&s(u,i);var x=p();for(var f in x)d.nestedProperty(t,f).set(x[f])}}}},{"../lib":515,"../plots/attributes":562}],556:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../registry"),w=m("../plots/plots"),y=m("../lib"),e=m("../lib/clear_gl_canvases"),t=m("../components/color"),n=m("../components/drawing"),o=m("../components/titles"),r=m("../components/modebar"),g=m("../plots/cartesian/axes"),c=m("../constants/alignment"),a=m("../plots/cartesian/constraints"),h=a.enforce,l=a.clean,s=m("../plots/cartesian/autorange").doAutoRange;function p(T,k,L){for(var A=0;A<L.length;A++){var I=L[A][0],P=L[A][1];if(!(I[0]>=T[1]||I[1]<=T[0])&&P[0]<k[1]&&P[1]>k[0])return!0}return!1}function u(T){var k,L,A,I,P,S,E=T._fullLayout,z=E._size,D=z.p,j=g.list(T,"",!0);if(E._paperdiv.style({width:T._context.responsive&&E.autosize&&!T._context._hasZeroWidth&&!T.layout.width?"100%":E.width+"px",height:T._context.responsive&&E.autosize&&!T._context._hasZeroHeight&&!T.layout.height?"100%":E.height+"px"}).selectAll(".main-svg").call(n.setSize,E.width,E.height),T._context.setBackground(T,E.paper_bgcolor),Y.drawMainTitle(T),r.manage(T),!E._has("cartesian"))return w.previousPromises(T);function V(We,$e,at){var gt=We._lw/2;return We._id.charAt(0)==="x"?$e?at==="top"?$e._offset-D-gt:$e._offset+$e._length+D+gt:z.t+z.h*(1-(We.position||0))+gt%1:$e?at==="right"?$e._offset+$e._length+D+gt:$e._offset-D-gt:z.l+z.w*(We.position||0)+gt%1}for(k=0;k<j.length;k++){var Z=(I=j[k])._anchorAxis;I._linepositions={},I._lw=n.crispRound(T,I.linewidth,1),I._mainLinePosition=V(I,Z,I.side),I._mainMirrorPosition=I.mirror&&Z?V(I,Z,c.OPPOSITE_SIDE[I.side]):null}var Q=[],X=[],$=[],re=t.opacity(E.paper_bgcolor)===1&&t.opacity(E.plot_bgcolor)===1&&E.paper_bgcolor===E.plot_bgcolor;for(L in E._plots)if((A=E._plots[L]).mainplot)A.bg&&A.bg.remove(),A.bg=void 0;else{var H=A.xaxis.domain,N=A.yaxis.domain,U=A.plotgroup;if(p(H,N,$)){var te=U.node(),B=A.bg=y.ensureSingle(U,"rect","bg");te.insertBefore(B.node(),te.childNodes[0]),X.push(L)}else U.select("rect.bg").remove(),$.push([H,N]),re||(Q.push(L),X.push(L))}var K,J,ee,ne,se,oe,me,ce,ye,Se,fe,ge,Te,le=E._bgLayer.selectAll(".bg").data(Q);for(le.enter().append("rect").classed("bg",!0),le.exit().remove(),le.each(function(We){E._plots[We].bg=d.select(this)}),k=0;k<X.length;k++)A=E._plots[X[k]],P=A.xaxis,S=A.yaxis,A.bg&&P._offset!==void 0&&S._offset!==void 0&&A.bg.call(n.setRect,P._offset-D,S._offset-D,P._length+2*D,S._length+2*D).call(t.fill,E.plot_bgcolor).style("stroke-width",0);if(!E._hasOnlyLargeSploms)for(L in E._plots){A=E._plots[L],P=A.xaxis,S=A.yaxis;var ve,Me,we=A.clipId="clip"+E._uid+L+"plot",de=y.ensureSingleById(E._clips,"clipPath",we,function(We){We.classed("plotclip",!0).append("rect")});A.clipRect=de.select("rect").attr({width:P._length,height:S._length}),n.setTranslate(A.plot,P._offset,S._offset),A._hasClipOnAxisFalse?(ve=null,Me=we):(ve=we,Me=null),n.setClipUrl(A.plot,ve,T),A.layerClipId=Me}function Ie(We){return"M"+K+","+We+"H"+J}function De(We){return"M"+P._offset+","+We+"h"+P._length}function Oe(We){return"M"+We+","+ce+"V"+me}function Ve(We){return"M"+We+","+S._offset+"v"+S._length}function Fe(We,$e,at){if(!We.showline||L!==We._mainSubplot)return"";if(!We._anchorAxis)return at(We._mainLinePosition);var gt=$e(We._mainLinePosition);return We.mirror&&(gt+=$e(We._mainMirrorPosition)),gt}for(L in E._plots){A=E._plots[L],P=A.xaxis,S=A.yaxis;var ze="M0,0";i(P,L)&&(se=f(P,"left",S,j),K=P._offset-(se?D+se:0),oe=f(P,"right",S,j),J=P._offset+P._length+(oe?D+oe:0),ee=V(P,S,"bottom"),ne=V(P,S,"top"),!(Te=!P._anchorAxis||L!==P._mainSubplot)||P.mirror!=="allticks"&&P.mirror!=="all"||(P._linepositions[L]=[ee,ne]),ze=Fe(P,Ie,De),Te&&P.showline&&(P.mirror==="all"||P.mirror==="allticks")&&(ze+=Ie(ee)+Ie(ne)),A.xlines.style("stroke-width",P._lw+"px").call(t.stroke,P.showline?P.linecolor:"rgba(0,0,0,0)")),A.xlines.attr("d",ze);var Re="M0,0";i(S,L)&&(fe=f(S,"bottom",P,j),me=S._offset+S._length+(fe?D:0),ge=f(S,"top",P,j),ce=S._offset-(ge?D:0),ye=V(S,P,"left"),Se=V(S,P,"right"),!(Te=!S._anchorAxis||L!==S._mainSubplot)||S.mirror!=="allticks"&&S.mirror!=="all"||(S._linepositions[L]=[ye,Se]),Re=Fe(S,Oe,Ve),Te&&S.showline&&(S.mirror==="all"||S.mirror==="allticks")&&(Re+=Oe(ye)+Oe(Se)),A.ylines.style("stroke-width",S._lw+"px").call(t.stroke,S.showline?S.linecolor:"rgba(0,0,0,0)")),A.ylines.attr("d",Re)}return g.makeClipPaths(T),w.previousPromises(T)}function i(T,k){return(T.ticks||T.showline)&&(k===T._mainSubplot||T.mirror==="all"||T.mirror==="allticks")}function x(T,k,L){if(!L.showline||!L._lw)return!1;if(L.mirror==="all"||L.mirror==="allticks")return!0;var A=L._anchorAxis;if(!A)return!1;var I=c.FROM_BL[k];return L.side===k?A.domain[I]===T.domain[I]:L.mirror&&A.domain[1-I]===T.domain[1-I]}function f(T,k,L,A){if(x(T,k,L))return L._lw;for(var I=0;I<A.length;I++){var P=A[I];if(P._mainAxis===L._mainAxis&&x(T,k,P))return P._lw}return 0}function _(T,k){var L=T.title,A=T._size,I=0;switch(k==="start"?I=L.pad.l:k==="end"&&(I=-L.pad.r),L.xref){case"paper":return A.l+A.w*L.x+I;case"container":default:return T.width*L.x+I}}function b(T,k){var L=T.title,A=T._size,I=0;if(k!=="0em"&&k?k===c.CAP_SHIFT+"em"&&(I=L.pad.t):I=-L.pad.b,L.y==="auto")return A.t/2;switch(L.yref){case"paper":return A.t+A.h-A.h*L.y+I;case"container":default:return T.height-T.height*L.y+I}}Y.layoutStyles=function(T){return y.syncOrAsync([w.doAutoMargin,u],T)},Y.drawMainTitle=function(T){var k=T._fullLayout,L=function(I){var P=I.title,S="middle";return y.isRightAnchor(P)?S="end":y.isLeftAnchor(P)&&(S="start"),S}(k),A=function(I){var P=I.title,S="0em";return y.isTopAnchor(P)?S=c.CAP_SHIFT+"em":y.isMiddleAnchor(P)&&(S=c.MID_SHIFT+"em"),S}(k);o.draw(T,"gtitle",{propContainer:k,propName:"title.text",placeholder:k._dfltTitle.plot,attributes:{x:_(k,L),y:b(k,A),"text-anchor":L,dy:A}})},Y.doTraceStyle=function(T){var k,L=T.calcdata,A=[];for(k=0;k<L.length;k++){var I=L[k],P=I[0]||{},S=P.trace||{},E=S._module||{},z=E.arraysToCalcdata;z&&z(I,S);var D=E.editStyle;D&&A.push({fn:D,cd0:P})}if(A.length){for(k=0;k<A.length;k++){var j=A[k];j.fn(T,j.cd0)}e(T),Y.redrawReglTraces(T)}return w.style(T),v.getComponentMethod("legend","draw")(T),w.previousPromises(T)},Y.doColorBars=function(T){return v.getComponentMethod("colorbar","draw")(T),w.previousPromises(T)},Y.layoutReplot=function(T){var k=T.layout;return T.layout=void 0,v.call("_doPlot",T,"",k)},Y.doLegend=function(T){return v.getComponentMethod("legend","draw")(T),w.previousPromises(T)},Y.doTicksRelayout=function(T){return g.draw(T,"redraw"),T._fullLayout._hasOnlyLargeSploms&&(v.subplotsRegistry.splom.updateGrid(T),e(T),Y.redrawReglTraces(T)),Y.drawMainTitle(T),w.previousPromises(T)},Y.doModeBar=function(T){var k=T._fullLayout;r.manage(T);for(var L=0;L<k._basePlotModules.length;L++){var A=k._basePlotModules[L].updateFx;A&&A(T)}return w.previousPromises(T)},Y.doCamera=function(T){for(var k=T._fullLayout,L=k._subplots.gl3d,A=0;A<L.length;A++){var I=k[L[A]];I._scene.setViewport(I)}},Y.drawData=function(T){var k=T._fullLayout;e(T);for(var L=k._basePlotModules,A=0;A<L.length;A++)L[A].plot(T);return Y.redrawReglTraces(T),w.style(T),v.getComponentMethod("selections","draw")(T),v.getComponentMethod("shapes","draw")(T),v.getComponentMethod("annotations","draw")(T),v.getComponentMethod("images","draw")(T),k._replotting=!1,w.previousPromises(T)},Y.redrawReglTraces=function(T){var k=T._fullLayout;if(k._has("regl")){var L,A,I=T._fullData,P=[],S=[];for(k._hasOnlyLargeSploms&&k._splomGrid.draw(),L=0;L<I.length;L++){var E=I[L];E.visible===!0&&E._length!==0&&(E.type==="splom"?k._splomScenes[E.uid].draw():E.type==="scattergl"?y.pushUnique(P,E.xaxis+E.yaxis):E.type==="scatterpolargl"&&y.pushUnique(S,E.subplot))}for(L=0;L<P.length;L++)(A=k._plots[P[L]])._scene&&A._scene.draw();for(L=0;L<S.length;L++)(A=k[S[L]]._subplot)._scene&&A._scene.draw()}},Y.doAutoRangeAndConstraints=function(T){for(var k,L=g.list(T,"",!0),A={},I=0;I<L.length;I++)if(!A[(k=L[I])._id]){A[k._id]=1,l(T,k),s(T,k);var P=k._matchGroup;if(P)for(var S in P){var E=g.getFromId(T,S);s(T,E,k.range),A[S]=1}}h(T)},Y.finalDraw=function(T){v.getComponentMethod("rangeslider","draw")(T),v.getComponentMethod("rangeselector","draw")(T)},Y.drawMarginPushers=function(T){v.getComponentMethod("legend","draw")(T),v.getComponentMethod("rangeselector","draw")(T),v.getComponentMethod("sliders","draw")(T),v.getComponentMethod("updatemenus","draw")(T),v.getComponentMethod("colorbar","draw")(T)}},{"../components/color":367,"../components/drawing":389,"../components/modebar":430,"../components/titles":476,"../constants/alignment":483,"../lib":515,"../lib/clear_gl_canvases":499,"../plots/cartesian/autorange":565,"../plots/cartesian/axes":566,"../plots/cartesian/constraints":574,"../plots/plots":628,"../registry":647,"@plotly/d3":58}],557:[function(m,G,Y){var d=m("../lib"),v=d.isPlainObject,w=m("./plot_schema"),y=m("../plots/plots"),e=m("../plots/attributes"),t=m("./plot_template"),n=m("./plot_config").dfltConfig;function o(p,u){p=d.extendDeep({},p);var i,x,f=Object.keys(p).sort();function _(A,I,P){if(v(I)&&v(A))o(A,I);else if(Array.isArray(I)&&Array.isArray(A)){var S=t.arrayTemplater({_template:p},P);for(x=0;x<I.length;x++){var E=I[x],z=S.newItem(E)._template;z&&o(z,E)}var D=S.defaultItems();for(x=0;x<D.length;x++)I.push(D[x]._template);for(x=0;x<I.length;x++)delete I[x].templateitemname}}for(i=0;i<f.length;i++){var b=f[i],T=p[b];if(b in u?_(T,u[b],b):u[b]=T,r(b)===b)for(var k in u){var L=r(k);k===L||L!==b||k in p||_(T,u[k],b)}}}function r(p){return p.replace(/[0-9]+$/,"")}function g(p,u,i,x,f){var _=f&&i(f);for(var b in p){var T=p[b],k=h(p,b,x),L=h(p,b,f),A=i(L);if(!A){var I=r(b);I!==b&&(A=i(L=h(p,I,f)))}if((!_||_!==A)&&!(!A||A._noTemplating||A.valType==="data_array"||A.arrayOk&&Array.isArray(T)))if(!A.valType&&v(T))g(T,u,i,k,L);else if(A._isLinkedToArray&&Array.isArray(T))for(var P=!1,S=0,E={},z=0;z<T.length;z++){var D=T[z];if(v(D)){var j=D.name;if(j)E[j]||(g(D,u,i,h(T,S,k),h(T,S,L)),S++,E[j]=1);else if(!P){var V=h(p,t.arrayDefaultKey(b),x),Z=h(T,S,k);g(D,u,i,Z,h(T,S,L));var Q=d.nestedProperty(u,Z);d.nestedProperty(u,V).set(Q.get()),Q.set(null),P=!0}}}else d.nestedProperty(u,k).set(T)}}function c(p,u){return w.getLayoutValObject(p,d.nestedProperty({},u).parts)}function a(p,u){return w.getTraceValObject(p,d.nestedProperty({},u).parts)}function h(p,u,i){return i?Array.isArray(p)?i+"["+u+"]":i+"."+u:u}function l(p){for(var u=0;u<p.length;u++)if(v(p[u]))return!0}function s(p){var u;switch(p.code){case"data":u="The template has no key data.";break;case"layout":u="The template has no key layout.";break;case"missing":u=p.path?"There are no templates for item "+p.path+" with name "+p.templateitemname:"There are no templates for trace "+p.index+", of type "+p.traceType+".";break;case"unused":u=p.path?"The template item at "+p.path+" was not used in constructing the plot.":p.dataCount?"Some of the templates of type "+p.traceType+" were not used. The template has "+p.templateCount+" traces, the data only has "+p.dataCount+" of this type.":"The template has "+p.templateCount+" traces of type "+p.traceType+" but there are none in the data.";break;case"reused":u="Some of the templates of type "+p.traceType+" were used more than once. The template has "+p.templateCount+" traces, the data has "+p.dataCount+" of this type."}return p.msg=u,p}Y.makeTemplate=function(p){p=d.isPlainObject(p)?p:d.getGraphDiv(p),p=d.extendDeep({_context:n},{data:p.data,layout:p.layout}),y.supplyDefaults(p);var u=p.data||[],i=p.layout||{};i._basePlotModules=p._fullLayout._basePlotModules,i._modules=p._fullLayout._modules;var x={data:{},layout:{}};u.forEach(function(S){var E={};g(S,E,a.bind(null,S));var z=d.coerce(S,{},e,"type"),D=x.data[z];D||(D=x.data[z]=[]),D.push(E)}),g(i,x.layout,c.bind(null,i)),delete x.layout.template;var f=i.template;if(v(f)){var _,b,T,k,L,A,I=f.layout;v(I)&&o(I,x.layout);var P=f.data;if(v(P)){for(b in x.data)if(T=P[b],Array.isArray(T)){for(A=(L=x.data[b]).length,k=T.length,_=0;_<A;_++)o(T[_%k],L[_]);for(_=A;_<k;_++)L.push(d.extendDeep({},T[_]))}for(b in P)b in x.data||(x.data[b]=d.extendDeep([],P[b]))}}return x},Y.validateTemplate=function(p,u){var i=d.extendDeep({},{_context:n,data:p.data,layout:p.layout}),x=i.layout||{};v(u)||(u=x.template||{});var f=u.layout,_=u.data,b=[];i.layout=x,i.layout.template=u,y.supplyDefaults(i);var T=i._fullLayout,k=i._fullData,L={};if(v(f)?(function D(j,V){for(var Z in j)if(Z.charAt(0)!=="_"&&v(j[Z])){var Q,X=r(Z),$=[];for(Q=0;Q<V.length;Q++)$.push(h(j,Z,V[Q])),X!==Z&&$.push(h(j,X,V[Q]));for(Q=0;Q<$.length;Q++)L[$[Q]]=1;D(j[Z],$)}}(T,["layout"]),function D(j,V){for(var Z in j)if(Z.indexOf("defaults")===-1&&v(j[Z])){var Q=h(j,Z,V);L[Q]?D(j[Z],Q):b.push({code:"unused",path:Q})}}(f,"layout")):b.push({code:"layout"}),v(_)){for(var A,I={},P=0;P<k.length;P++){var S=k[P];I[A=S.type]=(I[A]||0)+1,S._fullInput._template||b.push({code:"missing",index:S._fullInput.index,traceType:A})}for(A in _){var E=_[A].length,z=I[A]||0;E>z?b.push({code:"unused",traceType:A,templateCount:E,dataCount:z}):z>E&&b.push({code:"reused",traceType:A,templateCount:E,dataCount:z})}}else b.push({code:"data"});if(function D(j,V){for(var Z in j)if(Z.charAt(0)!=="_"){var Q=j[Z],X=h(j,Z,V);v(Q)?(Array.isArray(j)&&Q._template===!1&&Q.templateitemname&&b.push({code:"missing",path:X,templateitemname:Q.templateitemname}),D(Q,X)):Array.isArray(Q)&&l(Q)&&D(Q,X)}}({data:k,layout:T},""),b.length)return b.map(s)}},{"../lib":515,"../plots/attributes":562,"../plots/plots":628,"./plot_config":553,"./plot_schema":554,"./plot_template":555}],558:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("./plot_api"),w=m("../plots/plots"),y=m("../lib"),e=m("../snapshot/helpers"),t=m("../snapshot/tosvg"),n=m("../snapshot/svgtoimg"),o=m("../version").version,r={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};G.exports=function(g,c){var a,h,l,s;function p(z){return!(z in c)||y.validate(c[z],r[z])}if(c=c||{},y.isPlainObject(g)?(a=g.data||[],h=g.layout||{},l=g.config||{},s={}):(g=y.getGraphDiv(g),a=y.extendDeep([],g.data),h=y.extendDeep({},g.layout),l=g._context,s=g._fullLayout||{}),!p("width")&&c.width!==null||!p("height")&&c.height!==null)throw new Error("Height and width should be pixel values.");if(!p("format"))throw new Error("Export format is not "+y.join2(r.format.values,", "," or ")+".");var u={};function i(z,D){return y.coerce(c,u,r,z,D)}var x=i("format"),f=i("width"),_=i("height"),b=i("scale"),T=i("setBackground"),k=i("imageDataOnly"),L=document.createElement("div");L.style.position="absolute",L.style.left="-5000px",document.body.appendChild(L);var A=y.extendFlat({},h);f?A.width=f:c.width===null&&d(s.width)&&(A.width=s.width),_?A.height=_:c.height===null&&d(s.height)&&(A.height=s.height);var I=y.extendFlat({},l,{_exportedPlot:!0,staticPlot:!0,setBackground:T}),P=e.getRedrawFunc(L);function S(){return new Promise(function(z){setTimeout(z,e.getDelay(L._fullLayout))})}function E(){return new Promise(function(z,D){var j=t(L,x,b),V=L._fullLayout.width,Z=L._fullLayout.height;function Q(){v.purge(L),document.body.removeChild(L)}if(x==="full-json"){var X=w.graphJson(L,!1,"keepdata","object",!0,!0);return X.version=o,X=JSON.stringify(X),Q(),z(k?X:e.encodeJSON(X))}if(Q(),x==="svg")return z(k?j:e.encodeSVG(j));var $=document.createElement("canvas");$.id=y.randstr(),n({format:x,width:V,height:Z,scale:b,canvas:$,svg:j,promise:!0}).then(z).catch(D)})}return new Promise(function(z,D){v.newPlot(L,a,A,I).then(P).then(S).then(E).then(function(j){z(function(V){return k?V.replace(e.IMAGE_URL_PREFIX,""):V}(j))}).catch(function(j){D(j)})})}},{"../lib":515,"../plots/plots":628,"../snapshot/helpers":651,"../snapshot/svgtoimg":653,"../snapshot/tosvg":655,"../version":1132,"./plot_api":552,"fast-isnumeric":190}],559:[function(m,G,Y){var d=m("../lib"),v=m("../plots/plots"),w=m("./plot_schema"),y=m("./plot_config").dfltConfig,e=d.isPlainObject,t=Array.isArray,n=d.isArrayOrTypedArray;function o(u,i,x,f,_,b){b=b||[];for(var T=Object.keys(u),k=0;k<T.length;k++){var L=T[k];if(L!=="transforms"){var A=b.slice();A.push(L);var I=u[L],P=i[L],S=l(x,L),E=(S||{}).valType,z=E==="info_array",D=E==="colorscale",j=(S||{}).items;if(h(x,L))if(e(I)&&e(P)&&E!=="any")o(I,P,S,f,_,A);else if(z&&t(I)){I.length>P.length&&f.push(a("unused",_,A.concat(P.length)));var V,Z,Q,X,$,re=P.length,H=Array.isArray(j);if(H&&(re=Math.min(re,j.length)),S.dimensions===2)for(Z=0;Z<re;Z++)if(t(I[Z])){I[Z].length>P[Z].length&&f.push(a("unused",_,A.concat(Z,P[Z].length)));var N=P[Z].length;for(V=0;V<(H?Math.min(N,j[Z].length):N);V++)Q=H?j[Z][V]:j,X=I[Z][V],$=P[Z][V],d.validate(X,Q)?$!==X&&$!==+X&&f.push(a("dynamic",_,A.concat(Z,V),X,$)):f.push(a("value",_,A.concat(Z,V),X))}else f.push(a("array",_,A.concat(Z),I[Z]));else for(Z=0;Z<re;Z++)Q=H?j[Z]:j,X=I[Z],$=P[Z],d.validate(X,Q)?$!==X&&$!==+X&&f.push(a("dynamic",_,A.concat(Z),X,$)):f.push(a("value",_,A.concat(Z),X))}else if(S.items&&!z&&t(I)){var U,te,B=j[Object.keys(j)[0]],K=[];for(U=0;U<P.length;U++){var J=P[U]._index||U;if((te=A.slice()).push(J),e(I[J])&&e(P[U])){K.push(J);var ee=I[J],ne=P[U];e(ee)&&ee.visible!==!1&&ne.visible===!1?f.push(a("invisible",_,te)):o(ee,ne,B,f,_,te)}}for(U=0;U<I.length;U++)(te=A.slice()).push(U),e(I[U])?K.indexOf(U)===-1&&f.push(a("unused",_,te)):f.push(a("object",_,te,I[U]))}else!e(I)&&e(P)?f.push(a("object",_,A,I)):n(I)||!n(P)||z||D?L in i?d.validate(I,S)?S.valType==="enumerated"&&(S.coerceNumber&&I!==+P||I!==P)&&f.push(a("dynamic",_,A,I,P)):f.push(a("value",_,A,I)):f.push(a("unused",_,A,I)):f.push(a("array",_,A,I));else f.push(a("schema",_,A))}}return f}function r(u,i){for(var x=u.layout.layoutAttributes,f=0;f<i.length;f++){var _=i[f],b=u.traces[_.type],T=b.layoutAttributes;T&&(_.subplot?d.extendFlat(x[b.attributes.subplot.dflt],T):d.extendFlat(x,T))}return x}G.exports=function(u,i){u===void 0&&(u=[]),i===void 0&&(i={});var x,f,_=w.get(),b=[],T={_context:d.extendFlat({},y)};t(u)?(T.data=d.extendDeep([],u),x=u):(T.data=[],x=[],b.push(a("array","data"))),e(i)?(T.layout=d.extendDeep({},i),f=i):(T.layout={},f={},arguments.length>1&&b.push(a("object","layout"))),v.supplyDefaults(T);for(var k=T._fullData,L=x.length,A=0;A<L;A++){var I=x[A],P=["data",A];if(e(I)){var S=k[A],E=S.type,z=_.traces[E].attributes;z.type={valType:"enumerated",values:[E]},S.visible===!1&&I.visible!==!1&&b.push(a("invisible",P)),o(I,S,z,b,P);var D=I.transforms,j=S.transforms;if(D){t(D)||b.push(a("array",P,["transforms"])),P.push("transforms");for(var V=0;V<D.length;V++){var Z=["transforms",V],Q=D[V].type;if(e(D[V])){var X=_.transforms[Q]?_.transforms[Q].attributes:{};X.type={valType:"enumerated",values:Object.keys(_.transforms)},o(D[V],j[V],X,b,P,Z)}else b.push(a("object",P,Z))}}}else b.push(a("object",P))}var $=T._fullLayout,re=r(_,k);return o(f,$,re,b,"layout"),b.length===0?void 0:b};var g={object:function(u,i){return(u==="layout"&&i===""?"The layout argument":u[0]==="data"&&i===""?"Trace "+u[1]+" in the data argument":c(u)+"key "+i)+" must be linked to an object container"},array:function(u,i){return(u==="data"?"The data argument":c(u)+"key "+i)+" must be linked to an array container"},schema:function(u,i){return c(u)+"key "+i+" is not part of the schema"},unused:function(u,i,x){var f=e(x)?"container":"key";return c(u)+f+" "+i+" did not get coerced"},dynamic:function(u,i,x,f){return[c(u)+"key",i,"(set to '"+x+"')","got reset to","'"+f+"'","during defaults."].join(" ")},invisible:function(u,i){return(i?c(u)+"item "+i:"Trace "+u[1])+" got defaulted to be not visible"},value:function(u,i,x){return[c(u)+"key "+i,"is set to an invalid value ("+x+")"].join(" ")}};function c(u){return t(u)?"In data trace "+u[1]+", ":"In "+u+", "}function a(u,i,x,f,_){var b,T;x=x||"",t(i)?(b=i[0],T=i[1]):(b=i,T=null);var k=function(A){if(!t(A))return String(A);for(var I="",P=0;P<A.length;P++){var S=A[P];typeof S=="number"?I=I.substr(0,I.length-1)+"["+S+"]":I+=S,P<A.length-1&&(I+=".")}return I}(x),L=g[u](i,k,f,_);return d.log(L),{code:u,container:b,trace:T,path:x,astr:k,msg:L}}function h(u,i){var x=p(i),f=x.keyMinusId,_=x.id;return!!(f in u&&u[f]._isSubplotObj&&_)||i in u}function l(u,i){return i in u?u[i]:u[p(i).keyMinusId]}var s=d.counterRegex("([a-z]+)");function p(u){var i=u.match(s);return{keyMinusId:i&&i[1],id:i&&i[2]}}},{"../lib":515,"../plots/plots":628,"./plot_config":553,"./plot_schema":554}],560:[function(m,G,Y){G.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],561:[function(m,G,Y){var d=m("../lib"),v=m("../plot_api/plot_template");G.exports=function(w,y,e){var t,n,o=e.name,r=e.inclusionAttr||"visible",g=y[o],c=d.isArrayOrTypedArray(w[o])?w[o]:[],a=y[o]=[],h=v.arrayTemplater(y,o,r);for(t=0;t<c.length;t++){var l=c[t];d.isPlainObject(l)?n=h.newItem(l):(n=h.newItem({}))[r]=!1,n._index=t,n[r]!==!1&&e.handleItemDefaults(l,n,y,e),a.push(n)}var s=h.defaultItems();for(t=0;t<s.length;t++)(n=s[t])._index=a.length,e.handleItemDefaults({},n,y,e,{}),a.push(n);if(d.isArrayOrTypedArray(g)){var p=Math.min(g.length,a.length);for(t=0;t<p;t++)d.relinkPrivateKeys(a[t],g[t])}return a}},{"../lib":515,"../plot_api/plot_template":555}],562:[function(m,G,Y){var d=m("./font_attributes"),v=m("../components/fx/attributes");G.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},legendgrouptitle:{text:{valType:"string",dflt:"",editType:"style"},font:d({editType:"style"}),editType:"style"},legendrank:{valType:"number",dflt:1e3,editType:"style"},legendwidth:{valType:"number",min:0,editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:v.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":398,"./font_attributes":594}],563:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../lib"),w=v.dateTime2ms,y=v.incrementMonth,e=m("../../constants/numerical").ONEAVGMONTH;G.exports=function(t,n,o,r){if(n.type!=="date")return{vals:r};var g=t[o+"periodalignment"];if(!g)return{vals:r};var c,a=t[o+"period"];if(d(a)){if((a=+a)<=0)return{vals:r}}else if(typeof a=="string"&&a.charAt(0)==="M"){var h=+a.substring(1);if(!(h>0&&Math.round(h)===h))return{vals:r};c=h}for(var l=n.calendar,s=g==="start",p=g==="end",u=t[o+"period0"],i=w(u,l)||0,x=[],f=[],_=[],b=r.length,T=0;T<b;T++){var k,L,A,I=r[T];if(c){for(k=Math.round((I-i)/(c*e)),A=y(i,c*k,l);A>I;)A=y(A,-c,l);for(;A<=I;)A=y(A,c,l);L=y(A,-c,l)}else{for(A=i+(k=Math.round((I-i)/a))*a;A>I;)A-=a;for(;A<=I;)A+=a;L=A-a}x[T]=s?L:p?A:(L+A)/2,f[T]=L,_[T]=A}return{vals:x,starts:f,ends:_}}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],564:[function(m,G,Y){G.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],565:[function(m,G,Y){var d=m("@plotly/d3"),v=m("fast-isnumeric"),w=m("../../lib"),y=m("../../constants/numerical").FP_SAFE,e=m("../../registry"),t=m("../../components/drawing"),n=m("./axis_ids"),o=n.getFromId,r=n.isLinked;function g(f,_){var b,T,k=[],L=f._fullLayout,A=a(L,_,0),I=a(L,_,1),P=h(f,_),S=P.min,E=P.max;if(S.length===0||E.length===0)return w.simpleMap(_.range,_.r2l);var z=S[0].val,D=E[0].val;for(b=1;b<S.length&&z===D;b++)z=Math.min(z,S[b].val);for(b=1;b<E.length&&z===D;b++)D=Math.max(D,E[b].val);var j=!1;if(_.range){var V=w.simpleMap(_.range,_.r2l);j=V[1]<V[0]}_.autorange==="reversed"&&(j=!0,_.autorange=!0);var Z,Q,X,$,re,H,N=_.rangemode,U=N==="tozero",te=N==="nonnegative",B=_._length,K=B/10,J=0;for(b=0;b<S.length;b++)for(Z=S[b],T=0;T<E.length;T++)(H=(Q=E[T]).val-Z.val-c(_,Z.val,Q.val))>0&&((re=B-A(Z)-I(Q))>K?H/re>J&&(X=Z,$=Q,J=H/re):H/B>J&&(X={val:Z.val,nopad:1},$={val:Q.val,nopad:1},J=H/B));if(z===D){var ee=z-1,ne=z+1;if(U)if(z===0)k=[0,1];else{var se=(z>0?E:S).reduce(function(me,ce){return Math.max(me,I(ce))},0),oe=z/(1-Math.min(.5,se/B));k=z>0?[0,oe]:[oe,0]}else k=te?[Math.max(0,ee),Math.max(1,ne)]:[ee,ne]}else U?(X.val>=0&&(X={val:0,nopad:1}),$.val<=0&&($={val:0,nopad:1})):te&&(X.val-J*A(X)<0&&(X={val:0,nopad:1}),$.val<=0&&($={val:1,nopad:1})),J=($.val-X.val-c(_,Z.val,Q.val))/(B-A(X)-I($)),k=[X.val-J*A(X),$.val+J*I($)];return j&&k.reverse(),w.simpleMap(k,_.l2r||Number)}function c(f,_,b){var T=0;if(f.rangebreaks)for(var k=f.locateBreaks(_,b),L=0;L<k.length;L++){var A=k[L];T+=A.max-A.min}return T}function a(f,_,b){var T=.05*_._length,k=_._anchorAxis||{};if((_.ticklabelposition||"").indexOf("inside")!==-1||(k.ticklabelposition||"").indexOf("inside")!==-1){var L=_.autorange==="reversed";if(!L){var A=w.simpleMap(_.range,_.r2l);L=A[1]<A[0]}L&&(b=!b)}var I=0;return r(f,_._id)||(I=function(P,S,E){var z=0,D=S._id.charAt(0)==="x";for(var j in P._plots){var V=P._plots[j];if(S._id===V.xaxis._id||S._id===V.yaxis._id){var Z=(D?V.yaxis:V.xaxis)||{};if((Z.ticklabelposition||"").indexOf("inside")!==-1&&(!E&&(Z.side==="left"||Z.side==="bottom")||E&&(Z.side==="top"||Z.side==="right"))){if(Z._vals){var Q=w.deg2rad(Z._tickAngles[Z._id+"tick"]||0),X=Math.abs(Math.cos(Q)),$=Math.abs(Math.sin(Q));if(!Z._vals[0].bb){var re=Z._id+"tick";Z._selections[re].each(function(B){var K=d.select(this);K.select(".text-math-group").empty()&&(B.bb=t.bBox(K.node()))})}for(var H=0;H<Z._vals.length;H++){var N=Z._vals[H].bb;if(N){var U=6+N.width,te=6+N.height;z=Math.max(z,D?Math.max(U*X,te*$):Math.max(te*X,U*$))}}}Z.ticks==="inside"&&Z.ticklabelposition==="inside"&&(z+=Z.ticklen||0)}}}return z}(f,_,b)),T=Math.max(I,T),_.constrain==="domain"&&_._inputDomain&&(T*=(_._inputDomain[1]-_._inputDomain[0])/(_.domain[1]-_.domain[0])),function(P){return P.nopad?0:P.pad+(P.extrapad?T:I)}}G.exports={getAutoRange:g,makePadFn:a,doAutoRange:function(f,_,b){if(_.setScale(),_.autorange){_.range=b?b.slice():g(f,_),_._r=_.range.slice(),_._rl=w.simpleMap(_._r,_.r2l);var T=_._input,k={};k[_._attr+".range"]=_.range,k[_._attr+".autorange"]=_.autorange,e.call("_storeDirectGUIEdit",f.layout,f._fullLayout._preGUI,k),T.range=_.range.slice(),T.autorange=_.autorange}var L=_._anchorAxis;if(L&&L.rangeslider){var A=L.rangeslider[_._name];A&&A.rangemode==="auto"&&(A.range=g(f,_)),L._input.rangeslider[_._name]=w.extendFlat({},A)}},findExtremes:function(f,_,b){b||(b={}),f._m||f.setScale();var T,k,L,A,I,P,S,E,z,D=[],j=[],V=_.length,Z=b.padded||!1,Q=b.tozero&&(f.type==="linear"||f.type==="-"),X=f.type==="log",$=!1,re=b.vpadLinearized||!1;function H(ne){if(Array.isArray(ne))return $=!0,function(oe){return Math.max(Number(ne[oe]||0),0)};var se=Math.max(Number(ne||0),0);return function(){return se}}var N=H((f._m>0?b.ppadplus:b.ppadminus)||b.ppad||0),U=H((f._m>0?b.ppadminus:b.ppadplus)||b.ppad||0),te=H(b.vpadplus||b.vpad),B=H(b.vpadminus||b.vpad);if(!$){if(E=1/0,z=-1/0,X)for(T=0;T<V;T++)(k=_[T])<E&&k>0&&(E=k),k>z&&k<y&&(z=k);else for(T=0;T<V;T++)(k=_[T])<E&&k>-y&&(E=k),k>z&&k<y&&(z=k);_=[E,z],V=2}var K={tozero:Q,extrapad:Z};function J(ne){L=_[ne],v(L)&&(P=N(ne),S=U(ne),re?(A=f.c2l(L)-B(ne),I=f.c2l(L)+te(ne)):(E=L-B(ne),z=L+te(ne),X&&E<z/10&&(E=z/10),A=f.c2l(E),I=f.c2l(z)),Q&&(A=Math.min(0,A),I=Math.max(0,I)),u(A)&&l(D,A,S,K),u(I)&&s(j,I,P,K))}var ee=Math.min(6,V);for(T=0;T<ee;T++)J(T);for(T=V-1;T>=ee;T--)J(T);return{min:D,max:j,opts:b}},concatExtremes:h};function h(f,_,b){var T,k,L,A=_._id,I=f._fullData,P=f._fullLayout,S=[],E=[];function z(Q,X){for(T=0;T<X.length;T++){var $=Q[X[T]],re=($._extremes||{})[A];if($.visible===!0&&re){for(k=0;k<re.min.length;k++)L=re.min[k],l(S,L.val,L.pad,{extrapad:L.extrapad});for(k=0;k<re.max.length;k++)L=re.max[k],s(E,L.val,L.pad,{extrapad:L.extrapad})}}}if(z(I,_._traceIndices),z(P.annotations||[],_._annIndices||[]),z(P.shapes||[],_._shapeIndices||[]),_._matchGroup&&!b){for(var D in _._matchGroup)if(D!==_._id){var j=o(f,D),V=h(f,j,!0),Z=_._length/j._length;for(k=0;k<V.min.length;k++)L=V.min[k],l(S,L.val,L.pad*Z,{extrapad:L.extrapad});for(k=0;k<V.max.length;k++)L=V.max[k],s(E,L.val,L.pad*Z,{extrapad:L.extrapad})}}return{min:S,max:E}}function l(f,_,b,T){p(f,_,b,T,i)}function s(f,_,b,T){p(f,_,b,T,x)}function p(f,_,b,T,k){for(var L=T.tozero,A=T.extrapad,I=!0,P=0;P<f.length&&I;P++){var S=f[P];if(k(S.val,_)&&S.pad>=b&&(S.extrapad||!A)){I=!1;break}k(_,S.val)&&S.pad<=b&&(A||!S.extrapad)&&(f.splice(P,1),P--)}if(I){var E=L&&_===0;f.push({val:_,pad:E?0:b,extrapad:!E&&A})}}function u(f){return v(f)&&Math.abs(f)<y}function i(f,_){return f<=_}function x(f,_){return f>=_}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../../registry":647,"./axis_ids":570,"@plotly/d3":58,"fast-isnumeric":190}],566:[function(m,G,Y){var d=m("@plotly/d3"),v=m("fast-isnumeric"),w=m("../../plots/plots"),y=m("../../registry"),e=m("../../lib"),t=e.strTranslate,n=m("../../lib/svg_text_utils"),o=m("../../components/titles"),r=m("../../components/color"),g=m("../../components/drawing"),c=m("./layout_attributes"),a=m("./clean_ticks"),h=m("../../constants/numerical"),l=h.ONEMAXYEAR,s=h.ONEAVGYEAR,p=h.ONEMINYEAR,u=h.ONEMAXQUARTER,i=h.ONEAVGQUARTER,x=h.ONEMINQUARTER,f=h.ONEMAXMONTH,_=h.ONEAVGMONTH,b=h.ONEMINMONTH,T=h.ONEWEEK,k=h.ONEDAY,L=k/2,A=h.ONEHOUR,I=h.ONEMIN,P=h.ONESEC,S=h.MINUS_SIGN,E=h.BADNUM,z={K:"zeroline"},D={K:"gridline",L:"path"},j={K:"minor-gridline",L:"path"},V={K:"tick",L:"path"},Z={K:"tick",L:"text"},Q={width:["x","r","l","xl","xr"],height:["y","t","b","yt","yb"],right:["r","xr"],left:["l","xl"],top:["t","yt"],bottom:["b","yb"]},X=m("../../constants/alignment"),$=X.MID_SHIFT,re=X.CAP_SHIFT,H=X.LINE_SPACING,N=X.OPPOSITE_SIDE,U=G.exports={};U.setConvert=m("./set_convert");var te=m("./axis_autotype"),B=m("./axis_ids"),K=B.idSort,J=B.isLinked;U.id2name=B.id2name,U.name2id=B.name2id,U.cleanId=B.cleanId,U.list=B.list,U.listIds=B.listIds,U.getFromId=B.getFromId,U.getFromTrace=B.getFromTrace;var ee=m("./autorange");U.getAutoRange=ee.getAutoRange,U.findExtremes=ee.findExtremes;function ne(pe){var _e=1e-4*(pe[1]-pe[0]);return[pe[0]-_e,pe[1]+_e]}U.coerceRef=function(pe,_e,Be,He,Je,Ze){var ct=He.charAt(He.length-1),lt=Be._fullLayout._subplots[ct+"axis"],At=He+"ref",Ot={};return Je||(Je=lt[0]||(typeof Ze=="string"?Ze:Ze[0])),Ze||(Ze=Je),lt=lt.concat(lt.map(function(it){return it+" domain"})),Ot[At]={valType:"enumerated",values:lt.concat(Ze?typeof Ze=="string"?[Ze]:Ze:[]),dflt:Je},e.coerce(pe,_e,Ot,At)},U.getRefType=function(pe){return pe===void 0?pe:pe==="paper"?"paper":pe==="pixel"?"pixel":/( domain)$/.test(pe)?"domain":"range"},U.coercePosition=function(pe,_e,Be,He,Je,Ze){var ct,lt;if(U.getRefType(He)!=="range")ct=e.ensureNumber,lt=Be(Je,Ze);else{var At=U.getFromId(_e,He);lt=Be(Je,Ze=At.fraction2r(Ze)),ct=At.cleanPos}pe[Je]=ct(lt)},U.cleanPosition=function(pe,_e,Be){return(Be==="paper"||Be==="pixel"?e.ensureNumber:U.getFromId(_e,Be).cleanPos)(pe)},U.redrawComponents=function(pe,_e){_e=_e||U.listIds(pe);var Be=pe._fullLayout;function He(Je,Ze,ct,lt){for(var At=y.getComponentMethod(Je,Ze),Ot={},it=0;it<_e.length;it++)for(var ht=Be[U.id2name(_e[it])][ct],Ut=0;Ut<ht.length;Ut++){var Mt=ht[Ut];if(!Ot[Mt]&&(At(pe,Mt),Ot[Mt]=1,lt))return}}He("annotations","drawOne","_annIndices"),He("shapes","drawOne","_shapeIndices"),He("images","draw","_imgIndices",!0),He("selections","drawOne","_selectionIndices")};var se=U.getDataConversions=function(pe,_e,Be,He){var Je,Ze=Be==="x"||Be==="y"||Be==="z"?Be:He;if(Array.isArray(Ze)){if(Je={type:te(He,void 0,{autotypenumbers:pe._fullLayout.autotypenumbers}),_categories:[]},U.setConvert(Je),Je.type==="category")for(var ct=0;ct<He.length;ct++)Je.d2c(He[ct])}else Je=U.getFromTrace(pe,_e,Ze);return Je?{d2c:Je.d2c,c2d:Je.c2d}:Ze==="ids"?{d2c:me,c2d:me}:{d2c:oe,c2d:oe}};function oe(pe){return+pe}function me(pe){return String(pe)}function ce(pe,_e){return Math.abs((pe/_e+.5)%1-.5)<.001}function ye(pe,_e){return Math.abs(pe/_e-1)<.001}function Se(pe){return+pe.substring(1)}function fe(pe){var _e=ne(e.simpleMap(pe.range,pe.r2l)),Be=Math.min(_e[0],_e[1]),He=Math.max(_e[0],_e[1]),Je=pe.type==="category"?pe.d2l_noadd:pe.d2l;pe.type==="log"&&String(pe.dtick).charAt(0)!=="L"&&(pe.dtick="L"+Math.pow(10,Math.floor(Math.min(pe.range[0],pe.range[1]))-1));for(var Ze=[],ct=0;ct<=1;ct++)if(!ct||pe.minor){var lt=ct?pe.minor.tickvals:pe.tickvals,At=ct?[]:pe.ticktext;if(lt){Array.isArray(At)||(At=[]);for(var Ot=0;Ot<lt.length;Ot++){var it=Je(lt[Ot]);if(it>Be&&it<He){var ht=At[Ot]===void 0?U.tickText(pe,it):Oe(pe,it,String(At[Ot]));ct&&(ht.minor=!0,ht.text=""),Ze.push(ht)}}}}return pe.rangebreaks&&(Ze=Ze.filter(function(Ut){return pe.maskBreaks(Ut.x)!==E})),Ze}U.getDataToCoordFunc=function(pe,_e,Be,He){return se(pe,_e,Be,He).d2c},U.counterLetter=function(pe){var _e=pe.charAt(0);return _e==="x"?"y":_e==="y"?"x":void 0},U.minDtick=function(pe,_e,Be,He){["log","category","multicategory"].indexOf(pe.type)===-1&&He?pe._minDtick===void 0?(pe._minDtick=_e,pe._forceTick0=Be):pe._minDtick&&((pe._minDtick/_e+1e-6)%1<2e-6&&((Be-pe._forceTick0)/_e%1+1.000001)%1<2e-6?(pe._minDtick=_e,pe._forceTick0=Be):((_e/pe._minDtick+1e-6)%1>2e-6||((Be-pe._forceTick0)/pe._minDtick%1+1.000001)%1>2e-6)&&(pe._minDtick=0)):pe._minDtick=0},U.saveRangeInitial=function(pe,_e){for(var Be=U.list(pe,"",!0),He=!1,Je=0;Je<Be.length;Je++){var Ze=Be[Je],ct=Ze._rangeInitial===void 0,lt=ct||!(Ze.range[0]===Ze._rangeInitial[0]&&Ze.range[1]===Ze._rangeInitial[1]);(ct&&Ze.autorange===!1||_e&&lt)&&(Ze._rangeInitial=Ze.range.slice(),He=!0)}return He},U.saveShowSpikeInitial=function(pe,_e){for(var Be=U.list(pe,"",!0),He=!1,Je="on",Ze=0;Ze<Be.length;Ze++){var ct=Be[Ze],lt=ct._showSpikeInitial===void 0,At=lt||ct.showspikes!==ct._showspikes;(lt||_e&&At)&&(ct._showSpikeInitial=ct.showspikes,He=!0),Je!=="on"||ct.showspikes||(Je="off")}return pe._fullLayout._cartesianSpikesEnabled=Je,He},U.autoBin=function(pe,_e,Be,He,Je,Ze){var ct,lt=e.aggNums(Math.min,null,pe),At=e.aggNums(Math.max,null,pe);if(_e.type==="category"||_e.type==="multicategory")return{start:lt-.5,end:At+.5,size:Math.max(1,Math.round(Ze)||1),_dataSpan:At-lt};if(Je||(Je=_e.calendar),ct=_e.type==="log"?{type:"linear",range:[lt,At]}:{type:_e.type,range:e.simpleMap([lt,At],_e.c2r,0,Je),calendar:Je},U.setConvert(ct),Ze=Ze&&a.dtick(Ze,ct.type))ct.dtick=Ze,ct.tick0=a.tick0(void 0,ct.type,Je);else{var Ot;if(Be)Ot=(At-lt)/Be;else{var it=e.distinctVals(pe),ht=Math.pow(10,Math.floor(Math.log(it.minDiff)/Math.LN10)),Ut=ht*e.roundUp(it.minDiff/ht,[.9,1.9,4.9,9.9],!0);Ot=Math.max(Ut,2*e.stdev(pe)/Math.pow(pe.length,He?.25:.4)),v(Ot)||(Ot=1)}U.autoTicks(ct,Ot)}var Mt,It=ct.dtick,Le=U.tickIncrement(U.tickFirst(ct),It,"reverse",Je);if(typeof It=="number")Mt=(Le=function(Xe,ot,pt,St,Vt){var Jt=0,qt=0,gr=0,Cr=0;function mr(dr){return(1+100*(dr-Xe)/pt.dtick)%100<2}for(var tr=0;tr<ot.length;tr++)ot[tr]%1==0?gr++:v(ot[tr])||Cr++,mr(ot[tr])&&Jt++,mr(ot[tr]+pt.dtick/2)&&qt++;var nr=ot.length-Cr;if(gr===nr&&pt.type!=="date")pt.dtick<1?Xe=St-.5*pt.dtick:(Xe-=.5)+pt.dtick<St&&(Xe+=pt.dtick);else if(qt<.1*nr&&(Jt>.3*nr||mr(St)||mr(Vt))){var Qt=pt.dtick/2;Xe+=Xe+Qt<St?Qt:-Qt}return Xe}(Le,pe,ct,lt,At))+(1+Math.floor((At-Le)/It))*It;else for(ct.dtick.charAt(0)==="M"&&(Le=function(Xe,ot,pt,St,Vt){var Jt=e.findExactDates(ot,Vt);if(Jt.exactDays>.8){var qt=Number(pt.substr(1));Jt.exactYears>.8&&qt%12==0?Xe=U.tickIncrement(Xe,"M6","reverse")+1.5*k:Jt.exactMonths>.8?Xe=U.tickIncrement(Xe,"M1","reverse")+15.5*k:Xe-=L;var gr=U.tickIncrement(Xe,pt);if(gr<=St)return gr}return Xe}(Le,pe,It,lt,Je)),Mt=Le,0;Mt<=At;)Mt=U.tickIncrement(Mt,It,!1,Je);return{start:_e.c2r(Le,0,Je),end:_e.c2r(Mt,0,Je),size:It,_dataSpan:At-lt}},U.prepMinorTicks=function(pe,_e,Be){if(!_e.minor.dtick){delete pe.dtick;var He,Je=_e.dtick&&v(_e._tmin);if(Je){var Ze=U.tickIncrement(_e._tmin,_e.dtick,!0);He=[_e._tmin,.99*Ze+.01*_e._tmin]}else{var ct=e.simpleMap(_e.range,_e.r2l);He=[ct[0],.8*ct[0]+.2*ct[1]]}if(pe.range=e.simpleMap(He,_e.l2r),pe._isMinor=!0,U.prepTicks(pe,Be),Je){var lt=v(_e.dtick),At=v(pe.dtick),Ot=lt?_e.dtick:+_e.dtick.substring(1),it=At?pe.dtick:+pe.dtick.substring(1);lt&&At?ce(Ot,it)?Ot===2*T&&it===2*k&&(pe.dtick=T):Ot===2*T&&it===3*k?pe.dtick=T:Ot!==T||(_e._input.minor||{}).nticks?ye(Ot/it,2.5)?pe.dtick=Ot/2:pe.dtick=Ot:pe.dtick=k:String(_e.dtick).charAt(0)==="M"?At?pe.dtick="M1":ce(Ot,it)?Ot>=12&&it===2&&(pe.dtick="M3"):pe.dtick=_e.dtick:String(pe.dtick).charAt(0)==="L"?String(_e.dtick).charAt(0)==="L"?ce(Ot,it)||(pe.dtick=ye(Ot/it,2.5)?_e.dtick/2:_e.dtick):pe.dtick="D1":pe.dtick==="D2"&&+_e.dtick>1&&(pe.dtick=1)}pe.range=_e.range}_e.minor._tick0Init===void 0&&(pe.tick0=_e.tick0)},U.prepTicks=function(pe,_e){var Be=e.simpleMap(pe.range,pe.r2l,void 0,void 0,_e);if(pe.tickmode==="auto"||!pe.dtick){var He,Je=pe.nticks;Je||(pe.type==="category"||pe.type==="multicategory"?(He=pe.tickfont?e.bigFont(pe.tickfont.size||12):15,Je=pe._length/He):(He=pe._id.charAt(0)==="y"?40:80,Je=e.constrain(pe._length/He,4,9)+1),pe._name==="radialaxis"&&(Je*=2)),pe.minor&&pe.minor.tickmode!=="array"||pe.tickmode==="array"&&(Je*=100),pe._roughDTick=Math.abs(Be[1]-Be[0])/Je,U.autoTicks(pe,pe._roughDTick),pe._minDtick>0&&pe.dtick<2*pe._minDtick&&(pe.dtick=pe._minDtick,pe.tick0=pe.l2r(pe._forceTick0))}pe.ticklabelmode==="period"&&function(Ze){var ct;function lt(){return!(v(Ze.dtick)||Ze.dtick.charAt(0)!=="M")}var At=lt(),Ot=U.getTickFormat(Ze);if(Ot){var it=Ze._dtickInit!==Ze.dtick;/%[fLQsSMX]/.test(Ot)||(/%[HI]/.test(Ot)?(ct=A,it&&!At&&Ze.dtick<A&&(Ze.dtick=A)):/%p/.test(Ot)?(ct=L,it&&!At&&Ze.dtick<L&&(Ze.dtick=L)):/%[Aadejuwx]/.test(Ot)?(ct=k,it&&!At&&Ze.dtick<k&&(Ze.dtick=k)):/%[UVW]/.test(Ot)?(ct=T,it&&!At&&Ze.dtick<T&&(Ze.dtick=T)):/%[Bbm]/.test(Ot)?(ct=_,it&&(At?Se(Ze.dtick)<1:Ze.dtick<b)&&(Ze.dtick="M1")):/%[q]/.test(Ot)?(ct=i,it&&(At?Se(Ze.dtick)<3:Ze.dtick<x)&&(Ze.dtick="M3")):/%[Yy]/.test(Ot)&&(ct=s,it&&(At?Se(Ze.dtick)<12:Ze.dtick<p)&&(Ze.dtick="M12")))}(At=lt())&&Ze.tick0===Ze._dowTick0&&(Ze.tick0=Ze._rawTick0),Ze._definedDelta=ct}(pe),pe.tick0||(pe.tick0=pe.type==="date"?"2000-01-01":0),pe.type==="date"&&pe.dtick<.1&&(pe.dtick=.1),De(pe)},U.calcTicks=function(pe,_e){for(var Be,He,Je=pe.type,Ze=pe.calendar,ct=pe.ticklabelstep,lt=pe.ticklabelmode==="period",At=e.simpleMap(pe.range,pe.r2l,void 0,void 0,_e),Ot=At[1]<At[0],it=Math.min(At[0],At[1]),ht=Math.max(At[0],At[1]),Ut=Math.max(1e3,pe._length||0),Mt=[],It=[],Le=[],Xe=[],ot=pe.minor&&(pe.minor.ticks||pe.minor.showgrid),pt=1;pt>=(ot?0:1);pt--){var St=!pt;pt?(pe._dtickInit=pe.dtick,pe._tick0Init=pe.tick0):(pe.minor._dtickInit=pe.minor.dtick,pe.minor._tick0Init=pe.minor.tick0);var Vt=pt?pe:e.extendFlat({},pe,pe.minor);if(St?U.prepMinorTicks(Vt,pe,_e):U.prepTicks(Vt,_e),Vt.tickmode!=="array"){var Jt=ne(At),qt=Jt[0],gr=Jt[1],Cr=v(Vt.dtick),mr=Je==="log"&&!(Cr||Vt.dtick.charAt(0)==="L"),tr=U.tickFirst(Vt,_e);if(pt){if(pe._tmin=tr,tr<qt!==Ot)break;Je!=="category"&&Je!=="multicategory"||(gr=Ot?Math.max(-.5,gr):Math.min(pe._categories.length-.5,gr))}var nr,Qt,dr=null,_r=tr;pt&&(Cr?Qt=pe.dtick:Je==="date"?typeof pe.dtick=="string"&&pe.dtick.charAt(0)==="M"&&(Qt=_*pe.dtick.substring(1)):Qt=pe._roughDTick,nr=Math.round((pe.r2l(_r)-pe.r2l(pe.tick0))/Qt)-1);var Ir=Vt.dtick;for(Vt.rangebreaks&&Vt._tick0Init!==Vt.tick0&&(_r=Dt(_r,pe),Ot||(_r=U.tickIncrement(_r,Ir,!Ot,Ze))),pt&&lt&&(_r=U.tickIncrement(_r,Ir,!Ot,Ze),nr--);Ot?_r>=gr:_r<=gr;_r=U.tickIncrement(_r,Ir,Ot,Ze)){if(pt&&nr++,Vt.rangebreaks&&!Ot){if(_r<qt)continue;if(Vt.maskBreaks(_r)===E&&Dt(_r,Vt)>=ht)break}if(Le.length>Ut||_r===dr)break;dr=_r;var Rr={value:_r};pt?(mr&&_r!==(0|_r)&&(Rr.simpleLabel=!0),ct>1&&nr%ct&&(Rr.skipLabel=!0),Le.push(Rr)):(Rr.minor=!0,Xe.push(Rr))}}else pt?(Le=[],Mt=fe(pe)):(Xe=[],It=fe(pe))}if(ot&&!(pe.minor.ticks==="inside"&&pe.ticks==="outside"||pe.minor.ticks==="outside"&&pe.ticks==="inside")){for(var Vr=Le.map(function(xr){return xr.value}),Xr=[],cn=0;cn<Xe.length;cn++){var an=Xe[cn],zn=an.value;if(Vr.indexOf(zn)===-1){for(var on=!1,Tn=0;!on&&Tn<Le.length;Tn++)1e7+Le[Tn].value===1e7+zn&&(on=!0);on||Xr.push(an)}}Xe=Xr}if(lt&&function(xr,jr,Rt){for(var or=0;or<xr.length;or++){var wt=xr[or].value,ir=or,ar=or+1;or<xr.length-1?(ir=or,ar=or+1):or>0?(ir=or-1,ar=or):(ir=or,ar=or);var Dr,Pr=xr[ir].value,Er=xr[ar].value,Ar=Math.abs(Er-Pr),vr=Rt||Ar,wr=0;vr>=p?wr=Ar>=p&&Ar<=l?Ar:s:Rt===i&&vr>=x?wr=Ar>=x&&Ar<=u?Ar:i:vr>=b?wr=Ar>=b&&Ar<=f?Ar:_:Rt===T&&vr>=T?wr=T:vr>=k?wr=k:Rt===L&&vr>=L?wr=L:Rt===A&&vr>=A&&(wr=A),wr>=Ar&&(wr=Ar,Dr=!0);var Mr=wt+wr;if(jr.rangebreaks&&wr>0){for(var Lr=0,Zr=0;Zr<84;Zr++){var Yr=(Zr+.5)/84;jr.maskBreaks(wt*(1-Yr)+Yr*Mr)!==E&&Lr++}(wr*=Lr/84)||(xr[or].drop=!0),Dr&&Ar>T&&(wr=Ar)}(wr>0||or===0)&&(xr[or].periodX=wt+wr/2)}}(Le,pe,pe._definedDelta),pe.rangebreaks){var Mn=pe._id.charAt(0)==="y",ei=1;pe.tickmode==="auto"&&(ei=pe.tickfont?pe.tickfont.size:12);var Hr=NaN;for(Be=Le.length-1;Be>-1;Be--)if(Le[Be].drop)Le.splice(Be,1);else{Le[Be].value=Dt(Le[Be].value,pe);var ln=pe.c2p(Le[Be].value);(Mn?Hr>ln-ei:Hr<ln+ei)?Le.splice(Ot?Be+1:Be,1):Hr=ln}}cr(pe)&&Math.abs(At[1]-At[0])===360&&Le.pop(),pe._tmax=(Le[Le.length-1]||{}).value,pe._prevDateHead="",pe._inCalcTicks=!0;var bn,nn,pn=function(xr){xr.text="",pe._prevDateHead=He};for(Le=Le.concat(Xe),Be=0;Be<Le.length;Be++){var qn=Le[Be].minor,sr=Le[Be].value;qn?It.push({x:sr,minor:!0}):(He=pe._prevDateHead,bn=U.tickText(pe,sr,!1,Le[Be].simpleLabel),(nn=Le[Be].periodX)!==void 0&&(bn.periodX=nn,(nn>ht||nn<it)&&(nn>ht&&(bn.periodX=ht),nn<it&&(bn.periodX=it),pn(bn))),Le[Be].skipLabel&&pn(bn),Mt.push(bn))}return Mt=Mt.concat(It),pe._inCalcTicks=!1,lt&&Mt.length&&(Mt[0].noTick=!0),Mt};var ge=[2,5,10],Te=[1,2,3,6,12],le=[1,2,5,10,15,30],ve=[1,2,3,7,14],Me=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],we=[-.301,0,.301,.699,1],de=[15,30,45,90,180];function Ie(pe,_e,Be){return _e*e.roundUp(pe/_e,Be)}function De(pe){var _e=pe.dtick;if(pe._tickexponent=0,v(_e)||typeof _e=="string"||(_e=1),pe.type!=="category"&&pe.type!=="multicategory"||(pe._tickround=null),pe.type==="date"){var Be=pe.r2l(pe.tick0),He=pe.l2r(Be).replace(/(^-|i)/g,""),Je=He.length;if(String(_e).charAt(0)==="M")Je>10||He.substr(5)!=="01-01"?pe._tickround="d":pe._tickround=+_e.substr(1)%12==0?"y":"m";else if(_e>=k&&Je<=10||_e>=15*k)pe._tickround="d";else if(_e>=I&&Je<=16||_e>=A)pe._tickround="M";else if(_e>=P&&Je<=19||_e>=I)pe._tickround="S";else{var Ze=pe.l2r(Be+_e).replace(/^-/,"").length;pe._tickround=Math.max(Je,Ze)-20,pe._tickround<0&&(pe._tickround=4)}}else if(v(_e)||_e.charAt(0)==="L"){var ct=pe.range.map(pe.r2d||Number);v(_e)||(_e=Number(_e.substr(1))),pe._tickround=2-Math.floor(Math.log(_e)/Math.LN10+.01);var lt=Math.max(Math.abs(ct[0]),Math.abs(ct[1])),At=Math.floor(Math.log(lt)/Math.LN10+.01),Ot=pe.minexponent===void 0?3:pe.minexponent;Math.abs(At)>Ot&&(Fe(pe.exponentformat)&&!ze(At)?pe._tickexponent=3*Math.round((At-1)/3):pe._tickexponent=At)}else pe._tickround=null}function Oe(pe,_e,Be){var He=pe.tickfont||{};return{x:_e,dx:0,dy:0,text:Be||"",fontSize:He.size,font:He.family,fontColor:He.color}}U.autoTicks=function(pe,_e,Be){var He;function Je(ht){return Math.pow(ht,Math.floor(Math.log(_e)/Math.LN10))}if(pe.type==="date"){pe.tick0=e.dateTick0(pe.calendar,0);var Ze=2*_e;if(Ze>s)_e/=s,He=Je(10),pe.dtick="M"+12*Ie(_e,He,ge);else if(Ze>_)_e/=_,pe.dtick="M"+Ie(_e,1,Te);else if(Ze>k){if(pe.dtick=Ie(_e,k,pe._hasDayOfWeekBreaks?[1,2,7,14]:ve),!Be){var ct=U.getTickFormat(pe),lt=pe.ticklabelmode==="period";lt&&(pe._rawTick0=pe.tick0),/%[uVW]/.test(ct)?pe.tick0=e.dateTick0(pe.calendar,2):pe.tick0=e.dateTick0(pe.calendar,1),lt&&(pe._dowTick0=pe.tick0)}}else Ze>A?pe.dtick=Ie(_e,A,Te):Ze>I?pe.dtick=Ie(_e,I,le):Ze>P?pe.dtick=Ie(_e,P,le):(He=Je(10),pe.dtick=Ie(_e,He,ge))}else if(pe.type==="log"){pe.tick0=0;var At=e.simpleMap(pe.range,pe.r2l);if(pe._isMinor&&(_e*=1.5),_e>.7)pe.dtick=Math.ceil(_e);else if(Math.abs(At[1]-At[0])<1){var Ot=1.5*Math.abs((At[1]-At[0])/_e);_e=Math.abs(Math.pow(10,At[1])-Math.pow(10,At[0]))/Ot,He=Je(10),pe.dtick="L"+Ie(_e,He,ge)}else pe.dtick=_e>.3?"D2":"D1"}else pe.type==="category"||pe.type==="multicategory"?(pe.tick0=0,pe.dtick=Math.ceil(Math.max(_e,1))):cr(pe)?(pe.tick0=0,He=1,pe.dtick=Ie(_e,He,de)):(pe.tick0=0,He=Je(10),pe.dtick=Ie(_e,He,ge));if(pe.dtick===0&&(pe.dtick=1),!v(pe.dtick)&&typeof pe.dtick!="string"){var it=pe.dtick;throw pe.dtick=1,"ax.dtick error: "+String(it)}},U.tickIncrement=function(pe,_e,Be,He){var Je=Be?-1:1;if(v(_e))return e.increment(pe,Je*_e);var Ze=_e.charAt(0),ct=Je*Number(_e.substr(1));if(Ze==="M")return e.incrementMonth(pe,ct,He);if(Ze==="L")return Math.log(Math.pow(10,pe)+ct)/Math.LN10;if(Ze==="D"){var lt=_e==="D2"?we:Me,At=pe+.01*Je,Ot=e.roundUp(e.mod(At,1),lt,Be);return Math.floor(At)+Math.log(d.round(Math.pow(10,Ot),1))/Math.LN10}throw"unrecognized dtick "+String(_e)},U.tickFirst=function(pe,_e){var Be=pe.r2l||Number,He=e.simpleMap(pe.range,Be,void 0,void 0,_e),Je=He[1]<He[0],Ze=Je?Math.floor:Math.ceil,ct=ne(He)[0],lt=pe.dtick,At=Be(pe.tick0);if(v(lt)){var Ot=Ze((ct-At)/lt)*lt+At;return pe.type!=="category"&&pe.type!=="multicategory"||(Ot=e.constrain(Ot,0,pe._categories.length-1)),Ot}var it=lt.charAt(0),ht=Number(lt.substr(1));if(it==="M"){for(var Ut,Mt,It,Le=0,Xe=At;Le<10;){if(((Ut=U.tickIncrement(Xe,lt,Je,pe.calendar))-ct)*(Xe-ct)<=0)return Je?Math.min(Xe,Ut):Math.max(Xe,Ut);Mt=(ct-(Xe+Ut)/2)/(Ut-Xe),It=it+(Math.abs(Math.round(Mt))||1)*ht,Xe=U.tickIncrement(Xe,It,Mt<0?!Je:Je,pe.calendar),Le++}return e.error("tickFirst did not converge",pe),Xe}if(it==="L")return Math.log(Ze((Math.pow(10,ct)-At)/ht)*ht+At)/Math.LN10;if(it==="D"){var ot=lt==="D2"?we:Me,pt=e.roundUp(e.mod(ct,1),ot,Je);return Math.floor(ct)+Math.log(d.round(Math.pow(10,pt),1))/Math.LN10}throw"unrecognized dtick "+String(lt)},U.tickText=function(pe,_e,Be,He){var Je,Ze=Oe(pe,_e),ct=pe.tickmode==="array",lt=Be||ct,At=pe.type,Ot=At==="category"?pe.d2l_noadd:pe.d2l;if(ct&&Array.isArray(pe.ticktext)){var it=e.simpleMap(pe.range,pe.r2l),ht=(Math.abs(it[1]-it[0])-(pe._lBreaks||0))/1e4;for(Je=0;Je<pe.ticktext.length&&!(Math.abs(_e-Ot(pe.tickvals[Je]))<ht);Je++);if(Je<pe.ticktext.length)return Ze.text=String(pe.ticktext[Je]),Ze}function Ut(Le){if(Le===void 0)return!0;if(Be)return Le==="none";var Xe={first:pe._tmin,last:pe._tmax}[Le];return Le!=="all"&&_e!==Xe}var Mt=Be?"never":pe.exponentformat!=="none"&&Ut(pe.showexponent)?"hide":"";if(At==="date"?function(Le,Xe,ot,pt){var St=Le._tickround,Vt=ot&&Le.hoverformat||U.getTickFormat(Le);pt&&(St=v(St)?4:{y:"m",m:"d",d:"M",M:"S",S:4}[St]);var Jt,qt=e.formatDate(Xe.x,Vt,St,Le._dateFormat,Le.calendar,Le._extraFormat),gr=qt.indexOf(`
`);if(gr!==-1&&(Jt=qt.substr(gr+1),qt=qt.substr(0,gr)),pt&&(qt==="00:00:00"||qt==="00:00"?(qt=Jt,Jt=""):qt.length===8&&(qt=qt.replace(/:00$/,""))),Jt)if(ot)St==="d"?qt+=", "+Jt:qt=Jt+(qt?", "+qt:"");else if(Le._inCalcTicks&&Le._prevDateHead===Jt){var Cr=Ne(Le),mr=Le._trueSide||Le.side;(!Cr&&mr==="top"||Cr&&mr==="bottom")&&(qt+="<br> ")}else Le._prevDateHead=Jt,qt+="<br>"+Jt;Xe.text=qt}(pe,Ze,Be,lt):At==="log"?function(Le,Xe,ot,pt,St){var Vt=Le.dtick,Jt=Xe.x,qt=Le.tickformat,gr=typeof Vt=="string"&&Vt.charAt(0);if(St==="never"&&(St=""),pt&&gr!=="L"&&(Vt="L3",gr="L"),qt||gr==="L")Xe.text=Re(Math.pow(10,Jt),Le,St,pt);else if(v(Vt)||gr==="D"&&e.mod(Jt+.01,1)<.1){var Cr=Math.round(Jt),mr=Math.abs(Cr),tr=Le.exponentformat;tr==="power"||Fe(tr)&&ze(Cr)?(Xe.text=Cr===0?1:Cr===1?"10":"10<sup>"+(Cr>1?"":S)+mr+"</sup>",Xe.fontSize*=1.25):(tr==="e"||tr==="E")&&mr>2?Xe.text="1"+tr+(Cr>0?"+":S)+mr:(Xe.text=Re(Math.pow(10,Jt),Le,"","fakehover"),Vt==="D1"&&Le._id.charAt(0)==="y"&&(Xe.dy-=Xe.fontSize/6))}else{if(gr!=="D")throw"unrecognized dtick "+String(Vt);Xe.text=String(Math.round(Math.pow(10,e.mod(Jt,1)))),Xe.fontSize*=.75}if(Le.dtick==="D1"){var nr=String(Xe.text).charAt(0);nr!=="0"&&nr!=="1"||(Le._id.charAt(0)==="y"?Xe.dx-=Xe.fontSize/4:(Xe.dy+=Xe.fontSize/2,Xe.dx+=(Le.range[1]>Le.range[0]?1:-1)*Xe.fontSize*(Jt<0?.5:.25)))}}(pe,Ze,0,lt,Mt):At==="category"?function(Le,Xe){var ot=Le._categories[Math.round(Xe.x)];ot===void 0&&(ot=""),Xe.text=String(ot)}(pe,Ze):At==="multicategory"?function(Le,Xe,ot){var pt=Math.round(Xe.x),St=Le._categories[pt]||[],Vt=St[1]===void 0?"":String(St[1]),Jt=St[0]===void 0?"":String(St[0]);ot?Xe.text=Jt+" - "+Vt:(Xe.text=Vt,Xe.text2=Jt)}(pe,Ze,Be):cr(pe)?function(Le,Xe,ot,pt,St){if(Le.thetaunit!=="radians"||ot)Xe.text=Re(Xe.x,Le,St,pt);else{var Vt=Xe.x/180;if(Vt===0)Xe.text="0";else{var Jt=function(gr){function Cr(Qt,dr){return Math.abs(Qt-dr)<=1e-6}var mr=function(Qt){for(var dr=1;!Cr(Math.round(Qt*dr)/dr,Qt);)dr*=10;return dr}(gr),tr=gr*mr,nr=Math.abs(function Qt(dr,_r){return Cr(_r,0)?dr:Qt(_r,dr%_r)}(tr,mr));return[Math.round(tr/nr),Math.round(mr/nr)]}(Vt);if(Jt[1]>=100)Xe.text=Re(e.deg2rad(Xe.x),Le,St,pt);else{var qt=Xe.x<0;Jt[1]===1?Jt[0]===1?Xe.text="\u03C0":Xe.text=Jt[0]+"\u03C0":Xe.text=["<sup>",Jt[0],"</sup>","\u2044","<sub>",Jt[1],"</sub>","\u03C0"].join(""),qt&&(Xe.text=S+Xe.text)}}}}(pe,Ze,Be,lt,Mt):function(Le,Xe,ot,pt,St){St==="never"?St="":Le.showexponent==="all"&&Math.abs(Xe.x/Le.dtick)<1e-6&&(St="hide"),Xe.text=Re(Xe.x,Le,St,pt)}(pe,Ze,0,lt,Mt),He||(pe.tickprefix&&!Ut(pe.showtickprefix)&&(Ze.text=pe.tickprefix+Ze.text),pe.ticksuffix&&!Ut(pe.showticksuffix)&&(Ze.text+=pe.ticksuffix)),pe.tickson==="boundaries"||pe.showdividers){var It=function(Le){var Xe=pe.l2p(Le);return Xe>=0&&Xe<=pe._length?Le:null};Ze.xbnd=[It(Ze.x-.5),It(Ze.x+pe.dtick-.5)]}return Ze},U.hoverLabelText=function(pe,_e,Be){Be&&(pe=e.extendFlat({},pe,{hoverformat:Be}));var He=Array.isArray(_e)?_e[0]:_e,Je=Array.isArray(_e)?_e[1]:void 0;if(Je!==void 0&&Je!==He)return U.hoverLabelText(pe,He,Be)+" - "+U.hoverLabelText(pe,Je,Be);var Ze=pe.type==="log"&&He<=0,ct=U.tickText(pe,pe.c2l(Ze?-He:He),"hover").text;return Ze?He===0?"0":S+ct:ct};var Ve=["f","p","n","\u03BC","m","","k","M","G","T"];function Fe(pe){return pe==="SI"||pe==="B"}function ze(pe){return pe>14||pe<-15}function Re(pe,_e,Be,He){var Je=pe<0,Ze=_e._tickround,ct=Be||_e.exponentformat||"B",lt=_e._tickexponent,At=U.getTickFormat(_e),Ot=_e.separatethousands;if(He){var it={exponentformat:ct,minexponent:_e.minexponent,dtick:_e.showexponent==="none"?_e.dtick:v(pe)&&Math.abs(pe)||1,range:_e.showexponent==="none"?_e.range.map(_e.r2d):[0,pe||1]};De(it),Ze=(Number(it._tickround)||0)+4,lt=it._tickexponent,_e.hoverformat&&(At=_e.hoverformat)}if(At)return _e._numFormat(At)(pe).replace(/-/g,S);var ht,Ut=Math.pow(10,-Ze)/2;if(ct==="none"&&(lt=0),(pe=Math.abs(pe))<Ut)pe="0",Je=!1;else{if(pe+=Ut,lt&&(pe*=Math.pow(10,-lt),Ze+=lt),Ze===0)pe=String(Math.floor(pe));else if(Ze<0){pe=(pe=String(Math.round(pe))).substr(0,pe.length+Ze);for(var Mt=Ze;Mt<0;Mt++)pe+="0"}else{var It=(pe=String(pe)).indexOf(".")+1;It&&(pe=pe.substr(0,It+Ze).replace(/\.?0+$/,""))}pe=e.numSeparate(pe,_e._separators,Ot)}return lt&&ct!=="hide"&&(Fe(ct)&&ze(lt)&&(ct="power"),ht=lt<0?S+-lt:ct!=="power"?"+"+lt:String(lt),ct==="e"||ct==="E"?pe+=ct+ht:ct==="power"?pe+="\xD710<sup>"+ht+"</sup>":ct==="B"&&lt===9?pe+="B":Fe(ct)&&(pe+=Ve[lt/3+5])),Je?S+pe:pe}function We(pe,_e){if(pe){var Be=Object.keys(Q).reduce(function(He,Je){return _e.indexOf(Je)!==-1&&Q[Je].forEach(function(Ze){He[Ze]=1}),He},{});Object.keys(pe).forEach(function(He){Be[He]||(He.length===1?pe[He]=0:delete pe[He])})}}function $e(pe,_e){for(var Be=[],He={},Je=0;Je<_e.length;Je++){var Ze=_e[Je];He[Ze.text2]?He[Ze.text2].push(Ze.x):He[Ze.text2]=[Ze.x]}for(var ct in He)Be.push(Oe(pe,e.interp(He[ct],.5),ct));return Be}function at(pe){return pe.periodX!==void 0?pe.periodX:pe.x}function gt(pe){return[pe.text,pe.x,pe.axInfo,pe.font,pe.fontSize,pe.fontColor].join("_")}function xt(pe){var _e=pe.title.font.size,Be=(pe.title.text.match(n.BR_TAG_ALL)||[]).length;return pe.title.hasOwnProperty("standoff")?Be?_e*(re+Be*H):_e*re:Be?_e*(Be+1)*H:_e}function mt(pe,_e){var Be=pe.l2p(_e);return Be>1&&Be<pe._length-1}function nt(pe){var _e=d.select(pe),Be=_e.select(".text-math-group");return Be.empty()?_e.select("text"):Be}function Qe(pe){return pe._id+".automargin"}function vt(pe){return Qe(pe)+".mirror"}function jt(pe){return pe._id+".rangeslider"}function Gt(pe,_e){for(var Be=0;Be<_e.length;Be++)pe.indexOf(_e[Be])===-1&&pe.push(_e[Be])}function $t(pe,_e,Be){var He,Je,Ze=[],ct=[],lt=pe.layout;for(He=0;He<_e.length;He++)Ze.push(U.getFromId(pe,_e[He]));for(He=0;He<Be.length;He++)ct.push(U.getFromId(pe,Be[He]));var At=Object.keys(c),Ot=["anchor","domain","overlaying","position","side","tickangle","editType"],it=["linear","log"];for(He=0;He<At.length;He++){var ht=At[He],Ut=Ze[0][ht],Mt=ct[0][ht],It=!0,Le=!1,Xe=!1;if(ht.charAt(0)!=="_"&&typeof Ut!="function"&&Ot.indexOf(ht)===-1){for(Je=1;Je<Ze.length&&It;Je++){var ot=Ze[Je][ht];ht==="type"&&it.indexOf(Ut)!==-1&&it.indexOf(ot)!==-1&&Ut!==ot?Le=!0:ot!==Ut&&(It=!1)}for(Je=1;Je<ct.length&&It;Je++){var pt=ct[Je][ht];ht==="type"&&it.indexOf(Mt)!==-1&&it.indexOf(pt)!==-1&&Mt!==pt?Xe=!0:ct[Je][ht]!==Mt&&(It=!1)}It&&(Le&&(lt[Ze[0]._name].type="linear"),Xe&&(lt[ct[0]._name].type="linear"),Zt(lt,ht,Ze,ct,pe._fullLayout._dfltTitle))}}for(He=0;He<pe._fullLayout.annotations.length;He++){var St=pe._fullLayout.annotations[He];_e.indexOf(St.xref)!==-1&&Be.indexOf(St.yref)!==-1&&e.swapAttrs(lt.annotations[He],["?"])}}function Zt(pe,_e,Be,He,Je){var Ze,ct=e.nestedProperty,lt=ct(pe[Be[0]._name],_e).get(),At=ct(pe[He[0]._name],_e).get();for(_e==="title"&&(lt&&lt.text===Je.x&&(lt.text=Je.y),At&&At.text===Je.y&&(At.text=Je.x)),Ze=0;Ze<Be.length;Ze++)ct(pe,Be[Ze]._name+"."+_e).set(At);for(Ze=0;Ze<He.length;Ze++)ct(pe,He[Ze]._name+"."+_e).set(lt)}function cr(pe){return pe._id==="angularaxis"}function Dt(pe,_e){for(var Be=_e._rangebreaks.length,He=0;He<Be;He++){var Je=_e._rangebreaks[He];if(pe>=Je.min&&pe<Je.max)return Je.max}return pe}function Ne(pe){return(pe.ticklabelposition||"").indexOf("inside")!==-1}function Ye(pe,_e){Ne(pe._anchorAxis||{})&&pe._hideCounterAxisInsideTickLabels&&pe._hideCounterAxisInsideTickLabels(_e)}U.getTickFormat=function(pe){var _e,Be,He,Je,Ze,ct,lt,At;function Ot(Ut){return typeof Ut!="string"?Ut:Number(Ut.replace("M",""))*_}function it(Ut,Mt){var It=["L","D"];if(typeof Ut==typeof Mt){if(typeof Ut=="number")return Ut-Mt;var Le=It.indexOf(Ut.charAt(0)),Xe=It.indexOf(Mt.charAt(0));return Le===Xe?Number(Ut.replace(/(L|D)/g,""))-Number(Mt.replace(/(L|D)/g,"")):Le-Xe}return typeof Ut=="number"?1:-1}function ht(Ut,Mt){var It=Mt[0]===null,Le=Mt[1]===null,Xe=it(Ut,Mt[0])>=0,ot=it(Ut,Mt[1])<=0;return(It||Xe)&&(Le||ot)}if(pe.tickformatstops&&pe.tickformatstops.length>0)switch(pe.type){case"date":case"linear":for(_e=0;_e<pe.tickformatstops.length;_e++)if((He=pe.tickformatstops[_e]).enabled&&(Je=pe.dtick,Ze=He.dtickrange,ct=void 0,lt=void 0,At=void 0,ct=Ot||function(Ut){return Ut},lt=Ze[0],At=Ze[1],(!lt&&typeof lt!="number"||ct(lt)<=ct(Je))&&(!At&&typeof At!="number"||ct(At)>=ct(Je)))){Be=He;break}break;case"log":for(_e=0;_e<pe.tickformatstops.length;_e++)if((He=pe.tickformatstops[_e]).enabled&&ht(pe.dtick,He.dtickrange)){Be=He;break}}return Be?Be.value:pe.tickformat},U.getSubplots=function(pe,_e){var Be=pe._fullLayout._subplots,He=Be.cartesian.concat(Be.gl2d||[]),Je=_e?U.findSubplotsWithAxis(He,_e):He;return Je.sort(function(Ze,ct){var lt=Ze.substr(1).split("y"),At=ct.substr(1).split("y");return lt[0]===At[0]?+lt[1]-+At[1]:+lt[0]-+At[0]}),Je},U.findSubplotsWithAxis=function(pe,_e){for(var Be=new RegExp(_e._id.charAt(0)==="x"?"^"+_e._id+"y":_e._id+"$"),He=[],Je=0;Je<pe.length;Je++){var Ze=pe[Je];Be.test(Ze)&&He.push(Ze)}return He},U.makeClipPaths=function(pe){var _e=pe._fullLayout;if(!_e._hasOnlyLargeSploms){var Be,He,Je={_offset:0,_length:_e.width,_id:""},Ze={_offset:0,_length:_e.height,_id:""},ct=U.list(pe,"x",!0),lt=U.list(pe,"y",!0),At=[];for(Be=0;Be<ct.length;Be++)for(At.push({x:ct[Be],y:Ze}),He=0;He<lt.length;He++)Be===0&&At.push({x:Je,y:lt[He]}),At.push({x:ct[Be],y:lt[He]});var Ot=_e._clips.selectAll(".axesclip").data(At,function(it){return it.x._id+it.y._id});Ot.enter().append("clipPath").classed("axesclip",!0).attr("id",function(it){return"clip"+_e._uid+it.x._id+it.y._id}).append("rect"),Ot.exit().remove(),Ot.each(function(it){d.select(this).select("rect").attr({x:it.x._offset||0,y:it.y._offset||0,width:it.x._length||1,height:it.y._length||1})})}},U.draw=function(pe,_e,Be){var He=pe._fullLayout;_e==="redraw"&&He._paper.selectAll("g.subplot").each(function(Ze){var ct=Ze[0],lt=He._plots[ct];if(lt){var At=lt.xaxis,Ot=lt.yaxis;lt.xaxislayer.selectAll("."+At._id+"tick").remove(),lt.yaxislayer.selectAll("."+Ot._id+"tick").remove(),lt.xaxislayer.selectAll("."+At._id+"tick2").remove(),lt.yaxislayer.selectAll("."+Ot._id+"tick2").remove(),lt.xaxislayer.selectAll("."+At._id+"divider").remove(),lt.yaxislayer.selectAll("."+Ot._id+"divider").remove(),lt.minorGridlayer&&lt.minorGridlayer.selectAll("path").remove(),lt.gridlayer&&lt.gridlayer.selectAll("path").remove(),lt.zerolinelayer&&lt.zerolinelayer.selectAll("path").remove(),He._infolayer.select(".g-"+At._id+"title").remove(),He._infolayer.select(".g-"+Ot._id+"title").remove()}});var Je=_e&&_e!=="redraw"?_e:U.listIds(pe);return e.syncOrAsync(Je.map(function(Ze){return function(){if(Ze){var ct=U.getFromId(pe,Ze),lt=U.drawOne(pe,ct,Be);return ct._r=ct.range.slice(),ct._rl=e.simpleMap(ct._r,ct.r2l),lt}}}))},U.drawOne=function(pe,_e,Be){var He,Je,Ze;Be=Be||{},_e.setScale();var ct=pe._fullLayout,lt=_e._id,At=lt.charAt(0),Ot=U.counterLetter(lt),it=ct._plots[_e._mainSubplot];if(it){var ht=it[At+"axislayer"],Ut=_e._mainLinePosition,Mt=_e._mainMirrorPosition,It=_e._vals=U.calcTicks(_e),Le=[_e.mirror,Ut,Mt].join("_");for(He=0;He<It.length;He++)It[He].axInfo=Le;_e._selections={},_e._tickAngles&&(_e._prevTickAngles=_e._tickAngles),_e._tickAngles={},_e._depth=null;var Xe={};if(_e.visible){var ot,pt,St=U.makeTransTickFn(_e),Vt=U.makeTransTickLabelFn(_e),Jt=_e.ticks==="inside",qt=_e.ticks==="outside";if(_e.tickson==="boundaries"){var gr=function(Rt,or){var wt,ir=[],ar=function(Dr,Pr){var Er=Dr.xbnd[Pr];Er!==null&&ir.push(e.extendFlat({},Dr,{x:Er}))};if(or.length){for(wt=0;wt<or.length;wt++)ar(or[wt],0);ar(or[wt-1],1)}return ir}(0,It);pt=U.clipEnds(_e,gr),ot=Jt?pt:gr}else pt=U.clipEnds(_e,It),ot=Jt&&_e.ticklabelmode!=="period"?pt:It;var Cr,mr=_e._gridVals=pt,tr=function(Rt,or){var wt,ir,ar=[],Dr=or.length&&or[or.length-1].x<or[0].x,Pr=function(Ar,vr){var wr=Ar.xbnd[vr];wr!==null&&ar.push(e.extendFlat({},Ar,{x:wr}))};if(Rt.showdividers&&or.length){for(wt=0;wt<or.length;wt++){var Er=or[wt];Er.text2!==ir&&Pr(Er,Dr?1:0),ir=Er.text2}Pr(or[wt-1],Dr?0:1)}return ar}(_e,It);if(!ct._hasOnlyLargeSploms){var nr=_e._subplotsWith,Qt={};for(He=0;He<nr.length;He++){Je=nr[He];var dr=(Ze=ct._plots[Je])[Ot+"axis"],_r=dr._mainAxis._id;if(!Qt[_r]){Qt[_r]=1;var Ir=At==="x"?"M0,"+dr._offset+"v"+dr._length:"M"+dr._offset+",0h"+dr._length;U.drawGrid(pe,_e,{vals:mr,counterAxis:dr,layer:Ze.gridlayer.select("."+lt),minorLayer:Ze.minorGridlayer.select("."+lt),path:Ir,transFn:St}),U.drawZeroLine(pe,_e,{counterAxis:dr,layer:Ze.zerolinelayer,path:Ir,transFn:St})}}}var Rr=U.getTickSigns(_e),Vr=U.getTickSigns(_e,"minor");if(_e.ticks||_e.minor&&_e.minor.ticks){var Xr,cn,an,zn,on=U.makeTickPath(_e,Ut,Rr[2]),Tn=U.makeTickPath(_e,Ut,Vr[2],{minor:!0});if(_e._anchorAxis&&_e.mirror&&_e.mirror!==!0?(Xr=U.makeTickPath(_e,Mt,Rr[3]),cn=U.makeTickPath(_e,Mt,Vr[3],{minor:!0}),an=on+Xr,zn=Tn+cn):(Xr="",cn="",an=on,zn=Tn),_e.showdividers&&qt&&_e.tickson==="boundaries"){var Mn={};for(He=0;He<tr.length;He++)Mn[tr[He].x]=1;Cr=function(Rt){return Mn[Rt.x]?Xr:an}}else Cr=function(Rt){return Rt.minor?zn:an}}if(U.drawTicks(pe,_e,{vals:ot,layer:ht,path:Cr,transFn:St}),_e.mirror==="allticks"){var ei=Object.keys(_e._linepositions||{});for(He=0;He<ei.length;He++){Je=ei[He],Ze=ct._plots[Je];var Hr=_e._linepositions[Je]||[],ln=Hr[0],bn=Hr[1],nn=Hr[2],pn=U.makeTickPath(_e,ln,nn?Rr[0]:Vr[0],{minor:nn})+U.makeTickPath(_e,bn,nn?Rr[1]:Vr[1],{minor:nn});U.drawTicks(pe,_e,{vals:ot,layer:Ze[At+"axislayer"],path:pn,transFn:St})}}var qn=[];if(qn.push(function(){return U.drawLabels(pe,_e,{vals:It,layer:ht,plotinfo:Ze,transFn:Vt,labelFns:U.makeLabelFns(_e,Ut)})}),_e.type==="multicategory"){var sr={x:2,y:10}[At];qn.push(function(){var Rt={x:"height",y:"width"}[At],or=jr()[Rt]+sr+(_e._tickAngles[lt+"tick"]?_e.tickfont.size*H:0);return U.drawLabels(pe,_e,{vals:$e(_e,It),layer:ht,cls:lt+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:St,labelFns:U.makeLabelFns(_e,Ut+or*Rr[4])})}),qn.push(function(){return _e._depth=Rr[4]*(jr("tick2")[_e.side]-Ut),function(Rt,or,wt){var ir=or._id+"divider",ar=wt.vals,Dr=wt.layer.selectAll("path."+ir).data(ar,gt);Dr.exit().remove(),Dr.enter().insert("path",":first-child").classed(ir,1).classed("crisp",1).call(r.stroke,or.dividercolor).style("stroke-width",g.crispRound(Rt,or.dividerwidth,1)+"px"),Dr.attr("transform",wt.transFn).attr("d",wt.path)}(pe,_e,{vals:tr,layer:ht,path:U.makeTickPath(_e,Ut,Rr[4],{len:_e._depth}),transFn:St})})}else _e.title.hasOwnProperty("standoff")&&qn.push(function(){_e._depth=Rr[4]*(jr()[_e.side]-Ut)});var xr=y.getComponentMethod("rangeslider","isVisible")(_e);return qn.push(function(){var Rt,or,wt,ir,ar=_e.side.charAt(0),Dr=N[_e.side].charAt(0),Pr=U.getPxPosition(pe,_e),Er=qt?_e.ticklen:0;if((_e.automargin||xr)&&(_e.type==="multicategory"?Rt=jr("tick2"):(Rt=jr(),At==="x"&&ar==="b"&&(_e._depth=Math.max(Rt.width>0?Rt.bottom-Pr:0,Er)))),_e.automargin){or={x:0,y:0,r:0,l:0,t:0,b:0};var Ar=[0,1];if(At==="x"){if(ar==="b"?or[ar]=_e._depth:(or[ar]=_e._depth=Math.max(Rt.width>0?Pr-Rt.top:0,Er),Ar.reverse()),Rt.width>0){var vr=Rt.right-(_e._offset+_e._length);vr>0&&(or.xr=1,or.r=vr);var wr=_e._offset-Rt.left;wr>0&&(or.xl=0,or.l=wr)}}else if(ar==="l"?or[ar]=_e._depth=Math.max(Rt.height>0?Pr-Rt.left:0,Er):(or[ar]=_e._depth=Math.max(Rt.height>0?Rt.right-Pr:0,Er),Ar.reverse()),Rt.height>0){var Mr=Rt.bottom-(_e._offset+_e._length);Mr>0&&(or.yb=0,or.b=Mr);var Lr=_e._offset-Rt.top;Lr>0&&(or.yt=1,or.t=Lr)}or[Ot]=_e.anchor==="free"?_e.position:_e._anchorAxis.domain[Ar[0]],_e.title.text!==ct._dfltTitle[At]&&(or[ar]+=xt(_e)+(_e.title.standoff||0)),_e.mirror&&_e.anchor!=="free"&&((wt={x:0,y:0,r:0,l:0,t:0,b:0})[Dr]=_e.linewidth,_e.mirror&&_e.mirror!==!0&&(wt[Dr]+=Er),_e.mirror===!0||_e.mirror==="ticks"?wt[Ot]=_e._anchorAxis.domain[Ar[1]]:_e.mirror!=="all"&&_e.mirror!=="allticks"||(wt[Ot]=[_e._counterDomainMin,_e._counterDomainMax][Ar[1]]))}xr&&(ir=y.getComponentMethod("rangeslider","autoMarginOpts")(pe,_e)),typeof _e.automargin=="string"&&(We(or,_e.automargin),We(wt,_e.automargin)),w.autoMargin(pe,Qe(_e),or),w.autoMargin(pe,vt(_e),wt),w.autoMargin(pe,jt(_e),ir)}),Be.skipTitle||xr&&_e.side==="bottom"||qn.push(function(){return function(Rt,or){var wt,ir=Rt._fullLayout,ar=or._id,Dr=ar.charAt(0),Pr=or.title.font.size;if(or.title.hasOwnProperty("standoff"))wt=or._depth+or.title.standoff+xt(or);else{var Er=Ne(or);if(or.type==="multicategory")wt=or._depth;else{var Ar=1.5*Pr;Er&&(Ar=.5*Pr,or.ticks==="outside"&&(Ar+=or.ticklen)),wt=10+Ar+(or.linewidth?or.linewidth-1:0)}Er||(wt+=Dr==="x"?or.side==="top"?Pr*(or.showticklabels?1:0):Pr*(or.showticklabels?1.5:.5):or.side==="right"?Pr*(or.showticklabels?1:.5):Pr*(or.showticklabels?.5:0))}var vr,wr,Mr,Lr,Zr=U.getPxPosition(Rt,or);if(Dr==="x"?(wr=or._offset+or._length/2,Mr=or.side==="top"?Zr-wt:Zr+wt):(Mr=or._offset+or._length/2,wr=or.side==="right"?Zr+wt:Zr-wt,vr={rotate:"-90",offset:0}),or.type!=="multicategory"){var Yr=or._selections[or._id+"tick"];if(Lr={selection:Yr,side:or.side},Yr&&Yr.node()&&Yr.node().parentNode){var rn=g.getTranslate(Yr.node().parentNode);Lr.offsetLeft=rn.x,Lr.offsetTop=rn.y}or.title.hasOwnProperty("standoff")&&(Lr.pad=0)}return o.draw(Rt,ar+"title",{propContainer:or,propName:or._name+".title.text",placeholder:ir._dfltTitle[Dr],avoid:Lr,transform:vr,attributes:{x:wr,y:Mr,"text-anchor":"middle"}})}(pe,_e)}),e.syncOrAsync(qn)}}function jr(Rt){var or=lt+(Rt||"tick");return Xe[or]||(Xe[or]=function(wt,ir){var ar,Dr,Pr,Er;return wt._selections[ir].size()?(ar=1/0,Dr=-1/0,Pr=1/0,Er=-1/0,wt._selections[ir].each(function(){var Ar=nt(this),vr=g.bBox(Ar.node().parentNode);ar=Math.min(ar,vr.top),Dr=Math.max(Dr,vr.bottom),Pr=Math.min(Pr,vr.left),Er=Math.max(Er,vr.right)})):(ar=0,Dr=0,Pr=0,Er=0),{top:ar,bottom:Dr,left:Pr,right:Er,height:Dr-ar,width:Er-Pr}}(_e,or)),Xe[or]}},U.getTickSigns=function(pe,_e){var Be=pe._id.charAt(0),He={x:"top",y:"right"}[Be],Je=pe.side===He?1:-1,Ze=[-1,1,Je,-Je];return(_e?(pe.minor||{}).ticks:pe.ticks)!=="inside"==(Be==="x")&&(Ze=Ze.map(function(ct){return-ct})),pe.side&&Ze.push({l:-1,t:-1,r:1,b:1}[pe.side.charAt(0)]),Ze},U.makeTransTickFn=function(pe){return pe._id.charAt(0)==="x"?function(_e){return t(pe._offset+pe.l2p(_e.x),0)}:function(_e){return t(0,pe._offset+pe.l2p(_e.x))}},U.makeTransTickLabelFn=function(pe){var _e=function(Je){var Ze=Je.ticklabelposition||"",ct=function(ot){return Ze.indexOf(ot)!==-1},lt=ct("top"),At=ct("left"),Ot=ct("right"),it=ct("bottom"),ht=ct("inside"),Ut=it||At||lt||Ot;if(!Ut&&!ht)return[0,0];var Mt=Je.side,It=Ut?(Je.tickwidth||0)/2:0,Le=3,Xe=Je.tickfont?Je.tickfont.size:12;return(it||lt)&&(It+=Xe*re,Le+=(Je.linewidth||0)/2),(At||Ot)&&(It+=(Je.linewidth||0)/2,Le+=3),ht&&Mt==="top"&&(Le-=Xe*(1-re)),(At||lt)&&(It=-It),Mt!=="bottom"&&Mt!=="right"||(Le=-Le),[Ut?It:0,ht?Le:0]}(pe),Be=_e[0],He=_e[1];return pe._id.charAt(0)==="x"?function(Je){return t(Be+pe._offset+pe.l2p(at(Je)),He)}:function(Je){return t(He,Be+pe._offset+pe.l2p(at(Je)))}},U.makeTickPath=function(pe,_e,Be,He){He||(He={});var Je=He.minor;if(Je&&!pe.minor)return"";var Ze=He.len!==void 0?He.len:Je?pe.minor.ticklen:pe.ticklen,ct=pe._id.charAt(0),lt=(pe.linewidth||1)/2;return ct==="x"?"M0,"+(_e+lt*Be)+"v"+Ze*Be:"M"+(_e+lt*Be)+",0h"+Ze*Be},U.makeLabelFns=function(pe,_e,Be){var He=pe.ticklabelposition||"",Je=function(nr){return He.indexOf(nr)!==-1},Ze=Je("top"),ct=Je("left"),lt=Je("right"),At=Je("bottom")||ct||Ze||lt,Ot=Je("inside"),it=He==="inside"&&pe.ticks==="inside"||!Ot&&pe.ticks==="outside"&&pe.tickson!=="boundaries",ht=0,Ut=0,Mt=it?pe.ticklen:0;if(Ot?Mt*=-1:At&&(Mt=0),it&&(ht+=Mt,Be)){var It=e.deg2rad(Be);ht=Mt*Math.cos(It)+1,Ut=Mt*Math.sin(It)}pe.showticklabels&&(it||pe.showline)&&(ht+=.2*pe.tickfont.size);var Le,Xe,ot,pt,St,Vt={labelStandoff:ht+=(pe.linewidth||1)/2*(Ot?-1:1),labelShift:Ut},Jt=0,qt=pe.side,gr=pe._id.charAt(0),Cr=pe.tickangle;if(gr==="x")pt=(St=!Ot&&qt==="bottom"||Ot&&qt==="top")?1:-1,Ot&&(pt*=-1),Le=Ut*pt,Xe=_e+ht*pt,ot=St?1:-.2,Math.abs(Cr)===90&&(Ot?ot+=$:ot=Cr===-90&&qt==="bottom"?re:Cr===90&&qt==="top"?$:.5,Jt=$/2*(Cr/90)),Vt.xFn=function(nr){return nr.dx+Le+Jt*nr.fontSize},Vt.yFn=function(nr){return nr.dy+Xe+nr.fontSize*ot},Vt.anchorFn=function(nr,Qt){if(At){if(ct)return"end";if(lt)return"start"}return v(Qt)&&Qt!==0&&Qt!==180?Qt*pt<0!==Ot?"end":"start":"middle"},Vt.heightFn=function(nr,Qt,dr){return Qt<-60||Qt>60?-.5*dr:pe.side==="top"!==Ot?-dr:0};else if(gr==="y"){if(pt=(St=!Ot&&qt==="left"||Ot&&qt==="right")?1:-1,Ot&&(pt*=-1),Le=ht,Xe=Ut*pt,ot=0,Ot||Math.abs(Cr)!==90||(ot=Cr===-90&&qt==="left"||Cr===90&&qt==="right"?re:.5),Ot){var mr=v(Cr)?+Cr:0;if(mr!==0){var tr=e.deg2rad(mr);Jt=Math.abs(Math.sin(tr))*re*pt,ot=0}}Vt.xFn=function(nr){return nr.dx+_e-(Le+nr.fontSize*ot)*pt+Jt*nr.fontSize},Vt.yFn=function(nr){return nr.dy+Xe+nr.fontSize*$},Vt.anchorFn=function(nr,Qt){return v(Qt)&&Math.abs(Qt)===90?"middle":St?"end":"start"},Vt.heightFn=function(nr,Qt,dr){return pe.side==="right"&&(Qt*=-1),Qt<-30?-dr:Qt<30?-.5*dr:0}}return Vt},U.drawTicks=function(pe,_e,Be){Be=Be||{};var He=_e._id+"tick",Je=[].concat(_e.minor&&_e.minor.ticks?Be.vals.filter(function(ct){return ct.minor&&!ct.noTick}):[]).concat(_e.ticks?Be.vals.filter(function(ct){return!ct.minor&&!ct.noTick}):[]),Ze=Be.layer.selectAll("path."+He).data(Je,gt);Ze.exit().remove(),Ze.enter().append("path").classed(He,1).classed("ticks",1).classed("crisp",Be.crisp!==!1).each(function(ct){return r.stroke(d.select(this),ct.minor?_e.minor.tickcolor:_e.tickcolor)}).style("stroke-width",function(ct){return g.crispRound(pe,ct.minor?_e.minor.tickwidth:_e.tickwidth,1)+"px"}).attr("d",Be.path).style("display",null),Ye(_e,[V]),Ze.attr("transform",Be.transFn)},U.drawGrid=function(pe,_e,Be){Be=Be||{};var He=_e._id+"grid",Je=_e.minor&&_e.minor.showgrid,Ze=Je?Be.vals.filter(function(ot){return ot.minor}):[],ct=_e.showgrid?Be.vals.filter(function(ot){return!ot.minor}):[],lt=Be.counterAxis;if(lt&&U.shouldShowZeroLine(pe,_e,lt))for(var At=_e.tickmode==="array",Ot=0;Ot<ct.length;Ot++){var it=ct[Ot].x;if(At?!it:Math.abs(it)<_e.dtick/100){if(ct=ct.slice(0,Ot).concat(ct.slice(Ot+1)),!At)break;Ot--}}_e._gw=g.crispRound(pe,_e.gridwidth,1);for(var ht=Je?g.crispRound(pe,_e.minor.gridwidth,1):0,Ut=Be.layer,Mt=Be.minorLayer,It=1;It>=0;It--){var Le=It?Ut:Mt;if(Le){var Xe=Le.selectAll("path."+He).data(It?ct:Ze,gt);Xe.exit().remove(),Xe.enter().append("path").classed(He,1).classed("crisp",Be.crisp!==!1),Xe.attr("transform",Be.transFn).attr("d",Be.path).each(function(ot){return r.stroke(d.select(this),ot.minor?_e.minor.gridcolor:_e.gridcolor||"#ddd")}).style("stroke-dasharray",function(ot){return g.dashStyle(ot.minor?_e.minor.griddash:_e.griddash,ot.minor?_e.minor.gridwidth:_e.gridwidth)}).style("stroke-width",function(ot){return(ot.minor?ht:_e._gw)+"px"}).style("display",null),typeof Be.path=="function"&&Xe.attr("d",Be.path)}}Ye(_e,[D,j])},U.drawZeroLine=function(pe,_e,Be){Be=Be||Be;var He=_e._id+"zl",Je=U.shouldShowZeroLine(pe,_e,Be.counterAxis),Ze=Be.layer.selectAll("path."+He).data(Je?[{x:0,id:_e._id}]:[]);Ze.exit().remove(),Ze.enter().append("path").classed(He,1).classed("zl",1).classed("crisp",Be.crisp!==!1).each(function(){Be.layer.selectAll("path").sort(function(ct,lt){return K(ct.id,lt.id)})}),Ze.attr("transform",Be.transFn).attr("d",Be.path).call(r.stroke,_e.zerolinecolor||r.defaultLine).style("stroke-width",g.crispRound(pe,_e.zerolinewidth,_e._gw||1)+"px").style("display",null),Ye(_e,[z])},U.drawLabels=function(pe,_e,Be){Be=Be||{};var He=pe._fullLayout,Je=_e._id,Ze=Je.charAt(0),ct=Be.cls||Je+"tick",lt=Be.vals.filter(function(pt){return pt.text}),At=Be.labelFns,Ot=Be.secondary?0:_e.tickangle,it=(_e._prevTickAngles||{})[ct],ht=Be.layer.selectAll("g."+ct).data(_e.showticklabels?lt:[],gt),Ut=[];function Mt(pt,St){pt.each(function(Vt){var Jt=d.select(this),qt=Jt.select(".text-math-group"),gr=At.anchorFn(Vt,St),Cr=Be.transFn.call(Jt.node(),Vt)+(v(St)&&+St!=0?" rotate("+St+","+At.xFn(Vt)+","+(At.yFn(Vt)-Vt.fontSize/2)+")":""),mr=n.lineCount(Jt),tr=H*Vt.fontSize,nr=At.heightFn(Vt,v(St)?+St:0,(mr-1)*tr);if(nr&&(Cr+=t(0,nr)),qt.empty()){var Qt=Jt.select("text");Qt.attr({transform:Cr,"text-anchor":gr}),Qt.style("opacity",1),_e._adjustTickLabelsOverflow&&_e._adjustTickLabelsOverflow()}else{var dr=g.bBox(qt.node()).width*{end:-.5,start:.5}[gr];qt.attr("transform",Cr+t(dr,0))}})}ht.enter().append("g").classed(ct,1).append("text").attr("text-anchor","middle").each(function(pt){var St=d.select(this),Vt=pe._promises.length;St.call(n.positionText,At.xFn(pt),At.yFn(pt)).call(g.font,pt.font,pt.fontSize,pt.fontColor).text(pt.text).call(n.convertToTspans,pe),pe._promises[Vt]?Ut.push(pe._promises.pop().then(function(){Mt(St,Ot)})):Mt(St,Ot)}),Ye(_e,[Z]),ht.exit().remove(),Be.repositionOnUpdate&&ht.each(function(pt){d.select(this).select("text").call(n.positionText,At.xFn(pt),At.yFn(pt))}),_e._adjustTickLabelsOverflow=function(){var pt=_e.ticklabeloverflow;if(pt&&pt!=="allow"){var St=pt.indexOf("hide")!==-1,Vt=_e._id.charAt(0)==="x",Jt=0,qt=Vt?pe._fullLayout.width:pe._fullLayout.height;if(pt.indexOf("domain")!==-1){var gr=e.simpleMap(_e.range,_e.r2l);Jt=_e.l2p(gr[0])+_e._offset,qt=_e.l2p(gr[1])+_e._offset}var Cr=Math.min(Jt,qt),mr=Math.max(Jt,qt),tr=_e.side,nr=1/0,Qt=-1/0;for(var dr in ht.each(function(Rr){var Vr=d.select(this);if(Vr.select(".text-math-group").empty()){var Xr=g.bBox(Vr.node()),cn=0;Vt?(Xr.right>mr||Xr.left<Cr)&&(cn=1):(Xr.bottom>mr||Xr.top+(_e.tickangle?0:Rr.fontSize/4)<Cr)&&(cn=1);var an=Vr.select("text");cn?St&&an.style("opacity",0):(an.style("opacity",1),nr=tr==="bottom"||tr==="right"?Math.min(nr,Vt?Xr.top:Xr.left):-1/0,Qt=tr==="top"||tr==="left"?Math.max(Qt,Vt?Xr.bottom:Xr.right):1/0)}}),He._plots){var _r=He._plots[dr];if(_e._id===_r.xaxis._id||_e._id===_r.yaxis._id){var Ir=Vt?_r.yaxis:_r.xaxis;Ir&&(Ir["_visibleLabelMin_"+_e._id]=nr,Ir["_visibleLabelMax_"+_e._id]=Qt)}}}},_e._hideCounterAxisInsideTickLabels=function(pt){var St=_e._id.charAt(0)==="x",Vt=[];for(var Jt in He._plots){var qt=He._plots[Jt];_e._id!==qt.xaxis._id&&_e._id!==qt.yaxis._id||Vt.push(St?qt.yaxis:qt.xaxis)}Vt.forEach(function(gr,Cr){gr&&Ne(gr)&&(pt||[z,j,D,V,Z]).forEach(function(mr){var tr=mr.K==="tick"&&mr.L==="text"&&_e.ticklabelmode==="period",nr=He._plots[_e._mainSubplot];(mr.K===z.K?nr.zerolinelayer.selectAll("."+_e._id+"zl"):mr.K===j.K?nr.minorGridlayer.selectAll("."+_e._id):mr.K===D.K?nr.gridlayer.selectAll("."+_e._id):nr[_e._id.charAt(0)+"axislayer"]).each(function(){var Qt=d.select(this);mr.L&&(Qt=Qt.selectAll(mr.L)),Qt.each(function(dr){var _r=_e.l2p(tr?at(dr):dr.x)+_e._offset,Ir=d.select(this);_r<_e["_visibleLabelMax_"+gr._id]&&_r>_e["_visibleLabelMin_"+gr._id]?Ir.style("display","none"):mr.K!=="tick"||Cr||Ir.style("display",null)})})})})},Mt(ht,it+1?it:Ot);var It=null;_e._selections&&(_e._selections[ct]=ht);var Le=[function(){return Ut.length&&Promise.all(Ut)}];_e.automargin&&He._redrawFromAutoMarginCount&&it===90?(It=90,Le.push(function(){Mt(ht,it)})):Le.push(function(){if(Mt(ht,Ot),lt.length&&Ze==="x"&&!v(Ot)&&(_e.type!=="log"||String(_e.dtick).charAt(0)!=="D")){It=0;var pt,St=0,Vt=[];if(ht.each(function(Vr){St=Math.max(St,Vr.fontSize);var Xr=_e.l2p(Vr.x),cn=nt(this),an=g.bBox(cn.node());Vt.push({top:0,bottom:10,height:10,left:Xr-an.width/2,right:Xr+an.width/2+2,width:an.width+2})}),_e.tickson!=="boundaries"&&!_e.showdividers||Be.secondary){var Jt=lt.length,qt=Math.abs((lt[Jt-1].x-lt[0].x)*_e._m)/(Jt-1),gr=_e.ticklabelposition||"",Cr=function(Vr){return gr.indexOf(Vr)!==-1},mr=Cr("top"),tr=Cr("left"),nr=Cr("right"),Qt=Cr("bottom")||tr||mr||nr?(_e.tickwidth||0)+6:0,dr=qt<2.5*St||_e.type==="multicategory"||_e._name==="realaxis";for(pt=0;pt<Vt.length-1;pt++)if(e.bBoxIntersect(Vt[pt],Vt[pt+1],Qt)){It=dr?90:30;break}}else{var _r=2;for(_e.ticks&&(_r+=_e.tickwidth/2),pt=0;pt<Vt.length;pt++){var Ir=lt[pt].xbnd,Rr=Vt[pt];if(Ir[0]!==null&&Rr.left-_e.l2p(Ir[0])<_r||Ir[1]!==null&&_e.l2p(Ir[1])-Rr.right<_r){It=90;break}}}It&&Mt(ht,It)}}),_e._tickAngles&&Le.push(function(){_e._tickAngles[ct]=It===null?v(Ot)?Ot:0:It});var Xe=_e._anchorAxis;Xe&&Xe.autorange&&Ne(_e)&&!J(He,_e._id)&&(He._insideTickLabelsAutorange||(He._insideTickLabelsAutorange={}),He._insideTickLabelsAutorange[Xe._name+".autorange"]=Xe.autorange,Le.push(function(){ht.each(function(pt,St){var Vt=nt(this);Vt.select(".text-math-group").empty()&&(_e._vals[St].bb=g.bBox(Vt.node()))})}));var ot=e.syncOrAsync(Le);return ot&&ot.then&&pe._promises.push(ot),ot},U.getPxPosition=function(pe,_e){var Be,He=pe._fullLayout._size,Je=_e._id.charAt(0),Ze=_e.side;return _e.anchor!=="free"?Be=_e._anchorAxis:Je==="x"?Be={_offset:He.t+(1-(_e.position||0))*He.h,_length:0}:Je==="y"&&(Be={_offset:He.l+(_e.position||0)*He.w,_length:0}),Ze==="top"||Ze==="left"?Be._offset:Ze==="bottom"||Ze==="right"?Be._offset+Be._length:void 0},U.shouldShowZeroLine=function(pe,_e,Be){var He=e.simpleMap(_e.range,_e.r2l);return He[0]*He[1]<=0&&_e.zeroline&&(_e.type==="linear"||_e.type==="-")&&!(_e.rangebreaks&&_e.maskBreaks(0)===E)&&(mt(_e,0)||!function(Je,Ze,ct,lt){var At=ct._mainAxis;if(!At)return;var Ot=Je._fullLayout,it=Ze._id.charAt(0),ht=U.counterLetter(Ze._id),Ut=Ze._offset+(Math.abs(lt[0])<Math.abs(lt[1])==(it==="x")?0:Ze._length);function Mt(pt){if(!pt.showline||!pt.linewidth)return!1;var St=Math.max((pt.linewidth+Ze.zerolinewidth)/2,1);function Vt(gr){return typeof gr=="number"&&Math.abs(gr-Ut)<St}if(Vt(pt._mainLinePosition)||Vt(pt._mainMirrorPosition))return!0;var Jt=pt._linepositions||{};for(var qt in Jt)if(Vt(Jt[qt][0])||Vt(Jt[qt][1]))return!0}var It=Ot._plots[ct._mainSubplot];if(!(It.mainplotinfo||It).overlays.length)return Mt(ct);for(var Le=U.list(Je,ht),Xe=0;Xe<Le.length;Xe++){var ot=Le[Xe];if(ot._mainAxis===At&&Mt(ot))return!0}}(pe,_e,Be,He)||function(Je,Ze){for(var ct=Je._fullData,lt=Ze._mainSubplot,At=Ze._id.charAt(0),Ot=0;Ot<ct.length;Ot++){var it=ct[Ot];if(it.visible===!0&&it.xaxis+it.yaxis===lt&&(y.traceIs(it,"bar-like")&&it.orientation==={x:"h",y:"v"}[At]||it.fill&&it.fill.charAt(it.fill.length-1)===At))return!0}return!1}(pe,_e))},U.clipEnds=function(pe,_e){return _e.filter(function(Be){return mt(pe,Be.x)})},U.allowAutoMargin=function(pe){for(var _e=U.list(pe,"",!0),Be=0;Be<_e.length;Be++){var He=_e[Be];He.automargin&&(w.allowAutoMargin(pe,Qe(He)),He.mirror&&w.allowAutoMargin(pe,vt(He))),y.getComponentMethod("rangeslider","isVisible")(He)&&w.allowAutoMargin(pe,jt(He))}},U.swap=function(pe,_e){for(var Be=function(Je,Ze){var ct,lt,At=[];for(ct=0;ct<Ze.length;ct++){var Ot=[],it=Je._fullData[Ze[ct]].xaxis,ht=Je._fullData[Ze[ct]].yaxis;if(it&&ht){for(lt=0;lt<At.length;lt++)At[lt].x.indexOf(it)===-1&&At[lt].y.indexOf(ht)===-1||Ot.push(lt);if(Ot.length){var Ut,Mt=At[Ot[0]];if(Ot.length>1)for(lt=1;lt<Ot.length;lt++)Ut=At[Ot[lt]],Gt(Mt.x,Ut.x),Gt(Mt.y,Ut.y);Gt(Mt.x,[it]),Gt(Mt.y,[ht])}else At.push({x:[it],y:[ht]})}}return At}(pe,_e),He=0;He<Be.length;He++)$t(pe,Be[He].x,Be[He].y)}},{"../../components/color":367,"../../components/drawing":389,"../../components/titles":476,"../../constants/alignment":483,"../../constants/numerical":491,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../../registry":647,"./autorange":565,"./axis_autotype":567,"./axis_ids":570,"./clean_ticks":572,"./layout_attributes":579,"./set_convert":585,"@plotly/d3":58,"fast-isnumeric":190}],567:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("../../constants/numerical").BADNUM,y=v.isArrayOrTypedArray,e=v.isDateTime,t=v.cleanNumber,n=Math.round;function o(g,c){return c?d(g):typeof g=="number"}function r(g){return Math.max(1,(g-1)/1e3)}G.exports=function(g,c,a){var h=g,l=a.noMultiCategory;if(y(h)&&!h.length)return"-";if(!l&&function(x){return y(x[0])&&y(x[1])}(h))return"multicategory";if(l&&Array.isArray(h[0])){for(var s=[],p=0;p<h.length;p++)if(y(h[p]))for(var u=0;u<h[p].length;u++)s.push(h[p][u]);h=s}if(function(x,f){for(var _=x.length,b=r(_),T=0,k=0,L={},A=0;A<_;A+=b){var I=n(A),P=x[I],S=String(P);L[S]||(L[S]=1,e(P,f)&&T++,d(P)&&k++)}return T>2*k}(h,c))return"date";var i=a.autotypenumbers!=="strict";return function(x,f){for(var _=x.length,b=r(_),T=0,k=0,L={},A=0;A<_;A+=b){var I=n(A),P=x[I],S=String(P);if(!L[S]){L[S]=1;var E=typeof P;E==="boolean"?k++:(f?t(P)!==w:E==="number")?T++:E==="string"&&k++}}return k>2*T}(h,i)?"category":function(x,f){for(var _=x.length,b=0;b<_;b++)if(o(x[b],f))return!0;return!1}(h,i)?"linear":"-"}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],568:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../registry"),w=m("../../lib"),y=m("../../plot_api/plot_template"),e=m("../array_container_defaults"),t=m("./layout_attributes"),n=m("./tick_value_defaults"),o=m("./tick_mark_defaults"),r=m("./tick_label_defaults"),g=m("./prefix_suffix_defaults"),c=m("./category_order_defaults"),a=m("./line_grid_defaults"),h=m("./set_convert"),l=m("./constants").WEEKDAY_PATTERN,s=m("./constants").HOUR_PATTERN;function p(x,f,_){function b(E,z){return w.coerce(x,f,t.rangebreaks,E,z)}if(b("enabled")){var T=b("bounds");if(T&&T.length>=2){var k,L,A="";if(T.length===2){for(k=0;k<2;k++)if(L=i(T[k])){A=l;break}}var I=b("pattern",A);if(I===l)for(k=0;k<2;k++)(L=i(T[k]))&&(f.bounds[k]=T[k]=L-1);if(I)for(k=0;k<2;k++)switch(L=T[k],I){case l:if(!d(L)||(L=+L)!==Math.floor(L)||L<0||L>=7)return void(f.enabled=!1);f.bounds[k]=T[k]=L;break;case s:if(!d(L)||(L=+L)<0||L>24)return void(f.enabled=!1);f.bounds[k]=T[k]=L}if(_.autorange===!1){var P=_.range;if(P[0]<P[1]){if(T[0]<P[0]&&T[1]>P[1])return void(f.enabled=!1)}else if(T[0]>P[0]&&T[1]<P[1])return void(f.enabled=!1)}}else{var S=b("values");if(!S||!S.length)return void(f.enabled=!1);b("dvalue")}}}G.exports=function(x,f,_,b,T){var k,L=b.letter,A=b.font||{},I=b.splomStash||{},P=_("visible",!b.visibleDflt),S=f._template||{},E=f.type||S.type||"-";E==="date"&&(v.getComponentMethod("calendars","handleDefaults")(x,f,"calendar",b.calendar),b.noTicklabelmode||(k=_("ticklabelmode")));var z="";b.noTicklabelposition&&E!=="multicategory"||(z=w.coerce(x,f,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:k==="period"?["outside","inside"]:L==="x"?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition")),b.noTicklabeloverflow||_("ticklabeloverflow",z.indexOf("inside")!==-1?"hide past domain":E==="category"||E==="multicategory"?"allow":"hide past div"),h(f,T);var D=!f.isValidRange(x.range);D&&b.reverseDflt&&(D="reversed"),!_("autorange",D)||E!=="linear"&&E!=="-"||_("rangemode"),_("range"),f.cleanRange(),c(x,f,_,b),E==="category"||b.noHover||_("hoverformat");var j=_("color"),V=j!==t.color.dflt?j:A.color,Z=I.label||T._dfltTitle[L];if(g(x,f,_,E,b),!P)return f;_("title.text",Z),w.coerceFont(_,"title.font",{family:A.family,size:w.bigFont(A.size),color:V}),n(x,f,_,E);var Q=b.hasMinor;if(Q&&(y.newContainer(f,"minor"),n(x,f,_,E,{isMinor:!0})),r(x,f,_,E,b),o(x,f,_,b),Q){var X=b.isMinor;b.isMinor=!0,o(x,f,_,b),b.isMinor=X}a(x,f,_,{dfltColor:j,bgColor:b.bgColor,showGrid:b.showGrid,hasMinor:Q,attributes:t}),!Q||f.minor.ticks||f.minor.showgrid||delete f.minor,(f.showline||f.ticks)&&_("mirror"),b.automargin&&_("automargin");var $,re=E==="multicategory";if(b.noTickson||E!=="category"&&!re||!f.ticks&&!f.showgrid||(re&&($="boundaries"),_("tickson",$)==="boundaries"&&delete f.ticklabelposition),re&&_("showdividers")&&(_("dividercolor"),_("dividerwidth")),E==="date")if(e(x,f,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:p}),f.rangebreaks.length){for(var H=0;H<f.rangebreaks.length;H++)if(f.rangebreaks[H].pattern===l){f._hasDayOfWeekBreaks=!0;break}if(h(f,T),T._has("scattergl")||T._has("splom"))for(var N=0;N<b.data.length;N++){var U=b.data[N];U.type!=="scattergl"&&U.type!=="splom"||(U.visible=!1,w.warn(U.type+" traces do not work on axes with rangebreaks. Setting trace "+U.index+" to `visible: false`."))}}else delete f.rangebreaks;return f};var u={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function i(x){if(typeof x=="string")return u[x.substr(0,3).toLowerCase()]}},{"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"../array_container_defaults":561,"./category_order_defaults":571,"./constants":573,"./layout_attributes":579,"./line_grid_defaults":581,"./prefix_suffix_defaults":583,"./set_convert":585,"./tick_label_defaults":587,"./tick_mark_defaults":588,"./tick_value_defaults":589,"fast-isnumeric":190}],569:[function(m,G,Y){var d=m("../../constants/docs"),v=d.FORMAT_LINK,w=d.DATE_FORMAT_LINK;function y(t,n){return["Sets the "+t+" formatting rule"+(n?"for `"+n+"` ":""),"using d3 formatting mini-languages","which are very similar to those in Python. For numbers, see: "+v+"."].join(" ")}function e(t,n){return y(t,n)+[" And for dates see: "+w+".","We add two items to d3's date formatter:","*%h* for half of the year as a decimal number as well as","*%{n}f* for fractional seconds","with n digits. For example, *2016-10-13 09:15:23.456* with tickformat","*%H~%M~%S.%2f* would display *09~15~23.46*"].join(" ")}G.exports={axisHoverFormat:function(t,n){return{valType:"string",dflt:"",editType:"none",description:(n?y:e)("hover text",t)+["By default the values are formatted using "+(n?"generic number format":"`"+t+"axis.hoverformat`")+"."].join(" ")}},descriptionOnlyNumbers:y,descriptionWithDates:e}},{"../../constants/docs":486}],570:[function(m,G,Y){var d=m("../../registry"),v=m("./constants");function w(y,e){if(e&&e.length){for(var t=0;t<e.length;t++)if(e[t][y])return!0}return!1}Y.id2name=function(y){if(typeof y=="string"&&y.match(v.AX_ID_PATTERN)){var e=y.split(" ")[0].substr(1);return e==="1"&&(e=""),y.charAt(0)+"axis"+e}},Y.name2id=function(y){if(y.match(v.AX_NAME_PATTERN)){var e=y.substr(5);return e==="1"&&(e=""),y.charAt(0)+e}},Y.cleanId=function(y,e,t){var n=/( domain)$/.test(y);if(typeof y=="string"&&y.match(v.AX_ID_PATTERN)&&(!e||y.charAt(0)===e)&&(!n||t)){var o=y.split(" ")[0].substr(1).replace(/^0+/,"");return o==="1"&&(o=""),y.charAt(0)+o+(n&&t?" domain":"")}},Y.list=function(y,e,t){var n=y._fullLayout;if(!n)return[];var o,r=Y.listIds(y,e),g=new Array(r.length);for(o=0;o<r.length;o++){var c=r[o];g[o]=n[c.charAt(0)+"axis"+c.substr(1)]}if(!t){var a=n._subplots.gl3d||[];for(o=0;o<a.length;o++){var h=n[a[o]];e?g.push(h[e+"axis"]):g.push(h.xaxis,h.yaxis,h.zaxis)}}return g},Y.listIds=function(y,e){var t=y._fullLayout;if(!t)return[];var n=t._subplots;return e?n[e+"axis"]:n.xaxis.concat(n.yaxis)},Y.getFromId=function(y,e,t){var n=y._fullLayout;return e=e===void 0||typeof e!="string"?e:e.replace(" domain",""),t==="x"?e=e.replace(/y[0-9]*/,""):t==="y"&&(e=e.replace(/x[0-9]*/,"")),n[Y.id2name(e)]},Y.getFromTrace=function(y,e,t){var n=y._fullLayout,o=null;if(d.traceIs(e,"gl3d")){var r=e.scene;r.substr(0,5)==="scene"&&(o=n[r][t+"axis"])}else o=Y.getFromId(y,e[t+"axis"]||t);return o},Y.idSort=function(y,e){var t=y.charAt(0),n=e.charAt(0);return t!==n?t>n?1:-1:+(y.substr(1)||1)-+(e.substr(1)||1)},Y.ref2id=function(y){return!!/^[xyz]/.test(y)&&y.split(" ")[0]},Y.isLinked=function(y,e){return w(e,y._axisMatchGroups)||w(e,y._axisConstraintGroups)}},{"../../registry":647,"./constants":573}],571:[function(m,G,Y){G.exports=function(d,v,w,y){if(v.type==="category"){var e,t=d.categoryarray,n=Array.isArray(t)&&t.length>0;n&&(e="array");var o,r=w("categoryorder",e);r==="array"&&(o=w("categoryarray")),n||r!=="array"||(r=v.categoryorder="trace"),r==="trace"?v._initialCategories=[]:r==="array"?v._initialCategories=o.slice():(o=function(g,c){var a,h,l,s=c.dataAttr||g._id.charAt(0),p={};if(c.axData)a=c.axData;else for(a=[],h=0;h<c.data.length;h++){var u=c.data[h];u[s+"axis"]===g._id&&a.push(u)}for(h=0;h<a.length;h++){var i=a[h][s];for(l=0;l<i.length;l++){var x=i[l];x!=null&&(p[x]=1)}}return Object.keys(p)}(v,y).sort(),r==="category ascending"?v._initialCategories=o:r==="category descending"&&(v._initialCategories=o.reverse()))}}},{}],572:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("../../constants/numerical"),y=w.ONEDAY,e=w.ONEWEEK;Y.dtick=function(t,n){var o=n==="log",r=n==="date",g=n==="category",c=r?y:1;if(!t)return c;if(d(t))return(t=Number(t))<=0?c:g?Math.max(1,Math.round(t)):r?Math.max(.1,t):t;if(typeof t!="string"||!r&&!o)return c;var a=t.charAt(0),h=t.substr(1);return(h=d(h)?Number(h):0)<=0||!(r&&a==="M"&&h===Math.round(h)||o&&a==="L"||o&&a==="D"&&(h===1||h===2))?c:t},Y.tick0=function(t,n,o,r){return n==="date"?v.cleanDate(t,v.dateTick0(o,r%e==0?1:0)):r!=="D1"&&r!=="D2"?d(t)?Number(t):0:void 0}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],573:[function(m,G,Y){var d=m("../../lib/regex").counter;G.exports={idRegex:{x:d("x","( domain)?"),y:d("y","( domain)?")},attrRegex:d("[xy]axis"),xAxisMatch:d("xaxis"),yAxisMatch:d("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINZOOM:20,DRAGGERSIZE:20,REDRAWDELAY:50,DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":532}],574:[function(m,G,Y){var d=m("../../lib"),v=m("./autorange"),w=m("./axis_ids").id2name,y=m("./layout_attributes"),e=m("./scale_zoom"),t=m("./set_convert"),n=m("../../constants/numerical").ALMOST_EQUAL,o=m("../../constants/alignment").FROM_BL;function r(p,u,i){var x=i.axIds,f=i.layoutOut,_=i.hasImage,b=f._axisConstraintGroups,T=f._axisMatchGroups,k=u._id,L=k.charAt(0),A=((f._splomAxes||{})[L]||{})[k]||{},I=u._id,P=I.charAt(0)==="x";function S(te,B){return d.coerce(p,u,y,te,B)}u._matchGroup=null,u._constraintGroup=null,S("constrain",_?"domain":"range"),d.coerce(p,u,{constraintoward:{valType:"enumerated",values:P?["left","center","right"]:["bottom","middle","top"],dflt:P?"center":"middle"}},"constraintoward");var E,z,D=u.type,j=[];for(E=0;E<x.length;E++)(z=x[E])!==I&&f[w(z)].type===D&&j.push(z);var V=c(b,I);if(V){var Z=[];for(E=0;E<j.length;E++)V[z=j[E]]||Z.push(z);j=Z}var Q,X,$=j.length;$&&(p.matches||A.matches)&&(Q=d.coerce(p,u,{matches:{valType:"enumerated",values:j,dflt:j.indexOf(A.matches)!==-1?A.matches:void 0}},"matches"));var re=_&&!P?u.anchor:void 0;if($&&!Q&&(p.scaleanchor||re)&&(X=d.coerce(p,u,{scaleanchor:{valType:"enumerated",values:j}},"scaleanchor",re)),Q){u._matchGroup=a(T,I,Q,1);var H=f[w(Q)],N=g(f,u)/g(f,H);P!==(Q.charAt(0)==="x")&&(N=(P?"x":"y")+N),a(b,I,Q,N)}else p.matches&&x.indexOf(p.matches)!==-1&&d.warn("ignored "+u._name+'.matches: "'+p.matches+'" to avoid an infinite loop');if(X){var U=S("scaleratio");U||(U=u.scaleratio=1),a(b,I,X,U)}else p.scaleanchor&&x.indexOf(p.scaleanchor)!==-1&&d.warn("ignored "+u._name+'.scaleanchor: "'+p.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because this axis declares a *matches* constraint.')}function g(p,u){var i=u.domain;return i||(i=p[w(u.overlaying)].domain),i[1]-i[0]}function c(p,u){for(var i=0;i<p.length;i++)if(p[i][u])return p[i];return null}function a(p,u,i,x){var f,_,b,T,k,L=c(p,u);L===null?((L={})[u]=1,k=p.length,p.push(L)):k=p.indexOf(L);var A=Object.keys(L);for(f=0;f<p.length;f++)if(b=p[f],f!==k&&b[i]){var I=b[i];for(_=0;_<A.length;_++)b[T=A[_]]=h(I,h(x,L[T]));return void p.splice(k,1)}if(x!==1)for(_=0;_<A.length;_++){var P=A[_];L[P]=h(x,L[P])}L[i]=1}function h(p,u){var i,x,f="",_="";typeof p=="string"&&(i=(f=p.match(/^[xy]*/)[0]).length,p=+p.substr(i)),typeof u=="string"&&(x=(_=u.match(/^[xy]*/)[0]).length,u=+u.substr(x));var b=p*u;return i||x?i&&x&&f.charAt(0)!==_.charAt(0)?i===x?b:(i>x?f.substr(x):_.substr(i))+b:f+_+p*u:b}function l(p,u){for(var i=u._size,x=i.h/i.w,f={},_=Object.keys(p),b=0;b<_.length;b++){var T=_[b],k=p[T];if(typeof k=="string"){var L=k.match(/^[xy]*/)[0],A=L.length;k=+k.substr(A);for(var I=L.charAt(0)==="y"?x:1/x,P=0;P<A;P++)k*=I}f[T]=k}return f}function s(p,u){var i=p._inputDomain,x=o[p.constraintoward],f=i[0]+(i[1]-i[0])*x;p.domain=p._input.domain=[f+(i[0]-f)/u,f+(i[1]-f)/u],p.setScale()}Y.handleDefaults=function(p,u,i){var x,f,_,b,T,k,L,A,I=i.axIds,P=i.axHasImage,S=u._axisConstraintGroups=[],E=u._axisMatchGroups=[];for(x=0;x<I.length;x++)r(T=p[b=w(I[x])],k=u[b],{axIds:I,layoutOut:u,hasImage:P[b]});function z(H,N){for(x=0;x<H.length;x++)for(_ in f=H[x])u[w(_)][N]=f}for(z(E,"_matchGroup"),x=0;x<S.length;x++)for(_ in f=S[x])if((k=u[w(_)]).fixedrange){for(var D in f){var j=w(D);(p[j]||{}).fixedrange===!1&&d.warn("fixedrange was specified as false for axis "+j+" but was overridden because another axis in its constraint group has fixedrange true"),u[j].fixedrange=!0}break}for(x=0;x<S.length;){for(_ in f=S[x]){(k=u[w(_)])._matchGroup&&Object.keys(k._matchGroup).length===Object.keys(f).length&&(S.splice(x,1),x--);break}x++}z(S,"_constraintGroup");var V=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"],Z=!1,Q=!1;function X(){A=k[L],L==="rangebreaks"&&(Q=k._hasDayOfWeekBreaks)}for(x=0;x<E.length;x++){f=E[x];for(var $=0;$<V.length;$++){var re;for(_ in L=V[$],A=null,f)if(T=p[b=w(_)],k=u[b],L in k){if(!k.matches&&(re=k,L in T)){X();break}A===null&&L in T&&X()}if(L==="range"&&A&&(Z=!0),L==="autorange"&&A===null&&Z&&(A=!1),A===null&&L in re&&(A=re[L]),A!==null)for(_ in f)(k=u[w(_)])[L]=L==="range"?A.slice():A,L==="rangebreaks"&&(k._hasDayOfWeekBreaks=Q,t(k,u))}}},Y.enforce=function(p){var u,i,x,f,_,b,T,k,L=p._fullLayout,A=L._axisConstraintGroups||[];for(u=0;u<A.length;u++){x=l(A[u],L);var I=Object.keys(x),P=1/0,S=0,E=1/0,z={},D={},j=!1;for(i=0;i<I.length;i++)D[f=I[i]]=_=L[w(f)],_._inputDomain?_.domain=_._inputDomain.slice():_._inputDomain=_.domain.slice(),_._inputRange||(_._inputRange=_.range.slice()),_.setScale(),z[f]=b=Math.abs(_._m)/x[f],P=Math.min(P,b),_.constrain!=="domain"&&_._constraintShrinkable||(E=Math.min(E,b)),delete _._constraintShrinkable,S=Math.max(S,b),_.constrain==="domain"&&(j=!0);if(!(P>n*S)||j){for(i=0;i<I.length;i++)if(b=z[f=I[i]],T=(_=D[f]).constrain,b!==E||T==="domain")if(k=b/E,T==="range")e(_,k);else{var V=_._inputDomain,Z=(_.domain[1]-_.domain[0])/(V[1]-V[0]),Q=(_.r2l(_.range[1])-_.r2l(_.range[0]))/(_.r2l(_._inputRange[1])-_.r2l(_._inputRange[0]));if((k/=Z)*Q<1){_.domain=_._input.domain=V.slice(),e(_,k);continue}if(Q<1&&(_.range=_._input.range=_._inputRange.slice(),k*=Q),_.autorange){var X=_.r2l(_.range[0]),$=_.r2l(_.range[1]),re=(X+$)/2,H=re,N=re,U=Math.abs($-re),te=re-U*k*1.0001,B=re+U*k*1.0001,K=v.makePadFn(L,_,0),J=v.makePadFn(L,_,1);s(_,k);var ee,ne,se=Math.abs(_._m),oe=v.concatExtremes(p,_),me=oe.min,ce=oe.max;for(ne=0;ne<me.length;ne++)(ee=me[ne].val-K(me[ne])/se)>te&&ee<H&&(H=ee);for(ne=0;ne<ce.length;ne++)(ee=ce[ne].val+J(ce[ne])/se)<B&&ee>N&&(N=ee);k/=(N-H)/(2*U),H=_.l2r(H),N=_.l2r(N),_.range=_._input.range=X<$?[H,N]:[N,H]}s(_,k)}}}},Y.getAxisGroup=function(p,u){for(var i=p._axisMatchGroups,x=0;x<i.length;x++)if(i[x][u])return"g"+x;return u},Y.clean=function(p,u){if(u._inputDomain){for(var i=!1,x=u._id,f=p._fullLayout._axisConstraintGroups,_=0;_<f.length;_++)if(f[_][x]){i=!0;break}i&&u.constrain==="domain"||(u._input.domain=u.domain=u._inputDomain,delete u._inputDomain)}}},{"../../constants/alignment":483,"../../constants/numerical":491,"../../lib":515,"./autorange":565,"./axis_ids":570,"./layout_attributes":579,"./scale_zoom":584,"./set_convert":585}],575:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../lib"),w=v.numberFormat,y=m("tinycolor2"),e=m("has-passive-events"),t=m("../../registry"),n=v.strTranslate,o=m("../../lib/svg_text_utils"),r=m("../../components/color"),g=m("../../components/drawing"),c=m("../../components/fx"),a=m("./axes"),h=m("../../lib/setcursor"),l=m("../../components/dragelement"),s=m("../../components/dragelement/helpers"),p=s.selectingOrDrawing,u=s.freeMode,i=m("../../constants/alignment").FROM_TL,x=m("../../lib/clear_gl_canvases"),f=m("../../plot_api/subroutines").redrawReglTraces,_=m("../plots"),b=m("./axis_ids").getFromId,T=m("../../components/selections").prepSelect,k=m("../../components/selections").clearOutline,L=m("../../components/selections").selectOnClick,A=m("./scale_zoom"),I=m("./constants"),P=I.MINDRAG,S=I.MINZOOM,E=!0;function z(ee,ne,se,oe){var me=v.ensureSingle(ee.draglayer,ne,se,function(ce){ce.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",ee.id)});return me.call(h,oe),me.node()}function D(ee,ne,se,oe,me,ce,ye){var Se=z(ee,"rect",ne,se);return d.select(Se).call(g.setRect,oe,me,ce,ye),Se}function j(ee,ne){for(var se=0;se<ee.length;se++)if(!ee[se].fixedrange)return ne;return""}function V(ee,ne,se,oe,me){for(var ce=0;ce<ee.length;ce++){var ye=ee[ce];if(!ye.fixedrange)if(ye.rangebreaks){var Se=ye._id.charAt(0)==="y",fe=Se?1-ne:ne,ge=Se?1-se:se;oe[ye._name+".range[0]"]=ye.l2r(ye.p2l(fe*ye._length)),oe[ye._name+".range[1]"]=ye.l2r(ye.p2l(ge*ye._length))}else{var Te=ye._rl[0],le=ye._rl[1]-Te;oe[ye._name+".range[0]"]=ye.l2r(Te+le*ne),oe[ye._name+".range[1]"]=ye.l2r(Te+le*se)}}if(me&&me.length){var ve=(ne+(1-se))/2;V(me,ve,1-ve,oe,[])}}function Z(ee,ne){for(var se=0;se<ee.length;se++){var oe=ee[se];if(!oe.fixedrange)if(oe.rangebreaks){var me=oe._length,ce=(oe.p2l(0+ne)-oe.p2l(0)+(oe.p2l(me+ne)-oe.p2l(me)))/2;oe.range=[oe.l2r(oe._rl[0]-ce),oe.l2r(oe._rl[1]-ce)]}else oe.range=[oe.l2r(oe._rl[0]-ne/oe._m),oe.l2r(oe._rl[1]-ne/oe._m)]}}function Q(ee){return 1-(ee>=0?Math.min(ee,.9):1/(1/Math.max(ee,-.3)+3.222))}function X(ee,ne,se,oe,me){return ee.append("path").attr("class","zoombox").style({fill:ne>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",n(se,oe)).attr("d",me+"Z")}function $(ee,ne,se){return ee.append("path").attr("class","zoombox-corners").style({fill:r.background,stroke:r.defaultLine,"stroke-width":1,opacity:0}).attr("transform",n(ne,se)).attr("d","M0,0Z")}function re(ee,ne,se,oe,me,ce){ee.attr("d",oe+"M"+se.l+","+se.t+"v"+se.h+"h"+se.w+"v-"+se.h+"h-"+se.w+"Z"),H(ee,ne,me,ce)}function H(ee,ne,se,oe){se||(ee.transition().style("fill",oe>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),ne.transition().style("opacity",1).duration(200))}function N(ee){d.select(ee).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function U(ee){E&&ee.data&&ee._context.showTips&&(v.notifier(v._(ee,"Double-click to zoom back out"),"long"),E=!1)}function te(ee){var ne=Math.floor(Math.min(ee.b-ee.t,ee.r-ee.l,S)/2);return"M"+(ee.l-3.5)+","+(ee.t-.5+ne)+"h3v"+-ne+"h"+ne+"v-3h-"+(ne+3)+"ZM"+(ee.r+3.5)+","+(ee.t-.5+ne)+"h-3v"+-ne+"h"+-ne+"v-3h"+(ne+3)+"ZM"+(ee.r+3.5)+","+(ee.b+.5-ne)+"h-3v"+ne+"h"+-ne+"v3h"+(ne+3)+"ZM"+(ee.l-3.5)+","+(ee.b+.5-ne)+"h3v"+ne+"h"+ne+"v3h-"+(ne+3)+"Z"}function B(ee,ne,se,oe,me){for(var ce,ye,Se,fe,ge=!1,Te={},le={},ve=(me||{}).xaHash,Me=(me||{}).yaHash,we=0;we<ne.length;we++){var de=ne[we];for(ce in se)if(de[ce]){for(Se in de)me&&(ve[Se]||Me[Se])||(Se.charAt(0)==="x"?se:oe)[Se]||(Te[Se]=ce);for(ye in oe)me&&(ve[ye]||Me[ye])||!de[ye]||(ge=!0)}for(ye in oe)if(de[ye])for(fe in de)me&&(ve[fe]||Me[fe])||(fe.charAt(0)==="x"?se:oe)[fe]||(le[fe]=ye)}ge&&(v.extendFlat(Te,le),le={});var Ie={},De=[];for(Se in Te){var Oe=b(ee,Se);De.push(Oe),Ie[Oe._id]=Oe}var Ve={},Fe=[];for(fe in le){var ze=b(ee,fe);Fe.push(ze),Ve[ze._id]=ze}return{xaHash:Ie,yaHash:Ve,xaxes:De,yaxes:Fe,xLinks:Te,yLinks:le,isSubplotConstrained:ge}}function K(ee,ne){if(e){var se=ee.onwheel!==void 0?"wheel":"mousewheel";ee._onwheel&&ee.removeEventListener(se,ee._onwheel),ee._onwheel=ne,ee.addEventListener(se,ne,{passive:!1})}else ee.onwheel!==void 0?ee.onwheel=ne:ee.onmousewheel!==void 0?ee.onmousewheel=ne:ee.isAddedWheelEvent||(ee.isAddedWheelEvent=!0,ee.addEventListener("wheel",ne,{passive:!1}))}function J(ee){var ne=[];for(var se in ee)ne.push(ee[se]);return ne}G.exports={makeDragBox:function(ee,ne,se,oe,me,ce,ye,Se){var fe,ge,Te,le,ve,Me,we,de,Ie,De,Oe,Ve,Fe,ze,Re,We,$e,at,gt,xt,mt,nt,Qe,vt=ee._fullLayout._zoomlayer,jt=ye+Se==="nsew",Gt=(ye+Se).length===1;function $t(){if(fe=ne.xaxis,ge=ne.yaxis,Ie=fe._length,De=ge._length,we=fe._offset,de=ge._offset,(Te={})[fe._id]=fe,(le={})[ge._id]=ge,ye&&Se)for(var tr=ne.overlays,nr=0;nr<tr.length;nr++){var Qt=tr[nr].xaxis;Te[Qt._id]=Qt;var dr=tr[nr].yaxis;le[dr._id]=dr}ve=J(Te),Me=J(le),Fe=j(ve,Se),ze=j(Me,ye),Re=!ze&&!Fe,Ve=B(ee,ee._fullLayout._axisMatchGroups,Te,le);var _r=(Oe=B(ee,ee._fullLayout._axisConstraintGroups,Te,le,Ve)).isSubplotConstrained||Ve.isSubplotConstrained;We=Se||_r,$e=ye||_r;var Ir=ee._fullLayout;at=Ir._has("scattergl"),gt=Ir._has("splom"),xt=Ir._has("svg")}$t();var Zt=function(tr,nr,Qt){return tr?tr==="nsew"?Qt?"":nr==="pan"?"move":"crosshair":tr.toLowerCase()+"-resize":"pointer"}(ze+Fe,ee._fullLayout.dragmode,jt),cr=D(ne,ye+Se+"drag",Zt,se,oe,me,ce);if(Re&&!jt)return cr.onmousedown=null,cr.style.pointerEvents="none",cr;var Dt,Ne,Ye,pe,_e,Be,He,Je,Ze,ct,lt={element:cr,gd:ee,plotinfo:ne};function At(){lt.plotinfo.selection=!1,k(ee)}function Ot(tr,nr){var Qt=lt.gd;if(Qt._fullLayout._activeShapeIndex>=0)Qt._fullLayout._deactivateShape(Qt);else{var dr=Qt._fullLayout.clickmode;if(N(Qt),tr!==2||Gt||Vt(),jt)dr.indexOf("select")>-1&&L(nr,Qt,ve,Me,ne.id,lt),dr.indexOf("event")>-1&&c.click(Qt,nr,ne.id);else if(tr===1&&Gt){var _r=ye?ge:fe,Ir=ye==="s"||Se==="w"?0:1,Rr=_r._name+".range["+Ir+"]",Vr=function(an,zn){var on,Tn=an.range[zn],Mn=Math.abs(Tn-an.range[1-zn]);return an.type==="date"?Tn:an.type==="log"?(on=Math.ceil(Math.max(0,-Math.log(Mn)/Math.LN10))+3,w("."+on+"g")(Math.pow(10,Tn))):(on=Math.floor(Math.log(Math.abs(Tn))/Math.LN10)-Math.floor(Math.log(Mn)/Math.LN10)+4,w("."+String(on)+"g")(Tn))}(_r,Ir),Xr="left",cn="middle";if(_r.fixedrange)return;ye?(cn=ye==="n"?"top":"bottom",_r.side==="right"&&(Xr="right")):Se==="e"&&(Xr="right"),Qt._context.showAxisRangeEntryBoxes&&d.select(cr).call(o.makeEditable,{gd:Qt,immediate:!0,background:Qt._fullLayout.paper_bgcolor,text:String(Vr),fill:_r.tickfont?_r.tickfont.color:"#444",horizontalAlign:Xr,verticalAlign:cn}).on("edit",function(an){var zn=_r.d2r(an);zn!==void 0&&t.call("_guiRelayout",Qt,Rr,zn)})}}}function it(tr,nr){if(ee._transitioningWithDuration)return!1;var Qt=Math.max(0,Math.min(Ie,nt*tr+Dt)),dr=Math.max(0,Math.min(De,Qe*nr+Ne)),_r=Math.abs(Qt-Dt),Ir=Math.abs(dr-Ne);function Rr(){He="",Ye.r=Ye.l,Ye.t=Ye.b,Ze.attr("d","M0,0Z")}if(Ye.l=Math.min(Dt,Qt),Ye.r=Math.max(Dt,Qt),Ye.t=Math.min(Ne,dr),Ye.b=Math.max(Ne,dr),Oe.isSubplotConstrained)_r>S||Ir>S?(He="xy",_r/Ie>Ir/De?(Ir=_r*De/Ie,Ne>dr?Ye.t=Ne-Ir:Ye.b=Ne+Ir):(_r=Ir*Ie/De,Dt>Qt?Ye.l=Dt-_r:Ye.r=Dt+_r),Ze.attr("d",te(Ye))):Rr();else if(Ve.isSubplotConstrained)if(_r>S||Ir>S){He="xy";var Vr=Math.min(Ye.l/Ie,(De-Ye.b)/De),Xr=Math.max(Ye.r/Ie,(De-Ye.t)/De);Ye.l=Vr*Ie,Ye.r=Xr*Ie,Ye.b=(1-Vr)*De,Ye.t=(1-Xr)*De,Ze.attr("d",te(Ye))}else Rr();else!ze||Ir<Math.min(Math.max(.6*_r,P),S)?_r<P||!Fe?Rr():(Ye.t=0,Ye.b=De,He="x",Ze.attr("d",function(cn,an){return"M"+(cn.l-.5)+","+(an-S-.5)+"h-3v"+(2*S+1)+"h3ZM"+(cn.r+.5)+","+(an-S-.5)+"h3v"+(2*S+1)+"h-3Z"}(Ye,Ne))):!Fe||_r<Math.min(.6*Ir,S)?(Ye.l=0,Ye.r=Ie,He="y",Ze.attr("d",function(cn,an){return"M"+(an-S-.5)+","+(cn.t-.5)+"v-3h"+(2*S+1)+"v3ZM"+(an-S-.5)+","+(cn.b+.5)+"v3h"+(2*S+1)+"v-3Z"}(Ye,Dt))):(He="xy",Ze.attr("d",te(Ye)));Ye.w=Ye.r-Ye.l,Ye.h=Ye.b-Ye.t,He&&(ct=!0),ee._dragged=ct,re(Je,Ze,Ye,_e,Be,pe),ht(),ee.emit("plotly_relayouting",mt),Be=!0}function ht(){mt={},He!=="xy"&&He!=="x"||(V(ve,Ye.l/Ie,Ye.r/Ie,mt,Oe.xaxes),pt("x",mt)),He!=="xy"&&He!=="y"||(V(Me,(De-Ye.b)/De,(De-Ye.t)/De,mt,Oe.yaxes),pt("y",mt))}function Ut(){ht(),N(ee),Jt(),U(ee)}lt.prepFn=function(tr,nr,Qt){var dr=lt.dragmode,_r=ee._fullLayout.dragmode;_r!==dr&&(lt.dragmode=_r),$t(),nt=ee._fullLayout._invScaleX,Qe=ee._fullLayout._invScaleY,Re||(jt?tr.shiftKey?_r==="pan"?_r="zoom":p(_r)||(_r="pan"):tr.ctrlKey&&(_r="pan"):_r="pan"),u(_r)?lt.minDrag=1:lt.minDrag=void 0,p(_r)?(lt.xaxes=ve,lt.yaxes=Me,T(tr,nr,Qt,lt,_r)):(lt.clickFn=Ot,p(dr)&&At(),Re||(_r==="zoom"?(lt.moveFn=it,lt.doneFn=Ut,lt.minDrag=1,function(Ir,Rr,Vr){var Xr=cr.getBoundingClientRect();Dt=Rr-Xr.left,Ne=Vr-Xr.top,ee._fullLayout._calcInverseTransform(ee);var cn=v.apply3DTransform(ee._fullLayout._invTransform)(Dt,Ne);Dt=cn[0],Ne=cn[1],Ye={l:Dt,r:Dt,w:0,t:Ne,b:Ne,h:0},pe=ee._hmpixcount?ee._hmlumcount/ee._hmpixcount:y(ee._fullLayout.plot_bgcolor).getLuminance(),Be=!1,He="xy",ct=!1,Je=X(vt,pe,we,de,_e="M0,0H"+Ie+"V"+De+"H0V0"),Ze=$(vt,we,de)}(0,nr,Qt)):_r==="pan"&&(lt.moveFn=ot,lt.doneFn=Jt))),ee._fullLayout._redrag=function(){var Ir=ee._dragdata;if(Ir&&Ir.element===cr){var Rr=ee._fullLayout.dragmode;p(Rr)||($t(),qt([0,0,Ie,De]),lt.moveFn(Ir.dx,Ir.dy))}}},l.init(lt);var Mt=[0,0,Ie,De],It=null,Le=I.REDRAWDELAY,Xe=ne.mainplot?ee._fullLayout._plots[ne.mainplot]:ne;function ot(tr,nr){if(tr*=nt,nr*=Qe,!ee._transitioningWithDuration){if(ee._fullLayout._replotting=!0,Fe==="ew"||ze==="ns"){var Qt=Fe?-tr:0,dr=ze?-nr:0;if(Ve.isSubplotConstrained){if(Fe&&ze){var _r=(tr/Ie-nr/De)/2;Qt=-(tr=_r*Ie),dr=-(nr=-_r*De)}ze?Qt=-dr*Ie/De:dr=-Qt*De/Ie}return Fe&&(Z(ve,tr),pt("x")),ze&&(Z(Me,nr),pt("y")),qt([Qt,dr,Ie,De]),St(),void ee.emit("plotly_relayouting",mt)}var Ir,Rr,Vr=Fe==="w"==(ze==="n")?1:-1;if(Fe&&ze&&(Oe.isSubplotConstrained||Ve.isSubplotConstrained)){var Xr=(tr/Ie+Vr*nr/De)/2;tr=Xr*Ie,nr=Vr*Xr*De}if(Fe==="w"?tr=on(ve,0,tr):Fe==="e"?tr=on(ve,1,-tr):Fe||(tr=0),ze==="n"?nr=on(Me,1,nr):ze==="s"?nr=on(Me,0,-nr):ze||(nr=0),Ir=Fe==="w"?tr:0,Rr=ze==="n"?nr:0,Oe.isSubplotConstrained&&!Ve.isSubplotConstrained||Ve.isSubplotConstrained&&Fe&&ze&&Vr>0){var cn;if(Ve.isSubplotConstrained||!Fe&&ze.length===1){for(cn=0;cn<ve.length;cn++)ve[cn].range=ve[cn]._r.slice(),A(ve[cn],1-nr/De);Ir=(tr=nr*Ie/De)/2}if(Ve.isSubplotConstrained||!ze&&Fe.length===1){for(cn=0;cn<Me.length;cn++)Me[cn].range=Me[cn]._r.slice(),A(Me[cn],1-tr/Ie);Rr=(nr=tr*De/Ie)/2}}Ve.isSubplotConstrained&&ze||pt("x"),Ve.isSubplotConstrained&&Fe||pt("y");var an=Ie-tr,zn=De-nr;!Ve.isSubplotConstrained||Fe&&ze||(Fe?(Rr=Ir?0:tr*De/Ie,zn=an*De/Ie):(Ir=Rr?0:nr*Ie/De,an=zn*Ie/De)),qt([Ir,Rr,an,zn]),St(),ee.emit("plotly_relayouting",mt)}function on(Tn,Mn,ei){for(var Hr,ln,bn=1-Mn,nn=0;nn<Tn.length;nn++){var pn=Tn[nn];if(!pn.fixedrange){Hr=pn,ln=pn._rl[bn]+(pn._rl[Mn]-pn._rl[bn])/Q(ei/pn._length);var qn=pn.l2r(ln);qn!==!1&&qn!==void 0&&(pn.range[Mn]=qn)}}return Hr._length*(Hr._rl[Mn]-ln)/(Hr._rl[Mn]-Hr._rl[bn])}}function pt(tr,nr){for(var Qt=Ve.isSubplotConstrained?{x:Me,y:ve}[tr]:Ve[tr+"axes"],dr=Ve.isSubplotConstrained?{x:ve,y:Me}[tr]:[],_r=0;_r<Qt.length;_r++){var Ir=Qt[_r],Rr=Ir._id,Vr=Ve.xLinks[Rr]||Ve.yLinks[Rr],Xr=dr[0]||Te[Vr]||le[Vr];Xr&&(nr?(nr[Ir._name+".range[0]"]=nr[Xr._name+".range[0]"],nr[Ir._name+".range[1]"]=nr[Xr._name+".range[1]"]):Ir.range=Xr.range.slice())}}function St(){var tr,nr=[];function Qt(Ir){for(tr=0;tr<Ir.length;tr++)Ir[tr].fixedrange||nr.push(Ir[tr]._id)}for(We&&(Qt(ve),Qt(Oe.xaxes),Qt(Ve.xaxes)),$e&&(Qt(Me),Qt(Oe.yaxes),Qt(Ve.yaxes)),mt={},tr=0;tr<nr.length;tr++){var dr=nr[tr],_r=b(ee,dr);a.drawOne(ee,_r,{skipTitle:!0}),mt[_r._name+".range[0]"]=_r.range[0],mt[_r._name+".range[1]"]=_r.range[1]}a.redrawComponents(ee,nr)}function Vt(){if(!ee._transitioningWithDuration){var tr=ee._context.doubleClick,nr=[];Fe&&(nr=nr.concat(ve)),ze&&(nr=nr.concat(Me)),Ve.xaxes&&(nr=nr.concat(Ve.xaxes)),Ve.yaxes&&(nr=nr.concat(Ve.yaxes));var Qt,dr,_r,Ir={};if(tr==="reset+autosize"){for(tr="autosize",dr=0;dr<nr.length;dr++)if((Qt=nr[dr])._rangeInitial&&(Qt.range[0]!==Qt._rangeInitial[0]||Qt.range[1]!==Qt._rangeInitial[1])||!Qt._rangeInitial&&!Qt.autorange){tr="reset";break}}if(tr==="autosize")for(dr=0;dr<nr.length;dr++)(Qt=nr[dr]).fixedrange||(Ir[Qt._name+".autorange"]=!0);else if(tr==="reset")for((Fe||Oe.isSubplotConstrained)&&(nr=nr.concat(Oe.xaxes)),ze&&!Oe.isSubplotConstrained&&(nr=nr.concat(Oe.yaxes)),Oe.isSubplotConstrained&&(Fe?ze||(nr=nr.concat(Me)):nr=nr.concat(ve)),dr=0;dr<nr.length;dr++)(Qt=nr[dr]).fixedrange||(Qt._rangeInitial?(_r=Qt._rangeInitial,Ir[Qt._name+".range[0]"]=_r[0],Ir[Qt._name+".range[1]"]=_r[1]):Ir[Qt._name+".autorange"]=!0);ee.emit("plotly_doubleclick",null),t.call("_guiRelayout",ee,Ir)}}function Jt(){qt([0,0,Ie,De]),v.syncOrAsync([_.previousPromises,function(){ee._fullLayout._replotting=!1,t.call("_guiRelayout",ee,mt)}],ee)}function qt(tr){var nr,Qt,dr,_r,Ir=ee._fullLayout,Rr=Ir._plots,Vr=Ir._subplots.cartesian;if(gt&&t.subplotsRegistry.splom.drag(ee),at){for(nr=0;nr<Vr.length;nr++)if(dr=(Qt=Rr[Vr[nr]]).xaxis,_r=Qt.yaxis,Qt._scene){var Xr=v.simpleMap(dr.range,dr.r2l),cn=v.simpleMap(_r.range,_r.r2l);Qt._scene.update({range:[Xr[0],cn[0],Xr[1],cn[1]]})}}if((gt||at)&&(x(ee),f(ee)),xt){var an=tr[2]/fe._length,zn=tr[3]/ge._length;for(nr=0;nr<Vr.length;nr++){dr=(Qt=Rr[Vr[nr]]).xaxis,_r=Qt.yaxis;var on,Tn,Mn,ei,Hr=(We||Ve.isSubplotConstrained)&&!dr.fixedrange&&Te[dr._id],ln=($e||Ve.isSubplotConstrained)&&!_r.fixedrange&&le[_r._id];if(Hr?(on=an,Mn=Se||Ve.isSubplotConstrained?tr[0]:mr(dr,on)):Ve.xaHash[dr._id]?(on=an,Mn=tr[0]*dr._length/fe._length):Ve.yaHash[dr._id]?(on=zn,Mn=ze==="ns"?-tr[1]*dr._length/ge._length:mr(dr,on,{n:"top",s:"bottom"}[ze])):Mn=Cr(dr,on=gr(dr,an,zn)),ln?(Tn=zn,ei=ye||Ve.isSubplotConstrained?tr[1]:mr(_r,Tn)):Ve.yaHash[_r._id]?(Tn=zn,ei=tr[1]*_r._length/ge._length):Ve.xaHash[_r._id]?(Tn=an,ei=Fe==="ew"?-tr[0]*_r._length/fe._length:mr(_r,Tn,{e:"right",w:"left"}[Fe])):ei=Cr(_r,Tn=gr(_r,an,zn)),on||Tn){on||(on=1),Tn||(Tn=1);var bn=dr._offset-Mn/on,nn=_r._offset-ei/Tn;Qt.clipRect.call(g.setTranslate,Mn,ei).call(g.setScale,on,Tn),Qt.plot.call(g.setTranslate,bn,nn).call(g.setScale,1/on,1/Tn),on===Qt.xScaleFactor&&Tn===Qt.yScaleFactor||(g.setPointGroupScale(Qt.zoomScalePts,on,Tn),g.setTextPointsScale(Qt.zoomScaleTxt,on,Tn)),g.hideOutsideRangePoints(Qt.clipOnAxisFalseTraces,Qt),Qt.xScaleFactor=on,Qt.yScaleFactor=Tn}}}}function gr(tr,nr,Qt){return tr.fixedrange?0:We&&Oe.xaHash[tr._id]?nr:$e&&(Oe.isSubplotConstrained?Oe.xaHash:Oe.yaHash)[tr._id]?Qt:0}function Cr(tr,nr){return nr?(tr.range=tr._r.slice(),A(tr,nr),mr(tr,nr)):0}function mr(tr,nr,Qt){return tr._length*(1-nr)*i[Qt||tr.constraintoward||"middle"]}return ye.length*Se.length!=1&&K(cr,function(tr){if(ee._context._scrollZoom.cartesian||ee._fullLayout._enablescrollzoom){if(At(),ee._transitioningWithDuration)return tr.preventDefault(),void tr.stopPropagation();$t(),clearTimeout(It);var nr=-tr.deltaY;if(isFinite(nr)||(nr=tr.wheelDelta/10),isFinite(nr)){var Qt,dr=Math.exp(-Math.min(Math.max(nr,-20),20)/200),_r=Xe.draglayer.select(".nsewdrag").node().getBoundingClientRect(),Ir=(tr.clientX-_r.left)/_r.width,Rr=(_r.bottom-tr.clientY)/_r.height;if(We){for(Se||(Ir=.5),Qt=0;Qt<ve.length;Qt++)Vr(ve[Qt],Ir,dr);pt("x"),Mt[2]*=dr,Mt[0]+=Mt[2]*Ir*(1/dr-1)}if($e){for(ye||(Rr=.5),Qt=0;Qt<Me.length;Qt++)Vr(Me[Qt],Rr,dr);pt("y"),Mt[3]*=dr,Mt[1]+=Mt[3]*(1-Rr)*(1/dr-1)}qt(Mt),St(),ee.emit("plotly_relayouting",mt),It=setTimeout(function(){ee._fullLayout&&(Mt=[0,0,Ie,De],Jt())},Le),tr.preventDefault()}else v.log("Did not find wheel motion attributes: ",tr)}function Vr(Xr,cn,an){if(!Xr.fixedrange){var zn=v.simpleMap(Xr.range,Xr.r2l),on=zn[0]+(zn[1]-zn[0])*cn;Xr.range=zn.map(function(Tn){return Xr.l2r(on+(Tn-on)*an)})}}}),cr},makeDragger:z,makeRectDragger:D,makeZoombox:X,makeCorners:$,updateZoombox:re,xyCorners:te,transitionZoombox:H,removeZoombox:N,showDoubleClickNotifier:U,attachWheelEventHandler:K}},{"../../components/color":367,"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../constants/alignment":483,"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/setcursor":536,"../../lib/svg_text_utils":541,"../../plot_api/subroutines":556,"../../registry":647,"../plots":628,"./axes":566,"./axis_ids":570,"./constants":573,"./scale_zoom":584,"@plotly/d3":58,"has-passive-events":229,tinycolor2:313}],576:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../components/fx"),w=m("../../components/dragelement"),y=m("../../lib/setcursor"),e=m("./dragbox").makeDragBox,t=m("./constants").DRAGGERSIZE;Y.initInteractions=function(n){var o=n._fullLayout;if(n._context.staticPlot)d.select(n).selectAll(".drag").remove();else if(o._has("cartesian")||o._has("splom")){Object.keys(o._plots||{}).sort(function(g,c){if((o._plots[g].mainplot&&!0)===(o._plots[c].mainplot&&!0)){var a=g.split("y"),h=c.split("y");return a[0]===h[0]?Number(a[1]||1)-Number(h[1]||1):Number(a[0]||1)-Number(h[0]||1)}return o._plots[g].mainplot?1:-1}).forEach(function(g){var c=o._plots[g],a=c.xaxis,h=c.yaxis;if(!c.mainplot){var l=e(n,c,a._offset,h._offset,a._length,h._length,"ns","ew");l.onmousemove=function(u){n._fullLayout._rehover=function(){n._fullLayout._hoversubplot===g&&n._fullLayout._plots[g]&&v.hover(n,u,g)},v.hover(n,u,g),n._fullLayout._lasthover=l,n._fullLayout._hoversubplot=g},l.onmouseout=function(u){n._dragging||(n._fullLayout._hoversubplot=null,w.unhover(n,u))},n._context.showAxisDragHandles&&(e(n,c,a._offset-t,h._offset-t,t,t,"n","w"),e(n,c,a._offset+a._length,h._offset-t,t,t,"n","e"),e(n,c,a._offset-t,h._offset+h._length,t,t,"s","w"),e(n,c,a._offset+a._length,h._offset+h._length,t,t,"s","e"))}if(n._context.showAxisDragHandles){if(g===a._mainSubplot){var s=a._mainLinePosition;a.side==="top"&&(s-=t),e(n,c,a._offset+.1*a._length,s,.8*a._length,t,"","ew"),e(n,c,a._offset,s,.1*a._length,t,"","w"),e(n,c,a._offset+.9*a._length,s,.1*a._length,t,"","e")}if(g===h._mainSubplot){var p=h._mainLinePosition;h.side!=="right"&&(p-=t),e(n,c,p,h._offset+.1*h._length,t,.8*h._length,"ns",""),e(n,c,p,h._offset+.9*h._length,t,.1*h._length,"s",""),e(n,c,p,h._offset,t,.1*h._length,"n","")}}});var r=o._hoverlayer.node();r.onmousemove=function(g){g.target=n._fullLayout._lasthover,v.hover(n,g,o._hoversubplot)},r.onclick=function(g){g.target=n._fullLayout._lasthover,v.click(n,g)},r.onmousedown=function(g){n._fullLayout._lasthover.onmousedown(g)},Y.updateFx(n)}},Y.updateFx=function(n){var o=n._fullLayout,r=o.dragmode==="pan"?"move":"crosshair";y(o._draggers,r)}},{"../../components/dragelement":386,"../../components/fx":407,"../../lib/setcursor":536,"./constants":573,"./dragbox":575,"@plotly/d3":58}],577:[function(m,G,Y){var d=m("../../registry"),v=m("../../lib"),w=m("./axis_ids");G.exports=function(y){return function(e,t){var n=e[y];if(Array.isArray(n))for(var o=d.subplotsRegistry.cartesian,r=o.idRegex,g=t._subplots,c=g.xaxis,a=g.yaxis,h=g.cartesian,l=t._has("cartesian")||t._has("gl2d"),s=0;s<n.length;s++){var p=n[s];if(v.isPlainObject(p)){var u=w.cleanId(p.xref,"x",!1),i=w.cleanId(p.yref,"y",!1),x=r.x.test(u),f=r.y.test(i);if(x||f){l||v.pushUnique(t._basePlotModules,o);var _=!1;x&&c.indexOf(u)===-1&&(c.push(u),_=!0),f&&a.indexOf(i)===-1&&(a.push(i),_=!0),_&&x&&f&&h.push(u+i)}}}}}},{"../../lib":515,"../../registry":647,"./axis_ids":570}],578:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../registry"),w=m("../../lib"),y=m("../plots"),e=m("../../components/drawing"),t=m("../get_data").getModuleCalcData,n=m("./axis_ids"),o=m("./constants"),r=m("../../constants/xmlns_namespaces"),g=w.ensureSingle;function c(p,u,i){return w.ensureSingle(p,u,i,function(x){x.datum(i)})}function a(p,u,i,x,f){for(var _,b,T,k=o.traceLayerClasses,L=p._fullLayout,A=L._modules,I=[],P=[],S=0;S<A.length;S++){var E=(_=A[S]).name,z=v.modules[E].categories;if(z.svg){var D=_.layerName||E+"layer",j=_.plot;T=(b=t(i,j))[0],i=b[1],T.length&&I.push({i:k.indexOf(D),className:D,plotMethod:j,cdModule:T}),z.zoomScale&&P.push("."+D)}}I.sort(function(Q,X){return Q.i-X.i});var V=u.plot.selectAll("g.mlayer").data(I,function(Q){return Q.className});if(V.enter().append("g").attr("class",function(Q){return Q.className}).classed("mlayer",!0).classed("rangeplot",u.isRangePlot),V.exit().remove(),V.order(),V.each(function(Q){var X=d.select(this),$=Q.className;Q.plotMethod(p,u,Q.cdModule,X,x,f),o.clipOnAxisFalseQuery.indexOf("."+$)===-1&&e.setClipUrl(X,u.layerClipId,p)}),L._has("scattergl")&&(_=v.getModule("scattergl"),T=t(i,_)[0],_.plot(p,u,T)),!p._context.staticPlot&&(u._hasClipOnAxisFalse&&(u.clipOnAxisFalseTraces=u.plot.selectAll(o.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),P.length)){var Z=u.plot.selectAll(P.join(",")).selectAll(".trace");u.zoomScalePts=Z.selectAll("path.point"),u.zoomScaleTxt=Z.selectAll(".textpoint")}}function h(p,u){var i=u.plotgroup,x=u.id,f=o.layerValue2layerClass[u.xaxis.layer],_=o.layerValue2layerClass[u.yaxis.layer],b=p._fullLayout._hasOnlyLargeSploms;if(u.mainplot){var T=u.mainplotinfo,k=T.plotgroup,L=x+"-x",A=x+"-y";u.minorGridlayer=T.minorGridlayer,u.gridlayer=T.gridlayer,u.zerolinelayer=T.zerolinelayer,g(T.overlinesBelow,"path",L),g(T.overlinesBelow,"path",A),g(T.overaxesBelow,"g",L),g(T.overaxesBelow,"g",A),u.plot=g(T.overplot,"g",x),g(T.overlinesAbove,"path",L),g(T.overlinesAbove,"path",A),g(T.overaxesAbove,"g",L),g(T.overaxesAbove,"g",A),u.xlines=k.select(".overlines-"+f).select("."+L),u.ylines=k.select(".overlines-"+_).select("."+A),u.xaxislayer=k.select(".overaxes-"+f).select("."+L),u.yaxislayer=k.select(".overaxes-"+_).select("."+A)}else if(b)u.xlines=g(i,"path","xlines-above"),u.ylines=g(i,"path","ylines-above"),u.xaxislayer=g(i,"g","xaxislayer-above"),u.yaxislayer=g(i,"g","yaxislayer-above");else{var I=g(i,"g","layer-subplot");u.shapelayer=g(I,"g","shapelayer"),u.imagelayer=g(I,"g","imagelayer"),u.minorGridlayer=g(i,"g","minor-gridlayer"),u.gridlayer=g(i,"g","gridlayer"),u.zerolinelayer=g(i,"g","zerolinelayer"),g(i,"path","xlines-below"),g(i,"path","ylines-below"),u.overlinesBelow=g(i,"g","overlines-below"),g(i,"g","xaxislayer-below"),g(i,"g","yaxislayer-below"),u.overaxesBelow=g(i,"g","overaxes-below"),u.plot=g(i,"g","plot"),u.overplot=g(i,"g","overplot"),u.xlines=g(i,"path","xlines-above"),u.ylines=g(i,"path","ylines-above"),u.overlinesAbove=g(i,"g","overlines-above"),g(i,"g","xaxislayer-above"),g(i,"g","yaxislayer-above"),u.overaxesAbove=g(i,"g","overaxes-above"),u.xlines=i.select(".xlines-"+f),u.ylines=i.select(".ylines-"+_),u.xaxislayer=i.select(".xaxislayer-"+f),u.yaxislayer=i.select(".yaxislayer-"+_)}b||(c(u.minorGridlayer,"g",u.xaxis._id),c(u.minorGridlayer,"g",u.yaxis._id),u.minorGridlayer.selectAll("g").map(function(P){return P[0]}).sort(n.idSort),c(u.gridlayer,"g",u.xaxis._id),c(u.gridlayer,"g",u.yaxis._id),u.gridlayer.selectAll("g").map(function(P){return P[0]}).sort(n.idSort)),u.xlines.style("fill","none").classed("crisp",!0),u.ylines.style("fill","none").classed("crisp",!0)}function l(p,u){if(p){var i={};for(var x in p.each(function(T){var k=T[0];d.select(this).remove(),s(k,u),i[k]=!0}),u._plots)for(var f=u._plots[x].overlays||[],_=0;_<f.length;_++){var b=f[_];i[b.id]&&b.plot.selectAll(".trace").remove()}}}function s(p,u){u._draggers.selectAll("g."+p).remove(),u._defs.select("#clip"+u._uid+p+"plot").remove()}Y.name="cartesian",Y.attr=["xaxis","yaxis"],Y.idRoot=["x","y"],Y.idRegex=o.idRegex,Y.attrRegex=o.attrRegex,Y.attributes=m("./attributes"),Y.layoutAttributes=m("./layout_attributes"),Y.supplyLayoutDefaults=m("./layout_defaults"),Y.transitionAxes=m("./transition_axes"),Y.finalizeSubplots=function(p,u){var i,x,f,_=u._subplots,b=_.xaxis,T=_.yaxis,k=_.cartesian,L=k.concat(_.gl2d||[]),A={},I={};for(i=0;i<L.length;i++){var P=L[i].split("y");A[P[0]]=1,I["y"+P[1]]=1}for(i=0;i<b.length;i++)A[x=b[i]]||(f=(p[n.id2name(x)]||{}).anchor,o.idRegex.y.test(f)||(f="y"),k.push(x+f),L.push(x+f),I[f]||(I[f]=1,w.pushUnique(T,f)));for(i=0;i<T.length;i++)I[f=T[i]]||(x=(p[n.id2name(f)]||{}).anchor,o.idRegex.x.test(x)||(x="x"),k.push(x+f),L.push(x+f),A[x]||(A[x]=1,w.pushUnique(b,x)));if(!L.length){for(var S in x="",f="",p)o.attrRegex.test(S)&&(S.charAt(0)==="x"?(!x||+S.substr(5)<+x.substr(5))&&(x=S):(!f||+S.substr(5)<+f.substr(5))&&(f=S));x=x?n.name2id(x):"x",f=f?n.name2id(f):"y",b.push(x),T.push(f),k.push(x+f)}},Y.plot=function(p,u,i,x){var f,_=p._fullLayout,b=_._subplots.cartesian,T=p.calcdata;if(!Array.isArray(u))for(u=[],f=0;f<T.length;f++)u.push(f);for(f=0;f<b.length;f++){for(var k,L=b[f],A=_._plots[L],I=[],P=0;P<T.length;P++){var S=T[P],E=S[0].trace;E.xaxis+E.yaxis===L&&((u.indexOf(E.index)!==-1||E.carpet)&&(k&&k[0].trace.xaxis+k[0].trace.yaxis===L&&["tonextx","tonexty","tonext"].indexOf(E.fill)!==-1&&I.indexOf(k)===-1&&I.push(k),I.push(S)),k=S)}a(p,A,I,i,x)}},Y.clean=function(p,u,i,x){var f,_,b,T=x._plots||{},k=u._plots||{},L=x._subplots||{};if(x._hasOnlyLargeSploms&&!u._hasOnlyLargeSploms)for(b in T)(f=T[b]).plotgroup&&f.plotgroup.remove();var A=x._has&&x._has("gl"),I=u._has&&u._has("gl");if(A&&!I)for(b in T)(f=T[b])._scene&&f._scene.destroy();if(L.xaxis&&L.yaxis){var P=n.listIds({_fullLayout:x});for(_=0;_<P.length;_++){var S=P[_];u[n.id2name(S)]||x._infolayer.selectAll(".g-"+S+"title").remove()}}var E=x._has&&x._has("cartesian"),z=u._has&&u._has("cartesian");if(E&&!z)l(x._cartesianlayer.selectAll(".subplot"),x),x._defs.selectAll(".axesclip").remove(),delete x._axisConstraintGroups,delete x._axisMatchGroups;else if(L.cartesian)for(_=0;_<L.cartesian.length;_++){var D=L.cartesian[_];if(!k[D]){var j="."+D+",."+D+"-x,."+D+"-y";x._cartesianlayer.selectAll(j).remove(),s(D,x)}}},Y.drawFramework=function(p){var u=p._fullLayout,i=function(f){var _,b,T,k,L,A,I=f._fullLayout,P=I._subplots.cartesian,S=P.length,E=[],z=[];for(_=0;_<S;_++){T=P[_],k=I._plots[T],L=k.xaxis,A=k.yaxis;var D=L._mainAxis,j=A._mainAxis,V=D._id+j._id,Z=I._plots[V];k.overlays=[],V!==T&&Z?(k.mainplot=V,k.mainplotinfo=Z,z.push(T)):(k.mainplot=void 0,k.mainplotinfo=void 0,E.push(T))}for(_=0;_<z.length;_++)T=z[_],(k=I._plots[T]).mainplotinfo.overlays.push(k);var Q=E.concat(z),X=new Array(S);for(_=0;_<S;_++){T=Q[_],k=I._plots[T],L=k.xaxis,A=k.yaxis;var $=[T,L.layer,A.layer,L.overlaying||"",A.overlaying||""];for(b=0;b<k.overlays.length;b++)$.push(k.overlays[b].id);X[_]=$}return X}(p),x=u._cartesianlayer.selectAll(".subplot").data(i,String);x.enter().append("g").attr("class",function(f){return"subplot "+f[0]}),x.order(),x.exit().call(l,u),x.each(function(f){var _=f[0],b=u._plots[_];b.plotgroup=d.select(this),h(p,b),b.draglayer=g(u._draggers,"g",_)})},Y.rangePlot=function(p,u,i){h(p,u),a(p,u,i),y.style(p)},Y.toSVG=function(p){var u=p._fullLayout._glimages,i=d.select(p).selectAll(".svg-container");i.filter(function(x,f){return f===i.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var x=this.toDataURL("image/png");u.append("svg:image").attr({xmlns:r.svg,"xlink:href":x,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})})},Y.updateFx=m("./graph_interact").updateFx},{"../../components/drawing":389,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../registry":647,"../get_data":602,"../plots":628,"./attributes":564,"./axis_ids":570,"./constants":573,"./graph_interact":576,"./layout_attributes":579,"./layout_defaults":580,"./transition_axes":590,"@plotly/d3":58}],579:[function(m,G,Y){var d=m("../font_attributes"),v=m("../../components/color/attributes"),w=m("../../components/drawing/attributes").dash,y=m("../../lib/extend").extendFlat,e=m("../../plot_api/plot_template").templatedArray,t=m("../../plots/cartesian/axis_format_attributes").descriptionWithDates,n=m("../../constants/numerical").ONEDAY,o=m("./constants"),r=o.HOUR_PATTERN,g=o.WEEKDAY_PATTERN,c={valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}};function a(k){return{valType:"integer",min:0,dflt:k?5:0,editType:"ticks"}}var h={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},l={valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},s={valType:"data_array",editType:"ticks"},p={valType:"enumerated",values:["outside","inside",""],editType:"ticks"};function u(k){var L={valType:"number",min:0,editType:"ticks"};return k||(L.dflt=5),L}function i(k){var L={valType:"number",min:0,editType:"ticks"};return k||(L.dflt=1),L}var x={valType:"color",dflt:v.defaultLine,editType:"ticks"},f={valType:"color",dflt:v.lightLine,editType:"ticks"};function _(k){var L={valType:"number",min:0,editType:"ticks"};return k||(L.dflt=1),L}var b=y({},w,{editType:"ticks"}),T={valType:"boolean",editType:"ticks"};G.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:v.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:d({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[o.idRegex.x.toString(),o.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[o.idRegex.x.toString(),o.idRegex.y.toString()],editType:"calc"},rangebreaks:e("rangebreak",{enabled:{valType:"boolean",dflt:!0,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[g,r,""],editType:"calc"},values:{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:n},editType:"calc"}),tickmode:c,nticks:a(),tick0:h,dtick:l,ticklabelstep:{valType:"integer",min:1,dflt:1,editType:"ticks"},tickvals:s,ticktext:{valType:"data_array",editType:"ticks"},ticks:p,tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},ticklabeloverflow:{valType:"enumerated",values:["allow","hide past div","hide past domain"],editType:"calc"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:u(),tickwidth:i(),tickcolor:x,showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"flaglist",flags:["height","width","left","right","top","bottom"],extras:[!0,!1],dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:y({},w,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"hovered data",editType:"none"},tickfont:d({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks",description:t("tick label")},tickformatstops:e("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none",description:t("hover text")},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:v.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:T,gridcolor:f,gridwidth:_(),griddash:b,zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:v.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:v.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",o.idRegex.x.toString(),o.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",o.idRegex.x.toString(),o.idRegex.y.toString()],editType:"plot"},minor:{tickmode:c,nticks:a("minor"),tick0:h,dtick:l,tickvals:s,ticks:p,ticklen:u("minor"),tickwidth:i("minor"),tickcolor:x,gridcolor:f,gridwidth:_("minor"),griddash:b,showgrid:T,editType:"ticks"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:d({editType:"ticks"})}}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../constants/numerical":491,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../font_attributes":594,"./constants":573}],580:[function(m,G,Y){var d=m("../../lib"),v=m("../../components/color"),w=m("../../components/fx/helpers").isUnifiedHover,y=m("../../components/fx/hovermode_defaults"),e=m("../../plot_api/plot_template"),t=m("../layout_attributes"),n=m("./layout_attributes"),o=m("./type_defaults"),r=m("./axis_defaults"),g=m("./constraints"),c=m("./position_defaults"),a=m("./axis_ids"),h=a.id2name,l=a.name2id,s=m("./constants").AX_ID_PATTERN,p=m("../../registry"),u=p.traceIs,i=p.getComponentMethod;function x(f,_,b){Array.isArray(f[_])?f[_].push(b):f[_]=[b]}G.exports=function(f,_,b){var T,k,L=_.autotypenumbers,A={},I={},P={},S={},E={},z={},D={},j={},V={},Z={};for(T=0;T<b.length;T++){var Q=b[T];if(u(Q,"cartesian")||u(Q,"gl2d")){var X,$;if(Q.xaxis)X=h(Q.xaxis),x(A,X,Q);else if(Q.xaxes)for(k=0;k<Q.xaxes.length;k++)x(A,h(Q.xaxes[k]),Q);if(Q.yaxis)$=h(Q.yaxis),x(A,$,Q);else if(Q.yaxes)for(k=0;k<Q.yaxes.length;k++)x(A,h(Q.yaxes[k]),Q);Q.type==="funnel"?Q.orientation==="h"?(X&&(I[X]=!0),$&&(D[$]=!0)):$&&(P[$]=!0):Q.type==="image"?($&&(j[$]=!0),X&&(j[X]=!0)):($&&(E[$]=!0,z[$]=!0),u(Q,"carpet")&&(Q.type!=="carpet"||Q._cheater)||X&&(S[X]=!0)),Q.type==="carpet"&&Q._cheater&&X&&(I[X]=!0),u(Q,"2dMap")&&(V[X]=!0,V[$]=!0),u(Q,"oriented")&&(Z[Q.orientation==="h"?$:X]=!0)}}var re=_._subplots,H=re.xaxis,N=re.yaxis,U=d.simpleMap(H,h),te=d.simpleMap(N,h),B=U.concat(te),K=v.background;H.length&&N.length&&(K=d.coerce(f,_,t,"plot_bgcolor"));var J,ee,ne,se,oe,me=v.combine(K,_.paper_bgcolor);function ce(){var Qe=A[J]||[];oe._traceIndices=Qe.map(function(vt){return vt._expandedIndex}),oe._annIndices=[],oe._shapeIndices=[],oe._selectionIndices=[],oe._imgIndices=[],oe._subplotsWith=[],oe._counterAxes=[],oe._name=oe._attr=J,oe._id=ee}function ye(Qe,vt){return d.coerce(se,oe,n,Qe,vt)}function Se(Qe,vt){return d.coerce2(se,oe,n,Qe,vt)}function fe(Qe){return Qe==="x"?N:H}function ge(Qe,vt){for(var jt=Qe==="x"?U:te,Gt=[],$t=0;$t<jt.length;$t++){var Zt=jt[$t];Zt===vt||(f[Zt]||{}).overlaying||Gt.push(l(Zt))}return Gt}var Te={x:fe("x"),y:fe("y")},le=Te.x.concat(Te.y),ve={},Me=[];function we(){var Qe=se.matches;s.test(Qe)&&le.indexOf(Qe)===-1&&(ve[Qe]=se.type,Me=Object.keys(ve))}var de=y(f,_),Ie=w(de);for(T=0;T<B.length;T++){J=B[T],ee=l(J),ne=J.charAt(0),d.isPlainObject(f[J])||(f[J]={}),se=f[J],oe=e.newContainer(_,J,ne+"axis"),ce();var De=ne==="x"&&!S[J]&&I[J]||ne==="y"&&!E[J]&&P[J],Oe=ne==="y"&&(!z[J]&&D[J]||j[J]),Ve={hasMinor:!0,letter:ne,font:_.font,outerTicks:V[J],showGrid:!Z[J],data:A[J]||[],bgColor:me,calendar:_.calendar,automargin:!0,visibleDflt:De,reverseDflt:Oe,autotypenumbersDflt:L,splomStash:((_._splomAxes||{})[ne]||{})[ee]};ye("uirevision",_.uirevision),o(se,oe,ye,Ve),r(se,oe,ye,Ve,_);var Fe=Ie&&ne===de.charAt(0),ze=Se("spikecolor",Ie?oe.color:void 0),Re=Se("spikethickness",Ie?1.5:void 0),We=Se("spikedash",Ie?"dot":void 0),$e=Se("spikemode",Ie?"across":void 0),at=Se("spikesnap");ye("showspikes",!!(Fe||ze||Re||We||$e||at))||(delete oe.spikecolor,delete oe.spikethickness,delete oe.spikedash,delete oe.spikemode,delete oe.spikesnap),c(se,oe,ye,{letter:ne,counterAxes:Te[ne],overlayableAxes:ge(ne,J),grid:_.grid}),ye("title.standoff"),we(),oe._input=se}for(T=0;T<Me.length;){ee=Me[T++],ne=(J=h(ee)).charAt(0),d.isPlainObject(f[J])||(f[J]={}),se=f[J],oe=e.newContainer(_,J,ne+"axis"),ce();var gt={letter:ne,font:_.font,outerTicks:V[J],showGrid:!Z[J],data:[],bgColor:me,calendar:_.calendar,automargin:!0,visibleDflt:!1,reverseDflt:!1,autotypenumbersDflt:L,splomStash:((_._splomAxes||{})[ne]||{})[ee]};ye("uirevision",_.uirevision),oe.type=ve[ee]||"linear",r(se,oe,ye,gt,_),c(se,oe,ye,{letter:ne,counterAxes:Te[ne],overlayableAxes:ge(ne,J),grid:_.grid}),ye("fixedrange"),we(),oe._input=se}var xt=i("rangeslider","handleDefaults"),mt=i("rangeselector","handleDefaults");for(T=0;T<U.length;T++)J=U[T],se=f[J],oe=_[J],xt(f,_,J),oe.type==="date"&&mt(se,oe,_,te,oe.calendar),ye("fixedrange");for(T=0;T<te.length;T++){J=te[T],se=f[J],oe=_[J];var nt=_[h(oe.anchor)];ye("fixedrange",i("rangeslider","isVisible")(nt))}g.handleDefaults(f,_,{axIds:le.concat(Me).sort(a.idSort),axHasImage:j})}},{"../../components/color":367,"../../components/fx/helpers":403,"../../components/fx/hovermode_defaults":406,"../../lib":515,"../../plot_api/plot_template":555,"../../registry":647,"../layout_attributes":619,"./axis_defaults":568,"./axis_ids":570,"./constants":573,"./constraints":574,"./layout_attributes":579,"./position_defaults":582,"./type_defaults":591}],581:[function(m,G,Y){var d=m("tinycolor2").mix,v=m("../../components/color/attributes"),w=m("../../lib");G.exports=function(y,e,t,n){var o=(n=n||{}).dfltColor;function r(f,_){return w.coerce2(y,e,n.attributes,f,_)}var g=r("linecolor",o),c=r("linewidth");t("showline",n.showLine||!!g||!!c)||(delete e.linecolor,delete e.linewidth);var a=r("gridcolor",d(o,n.bgColor,n.blend||v.lightFraction).toRgbString()),h=r("gridwidth"),l=r("griddash");if(t("showgrid",n.showGrid||!!a||!!h||!!l)||(delete e.gridcolor,delete e.gridwidth,delete e.griddash),n.hasMinor){var s=r("minor.gridcolor",d(e.gridcolor,n.bgColor,67).toRgbString()),p=r("minor.gridwidth",e.gridwidth||1),u=r("minor.griddash",e.griddash||"solid");t("minor.showgrid",!!s||!!p||!!u)||(delete e.minor.gridcolor,delete e.minor.gridwidth,delete e.minor.griddash)}if(!n.noZeroLine){var i=r("zerolinecolor",o),x=r("zerolinewidth");t("zeroline",n.showGrid||!!i||!!x)||(delete e.zerolinecolor,delete e.zerolinewidth)}}},{"../../components/color/attributes":366,"../../lib":515,tinycolor2:313}],582:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../lib");G.exports=function(w,y,e,t){var n,o,r,g,c=t.counterAxes||[],a=t.overlayableAxes||[],h=t.letter,l=t.grid;l&&(o=l._domains[h][l._axisMap[y._id]],n=l._anchors[y._id],o&&(r=l[h+"side"].split(" ")[0],g=l.domain[h][r==="right"||r==="top"?1:0])),o=o||[0,1],n=n||(d(w.position)?"free":c[0]||"free"),r=r||(h==="x"?"bottom":"left"),g=g||0,v.coerce(w,y,{anchor:{valType:"enumerated",values:["free"].concat(c),dflt:n}},"anchor")==="free"&&e("position",g),v.coerce(w,y,{side:{valType:"enumerated",values:h==="x"?["bottom","top"]:["left","right"],dflt:r}},"side");var s=!1;if(a.length&&(s=v.coerce(w,y,{overlaying:{valType:"enumerated",values:[!1].concat(a),dflt:!1}},"overlaying")),!s){var p=e("domain",o);p[0]>p[1]-1/4096&&(y.domain=o),v.noneOrAll(w.domain,y.domain,o)}return e("layer"),y}},{"../../lib":515,"fast-isnumeric":190}],583:[function(m,G,Y){var d=m("./show_dflt");G.exports=function(v,w,y,e,t){t||(t={});var n=t.tickSuffixDflt,o=d(v);y("tickprefix")&&y("showtickprefix",o),y("ticksuffix",n)&&y("showticksuffix",o)}},{"./show_dflt":586}],584:[function(m,G,Y){var d=m("../../constants/alignment").FROM_BL;G.exports=function(v,w,y){y===void 0&&(y=d[v.constraintoward||"center"]);var e=[v.r2l(v.range[0]),v.r2l(v.range[1])],t=e[0]+(e[1]-e[0])*y;v.range=v._input.range=[v.l2r(t+(e[0]-t)*w),v.l2r(t+(e[1]-t)*w)],v.setScale()}},{"../../constants/alignment":483}],585:[function(m,G,Y){var d=m("@plotly/d3"),v=m("d3-time-format").utcFormat,w=m("../../lib"),y=w.numberFormat,e=m("fast-isnumeric"),t=w.cleanNumber,n=w.ms2DateTime,o=w.dateTime2ms,r=w.ensureNumber,g=w.isArrayOrTypedArray,c=m("../../constants/numerical"),a=c.FP_SAFE,h=c.BADNUM,l=c.LOG_CLIP,s=c.ONEWEEK,p=c.ONEDAY,u=c.ONEHOUR,i=c.ONEMIN,x=c.ONESEC,f=m("./axis_ids"),_=m("./constants"),b=_.HOUR_PATTERN,T=_.WEEKDAY_PATTERN;function k(A){return Math.pow(10,A)}function L(A){return A!=null}G.exports=function(A,I){I=I||{};var P=A._id||"x",S=P.charAt(0);function E(B,K){if(B>0)return Math.log(B)/Math.LN10;if(B<=0&&K&&A.range&&A.range.length===2){var J=A.range[0],ee=A.range[1];return .5*(J+ee-2*l*Math.abs(J-ee))}return h}function z(B,K,J,ee){if((ee||{}).msUTC&&e(B))return+B;var ne=o(B,J||A.calendar);if(ne===h){if(!e(B))return h;B=+B;var se=Math.floor(10*w.mod(B+.05,1)),oe=Math.round(B-se/10);ne=o(new Date(oe))+se/10}return ne}function D(B,K,J){return n(B,K,J||A.calendar)}function j(B){return A._categories[Math.round(B)]}function V(B){if(L(B)){if(A._categoriesMap===void 0&&(A._categoriesMap={}),A._categoriesMap[B]!==void 0)return A._categoriesMap[B];A._categories.push(typeof B=="number"?String(B):B);var K=A._categories.length-1;return A._categoriesMap[B]=K,K}return h}function Z(B){if(A._categoriesMap)return A._categoriesMap[B]}function Q(B){var K=Z(B);return K!==void 0?K:e(B)?+B:void 0}function X(B){return e(B)?+B:Z(B)}function $(B,K,J){return d.round(J+K*B,2)}function re(B,K,J){return(B-J)/K}var H=function(B){return e(B)?$(B,A._m,A._b):h},N=function(B){return re(B,A._m,A._b)};if(A.rangebreaks){var U=S==="y";H=function(B){if(!e(B))return h;var K=A._rangebreaks.length;if(!K)return $(B,A._m,A._b);var J=U;A.range[0]>A.range[1]&&(J=!J);for(var ee=J?-1:1,ne=ee*B,se=0,oe=0;oe<K;oe++){var me=ee*A._rangebreaks[oe].min,ce=ee*A._rangebreaks[oe].max;if(ne<me)break;if(!(ne>ce)){se=ne<(me+ce)/2?oe:oe+1;break}se=oe+1}var ye=A._B[se]||0;return isFinite(ye)?$(B,A._m2,ye):0},N=function(B){var K=A._rangebreaks.length;if(!K)return re(B,A._m,A._b);for(var J=0,ee=0;ee<K&&!(B<A._rangebreaks[ee].pmin);ee++)B>A._rangebreaks[ee].pmax&&(J=ee+1);return re(B,A._m2,A._B[J])}}A.c2l=A.type==="log"?E:r,A.l2c=A.type==="log"?k:r,A.l2p=H,A.p2l=N,A.c2p=A.type==="log"?function(B,K){return H(E(B,K))}:H,A.p2c=A.type==="log"?function(B){return k(N(B))}:N,["linear","-"].indexOf(A.type)!==-1?(A.d2r=A.r2d=A.d2c=A.r2c=A.d2l=A.r2l=t,A.c2d=A.c2r=A.l2d=A.l2r=r,A.d2p=A.r2p=function(B){return A.l2p(t(B))},A.p2d=A.p2r=N,A.cleanPos=r):A.type==="log"?(A.d2r=A.d2l=function(B,K){return E(t(B),K)},A.r2d=A.r2c=function(B){return k(t(B))},A.d2c=A.r2l=t,A.c2d=A.l2r=r,A.c2r=E,A.l2d=k,A.d2p=function(B,K){return A.l2p(A.d2r(B,K))},A.p2d=function(B){return k(N(B))},A.r2p=function(B){return A.l2p(t(B))},A.p2r=N,A.cleanPos=r):A.type==="date"?(A.d2r=A.r2d=w.identity,A.d2c=A.r2c=A.d2l=A.r2l=z,A.c2d=A.c2r=A.l2d=A.l2r=D,A.d2p=A.r2p=function(B,K,J){return A.l2p(z(B,0,J))},A.p2d=A.p2r=function(B,K,J){return D(N(B),K,J)},A.cleanPos=function(B){return w.cleanDate(B,h,A.calendar)}):A.type==="category"?(A.d2c=A.d2l=V,A.r2d=A.c2d=A.l2d=j,A.d2r=A.d2l_noadd=Q,A.r2c=function(B){var K=X(B);return K!==void 0?K:A.fraction2r(.5)},A.l2r=A.c2r=r,A.r2l=X,A.d2p=function(B){return A.l2p(A.r2c(B))},A.p2d=function(B){return j(N(B))},A.r2p=A.d2p,A.p2r=N,A.cleanPos=function(B){return typeof B=="string"&&B!==""?B:r(B)}):A.type==="multicategory"&&(A.r2d=A.c2d=A.l2d=j,A.d2r=A.d2l_noadd=Q,A.r2c=function(B){var K=Q(B);return K!==void 0?K:A.fraction2r(.5)},A.r2c_just_indices=Z,A.l2r=A.c2r=r,A.r2l=Q,A.d2p=function(B){return A.l2p(A.r2c(B))},A.p2d=function(B){return j(N(B))},A.r2p=A.d2p,A.p2r=N,A.cleanPos=function(B){return Array.isArray(B)||typeof B=="string"&&B!==""?B:r(B)},A.setupMultiCategory=function(B){var K,J,ee=A._traceIndices,ne=A._matchGroup;if(ne&&A._categories.length===0){for(var se in ne)if(se!==P){var oe=I[f.id2name(se)];ee=ee.concat(oe._traceIndices)}}var me=[[0,{}],[0,{}]],ce=[];for(K=0;K<ee.length;K++){var ye=B[ee[K]];if(S in ye){var Se=ye[S],fe=ye._length||w.minRowLength(Se);if(g(Se[0])&&g(Se[1]))for(J=0;J<fe;J++){var ge=Se[0][J],Te=Se[1][J];L(ge)&&L(Te)&&(ce.push([ge,Te]),ge in me[0][1]||(me[0][1][ge]=me[0][0]++),Te in me[1][1]||(me[1][1][Te]=me[1][0]++))}}}for(ce.sort(function(le,ve){var Me=me[0][1],we=Me[le[0]]-Me[ve[0]];if(we)return we;var de=me[1][1];return de[le[1]]-de[ve[1]]}),K=0;K<ce.length;K++)V(ce[K])}),A.fraction2r=function(B){var K=A.r2l(A.range[0]),J=A.r2l(A.range[1]);return A.l2r(K+B*(J-K))},A.r2fraction=function(B){var K=A.r2l(A.range[0]),J=A.r2l(A.range[1]);return(A.r2l(B)-K)/(J-K)},A.cleanRange=function(B,K){K||(K={}),B||(B="range");var J,ee,ne=w.nestedProperty(A,B).get();if(ee=(ee=A.type==="date"?w.dfltRange(A.calendar):S==="y"?_.DFLTRANGEY:A._name==="realaxis"?[0,1]:K.dfltRange||_.DFLTRANGEX).slice(),A.rangemode!=="tozero"&&A.rangemode!=="nonnegative"||(ee[0]=0),ne&&ne.length===2)for(A.type!=="date"||A.autorange||(ne[0]=w.cleanDate(ne[0],h,A.calendar),ne[1]=w.cleanDate(ne[1],h,A.calendar)),J=0;J<2;J++)if(A.type==="date"){if(!w.isDateTime(ne[J],A.calendar)){A[B]=ee;break}if(A.r2l(ne[0])===A.r2l(ne[1])){var se=w.constrain(A.r2l(ne[0]),w.MIN_MS+1e3,w.MAX_MS-1e3);ne[0]=A.l2r(se-1e3),ne[1]=A.l2r(se+1e3);break}}else{if(!e(ne[J])){if(!e(ne[1-J])){A[B]=ee;break}ne[J]=ne[1-J]*(J?10:.1)}if(ne[J]<-a?ne[J]=-a:ne[J]>a&&(ne[J]=a),ne[0]===ne[1]){var oe=Math.max(1,Math.abs(1e-6*ne[0]));ne[0]-=oe,ne[1]+=oe}}else w.nestedProperty(A,B).set(ee)},A.setScale=function(B){var K=I._size;if(A.overlaying){var J=f.getFromId({_fullLayout:I},A.overlaying);A.domain=J.domain}var ee=B&&A._r?"_r":"range",ne=A.calendar;A.cleanRange(ee);var se,oe,me=A.r2l(A[ee][0],ne),ce=A.r2l(A[ee][1],ne),ye=S==="y";if(ye?(A._offset=K.t+(1-A.domain[1])*K.h,A._length=K.h*(A.domain[1]-A.domain[0]),A._m=A._length/(me-ce),A._b=-A._m*ce):(A._offset=K.l+A.domain[0]*K.w,A._length=K.w*(A.domain[1]-A.domain[0]),A._m=A._length/(ce-me),A._b=-A._m*me),A._rangebreaks=[],A._lBreaks=0,A._m2=0,A._B=[],A.rangebreaks&&(A._rangebreaks=A.locateBreaks(Math.min(me,ce),Math.max(me,ce)),A._rangebreaks.length)){for(se=0;se<A._rangebreaks.length;se++)oe=A._rangebreaks[se],A._lBreaks+=Math.abs(oe.max-oe.min);var Se=ye;me>ce&&(Se=!Se),Se&&A._rangebreaks.reverse();var fe=Se?-1:1;for(A._m2=fe*A._length/(Math.abs(ce-me)-A._lBreaks),A._B.push(-A._m2*(ye?ce:me)),se=0;se<A._rangebreaks.length;se++)oe=A._rangebreaks[se],A._B.push(A._B[A._B.length-1]-fe*A._m2*(oe.max-oe.min));for(se=0;se<A._rangebreaks.length;se++)(oe=A._rangebreaks[se]).pmin=H(oe.min),oe.pmax=H(oe.max)}if(!isFinite(A._m)||!isFinite(A._b)||A._length<0)throw I._replotting=!1,new Error("Something went wrong with axis scaling")},A.maskBreaks=function(B){var K,J,ee,ne,se,oe=A.rangebreaks||[];oe._cachedPatterns||(oe._cachedPatterns=oe.map(function(ge){return ge.enabled&&ge.bounds?w.simpleMap(ge.bounds,ge.pattern?t:A.d2c):null})),oe._cachedValues||(oe._cachedValues=oe.map(function(ge){return ge.enabled&&ge.values?w.simpleMap(ge.values,A.d2c).sort(w.sorterAsc):null}));for(var me=0;me<oe.length;me++){var ce=oe[me];if(ce.enabled){if(ce.bounds){var ye=ce.pattern;switch(J=(K=oe._cachedPatterns[me])[0],ee=K[1],ye){case T:ne=(se=new Date(B)).getUTCDay(),J>ee&&(ee+=7,ne<J&&(ne+=7));break;case b:ne=(se=new Date(B)).getUTCHours()+(se.getUTCMinutes()/60+se.getUTCSeconds()/3600+se.getUTCMilliseconds()/36e5),J>ee&&(ee+=24,ne<J&&(ne+=24));break;case"":ne=B}if(ne>=J&&ne<ee)return h}else for(var Se=oe._cachedValues[me],fe=0;fe<Se.length;fe++)if(ee=(J=Se[fe])+ce.dvalue,B>=J&&B<ee)return h}}return B},A.locateBreaks=function(B,K){var J,ee,ne,se,oe=[];if(!A.rangebreaks)return oe;var me=A.rangebreaks.slice().sort(function(de,Ie){return de.pattern===T&&Ie.pattern===b?-1:Ie.pattern===T&&de.pattern===b?1:0}),ce=function(de,Ie){if((de=w.constrain(de,B,K))!==(Ie=w.constrain(Ie,B,K))){for(var De=!0,Oe=0;Oe<oe.length;Oe++){var Ve=oe[Oe];de<Ve.max&&Ie>=Ve.min&&(de<Ve.min&&(Ve.min=de),Ie>Ve.max&&(Ve.max=Ie),De=!1)}De&&oe.push({min:de,max:Ie})}};for(J=0;J<me.length;J++){var ye=me[J];if(ye.enabled)if(ye.bounds){var Se=B,fe=K;ye.pattern&&(Se=Math.floor(Se)),ne=(ee=w.simpleMap(ye.bounds,ye.pattern?t:A.r2l))[0],se=ee[1];var ge,Te,le=new Date(Se);switch(ye.pattern){case T:Te=s,ge=(se-ne+(se<ne?7:0))*p,Se+=ne*p-(le.getUTCDay()*p+le.getUTCHours()*u+le.getUTCMinutes()*i+le.getUTCSeconds()*x+le.getUTCMilliseconds());break;case b:Te=p,ge=(se-ne+(se<ne?24:0))*u,Se+=ne*u-(le.getUTCHours()*u+le.getUTCMinutes()*i+le.getUTCSeconds()*x+le.getUTCMilliseconds());break;default:Se=Math.min(ee[0],ee[1]),ge=Te=(fe=Math.max(ee[0],ee[1]))-Se}for(var ve=Se;ve<fe;ve+=Te)ce(ve,ve+ge)}else for(var Me=w.simpleMap(ye.values,A.d2c),we=0;we<Me.length;we++)ce(ne=Me[we],se=ne+ye.dvalue)}return oe.sort(function(de,Ie){return de.min-Ie.min}),oe},A.makeCalcdata=function(B,K,J){var ee,ne,se,oe,me=A.type,ce=me==="date"&&B[K+"calendar"];if(K in B){if(ee=B[K],oe=B._length||w.minRowLength(ee),w.isTypedArray(ee)&&(me==="linear"||me==="log")){if(oe===ee.length)return ee;if(ee.subarray)return ee.subarray(0,oe)}if(me==="multicategory")return function(fe,ge){for(var Te=new Array(ge),le=0;le<ge;le++){var ve=(fe[0]||[])[le],Me=(fe[1]||[])[le];Te[le]=Z([ve,Me])}return Te}(ee,oe);for(ne=new Array(oe),se=0;se<oe;se++)ne[se]=A.d2c(ee[se],0,ce,J)}else{var ye=K+"0"in B?A.d2c(B[K+"0"],0,ce):0,Se=B["d"+K]?Number(B["d"+K]):1;for(ee=B[{x:"y",y:"x"}[K]],oe=B._length||ee.length,ne=new Array(oe),se=0;se<oe;se++)ne[se]=ye+se*Se}if(A.rangebreaks)for(se=0;se<oe;se++)ne[se]=A.maskBreaks(ne[se]);return ne},A.isValidRange=function(B){return Array.isArray(B)&&B.length===2&&e(A.r2l(B[0]))&&e(A.r2l(B[1]))},A.isPtWithinRange=function(B,K){var J=A.c2l(B[S],null,K),ee=A.r2l(A.range[0]),ne=A.r2l(A.range[1]);return ee<ne?ee<=J&&J<=ne:ne<=J&&J<=ee},A._emptyCategories=function(){A._categories=[],A._categoriesMap={}},A.clearCalc=function(){var B=A._matchGroup;if(B){var K=null,J=null;for(var ee in B){var ne=I[f.id2name(ee)];if(ne._categories){K=ne._categories,J=ne._categoriesMap;break}}K&&J?(A._categories=K,A._categoriesMap=J):A._emptyCategories()}else A._emptyCategories();if(A._initialCategories)for(var se=0;se<A._initialCategories.length;se++)V(A._initialCategories[se])},A.sortByInitialCategories=function(){var B=[];if(A._emptyCategories(),A._initialCategories)for(var K=0;K<A._initialCategories.length;K++)V(A._initialCategories[K]);B=B.concat(A._traceIndices);var J=A._matchGroup;for(var ee in J)if(P!==ee){var ne=I[f.id2name(ee)];ne._categories=A._categories,ne._categoriesMap=A._categoriesMap,B=B.concat(ne._traceIndices)}return B};var te=I._d3locale;A.type==="date"&&(A._dateFormat=te?te.timeFormat:v,A._extraFormat=I._extraFormat),A._separators=I.separators,A._numFormat=te?te.numberFormat:y,delete A._minDtick,delete A._forceTick0}},{"../../constants/numerical":491,"../../lib":515,"./axis_ids":570,"./constants":573,"@plotly/d3":58,"d3-time-format":120,"fast-isnumeric":190}],586:[function(m,G,Y){G.exports=function(d){var v=["showexponent","showtickprefix","showticksuffix"].filter(function(w){return d[w]!==void 0});if(v.every(function(w){return d[w]===d[v[0]]})||v.length===1)return d[v[0]]}},{}],587:[function(m,G,Y){var d=m("../../lib"),v=m("../../components/color").contrast,w=m("./layout_attributes"),y=m("./show_dflt"),e=m("../array_container_defaults");function t(n,o){function r(g,c){return d.coerce(n,o,w.tickformatstops,g,c)}r("enabled")&&(r("dtickrange"),r("value"))}G.exports=function(n,o,r,g,c){c||(c={});var a=y(n);if(r("showticklabels")){var h=c.font||{},l=o.color,s=(o.ticklabelposition||"").indexOf("inside")!==-1?v(c.bgColor):l&&l!==w.color.dflt?l:h.color;if(d.coerceFont(r,"tickfont",{family:h.family,size:h.size,color:s}),c.noTicklabelstep||g==="multicategory"||g==="log"||r("ticklabelstep"),c.noAng||r("tickangle"),g!=="category"){var p=r("tickformat");e(n,o,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:t}),o.tickformatstops.length||delete o.tickformatstops,c.noExp||p||g==="date"||(r("showexponent",a),r("exponentformat"),r("minexponent"),r("separatethousands"))}}}},{"../../components/color":367,"../../lib":515,"../array_container_defaults":561,"./layout_attributes":579,"./show_dflt":586}],588:[function(m,G,Y){var d=m("../../lib"),v=m("./layout_attributes");G.exports=function(w,y,e,t){var n=t.isMinor,o=n?w.minor||{}:w,r=n?y.minor:y,g=n?v.minor:v,c=n?"minor.":"",a=d.coerce2(o,r,g,"ticklen",n?.6*(y.ticklen||5):void 0),h=d.coerce2(o,r,g,"tickwidth",n?y.tickwidth||1:void 0),l=d.coerce2(o,r,g,"tickcolor",(n?y.tickcolor:void 0)||r.color);e(c+"ticks",!n&&t.outerTicks||a||h||l?"outside":"")||(delete r.ticklen,delete r.tickwidth,delete r.tickcolor)}},{"../../lib":515,"./layout_attributes":579}],589:[function(m,G,Y){var d=m("./clean_ticks"),v=m("../../lib").isArrayOrTypedArray;G.exports=function(w,y,e,t,n){n||(n={});var o=n.isMinor,r=o?w.minor||{}:w,g=o?y.minor:y,c=o?"minor.":"";function a(i){var x=r[i];return x!==void 0?x:(g._template||{})[i]}var h=a("tick0"),l=a("dtick"),s=a("tickvals"),p=e(c+"tickmode",v(s)?"array":l?"linear":"auto");if(p==="auto")e(c+"nticks");else if(p==="linear"){var u=g.dtick=d.dtick(l,t);g.tick0=d.tick0(h,t,y.calendar,u)}else t!=="multicategory"&&(e(c+"tickvals")===void 0?g.tickmode="auto":o||e("ticktext"))}},{"../../lib":515,"./clean_ticks":572}],590:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../registry"),w=m("../../lib"),y=m("../../components/drawing"),e=m("./axes");G.exports=function(t,n,o,r){var g=t._fullLayout;if(n.length!==0){var c,a,h,l;r&&(c=r());var s=d.ease(o.easing);return t._transitionData._interruptCallbacks.push(function(){return window.cancelAnimationFrame(l),l=null,function(){for(var i={},x=0;x<n.length;x++){var f=n[x],_=f.plotinfo.xaxis,b=f.plotinfo.yaxis;f.xr0&&(i[_._name+".range"]=f.xr0.slice()),f.yr0&&(i[b._name+".range"]=f.yr0.slice())}return v.call("relayout",t,i).then(function(){for(var T=0;T<n.length;T++)p(n[T].plotinfo)})}()}),a=Date.now(),l=window.requestAnimationFrame(function i(){h=Date.now();for(var x=Math.min(1,(h-a)/o.duration),f=s(x),_=0;_<n.length;_++)u(n[_],f);h-a>o.duration?(function(){for(var b={},T=0;T<n.length;T++){var k=n[T],L=k.plotinfo.xaxis,A=k.plotinfo.yaxis;k.xr1&&(b[L._name+".range"]=k.xr1.slice()),k.yr1&&(b[A._name+".range"]=k.yr1.slice())}c&&c(),v.call("relayout",t,b).then(function(){for(var I=0;I<n.length;I++)p(n[I].plotinfo)})}(),l=window.cancelAnimationFrame(i)):l=window.requestAnimationFrame(i)}),Promise.resolve()}function p(i){var x=i.xaxis,f=i.yaxis;g._defs.select("#"+i.clipId+"> rect").call(y.setTranslate,0,0).call(y.setScale,1,1),i.plot.call(y.setTranslate,x._offset,f._offset).call(y.setScale,1,1);var _=i.plot.selectAll(".scatterlayer .trace");_.selectAll(".point").call(y.setPointGroupScale,1,1),_.selectAll(".textpoint").call(y.setTextPointsScale,1,1),_.call(y.hideOutsideRangePoints,i)}function u(i,x){var f=i.plotinfo,_=f.xaxis,b=f.yaxis,T=_._length,k=b._length,L=!!i.xr1,A=!!i.yr1,I=[];if(L){var P=w.simpleMap(i.xr0,_.r2l),S=w.simpleMap(i.xr1,_.r2l),E=P[1]-P[0],z=S[1]-S[0];I[0]=(P[0]*(1-x)+x*S[0]-P[0])/(P[1]-P[0])*T,I[2]=T*(1-x+x*z/E),_.range[0]=_.l2r(P[0]*(1-x)+x*S[0]),_.range[1]=_.l2r(P[1]*(1-x)+x*S[1])}else I[0]=0,I[2]=T;if(A){var D=w.simpleMap(i.yr0,b.r2l),j=w.simpleMap(i.yr1,b.r2l),V=D[1]-D[0],Z=j[1]-j[0];I[1]=(D[1]*(1-x)+x*j[1]-D[1])/(D[0]-D[1])*k,I[3]=k*(1-x+x*Z/V),b.range[0]=_.l2r(D[0]*(1-x)+x*j[0]),b.range[1]=b.l2r(D[1]*(1-x)+x*j[1])}else I[1]=0,I[3]=k;e.drawOne(t,_,{skipTitle:!0}),e.drawOne(t,b,{skipTitle:!0}),e.redrawComponents(t,[_._id,b._id]);var Q=L?T/I[2]:1,X=A?k/I[3]:1,$=L?I[0]:0,re=A?I[1]:0,H=L?I[0]/I[2]*T:0,N=A?I[1]/I[3]*k:0,U=_._offset-H,te=b._offset-N;f.clipRect.call(y.setTranslate,$,re).call(y.setScale,1/Q,1/X),f.plot.call(y.setTranslate,U,te).call(y.setScale,Q,X),y.setPointGroupScale(f.zoomScalePts,1/Q,1/X),y.setTextPointsScale(f.zoomScaleTxt,1/Q,1/X)}e.redrawComponents(t)}},{"../../components/drawing":389,"../../lib":515,"../../registry":647,"./axes":566,"@plotly/d3":58}],591:[function(m,G,Y){var d=m("../../registry").traceIs,v=m("./axis_autotype");function w(e){return{v:"x",h:"y"}[e.orientation||"v"]}function y(e,t){var n=w(e),o=d(e,"box-violin"),r=d(e._fullInput||{},"candlestick");return o&&!r&&t===n&&e[n]===void 0&&e[n+"0"]===void 0}G.exports=function(e,t,n,o){n("autotypenumbers",o.autotypenumbersDflt),n("type",(o.splomStash||{}).type)==="-"&&(function(r,g){if(r.type==="-"){var c,a=r._id,h=a.charAt(0);a.indexOf("scene")!==-1&&(a=h);var l=function(b,T,k){for(var L=0;L<b.length;L++){var A=b[L];if(A.type==="splom"&&A._length>0&&(A["_"+k+"axes"]||{})[T]||(A[k+"axis"]||k)===T&&(y(A,k)||(A[k]||[]).length||A[k+"0"]))return A}}(g,a,h);if(!!l){if(l.type==="histogram"&&h==={v:"y",h:"x"}[l.orientation||"v"])return void(r.type="linear");var s=h+"calendar",p=l[s],u={noMultiCategory:!d(l,"cartesian")||d(l,"noMultiCategory")};if(l.type==="box"&&l._hasPreCompStats&&h==={h:"x",v:"y"}[l.orientation||"v"]&&(u.noMultiCategory=!0),u.autotypenumbers=r.autotypenumbers,y(l,h)){var i=w(l),x=[];for(c=0;c<g.length;c++){var f=g[c];d(f,"box-violin")&&(f[h+"axis"]||h)===a&&(f[i]!==void 0?x.push(f[i][0]):f.name!==void 0?x.push(f.name):x.push("text"),f[s]!==p&&(p=void 0))}r.type=v(x,p,u)}else if(l.type==="splom"){var _=l.dimensions[l._axesDim[a]];_.visible&&(r.type=v(_.values,p,u))}else r.type=v(l[h]||[l[h+"0"]],p,u)}}}(t,o.data),t.type==="-"?t.type="linear":e.type=t.type)}},{"../../registry":647,"./axis_autotype":567}],592:[function(m,G,Y){var d=m("../registry"),v=m("../lib");function w(n,o,r){var g,c,a,h=!1;if(o.type==="data")g=n._fullData[o.traces!==null?o.traces[0]:0];else{if(o.type!=="layout")return!1;g=n._fullLayout}return c=v.nestedProperty(g,o.prop).get(),(a=r[o.type]=r[o.type]||{}).hasOwnProperty(o.prop)&&a[o.prop]!==c&&(h=!0),a[o.prop]=c,{changed:h,value:c}}function y(n,o){var r=[],g=o[0],c={};if(typeof g=="string")c[g]=o[1];else{if(!v.isPlainObject(g))return r;c=g}return t(c,function(a,h,l){r.push({type:"layout",prop:a,value:l})},"",0),r}function e(n,o){var r,g,c,a,h=[];if(g=o[0],c=o[1],r=o[2],a={},typeof g=="string")a[g]=c;else{if(!v.isPlainObject(g))return h;a=g,r===void 0&&(r=c)}return r===void 0&&(r=null),t(a,function(l,s,p){var u,i;if(Array.isArray(p)){i=p.slice();var x=Math.min(i.length,n.data.length);r&&(x=Math.min(x,r.length)),u=[];for(var f=0;f<x;f++)u[f]=r?r[f]:f}else i=p,u=r?r.slice():null;if(u===null)Array.isArray(i)&&(i=i[0]);else if(Array.isArray(u)){if(!Array.isArray(i)){var _=i;i=[];for(var b=0;b<u.length;b++)i[b]=_}i.length=Math.min(u.length,i.length)}h.push({type:"data",prop:l,traces:u,value:i})},"",0),h}function t(n,o,r,g){Object.keys(n).forEach(function(c){var a=n[c];if(c[0]!=="_"){var h=r+(g>0?".":"")+c;v.isPlainObject(a)?t(a,o,h,g+1):o(h,c,a)}})}Y.manageCommandObserver=function(n,o,r,g){var c={},a=!0;o&&o._commandObserver&&(c=o._commandObserver),c.cache||(c.cache={}),c.lookupTable={};var h=Y.hasSimpleAPICommandBindings(n,r,c.lookupTable);if(o&&o._commandObserver){if(h)return c;if(o._commandObserver.remove)return o._commandObserver.remove(),o._commandObserver=null,c}if(h){w(n,h,c.cache),c.check=function(){if(a){var p=w(n,h,c.cache);return p.changed&&g&&c.lookupTable[p.value]!==void 0&&(c.disable(),Promise.resolve(g({value:p.value,type:h.type,prop:h.prop,traces:h.traces,index:c.lookupTable[p.value]})).then(c.enable,c.enable)),p.changed}};for(var l=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],s=0;s<l.length;s++)n._internalOn(l[s],c.check);c.remove=function(){for(var p=0;p<l.length;p++)n._removeInternalListener(l[p],c.check)}}else v.log("Unable to automatically bind plot updates to API command"),c.lookupTable={},c.remove=function(){};return c.disable=function(){a=!1},c.enable=function(){a=!0},o&&(o._commandObserver=c),c},Y.hasSimpleAPICommandBindings=function(n,o,r){var g,c,a=o.length;for(g=0;g<a;g++){var h,l=o[g],s=l.method,p=l.args;if(Array.isArray(p)||(p=[]),!s)return!1;var u=Y.computeAPICommandBindings(n,s,p);if(u.length!==1)return!1;if(c){if((h=u[0]).type!==c.type||h.prop!==c.prop)return!1;if(Array.isArray(c.traces)){if(!Array.isArray(h.traces))return!1;h.traces.sort();for(var i=0;i<c.traces.length;i++)if(c.traces[i]!==h.traces[i])return!1}else if(h.prop!==c.prop)return!1}else c=u[0],Array.isArray(c.traces)&&c.traces.sort();var x=(h=u[0]).value;if(Array.isArray(x)){if(x.length!==1)return!1;x=x[0]}r&&(r[x]=g)}return c},Y.executeAPICommand=function(n,o,r){if(o==="skip")return Promise.resolve();var g=d.apiMethodRegistry[o],c=[n];Array.isArray(r)||(r=[]);for(var a=0;a<r.length;a++)c.push(r[a]);return g.apply(null,c).catch(function(h){return v.warn("API call to Plotly."+o+" rejected.",h),Promise.reject(h)})},Y.computeAPICommandBindings=function(n,o,r){var g;switch(Array.isArray(r)||(r=[]),o){case"restyle":g=e(n,r);break;case"relayout":g=y(n,r);break;case"update":g=e(n,[r[0],r[2]]).concat(y(n,[r[1]]));break;case"animate":g=function(c,a){return Array.isArray(a[0])&&a[0].length===1&&["string","number"].indexOf(typeof a[0][0])!==-1?[{type:"layout",prop:"_currentFrame",value:a[0][0].toString()}]:[]}(0,r);break;default:g=[]}return g}},{"../lib":515,"../registry":647}],593:[function(m,G,Y){var d=m("../lib/extend").extendFlat;Y.attributes=function(v,w){w=w||{};var y={valType:"info_array",editType:(v=v||{}).editType,items:[{valType:"number",min:0,max:1,editType:v.editType},{valType:"number",min:0,max:1,editType:v.editType}],dflt:[0,1]},e=(v.name&&v.name,v.trace,w.description&&w.description,{x:d({},y,{}),y:d({},y,{}),editType:v.editType});return v.noGridCell||(e.row={valType:"integer",min:0,dflt:0,editType:v.editType},e.column={valType:"integer",min:0,dflt:0,editType:v.editType}),e},Y.defaults=function(v,w,y,e){var t=e&&e.x||[0,1],n=e&&e.y||[0,1],o=w.grid;if(o){var r=y("domain.column");r!==void 0&&(r<o.columns?t=o._domains.x[r]:delete v.domain.column);var g=y("domain.row");g!==void 0&&(g<o.rows?n=o._domains.y[g]:delete v.domain.row)}var c=y("domain.x",t),a=y("domain.y",n);c[0]<c[1]||(v.domain.x=t.slice()),a[0]<a[1]||(v.domain.y=n.slice())}},{"../lib/extend":505}],594:[function(m,G,Y){G.exports=function(d){var v=d.editType,w=d.colorEditType;w===void 0&&(w=v);var y={family:{valType:"string",noBlank:!0,strict:!0,editType:v},size:{valType:"number",min:1,editType:v},color:{valType:"color",editType:w},editType:v};return d.autoSize&&(y.size.dflt="auto"),d.autoColor&&(y.color.dflt="auto"),d.arrayOk&&(y.family.arrayOk=!0,y.size.arrayOk=!0,y.color.arrayOk=!0),y}},{}],595:[function(m,G,Y){G.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],596:[function(m,G,Y){Y.projNames={airy:"airy",aitoff:"aitoff","albers usa":"albersUsa",albers:"albers",august:"august","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant",baker:"baker",bertin1953:"bertin1953",boggs:"boggs",bonne:"bonne",bottomley:"bottomley",bromley:"bromley",collignon:"collignon","conic conformal":"conicConformal","conic equal area":"conicEqualArea","conic equidistant":"conicEquidistant",craig:"craig",craster:"craster","cylindrical equal area":"cylindricalEqualArea","cylindrical stereographic":"cylindricalStereographic",eckert1:"eckert1",eckert2:"eckert2",eckert3:"eckert3",eckert4:"eckert4",eckert5:"eckert5",eckert6:"eckert6",eisenlohr:"eisenlohr",equirectangular:"equirectangular",fahey:"fahey","foucaut sinusoidal":"foucautSinusoidal",foucaut:"foucaut",ginzburg4:"ginzburg4",ginzburg5:"ginzburg5",ginzburg6:"ginzburg6",ginzburg8:"ginzburg8",ginzburg9:"ginzburg9",gnomonic:"gnomonic","gringorten quincuncial":"gringortenQuincuncial",gringorten:"gringorten",guyou:"guyou",hammer:"hammer",hill:"hill",homolosine:"homolosine",hufnagel:"hufnagel",hyperelliptical:"hyperelliptical",kavrayskiy7:"kavrayskiy7",lagrange:"lagrange",larrivee:"larrivee",laskowski:"laskowski",loximuthal:"loximuthal",mercator:"mercator",miller:"miller",mollweide:"mollweide","mt flat polar parabolic":"mtFlatPolarParabolic","mt flat polar quartic":"mtFlatPolarQuartic","mt flat polar sinusoidal":"mtFlatPolarSinusoidal","natural earth":"naturalEarth","natural earth1":"naturalEarth1","natural earth2":"naturalEarth2","nell hammer":"nellHammer",nicolosi:"nicolosi",orthographic:"orthographic",patterson:"patterson","peirce quincuncial":"peirceQuincuncial",polyconic:"polyconic","rectangular polyconic":"rectangularPolyconic",robinson:"robinson",satellite:"satellite","sinu mollweide":"sinuMollweide",sinusoidal:"sinusoidal",stereographic:"stereographic",times:"times","transverse mercator":"transverseMercator","van der grinten":"vanDerGrinten","van der grinten2":"vanDerGrinten2","van der grinten3":"vanDerGrinten3","van der grinten4":"vanDerGrinten4",wagner4:"wagner4",wagner6:"wagner6",wiechel:"wiechel","winkel tripel":"winkel3",winkel3:"winkel3"},Y.axesNames=["lonaxis","lataxis"],Y.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},Y.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},Y.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},Y.clipPad=.001,Y.precision=.1,Y.landColor="#F0DC82",Y.waterColor="#3399FF",Y.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},Y.sphereSVG={type:"Sphere"},Y.fillLayers={ocean:1,land:1,lakes:1},Y.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},Y.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],Y.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],Y.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],597:[function(m,G,Y){var d=m("@plotly/d3"),v=m("d3-geo"),w=v.geoPath,y=v.geoDistance,e=m("d3-geo-projection"),t=m("../../registry"),n=m("../../lib"),o=n.strTranslate,r=m("../../components/color"),g=m("../../components/drawing"),c=m("../../components/fx"),a=m("../plots"),h=m("../cartesian/axes"),l=m("../cartesian/autorange").getAutoRange,s=m("../../components/dragelement"),p=m("../../components/selections").prepSelect,u=m("../../components/selections").clearOutline,i=m("../../components/selections").selectOnClick,x=m("./zoom"),f=m("./constants"),_=m("../../lib/geo_location_utils"),b=m("../../lib/topojson_utils"),T=m("topojson-client").feature;function k(I){this.id=I.id,this.graphDiv=I.graphDiv,this.container=I.container,this.topojsonURL=I.topojsonURL,this.isStatic=I.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}var L=k.prototype;function A(I,P){var S=f.clipPad,E=I[0]+S,z=I[1]-S,D=P[0]+S,j=P[1]-S;E>0&&z<0&&(z+=360);var V=(z-E)/4;return{type:"Polygon",coordinates:[[[E,D],[E,j],[E+V,j],[E+2*V,j],[E+3*V,j],[z,j],[z,D],[z-V,D],[z-2*V,D],[z-3*V,D],[E,D]]]}}G.exports=function(I){return new k(I)},L.plot=function(I,P,S,E){var z=this;if(E)return z.update(I,P,!0);z._geoCalcData=I,z._fullLayout=P;var D=P[this.id],j=[],V=!1;for(var Z in f.layerNameToAdjective)if(Z!=="frame"&&D["show"+Z]){V=!0;break}for(var Q=!1,X=0;X<I.length;X++){var $=I[0][0].trace;$._geo=z,$.locationmode&&(V=!0);var re=$.marker;if(re){var H=re.angle,N=re.angleref;(H||N==="north"||N==="previous")&&(Q=!0)}}if(this._hasMarkerAngles=Q,V){var U=b.getTopojsonName(D);z.topojson!==null&&U===z.topojsonName||(z.topojsonName=U,PlotlyGeoAssets.topojson[z.topojsonName]===void 0&&j.push(z.fetchTopojson()))}j=j.concat(_.fetchTraceGeoData(I)),S.push(new Promise(function(te,B){Promise.all(j).then(function(){z.topojson=PlotlyGeoAssets.topojson[z.topojsonName],z.update(I,P),te()}).catch(B)}))},L.fetchTopojson=function(){var I=this,P=b.getTopojsonPath(I.topojsonURL,I.topojsonName);return new Promise(function(S,E){d.json(P,function(z,D){if(z)return z.status===404?E(new Error(["plotly.js could not find topojson file at",P+".","Make sure the *topojsonURL* plot config option","is set properly."].join(" "))):E(new Error(["unexpected error while fetching topojson file at",P].join(" ")));PlotlyGeoAssets.topojson[I.topojsonName]=D,S()})})},L.update=function(I,P,S){var E=P[this.id];this.hasChoropleth=!1;for(var z=0;z<I.length;z++){var D=I[z],j=D[0].trace;j.type==="choropleth"&&(this.hasChoropleth=!0),j.visible===!0&&j._length>0&&j._module.calcGeoJSON(D,P)}if(!S){if(this.updateProjection(I,P))return;this.viewInitial&&this.scope===E.scope||this.saveViewInitial(E)}this.scope=E.scope,this.updateBaseLayers(P,E),this.updateDims(P,E),this.updateFx(P,E),a.generalUpdatePerTraceModule(this.graphDiv,this,I,E);var V=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=V.selectAll(".point"),this.dataPoints.text=V.selectAll("text"),this.dataPaths.line=V.selectAll(".js-line");var Z=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=Z.selectAll("path"),this._render()},L.updateProjection=function(I,P){var S=this.graphDiv,E=P[this.id],z=P._size,D=E.domain,j=E.projection,V=E.lonaxis,Z=E.lataxis,Q=V._ax,X=Z._ax,$=this.projection=function(le){var ve=le.projection,Me=ve.type,we=f.projNames[Me];we="geo"+n.titleCase(we);for(var de=(v[we]||e[we])(),Ie=le._isSatellite?180*Math.acos(1/ve.distance)/Math.PI:le._isClipped?f.lonaxisSpan[Me]/2:null,De=["center","rotate","parallels","clipExtent"],Oe=function(ze){return ze?de:[]},Ve=0;Ve<De.length;Ve++){var Fe=De[Ve];typeof de[Fe]!="function"&&(de[Fe]=Oe)}return de.isLonLatOverEdges=function(ze){if(de(ze)===null)return!0;if(Ie){var Re=de.rotate();return y(ze,[-Re[0],-Re[1]])>Ie*Math.PI/180}return!1},de.getPath=function(){return w().projection(de)},de.getBounds=function(ze){return de.getPath().bounds(ze)},de.precision(f.precision),le._isSatellite&&de.tilt(ve.tilt).distance(ve.distance),Ie&&de.clipAngle(Ie-f.clipPad),de}(E),re=[[z.l+z.w*D.x[0],z.t+z.h*(1-D.y[1])],[z.l+z.w*D.x[1],z.t+z.h*(1-D.y[0])]],H=E.center||{},N=j.rotation||{},U=V.range||[],te=Z.range||[];if(E.fitbounds){Q._length=re[1][0]-re[0][0],X._length=re[1][1]-re[0][1],Q.range=l(S,Q),X.range=l(S,X);var B=(Q.range[0]+Q.range[1])/2,K=(X.range[0]+X.range[1])/2;if(E._isScoped)H={lon:B,lat:K};else if(E._isClipped){H={lon:B,lat:K},N={lon:B,lat:K,roll:N.roll};var J=j.type,ee=f.lonaxisSpan[J]/2||180,ne=f.lataxisSpan[J]/2||90;U=[B-ee,B+ee],te=[K-ne,K+ne]}else H={lon:B,lat:K},N={lon:B,lat:N.lat,roll:N.roll}}$.center([H.lon-N.lon,H.lat-N.lat]).rotate([-N.lon,-N.lat,N.roll]).parallels(j.parallels);var se=A(U,te);$.fitExtent(re,se);var oe=this.bounds=$.getBounds(se),me=this.fitScale=$.scale(),ce=$.translate();if(E.fitbounds){var ye=$.getBounds(A(Q.range,X.range)),Se=Math.min((oe[1][0]-oe[0][0])/(ye[1][0]-ye[0][0]),(oe[1][1]-oe[0][1])/(ye[1][1]-ye[0][1]));isFinite(Se)?$.scale(Se*me):n.warn("Something went wrong during"+this.id+"fitbounds computations.")}else $.scale(j.scale*me);var fe=this.midPt=[(oe[0][0]+oe[1][0])/2,(oe[0][1]+oe[1][1])/2];if($.translate([ce[0]+(fe[0]-ce[0]),ce[1]+(fe[1]-ce[1])]).clipExtent(oe),E._isAlbersUsa){var ge=$([H.lon,H.lat]),Te=$.translate();$.translate([Te[0]-(ge[0]-Te[0]),Te[1]-(ge[1]-Te[1])])}},L.updateBaseLayers=function(I,P){var S=this,E=S.topojson,z=S.layers,D=S.basePaths;function j($){return $==="lonaxis"||$==="lataxis"}function V($){return Boolean(f.lineLayers[$])}function Z($){return Boolean(f.fillLayers[$])}var Q=(this.hasChoropleth?f.layersForChoropleth:f.layers).filter(function($){return V($)||Z($)?P["show"+$]:!j($)||P[$].showgrid}),X=S.framework.selectAll(".layer").data(Q,String);X.exit().each(function($){delete z[$],delete D[$],d.select(this).remove()}),X.enter().append("g").attr("class",function($){return"layer "+$}).each(function($){var re=z[$]=d.select(this);$==="bg"?S.bgRect=re.append("rect").style("pointer-events","all"):j($)?D[$]=re.append("path").style("fill","none"):$==="backplot"?re.append("g").classed("choroplethlayer",!0):$==="frontplot"?re.append("g").classed("scatterlayer",!0):V($)?D[$]=re.append("path").style("fill","none").style("stroke-miterlimit",2):Z($)&&(D[$]=re.append("path").style("stroke","none"))}),X.order(),X.each(function($){var re=D[$],H=f.layerNameToAdjective[$];$==="frame"?re.datum(f.sphereSVG):V($)||Z($)?re.datum(T(E,E.objects[$])):j($)&&re.datum(function(N,U,te){var B,K,J,ee=U[N],ne=f.scopeDefaults[U.scope];N==="lonaxis"?(B=ne.lonaxisRange,K=ne.lataxisRange,J=function(Te,le){return[Te,le]}):N==="lataxis"&&(B=ne.lataxisRange,K=ne.lonaxisRange,J=function(Te,le){return[le,Te]});var se={type:"linear",range:[B[0],B[1]-1e-6],tick0:ee.tick0,dtick:ee.dtick};h.setConvert(se,te);var oe=h.calcTicks(se);U.isScoped||N!=="lonaxis"||oe.pop();for(var me=oe.length,ce=new Array(me),ye=0;ye<me;ye++)for(var Se=oe[ye].x,fe=ce[ye]=[],ge=K[0];ge<K[1]+2.5;ge+=2.5)fe.push(J(Se,ge));return{type:"MultiLineString",coordinates:ce}}($,P,I)).call(r.stroke,P[$].gridcolor).call(g.dashLine,P[$].griddash,P[$].gridwidth),V($)?re.call(r.stroke,P[H+"color"]).call(g.dashLine,"",P[H+"width"]):Z($)&&re.call(r.fill,P[H+"color"])})},L.updateDims=function(I,P){var S=this.bounds,E=(P.framewidth||0)/2,z=S[0][0]-E,D=S[0][1]-E,j=S[1][0]-z+E,V=S[1][1]-D+E;g.setRect(this.clipRect,z,D,j,V),this.bgRect.call(g.setRect,z,D,j,V).call(r.fill,P.bgcolor),this.xaxis._offset=z,this.xaxis._length=j,this.yaxis._offset=D,this.yaxis._length=V},L.updateFx=function(I,P){var S=this,E=S.graphDiv,z=S.bgRect,D=I.dragmode,j=I.clickmode;if(!S.isStatic){var V={element:S.bgRect.node(),gd:E,plotinfo:{id:S.id,xaxis:S.xaxis,yaxis:S.yaxis,fillRangeItems:function(Q,X){X.isRect?(Q.range={})[S.id]=[Z([X.xmin,X.ymin]),Z([X.xmax,X.ymax])]:(Q.lassoPoints={})[S.id]=X.map(Z)}},xaxes:[S.xaxis],yaxes:[S.yaxis],subplot:S.id,clickFn:function(Q){Q===2&&u(E)}};D==="pan"?(z.node().onmousedown=null,z.call(x(S,P)),z.on("dblclick.zoom",function(){var Q=S.viewInitial,X={};for(var $ in Q)X[S.id+"."+$]=Q[$];t.call("_guiRelayout",E,X),E.emit("plotly_doubleclick",null)}),E._context._scrollZoom.geo||z.on("wheel.zoom",null)):D!=="select"&&D!=="lasso"||(z.on(".zoom",null),V.prepFn=function(Q,X,$){p(Q,X,$,V,D)},s.init(V)),z.on("mousemove",function(){var Q=S.projection.invert(n.getPositionFromD3Event());if(!Q)return s.unhover(E,d.event);S.xaxis.p2c=function(){return Q[0]},S.yaxis.p2c=function(){return Q[1]},c.hover(E,d.event,S.id)}),z.on("mouseout",function(){E._dragging||s.unhover(E,d.event)}),z.on("click",function(){D!=="select"&&D!=="lasso"&&(j.indexOf("select")>-1&&i(d.event,E,[S.xaxis],[S.yaxis],S.id,V),j.indexOf("event")>-1&&c.click(E,d.event))})}function Z(Q){return S.projection.invert([Q[0]+S.xaxis._offset,Q[1]+S.yaxis._offset])}},L.makeFramework=function(){var I=this,P=I.graphDiv,S=P._fullLayout,E="clip"+S._uid+I.id;I.clipDef=S._clips.append("clipPath").attr("id",E),I.clipRect=I.clipDef.append("rect"),I.framework=d.select(I.container).append("g").attr("class","geo "+I.id).call(g.setClipUrl,E,P),I.project=function(z){var D=I.projection(z);return D?[D[0]-I.xaxis._offset,D[1]-I.yaxis._offset]:[null,null]},I.xaxis={_id:"x",c2p:function(z){return I.project(z)[0]}},I.yaxis={_id:"y",c2p:function(z){return I.project(z)[1]}},I.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},h.setConvert(I.mockAxis,S)},L.saveViewInitial=function(I){var P,S=I.center||{},E=I.projection,z=E.rotation||{};this.viewInitial={fitbounds:I.fitbounds,"projection.scale":E.scale},P=I._isScoped?{"center.lon":S.lon,"center.lat":S.lat}:I._isClipped?{"projection.rotation.lon":z.lon,"projection.rotation.lat":z.lat}:{"center.lon":S.lon,"center.lat":S.lat,"projection.rotation.lon":z.lon},n.extendFlat(this.viewInitial,P)},L.render=function(I){this._hasMarkerAngles&&I?this.plot(this._geoCalcData,this._fullLayout,[],!0):this._render()},L._render=function(){var I,P=this.projection,S=P.getPath();function E(D){var j=P(D.lonlat);return j?o(j[0],j[1]):null}function z(D){return P.isLonLatOverEdges(D.lonlat)?"none":null}for(I in this.basePaths)this.basePaths[I].attr("d",S);for(I in this.dataPaths)this.dataPaths[I].attr("d",function(D){return S(D.geojson)});for(I in this.dataPoints)this.dataPoints[I].attr("display",z).attr("transform",E)}},{"../../components/color":367,"../../components/dragelement":386,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/topojson_utils":544,"../../registry":647,"../cartesian/autorange":565,"../cartesian/axes":566,"../plots":628,"./constants":596,"./zoom":601,"@plotly/d3":58,"d3-geo":114,"d3-geo-projection":113,"topojson-client":316}],598:[function(m,G,Y){var d=m("../../plots/get_data").getSubplotCalcData,v=m("../../lib").counterRegex,w=m("./geo"),y="geo",e=v(y),t={};t.geo={valType:"subplotid",dflt:y,editType:"calc"},G.exports={attr:y,name:y,idRoot:y,idRegex:e,attrRegex:e,attributes:t,layoutAttributes:m("./layout_attributes"),supplyLayoutDefaults:m("./layout_defaults"),plot:function(n){for(var o=n._fullLayout,r=n.calcdata,g=o._subplots.geo,c=0;c<g.length;c++){var a=g[c],h=d(r,y,a),l=o[a]._subplot;l||(l=w({id:a,graphDiv:n,container:o._geolayer.node(),topojsonURL:n._context.topojsonURL,staticPlot:n._context.staticPlot}),o[a]._subplot=l),l.plot(h,o,n._promises)}},updateFx:function(n){for(var o=n._fullLayout,r=o._subplots.geo,g=0;g<r.length;g++){var c=o[r[g]];c._subplot.updateFx(o,c)}},clean:function(n,o,r,g){for(var c=g._subplots.geo||[],a=0;a<c.length;a++){var h=c[a],l=g[h]._subplot;!o[h]&&l&&(l.framework.remove(),l.clipDef.remove())}}}},{"../../lib":515,"../../plots/get_data":602,"./geo":597,"./layout_attributes":599,"./layout_defaults":600}],599:[function(m,G,Y){var d=m("../../components/color/attributes"),v=m("../domain").attributes,w=m("../../components/drawing/attributes").dash,y=m("./constants"),e=m("../../plot_api/edit_types").overrideAll,t=m("../../lib/sort_object_keys"),n={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:d.lightLine},gridwidth:{valType:"number",min:0,dflt:1},griddash:w};(G.exports=e({domain:v({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[!1,"locations","geojson"],dflt:!1,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:t(y.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:t(y.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},tilt:{valType:"number",dflt:0},distance:{valType:"number",min:1.001,dflt:2},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:!0},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:d.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:y.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:y.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:y.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:y.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:d.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:d.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:d.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:d.background},lonaxis:n,lataxis:n},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../domain":593,"./constants":596}],600:[function(m,G,Y){var d=m("../../lib"),v=m("../subplot_defaults"),w=m("../get_data").getSubplotData,y=m("./constants"),e=m("./layout_attributes"),t=y.axesNames;function n(o,r,g,c){var a=w(c.fullData,"geo",c.id).map(function(N){return N._expandedIndex}),h=g("resolution"),l=g("scope"),s=y.scopeDefaults[l],p=g("projection.type",s.projType),u=r._isAlbersUsa=p==="albers usa";u&&(l=r.scope="usa");var i=r._isScoped=l!=="world",x=r._isSatellite=p==="satellite",f=r._isConic=p.indexOf("conic")!==-1||p==="albers",_=r._isClipped=!!y.lonaxisSpan[p];if(o.visible===!1){var b=d.extendDeep({},r._template);b.showcoastlines=!1,b.showcountries=!1,b.showframe=!1,b.showlakes=!1,b.showland=!1,b.showocean=!1,b.showrivers=!1,b.showsubunits=!1,b.lonaxis&&(b.lonaxis.showgrid=!1),b.lataxis&&(b.lataxis.showgrid=!1),r._template=b}for(var T=g("visible"),k=0;k<t.length;k++){var L,A=t[k],I=[30,10][k];if(i)L=s[A+"Range"];else{var P=y[A+"Span"],S=(P[p]||P["*"])/2,E=g("projection.rotation."+A.substr(0,3),s.projRotate[k]);L=[E-S,E+S]}var z=g(A+".range",L);g(A+".tick0"),g(A+".dtick",I),g(A+".showgrid",!!T&&void 0)&&(g(A+".gridcolor"),g(A+".gridwidth"),g(A+".griddash")),r[A]._ax={type:"linear",_id:A.slice(0,3),_traceIndices:a,setScale:d.identity,c2l:d.identity,r2l:d.identity,autorange:!0,range:z.slice(),_m:1,_input:{}}}var D=r.lonaxis.range,j=r.lataxis.range,V=D[0],Z=D[1];V>0&&Z<0&&(Z+=360);var Q,X,$,re=(V+Z)/2;if(!u){var H=i?s.projRotate:[re,0,0];Q=g("projection.rotation.lon",H[0]),g("projection.rotation.lat",H[1]),g("projection.rotation.roll",H[2]),g("showcoastlines",!i&&T)&&(g("coastlinecolor"),g("coastlinewidth")),g("showocean",!!T&&void 0)&&g("oceancolor")}u?(X=-96.6,$=38.7):(X=i?re:Q,$=(j[0]+j[1])/2),g("center.lon",X),g("center.lat",$),x&&(g("projection.tilt"),g("projection.distance")),f&&g("projection.parallels",s.projParallels||[0,60]),g("projection.scale"),g("showland",!!T&&void 0)&&g("landcolor"),g("showlakes",!!T&&void 0)&&g("lakecolor"),g("showrivers",!!T&&void 0)&&(g("rivercolor"),g("riverwidth")),g("showcountries",i&&l!=="usa"&&T)&&(g("countrycolor"),g("countrywidth")),(l==="usa"||l==="north america"&&h===50)&&(g("showsubunits",T),g("subunitcolor"),g("subunitwidth")),i||g("showframe",T)&&(g("framecolor"),g("framewidth")),g("bgcolor"),g("fitbounds")&&(delete r.projection.scale,i?(delete r.center.lon,delete r.center.lat):_?(delete r.center.lon,delete r.center.lat,delete r.projection.rotation.lon,delete r.projection.rotation.lat,delete r.lonaxis.range,delete r.lataxis.range):(delete r.center.lon,delete r.center.lat,delete r.projection.rotation.lon))}G.exports=function(o,r,g){v(o,r,g,{type:"geo",attributes:e,handleDefaults:n,fullData:g,partition:"y"})}},{"../../lib":515,"../get_data":602,"../subplot_defaults":641,"./constants":596,"./layout_attributes":599}],601:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../registry"),y=Math.PI/180,e=180/Math.PI,t={cursor:"pointer"},n={cursor:"auto"};function o(T,k){return d.behavior.zoom().translate(k.translate()).scale(k.scale())}function r(T,k,L){var A=T.id,I=T.graphDiv,P=I.layout,S=P[A],E=I._fullLayout,z=E[A],D={},j={};function V(Z,Q){D[A+"."+Z]=v.nestedProperty(S,Z).get(),w.call("_storeDirectGUIEdit",P,E._preGUI,D);var X=v.nestedProperty(z,Z);X.get()!==Q&&(X.set(Q),v.nestedProperty(S,Z).set(Q),j[A+"."+Z]=Q)}L(V),V("projection.scale",k.scale()/T.fitScale),V("fitbounds",!1),I.emit("plotly_relayout",j)}function g(T,k){var L=o(0,k);function A(I){var P=k.invert(T.midPt);I("center.lon",P[0]),I("center.lat",P[1])}return L.on("zoomstart",function(){d.select(this).style(t)}).on("zoom",function(){k.scale(d.event.scale).translate(d.event.translate),T.render(!0);var I=k.invert(T.midPt);T.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/T.fitScale,"geo.center.lon":I[0],"geo.center.lat":I[1]})}).on("zoomend",function(){d.select(this).style(n),r(T,k,A)}),L}function c(T,k){var L,A,I,P,S,E,z,D,j,V=o(0,k);function Z(X){return k.invert(X)}function Q(X){var $=k.rotate(),re=k.invert(T.midPt);X("projection.rotation.lon",-$[0]),X("center.lon",re[0]),X("center.lat",re[1])}return V.on("zoomstart",function(){d.select(this).style(t),L=d.mouse(this),A=k.rotate(),I=k.translate(),P=A,S=Z(L)}).on("zoom",function(){if(E=d.mouse(this),function(re){var H=Z(re);if(!H)return!0;var N=k(H);return Math.abs(N[0]-re[0])>2||Math.abs(N[1]-re[1])>2}(L))return V.scale(k.scale()),void V.translate(k.translate());k.scale(d.event.scale),k.translate([I[0],d.event.translate[1]]),S?Z(E)&&(D=Z(E),z=[P[0]+(D[0]-S[0]),A[1],A[2]],k.rotate(z),P=z):S=Z(L=E),j=!0,T.render(!0);var X=k.rotate(),$=k.invert(T.midPt);T.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/T.fitScale,"geo.center.lon":$[0],"geo.center.lat":$[1],"geo.projection.rotation.lon":-X[0]})}).on("zoomend",function(){d.select(this).style(n),j&&r(T,k,Q)}),V}function a(T,k){var L;k.rotate(),k.scale();var A=o(0,k),I=function(V){for(var Z=0,Q=arguments.length,X=[];++Z<Q;)X.push(arguments[Z]);var $=d.dispatch.apply(null,X);return $.of=function(re,H){return function(N){var U;try{U=N.sourceEvent=d.event,N.target=V,d.event=N,$[N.type].apply(re,H)}finally{d.event=U}}},$}(A,"zoomstart","zoom","zoomend"),P=0,S=A.on;function E(V){P++||V({type:"zoomstart"})}function z(V){V({type:"zoom"})}function D(V){--P||V({type:"zoomend"})}function j(V){var Z=k.rotate();V("projection.rotation.lon",-Z[0]),V("projection.rotation.lat",-Z[1])}return A.on("zoomstart",function(){d.select(this).style(t);var V=d.mouse(this),Z=k.rotate(),Q=Z,X=k.translate(),$=l(Z);L=h(k,V),S.call(A,"zoom",function(){var re=d.mouse(this);if(k.scale(d.event.scale),L){if(h(k,re)){k.rotate(Z).translate(X);var H=h(k,re),N=p(L,H),U=_(s($,N)),te=u(U,L,Q);isFinite(te[0])&&isFinite(te[1])&&isFinite(te[2])||(te=Q),k.rotate(te),Q=te}}else L=h(k,V=re);z(I.of(this,arguments))}),E(I.of(this,arguments))}).on("zoomend",function(){d.select(this).style(n),S.call(A,"zoom",null),D(I.of(this,arguments)),r(T,k,j)}).on("zoom.redraw",function(){T.render(!0);var V=k.rotate();T.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":k.scale()/T.fitScale,"geo.projection.rotation.lon":-V[0],"geo.projection.rotation.lat":-V[1]})}),d.rebind(A,I,"on")}function h(T,k){var L=T.invert(k);return L&&isFinite(L[0])&&isFinite(L[1])&&function(A){var I=A[0]*y,P=A[1]*y,S=Math.cos(P);return[S*Math.cos(I),S*Math.sin(I),Math.sin(P)]}(L)}function l(T){var k=.5*T[0]*y,L=.5*T[1]*y,A=.5*T[2]*y,I=Math.sin(k),P=Math.cos(k),S=Math.sin(L),E=Math.cos(L),z=Math.sin(A),D=Math.cos(A);return[P*E*D+I*S*z,I*E*D-P*S*z,P*S*D+I*E*z,P*E*z-I*S*D]}function s(T,k){var L=T[0],A=T[1],I=T[2],P=T[3],S=k[0],E=k[1],z=k[2],D=k[3];return[L*S-A*E-I*z-P*D,L*E+A*S+I*D-P*z,L*z-A*D+I*S+P*E,L*D+A*z-I*E+P*S]}function p(T,k){if(T&&k){var L=function(S,E){return[S[1]*E[2]-S[2]*E[1],S[2]*E[0]-S[0]*E[2],S[0]*E[1]-S[1]*E[0]]}(T,k),A=Math.sqrt(b(L,L)),I=.5*Math.acos(Math.max(-1,Math.min(1,b(T,k)))),P=Math.sin(I)/A;return A&&[Math.cos(I),L[2]*P,-L[1]*P,L[0]*P]}}function u(T,k,L){var A=f(k,2,T[0]);A=f(A,1,T[1]),A=f(A,0,T[2]-L[2]);var I,P,S=k[0],E=k[1],z=k[2],D=A[0],j=A[1],V=A[2],Z=Math.atan2(E,S)*e,Q=Math.sqrt(S*S+E*E);Math.abs(j)>Q?(P=(j>0?90:-90)-Z,I=0):(P=Math.asin(j/Q)*e-Z,I=Math.sqrt(Q*Q-j*j));var X=180-P-2*Z,$=(Math.atan2(V,D)-Math.atan2(z,I))*e,re=(Math.atan2(V,D)-Math.atan2(z,-I))*e;return i(L[0],L[1],P,$)<=i(L[0],L[1],X,re)?[P,$,L[2]]:[X,re,L[2]]}function i(T,k,L,A){var I=x(L-T),P=x(A-k);return Math.sqrt(I*I+P*P)}function x(T){return(T%360+540)%360-180}function f(T,k,L){var A=L*y,I=T.slice(),P=k===0?1:0,S=k===2?1:2,E=Math.cos(A),z=Math.sin(A);return I[P]=T[P]*E-T[S]*z,I[S]=T[S]*E+T[P]*z,I}function _(T){return[Math.atan2(2*(T[0]*T[1]+T[2]*T[3]),1-2*(T[1]*T[1]+T[2]*T[2]))*e,Math.asin(Math.max(-1,Math.min(1,2*(T[0]*T[2]-T[3]*T[1]))))*e,Math.atan2(2*(T[0]*T[3]+T[1]*T[2]),1-2*(T[2]*T[2]+T[3]*T[3]))*e]}function b(T,k){for(var L=0,A=0,I=T.length;A<I;++A)L+=T[A]*k[A];return L}G.exports=function(T,k){var L=T.projection;return(k._isScoped?g:k._isClipped?a:c)(T,L)}},{"../../lib":515,"../../registry":647,"@plotly/d3":58}],602:[function(m,G,Y){var d=m("../registry"),v=m("./cartesian/constants").SUBPLOT_PATTERN;Y.getSubplotCalcData=function(w,y,e){var t=d.subplotsRegistry[y];if(!t)return[];for(var n=t.attr,o=[],r=0;r<w.length;r++){var g=w[r];g[0].trace[n]===e&&o.push(g)}return o},Y.getModuleCalcData=function(w,y){var e,t=[],n=[];if(!(e=typeof y=="string"?d.getModule(y).plot:typeof y=="function"?y:y.plot))return[t,w];for(var o=0;o<w.length;o++){var r=w[o],g=r[0].trace;g.visible===!0&&g._length!==0&&(g._module.plot===e?t.push(r):n.push(r))}return[t,n]},Y.getSubplotData=function(w,y,e){if(!d.subplotsRegistry[y])return[];var t,n,o,r=d.subplotsRegistry[y].attr,g=[];if(y==="gl2d"){var c=e.match(v);n="x"+c[1],o="y"+c[2]}for(var a=0;a<w.length;a++)t=w[a],y==="gl2d"&&d.traceIs(t,"gl2d")?t[r[0]]===n&&t[r[1]]===o&&g.push(t):t[r]===e&&g.push(t);return g}},{"../registry":647,"./cartesian/constants":573}],603:[function(m,G,Y){var d=m("mouse-change"),v=m("mouse-wheel"),w=m("mouse-event-offset"),y=m("../cartesian/constants"),e=m("has-passive-events");function t(n,o){this.element=n,this.plot=o,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}G.exports=function(n){var o=n.mouseContainer,r=n.glplot,g=new t(o,r);function c(){n.xaxis.autorange=!1,n.yaxis.autorange=!1}function a(h,l,s){var p,u,i=n.calcDataBox(),x=r.viewBox,f=g.lastPos[0],_=g.lastPos[1],b=y.MINDRAG*r.pixelRatio,T=y.MINZOOM*r.pixelRatio;function k(E,z,D){var j=Math.min(z,D),V=Math.max(z,D);j!==V?(i[E]=j,i[E+2]=V,g.dataBox=i,n.setRanges(i)):(n.selectBox.selectBox=[0,0,1,1],n.glplot.setDirty())}switch(l*=r.pixelRatio,s*=r.pixelRatio,s=x[3]-x[1]-s,n.fullLayout.dragmode){case"zoom":if(h){var L=l/(x[2]-x[0])*(i[2]-i[0])+i[0],A=s/(x[3]-x[1])*(i[3]-i[1])+i[1];g.boxInited||(g.boxStart[0]=L,g.boxStart[1]=A,g.dragStart[0]=l,g.dragStart[1]=s),g.boxEnd[0]=L,g.boxEnd[1]=A,g.boxInited=!0,g.boxEnabled||g.boxStart[0]===g.boxEnd[0]&&g.boxStart[1]===g.boxEnd[1]||(g.boxEnabled=!0);var I=Math.abs(g.dragStart[0]-l)<T,P=Math.abs(g.dragStart[1]-s)<T;if(!function(){for(var E=n.graphDiv._fullLayout._axisConstraintGroups,z=n.xaxis._id,D=n.yaxis._id,j=0;j<E.length;j++)if(E[j][z]!==-1){if(E[j][D]!==-1)return!0;break}return!1}()||I&&P)I&&(g.boxEnd[0]=g.boxStart[0]),P&&(g.boxEnd[1]=g.boxStart[1]);else{p=g.boxEnd[0]-g.boxStart[0],u=g.boxEnd[1]-g.boxStart[1];var S=(i[3]-i[1])/(i[2]-i[0]);Math.abs(p*S)>Math.abs(u)?(g.boxEnd[1]=g.boxStart[1]+Math.abs(p)*S*(u>=0?1:-1),g.boxEnd[1]<i[1]?(g.boxEnd[1]=i[1],g.boxEnd[0]=g.boxStart[0]+(i[1]-g.boxStart[1])/Math.abs(S)):g.boxEnd[1]>i[3]&&(g.boxEnd[1]=i[3],g.boxEnd[0]=g.boxStart[0]+(i[3]-g.boxStart[1])/Math.abs(S))):(g.boxEnd[0]=g.boxStart[0]+Math.abs(u)/S*(p>=0?1:-1),g.boxEnd[0]<i[0]?(g.boxEnd[0]=i[0],g.boxEnd[1]=g.boxStart[1]+(i[0]-g.boxStart[0])*Math.abs(S)):g.boxEnd[0]>i[2]&&(g.boxEnd[0]=i[2],g.boxEnd[1]=g.boxStart[1]+(i[2]-g.boxStart[0])*Math.abs(S)))}}else g.boxEnabled?(p=g.boxStart[0]!==g.boxEnd[0],u=g.boxStart[1]!==g.boxEnd[1],p||u?(p&&(k(0,g.boxStart[0],g.boxEnd[0]),n.xaxis.autorange=!1),u&&(k(1,g.boxStart[1],g.boxEnd[1]),n.yaxis.autorange=!1),n.relayoutCallback()):n.glplot.setDirty(),g.boxEnabled=!1,g.boxInited=!1):g.boxInited&&(g.boxInited=!1);break;case"pan":g.boxEnabled=!1,g.boxInited=!1,h?(g.panning||(g.dragStart[0]=l,g.dragStart[1]=s),Math.abs(g.dragStart[0]-l)<b&&(l=g.dragStart[0]),Math.abs(g.dragStart[1]-s)<b&&(s=g.dragStart[1]),p=(f-l)*(i[2]-i[0])/(r.viewBox[2]-r.viewBox[0]),u=(_-s)*(i[3]-i[1])/(r.viewBox[3]-r.viewBox[1]),i[0]+=p,i[2]+=p,i[1]+=u,i[3]+=u,n.setRanges(i),g.panning=!0,g.lastInputTime=Date.now(),c(),n.cameraChanged(),n.handleAnnotations()):g.panning&&(g.panning=!1,n.relayoutCallback())}g.lastPos[0]=l,g.lastPos[1]=s}return g.mouseListener=d(o,a),o.addEventListener("touchstart",function(h){var l=w(h.changedTouches[0],o);a(0,l[0],l[1]),a(1,l[0],l[1]),h.preventDefault()},!!e&&{passive:!1}),o.addEventListener("touchmove",function(h){h.preventDefault();var l=w(h.changedTouches[0],o);a(1,l[0],l[1]),h.preventDefault()},!!e&&{passive:!1}),o.addEventListener("touchend",function(h){a(0,g.lastPos[0],g.lastPos[1]),h.preventDefault()},!!e&&{passive:!1}),g.wheelListener=v(o,function(h,l){if(!n.scrollZoom)return!1;var s=n.calcDataBox(),p=r.viewBox,u=g.lastPos[0],i=g.lastPos[1],x=Math.exp(5*l/(p[3]-p[1])),f=u/(p[2]-p[0])*(s[2]-s[0])+s[0],_=i/(p[3]-p[1])*(s[3]-s[1])+s[1];return s[0]=(s[0]-f)*x+f,s[2]=(s[2]-f)*x+f,s[1]=(s[1]-_)*x+_,s[3]=(s[3]-_)*x+_,n.setRanges(s),g.lastInputTime=Date.now(),c(),n.cameraChanged(),n.handleAnnotations(),n.relayoutCallback(),!0},!0),g}},{"../cartesian/constants":573,"has-passive-events":229,"mouse-change":241,"mouse-event-offset":242,"mouse-wheel":244}],604:[function(m,G,Y){var d=m("../cartesian/axes"),v=m("../../lib/str2rgbarray");function w(t){this.scene=t,this.gl=t.gl,this.pixelRatio=t.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var y=w.prototype,e=["xaxis","yaxis"];y.merge=function(t){var n,o,r,g,c,a,h,l,s,p,u;for(this.titleEnable=!1,this.backgroundColor=v(t.plot_bgcolor),p=0;p<2;++p){var i=(n=e[p]).charAt(0);for(r=(o=t[this.scene[n]._name]).title.text===this.scene.fullLayout._dfltTitle[i]?"":o.title.text,u=0;u<=2;u+=2)this.labelEnable[p+u]=!1,this.labels[p+u]=r,this.labelColor[p+u]=v(o.title.font.color),this.labelFont[p+u]=o.title.font.family,this.labelSize[p+u]=o.title.font.size,this.labelPad[p+u]=this.getLabelPad(n,o),this.tickEnable[p+u]=!1,this.tickColor[p+u]=v((o.tickfont||{}).color),this.tickAngle[p+u]=o.tickangle==="auto"?0:Math.PI*-o.tickangle/180,this.tickPad[p+u]=this.getTickPad(o),this.tickMarkLength[p+u]=0,this.tickMarkWidth[p+u]=o.tickwidth||0,this.tickMarkColor[p+u]=v(o.tickcolor),this.borderLineEnable[p+u]=!1,this.borderLineColor[p+u]=v(o.linecolor),this.borderLineWidth[p+u]=o.linewidth||0;h=this.hasSharedAxis(o),c=this.hasAxisInDfltPos(n,o)&&!h,a=this.hasAxisInAltrPos(n,o)&&!h,g=o.mirror||!1,l=h?String(g).indexOf("all")!==-1:!!g,s=h?g==="allticks":String(g).indexOf("ticks")!==-1,c?this.labelEnable[p]=!0:a&&(this.labelEnable[p+2]=!0),c?this.tickEnable[p]=o.showticklabels:a&&(this.tickEnable[p+2]=o.showticklabels),(c||l)&&(this.borderLineEnable[p]=o.showline),(a||l)&&(this.borderLineEnable[p+2]=o.showline),(c||s)&&(this.tickMarkLength[p]=this.getTickMarkLength(o)),(a||s)&&(this.tickMarkLength[p+2]=this.getTickMarkLength(o)),this.gridLineEnable[p]=o.showgrid,this.gridLineColor[p]=v(o.gridcolor),this.gridLineWidth[p]=o.gridwidth,this.zeroLineEnable[p]=o.zeroline,this.zeroLineColor[p]=v(o.zerolinecolor),this.zeroLineWidth[p]=o.zerolinewidth}},y.hasSharedAxis=function(t){var n=this.scene,o=n.fullLayout._subplots.gl2d;return d.findSubplotsWithAxis(o,t).indexOf(n.id)!==0},y.hasAxisInDfltPos=function(t,n){var o=n.side;return t==="xaxis"?o==="bottom":t==="yaxis"?o==="left":void 0},y.hasAxisInAltrPos=function(t,n){var o=n.side;return t==="xaxis"?o==="top":t==="yaxis"?o==="right":void 0},y.getLabelPad=function(t,n){var o=n.title.font.size,r=n.showticklabels;return t==="xaxis"?n.side==="top"?o*(1.5+(r?1:0))-10:o*(1.5+(r?.5:0))-10:t==="yaxis"?n.side==="right"?10+o*(1.5+(r?1:.5)):10+o*(1.5+(r?.5:0)):void 0},y.getTickPad=function(t){return t.ticks==="outside"?10+t.ticklen:15},y.getTickMarkLength=function(t){if(!t.ticks)return 0;var n=t.ticklen;return t.ticks==="inside"?-n:n},G.exports=function(t){return new w(t)}},{"../../lib/str2rgbarray":540,"../cartesian/axes":566}],605:[function(m,G,Y){var d=m("../../plot_api/edit_types").overrideAll,v=m("./scene2d"),w=m("../layout_attributes"),y=m("../../constants/xmlns_namespaces"),e=m("../cartesian/constants"),t=m("../cartesian"),n=m("../../components/fx/layout_attributes"),o=m("../get_data").getSubplotData;Y.name="gl2d",Y.attr=["xaxis","yaxis"],Y.idRoot=["x","y"],Y.idRegex=e.idRegex,Y.attrRegex=e.attrRegex,Y.attributes=m("../cartesian/attributes"),Y.supplyLayoutDefaults=function(r,g,c){g._has("cartesian")||t.supplyLayoutDefaults(r,g,c)},Y.layoutAttrOverrides=d(t.layoutAttributes,"plot","from-root"),Y.baseLayoutAttrOverrides=d({plot_bgcolor:w.plot_bgcolor,hoverlabel:n.hoverlabel},"plot","nested"),Y.plot=function(r){for(var g=r._fullLayout,c=r._fullData,a=g._subplots.gl2d,h=0;h<a.length;h++){var l=a[h],s=g._plots[l],p=o(c,"gl2d",l),u=s._scene2d;u===void 0&&(u=new v({id:l,graphDiv:r,container:r.querySelector(".gl-container"),staticPlot:r._context.staticPlot,plotGlPixelRatio:r._context.plotGlPixelRatio},g),s._scene2d=u),u.plot(p,r.calcdata,g,r.layout)}},Y.clean=function(r,g,c,a){for(var h=a._subplots.gl2d||[],l=0;l<h.length;l++){var s=h[l],p=a._plots[s];if(p._scene2d){var u=o(r,"gl2d",s);u.length===0&&(p._scene2d.destroy(),delete a._plots[s])}}t.clean.apply(this,arguments)},Y.drawFramework=function(r){r._context.staticPlot||t.drawFramework(r)},Y.toSVG=function(r){for(var g=r._fullLayout,c=g._subplots.gl2d,a=0;a<c.length;a++){var h=g._plots[c[a]]._scene2d,l=h.toImage("png");g._glimages.append("svg:image").attr({xmlns:y.svg,"xlink:href":l,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),h.destroy()}},Y.updateFx=function(r){for(var g=r._fullLayout,c=g._subplots.gl2d,a=0;a<c.length;a++)g._plots[c[a]]._scene2d.updateFx(g.dragmode)}},{"../../components/fx/layout_attributes":408,"../../constants/xmlns_namespaces":492,"../../plot_api/edit_types":548,"../cartesian":578,"../cartesian/attributes":564,"../cartesian/constants":573,"../get_data":602,"../layout_attributes":619,"./scene2d":606}],606:[function(m,G,Y){var d,v,w=m("../../registry"),y=m("../../plots/cartesian/axes"),e=m("../../components/fx"),t=m("../../../stackgl_modules").gl_plot2d,n=m("../../../stackgl_modules").gl_spikes2d,o=m("../../../stackgl_modules").gl_select_box,r=m("webgl-context"),g=m("./convert"),c=m("./camera"),a=m("../../lib/show_no_webgl_msg"),h=m("../cartesian/constraints"),l=h.enforce,s=h.clean,p=m("../cartesian/autorange").doAutoRange,u=m("../../components/dragelement/helpers"),i=u.drawMode,x=u.selectMode,f=["xaxis","yaxis"],_=m("../cartesian/constants").SUBPLOT_PATTERN;function b(k,L){this.container=k.container,this.graphDiv=k.graphDiv,this.pixelRatio=k.plotGlPixelRatio||window.devicePixelRatio,this.id=k.id,this.staticPlot=!!k.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(L),this.makeFramework(),this.stopped||(this.glplotOptions=g(this),this.glplotOptions.merge(L),this.glplot=t(this.glplotOptions),this.camera=c(this),this.traces={},this.spikes=n(this.glplot),this.selectBox=o(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}G.exports=b;var T=b.prototype;T.makeFramework=function(){if(this.staticPlot){if(!(v||(d=document.createElement("canvas"),v=r({canvas:d,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}))))throw new Error("Error creating static canvas/context for image server");this.canvas=d,this.gl=v}else{var k=this.container.querySelector(".gl-canvas-focus"),L=r({canvas:k,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!L)return a(this),void(this.stopped=!0);this.canvas=k,this.gl=L}var A=this.canvas;A.style.width="100%",A.style.height="100%",A.style.position="absolute",A.style.top="0px",A.style.left="0px",A.style["pointer-events"]="none",this.updateSize(A);var I=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");I.style.position="absolute",I.style.top=I.style.left="0px",I.style.width=I.style.height="100%",I.style["z-index"]=20,I.style["pointer-events"]="none";var P=this.mouseContainer=document.createElement("div");P.style.position="absolute",P.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var S=this.container;S.appendChild(I),S.appendChild(P);var E=this;P.addEventListener("mouseout",function(){E.isMouseOver=!1,E.unhover()}),P.addEventListener("mouseover",function(){E.isMouseOver=!0})},T.toImage=function(k){k||(k="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(d),this.updateSize(this.canvas);var L=this.glplot.gl,A=L.drawingBufferWidth,I=L.drawingBufferHeight;L.clearColor(1,1,1,0),L.clear(L.COLOR_BUFFER_BIT|L.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),L.bindFramebuffer(L.FRAMEBUFFER,null);var P=new Uint8Array(A*I*4);L.readPixels(0,0,A,I,L.RGBA,L.UNSIGNED_BYTE,P);for(var S=0,E=I-1;S<E;++S,--E)for(var z=0;z<A;++z)for(var D=0;D<4;++D){var j=P[4*(A*S+z)+D];P[4*(A*S+z)+D]=P[4*(A*E+z)+D],P[4*(A*E+z)+D]=j}var V=document.createElement("canvas");V.width=A,V.height=I;var Z,Q=V.getContext("2d",{willReadFrequently:!0}),X=Q.createImageData(A,I);switch(X.data.set(P),Q.putImageData(X,0,0),k){case"jpeg":Z=V.toDataURL("image/jpeg");break;case"webp":Z=V.toDataURL("image/webp");break;default:Z=V.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(d),Z},T.updateSize=function(k){k||(k=this.canvas);var L=this.pixelRatio,A=this.fullLayout,I=A.width,P=A.height,S=0|Math.ceil(L*I),E=0|Math.ceil(L*P);return k.width===S&&k.height===E||(k.width=S,k.height=E),k},T.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var k=[y.calcTicks(this.xaxis),y.calcTicks(this.yaxis)],L=0;L<2;++L)for(var A=0;A<k[L].length;++A)k[L][A].text=k[L][A].text+"";return k},T.updateRefs=function(k){this.fullLayout=k;var L=this.id.match(_),A="xaxis"+L[1],I="yaxis"+L[2];this.xaxis=this.fullLayout[A],this.yaxis=this.fullLayout[I]},T.relayoutCallback=function(){var k=this.graphDiv,L=this.xaxis,A=this.yaxis,I=k.layout,P={},S=P[L._name+".range"]=L.range.slice(),E=P[A._name+".range"]=A.range.slice();P[L._name+".autorange"]=L.autorange,P[A._name+".autorange"]=A.autorange,w.call("_storeDirectGUIEdit",k.layout,k._fullLayout._preGUI,P);var z=I[L._name];z.range=S,z.autorange=L.autorange;var D=I[A._name];D.range=E,D.autorange=A.autorange,P.lastInputTime=this.camera.lastInputTime,k.emit("plotly_relayout",P)},T.cameraChanged=function(){var k=this.camera;this.glplot.setDataBox(this.calcDataBox());var L=this.computeTickMarks();(function(A,I){for(var P=0;P<2;++P){var S=A[P],E=I[P];if(S.length!==E.length)return!0;for(var z=0;z<S.length;++z)if(S[z].x!==E[z].x)return!0}return!1})(L,this.glplotOptions.ticks)&&(this.glplotOptions.ticks=L,this.glplotOptions.dataBox=k.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},T.handleAnnotations=function(){for(var k=this.graphDiv,L=this.fullLayout.annotations,A=0;A<L.length;A++){var I=L[A];I.xref===this.xaxis._id&&I.yref===this.yaxis._id&&w.getComponentMethod("annotations","drawOne")(k,A)}},T.destroy=function(){if(this.glplot){var k=this.traces;k&&Object.keys(k).map(function(L){k[L].dispose(),delete k[L]}),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},T.plot=function(k,L,A){var I=this.glplot;this.updateRefs(A),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(k,L),this.updateFx(A.dragmode);var P=A.width,S=A.height;this.updateSize(this.canvas);var E=this.glplotOptions;E.merge(A),E.screenBox=[0,0,P,S];var z={_fullLayout:{_axisConstraintGroups:A._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis,_size:A._size}};s(z,this.xaxis),s(z,this.yaxis);var D,j,V=A._size,Z=this.xaxis.domain,Q=this.yaxis.domain;for(E.viewBox=[V.l+Z[0]*V.w,V.b+Q[0]*V.h,P-V.r-(1-Z[1])*V.w,S-V.t-(1-Q[1])*V.h],this.mouseContainer.style.width=V.w*(Z[1]-Z[0])+"px",this.mouseContainer.style.height=V.h*(Q[1]-Q[0])+"px",this.mouseContainer.height=V.h*(Q[1]-Q[0]),this.mouseContainer.style.left=V.l+Z[0]*V.w+"px",this.mouseContainer.style.top=V.t+(1-Q[1])*V.h+"px",j=0;j<2;++j)(D=this[f[j]])._length=E.viewBox[j+2]-E.viewBox[j],p(this.graphDiv,D),D.setScale();l(z),E.ticks=this.computeTickMarks(),E.dataBox=this.calcDataBox(),E.merge(A),I.update(E),this.glplot.draw()},T.calcDataBox=function(){var k=this.xaxis,L=this.yaxis,A=k.range,I=L.range,P=k.r2l,S=L.r2l;return[P(A[0]),S(I[0]),P(A[1]),S(I[1])]},T.setRanges=function(k){var L=this.xaxis,A=this.yaxis,I=L.l2r,P=A.l2r;L.range=[I(k[0]),I(k[2])],A.range=[P(k[1]),P(k[3])]},T.updateTraces=function(k,L){var A,I,P,S=Object.keys(this.traces);this.fullData=k;e:for(A=0;A<S.length;A++){var E=S[A],z=this.traces[E];for(I=0;I<k.length;I++)if((P=k[I]).uid===E&&P.type===z.type)continue e;z.dispose(),delete this.traces[E]}for(A=0;A<k.length;A++){P=k[A];var D=L[A],j=this.traces[P.uid];j?j.update(P,D):(j=P._module.plot(this,P,D),this.traces[P.uid]=j)}this.glplot.objects.sort(function(V,Z){return V._trace.index-Z._trace.index})},T.updateFx=function(k){x(k)||i(k)?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),this.mouseContainer.style.cursor=k==="pan"?"move":k==="zoom"?"crosshair":null},T.emitPointAction=function(k,L){for(var A,I=k.trace.uid,P=k.pointIndex,S=0;S<this.fullData.length;S++)this.fullData[S].uid===I&&(A=this.fullData[S]);var E={x:k.traceCoord[0],y:k.traceCoord[1],curveNumber:A.index,pointNumber:P,data:A._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};e.appendArrayPointValue(E,A,P),this.graphDiv.emit(L,{points:[E]})},T.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var k=this.glplot,L=this.camera,A=L.mouseListener,I=this.lastButtonState===1&&A.buttons===0,P=this.fullLayout;this.lastButtonState=A.buttons,this.cameraChanged();var S,E=A.x*k.pixelRatio,z=this.canvas.height-k.pixelRatio*A.y;if(L.boxEnabled&&P.dragmode==="zoom"){this.selectBox.enabled=!0;for(var D=this.selectBox.selectBox=[Math.min(L.boxStart[0],L.boxEnd[0]),Math.min(L.boxStart[1],L.boxEnd[1]),Math.max(L.boxStart[0],L.boxEnd[0]),Math.max(L.boxStart[1],L.boxEnd[1])],j=0;j<2;j++)L.boxStart[j]===L.boxEnd[j]&&(D[j]=k.dataBox[j],D[j+2]=k.dataBox[j+2]);k.setDirty()}else if(!L.panning&&this.isMouseOver){this.selectBox.enabled=!1;var V=P._size,Z=this.xaxis.domain,Q=this.yaxis.domain,X=(S=k.pick(E/k.pixelRatio+V.l+Z[0]*V.w,z/k.pixelRatio-(V.t+(1-Q[1])*V.h)))&&S.object._trace.handlePick(S);if(X&&I&&this.emitPointAction(X,"plotly_click"),S&&S.object._trace.hoverinfo!=="skip"&&P.hovermode&&X&&(!this.lastPickResult||this.lastPickResult.traceUid!==X.trace.uid||this.lastPickResult.dataCoord[0]!==X.dataCoord[0]||this.lastPickResult.dataCoord[1]!==X.dataCoord[1])){var $=X;this.lastPickResult={traceUid:X.trace?X.trace.uid:null,dataCoord:X.dataCoord.slice()},this.spikes.update({center:S.dataCoord}),$.screenCoord=[((k.viewBox[2]-k.viewBox[0])*(S.dataCoord[0]-k.dataBox[0])/(k.dataBox[2]-k.dataBox[0])+k.viewBox[0])/k.pixelRatio,(this.canvas.height-(k.viewBox[3]-k.viewBox[1])*(S.dataCoord[1]-k.dataBox[1])/(k.dataBox[3]-k.dataBox[1])-k.viewBox[1])/k.pixelRatio],this.emitPointAction(X,"plotly_hover");var re=this.fullData[$.trace.index]||{},H=$.pointIndex,N=e.castHoverinfo(re,P,H);if(N&&N!=="all"){var U=N.split("+");U.indexOf("x")===-1&&($.traceCoord[0]=void 0),U.indexOf("y")===-1&&($.traceCoord[1]=void 0),U.indexOf("z")===-1&&($.traceCoord[2]=void 0),U.indexOf("text")===-1&&($.textLabel=void 0),U.indexOf("name")===-1&&($.name=void 0)}e.loneHover({x:$.screenCoord[0],y:$.screenCoord[1],xLabel:this.hoverFormatter("xaxis",$.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",$.traceCoord[1]),zLabel:$.traceCoord[2],text:$.textLabel,name:$.name,color:e.castHoverOption(re,H,"bgcolor")||$.color,borderColor:e.castHoverOption(re,H,"bordercolor"),fontFamily:e.castHoverOption(re,H,"font.family"),fontSize:e.castHoverOption(re,H,"font.size"),fontColor:e.castHoverOption(re,H,"font.color"),nameLength:e.castHoverOption(re,H,"namelength"),textAlign:e.castHoverOption(re,H,"align")},{container:this.svgContainer,gd:this.graphDiv})}}S||this.unhover(),k.draw()}},T.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),e.loneUnhover(this.svgContainer))},T.hoverFormatter=function(k,L){if(L!==void 0){var A=this[k];return y.tickText(A,A.c2l(L),"hover").text}}},{"../../../stackgl_modules":1133,"../../components/dragelement/helpers":385,"../../components/fx":407,"../../lib/show_no_webgl_msg":537,"../../plots/cartesian/axes":566,"../../registry":647,"../cartesian/autorange":565,"../cartesian/constants":573,"../cartesian/constraints":574,"./camera":603,"./convert":604,"webgl-context":332}],607:[function(m,G,Y){var d=m("../../plot_api/edit_types").overrideAll,v=m("../../components/fx/layout_attributes"),w=m("./scene"),y=m("../get_data").getSubplotData,e=m("../../lib"),t=m("../../constants/xmlns_namespaces");Y.name="gl3d",Y.attr="scene",Y.idRoot="scene",Y.idRegex=Y.attrRegex=e.counterRegex("scene"),Y.attributes=m("./layout/attributes"),Y.layoutAttributes=m("./layout/layout_attributes"),Y.baseLayoutAttrOverrides=d({hoverlabel:v.hoverlabel},"plot","nested"),Y.supplyLayoutDefaults=m("./layout/defaults"),Y.plot=function(n){for(var o=n._fullLayout,r=n._fullData,g=o._subplots.gl3d,c=0;c<g.length;c++){var a=g[c],h=y(r,"gl3d",a),l=o[a],s=l.camera,p=l._scene;p||(p=new w({id:a,graphDiv:n,container:n.querySelector(".gl-container"),staticPlot:n._context.staticPlot,plotGlPixelRatio:n._context.plotGlPixelRatio,camera:s},o),l._scene=p),p.viewInitial||(p.viewInitial={up:{x:s.up.x,y:s.up.y,z:s.up.z},eye:{x:s.eye.x,y:s.eye.y,z:s.eye.z},center:{x:s.center.x,y:s.center.y,z:s.center.z}}),p.plot(h,o,n.layout)}},Y.clean=function(n,o,r,g){for(var c=g._subplots.gl3d||[],a=0;a<c.length;a++){var h=c[a];!o[h]&&g[h]._scene&&(g[h]._scene.destroy(),g._infolayer&&g._infolayer.selectAll(".annotation-"+h).remove())}},Y.toSVG=function(n){for(var o=n._fullLayout,r=o._subplots.gl3d,g=o._size,c=0;c<r.length;c++){var a=o[r[c]],h=a.domain,l=a._scene,s=l.toImage("png");o._glimages.append("svg:image").attr({xmlns:t.svg,"xlink:href":s,x:g.l+g.w*h.x[0],y:g.t+g.h*(1-h.y[1]),width:g.w*(h.x[1]-h.x[0]),height:g.h*(h.y[1]-h.y[0]),preserveAspectRatio:"none"}),l.destroy()}},Y.cleanId=function(n){if(n.match(/^scene[0-9]*$/)){var o=n.substr(5);return o==="1"&&(o=""),"scene"+o}},Y.updateFx=function(n){for(var o=n._fullLayout,r=o._subplots.gl3d,g=0;g<r.length;g++)o[r[g]]._scene.updateFx(o.dragmode,o.hovermode)}},{"../../components/fx/layout_attributes":408,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../plot_api/edit_types":548,"../get_data":602,"./layout/attributes":608,"./layout/defaults":612,"./layout/layout_attributes":613,"./scene":617}],608:[function(m,G,Y){G.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],609:[function(m,G,Y){var d=m("../../../components/color"),v=m("../../cartesian/layout_attributes"),w=m("../../../lib/extend").extendFlat,y=m("../../../plot_api/edit_types").overrideAll;G.exports=y({visible:v.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:d.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:v.color,categoryorder:v.categoryorder,categoryarray:v.categoryarray,title:{text:v.title.text,font:v.title.font},type:w({},v.type,{values:["-","linear","log","date","category"]}),autotypenumbers:v.autotypenumbers,autorange:v.autorange,rangemode:v.rangemode,range:w({},v.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:v.tickmode,nticks:v.nticks,tick0:v.tick0,dtick:v.dtick,tickvals:v.tickvals,ticktext:v.ticktext,ticks:v.ticks,mirror:v.mirror,ticklen:v.ticklen,tickwidth:v.tickwidth,tickcolor:v.tickcolor,showticklabels:v.showticklabels,tickfont:v.tickfont,tickangle:v.tickangle,tickprefix:v.tickprefix,showtickprefix:v.showtickprefix,ticksuffix:v.ticksuffix,showticksuffix:v.showticksuffix,showexponent:v.showexponent,exponentformat:v.exponentformat,minexponent:v.minexponent,separatethousands:v.separatethousands,tickformat:v.tickformat,tickformatstops:v.tickformatstops,hoverformat:v.hoverformat,showline:v.showline,linecolor:v.linecolor,linewidth:v.linewidth,showgrid:v.showgrid,gridcolor:w({},v.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:v.gridwidth,zeroline:v.zeroline,zerolinecolor:v.zerolinecolor,zerolinewidth:v.zerolinewidth,_deprecated:{title:v._deprecated.title,titlefont:v._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":367,"../../../lib/extend":505,"../../../plot_api/edit_types":548,"../../cartesian/layout_attributes":579}],610:[function(m,G,Y){var d=m("tinycolor2").mix,v=m("../../../lib"),w=m("../../../plot_api/plot_template"),y=m("./axis_attributes"),e=m("../../cartesian/type_defaults"),t=m("../../cartesian/axis_defaults"),n=["xaxis","yaxis","zaxis"];G.exports=function(o,r,g){var c,a;function h(p,u){return v.coerce(c,a,y,p,u)}for(var l=0;l<n.length;l++){var s=n[l];c=o[s]||{},(a=w.newContainer(r,s))._id=s[0]+g.scene,a._name=s,e(c,a,h,g),t(c,a,h,{font:g.font,letter:s[0],data:g.data,showGrid:!0,noTickson:!0,noTicklabelmode:!0,noTicklabelstep:!0,noTicklabelposition:!0,noTicklabeloverflow:!0,bgColor:g.bgColor,calendar:g.calendar},g.fullLayout),h("gridcolor",d(a.color,g.bgColor,13600/187).toRgbString()),h("title.text",s[0]),a.setScale=v.noop,h("showspikes")&&(h("spikesides"),h("spikethickness"),h("spikecolor",a.color)),h("showaxeslabels"),h("showbackground")&&h("backgroundcolor")}}},{"../../../lib":515,"../../../plot_api/plot_template":555,"../../cartesian/axis_defaults":568,"../../cartesian/type_defaults":591,"./axis_attributes":609,tinycolor2:313}],611:[function(m,G,Y){var d=m("../../../lib/str2rgbarray"),v=m("../../../lib"),w=["xaxis","yaxis","zaxis"];function y(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}y.prototype.merge=function(e,t){for(var n=0;n<3;++n){var o=t[w[n]];o.visible?(this.labels[n]=e._meta?v.templateString(o.title.text,e._meta):o.title.text,"font"in o.title&&(o.title.font.color&&(this.labelColor[n]=d(o.title.font.color)),o.title.font.family&&(this.labelFont[n]=o.title.font.family),o.title.font.size&&(this.labelSize[n]=o.title.font.size)),"showline"in o&&(this.lineEnable[n]=o.showline),"linecolor"in o&&(this.lineColor[n]=d(o.linecolor)),"linewidth"in o&&(this.lineWidth[n]=o.linewidth),"showgrid"in o&&(this.gridEnable[n]=o.showgrid),"gridcolor"in o&&(this.gridColor[n]=d(o.gridcolor)),"gridwidth"in o&&(this.gridWidth[n]=o.gridwidth),o.type==="log"?this.zeroEnable[n]=!1:"zeroline"in o&&(this.zeroEnable[n]=o.zeroline),"zerolinecolor"in o&&(this.zeroLineColor[n]=d(o.zerolinecolor)),"zerolinewidth"in o&&(this.zeroLineWidth[n]=o.zerolinewidth),"ticks"in o&&o.ticks?this.lineTickEnable[n]=!0:this.lineTickEnable[n]=!1,"ticklen"in o&&(this.lineTickLength[n]=this._defaultLineTickLength[n]=o.ticklen),"tickcolor"in o&&(this.lineTickColor[n]=d(o.tickcolor)),"tickwidth"in o&&(this.lineTickWidth[n]=o.tickwidth),"tickangle"in o&&(this.tickAngle[n]=o.tickangle==="auto"?-3600:Math.PI*-o.tickangle/180),"showticklabels"in o&&(this.tickEnable[n]=o.showticklabels),"tickfont"in o&&(o.tickfont.color&&(this.tickColor[n]=d(o.tickfont.color)),o.tickfont.family&&(this.tickFont[n]=o.tickfont.family),o.tickfont.size&&(this.tickSize[n]=o.tickfont.size)),"mirror"in o?["ticks","all","allticks"].indexOf(o.mirror)!==-1?(this.lineTickMirror[n]=!0,this.lineMirror[n]=!0):o.mirror===!0?(this.lineTickMirror[n]=!1,this.lineMirror[n]=!0):(this.lineTickMirror[n]=!1,this.lineMirror[n]=!1):this.lineMirror[n]=!1,"showbackground"in o&&o.showbackground!==!1?(this.backgroundEnable[n]=!0,this.backgroundColor[n]=d(o.backgroundcolor)):this.backgroundEnable[n]=!1):(this.tickEnable[n]=!1,this.labelEnable[n]=!1,this.lineEnable[n]=!1,this.lineTickEnable[n]=!1,this.gridEnable[n]=!1,this.zeroEnable[n]=!1,this.backgroundEnable[n]=!1)}},G.exports=function(e,t){var n=new y;return n.merge(e,t),n}},{"../../../lib":515,"../../../lib/str2rgbarray":540}],612:[function(m,G,Y){var d=m("../../../lib"),v=m("../../../components/color"),w=m("../../../registry"),y=m("../../subplot_defaults"),e=m("./axis_defaults"),t=m("./layout_attributes"),n=m("../../get_data").getSubplotData;function o(r,g,c,a){for(var h=c("bgcolor"),l=v.combine(h,a.paper_bgcolor),s=["up","center","eye"],p=0;p<s.length;p++)c("camera."+s[p]+".x"),c("camera."+s[p]+".y"),c("camera."+s[p]+".z");c("camera.projection.type");var u=!!c("aspectratio.x")&&!!c("aspectratio.y")&&!!c("aspectratio.z"),i=c("aspectmode",u?"manual":"auto");u||(r.aspectratio=g.aspectratio={x:1,y:1,z:1},i==="manual"&&(g.aspectmode="auto"),r.aspectmode=g.aspectmode);var x=n(a.fullData,"gl3d",a.id);e(r,g,{font:a.font,scene:a.id,data:x,bgColor:l,calendar:a.calendar,autotypenumbersDflt:a.autotypenumbersDflt,fullLayout:a.fullLayout}),w.getComponentMethod("annotations3d","handleDefaults")(r,g,a);var f=a.getDfltFromLayout("dragmode");if(f!==!1&&!f)if(f="orbit",r.camera&&r.camera.up){var _=r.camera.up.x,b=r.camera.up.y,T=r.camera.up.z;T!==0&&(_&&b&&T?T/Math.sqrt(_*_+b*b+T*T)>.999&&(f="turntable"):f="turntable")}else f="turntable";c("dragmode",f),c("hovermode",a.getDfltFromLayout("hovermode"))}G.exports=function(r,g,c){var a=g._basePlotModules.length>1;y(r,g,c,{type:"gl3d",attributes:t,handleDefaults:o,fullLayout:g,font:g.font,fullData:c,getDfltFromLayout:function(h){if(!a)return d.validate(r[h],t[h])?r[h]:void 0},autotypenumbersDflt:g.autotypenumbers,paper_bgcolor:g.paper_bgcolor,calendar:g.calendar})}},{"../../../components/color":367,"../../../lib":515,"../../../registry":647,"../../get_data":602,"../../subplot_defaults":641,"./axis_defaults":610,"./layout_attributes":613}],613:[function(m,G,Y){var d=m("./axis_attributes"),v=m("../../domain").attributes,w=m("../../../lib/extend").extendFlat,y=m("../../../lib").counterRegex;function e(t,n,o){return{x:{valType:"number",dflt:t,editType:"camera"},y:{valType:"number",dflt:n,editType:"camera"},z:{valType:"number",dflt:o,editType:"camera"},editType:"camera"}}G.exports={_arrayAttrRegexps:[y("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:w(e(0,0,1),{}),center:w(e(0,0,0),{}),eye:w(e(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:v({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:d,yaxis:d,zaxis:d,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":515,"../../../lib/extend":505,"../../domain":593,"./axis_attributes":609}],614:[function(m,G,Y){var d=m("../../../lib/str2rgbarray"),v=["xaxis","yaxis","zaxis"];function w(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}w.prototype.merge=function(y){for(var e=0;e<3;++e){var t=y[v[e]];t.visible?(this.enabled[e]=t.showspikes,this.colors[e]=d(t.spikecolor),this.drawSides[e]=t.spikesides,this.lineWidth[e]=t.spikethickness):(this.enabled[e]=!1,this.drawSides[e]=!1)}},G.exports=function(y){var e=new w;return e.merge(y),e}},{"../../../lib/str2rgbarray":540}],615:[function(m,G,Y){G.exports=function(e){for(var t=e.axesOptions,n=e.glplot.axesPixels,o=e.fullSceneLayout,r=[[],[],[]],g=0;g<3;++g){var c=o[w[g]];if(c._length=(n[g].hi-n[g].lo)*n[g].pixelsPerDataUnit/e.dataScale[g],Math.abs(c._length)===1/0||isNaN(c._length))r[g]=[];else{c._input_range=c.range.slice(),c.range[0]=n[g].lo/e.dataScale[g],c.range[1]=n[g].hi/e.dataScale[g],c._m=1/(e.dataScale[g]*n[g].pixelsPerDataUnit),c.range[0]===c.range[1]&&(c.range[0]-=1,c.range[1]+=1);var a=c.tickmode;if(c.tickmode==="auto"){c.tickmode="linear";var h=c.nticks||v.constrain(c._length/40,4,9);d.autoTicks(c,Math.abs(c.range[1]-c.range[0])/h)}for(var l=d.calcTicks(c,{msUTC:!0}),s=0;s<l.length;++s)l[s].x=l[s].x*e.dataScale[g],c.type==="date"&&(l[s].text=l[s].text.replace(/\<br\>/g," "));r[g]=l,c.tickmode=a}}for(t.ticks=r,g=0;g<3;++g)for(y[g]=.5*(e.glplot.bounds[0][g]+e.glplot.bounds[1][g]),s=0;s<2;++s)t.bounds[s][g]=e.glplot.bounds[s][g];e.contourLevels=function(p){for(var u=new Array(3),i=0;i<3;++i){for(var x=p[i],f=new Array(x.length),_=0;_<x.length;++_)f[_]=x[_].x;u[i]=f}return u}(r)};var d=m("../../cartesian/axes"),v=m("../../../lib"),w=["xaxis","yaxis","zaxis"],y=[0,0,0]},{"../../../lib":515,"../../cartesian/axes":566}],616:[function(m,G,Y){function d(v,w){var y,e,t=[0,0,0,0];for(y=0;y<4;++y)for(e=0;e<4;++e)t[e]+=v[4*y+e]*w[y];return t}G.exports=function(v,w){return d(v.projection,d(v.view,d(v.model,[w[0],w[1],w[2],1])))}},{}],617:[function(m,G,Y){var d,v,w=m("../../../stackgl_modules").gl_plot3d,y=w.createCamera,e=w.createScene,t=m("webgl-context"),n=m("has-passive-events"),o=m("../../registry"),r=m("../../lib"),g=r.preserveDrawingBuffer(),c=m("../../plots/cartesian/axes"),a=m("../../components/fx"),h=m("../../lib/str2rgbarray"),l=m("../../lib/show_no_webgl_msg"),s=m("./project"),p=m("./layout/convert"),u=m("./layout/spikes"),i=m("./layout/tick_marks");function x(k,L){var A=document.createElement("div"),I=k.container;this.graphDiv=k.graphDiv;var P=document.createElementNS("http://www.w3.org/2000/svg","svg");P.style.position="absolute",P.style.top=P.style.left="0px",P.style.width=P.style.height="100%",P.style["z-index"]=20,P.style["pointer-events"]="none",A.appendChild(P),this.svgContainer=P,A.id=k.id,A.style.position="absolute",A.style.top=A.style.left="0px",A.style.width=A.style.height="100%",I.appendChild(A),this.fullLayout=L,this.id=k.id||"scene",this.fullSceneLayout=L[this.id],this.plotArgs=[[],{},{}],this.axesOptions=p(L,L[this.id]),this.spikeOptions=u(L[this.id]),this.container=A,this.staticMode=!!k.staticPlot,this.pixelRatio=this.pixelRatio||k.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=o.getComponentMethod("annotations3d","convert"),this.drawAnnotations=o.getComponentMethod("annotations3d","draw"),this.initializeGLPlot()}var f=x.prototype;f.prepareOptions=function(){var k={canvas:this.canvas,gl:this.gl,glOptions:{preserveDrawingBuffer:g,premultipliedAlpha:!0,antialias:!0},container:this.container,axes:this.axesOptions,spikes:this.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:this.camera,pixelRatio:this.pixelRatio};if(this.staticMode){if(!(v||(d=document.createElement("canvas"),v=t({canvas:d,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}))))throw new Error("error creating static canvas/context for image server");k.gl=v,k.canvas=d}return k};var _=!0;f.tryCreatePlot=function(){var k=this.prepareOptions(),L=!0;try{this.glplot=e(k)}catch{if(this.staticMode||!_||g)L=!1;else{r.warn(["webgl setup failed possibly due to","false preserveDrawingBuffer config.","The mobile/tablet device may not be detected by is-mobile module.","Enabling preserveDrawingBuffer in second attempt to create webgl scene..."].join(" "));try{g=k.glOptions.preserveDrawingBuffer=!0,this.glplot=e(k)}catch{g=k.glOptions.preserveDrawingBuffer=!1,L=!1}}}return _=!1,L},f.initializeGLCamera=function(){var k=this.fullSceneLayout.camera,L=k.projection.type==="orthographic";this.camera=y(this.container,{center:[k.center.x,k.center.y,k.center.z],eye:[k.eye.x,k.eye.y,k.eye.z],up:[k.up.x,k.up.y,k.up.z],_ortho:L,zoomMin:.01,zoomMax:100,mode:"orbit"})},f.initializeGLPlot=function(){var k=this;if(k.initializeGLCamera(),!k.tryCreatePlot())return l(k);k.traces={},k.make4thDimension();var L=k.graphDiv,A=L.layout,I=function(){var S={};return k.isCameraChanged(A)&&(S[k.id+".camera"]=k.getCamera()),k.isAspectChanged(A)&&(S[k.id+".aspectratio"]=k.glplot.getAspectratio(),A[k.id].aspectmode!=="manual"&&(k.fullSceneLayout.aspectmode=A[k.id].aspectmode=S[k.id+".aspectmode"]="manual")),S},P=function(S){if(S.fullSceneLayout.dragmode!==!1){var E=I();S.saveLayout(A),S.graphDiv.emit("plotly_relayout",E)}};return k.glplot.canvas&&(k.glplot.canvas.addEventListener("mouseup",function(){P(k)}),k.glplot.canvas.addEventListener("wheel",function(S){if(L._context._scrollZoom.gl3d){if(k.camera._ortho){var E=S.deltaX>S.deltaY?1.1:.9090909090909091,z=k.glplot.getAspectratio();k.glplot.setAspectratio({x:E*z.x,y:E*z.y,z:E*z.z})}P(k)}},!!n&&{passive:!1}),k.glplot.canvas.addEventListener("mousemove",function(){if(k.fullSceneLayout.dragmode!==!1&&k.camera.mouseListener.buttons!==0){var S=I();k.graphDiv.emit("plotly_relayouting",S)}}),k.staticMode||k.glplot.canvas.addEventListener("webglcontextlost",function(S){L&&L.emit&&L.emit("plotly_webglcontextlost",{event:S,layer:k.id})},!1)),k.glplot.oncontextloss=function(){k.recoverContext()},k.glplot.onrender=function(){k.render()},!0},f.render=function(){var k,L=this,A=L.graphDiv,I=L.svgContainer,P=L.container.getBoundingClientRect();A._fullLayout._calcInverseTransform(A);var S=A._fullLayout._invScaleX,E=A._fullLayout._invScaleY,z=P.width*S,D=P.height*E;I.setAttributeNS(null,"viewBox","0 0 "+z+" "+D),I.setAttributeNS(null,"width",z),I.setAttributeNS(null,"height",D),i(L),L.glplot.axes.update(L.axesOptions);for(var j=Object.keys(L.traces),V=null,Z=L.glplot.selection,Q=0;Q<j.length;++Q)(k=L.traces[j[Q]]).data.hoverinfo!=="skip"&&k.handlePick(Z)&&(V=k),k.setContourLevels&&k.setContourLevels();function X(oe,me,ce){var ye=L.fullSceneLayout[oe+"axis"];return ye.type!=="log"&&(me=ye.d2l(me)),c.hoverLabelText(ye,me,ce)}if(V!==null){var $=s(L.glplot.cameraParams,Z.dataCoordinate);k=V.data;var re,H=A._fullData[k.index],N=Z.index,U={xLabel:X("x",Z.traceCoordinate[0],k.xhoverformat),yLabel:X("y",Z.traceCoordinate[1],k.yhoverformat),zLabel:X("z",Z.traceCoordinate[2],k.zhoverformat)},te=a.castHoverinfo(H,L.fullLayout,N),B=(te||"").split("+"),K=te&&te==="all";H.hovertemplate||K||(B.indexOf("x")===-1&&(U.xLabel=void 0),B.indexOf("y")===-1&&(U.yLabel=void 0),B.indexOf("z")===-1&&(U.zLabel=void 0),B.indexOf("text")===-1&&(Z.textLabel=void 0),B.indexOf("name")===-1&&(V.name=void 0));var J=[];k.type==="cone"||k.type==="streamtube"?(U.uLabel=X("x",Z.traceCoordinate[3],k.uhoverformat),(K||B.indexOf("u")!==-1)&&J.push("u: "+U.uLabel),U.vLabel=X("y",Z.traceCoordinate[4],k.vhoverformat),(K||B.indexOf("v")!==-1)&&J.push("v: "+U.vLabel),U.wLabel=X("z",Z.traceCoordinate[5],k.whoverformat),(K||B.indexOf("w")!==-1)&&J.push("w: "+U.wLabel),U.normLabel=Z.traceCoordinate[6].toPrecision(3),(K||B.indexOf("norm")!==-1)&&J.push("norm: "+U.normLabel),k.type==="streamtube"&&(U.divergenceLabel=Z.traceCoordinate[7].toPrecision(3),(K||B.indexOf("divergence")!==-1)&&J.push("divergence: "+U.divergenceLabel)),Z.textLabel&&J.push(Z.textLabel),re=J.join("<br>")):k.type==="isosurface"||k.type==="volume"?(U.valueLabel=c.hoverLabelText(L._mockAxis,L._mockAxis.d2l(Z.traceCoordinate[3]),k.valuehoverformat),J.push("value: "+U.valueLabel),Z.textLabel&&J.push(Z.textLabel),re=J.join("<br>")):re=Z.textLabel;var ee={x:Z.traceCoordinate[0],y:Z.traceCoordinate[1],z:Z.traceCoordinate[2],data:H._input,fullData:H,curveNumber:H.index,pointNumber:N};a.appendArrayPointValue(ee,H,N),k._module.eventData&&(ee=H._module.eventData(ee,Z,H,{},N));var ne={points:[ee]};if(L.fullSceneLayout.hovermode){var se=[];a.loneHover({trace:H,x:(.5+.5*$[0]/$[3])*z,y:(.5-.5*$[1]/$[3])*D,xLabel:U.xLabel,yLabel:U.yLabel,zLabel:U.zLabel,text:re,name:V.name,color:a.castHoverOption(H,N,"bgcolor")||V.color,borderColor:a.castHoverOption(H,N,"bordercolor"),fontFamily:a.castHoverOption(H,N,"font.family"),fontSize:a.castHoverOption(H,N,"font.size"),fontColor:a.castHoverOption(H,N,"font.color"),nameLength:a.castHoverOption(H,N,"namelength"),textAlign:a.castHoverOption(H,N,"align"),hovertemplate:r.castOption(H,N,"hovertemplate"),hovertemplateLabels:r.extendFlat({},ee,U),eventData:[ee]},{container:I,gd:A,inOut_bbox:se}),ee.bbox=se[0]}Z.buttons&&Z.distance<5?A.emit("plotly_click",ne):A.emit("plotly_hover",ne),this.oldEventData=ne}else a.loneUnhover(I),this.oldEventData&&A.emit("plotly_unhover",this.oldEventData),this.oldEventData=void 0;L.drawAnnotations(L)},f.recoverContext=function(){var k=this;k.glplot.dispose();var L=function(){k.glplot.gl.isContextLost()?requestAnimationFrame(L):k.initializeGLPlot()?k.plot.apply(k,k.plotArgs):r.error("Catastrophic and unrecoverable WebGL error. Context lost.")};requestAnimationFrame(L)};var b=["xaxis","yaxis","zaxis"];function T(k,L,A){for(var I=k.fullSceneLayout,P=0;P<3;P++){var S=b[P],E=S.charAt(0),z=I[S],D=L[E],j=L[E+"calendar"],V=L["_"+E+"length"];if(r.isArrayOrTypedArray(D))for(var Z,Q=0;Q<(V||D.length);Q++)if(r.isArrayOrTypedArray(D[Q]))for(var X=0;X<D[Q].length;++X)Z=z.d2l(D[Q][X],0,j),!isNaN(Z)&&isFinite(Z)&&(A[0][P]=Math.min(A[0][P],Z),A[1][P]=Math.max(A[1][P],Z));else Z=z.d2l(D[Q],0,j),!isNaN(Z)&&isFinite(Z)&&(A[0][P]=Math.min(A[0][P],Z),A[1][P]=Math.max(A[1][P],Z));else A[0][P]=Math.min(A[0][P],0),A[1][P]=Math.max(A[1][P],V-1)}}f.plot=function(k,L,A){if(this.plotArgs=[k,L,A],!this.glplot.contextLost){var I,P,S,E,z,D,j=L[this.id],V=A[this.id];this.fullLayout=L,this.fullSceneLayout=j,this.axesOptions.merge(L,j),this.spikeOptions.merge(j),this.setViewport(j),this.updateFx(j.dragmode,j.hovermode),this.camera.enableWheel=this.graphDiv._context._scrollZoom.gl3d,this.glplot.setClearColor(h(j.bgcolor)),this.setConvert(z),k?Array.isArray(k)||(k=[k]):k=[];var Z=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(S=0;S<k.length;++S)(I=k[S]).visible===!0&&I._length!==0&&T(this,I,Z);(function(Me,we){for(var de=Me.fullSceneLayout,Ie=de.annotations||[],De=0;De<3;De++)for(var Oe=b[De],Ve=Oe.charAt(0),Fe=de[Oe],ze=0;ze<Ie.length;ze++){var Re=Ie[ze];if(Re.visible){var We=Fe.r2l(Re[Ve]);!isNaN(We)&&isFinite(We)&&(we[0][De]=Math.min(we[0][De],We),we[1][De]=Math.max(we[1][De],We))}}})(this,Z);var Q=[1,1,1];for(E=0;E<3;++E)Z[1][E]===Z[0][E]?Q[E]=1:Q[E]=1/(Z[1][E]-Z[0][E]);for(this.dataScale=Q,this.convertAnnotations(this),S=0;S<k.length;++S)(I=k[S]).visible===!0&&I._length!==0&&((P=this.traces[I.uid])?P.data.type===I.type?P.update(I):(P.dispose(),P=I._module.plot(this,I),this.traces[I.uid]=P):(P=I._module.plot(this,I),this.traces[I.uid]=P),P.name=I.name);var X=Object.keys(this.traces);e:for(S=0;S<X.length;++S){for(E=0;E<k.length;++E)if(k[E].uid===X[S]&&k[E].visible===!0&&k[E]._length!==0)continue e;(P=this.traces[X[S]]).dispose(),delete this.traces[X[S]]}this.glplot.objects.sort(function(Me,we){return Me._trace.data.index-we._trace.data.index});var $,re=[[0,0,0],[0,0,0]],H=[],N={};for(S=0;S<3;++S){if((D=(z=j[b[S]]).type)in N?(N[D].acc*=Q[S],N[D].count+=1):N[D]={acc:Q[S],count:1},z.autorange){re[0][S]=1/0,re[1][S]=-1/0;var U=this.glplot.objects,te=this.fullSceneLayout.annotations||[],B=z._name.charAt(0);for(E=0;E<U.length;E++){var K=U[E],J=K.bounds,ee=K._trace.data._pad||0;K.constructor.name==="ErrorBars"&&z._lowerLogErrorBound?re[0][S]=Math.min(re[0][S],z._lowerLogErrorBound):re[0][S]=Math.min(re[0][S],J[0][S]/Q[S]-ee),re[1][S]=Math.max(re[1][S],J[1][S]/Q[S]+ee)}for(E=0;E<te.length;E++){var ne=te[E];if(ne.visible){var se=z.r2l(ne[B]);re[0][S]=Math.min(re[0][S],se),re[1][S]=Math.max(re[1][S],se)}}if("rangemode"in z&&z.rangemode==="tozero"&&(re[0][S]=Math.min(re[0][S],0),re[1][S]=Math.max(re[1][S],0)),re[0][S]>re[1][S])re[0][S]=-1,re[1][S]=1;else{var oe=re[1][S]-re[0][S];re[0][S]-=oe/32,re[1][S]+=oe/32}if(z.autorange==="reversed"){var me=re[0][S];re[0][S]=re[1][S],re[1][S]=me}}else{var ce=z.range;re[0][S]=z.r2l(ce[0]),re[1][S]=z.r2l(ce[1])}re[0][S]===re[1][S]&&(re[0][S]-=1,re[1][S]+=1),H[S]=re[1][S]-re[0][S],this.glplot.setBounds(S,{min:re[0][S]*Q[S],max:re[1][S]*Q[S]})}var ye=j.aspectmode;if(ye==="cube")$=[1,1,1];else if(ye==="manual"){var Se=j.aspectratio;$=[Se.x,Se.y,Se.z]}else{if(ye!=="auto"&&ye!=="data")throw new Error("scene.js aspectRatio was not one of the enumerated types");var fe=[1,1,1];for(S=0;S<3;++S){var ge=N[D=(z=j[b[S]]).type];fe[S]=Math.pow(ge.acc,1/ge.count)/Q[S]}$=ye==="data"||Math.max.apply(null,fe)/Math.min.apply(null,fe)<=4?fe:[1,1,1]}j.aspectratio.x=V.aspectratio.x=$[0],j.aspectratio.y=V.aspectratio.y=$[1],j.aspectratio.z=V.aspectratio.z=$[2],this.glplot.setAspectratio(j.aspectratio),this.viewInitial.aspectratio||(this.viewInitial.aspectratio={x:j.aspectratio.x,y:j.aspectratio.y,z:j.aspectratio.z}),this.viewInitial.aspectmode||(this.viewInitial.aspectmode=j.aspectmode);var Te=j.domain||null,le=L._size||null;if(Te&&le){var ve=this.container.style;ve.position="absolute",ve.left=le.l+Te.x[0]*le.w+"px",ve.top=le.t+(1-Te.y[1])*le.h+"px",ve.width=le.w*(Te.x[1]-Te.x[0])+"px",ve.height=le.h*(Te.y[1]-Te.y[0])+"px"}this.glplot.redraw()}},f.destroy=function(){this.glplot&&(this.camera.mouseListener.enabled=!1,this.container.removeEventListener("wheel",this.camera.wheelListener),this.camera=null,this.glplot.dispose(),this.container.parentNode.removeChild(this.container),this.glplot=null)},f.getCamera=function(){var k;return this.camera.view.recalcMatrix(this.camera.view.lastT()),{up:{x:(k=this.camera).up[0],y:k.up[1],z:k.up[2]},center:{x:k.center[0],y:k.center[1],z:k.center[2]},eye:{x:k.eye[0],y:k.eye[1],z:k.eye[2]},projection:{type:k._ortho===!0?"orthographic":"perspective"}}},f.setViewport=function(k){var L,A=k.camera;this.camera.lookAt.apply(this,[[(L=A).eye.x,L.eye.y,L.eye.z],[L.center.x,L.center.y,L.center.z],[L.up.x,L.up.y,L.up.z]]),this.glplot.setAspectratio(k.aspectratio),A.projection.type==="orthographic"!==this.camera._ortho&&(this.glplot.redraw(),this.glplot.clearRGBA(),this.glplot.dispose(),this.initializeGLPlot())},f.isCameraChanged=function(k){var L=this.getCamera(),A=r.nestedProperty(k,this.id+".camera").get();function I(z,D,j,V){var Z=["up","center","eye"],Q=["x","y","z"];return D[Z[j]]&&z[Z[j]][Q[V]]===D[Z[j]][Q[V]]}var P=!1;if(A===void 0)P=!0;else{for(var S=0;S<3;S++)for(var E=0;E<3;E++)if(!I(L,A,S,E)){P=!0;break}(!A.projection||L.projection&&L.projection.type!==A.projection.type)&&(P=!0)}return P},f.isAspectChanged=function(k){var L=this.glplot.getAspectratio(),A=r.nestedProperty(k,this.id+".aspectratio").get();return A===void 0||A.x!==L.x||A.y!==L.y||A.z!==L.z},f.saveLayout=function(k){var L,A,I,P,S,E,z=this.fullLayout,D=this.isCameraChanged(k),j=this.isAspectChanged(k),V=D||j;if(V){var Z={};D&&(L=this.getCamera(),I=(A=r.nestedProperty(k,this.id+".camera")).get(),Z[this.id+".camera"]=I),j&&(P=this.glplot.getAspectratio(),E=(S=r.nestedProperty(k,this.id+".aspectratio")).get(),Z[this.id+".aspectratio"]=E),o.call("_storeDirectGUIEdit",k,z._preGUI,Z),D&&(A.set(L),r.nestedProperty(z,this.id+".camera").set(L)),j&&(S.set(P),r.nestedProperty(z,this.id+".aspectratio").set(P),this.glplot.redraw())}return V},f.updateFx=function(k,L){var A=this.camera;if(A)if(k==="orbit")A.mode="orbit",A.keyBindingMode="rotate";else if(k==="turntable"){A.up=[0,0,1],A.mode="turntable",A.keyBindingMode="rotate";var I=this.graphDiv,P=I._fullLayout,S=this.fullSceneLayout.camera,E=S.up.x,z=S.up.y,D=S.up.z;if(D/Math.sqrt(E*E+z*z+D*D)<.999){var j=this.id+".camera.up",V={x:0,y:0,z:1},Z={};Z[j]=V;var Q=I.layout;o.call("_storeDirectGUIEdit",Q,P._preGUI,Z),S.up=V,r.nestedProperty(Q,j).set(V)}}else A.keyBindingMode=k;this.fullSceneLayout.hovermode=L},f.toImage=function(k){k||(k="png"),this.staticMode&&this.container.appendChild(d),this.glplot.redraw();var L=this.glplot.gl,A=L.drawingBufferWidth,I=L.drawingBufferHeight;L.bindFramebuffer(L.FRAMEBUFFER,null);var P=new Uint8Array(A*I*4);L.readPixels(0,0,A,I,L.RGBA,L.UNSIGNED_BYTE,P),function(j,V,Z){for(var Q=0,X=Z-1;Q<X;++Q,--X)for(var $=0;$<V;++$)for(var re=0;re<4;++re){var H=4*(V*Q+$)+re,N=4*(V*X+$)+re,U=j[H];j[H]=j[N],j[N]=U}}(P,A,I),function(j,V,Z){for(var Q=0;Q<Z;++Q)for(var X=0;X<V;++X){var $=4*(V*Q+X),re=j[$+3];if(re>0)for(var H=255/re,N=0;N<3;++N)j[$+N]=Math.min(H*j[$+N],255)}}(P,A,I);var S=document.createElement("canvas");S.width=A,S.height=I;var E,z=S.getContext("2d",{willReadFrequently:!0}),D=z.createImageData(A,I);switch(D.data.set(P),z.putImageData(D,0,0),k){case"jpeg":E=S.toDataURL("image/jpeg");break;case"webp":E=S.toDataURL("image/webp");break;default:E=S.toDataURL("image/png")}return this.staticMode&&this.container.removeChild(d),E},f.setConvert=function(){for(var k=0;k<3;k++){var L=this.fullSceneLayout[b[k]];c.setConvert(L,this.fullLayout),L.setScale=r.noop}},f.make4thDimension=function(){var k=this.graphDiv._fullLayout;this._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},c.setConvert(this._mockAxis,k)},G.exports=x},{"../../../stackgl_modules":1133,"../../components/fx":407,"../../lib":515,"../../lib/show_no_webgl_msg":537,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566,"../../registry":647,"./layout/convert":611,"./layout/spikes":614,"./layout/tick_marks":615,"./project":616,"has-passive-events":229,"webgl-context":332}],618:[function(m,G,Y){G.exports=function(d,v,w,y){y=y||d.length;for(var e=new Array(y),t=0;t<y;t++)e[t]=[d[t],v[t],w[t]];return e}},{}],619:[function(m,G,Y){var d=m("./font_attributes"),v=m("./animation_attributes"),w=m("../components/color/attributes"),y=m("../components/shapes/draw_newshape/attributes"),e=m("../components/selections/draw_newselection/attributes"),t=m("./pad_attributes"),n=m("../lib/extend").extendFlat,o=d({editType:"calc"});o.family.dflt='"Open Sans", verdana, arial, sans-serif',o.size.dflt=12,o.color.dflt=w.defaultLine,G.exports={font:o,title:{text:{valType:"string",editType:"layoutstyle"},font:d({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:n(t({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[!1,"hide","show"],dflt:!1,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},minreducedwidth:{valType:"number",min:2,dflt:64,editType:"plot"},minreducedheight:{valType:"number",min:2,dflt:64,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:w.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:w.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:w.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},newshape:y.newshape,activeshape:y.activeshape,newselection:e.newselection,activeselection:e.activeselection,meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:n({},v.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:d({editType:"layoutstyle"})}}},{"../components/color/attributes":366,"../components/selections/draw_newselection/attributes":451,"../components/shapes/draw_newshape/attributes":463,"../lib/extend":505,"./animation_attributes":560,"./font_attributes":594,"./pad_attributes":627}],620:[function(m,G,Y){var d=m("../../lib/sort_object_keys"),v='\xA9 <a target="_blank" href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',w=['\xA9 <a target="_blank" href="https://carto.com/">Carto</a>',v].join(" "),y=['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://www.openstreetmap.org/copyright">ODbL</a>'].join(" "),e={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:v,tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:w,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:w,tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:y,tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:y,tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:['Map tiles by <a target="_blank" href="https://stamen.com">Stamen Design</a>','under <a target="_blank" href="https://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>',"|",'Data by <a target="_blank" href="https://openstreetmap.org">OpenStreetMap</a> contributors','under <a target="_blank" href="https://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>'].join(" "),tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},t=d(e);G.exports={requiredVersion:"1.10.1",styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:e,styleValuesNonMapbox:t,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@1.10.1."].join(`
`),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.newPlot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join(`
`),missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",t.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join(`
`),multipleTokensErrorMsg:["Set multiple mapbox access token across different mapbox subplot,","using first token found as mapbox-gl does not allow multipleaccess tokens on the same page."].join(`
`),mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":`content: ""; cursor: pointer; position: absolute; background-image: url('data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;`,"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":`display:block; width: 21px; height: 21px; background-image: url('data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E')`}}},{"../../lib/sort_object_keys":538}],621:[function(m,G,Y){var d=m("../../lib");G.exports=function(v,w){var y=v.split(" "),e=y[0],t=y[1],n=d.isArrayOrTypedArray(w)?d.mean(w):w,o=.5+n/100,r=1.5+n/100,g=["",""],c=[0,0];switch(e){case"top":g[0]="top",c[1]=-r;break;case"bottom":g[0]="bottom",c[1]=r}switch(t){case"left":g[1]="right",c[0]=-o;break;case"right":g[1]="left",c[0]=o}return{anchor:g[0]&&g[1]?g.join("-"):g[0]?g[0]:g[1]?g[1]:"center",offset:c}}},{"../../lib":515}],622:[function(m,G,Y){var d=m("mapbox-gl/dist/mapbox-gl-unminified"),v=m("../../lib"),w=v.strTranslate,y=v.strScale,e=m("../../plots/get_data").getSubplotCalcData,t=m("../../constants/xmlns_namespaces"),n=m("@plotly/d3"),o=m("../../components/drawing"),r=m("../../lib/svg_text_utils"),g=m("./mapbox"),c=Y.constants=m("./constants");function a(h){return typeof h=="string"&&(c.styleValuesMapbox.indexOf(h)!==-1||h.indexOf("mapbox://")===0)}Y.name="mapbox",Y.attr="subplot",Y.idRoot="mapbox",Y.idRegex=Y.attrRegex=v.counterRegex("mapbox"),Y.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},Y.layoutAttributes=m("./layout_attributes"),Y.supplyLayoutDefaults=m("./layout_defaults"),Y.plot=function(h){var l=h._fullLayout,s=h.calcdata,p=l._subplots.mapbox;if(d.version!==c.requiredVersion)throw new Error(c.wrongVersionErrorMsg);var u=function(T,k){var L=T._fullLayout;if(T._context.mapboxAccessToken==="")return"";for(var A=[],I=[],P=!1,S=!1,E=0;E<k.length;E++){var z=L[k[E]],D=z.accesstoken;a(z.style)&&(D?v.pushUnique(A,D):(a(z._input.style)&&(v.error("Uses Mapbox map style, but did not set an access token."),P=!0),S=!0)),D&&v.pushUnique(I,D)}if(S){var j=P?c.noAccessTokenErrorMsg:c.missingStyleErrorMsg;throw v.error(j),new Error(j)}return A.length?(A.length>1&&v.warn(c.multipleTokensErrorMsg),A[0]):(I.length&&v.log(["Listed mapbox access token(s)",I.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}(h,p);d.accessToken=u;for(var i=0;i<p.length;i++){var x=p[i],f=e(s,"mapbox",x),_=l[x],b=_._subplot;b||(b=new g(h,x),l[x]._subplot=b),b.viewInitial||(b.viewInitial={center:v.extendFlat({},_.center),zoom:_.zoom,bearing:_.bearing,pitch:_.pitch}),b.plot(f,l,h._promises)}},Y.clean=function(h,l,s,p){for(var u=p._subplots.mapbox||[],i=0;i<u.length;i++){var x=u[i];!l[x]&&p[x]._subplot&&p[x]._subplot.destroy()}},Y.toSVG=function(h){for(var l=h._fullLayout,s=l._subplots.mapbox,p=l._size,u=0;u<s.length;u++){var i=l[s[u]],x=i.domain,f=i._subplot.toImage("png");l._glimages.append("svg:image").attr({xmlns:t.svg,"xlink:href":f,x:p.l+p.w*x.x[0],y:p.t+p.h*(1-x.y[1]),width:p.w*(x.x[1]-x.x[0]),height:p.h*(x.y[1]-x.y[0]),preserveAspectRatio:"none"});var _=n.select(i._subplot.div);if(_.select(".mapboxgl-ctrl-logo").node().offsetParent!==null){var b=l._glimages.append("g");b.attr("transform",w(p.l+p.w*x.x[0]+10,p.t+p.h*(1-x.y[0])-31)),b.append("path").attr("d",c.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),b.append("path").attr("d",c.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),b.append("path").attr("d",c.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),b.append("polygon").attr("points",c.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var T=_.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),k=l._glimages.append("g"),L=k.append("text");L.text(T).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":T});var A=o.bBox(L.node()),I=p.w*(x.x[1]-x.x[0]);if(A.width>I/2){var P=T.split("|").join("<br>");L.text(P).attr("data-unformatted",P).call(r.convertToTspans,h),A=o.bBox(L.node())}L.attr("transform",w(-3,8-A.height)),k.insert("rect",".static-attribution").attr({x:-A.width-6,y:-A.height-3,width:A.width+6,height:A.height+3,fill:"rgba(255, 255, 255, 0.75)"});var S=1;A.width+6>I&&(S=I/(A.width+6));var E=[p.l+p.w*x.x[1],p.t+p.h*(1-x.y[0])];k.attr("transform",w(E[0],E[1])+y(S))}},Y.updateFx=function(h){for(var l=h._fullLayout,s=l._subplots.mapbox,p=0;p<s.length;p++)l[s[p]]._subplot.updateFx(l)}},{"../../components/drawing":389,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/get_data":602,"./constants":620,"./layout_attributes":624,"./layout_defaults":625,"./mapbox":626,"@plotly/d3":58,"mapbox-gl/dist/mapbox-gl-unminified":239}],623:[function(m,G,Y){var d=m("../../lib"),v=m("../../lib/svg_text_utils").sanitizeHTML,w=m("./convert_text_opts"),y=m("./constants");function e(r,g){this.subplot=r,this.uid=r.uid+"-"+g,this.index=g,this.idSource="source-"+this.uid,this.idLayer=y.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}var t=e.prototype;function n(r){if(!r.visible)return!1;var g=r.source;if(Array.isArray(g)&&g.length>0){for(var c=0;c<g.length;c++)if(typeof g[c]!="string"||g[c].length===0)return!1;return!0}return d.isPlainObject(g)||typeof g=="string"&&g.length>0}function o(r){var g={},c={};switch(r.type){case"circle":d.extendFlat(c,{"circle-radius":r.circle.radius,"circle-color":r.color,"circle-opacity":r.opacity});break;case"line":d.extendFlat(c,{"line-width":r.line.width,"line-color":r.color,"line-opacity":r.opacity,"line-dasharray":r.line.dash});break;case"fill":d.extendFlat(c,{"fill-color":r.color,"fill-outline-color":r.fill.outlinecolor,"fill-opacity":r.opacity});break;case"symbol":var a=r.symbol,h=w(a.textposition,a.iconsize);d.extendFlat(g,{"icon-image":a.icon+"-15","icon-size":a.iconsize/10,"text-field":a.text,"text-size":a.textfont.size,"text-anchor":h.anchor,"text-offset":h.offset,"symbol-placement":a.placement}),d.extendFlat(c,{"icon-color":r.color,"text-color":a.textfont.color,"text-opacity":r.opacity});break;case"raster":d.extendFlat(c,{"raster-fade-duration":0,"raster-opacity":r.opacity})}return{layout:g,paint:c}}t.update=function(r){this.visible?this.needsNewImage(r)?this.updateImage(r):this.needsNewSource(r)?(this.removeLayer(),this.updateSource(r),this.updateLayer(r)):this.needsNewLayer(r)?this.updateLayer(r):this.updateStyle(r):(this.updateSource(r),this.updateLayer(r)),this.visible=n(r)},t.needsNewImage=function(r){return this.subplot.map.getSource(this.idSource)&&this.sourceType==="image"&&r.sourcetype==="image"&&(this.source!==r.source||JSON.stringify(this.coordinates)!==JSON.stringify(r.coordinates))},t.needsNewSource=function(r){return this.sourceType!==r.sourcetype||JSON.stringify(this.source)!==JSON.stringify(r.source)||this.layerType!==r.type},t.needsNewLayer=function(r){return this.layerType!==r.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},t.lookupBelow=function(){return this.subplot.belowLookup["layout-"+this.index]},t.updateImage=function(r){this.subplot.map.getSource(this.idSource).updateImage({url:r.source,coordinates:r.coordinates});var g=this.findFollowingMapboxLayerId(this.lookupBelow());g!==null&&this.subplot.map.moveLayer(this.idLayer,g)},t.updateSource=function(r){var g=this.subplot.map;if(g.getSource(this.idSource)&&g.removeSource(this.idSource),this.sourceType=r.sourcetype,this.source=r.source,n(r)){var c=function(a){var h,l=a.sourcetype,s=a.source,p={type:l};return l==="geojson"?h="data":l==="vector"?h=typeof s=="string"?"url":"tiles":l==="raster"?(h="tiles",p.tileSize=256):l==="image"&&(h="url",p.coordinates=a.coordinates),p[h]=s,a.sourceattribution&&(p.attribution=v(a.sourceattribution)),p}(r);g.addSource(this.idSource,c)}},t.findFollowingMapboxLayerId=function(r){if(r==="traces")for(var g=this.subplot.getMapLayers(),c=0;c<g.length;c++){var a=g[c].id;if(typeof a=="string"&&a.indexOf(y.traceLayerPrefix)===0){r=a;break}}return r},t.updateLayer=function(r){var g=this.subplot,c=o(r),a=this.lookupBelow(),h=this.findFollowingMapboxLayerId(a);this.removeLayer(),n(r)&&g.addLayer({id:this.idLayer,source:this.idSource,"source-layer":r.sourcelayer||"",type:r.type,minzoom:r.minzoom,maxzoom:r.maxzoom,layout:c.layout,paint:c.paint},h),this.layerType=r.type,this.below=a},t.updateStyle=function(r){if(n(r)){var g=o(r);this.subplot.setOptions(this.idLayer,"setLayoutProperty",g.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",g.paint)}},t.removeLayer=function(){var r=this.subplot.map;r.getLayer(this.idLayer)&&r.removeLayer(this.idLayer)},t.dispose=function(){var r=this.subplot.map;r.getLayer(this.idLayer)&&r.removeLayer(this.idLayer),r.getSource(this.idSource)&&r.removeSource(this.idSource)},G.exports=function(r,g,c){var a=new e(r,g);return a.update(c),a}},{"../../lib":515,"../../lib/svg_text_utils":541,"./constants":620,"./convert_text_opts":621}],624:[function(m,G,Y){var d=m("../../lib"),v=m("../../components/color").defaultLine,w=m("../domain").attributes,y=m("../font_attributes"),e=m("../../traces/scatter/attributes").textposition,t=m("../../plot_api/edit_types").overrideAll,n=m("../../plot_api/plot_template").templatedArray,o=m("./constants"),r=y({});r.family.dflt="Open Sans Regular, Arial Unicode MS Regular",(G.exports=t({_arrayAttrRegexps:[d.counterRegex("mapbox",".layers",!0)],domain:w({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:o.styleValuesMapbox.concat(o.styleValuesNonMapbox),dflt:o.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},bounds:{west:{valType:"number"},east:{valType:"number"},south:{valType:"number"},north:{valType:"number"}},layers:n("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:v},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:v}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:r,textposition:d.extendFlat({},e,{arrayOk:!1})}})},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color":367,"../../lib":515,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../traces/scatter/attributes":936,"../domain":593,"../font_attributes":594,"./constants":620}],625:[function(m,G,Y){var d=m("../../lib"),v=m("../subplot_defaults"),w=m("../array_container_defaults"),y=m("./layout_attributes");function e(n,o,r,g){r("accesstoken",g.accessToken),r("style"),r("center.lon"),r("center.lat"),r("zoom"),r("bearing"),r("pitch");var c=r("bounds.west"),a=r("bounds.east"),h=r("bounds.south"),l=r("bounds.north");c!==void 0&&a!==void 0&&h!==void 0&&l!==void 0||delete o.bounds,w(n,o,{name:"layers",handleItemDefaults:t}),o._input=n}function t(n,o){function r(l,s){return d.coerce(n,o,y.layers,l,s)}if(r("visible")){var g,c=r("sourcetype"),a=c==="raster"||c==="image";r("source"),r("sourceattribution"),c==="vector"&&r("sourcelayer"),c==="image"&&r("coordinates"),a&&(g="raster");var h=r("type",g);a&&h!=="raster"&&(h=o.type="raster",d.log("Source types *raster* and *image* must drawn *raster* layer type.")),r("below"),r("color"),r("opacity"),r("minzoom"),r("maxzoom"),h==="circle"&&r("circle.radius"),h==="line"&&(r("line.width"),r("line.dash")),h==="fill"&&r("fill.outlinecolor"),h==="symbol"&&(r("symbol.icon"),r("symbol.iconsize"),r("symbol.text"),d.coerceFont(r,"symbol.textfont"),r("symbol.textposition"),r("symbol.placement"))}}G.exports=function(n,o,r){v(n,o,r,{type:"mapbox",attributes:y,handleDefaults:e,partition:"y",accessToken:o._mapboxAccessToken})}},{"../../lib":515,"../array_container_defaults":561,"../subplot_defaults":641,"./layout_attributes":624}],626:[function(m,G,Y){var d=m("mapbox-gl/dist/mapbox-gl-unminified"),v=m("../../lib"),w=m("../../lib/geo_location_utils"),y=m("../../registry"),e=m("../cartesian/axes"),t=m("../../components/dragelement"),n=m("../../components/fx"),o=m("../../components/dragelement/helpers"),r=o.drawMode,g=o.selectMode,c=m("../../components/selections").prepSelect,a=m("../../components/selections").clearOutline,h=m("../../components/selections").clearSelectionsCache,l=m("../../components/selections").selectOnClick,s=m("./constants"),p=m("./layers");function u(T,k){this.id=k,this.gd=T;var L=T._fullLayout,A=T._context;this.container=L._glcontainer.node(),this.isStatic=A.staticPlot,this.uid=L._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(L),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={},this.dragging=!1,this.wheeling=!1}var i=u.prototype;i.plot=function(T,k,L){var A,I=this,P=k[I.id];I.map&&P.accesstoken!==I.accessToken&&(I.map.remove(),I.map=null,I.styleObj=null,I.traceHash={},I.layerList=[]),A=I.map?new Promise(function(S,E){I.updateMap(T,k,S,E)}):new Promise(function(S,E){I.createMap(T,k,S,E)}),L.push(A)},i.createMap=function(T,k,L,A){var I=this,P=k[I.id],S=I.styleObj=f(P.style);I.accessToken=P.accesstoken;var E=P.bounds,z=E?[[E.west,E.south],[E.east,E.north]]:null,D=I.map=new d.Map({container:I.div,style:S.style,center:b(P.center),zoom:P.zoom,bearing:P.bearing,pitch:P.pitch,maxBounds:z,interactive:!I.isStatic,preserveDrawingBuffer:I.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new d.AttributionControl({compact:!0}));D._canvas.style.left="0px",D._canvas.style.top="0px",I.rejectOnError(A),I.isStatic||I.initFx(T,k);var j=[];j.push(new Promise(function(V){D.once("load",V)})),j=j.concat(w.fetchTraceGeoData(T)),Promise.all(j).then(function(){I.fillBelowLookup(T,k),I.updateData(T),I.updateLayout(k),I.resolveOnRender(L)}).catch(A)},i.updateMap=function(T,k,L,A){var I=this,P=I.map,S=k[this.id];I.rejectOnError(A);var E=[],z=f(S.style);JSON.stringify(I.styleObj)!==JSON.stringify(z)&&(I.styleObj=z,P.setStyle(z.style),I.traceHash={},E.push(new Promise(function(D){P.once("styledata",D)}))),E=E.concat(w.fetchTraceGeoData(T)),Promise.all(E).then(function(){I.fillBelowLookup(T,k),I.updateData(T),I.updateLayout(k),I.resolveOnRender(L)}).catch(A)},i.fillBelowLookup=function(T,k){var L,A,I=k[this.id].layers,P=this.belowLookup={},S=!1;for(L=0;L<T.length;L++){var E=T[L][0].trace,z=E._module;typeof E.below=="string"?A=E.below:z.getBelow&&(A=z.getBelow(E,this)),A===""&&(S=!0),P["trace-"+E.uid]=A||""}for(L=0;L<I.length;L++){var D=I[L];A=typeof D.below=="string"?D.below:S?"traces":"",P["layout-"+L]=A}var j,V,Z={};for(j in P)Z[A=P[j]]?Z[A].push(j):Z[A]=[j];for(A in Z){var Q=Z[A];if(Q.length>1)for(L=0;L<Q.length;L++)(j=Q[L]).indexOf("trace-")===0?(V=j.split("trace-")[1],this.traceHash[V]&&(this.traceHash[V].below=null)):j.indexOf("layout-")===0&&(V=j.split("layout-")[1],this.layerList[V]&&(this.layerList[V].below=null))}};var x={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};function f(T){var k={};return v.isPlainObject(T)?(k.id=T.id,k.style=T):typeof T=="string"?(k.id=T,s.styleValuesMapbox.indexOf(T)!==-1?k.style=_(T):s.stylesNonMapbox[T]?k.style=s.stylesNonMapbox[T]:k.style=T):(k.id=s.styleValueDflt,k.style=_(s.styleValueDflt)),k.transition={duration:0,delay:0},k}function _(T){return s.styleUrlPrefix+T+"-"+s.styleUrlSuffix}function b(T){return[T.lon,T.lat]}i.updateData=function(T){var k,L,A,I,P=this.traceHash,S=T.slice().sort(function(V,Z){return x[V[0].trace.type]-x[Z[0].trace.type]});for(A=0;A<S.length;A++){var E=S[A],z=!1;(k=P[(L=E[0].trace).uid])&&(k.type===L.type?(k.update(E),z=!0):k.dispose()),!z&&L._module&&(P[L.uid]=L._module.plot(this,E))}var D=Object.keys(P);e:for(A=0;A<D.length;A++){var j=D[A];for(I=0;I<T.length;I++)if(j===(L=T[I][0].trace).uid)continue e;(k=P[j]).dispose(),delete P[j]}},i.updateLayout=function(T){var k=this.map,L=T[this.id];this.dragging||this.wheeling||(k.setCenter(b(L.center)),k.setZoom(L.zoom),k.setBearing(L.bearing),k.setPitch(L.pitch)),this.updateLayers(T),this.updateFramework(T),this.updateFx(T),this.map.resize(),this.gd._context._scrollZoom.mapbox?k.scrollZoom.enable():k.scrollZoom.disable()},i.resolveOnRender=function(T){var k=this.map;k.on("render",function L(){k.loaded()&&(k.off("render",L),setTimeout(T,10))})},i.rejectOnError=function(T){var k=this.map;function L(){T(new Error(s.mapOnErrorMsg))}k.once("error",L),k.once("style.error",L),k.once("source.error",L),k.once("tile.error",L),k.once("layer.error",L)},i.createFramework=function(T){var k=this,L=k.div=document.createElement("div");L.id=k.uid,L.style.position="absolute",k.container.appendChild(L),k.xaxis={_id:"x",c2p:function(A){return k.project(A).x}},k.yaxis={_id:"y",c2p:function(A){return k.project(A).y}},k.updateFramework(T),k.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},e.setConvert(k.mockAxis,T)},i.initFx=function(T,k){var L=this,A=L.gd,I=L.map;function P(){n.loneUnhover(k._hoverlayer)}function S(){var E=L.getView();A.emit("plotly_relayouting",L.getViewEditsWithDerived(E))}I.on("moveend",function(E){if(L.map){var z=A._fullLayout;if(E.originalEvent||L.wheeling){var D=z[L.id];y.call("_storeDirectGUIEdit",A.layout,z._preGUI,L.getViewEdits(D));var j=L.getView();D._input.center=D.center=j.center,D._input.zoom=D.zoom=j.zoom,D._input.bearing=D.bearing=j.bearing,D._input.pitch=D.pitch=j.pitch,A.emit("plotly_relayout",L.getViewEditsWithDerived(j))}E.originalEvent&&E.originalEvent.type==="mouseup"?L.dragging=!1:L.wheeling&&(L.wheeling=!1),z._rehover&&z._rehover()}}),I.on("wheel",function(){L.wheeling=!0}),I.on("mousemove",function(E){var z=L.div.getBoundingClientRect(),D=[E.originalEvent.offsetX,E.originalEvent.offsetY];E.target.getBoundingClientRect=function(){return z},L.xaxis.p2c=function(){return I.unproject(D).lng},L.yaxis.p2c=function(){return I.unproject(D).lat},A._fullLayout._rehover=function(){A._fullLayout._hoversubplot===L.id&&A._fullLayout[L.id]&&n.hover(A,E,L.id)},n.hover(A,E,L.id),A._fullLayout._hoversubplot=L.id}),I.on("dragstart",function(){L.dragging=!0,P()}),I.on("zoomstart",P),I.on("mouseout",function(){A._fullLayout._hoversubplot=null}),I.on("drag",S),I.on("zoom",S),I.on("dblclick",function(){var E=A._fullLayout[L.id];y.call("_storeDirectGUIEdit",A.layout,A._fullLayout._preGUI,L.getViewEdits(E));var z=L.viewInitial;I.setCenter(b(z.center)),I.setZoom(z.zoom),I.setBearing(z.bearing),I.setPitch(z.pitch);var D=L.getView();E._input.center=E.center=D.center,E._input.zoom=E.zoom=D.zoom,E._input.bearing=E.bearing=D.bearing,E._input.pitch=E.pitch=D.pitch,A.emit("plotly_doubleclick",null),A.emit("plotly_relayout",L.getViewEditsWithDerived(D))}),L.clearOutline=function(){h(L.dragOptions),a(L.dragOptions.gd)},L.onClickInPanFn=function(E){return function(z){var D=A._fullLayout.clickmode;D.indexOf("select")>-1&&l(z.originalEvent,A,[L.xaxis],[L.yaxis],L.id,E),D.indexOf("event")>-1&&n.click(A,z.originalEvent)}}},i.updateFx=function(T){var k=this,L=k.map,A=k.gd;if(!k.isStatic){var I,P=T.dragmode;I=function(z,D){D.isRect?(z.range={})[k.id]=[E([D.xmin,D.ymin]),E([D.xmax,D.ymax])]:(z.lassoPoints={})[k.id]=D.map(E)};var S=k.dragOptions;k.dragOptions=v.extendDeep(S||{},{dragmode:T.dragmode,element:k.div,gd:A,plotinfo:{id:k.id,domain:T[k.id].domain,xaxis:k.xaxis,yaxis:k.yaxis,fillRangeItems:I},xaxes:[k.xaxis],yaxes:[k.yaxis],subplot:k.id}),L.off("click",k.onClickInPanHandler),g(P)||r(P)?(L.dragPan.disable(),L.on("zoomstart",k.clearSelect),k.dragOptions.prepFn=function(z,D,j){c(z,D,j,k.dragOptions,P)},t.init(k.dragOptions)):(L.dragPan.enable(),L.off("zoomstart",k.clearSelect),k.div.onmousedown=null,k.div.ontouchstart=null,k.div.removeEventListener("touchstart",k.div._ontouchstart),k.onClickInPanHandler=k.onClickInPanFn(k.dragOptions),L.on("click",k.onClickInPanHandler))}function E(z){var D=k.map.unproject(z);return[D.lng,D.lat]}},i.updateFramework=function(T){var k=T[this.id].domain,L=T._size,A=this.div.style;A.width=L.w*(k.x[1]-k.x[0])+"px",A.height=L.h*(k.y[1]-k.y[0])+"px",A.left=L.l+k.x[0]*L.w+"px",A.top=L.t+(1-k.y[1])*L.h+"px",this.xaxis._offset=L.l+k.x[0]*L.w,this.xaxis._length=L.w*(k.x[1]-k.x[0]),this.yaxis._offset=L.t+(1-k.y[1])*L.h,this.yaxis._length=L.h*(k.y[1]-k.y[0])},i.updateLayers=function(T){var k,L=T[this.id].layers,A=this.layerList;if(L.length!==A.length){for(k=0;k<A.length;k++)A[k].dispose();for(A=this.layerList=[],k=0;k<L.length;k++)A.push(p(this,k,L[k]))}else for(k=0;k<L.length;k++)A[k].update(L[k])},i.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},i.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},i.setOptions=function(T,k,L){for(var A in L)this.map[k](T,A,L[A])},i.getMapLayers=function(){return this.map.getStyle().layers},i.addLayer=function(T,k){var L=this.map;if(typeof k=="string"){if(k==="")return void L.addLayer(T,k);for(var A=this.getMapLayers(),I=0;I<A.length;I++)if(k===A[I].id)return void L.addLayer(T,k);v.warn(["Trying to add layer with *below* value",k,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}L.addLayer(T)},i.project=function(T){return this.map.project(new d.LngLat(T[0],T[1]))},i.getView=function(){var T=this.map,k=T.getCenter(),L={lon:k.lng,lat:k.lat},A=T.getCanvas(),I=parseInt(A.style.width),P=parseInt(A.style.height);return{center:L,zoom:T.getZoom(),bearing:T.getBearing(),pitch:T.getPitch(),_derived:{coordinates:[T.unproject([0,0]).toArray(),T.unproject([I,0]).toArray(),T.unproject([I,P]).toArray(),T.unproject([0,P]).toArray()]}}},i.getViewEdits=function(T){for(var k=this.id,L=["center","zoom","bearing","pitch"],A={},I=0;I<L.length;I++){var P=L[I];A[k+"."+P]=T[P]}return A},i.getViewEditsWithDerived=function(T){var k=this.id,L=this.getViewEdits(T);return L[k+"._derived"]=T._derived,L},G.exports=u},{"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/fx":407,"../../components/selections":455,"../../lib":515,"../../lib/geo_location_utils":508,"../../registry":647,"../cartesian/axes":566,"./constants":620,"./layers":623,"mapbox-gl/dist/mapbox-gl-unminified":239}],627:[function(m,G,Y){G.exports=function(d){var v=d.editType;return{t:{valType:"number",dflt:0,editType:v},r:{valType:"number",dflt:0,editType:v},b:{valType:"number",dflt:0,editType:v},l:{valType:"number",dflt:0,editType:v},editType:v}}},{}],628:[function(m,G,Y){var d=m("@plotly/d3"),v=m("d3-time-format").timeFormatLocale,w=m("d3-format").formatLocale,y=m("fast-isnumeric"),e=m("../registry"),t=m("../plot_api/plot_schema"),n=m("../plot_api/plot_template"),o=m("../lib"),r=m("../components/color"),g=m("../constants/numerical").BADNUM,c=m("./cartesian/axis_ids"),a=m("../components/shapes/handle_outline").clearOutline,h=m("./animation_attributes"),l=m("./frame_attributes"),s=m("../plots/get_data").getModuleCalcData,p=o.relinkPrivateKeys,u=o._,i=G.exports={};o.extendFlat(i,e),i.attributes=m("./attributes"),i.attributes.type.values=i.allTypes,i.fontAttrs=m("./font_attributes"),i.layoutAttributes=m("./layout_attributes"),i.fontWeight="normal";var x=i.transformsRegistry,f=m("./command");i.executeAPICommand=f.executeAPICommand,i.computeAPICommandBindings=f.computeAPICommandBindings,i.manageCommandObserver=f.manageCommandObserver,i.hasSimpleAPICommandBindings=f.hasSimpleAPICommandBindings,i.redrawText=function(V){return V=o.getGraphDiv(V),new Promise(function(Z){setTimeout(function(){V._fullLayout&&(e.getComponentMethod("annotations","draw")(V),e.getComponentMethod("legend","draw")(V),e.getComponentMethod("colorbar","draw")(V),Z(i.previousPromises(V)))},300)})},i.resize=function(V){var Z;V=o.getGraphDiv(V);var Q=new Promise(function(X,$){V&&!o.isHidden(V)||$(new Error("Resize must be passed a displayed plot div element.")),V._redrawTimer&&clearTimeout(V._redrawTimer),V._resolveResize&&(Z=V._resolveResize),V._resolveResize=X,V._redrawTimer=setTimeout(function(){if(!V.layout||V.layout.width&&V.layout.height||o.isHidden(V))X(V);else{delete V.layout.width,delete V.layout.height;var re=V.changed;V.autoplay=!0,e.call("relayout",V,{autosize:!0}).then(function(){V.changed=re,V._resolveResize===X&&(delete V._resolveResize,X(V))})}},100)});return Z&&Z(Q),Q},i.previousPromises=function(V){if((V._promises||[]).length)return Promise.all(V._promises).then(function(){V._promises=[]})},i.addLinks=function(V){if(V._context.showLink||V._context.showSources){var Z=V._fullLayout,Q=o.ensureSingle(Z._paper,"text","js-plot-link-container",function(U){U.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:r.defaultLine,"pointer-events":"all"}).each(function(){var te=d.select(this);te.append("tspan").classed("js-link-to-tool",!0),te.append("tspan").classed("js-link-spacer",!0),te.append("tspan").classed("js-sourcelinks",!0)})}),X=Q.node(),$={y:Z._paper.attr("height")-9};document.body.contains(X)&&X.getComputedTextLength()>=Z.width-20?($["text-anchor"]="start",$.x=5):($["text-anchor"]="end",$.x=Z._paper.attr("width")-7),Q.attr($);var re=Q.select(".js-link-to-tool"),H=Q.select(".js-link-spacer"),N=Q.select(".js-sourcelinks");V._context.showSources&&V._context.showSources(V),V._context.showLink&&function(U,te){te.text("");var B=te.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(U._context.linkText+" "+String.fromCharCode(187));if(U._context.sendData)B.on("click",function(){i.sendDataToCloud(U)});else{var K=window.location.pathname.split("/"),J=window.location.search;B.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+K[2].split(".")[0]+"/"+K[1]+J})}}(V,re),H.text(re.text()&&N.text()?" - ":"")}},i.sendDataToCloud=function(V){var Z=(window.PLOTLYENV||{}).BASE_URL||V._context.plotlyServerURL;if(Z){V.emit("plotly_beforeexport");var Q=d.select(V).append("div").attr("id","hiddenform").style("display","none"),X=Q.append("form").attr({action:Z+"/external",method:"post",target:"_blank"});return X.append("input").attr({type:"text",name:"data"}).node().value=i.graphJson(V,!1,"keepdata"),X.node().submit(),Q.remove(),V.emit("plotly_afterexport"),!1}};var _=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],b=["year","month","dayMonth","dayMonthYear"];function T(V,Z){var Q=V._context.locale;Q||(Q="en-US");var X=!1,$={};function re(K){for(var J=!0,ee=0;ee<Z.length;ee++){var ne=Z[ee];$[ne]||(K[ne]?$[ne]=K[ne]:J=!1)}J&&(X=!0)}for(var H=0;H<2;H++){for(var N=V._context.locales,U=0;U<2;U++){var te=(N[Q]||{}).format;if(te&&(re(te),X))break;N=e.localeRegistry}var B=Q.split("-")[0];if(X||B===Q)break;Q=B}return X||re(e.localeRegistry.en.format),$}function k(V,Z){var Q={_fullLayout:Z},X=V._id.charAt(0)==="x",$=V._mainAxis._anchorAxis,re="",H="",N="";if($&&(N=$._mainAxis._id,re=X?V._id+N:N+V._id),!re||!Z._plots[re]){re="";for(var U=V._counterAxes,te=0;te<U.length;te++){var B=U[te],K=X?V._id+B:B+V._id;H||(H=K);var J=c.getFromId(Q,B);if(N&&J.overlaying===N){re=K;break}}}return re||H}function L(V){var Z=V.transforms;if(Array.isArray(Z)&&Z.length)for(var Q=0;Q<Z.length;Q++){var X=Z[Q],$=X._module||x[X.type];if($&&$.makesData)return!0}return!1}function A(V,Z,Q,X){for(var $=V.transforms,re=[V],H=0;H<$.length;H++){var N=$[H],U=x[N.type];U&&U.transform&&(re=U.transform(re,{transform:N,fullTrace:V,fullData:Z,layout:Q,fullLayout:X,transformIndex:H}))}return re}function I(V){return typeof V=="string"&&V.substr(V.length-2)==="px"&&parseFloat(V)}function P(V){var Z=V.margin;if(!V._size){var Q=V._size={l:Math.round(Z.l),r:Math.round(Z.r),t:Math.round(Z.t),b:Math.round(Z.b),p:Math.round(Z.pad)};Q.w=Math.round(V.width)-Q.l-Q.r,Q.h=Math.round(V.height)-Q.t-Q.b}V._pushmargin||(V._pushmargin={}),V._pushmarginIds||(V._pushmarginIds={})}i.supplyDefaults=function(V,Z){var Q=Z&&Z.skipUpdateCalc,X=V._fullLayout||{};if(X._skipDefaults)delete X._skipDefaults;else{var $,re=V._fullLayout={},H=V.layout||{},N=V._fullData||[],U=V._fullData=[],te=V.data||[],B=V.calcdata||[],K=V._context||{};V._transitionData||i.createTransitionData(V),re._dfltTitle={plot:u(V,"Click to enter Plot title"),x:u(V,"Click to enter X axis title"),y:u(V,"Click to enter Y axis title"),colorbar:u(V,"Click to enter Colorscale title"),annotation:u(V,"new text")},re._traceWord=u(V,"trace");var J=T(V,_);if(re._mapboxAccessToken=K.mapboxAccessToken,X._initialAutoSizeIsDone){var ee=X.width,ne=X.height;i.supplyLayoutGlobalDefaults(H,re,J),H.width||(re.width=ee),H.height||(re.height=ne),i.sanitizeMargins(re)}else{i.supplyLayoutGlobalDefaults(H,re,J);var se=!H.width||!H.height,oe=re.autosize,me=K.autosizable;se&&(oe||me)?i.plotAutoSize(V,H,re):se&&i.sanitizeMargins(re),!oe&&se&&(H.width=re.width,H.height=re.height)}re._d3locale=function(ze,Re){return ze.decimal=Re.charAt(0),ze.thousands=Re.charAt(1),{numberFormat:function(We){try{We=w(ze).format(o.adjustFormat(We))}catch{return o.warnBadFormat(We),o.noFormat}return We},timeFormat:v(ze).utcFormat}}(J,re.separators),re._extraFormat=T(V,b),re._initialAutoSizeIsDone=!0,re._dataLength=te.length,re._modules=[],re._visibleModules=[],re._basePlotModules=[];var ce=re._subplots=function(){var ze,Re,We=e.collectableSubplotTypes,$e={};if(!We){We=[];var at=e.subplotsRegistry;for(var gt in at){var xt=at[gt].attr;if(xt&&(We.push(gt),Array.isArray(xt)))for(Re=0;Re<xt.length;Re++)o.pushUnique(We,xt[Re])}}for(ze=0;ze<We.length;ze++)$e[We[ze]]=[];return $e}(),ye=re._splomAxes={x:{},y:{}},Se=re._splomSubplots={};re._splomGridDflt={},re._scatterStackOpts={},re._firstScatter={},re._alignmentOpts={},re._colorAxes={},re._requestRangeslider={},re._traceUids=function(ze,Re){var We,$e,at=Re.length,gt=[];for(We=0;We<ze.length;We++){var xt=ze[We]._fullInput;xt!==$e&&gt.push(xt),$e=xt}var mt=gt.length,nt=new Array(at),Qe={};function vt($t,Zt){nt[Zt]=$t,Qe[$t]=1}function jt($t,Zt){if($t&&typeof $t=="string"&&!Qe[$t])return vt($t,Zt),!0}for(We=0;We<at;We++){var Gt=Re[We].uid;typeof Gt=="number"&&(Gt=String(Gt)),jt(Gt,We)||We<mt&&jt(gt[We].uid,We)||vt(o.randstr(Qe),We)}return nt}(N,te),re._globalTransforms=(V._context||{}).globalTransforms,i.supplyDataDefaults(te,U,H,re);var fe=Object.keys(ye.x),ge=Object.keys(ye.y);if(fe.length>1&&ge.length>1){for(e.getComponentMethod("grid","sizeDefaults")(H,re),$=0;$<fe.length;$++)o.pushUnique(ce.xaxis,fe[$]);for($=0;$<ge.length;$++)o.pushUnique(ce.yaxis,ge[$]);for(var Te in Se)o.pushUnique(ce.cartesian,Te)}if(re._has=i._hasPlotType.bind(re),N.length===U.length)for($=0;$<U.length;$++)p(U[$],N[$]);i.supplyLayoutModuleDefaults(H,re,U,V._transitionData);var le=re._visibleModules,ve=[];for($=0;$<le.length;$++){var Me=le[$].crossTraceDefaults;Me&&o.pushUnique(ve,Me)}for($=0;$<ve.length;$++)ve[$](U,re);re._hasOnlyLargeSploms=re._basePlotModules.length===1&&re._basePlotModules[0].name==="splom"&&fe.length>15&&ge.length>15&&re.shapes.length===0&&re.images.length===0,i.linkSubplots(U,re,N,X),i.cleanPlot(U,re,N,X);var we=!(!X._has||!X._has("gl2d")),de=!(!re._has||!re._has("gl2d")),Ie=!(!X._has||!X._has("cartesian"))||we,De=!(!re._has||!re._has("cartesian"))||de;Ie&&!De?X._bgLayer.remove():De&&!Ie&&(re._shouldCreateBgLayer=!0),X._zoomlayer&&!V._dragging&&a({_fullLayout:X}),function(ze,Re){var We,$e=[];Re.meta&&(We=Re._meta={meta:Re.meta,layout:{meta:Re.meta}});for(var at=0;at<ze.length;at++){var gt=ze[at];gt.meta?$e[gt.index]=gt._meta={meta:gt.meta}:Re.meta&&(gt._meta={meta:Re.meta}),Re.meta&&(gt._meta.layout={meta:Re.meta})}$e.length&&(We||(We=Re._meta={}),We.data=$e)}(U,re),p(re,X),e.getComponentMethod("colorscale","crossTraceDefaults")(U,re),re._preGUI||(re._preGUI={}),re._tracePreGUI||(re._tracePreGUI={});var Oe,Ve=re._tracePreGUI,Fe={};for(Oe in Ve)Fe[Oe]="old";for($=0;$<U.length;$++)Fe[Oe=U[$]._fullInput.uid]||(Ve[Oe]={}),Fe[Oe]="new";for(Oe in Fe)Fe[Oe]==="old"&&delete Ve[Oe];P(re),e.getComponentMethod("rangeslider","makeData")(re),Q||B.length!==U.length||i.supplyDefaultsUpdateCalc(B,U)}},i.supplyDefaultsUpdateCalc=function(V,Z){for(var Q=0;Q<Z.length;Q++){var X=Z[Q],$=(V[Q]||[])[0];if($&&$.trace){var re=$.trace;if(re._hasCalcTransform){var H,N,U,te=re._arrayAttrs;for(H=0;H<te.length;H++)N=te[H],U=o.nestedProperty(re,N).get().slice(),o.nestedProperty(X,N).set(U)}$.trace=X}}},i.createTransitionData=function(V){V._transitionData||(V._transitionData={}),V._transitionData._frames||(V._transitionData._frames=[]),V._transitionData._frameHash||(V._transitionData._frameHash={}),V._transitionData._counter||(V._transitionData._counter=0),V._transitionData._interruptCallbacks||(V._transitionData._interruptCallbacks=[])},i._hasPlotType=function(V){var Z,Q=this._basePlotModules||[];for(Z=0;Z<Q.length;Z++)if(Q[Z].name===V)return!0;var X=this._modules||[];for(Z=0;Z<X.length;Z++){var $=X[Z].name;if($===V)return!0;var re=e.modules[$];if(re&&re.categories[V])return!0}return!1},i.cleanPlot=function(V,Z,Q,X){var $,re,H=X._basePlotModules||[];for($=0;$<H.length;$++){var N=H[$];N.clean&&N.clean(V,Z,Q,X)}var U=X._has&&X._has("gl"),te=Z._has&&Z._has("gl");U&&!te&&X._glcontainer!==void 0&&(X._glcontainer.selectAll(".gl-canvas").remove(),X._glcontainer.selectAll(".no-webgl").remove(),X._glcanvas=null);var B=!!X._infolayer;e:for($=0;$<Q.length;$++){var K=Q[$].uid;for(re=0;re<V.length;re++)if(K===V[re].uid)continue e;B&&X._infolayer.select(".cb"+K).remove()}},i.linkSubplots=function(V,Z,Q,X){var $,re,H=X._plots||{},N=Z._plots={},U=Z._subplots,te={_fullData:V,_fullLayout:Z},B=U.cartesian.concat(U.gl2d||[]);for($=0;$<B.length;$++){var K,J=B[$],ee=H[J],ne=c.getFromId(te,J,"x"),se=c.getFromId(te,J,"y");for(ee?K=N[J]=ee:(K=N[J]={}).id=J,ne._counterAxes.push(se._id),se._counterAxes.push(ne._id),ne._subplotsWith.push(J),se._subplotsWith.push(J),K.xaxis=ne,K.yaxis=se,K._hasClipOnAxisFalse=!1,re=0;re<V.length;re++){var oe=V[re];if(oe.xaxis===K.xaxis._id&&oe.yaxis===K.yaxis._id&&oe.cliponaxis===!1){K._hasClipOnAxisFalse=!0;break}}}var me,ce=c.list(te,null,!0);for($=0;$<ce.length;$++){var ye=null;(me=ce[$]).overlaying&&(ye=c.getFromId(te,me.overlaying))&&ye.overlaying&&(me.overlaying=!1,ye=null),me._mainAxis=ye||me,ye&&(me.domain=ye.domain.slice()),me._anchorAxis=me.anchor==="free"?null:c.getFromId(te,me.anchor)}for($=0;$<ce.length;$++)if((me=ce[$])._counterAxes.sort(c.idSort),me._subplotsWith.sort(o.subplotSort),me._mainSubplot=k(me,Z),me._counterAxes.length&&(me.spikemode&&me.spikemode.indexOf("across")!==-1||me.automargin&&me.mirror&&me.anchor!=="free"||e.getComponentMethod("rangeslider","isVisible")(me))){var Se=1,fe=0;for(re=0;re<me._counterAxes.length;re++){var ge=c.getFromId(te,me._counterAxes[re]);Se=Math.min(Se,ge.domain[0]),fe=Math.max(fe,ge.domain[1])}Se<fe&&(me._counterDomainMin=Se,me._counterDomainMax=fe)}},i.clearExpandedTraceDefaultColors=function(V){var Z,Q,X;for(Q=[],(Z=V._module._colorAttrs)||(V._module._colorAttrs=Z=[],t.crawl(V._module.attributes,function($,re,H,N){Q[N]=re,Q.length=N+1,$.valType==="color"&&$.dflt===void 0&&Z.push(Q.join("."))})),X=0;X<Z.length;X++)o.nestedProperty(V,"_input."+Z[X]).get()||o.nestedProperty(V,Z[X]).set(null)},i.supplyDataDefaults=function(V,Z,Q,X){var $,re,H,N=X._modules,U=X._visibleModules,te=X._basePlotModules,B=0,K=0;function J(Te){Z.push(Te);var le=Te._module;le&&(o.pushUnique(N,le),Te.visible===!0&&o.pushUnique(U,le),o.pushUnique(te,Te._module.basePlotModule),B++,Te._input.visible!==!1&&K++)}X._transformModules=[];var ee={},ne=[],se=(Q.template||{}).data||{},oe=n.traceTemplater(se);for($=0;$<V.length;$++){if(H=V[$],(re=oe.newTrace(H)).uid=X._traceUids[$],i.supplyTraceDefaults(H,re,K,X,$),re.index=$,re._input=H,re._expandedIndex=B,re.transforms&&re.transforms.length)for(var me=H.visible!==!1&&re.visible===!1,ce=A(re,Z,Q,X),ye=0;ye<ce.length;ye++){var Se=ce[ye],fe={_template:re._template,type:re.type,uid:re.uid+ye};me&&Se.visible===!1&&delete Se.visible,i.supplyTraceDefaults(Se,fe,B,X,$),p(fe,Se),fe.index=$,fe._input=H,fe._fullInput=re,fe._expandedIndex=B,fe._expandedInput=Se,J(fe)}else re._fullInput=re,re._expandedInput=re,J(re);e.traceIs(re,"carpetAxis")&&(ee[re.carpet]=re),e.traceIs(re,"carpetDependent")&&ne.push($)}for($=0;$<ne.length;$++)if((re=Z[ne[$]]).visible){var ge=ee[re.carpet];re._carpet=ge,ge&&ge.visible?(re.xaxis=ge.xaxis,re.yaxis=ge.yaxis):re.visible=!1}},i.supplyAnimationDefaults=function(V){var Z;V=V||{};var Q={};function X($,re){return o.coerce(V||{},Q,h,$,re)}if(X("mode"),X("direction"),X("fromcurrent"),Array.isArray(V.frame))for(Q.frame=[],Z=0;Z<V.frame.length;Z++)Q.frame[Z]=i.supplyAnimationFrameDefaults(V.frame[Z]||{});else Q.frame=i.supplyAnimationFrameDefaults(V.frame||{});if(Array.isArray(V.transition))for(Q.transition=[],Z=0;Z<V.transition.length;Z++)Q.transition[Z]=i.supplyAnimationTransitionDefaults(V.transition[Z]||{});else Q.transition=i.supplyAnimationTransitionDefaults(V.transition||{});return Q},i.supplyAnimationFrameDefaults=function(V){var Z={};function Q(X,$){return o.coerce(V||{},Z,h.frame,X,$)}return Q("duration"),Q("redraw"),Z},i.supplyAnimationTransitionDefaults=function(V){var Z={};function Q(X,$){return o.coerce(V||{},Z,h.transition,X,$)}return Q("duration"),Q("easing"),Z},i.supplyFrameDefaults=function(V){var Z={};function Q(X,$){return o.coerce(V,Z,l,X,$)}return Q("group"),Q("name"),Q("traces"),Q("baseframe"),Q("data"),Q("layout"),Z},i.supplyTraceDefaults=function(V,Z,Q,X,$){var re,H=X.colorway||r.defaults,N=H[Q%H.length];function U(ce,ye){return o.coerce(V,Z,i.attributes,ce,ye)}var te=U("visible");U("type"),U("name",X._traceWord+" "+$),U("uirevision",X.uirevision);var B=i.getModule(Z);if(Z._module=B,B){var K=B.basePlotModule,J=K.attr,ee=K.attributes;if(J&&ee){var ne=X._subplots,se="";if(te||K.name!=="gl2d"){if(Array.isArray(J))for(re=0;re<J.length;re++){var oe=J[re],me=o.coerce(V,Z,ee,oe);ne[oe]&&o.pushUnique(ne[oe],me),se+=me}else se=o.coerce(V,Z,ee,J);ne[K.name]&&o.pushUnique(ne[K.name],se)}}}return te&&(U("customdata"),U("ids"),U("meta"),e.traceIs(Z,"showLegend")?(o.coerce(V,Z,B.attributes.showlegend?B.attributes:i.attributes,"showlegend"),U("legendwidth"),U("legendgroup"),U("legendgrouptitle.text"),U("legendrank"),Z._dfltShowLegend=!0):Z._dfltShowLegend=!1,B&&B.supplyDefaults(V,Z,N,X),e.traceIs(Z,"noOpacity")||U("opacity"),e.traceIs(Z,"notLegendIsolatable")&&(Z.visible=!!Z.visible),e.traceIs(Z,"noHover")||(Z.hovertemplate||o.coerceHoverinfo(V,Z,X),Z.type!=="parcats"&&e.getComponentMethod("fx","supplyDefaults")(V,Z,N,X)),B&&B.selectPoints&&U("selectedpoints"),i.supplyTransformDefaults(V,Z,X)),Z},i.hasMakesDataTransform=L,i.supplyTransformDefaults=function(V,Z,Q){if(Z._length||L(V)){var X=Q._globalTransforms||[],$=Q._transformModules||[];if(Array.isArray(V.transforms)||X.length!==0)for(var re=V.transforms||[],H=X.concat(re),N=Z.transforms=[],U=0;U<H.length;U++){var te,B=H[U],K=B.type,J=x[K],ee=!(B._module&&B._module===J),ne=J&&typeof J.transform=="function";J||o.warn("Unrecognized transform type "+K+"."),J&&J.supplyDefaults&&(ee||ne)?((te=J.supplyDefaults(B,Z,Q,V)).type=K,te._module=J,o.pushUnique($,J)):te=o.extendFlat({},B),N.push(te)}}},i.supplyLayoutGlobalDefaults=function(V,Z,Q){function X(U,te){return o.coerce(V,Z,i.layoutAttributes,U,te)}var $=V.template;o.isPlainObject($)&&(Z.template=$,Z._template=$.layout,Z._dataTemplate=$.data),X("autotypenumbers");var re=o.coerceFont(X,"font"),H=re.size;o.coerceFont(X,"title.font",o.extendFlat({},re,{size:Math.round(1.4*H)})),X("title.text",Z._dfltTitle.plot),X("title.xref"),X("title.yref"),X("title.x"),X("title.y"),X("title.xanchor"),X("title.yanchor"),X("title.pad.t"),X("title.pad.r"),X("title.pad.b"),X("title.pad.l"),X("uniformtext.mode")&&X("uniformtext.minsize"),X("autosize",!(V.width&&V.height)),X("width"),X("height"),X("minreducedwidth"),X("minreducedheight"),X("margin.l"),X("margin.r"),X("margin.t"),X("margin.b"),X("margin.pad"),X("margin.autoexpand"),V.width&&V.height&&i.sanitizeMargins(Z),e.getComponentMethod("grid","sizeDefaults")(V,Z),X("paper_bgcolor"),X("separators",Q.decimal+Q.thousands),X("hidesources"),X("colorway"),X("datarevision");var N=X("uirevision");X("editrevision",N),X("selectionrevision",N),e.getComponentMethod("modebar","supplyLayoutDefaults")(V,Z),e.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(V,Z,X),e.getComponentMethod("selections","supplyDrawNewSelectionDefaults")(V,Z,X),X("meta"),o.isPlainObject(V.transition)&&(X("transition.duration"),X("transition.easing"),X("transition.ordering")),e.getComponentMethod("calendars","handleDefaults")(V,Z,"calendar"),e.getComponentMethod("fx","supplyLayoutGlobalDefaults")(V,Z,X)},i.plotAutoSize=function(V,Z,Q){var X,$,re=V._context||{},H=re.frameMargins,N=o.isPlotDiv(V);if(N&&V.emit("plotly_autosize"),re.fillFrame)X=window.innerWidth,$=window.innerHeight,document.body.style.overflow="hidden";else{var U=N?window.getComputedStyle(V):{};if(X=I(U.width)||I(U.maxWidth)||Q.width,$=I(U.height)||I(U.maxHeight)||Q.height,y(H)&&H>0){var te=1-2*H;X=Math.round(te*X),$=Math.round(te*$)}}var B=i.layoutAttributes.width.min,K=i.layoutAttributes.height.min;X<B&&(X=B),$<K&&($=K);var J=!Z.width&&Math.abs(Q.width-X)>1,ee=!Z.height&&Math.abs(Q.height-$)>1;(ee||J)&&(J&&(Q.width=X),ee&&(Q.height=$)),V._initialAutoSize||(V._initialAutoSize={width:X,height:$}),i.sanitizeMargins(Q)},i.supplyLayoutModuleDefaults=function(V,Z,Q,X){var $,re,H,N=e.componentsRegistry,U=Z._basePlotModules,te=e.subplotsRegistry.cartesian;for($ in N)(H=N[$]).includeBasePlot&&H.includeBasePlot(V,Z);for(var B in U.length||U.push(te),Z._has("cartesian")&&(e.getComponentMethod("grid","contentDefaults")(V,Z),te.finalizeSubplots(V,Z)),Z._subplots)Z._subplots[B].sort(o.subplotSort);for(re=0;re<U.length;re++)(H=U[re]).supplyLayoutDefaults&&H.supplyLayoutDefaults(V,Z,Q);var K=Z._modules;for(re=0;re<K.length;re++)(H=K[re]).supplyLayoutDefaults&&H.supplyLayoutDefaults(V,Z,Q);var J=Z._transformModules;for(re=0;re<J.length;re++)(H=J[re]).supplyLayoutDefaults&&H.supplyLayoutDefaults(V,Z,Q,X);for($ in N)(H=N[$]).supplyLayoutDefaults&&H.supplyLayoutDefaults(V,Z,Q)},i.purge=function(V){var Z=V._fullLayout||{};Z._glcontainer!==void 0&&(Z._glcontainer.selectAll(".gl-canvas").remove(),Z._glcontainer.remove(),Z._glcanvas=null),Z._modeBar&&Z._modeBar.destroy(),V._transitionData&&(V._transitionData._interruptCallbacks&&(V._transitionData._interruptCallbacks.length=0),V._transitionData._animationRaf&&window.cancelAnimationFrame(V._transitionData._animationRaf)),o.clearThrottle(),o.clearResponsive(V),delete V.data,delete V.layout,delete V._fullData,delete V._fullLayout,delete V.calcdata,delete V.empty,delete V.fid,delete V.undoqueue,delete V.undonum,delete V.autoplay,delete V.changed,delete V._promises,delete V._redrawTimer,delete V._hmlumcount,delete V._hmpixcount,delete V._transitionData,delete V._transitioning,delete V._initialAutoSize,delete V._transitioningWithDuration,delete V._dragging,delete V._dragged,delete V._dragdata,delete V._hoverdata,delete V._snapshotInProgress,delete V._editing,delete V._mouseDownTime,delete V._legendMouseDownTime,V.removeAllListeners&&V.removeAllListeners()},i.style=function(V){var Z,Q=V._fullLayout._visibleModules,X=[];for(Z=0;Z<Q.length;Z++){var $=Q[Z];$.style&&o.pushUnique(X,$.style)}for(Z=0;Z<X.length;Z++)X[Z](V)},i.sanitizeMargins=function(V){if(V&&V.margin){var Z,Q=V.width,X=V.height,$=V.margin,re=Q-($.l+$.r),H=X-($.t+$.b);re<0&&(Z=(Q-1)/($.l+$.r),$.l=Math.floor(Z*$.l),$.r=Math.floor(Z*$.r)),H<0&&(Z=(X-1)/($.t+$.b),$.t=Math.floor(Z*$.t),$.b=Math.floor(Z*$.b))}},i.clearAutoMarginIds=function(V){V._fullLayout._pushmarginIds={}},i.allowAutoMargin=function(V,Z){V._fullLayout._pushmarginIds[Z]=1},i.autoMargin=function(V,Z,Q){var X=V._fullLayout,$=X.width,re=X.height,H=X.margin,N=X.minreducedwidth,U=X.minreducedheight,te=o.constrain($-H.l-H.r,2,N),B=o.constrain(re-H.t-H.b,2,U),K=Math.max(0,$-te),J=Math.max(0,re-B),ee=X._pushmargin,ne=X._pushmarginIds;if(H.autoexpand!==!1){if(Q){var se=Q.pad;if(se===void 0&&(se=Math.min(12,H.l,H.r,H.t,H.b)),K){var oe=(Q.l+Q.r)/K;oe>1&&(Q.l/=oe,Q.r/=oe)}if(J){var me=(Q.t+Q.b)/J;me>1&&(Q.t/=me,Q.b/=me)}var ce=Q.xl!==void 0?Q.xl:Q.x,ye=Q.xr!==void 0?Q.xr:Q.x,Se=Q.yt!==void 0?Q.yt:Q.y,fe=Q.yb!==void 0?Q.yb:Q.y;ee[Z]={l:{val:ce,size:Q.l+se},r:{val:ye,size:Q.r+se},b:{val:fe,size:Q.b+se},t:{val:Se,size:Q.t+se}},ne[Z]=1}else delete ee[Z],delete ne[Z];if(!X._replotting)return i.doAutoMargin(V)}},i.doAutoMargin=function(V){var Z=V._fullLayout,Q=Z.width,X=Z.height;Z._size||(Z._size={}),P(Z);var $=Z._size,re=Z.margin,H=o.extendFlat({},$),N=re.l,U=re.r,te=re.t,B=re.b,K=Z._pushmargin,J=Z._pushmarginIds,ee=Z.minreducedwidth,ne=Z.minreducedheight;if(Z.margin.autoexpand!==!1){for(var se in K)J[se]||delete K[se];for(var oe in K.base={l:{val:0,size:N},r:{val:1,size:U},t:{val:1,size:te},b:{val:0,size:B}},K){var me=K[oe].l||{},ce=K[oe].b||{},ye=me.val,Se=me.size,fe=ce.val,ge=ce.size;for(var Te in K){if(y(Se)&&K[Te].r){var le=K[Te].r.val,ve=K[Te].r.size;if(le>ye){var Me=(Se*le+(ve-Q)*ye)/(le-ye),we=(ve*(1-ye)+(Se-Q)*(1-le))/(le-ye);Me+we>N+U&&(N=Me,U=we)}}if(y(ge)&&K[Te].t){var de=K[Te].t.val,Ie=K[Te].t.size;if(de>fe){var De=(ge*de+(Ie-X)*fe)/(de-fe),Oe=(Ie*(1-fe)+(ge-X)*(1-de))/(de-fe);De+Oe>B+te&&(B=De,te=Oe)}}}}}var Ve=o.constrain(Q-re.l-re.r,2,ee),Fe=o.constrain(X-re.t-re.b,2,ne),ze=Math.max(0,Q-Ve),Re=Math.max(0,X-Fe);if(ze){var We=(N+U)/ze;We>1&&(N/=We,U/=We)}if(Re){var $e=(B+te)/Re;$e>1&&(B/=$e,te/=$e)}if($.l=Math.round(N),$.r=Math.round(U),$.t=Math.round(te),$.b=Math.round(B),$.p=Math.round(re.pad),$.w=Math.round(Q)-$.l-$.r,$.h=Math.round(X)-$.t-$.b,!Z._replotting&&i.didMarginChange(H,$)){"_redrawFromAutoMarginCount"in Z?Z._redrawFromAutoMarginCount++:Z._redrawFromAutoMarginCount=1;var at=3*(1+Object.keys(J).length);if(Z._redrawFromAutoMarginCount<at)return e.call("_doPlot",V);Z._size=H,o.warn("Too many auto-margin redraws.")}(function(gt){var xt=c.list(gt,"",!0);["_adjustTickLabelsOverflow","_hideCounterAxisInsideTickLabels"].forEach(function(mt){for(var nt=0;nt<xt.length;nt++){var Qe=xt[nt][mt];Qe&&Qe()}})})(V)};var S=["l","r","t","b","p","w","h"];function E(V,Z,Q){var X=!1,$=[i.previousPromises,function(){if(V._transitionData)return V._transitioning=!1,function(H){var N=Promise.resolve();if(!H)return N;for(;H.length;)N=N.then(H.shift());return N}(V._transitionData._interruptCallbacks)},Q.prepareFn,i.rehover,i.reselect,function(){return V.emit("plotly_transitioning",[]),new Promise(function(H){V._transitioning=!0,Z.duration>0&&(V._transitioningWithDuration=!0),V._transitionData._interruptCallbacks.push(function(){X=!0}),Q.redraw&&V._transitionData._interruptCallbacks.push(function(){return e.call("redraw",V)}),V._transitionData._interruptCallbacks.push(function(){V.emit("plotly_transitioninterrupted",[])});var N=0,U=0;function te(){return N++,function(){U++,X||U!==N||function(B){!V._transitionData||(function(K){if(K)for(;K.length;)K.shift()}(V._transitionData._interruptCallbacks),Promise.resolve().then(function(){if(Q.redraw)return e.call("redraw",V)}).then(function(){V._transitioning=!1,V._transitioningWithDuration=!1,V.emit("plotly_transitioned",[])}).then(B))}(H)}}Q.runFn(te),setTimeout(te())})}],re=o.syncOrAsync($,V);return re&&re.then||(re=Promise.resolve()),re.then(function(){return V})}i.didMarginChange=function(V,Z){for(var Q=0;Q<S.length;Q++){var X=S[Q],$=V[X],re=Z[X];if(!y($)||Math.abs(re-$)>1)return!0}return!1},i.graphJson=function(V,Z,Q,X,$,re){($&&Z&&!V._fullData||$&&!Z&&!V._fullLayout)&&i.supplyDefaults(V);var H=$?V._fullData:V.data,N=$?V._fullLayout:V.layout,U=(V._transitionData||{})._frames;function te(J,ee){if(typeof J=="function")return ee?"_function_":null;if(o.isPlainObject(J)){var ne,se={};return Object.keys(J).sort().forEach(function(oe){if(["_","["].indexOf(oe.charAt(0))===-1)if(typeof J[oe]!="function"){if(Q==="keepdata"){if(oe.substr(oe.length-3)==="src")return}else if(Q==="keepstream"){if(typeof(ne=J[oe+"src"])=="string"&&ne.indexOf(":")>0&&!o.isPlainObject(J.stream))return}else if(Q!=="keepall"&&typeof(ne=J[oe+"src"])=="string"&&ne.indexOf(":")>0)return;se[oe]=te(J[oe],ee)}else ee&&(se[oe]="_function")}),se}return Array.isArray(J)?J.map(function(oe){return te(oe,ee)}):o.isTypedArray(J)?o.simpleMap(J,o.identity):o.isJSDate(J)?o.ms2DateTimeLocal(+J):J}var B={data:(H||[]).map(function(J){var ee=te(J);return Z&&delete ee.fit,ee})};if(!Z&&(B.layout=te(N),$)){var K=N._size;B.layout.computed={margin:{b:K.b,l:K.l,r:K.r,t:K.t}}}return U&&(B.frames=te(U)),re&&(B.config=te(V._context,!0)),X==="object"?B:JSON.stringify(B)},i.modifyFrames=function(V,Z){var Q,X,$,re=V._transitionData._frames,H=V._transitionData._frameHash;for(Q=0;Q<Z.length;Q++)switch((X=Z[Q]).type){case"replace":$=X.value;var N=(re[X.index]||{}).name,U=$.name;re[X.index]=H[U]=$,U!==N&&(delete H[N],H[U]=$);break;case"insert":H[($=X.value).name]=$,re.splice(X.index,0,$);break;case"delete":delete H[($=re[X.index]).name],re.splice(X.index,1)}return Promise.resolve()},i.computeFrame=function(V,Z){var Q,X,$,re,H=V._transitionData._frameHash;if(!Z)throw new Error("computeFrame must be given a string frame name");var N=H[Z.toString()];if(!N)return!1;for(var U=[N],te=[N.name];N.baseframe&&(N=H[N.baseframe.toString()])&&te.indexOf(N.name)===-1;)U.push(N),te.push(N.name);for(var B={};N=U.pop();)if(N.layout&&(B.layout=i.extendLayout(B.layout,N.layout)),N.data){if(B.data||(B.data=[]),!(X=N.traces))for(X=[],Q=0;Q<N.data.length;Q++)X[Q]=Q;for(B.traces||(B.traces=[]),Q=0;Q<N.data.length;Q++)($=X[Q])!=null&&((re=B.traces.indexOf($))===-1&&(re=B.data.length,B.traces[re]=$),B.data[re]=i.extendTrace(B.data[re],N.data[Q]))}return B},i.recomputeFrameHash=function(V){for(var Z=V._transitionData._frameHash={},Q=V._transitionData._frames,X=0;X<Q.length;X++){var $=Q[X];$&&$.name&&(Z[$.name]=$)}},i.extendObjectWithContainers=function(V,Z,Q){var X,$,re,H,N,U,te,B=o.extendDeepNoArrays({},Z||{}),K=o.expandObjectPaths(B),J={};if(Q&&Q.length)for(re=0;re<Q.length;re++)($=(X=o.nestedProperty(K,Q[re])).get())===void 0?o.nestedProperty(J,Q[re]).set(null):(X.set(null),o.nestedProperty(J,Q[re]).set($));if(V=o.extendDeepNoArrays(V||{},K),Q&&Q.length){for(re=0;re<Q.length;re++)if(U=o.nestedProperty(J,Q[re]).get()){for(te=(N=o.nestedProperty(V,Q[re])).get(),Array.isArray(te)||(te=[],N.set(te)),H=0;H<U.length;H++){var ee=U[H];te[H]=ee===null?null:i.extendObjectWithContainers(te[H],ee)}N.set(te)}}return V},i.dataArrayContainers=["transforms","dimensions"],i.layoutArrayContainers=e.layoutArrayContainers,i.extendTrace=function(V,Z){return i.extendObjectWithContainers(V,Z,i.dataArrayContainers)},i.extendLayout=function(V,Z){return i.extendObjectWithContainers(V,Z,i.layoutArrayContainers)},i.transition=function(V,Z,Q,X,$,re){var H={redraw:$.redraw},N={},U=[];return H.prepareFn=function(){for(var te=Array.isArray(Z)?Z.length:0,B=X.slice(0,te),K=0;K<B.length;K++){var J=B[K],ee=V._fullData[J]._module;if(ee){if(ee.animatable){var ne=ee.basePlotModule.name;N[ne]||(N[ne]=[]),N[ne].push(J)}V.data[B[K]]=i.extendTrace(V.data[B[K]],Z[K])}}var se=o.expandObjectPaths(o.extendDeepNoArrays({},Q)),oe=/^[xy]axis[0-9]*$/;for(var me in se)oe.test(me)&&delete se[me].range;i.extendLayout(V.layout,se),delete V.calcdata,i.supplyDefaults(V),i.doCalcdata(V);var ce=o.expandObjectPaths(Q);if(ce){var ye=V._fullLayout._plots;for(var Se in ye){var fe=ye[Se],ge=fe.xaxis,Te=fe.yaxis,le=ge.range.slice(),ve=Te.range.slice(),Me=null,we=null,de=null,Ie=null;Array.isArray(ce[ge._name+".range"])?Me=ce[ge._name+".range"].slice():Array.isArray((ce[ge._name]||{}).range)&&(Me=ce[ge._name].range.slice()),Array.isArray(ce[Te._name+".range"])?we=ce[Te._name+".range"].slice():Array.isArray((ce[Te._name]||{}).range)&&(we=ce[Te._name].range.slice()),le&&Me&&(ge.r2l(le[0])!==ge.r2l(Me[0])||ge.r2l(le[1])!==ge.r2l(Me[1]))&&(de={xr0:le,xr1:Me}),ve&&we&&(Te.r2l(ve[0])!==Te.r2l(we[0])||Te.r2l(ve[1])!==Te.r2l(we[1]))&&(Ie={yr0:ve,yr1:we}),(de||Ie)&&U.push(o.extendFlat({plotinfo:fe},de,Ie))}}return Promise.resolve()},H.runFn=function(te){var B,K,J=V._fullLayout._basePlotModules,ee=U.length;if(Q)for(K=0;K<J.length;K++)J[K].transitionAxes&&J[K].transitionAxes(V,U,re,te);for(var ne in ee?((B=o.extendFlat({},re)).duration=0,delete N.cartesian):B=re,N){var se=N[ne];V._fullData[se[0]]._module.basePlotModule.plot(V,se,B,te)}},E(V,re,H)},i.transitionFromReact=function(V,Z,Q,X){var $=V._fullLayout,re=$.transition,H={},N=[];return H.prepareFn=function(){var U=$._plots;for(var te in H.redraw=!1,Z.anim==="some"&&(H.redraw=!0),Q.anim==="some"&&(H.redraw=!0),U){var B=U[te],K=B.xaxis,J=B.yaxis,ee=X[K._name].range.slice(),ne=X[J._name].range.slice(),se=K.range.slice(),oe=J.range.slice();K.setScale(),J.setScale();var me=null,ce=null;K.r2l(ee[0])===K.r2l(se[0])&&K.r2l(ee[1])===K.r2l(se[1])||(me={xr0:ee,xr1:se}),J.r2l(ne[0])===J.r2l(oe[0])&&J.r2l(ne[1])===J.r2l(oe[1])||(ce={yr0:ne,yr1:oe}),(me||ce)&&N.push(o.extendFlat({plotinfo:B},me,ce))}return Promise.resolve()},H.runFn=function(U){for(var te,B,K,J=V._fullData,ee=V._fullLayout._basePlotModules,ne=[],se=0;se<J.length;se++)ne.push(se);function oe(){if(V._fullLayout)for(var ce=0;ce<ee.length;ce++)ee[ce].transitionAxes&&ee[ce].transitionAxes(V,N,te,U)}function me(){if(V._fullLayout)for(var ce=0;ce<ee.length;ce++)ee[ce].plot(V,K,B,U)}N.length&&Z.anim?re.ordering==="traces first"?(te=o.extendFlat({},re,{duration:0}),K=ne,B=re,setTimeout(oe,re.duration),me()):(te=re,K=null,B=o.extendFlat({},re,{duration:0}),setTimeout(me,te.duration),oe()):N.length?(te=re,oe()):Z.anim&&(K=ne,B=re,me())},E(V,re,H)},i.doCalcdata=function(V,Z){var Q,X,$,re,H=c.list(V),N=V._fullData,U=V._fullLayout,te=new Array(N.length),B=(V.calcdata||[]).slice();for(V.calcdata=te,U._numBoxes=0,U._numViolins=0,U._violinScaleGroupStats={},V._hmpixcount=0,V._hmlumcount=0,U._piecolormap={},U._sunburstcolormap={},U._treemapcolormap={},U._iciclecolormap={},U._funnelareacolormap={},$=0;$<N.length;$++)Array.isArray(Z)&&Z.indexOf($)===-1&&(te[$]=B[$]);for($=0;$<N.length;$++)(Q=N[$])._arrayAttrs=t.findArrayAttributes(Q),Q._extremes={};var K=U._subplots.polar||[];for($=0;$<K.length;$++)H.push(U[K[$]].radialaxis,U[K[$]].angularaxis);for(var J in U._colorAxes){var ee=U[J];ee.cauto!==!1&&(delete ee.cmin,delete ee.cmax)}var ne=!1;function se(ce){if(Q=N[ce],X=Q._module,Q.visible===!0&&Q.transforms){if(X&&X.calc){var ye=X.calc(V,Q);ye[0]&&ye[0].t&&ye[0].t._scene&&delete ye[0].t._scene.dirty}for(re=0;re<Q.transforms.length;re++){var Se=Q.transforms[re];(X=x[Se.type])&&X.calcTransform&&(Q._hasCalcTransform=!0,ne=!0,X.calcTransform(V,Q,Se))}}}function oe(ce,ye){if(Q=N[ce],!!(X=Q._module).isContainer===ye){var Se=[];if(Q.visible===!0&&Q._length!==0){delete Q._indexToPoints;var fe=Q.transforms||[];for(re=fe.length-1;re>=0;re--)if(fe[re].enabled){Q._indexToPoints=fe[re]._indexToPoints;break}X&&X.calc&&(Se=X.calc(V,Q))}Array.isArray(Se)&&Se[0]||(Se=[{x:g,y:g}]),Se[0].t||(Se[0].t={}),Se[0].trace=Q,te[ce]=Se}}for(D(H,N,U),$=0;$<N.length;$++)oe($,!0);for($=0;$<N.length;$++)se($);for(ne&&D(H,N,U),$=0;$<N.length;$++)oe($,!0);for($=0;$<N.length;$++)oe($,!1);j(V);var me=function(ce,ye){var Se,fe,ge,Te,le,ve=[];function Me(Dt,Ne,Ye){var pe=Ne._id.charAt(0);if(Dt==="histogram2dcontour"){var _e=Ne._counterAxes[0],Be=c.getFromId(ye,_e),He=pe==="x"||_e==="x"&&Be.type==="category",Je=pe==="y"||_e==="y"&&Be.type==="category";return function(Ze,ct){return Ze===0||ct===0||He&&Ze===Ye[ct].length-1||Je&&ct===Ye.length-1?-1:(pe==="y"?ct:Ze)-1}}return function(Ze,ct){return pe==="y"?ct:Ze}}var we={min:function(Dt){return o.aggNums(Math.min,null,Dt)},max:function(Dt){return o.aggNums(Math.max,null,Dt)},sum:function(Dt){return o.aggNums(function(Ne,Ye){return Ne+Ye},null,Dt)},total:function(Dt){return o.aggNums(function(Ne,Ye){return Ne+Ye},null,Dt)},mean:function(Dt){return o.mean(Dt)},median:function(Dt){return o.median(Dt)}};for(Se=0;Se<ce.length;Se++){var de=ce[Se];if(de.type==="category"){var Ie=de.categoryorder.match(z);if(Ie){var De=Ie[1],Oe=Ie[2],Ve=de._id.charAt(0),Fe=Ve==="x",ze=[];for(fe=0;fe<de._categories.length;fe++)ze.push([de._categories[fe],[]]);for(fe=0;fe<de._traceIndices.length;fe++){var Re=de._traceIndices[fe],We=ye._fullData[Re];if(We.visible===!0){var $e=We.type;e.traceIs(We,"histogram")&&(delete We._xautoBinFinished,delete We._yautoBinFinished);var at=$e==="splom",gt=$e==="scattergl",xt=ye.calcdata[Re];for(ge=0;ge<xt.length;ge++){var mt,nt,Qe=xt[ge];if(at){var vt=We._axesDim[de._id];if(!Fe){var jt=We._diag[vt][0];jt&&(de=ye._fullLayout[c.id2name(jt)])}var Gt=Qe.trace.dimensions[vt].values;for(Te=0;Te<Gt.length;Te++)for(mt=de._categoriesMap[Gt[Te]],le=0;le<Qe.trace.dimensions.length;le++)if(le!==vt){var $t=Qe.trace.dimensions[le];ze[mt][1].push($t.values[Te])}}else if(gt){for(Te=0;Te<Qe.t.x.length;Te++)Fe?(mt=Qe.t.x[Te],nt=Qe.t.y[Te]):(mt=Qe.t.y[Te],nt=Qe.t.x[Te]),ze[mt][1].push(nt);Qe.t&&Qe.t._scene&&delete Qe.t._scene.dirty}else if(Qe.hasOwnProperty("z")){nt=Qe.z;var Zt=Me(We.type,de,nt);for(Te=0;Te<nt.length;Te++)for(le=0;le<nt[Te].length;le++)(mt=Zt(le,Te))+1&&ze[mt][1].push(nt[Te][le])}else for((mt=Qe.p)===void 0&&(mt=Qe[Ve]),(nt=Qe.s)===void 0&&(nt=Qe.v),nt===void 0&&(nt=Fe?Qe.y:Qe.x),Array.isArray(nt)||(nt=nt===void 0?[]:[nt]),Te=0;Te<nt.length;Te++)ze[mt][1].push(nt[Te])}}}de._categoriesValue=ze;var cr=[];for(fe=0;fe<ze.length;fe++)cr.push([ze[fe][0],we[De](ze[fe][1])]);cr.sort(function(Dt,Ne){return Dt[1]-Ne[1]}),de._categoriesAggregatedValue=cr,de._initialCategories=cr.map(function(Dt){return Dt[0]}),Oe==="descending"&&de._initialCategories.reverse(),ve=ve.concat(de.sortByInitialCategories())}}}return ve}(H,V);if(me.length){for(U._numBoxes=0,U._numViolins=0,$=0;$<me.length;$++)oe(me[$],!0);for($=0;$<me.length;$++)oe(me[$],!1);j(V)}e.getComponentMethod("fx","calc")(V),e.getComponentMethod("errorbars","calc")(V)};var z=/(total|sum|min|max|mean|median) (ascending|descending)/;function D(V,Z,Q){var X={};function $(U){U.clearCalc(),U.type==="multicategory"&&U.setupMultiCategory(Z),X[U._id]=1}o.simpleMap(V,$);for(var re=Q._axisMatchGroups||[],H=0;H<re.length;H++)for(var N in re[H])X[N]||$(Q[c.id2name(N)])}function j(V){var Z,Q,X,$=V._fullLayout,re=$._visibleModules,H={};for(Q=0;Q<re.length;Q++){var N=re[Q],U=N.crossTraceCalc;if(U){var te=N.basePlotModule.name;H[te]?o.pushUnique(H[te],U):H[te]=[U]}}for(X in H){var B=H[X],K=$._subplots[X];if(Array.isArray(K))for(Z=0;Z<K.length;Z++){var J=K[Z],ee=X==="cartesian"?$._plots[J]:$[J];for(Q=0;Q<B.length;Q++)B[Q](V,ee,J)}else for(Q=0;Q<B.length;Q++)B[Q](V)}}i.rehover=function(V){V._fullLayout._rehover&&V._fullLayout._rehover()},i.redrag=function(V){V._fullLayout._redrag&&V._fullLayout._redrag()},i.reselect=function(V){var Z=V._fullLayout,Q=(V.layout||{}).selections,X=Z._previousSelections;Z._previousSelections=Q;var $=Z._reselect||JSON.stringify(Q)!==JSON.stringify(X);e.getComponentMethod("selections","reselect")(V,$)},i.generalUpdatePerTraceModule=function(V,Z,Q,X){var $,re=Z.traceHash,H={};for($=0;$<Q.length;$++){var N=Q[$],U=N[0].trace;U.visible&&(H[U.type]=H[U.type]||[],H[U.type].push(N))}for(var te in re)if(!H[te]){var B=re[te][0];B[0].trace.visible=!1,H[te]=[B]}for(var K in H){var J=H[K];J[0][0].trace._module.plot(V,Z,o.filterVisible(J),X)}Z.traceHash=H},i.plotBasePlot=function(V,Z,Q,X,$){var re=e.getModule(V),H=s(Z.calcdata,re)[0];re.plot(Z,H,X,$)},i.cleanBasePlot=function(V,Z,Q,X,$){var re=$._has&&$._has(V),H=Q._has&&Q._has(V);re&&!H&&$["_"+V+"layer"].selectAll("g.trace").remove()}},{"../components/color":367,"../components/shapes/handle_outline":468,"../constants/numerical":491,"../lib":515,"../plot_api/plot_schema":554,"../plot_api/plot_template":555,"../plots/get_data":602,"../registry":647,"./animation_attributes":560,"./attributes":562,"./cartesian/axis_ids":570,"./command":592,"./font_attributes":594,"./frame_attributes":595,"./layout_attributes":619,"@plotly/d3":58,"d3-format":112,"d3-time-format":120,"fast-isnumeric":190}],629:[function(m,G,Y){G.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],630:[function(m,G,Y){var d=m("../../lib"),v=m("../../lib/polygon").tester,w=d.findIndexOfMin,y=d.isAngleInsideSector,e=d.angleDelta,t=d.angleDist;function n(c,a,h,l){var s,p,u=l[0],i=l[1],x=r(Math.sin(a)-Math.sin(c)),f=r(Math.cos(a)-Math.cos(c)),_=Math.tan(h),b=r(1/_),T=x/f,k=i-T*u;return b?x&&f?p=_*(s=k/(_-T)):f?(s=i*b,p=i):(s=u,p=u*_):x&&f?(s=0,p=k):f?(s=0,p=i):s=p=NaN,[s,p]}function o(c,a,h,l){return d.isFullCircle([a,h])?function(s,p){var u,i=p.length,x=new Array(i+1);for(u=0;u<i;u++){var f=p[u];x[u]=[s*Math.cos(f),s*Math.sin(f)]}return x[u]=x[0].slice(),x}(c,l):function(s,p,u,i){var x,f,_=i.length,b=[];function T(D){return[s*Math.cos(D),s*Math.sin(D)]}function k(D,j,V){return n(D,j,V,T(D))}function L(D){return d.mod(D,_)}function A(D){return y(D,[p,u])}var I=w(i,function(D){return A(D)?t(D,p):1/0}),P=k(i[I],i[L(I-1)],p);for(b.push(P),x=I,f=0;f<_;x++,f++){var S=i[L(x)];if(!A(S))break;b.push(T(S))}var E=w(i,function(D){return A(D)?t(D,u):1/0}),z=k(i[E],i[L(E+1)],u);return b.push(z),b.push([0,0]),b.push(b[0].slice()),b}(c,a,h,l)}function r(c){return Math.abs(c)>1e-10?c:0}function g(c,a,h){a=a||0,h=h||0;for(var l=c.length,s=new Array(l),p=0;p<l;p++){var u=c[p];s[p]=[a+u[0],h-u[1]]}return s}G.exports={isPtInsidePolygon:function(c,a,h,l,s){if(!y(a,l))return!1;var p,u;h[0]<h[1]?(p=h[0],u=h[1]):(p=h[1],u=h[0]);var i=v(o(p,l[0],l[1],s)),x=v(o(u,l[0],l[1],s)),f=[c*Math.cos(a),c*Math.sin(a)];return x.contains(f)&&!i.contains(f)},findPolygonOffset:function(c,a,h,l){for(var s=1/0,p=1/0,u=o(c,a,h,l),i=0;i<u.length;i++){var x=u[i];s=Math.min(s,x[0]),p=Math.min(p,-x[1])}return[s,p]},findEnclosingVertexAngles:function(c,a){var h=w(a,function(s){var p=e(s,c);return p>0?p:1/0}),l=d.mod(h+1,a.length);return[a[h],a[l]]},findIntersectionXY:n,findXYatLength:function(c,a,h,l){var s=-a*h,p=a*a+1,u=2*(a*s-h),i=s*s+h*h-c*c,x=Math.sqrt(u*u-4*p*i),f=(-u+x)/(2*p),_=(-u-x)/(2*p);return[[f,a*f+s+l],[_,a*_+s+l]]},clampTiny:r,pathPolygon:function(c,a,h,l,s,p){return"M"+g(o(c,a,h,l),s,p).join("L")},pathPolygonAnnulus:function(c,a,h,l,s,p,u){var i,x;c<a?(i=c,x=a):(i=a,x=c);var f=g(o(i,h,l,s),p,u);return"M"+g(o(x,h,l,s),p,u).reverse().join("L")+"M"+f.join("L")}}},{"../../lib":515,"../../lib/polygon":527}],631:[function(m,G,Y){var d=m("../get_data").getSubplotCalcData,v=m("../../lib").counterRegex,w=m("./polar"),y=m("./constants"),e=y.attr,t=y.name,n=v(t),o={};o[e]={valType:"subplotid",dflt:t,editType:"calc"},G.exports={attr:e,name:t,idRoot:t,idRegex:n,attrRegex:n,attributes:o,layoutAttributes:m("./layout_attributes"),supplyLayoutDefaults:m("./layout_defaults"),plot:function(r){for(var g=r._fullLayout,c=r.calcdata,a=g._subplots[t],h=0;h<a.length;h++){var l=a[h],s=d(c,t,l),p=g[l]._subplot;p||(p=w(r,l),g[l]._subplot=p),p.plot(s,g,r._promises)}},clean:function(r,g,c,a){for(var h=a._subplots[t]||[],l=a._has&&a._has("gl"),s=g._has&&g._has("gl"),p=l&&!s,u=0;u<h.length;u++){var i=h[u],x=a[i]._subplot;if(!g[i]&&x)for(var f in x.framework.remove(),x.layers["radial-axis-title"].remove(),x.clipPaths)x.clipPaths[f].remove();p&&x._scene&&(x._scene.destroy(),x._scene=null)}},toSVG:m("../cartesian").toSVG}},{"../../lib":515,"../cartesian":578,"../get_data":602,"./constants":629,"./layout_attributes":632,"./layout_defaults":633,"./polar":634}],632:[function(m,G,Y){var d=m("../../components/color/attributes"),v=m("../cartesian/layout_attributes"),w=m("../domain").attributes,y=m("../../lib").extendFlat,e=m("../../plot_api/edit_types").overrideAll,t=e({color:v.color,showline:y({},v.showline,{dflt:!0}),linecolor:v.linecolor,linewidth:v.linewidth,showgrid:y({},v.showgrid,{dflt:!0}),gridcolor:v.gridcolor,gridwidth:v.gridwidth,griddash:v.griddash},"plot","from-root"),n=e({tickmode:v.tickmode,nticks:v.nticks,tick0:v.tick0,dtick:v.dtick,tickvals:v.tickvals,ticktext:v.ticktext,ticks:v.ticks,ticklen:v.ticklen,tickwidth:v.tickwidth,tickcolor:v.tickcolor,ticklabelstep:v.ticklabelstep,showticklabels:v.showticklabels,showtickprefix:v.showtickprefix,tickprefix:v.tickprefix,showticksuffix:v.showticksuffix,ticksuffix:v.ticksuffix,showexponent:v.showexponent,exponentformat:v.exponentformat,minexponent:v.minexponent,separatethousands:v.separatethousands,tickfont:v.tickfont,tickangle:v.tickangle,tickformat:v.tickformat,tickformatstops:v.tickformatstops,layer:v.layer},"plot","from-root"),o={visible:y({},v.visible,{dflt:!0}),type:y({},v.type,{values:["-","linear","log","date","category"]}),autotypenumbers:v.autotypenumbers,autorange:y({},v.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:y({},v.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:v.categoryorder,categoryarray:v.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:y({},v.title.text,{editType:"plot",dflt:""}),font:y({},v.title.font,{editType:"plot"}),editType:"plot"},hoverformat:v.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:v._deprecated.title,titlefont:v._deprecated.titlefont}};y(o,t,n);var r={visible:y({},v.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:v.autotypenumbers,categoryorder:v.categoryorder,categoryarray:v.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:v.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};y(r,t,n),G.exports={domain:w({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:d.background},radialaxis:o,angularaxis:r,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":366,"../../lib":515,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],633:[function(m,G,Y){var d=m("../../lib"),v=m("../../components/color"),w=m("../../plot_api/plot_template"),y=m("../subplot_defaults"),e=m("../get_data").getSubplotData,t=m("../cartesian/tick_value_defaults"),n=m("../cartesian/tick_mark_defaults"),o=m("../cartesian/tick_label_defaults"),r=m("../cartesian/prefix_suffix_defaults"),g=m("../cartesian/category_order_defaults"),c=m("../cartesian/line_grid_defaults"),a=m("../cartesian/axis_autotype"),h=m("./layout_attributes"),l=m("./set_convert"),s=m("./constants"),p=s.axisNames;function u(x,f,_,b){var T=_("bgcolor");b.bgColor=v.combine(T,b.paper_bgcolor);var k=_("sector");_("hole");var L,A=e(b.fullData,s.name,b.id),I=b.layoutOut;function P(te,B){return _(L+"."+te,B)}for(var S=0;S<p.length;S++){L=p[S],d.isPlainObject(x[L])||(x[L]={});var E=x[L],z=w.newContainer(f,L);z._id=z._name=L,z._attr=b.id+"."+L,z._traceIndices=A.map(function(te){return te._expandedIndex});var D=s.axisName2dataArray[L],j=i(E,z,P,A,D,b);g(E,z,P,{axData:A,dataAttr:D});var V=P("visible");switch(l(z,f,I),P("uirevision",f.uirevision),z._m=1,L){case"radialaxis":var Z=P("autorange",!z.isValidRange(E.range));E.autorange=Z,!Z||j!=="linear"&&j!=="-"||P("rangemode"),Z==="reversed"&&(z._m=-1),P("range"),z.cleanRange("range",{dfltRange:[0,1]});break;case"angularaxis":if(j==="date"){d.log("Polar plots do not support date angular axes yet.");for(var Q=0;Q<A.length;Q++)A[Q].visible=!1;j=E.type=z.type="linear"}P(j==="linear"?"thetaunit":"period");var X=P("direction");P("rotation",{counterclockwise:0,clockwise:90}[X])}if(r(E,z,P,z.type,{tickSuffixDflt:z.thetaunit==="degrees"?"\xB0":void 0}),V){var $,re,H,N,U=b.font||{};re=($=P("color"))===E.color?$:U.color,H=U.size,N=U.family,t(E,z,P,z.type),o(E,z,P,z.type,{font:{color:re,size:H,family:N}}),n(E,z,P,{outerTicks:!0}),c(E,z,P,{dfltColor:$,bgColor:b.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:h[L]}),P("layer"),L==="radialaxis"&&(P("side"),P("angle",k[0]),P("title.text"),d.coerceFont(P,"title.font",{color:re,size:d.bigFont(H),family:N}))}j!=="category"&&P("hoverformat"),z._input=E}f.angularaxis.type==="category"&&_("gridshape")}function i(x,f,_,b,T,k){var L=_("autotypenumbers",k.autotypenumbersDflt);if(_("type")==="-"){for(var A,I=0;I<b.length;I++)if(b[I].visible){A=b[I];break}A&&A[T]&&(f.type=a(A[T],"gregorian",{noMultiCategory:!0,autotypenumbers:L})),f.type==="-"?f.type="linear":x.type=f.type}return f.type}G.exports=function(x,f,_){y(x,f,_,{type:s.name,attributes:h,handleDefaults:u,font:f.font,autotypenumbersDflt:f.autotypenumbers,paper_bgcolor:f.paper_bgcolor,fullData:_,layoutOut:f})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/axis_autotype":567,"../cartesian/category_order_defaults":571,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/tick_label_defaults":587,"../cartesian/tick_mark_defaults":588,"../cartesian/tick_value_defaults":589,"../get_data":602,"../subplot_defaults":641,"./constants":629,"./layout_attributes":632,"./set_convert":635}],634:[function(m,G,Y){var d=m("@plotly/d3"),v=m("tinycolor2"),w=m("../../registry"),y=m("../../lib"),e=y.strRotate,t=y.strTranslate,n=m("../../components/color"),o=m("../../components/drawing"),r=m("../plots"),g=m("../../plots/cartesian/axes"),c=m("../cartesian/set_convert"),a=m("./set_convert"),h=m("../cartesian/autorange").doAutoRange,l=m("../cartesian/dragbox"),s=m("../../components/dragelement"),p=m("../../components/fx"),u=m("../../components/titles"),i=m("../../components/selections").prepSelect,x=m("../../components/selections").selectOnClick,f=m("../../components/selections").clearOutline,_=m("../../lib/setcursor"),b=m("../../lib/clear_gl_canvases"),T=m("../../plot_api/subroutines").redrawReglTraces,k=m("../../constants/alignment").MID_SHIFT,L=m("./constants"),A=m("./helpers"),I=m("../smith/helpers"),P=I.smith,S=I.reactanceArc,E=I.resistanceArc,z=I.smithTransform,D=y._,j=y.mod,V=y.deg2rad,Z=y.rad2deg;function Q(N,U,te){this.isSmith=te||!1,this.id=U,this.gd=N,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var B=N._fullLayout,K="clip"+B._uid+U;this.clipIds.forTraces=K+"-for-traces",this.clipPaths.forTraces=B._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=B["_"+(te?"smith":"polar")+"layer"].append("g").attr("class",U),this.getHole=function(J){return this.isSmith?0:J.hole},this.getSector=function(J){return this.isSmith?[0,360]:J.sector},this.getRadial=function(J){return this.isSmith?J.realaxis:J.radialaxis},this.getAngular=function(J){return this.isSmith?J.imaginaryaxis:J.angularaxis},te||(this.radialTickLayout=null,this.angularTickLayout=null)}var X=Q.prototype;function $(N){var U=N.ticks+String(N.ticklen)+String(N.showticklabels);return"side"in N&&(U+=N.side),U}function re(N,U){return U[y.findIndexOfMin(U,function(te){return y.angleDist(N,te)})]}function H(N,U,te){return U?(N.attr("display",null),N.attr(te)):N&&N.attr("display","none"),N}G.exports=function(N,U,te){return new Q(N,U,te)},X.plot=function(N,U){for(var te=U[this.id],B=!1,K=0;K<N.length;K++)if(N[K][0].trace.cliponaxis===!1){B=!0;break}this._hasClipOnAxisFalse=B,this.updateLayers(U,te),this.updateLayout(U,te),r.generalUpdatePerTraceModule(this.gd,this,N,te),this.updateFx(U,te),this.isSmith&&(delete te.realaxis.range,delete te.imaginaryaxis.range)},X.updateLayers=function(N,U){var te=this.isSmith,B=this.layers,K=this.getRadial(U),J=this.getAngular(U),ee=L.layerNames,ne=ee.indexOf("frontplot"),se=ee.slice(0,ne),oe=J.layer==="below traces",me=K.layer==="below traces";oe&&se.push("angular-line"),me&&se.push("radial-line"),oe&&se.push("angular-axis"),me&&se.push("radial-axis"),se.push("frontplot"),oe||se.push("angular-line"),me||se.push("radial-line"),oe||se.push("angular-axis"),me||se.push("radial-axis");var ce=(te?"smith":"polar")+"sublayer",ye=this.framework.selectAll("."+ce).data(se,String);ye.enter().append("g").attr("class",function(Se){return ce+" "+Se}).each(function(Se){var fe=B[Se]=d.select(this);switch(Se){case"frontplot":te||fe.append("g").classed("barlayer",!0),fe.append("g").classed("scatterlayer",!0);break;case"backplot":fe.append("g").classed("maplayer",!0);break;case"plotbg":B.bg=fe.append("path");break;case"radial-grid":case"angular-grid":fe.style("fill","none");break;case"radial-line":fe.append("line").style("fill","none");break;case"angular-line":fe.append("path").style("fill","none")}}),ye.order()},X.updateLayout=function(N,U){var te=this.layers,B=N._size,K=this.getRadial(U),J=this.getAngular(U),ee=U.domain.x,ne=U.domain.y;this.xOffset=B.l+B.w*ee[0],this.yOffset=B.t+B.h*(1-ne[1]);var se=this.xLength=B.w*(ee[1]-ee[0]),oe=this.yLength=B.h*(ne[1]-ne[0]),me=this.getSector(U);this.sectorInRad=me.map(V);var ce,ye,Se,fe,ge,Te=this.sectorBBox=function(gt){var xt,mt,nt,Qe,vt=gt[0],jt=gt[1]-vt,Gt=j(vt,360),$t=Gt+jt,Zt=Math.cos(V(Gt)),cr=Math.sin(V(Gt)),Dt=Math.cos(V($t)),Ne=Math.sin(V($t));return Qe=Gt<=90&&$t>=90||Gt>90&&$t>=450?1:cr<=0&&Ne<=0?0:Math.max(cr,Ne),xt=Gt<=180&&$t>=180||Gt>180&&$t>=540?-1:Zt>=0&&Dt>=0?0:Math.min(Zt,Dt),mt=Gt<=270&&$t>=270||Gt>270&&$t>=630?-1:cr>=0&&Ne>=0?0:Math.min(cr,Ne),nt=$t>=360?1:Zt<=0&&Dt<=0?0:Math.max(Zt,Dt),[xt,mt,nt,Qe]}(me),le=Te[2]-Te[0],ve=Te[3]-Te[1],Me=oe/se,we=Math.abs(ve/le);Me>we?(ce=se,ge=(oe-(ye=se*we))/B.h/2,Se=[ee[0],ee[1]],fe=[ne[0]+ge,ne[1]-ge]):(ye=oe,ge=(se-(ce=oe/we))/B.w/2,Se=[ee[0]+ge,ee[1]-ge],fe=[ne[0],ne[1]]),this.xLength2=ce,this.yLength2=ye,this.xDomain2=Se,this.yDomain2=fe;var de,Ie=this.xOffset2=B.l+B.w*Se[0],De=this.yOffset2=B.t+B.h*(1-fe[1]),Oe=this.radius=ce/le,Ve=this.innerRadius=this.getHole(U)*Oe,Fe=this.cx=Ie-Oe*Te[0],ze=this.cy=De+Oe*Te[3],Re=this.cxx=Fe-Ie,We=this.cyy=ze-De,$e=K.side;$e==="counterclockwise"?(de=$e,$e="top"):$e==="clockwise"&&(de=$e,$e="bottom"),this.radialAxis=this.mockAxis(N,U,K,{_id:"x",side:$e,_trueSide:de,domain:[Ve/B.w,Oe/B.w]}),this.angularAxis=this.mockAxis(N,U,J,{side:"right",domain:[0,Math.PI],autorange:!1}),this.doAutoRange(N,U),this.updateAngularAxis(N,U),this.updateRadialAxis(N,U),this.updateRadialAxisTitle(N,U),this.xaxis=this.mockCartesianAxis(N,U,{_id:"x",domain:Se}),this.yaxis=this.mockCartesianAxis(N,U,{_id:"y",domain:fe});var at=this.pathSubplot();this.clipPaths.forTraces.select("path").attr("d",at).attr("transform",t(Re,We)),te.frontplot.attr("transform",t(Ie,De)).call(o.setClipUrl,this._hasClipOnAxisFalse?null:this.clipIds.forTraces,this.gd),te.bg.attr("d",at).attr("transform",t(Fe,ze)).call(n.fill,U.bgcolor)},X.mockAxis=function(N,U,te,B){var K=y.extendFlat({},te,B);return a(K,U,N),K},X.mockCartesianAxis=function(N,U,te){var B=this,K=B.isSmith,J=te._id,ee=y.extendFlat({type:"linear"},te);c(ee,N);var ne={x:[0,2],y:[1,3]};return ee.setRange=function(){var se=B.sectorBBox,oe=ne[J],me=B.radialAxis._rl,ce=(me[1]-me[0])/(1-B.getHole(U));ee.range=[se[oe[0]]*ce,se[oe[1]]*ce]},ee.isPtWithinRange=J!=="x"||K?function(){return!0}:function(se){return B.isPtInside(se)},ee.setRange(),ee.setScale(),ee},X.doAutoRange=function(N,U){var te=this.gd,B=this.radialAxis,K=this.getRadial(U);h(te,B);var J=B.range;K.range=J.slice(),K._input.range=J.slice(),B._rl=[B.r2l(J[0],null,"gregorian"),B.r2l(J[1],null,"gregorian")]},X.updateRadialAxis=function(N,U){var te=this,B=te.gd,K=te.layers,J=te.radius,ee=te.innerRadius,ne=te.cx,se=te.cy,oe=te.getRadial(U),me=j(te.getSector(U)[0],360),ce=te.radialAxis,ye=ee<J,Se=te.isSmith;Se||(te.fillViewInitialKey("radialaxis.angle",oe.angle),te.fillViewInitialKey("radialaxis.range",ce.range.slice()),ce.setGeometry()),ce.tickangle==="auto"&&me>90&&me<=270&&(ce.tickangle=180);var fe=Se?function(Oe){var Ve=z(te,P([Oe.x,0]));return t(Ve[0]-ne,Ve[1]-se)}:function(Oe){return t(ce.l2p(Oe.x)+ee,0)},ge=Se?function(Oe){return E(te,Oe.x,-1/0,1/0)}:function(Oe){return te.pathArc(ce.r2p(Oe.x)+ee)},Te=$(oe);if(te.radialTickLayout!==Te&&(K["radial-axis"].selectAll(".xtick").remove(),te.radialTickLayout=Te),ye){ce.setScale();var le=0,ve=Se?(ce.tickvals||[]).filter(function(Oe){return Oe>=0}).map(function(Oe){return g.tickText(ce,Oe,!0,!1)}):g.calcTicks(ce),Me=Se?ve:g.clipEnds(ce,ve),we=g.getTickSigns(ce)[2];Se&&((ce.ticks==="top"&&ce.side==="bottom"||ce.ticks==="bottom"&&ce.side==="top")&&(we=-we),ce.ticks==="top"&&ce.side==="top"&&(le=-ce.ticklen),ce.ticks==="bottom"&&ce.side==="bottom"&&(le=ce.ticklen)),g.drawTicks(B,ce,{vals:ve,layer:K["radial-axis"],path:g.makeTickPath(ce,0,we),transFn:fe,crisp:!1}),g.drawGrid(B,ce,{vals:Me,layer:K["radial-grid"],path:ge,transFn:y.noop,crisp:!1}),g.drawLabels(B,ce,{vals:ve,layer:K["radial-axis"],transFn:fe,labelFns:g.makeLabelFns(ce,le)})}var de=te.radialAxisAngle=te.vangles?Z(re(V(oe.angle),te.vangles)):oe.angle,Ie=t(ne,se),De=Ie+e(-de);H(K["radial-axis"],ye&&(oe.showticklabels||oe.ticks),{transform:De}),H(K["radial-grid"],ye&&oe.showgrid,{transform:Se?"":Ie}),H(K["radial-line"].select("line"),ye&&oe.showline,{x1:Se?-J:ee,y1:0,x2:J,y2:0,transform:De}).attr("stroke-width",oe.linewidth).call(n.stroke,oe.linecolor)},X.updateRadialAxisTitle=function(N,U,te){if(!this.isSmith){var B=this.gd,K=this.radius,J=this.cx,ee=this.cy,ne=this.getRadial(U),se=this.id+"title",oe=0;if(ne.title){var me=o.bBox(this.layers["radial-axis"].node()).height,ce=ne.title.font.size,ye=ne.side;oe=ye==="top"?ce:ye==="counterclockwise"?-(me+.4*ce):me+.8*ce}var Se=te!==void 0?te:this.radialAxisAngle,fe=V(Se),ge=Math.cos(fe),Te=Math.sin(fe),le=J+K/2*ge+oe*Te,ve=ee-K/2*Te+oe*ge;this.layers["radial-axis-title"]=u.draw(B,se,{propContainer:ne,propName:this.id+".radialaxis.title",placeholder:D(B,"Click to enter radial axis title"),attributes:{x:le,y:ve,"text-anchor":"middle"},transform:{rotate:-Se}})}},X.updateAngularAxis=function(N,U){var te=this,B=te.gd,K=te.layers,J=te.radius,ee=te.innerRadius,ne=te.cx,se=te.cy,oe=te.getAngular(U),me=te.angularAxis,ce=te.isSmith;ce||(te.fillViewInitialKey("angularaxis.rotation",oe.rotation),me.setGeometry(),me.setScale());var ye=ce?function(Oe){var Ve=z(te,P([0,Oe.x]));return Math.atan2(Ve[0]-ne,Ve[1]-se)-Math.PI/2}:function(Oe){return me.t2g(Oe.x)};me.type==="linear"&&me.thetaunit==="radians"&&(me.tick0=Z(me.tick0),me.dtick=Z(me.dtick));var Se=function(Oe){return t(ne+J*Math.cos(Oe),se-J*Math.sin(Oe))},fe=ce?function(Oe){var Ve=z(te,P([0,Oe.x]));return t(Ve[0],Ve[1])}:function(Oe){return Se(ye(Oe))},ge=ce?function(Oe){var Ve=z(te,P([0,Oe.x])),Fe=Math.atan2(Ve[0]-ne,Ve[1]-se)-Math.PI/2;return t(Ve[0],Ve[1])+e(-Z(Fe))}:function(Oe){var Ve=ye(Oe);return Se(Ve)+e(-Z(Ve))},Te=ce?function(Oe){return S(te,Oe.x,0,1/0)}:function(Oe){var Ve=ye(Oe),Fe=Math.cos(Ve),ze=Math.sin(Ve);return"M"+[ne+ee*Fe,se-ee*ze]+"L"+[ne+J*Fe,se-J*ze]},le=g.makeLabelFns(me,0).labelStandoff,ve={xFn:function(Oe){var Ve=ye(Oe);return Math.cos(Ve)*le},yFn:function(Oe){var Ve=ye(Oe),Fe=Math.sin(Ve)>0?.2:1;return-Math.sin(Ve)*(le+Oe.fontSize*Fe)+Math.abs(Math.cos(Ve))*(Oe.fontSize*k)},anchorFn:function(Oe){var Ve=ye(Oe),Fe=Math.cos(Ve);return Math.abs(Fe)<.1?"middle":Fe>0?"start":"end"},heightFn:function(Oe,Ve,Fe){var ze=ye(Oe);return-.5*(1+Math.sin(ze))*Fe}},Me=$(oe);te.angularTickLayout!==Me&&(K["angular-axis"].selectAll("."+me._id+"tick").remove(),te.angularTickLayout=Me);var we,de=ce?[1/0].concat(me.tickvals||[]).map(function(Oe){return g.tickText(me,Oe,!0,!1)}):g.calcTicks(me);if(ce&&(de[0].text="\u221E",de[0].fontSize*=1.75),U.gridshape==="linear"?(we=de.map(ye),y.angleDelta(we[0],we[1])<0&&(we=we.slice().reverse())):we=null,te.vangles=we,me.type==="category"&&(de=de.filter(function(Oe){return y.isAngleInsideSector(ye(Oe),te.sectorInRad)})),me.visible){var Ie=me.ticks==="inside"?-1:1,De=(me.linewidth||1)/2;g.drawTicks(B,me,{vals:de,layer:K["angular-axis"],path:"M"+Ie*De+",0h"+Ie*me.ticklen,transFn:ge,crisp:!1}),g.drawGrid(B,me,{vals:de,layer:K["angular-grid"],path:Te,transFn:y.noop,crisp:!1}),g.drawLabels(B,me,{vals:de,layer:K["angular-axis"],repositionOnUpdate:!0,transFn:fe,labelFns:ve})}H(K["angular-line"].select("path"),oe.showline,{d:te.pathSubplot(),transform:t(ne,se)}).attr("stroke-width",oe.linewidth).call(n.stroke,oe.linecolor)},X.updateFx=function(N,U){this.gd._context.staticPlot||(!this.isSmith&&(this.updateAngularDrag(N),this.updateRadialDrag(N,U,0),this.updateRadialDrag(N,U,1)),this.updateHoverAndMainDrag(N))},X.updateHoverAndMainDrag=function(N){var U,te,B=this,K=B.isSmith,J=B.gd,ee=B.layers,ne=N._zoomlayer,se=L.MINZOOM,oe=L.OFFEDGE,me=B.radius,ce=B.innerRadius,ye=B.cx,Se=B.cy,fe=B.cxx,ge=B.cyy,Te=B.sectorInRad,le=B.vangles,ve=B.radialAxis,Me=A.clampTiny,we=A.findXYatLength,de=A.findEnclosingVertexAngles,Ie=L.cornerHalfWidth,De=L.cornerLen/2,Oe=l.makeDragger(ee,"path","maindrag",N.dragmode===!1?"none":"crosshair");d.select(Oe).attr("d",B.pathSubplot()).attr("transform",t(ye,Se)),Oe.onmousemove=function(He){p.hover(J,He,B.id),J._fullLayout._lasthover=Oe,J._fullLayout._hoversubplot=B.id},Oe.onmouseout=function(He){J._dragging||s.unhover(J,He)};var Ve,Fe,ze,Re,We,$e,at,gt,xt,mt={element:Oe,gd:J,subplot:B.id,plotinfo:{id:B.id,xaxis:B.xaxis,yaxis:B.yaxis},xaxes:[B.xaxis],yaxes:[B.yaxis]};function nt(He,Je){return Math.sqrt(He*He+Je*Je)}function Qe(He,Je){return nt(He-fe,Je-ge)}function vt(He,Je){return Math.atan2(ge-Je,He-fe)}function jt(He,Je){return[He*Math.cos(Je),He*Math.sin(-Je)]}function Gt(He,Je){if(He===0)return B.pathSector(2*Ie);var Ze=De/He,ct=Je-Ze,lt=Je+Ze,At=Math.max(0,Math.min(He,me)),Ot=At-Ie,it=At+Ie;return"M"+jt(Ot,ct)+"A"+[Ot,Ot]+" 0,0,0 "+jt(Ot,lt)+"L"+jt(it,lt)+"A"+[it,it]+" 0,0,1 "+jt(it,ct)+"Z"}function $t(He,Je,Ze){if(He===0)return B.pathSector(2*Ie);var ct,lt,At=jt(He,Je),Ot=jt(He,Ze),it=Me((At[0]+Ot[0])/2),ht=Me((At[1]+Ot[1])/2);if(it&&ht){var Ut=ht/it,Mt=-1/Ut,It=we(Ie,Ut,it,ht);ct=we(De,Mt,It[0][0],It[0][1]),lt=we(De,Mt,It[1][0],It[1][1])}else{var Le,Xe;ht?(Le=De,Xe=Ie):(Le=Ie,Xe=De),ct=[[it-Le,ht-Xe],[it+Le,ht-Xe]],lt=[[it-Le,ht+Xe],[it+Le,ht+Xe]]}return"M"+ct.join("L")+"L"+lt.reverse().join("L")+"Z"}function Zt(He,Je){return Je=Math.max(Math.min(Je,me),ce),He<oe?He=0:me-He<oe?He=me:Je<oe?Je=0:me-Je<oe&&(Je=me),Math.abs(Je-He)>se?(He<Je?(ze=He,Re=Je):(ze=Je,Re=He),!0):(ze=null,Re=null,!1)}function cr(He,Je){He=He||We,Je=Je||"M0,0Z",gt.attr("d",He),xt.attr("d",Je),l.transitionZoombox(gt,xt,$e,at),$e=!0;var Ze={};_e(Ze),J.emit("plotly_relayouting",Ze)}function Dt(He,Je){var Ze,ct,lt=Ve+(He*=U),At=Fe+(Je*=te),Ot=Qe(Ve,Fe),it=Math.min(Qe(lt,At),me),ht=vt(Ve,Fe);Zt(Ot,it)&&(Ze=We+B.pathSector(Re),ze&&(Ze+=B.pathSector(ze)),ct=Gt(ze,ht)+Gt(Re,ht)),cr(Ze,ct)}function Ne(He,Je,Ze,ct){var lt=A.findIntersectionXY(Ze,ct,Ze,[He-fe,ge-Je]);return nt(lt[0],lt[1])}function Ye(He,Je){var Ze,ct,lt=Ve+He,At=Fe+Je,Ot=vt(Ve,Fe),it=vt(lt,At),ht=de(Ot,le),Ut=de(it,le);Zt(Ne(Ve,Fe,ht[0],ht[1]),Math.min(Ne(lt,At,Ut[0],Ut[1]),me))&&(Ze=We+B.pathSector(Re),ze&&(Ze+=B.pathSector(ze)),ct=[$t(ze,ht[0],ht[1]),$t(Re,ht[0],ht[1])].join(" ")),cr(Ze,ct)}function pe(){if(l.removeZoombox(J),ze!==null&&Re!==null){var He={};_e(He),l.showDoubleClickNotifier(J),w.call("_guiRelayout",J,He)}}function _e(He){var Je=ve._rl,Ze=(Je[1]-Je[0])/(1-ce/me)/me,ct=[Je[0]+(ze-ce)*Ze,Je[0]+(Re-ce)*Ze];He[B.id+".radialaxis.range"]=ct}function Be(He,Je){var Ze=J._fullLayout.clickmode;if(l.removeZoombox(J),He===2){var ct={};for(var lt in B.viewInitial)ct[B.id+"."+lt]=B.viewInitial[lt];J.emit("plotly_doubleclick",null),w.call("_guiRelayout",J,ct)}Ze.indexOf("select")>-1&&He===1&&x(Je,J,[B.xaxis],[B.yaxis],B.id,mt),Ze.indexOf("event")>-1&&p.click(J,Je,B.id)}mt.prepFn=function(He,Je,Ze){var ct=J._fullLayout.dragmode,lt=Oe.getBoundingClientRect();J._fullLayout._calcInverseTransform(J);var At=J._fullLayout._invTransform;U=J._fullLayout._invScaleX,te=J._fullLayout._invScaleY;var Ot=y.apply3DTransform(At)(Je-lt.left,Ze-lt.top);if(Ve=Ot[0],Fe=Ot[1],le){var it=A.findPolygonOffset(me,Te[0],Te[1],le);Ve+=fe+it[0],Fe+=ge+it[1]}switch(ct){case"zoom":mt.clickFn=Be,K||(mt.moveFn=le?Ye:Dt,mt.doneFn=pe,function(){ze=null,Re=null,We=B.pathSubplot(),$e=!1;var ht=J._fullLayout[B.id];at=v(ht.bgcolor).getLuminance(),(gt=l.makeZoombox(ne,at,ye,Se,We)).attr("fill-rule","evenodd"),xt=l.makeCorners(ne,ye,Se),f(J)}());break;case"select":case"lasso":i(He,Je,Ze,mt,ct)}},s.init(mt)},X.updateRadialDrag=function(N,U,te){var B=this,K=B.gd,J=B.layers,ee=B.radius,ne=B.innerRadius,se=B.cx,oe=B.cy,me=B.radialAxis,ce=L.radialDragBoxSize,ye=ce/2;if(me.visible){var Se,fe,ge,Te=V(B.radialAxisAngle),le=me._rl,ve=le[0],Me=le[1],we=le[te],de=.75*(le[1]-le[0])/(1-B.getHole(U))/ee;te?(Se=se+(ee+ye)*Math.cos(Te),fe=oe-(ee+ye)*Math.sin(Te),ge="radialdrag"):(Se=se+(ne-ye)*Math.cos(Te),fe=oe-(ne-ye)*Math.sin(Te),ge="radialdrag-inner");var Ie,De,Oe,Ve=l.makeRectDragger(J,ge,"crosshair",-ye,-ye,ce,ce),Fe={element:Ve,gd:K};N.dragmode===!1&&(Fe.dragmode=!1),H(d.select(Ve),me.visible&&ne<ee,{transform:t(Se,fe)}),Fe.prepFn=function(){Ie=null,De=null,Oe=null,Fe.moveFn=ze,Fe.doneFn=Re,f(K)},Fe.clampFn=function(at,gt){return Math.sqrt(at*at+gt*gt)<L.MINDRAG&&(at=0,gt=0),[at,gt]},s.init(Fe)}function ze(at,gt){if(Ie)Ie(at,gt);else{var xt=[at,-gt],mt=[Math.cos(Te),Math.sin(Te)],nt=Math.abs(y.dot(xt,mt)/Math.sqrt(y.dot(xt,xt)));isNaN(nt)||(Ie=nt<.5?We:$e)}var Qe={};(function(vt){De!==null?vt[B.id+".radialaxis.angle"]=De:Oe!==null&&(vt[B.id+".radialaxis.range["+te+"]"]=Oe)})(Qe),K.emit("plotly_relayouting",Qe)}function Re(){De!==null?w.call("_guiRelayout",K,B.id+".radialaxis.angle",De):Oe!==null&&w.call("_guiRelayout",K,B.id+".radialaxis.range["+te+"]",Oe)}function We(at,gt){if(te!==0){var xt=Se+at,mt=fe+gt;De=Math.atan2(oe-mt,xt-se),B.vangles&&(De=re(De,B.vangles)),De=Z(De);var nt=t(se,oe)+e(-De);J["radial-axis"].attr("transform",nt),J["radial-line"].select("line").attr("transform",nt);var Qe=B.gd._fullLayout,vt=Qe[B.id];B.updateRadialAxisTitle(Qe,vt,De)}}function $e(at,gt){var xt=y.dot([at,-gt],[Math.cos(Te),Math.sin(Te)]);if(Oe=we-de*xt,de>0==(te?Oe>ve:Oe<Me)){var mt=K._fullLayout,nt=mt[B.id];me.range[te]=Oe,me._rl[te]=Oe,B.updateRadialAxis(mt,nt),B.xaxis.setRange(),B.xaxis.setScale(),B.yaxis.setRange(),B.yaxis.setScale();var Qe=!1;for(var vt in B.traceHash){var jt=B.traceHash[vt],Gt=y.filterVisible(jt);jt[0][0].trace._module.plot(K,B,Gt,nt),w.traceIs(vt,"gl")&&Gt.length&&(Qe=!0)}Qe&&(b(K),T(K))}else Oe=null}},X.updateAngularDrag=function(N){var U=this,te=U.gd,B=U.layers,K=U.radius,J=U.angularAxis,ee=U.cx,ne=U.cy,se=U.cxx,oe=U.cyy,me=L.angularDragBoxSize,ce=l.makeDragger(B,"path","angulardrag",N.dragmode===!1?"none":"move"),ye={element:ce,gd:te};function Se(Fe,ze){return Math.atan2(oe+me-ze,Fe-se-me)}N.dragmode===!1?ye.dragmode=!1:d.select(ce).attr("d",U.pathAnnulus(K,K+me)).attr("transform",t(ee,ne)).call(_,"move");var fe,ge,Te,le,ve,Me,we=B.frontplot.select(".scatterlayer").selectAll(".trace"),de=we.selectAll(".point"),Ie=we.selectAll(".textpoint");function De(Fe,ze){var Re=U.gd._fullLayout,We=Re[U.id],$e=Se(fe+Fe*N._invScaleX,ge+ze*N._invScaleY),at=Z($e-Me);if(le=Te+at,B.frontplot.attr("transform",t(U.xOffset2,U.yOffset2)+e([-at,se,oe])),U.vangles){ve=U.radialAxisAngle+at;var gt=t(ee,ne)+e(-at),xt=t(ee,ne)+e(-ve);B.bg.attr("transform",gt),B["radial-grid"].attr("transform",gt),B["radial-axis"].attr("transform",xt),B["radial-line"].select("line").attr("transform",xt),U.updateRadialAxisTitle(Re,We,ve)}else U.clipPaths.forTraces.select("path").attr("transform",t(se,oe)+e(at));de.each(function(){var Gt=d.select(this),$t=o.getTranslate(Gt);Gt.attr("transform",t($t.x,$t.y)+e([at]))}),Ie.each(function(){var Gt=d.select(this),$t=Gt.select("text"),Zt=o.getTranslate(Gt);Gt.attr("transform",e([at,$t.attr("x"),$t.attr("y")])+t(Zt.x,Zt.y))}),J.rotation=y.modHalf(le,360),U.updateAngularAxis(Re,We),U._hasClipOnAxisFalse&&!y.isFullCircle(U.sectorInRad)&&we.call(o.hideOutsideRangePoints,U);var mt=!1;for(var nt in U.traceHash)if(w.traceIs(nt,"gl")){var Qe=U.traceHash[nt],vt=y.filterVisible(Qe);Qe[0][0].trace._module.plot(te,U,vt,We),vt.length&&(mt=!0)}mt&&(b(te),T(te));var jt={};Oe(jt),te.emit("plotly_relayouting",jt)}function Oe(Fe){Fe[U.id+".angularaxis.rotation"]=le,U.vangles&&(Fe[U.id+".radialaxis.angle"]=ve)}function Ve(){Ie.select("text").attr("transform",null);var Fe={};Oe(Fe),w.call("_guiRelayout",te,Fe)}ye.prepFn=function(Fe,ze,Re){var We=N[U.id];Te=We.angularaxis.rotation;var $e=ce.getBoundingClientRect();fe=ze-$e.left,ge=Re-$e.top,te._fullLayout._calcInverseTransform(te);var at=y.apply3DTransform(N._invTransform)(fe,ge);fe=at[0],ge=at[1],Me=Se(fe,ge),ye.moveFn=De,ye.doneFn=Ve,f(te)},U.vangles&&!y.isFullCircle(U.sectorInRad)&&(ye.prepFn=y.noop,_(d.select(ce),null)),s.init(ye)},X.isPtInside=function(N){if(this.isSmith)return!0;var U=this.sectorInRad,te=this.vangles,B=this.angularAxis.c2g(N.theta),K=this.radialAxis,J=K.c2l(N.r),ee=K._rl;return(te?A.isPtInsidePolygon:y.isPtInsideSector)(J,B,ee,U,te)},X.pathArc=function(N){var U=this.sectorInRad,te=this.vangles;return(te?A.pathPolygon:y.pathArc)(N,U[0],U[1],te)},X.pathSector=function(N){var U=this.sectorInRad,te=this.vangles;return(te?A.pathPolygon:y.pathSector)(N,U[0],U[1],te)},X.pathAnnulus=function(N,U){var te=this.sectorInRad,B=this.vangles;return(B?A.pathPolygonAnnulus:y.pathAnnulus)(N,U,te[0],te[1],B)},X.pathSubplot=function(){var N=this.innerRadius,U=this.radius;return N?this.pathAnnulus(N,U):this.pathSector(U)},X.fillViewInitialKey=function(N,U){N in this.viewInitial||(this.viewInitial[N]=U)}},{"../../components/color":367,"../../components/dragelement":386,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../components/titles":476,"../../constants/alignment":483,"../../lib":515,"../../lib/clear_gl_canvases":499,"../../lib/setcursor":536,"../../plot_api/subroutines":556,"../../plots/cartesian/axes":566,"../../registry":647,"../cartesian/autorange":565,"../cartesian/dragbox":575,"../cartesian/set_convert":585,"../plots":628,"../smith/helpers":637,"./constants":629,"./helpers":630,"./set_convert":635,"@plotly/d3":58,tinycolor2:313}],635:[function(m,G,Y){var d=m("../../lib"),v=m("../cartesian/set_convert"),w=d.deg2rad,y=d.rad2deg;G.exports=function(e,t,n){switch(v(e,n),e._id){case"x":case"radialaxis":(function(o,r){var g=r._subplot;o.setGeometry=function(){var c=o._rl[0],a=o._rl[1],h=g.innerRadius,l=(g.radius-h)/(a-c),s=h/l,p=c>a?function(u){return u<=0}:function(u){return u>=0};o.c2g=function(u){var i=o.c2l(u)-c;return(p(i)?i:0)+s},o.g2c=function(u){return o.l2c(u+c-s)},o.g2p=function(u){return u*l},o.c2p=function(u){return o.g2p(o.c2g(u))}}})(e,t);break;case"angularaxis":(function(o,r){var g=o.type;if(g==="linear"){var c=o.d2c,a=o.c2d;o.d2c=function(h,l){return function(s,p){return p==="degrees"?w(s):s}(c(h),l)},o.c2d=function(h,l){return a(function(s,p){return p==="degrees"?y(s):s}(h,l))}}o.makeCalcdata=function(h,l){var s,p,u=h[l],i=h._length,x=function(k){return o.d2c(k,h.thetaunit)};if(u){if(d.isTypedArray(u)&&g==="linear"){if(i===u.length)return u;if(u.subarray)return u.subarray(0,i)}for(s=new Array(i),p=0;p<i;p++)s[p]=x(u[p])}else{var f=l+"0",_="d"+l,b=f in h?x(h[f]):0,T=h[_]?x(h[_]):(o.period||2*Math.PI)/i;for(s=new Array(i),p=0;p<i;p++)s[p]=b+p*T}return s},o.setGeometry=function(){var h,l,s,p,u=r.sector,i=u.map(w),x={clockwise:-1,counterclockwise:1}[o.direction],f=w(o.rotation),_=function(L){return x*L+f},b=function(L){return(L-f)/x};switch(g){case"linear":l=h=d.identity,p=w,s=y,o.range=d.isFullCircle(i)?[u[0],u[0]+360]:i.map(b).map(y);break;case"category":var T=o._categories.length,k=o.period?Math.max(o.period,T):T;k===0&&(k=1),l=p=function(L){return 2*L*Math.PI/k},h=s=function(L){return L*k/Math.PI/2},o.range=[0,k]}o.c2g=function(L){return _(l(L))},o.g2c=function(L){return h(b(L))},o.t2g=function(L){return _(p(L))},o.g2t=function(L){return s(b(L))}}})(e,t)}}},{"../../lib":515,"../cartesian/set_convert":585}],636:[function(m,G,Y){G.exports={attr:"subplot",name:"smith",axisNames:["realaxis","imaginaryaxis"],axisName2dataArray:{imaginaryaxis:"imag",realaxis:"real"}}},{}],637:[function(m,G,Y){function d(e){return e<0?-1:e>0?1:0}function v(e){var t=e[0],n=e[1];if(!isFinite(t)||!isFinite(n))return[1,0];var o=(t+1)*(t+1)+n*n;return[(t*t+n*n-1)/o,2*n/o]}function w(e,t){var n=t[0],o=t[1];return[n*e.radius+e.cx,-o*e.radius+e.cy]}function y(e,t){return t*e.radius}G.exports={smith:v,reactanceArc:function(e,t,n,o){var r=w(e,v([n,t])),g=r[0],c=r[1],a=w(e,v([o,t])),h=a[0],l=a[1];if(t===0)return["M"+g+","+c,"L"+h+","+l].join(" ");var s=y(e,1/Math.abs(t));return["M"+g+","+c,"A"+s+","+s+" 0 0,"+(t<0?1:0)+" "+h+","+l].join(" ")},resistanceArc:function(e,t,n,o){var r=y(e,1/(t+1)),g=w(e,v([t,n])),c=g[0],a=g[1],h=w(e,v([t,o])),l=h[0],s=h[1];if(d(n)!==d(o)){var p=w(e,v([t,0]));return["M"+c+","+a,"A"+r+","+r+" 0 0,"+(0<n?0:1)+" "+p[0]+","+p[1],"A"+r+","+r+" 0 0,"+(o<0?0:1)+l+","+s].join(" ")}return["M"+c+","+a,"A"+r+","+r+" 0 0,"+(o<n?0:1)+" "+l+","+s].join(" ")},smithTransform:w}},{}],638:[function(m,G,Y){var d=m("../get_data").getSubplotCalcData,v=m("../../lib").counterRegex,w=m("../polar/polar"),y=m("./constants"),e=y.attr,t=y.name,n=v(t),o={};o[e]={valType:"subplotid",dflt:t,editType:"calc"},G.exports={attr:e,name:t,idRoot:t,idRegex:n,attrRegex:n,attributes:o,layoutAttributes:m("./layout_attributes"),supplyLayoutDefaults:m("./layout_defaults"),plot:function(r){for(var g=r._fullLayout,c=r.calcdata,a=g._subplots[t],h=0;h<a.length;h++){var l=a[h],s=d(c,t,l),p=g[l]._subplot;p||(p=w(r,l,!0),g[l]._subplot=p),p.plot(s,g,r._promises)}},clean:function(r,g,c,a){for(var h=a._subplots[t]||[],l=0;l<h.length;l++){var s=h[l],p=a[s]._subplot;if(!g[s]&&p)for(var u in p.framework.remove(),p.clipPaths)p.clipPaths[u].remove()}},toSVG:m("../cartesian").toSVG}},{"../../lib":515,"../cartesian":578,"../get_data":602,"../polar/polar":634,"./constants":636,"./layout_attributes":639,"./layout_defaults":640}],639:[function(m,G,Y){var d=m("../../components/color/attributes"),v=m("../cartesian/layout_attributes"),w=m("../domain").attributes,y=m("../../lib").extendFlat,e=m("../../plot_api/edit_types").overrideAll,t=e({color:v.color,showline:y({},v.showline,{dflt:!0}),linecolor:v.linecolor,linewidth:v.linewidth,showgrid:y({},v.showgrid,{dflt:!0}),gridcolor:v.gridcolor,gridwidth:v.gridwidth,griddash:v.griddash},"plot","from-root"),n=e({ticklen:v.ticklen,tickwidth:y({},v.tickwidth,{dflt:2}),tickcolor:v.tickcolor,showticklabels:v.showticklabels,showtickprefix:v.showtickprefix,tickprefix:v.tickprefix,showticksuffix:v.showticksuffix,ticksuffix:v.ticksuffix,tickfont:v.tickfont,tickformat:v.tickformat,hoverformat:v.hoverformat,layer:v.layer},"plot","from-root"),o=y({visible:y({},v.visible,{dflt:!0}),tickvals:{dflt:[.2,.5,1,2,5],valType:"data_array",editType:"plot"},tickangle:y({},v.tickangle,{dflt:90}),ticks:{valType:"enumerated",values:["top","bottom",""],editType:"ticks"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},editType:"calc"},t,n),r=y({visible:y({},v.visible,{dflt:!0}),tickvals:{valType:"data_array",editType:"plot"},ticks:v.ticks,editType:"calc"},t,n);G.exports={domain:w({name:"smith",editType:"plot"}),bgcolor:{valType:"color",editType:"plot",dflt:d.background},realaxis:o,imaginaryaxis:r,editType:"calc"}},{"../../components/color/attributes":366,"../../lib":515,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],640:[function(m,G,Y){var d,v,w,y=m("../../lib"),e=m("../../components/color"),t=m("../../plot_api/plot_template"),n=m("../subplot_defaults"),o=m("../get_data").getSubplotData,r=m("../cartesian/prefix_suffix_defaults"),g=m("../cartesian/tick_label_defaults"),c=m("../cartesian/line_grid_defaults"),a=m("../cartesian/set_convert"),h=m("./layout_attributes"),l=m("./constants"),s=l.axisNames,p=(d=function(i){return i.slice().reverse().map(function(x){return-x}).concat([0]).concat(i)},v=String,w={},function(i){var x=v?v(i):i;if(x in w)return w[x];var f=d(i);return w[x]=f,f});function u(i,x,f,_){var b=f("bgcolor");_.bgColor=e.combine(b,_.paper_bgcolor);var T,k=o(_.fullData,l.name,_.id),L=_.layoutOut;function A(X,$){return f(T+"."+X,$)}for(var I=0;I<s.length;I++){T=s[I],y.isPlainObject(i[T])||(i[T]={});var P=i[T],S=t.newContainer(x,T);S._id=S._name=T,S._attr=_.id+"."+T,S._traceIndices=k.map(function(X){return X._expandedIndex});var E=A("visible");if(S.type="linear",a(S,L),r(P,S,A,S.type),E){var z,D,j,V,Z=T==="realaxis";Z&&A("side"),Z?A("tickvals"):A("tickvals",p(x.realaxis.tickvals||h.realaxis.tickvals.dflt));var Q=_.font||{};E&&(D=(z=A("color"))===P.color?z:Q.color,j=Q.size,V=Q.family),g(P,S,A,S.type,{noTicklabelstep:!0,noAng:!Z,noExp:!0,font:{color:D,size:j,family:V}}),y.coerce2(i,x,h,T+".ticklen"),y.coerce2(i,x,h,T+".tickwidth"),y.coerce2(i,x,h,T+".tickcolor",x.color),A("ticks")||(delete x[T].ticklen,delete x[T].tickwidth,delete x[T].tickcolor),c(P,S,A,{dfltColor:z,bgColor:_.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:h[T]}),A("layer")}A("hoverformat"),delete S.type,S._input=P}}G.exports=function(i,x,f){n(i,x,f,{noUirevision:!0,type:l.name,attributes:h,handleDefaults:u,font:x.font,paper_bgcolor:x.paper_bgcolor,fullData:f,layoutOut:x})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/set_convert":585,"../cartesian/tick_label_defaults":587,"../get_data":602,"../subplot_defaults":641,"./constants":636,"./layout_attributes":639}],641:[function(m,G,Y){var d=m("../lib"),v=m("../plot_api/plot_template"),w=m("./domain").defaults;G.exports=function(y,e,t,n){var o,r,g=n.type,c=n.attributes,a=n.handleDefaults,h=n.partition||"x",l=e._subplots[g],s=l.length,p=s&&l[0].replace(/\d+$/,"");function u(_,b){return d.coerce(o,r,c,_,b)}for(var i=0;i<s;i++){var x=l[i];o=y[x]?y[x]:y[x]={},r=v.newContainer(e,x,p),n.noUirevision||u("uirevision",e.uirevision);var f={};f[h]=[i/s,(i+1)/s],w(r,e,u,f),n.id=x,a(o,r,u,n)}}},{"../lib":515,"../plot_api/plot_template":555,"./domain":593}],642:[function(m,G,Y){var d=m("../constants/docs");d.FORMAT_LINK,d.DATE_FORMAT_LINK;function v(w){var y=w.description?" "+w.description:"",e=w.keys||[];if(e.length>0){for(var t=[],n=0;n<e.length;n++)t[n]="`"+e[n]+"`";y+="Finally, the template string has access to ",y=e.length===1?"variable "+t[0]:"variables "+t.slice(0,-1).join(", ")+" and "+t.slice(-1)+"."}return y}Y.hovertemplateAttrs=function(w,y){w=w||{},v(y=y||{});var e={valType:"string",dflt:"",editType:w.editType||"none"};return w.arrayOk!==!1&&(e.arrayOk=!0),e},Y.texttemplateAttrs=function(w,y){w=w||{},v(y=y||{});var e={valType:"string",dflt:"",editType:w.editType||"calc"};return w.arrayOk!==!1&&(e.arrayOk=!0),e}},{"../constants/docs":486}],643:[function(m,G,Y){var d=m("./ternary"),v=m("../../plots/get_data").getSubplotCalcData,w=m("../../lib").counterRegex;Y.name="ternary";var y=Y.attr="subplot";Y.idRoot="ternary",Y.idRegex=Y.attrRegex=w("ternary"),(Y.attributes={})[y]={valType:"subplotid",dflt:"ternary",editType:"calc"},Y.layoutAttributes=m("./layout_attributes"),Y.supplyLayoutDefaults=m("./layout_defaults"),Y.plot=function(e){for(var t=e._fullLayout,n=e.calcdata,o=t._subplots.ternary,r=0;r<o.length;r++){var g=o[r],c=v(n,"ternary",g),a=t[g]._subplot;a||(a=new d({id:g,graphDiv:e,container:t._ternarylayer.node()},t),t[g]._subplot=a),a.plot(c,t,e._promises)}},Y.clean=function(e,t,n,o){for(var r=o._subplots.ternary||[],g=0;g<r.length;g++){var c=r[g],a=o[c]._subplot;!t[c]&&a&&(a.plotContainer.remove(),a.clipDef.remove(),a.clipDefRelative.remove(),a.layers["a-title"].remove(),a.layers["b-title"].remove(),a.layers["c-title"].remove())}}},{"../../lib":515,"../../plots/get_data":602,"./layout_attributes":644,"./layout_defaults":645,"./ternary":646}],644:[function(m,G,Y){var d=m("../../components/color/attributes"),v=m("../domain").attributes,w=m("../cartesian/layout_attributes"),y=m("../../plot_api/edit_types").overrideAll,e=m("../../lib/extend").extendFlat,t={title:{text:w.title.text,font:w.title.font},color:w.color,tickmode:w.tickmode,nticks:e({},w.nticks,{dflt:6,min:1}),tick0:w.tick0,dtick:w.dtick,tickvals:w.tickvals,ticktext:w.ticktext,ticks:w.ticks,ticklen:w.ticklen,tickwidth:w.tickwidth,tickcolor:w.tickcolor,ticklabelstep:w.ticklabelstep,showticklabels:w.showticklabels,showtickprefix:w.showtickprefix,tickprefix:w.tickprefix,showticksuffix:w.showticksuffix,ticksuffix:w.ticksuffix,showexponent:w.showexponent,exponentformat:w.exponentformat,minexponent:w.minexponent,separatethousands:w.separatethousands,tickfont:w.tickfont,tickangle:w.tickangle,tickformat:w.tickformat,tickformatstops:w.tickformatstops,hoverformat:w.hoverformat,showline:e({},w.showline,{dflt:!0}),linecolor:w.linecolor,linewidth:w.linewidth,showgrid:e({},w.showgrid,{dflt:!0}),gridcolor:w.gridcolor,gridwidth:w.gridwidth,griddash:w.griddash,layer:w.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:w._deprecated.title,titlefont:w._deprecated.titlefont}},n=G.exports=y({domain:v({name:"ternary"}),bgcolor:{valType:"color",dflt:d.background},sum:{valType:"number",dflt:1,min:0},aaxis:t,baxis:t,caxis:t},"plot","from-root");n.uirevision={valType:"any",editType:"none"},n.aaxis.uirevision=n.baxis.uirevision=n.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plot_api/edit_types":548,"../cartesian/layout_attributes":579,"../domain":593}],645:[function(m,G,Y){var d=m("../../components/color"),v=m("../../plot_api/plot_template"),w=m("../../lib"),y=m("../subplot_defaults"),e=m("../cartesian/tick_label_defaults"),t=m("../cartesian/prefix_suffix_defaults"),n=m("../cartesian/tick_mark_defaults"),o=m("../cartesian/tick_value_defaults"),r=m("../cartesian/line_grid_defaults"),g=m("./layout_attributes"),c=["aaxis","baxis","caxis"];function a(l,s,p,u){var i,x,f,_=p("bgcolor"),b=p("sum");u.bgColor=d.combine(_,u.paper_bgcolor);for(var T=0;T<c.length;T++)x=l[i=c[T]]||{},(f=v.newContainer(s,i))._name=i,h(x,f,u,s);var k=s.aaxis,L=s.baxis,A=s.caxis;k.min+L.min+A.min>=b&&(k.min=0,L.min=0,A.min=0,l.aaxis&&delete l.aaxis.min,l.baxis&&delete l.baxis.min,l.caxis&&delete l.caxis.min)}function h(l,s,p,u){var i=g[s._name];function x(L,A){return w.coerce(l,s,i,L,A)}x("uirevision",u.uirevision),s.type="linear";var f=x("color"),_=f!==i.color.dflt?f:p.font.color,b=s._name.charAt(0).toUpperCase(),T="Component "+b,k=x("title.text",T);s._hovertitle=k===T?k:b,w.coerceFont(x,"title.font",{family:p.font.family,size:w.bigFont(p.font.size),color:_}),x("min"),o(l,s,x,"linear"),t(l,s,x,"linear"),e(l,s,x,"linear"),n(l,s,x,{outerTicks:!0}),x("showticklabels")&&(w.coerceFont(x,"tickfont",{family:p.font.family,size:p.font.size,color:_}),x("tickangle"),x("tickformat")),r(l,s,x,{dfltColor:f,bgColor:p.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:i}),x("hoverformat"),x("layer")}G.exports=function(l,s,p){y(l,s,p,{type:"ternary",attributes:g,handleDefaults:a,font:s.font,paper_bgcolor:s.paper_bgcolor})}},{"../../components/color":367,"../../lib":515,"../../plot_api/plot_template":555,"../cartesian/line_grid_defaults":581,"../cartesian/prefix_suffix_defaults":583,"../cartesian/tick_label_defaults":587,"../cartesian/tick_mark_defaults":588,"../cartesian/tick_value_defaults":589,"../subplot_defaults":641,"./layout_attributes":644}],646:[function(m,G,Y){var d=m("@plotly/d3"),v=m("tinycolor2"),w=m("../../registry"),y=m("../../lib"),e=y.strTranslate,t=y._,n=m("../../components/color"),o=m("../../components/drawing"),r=m("../cartesian/set_convert"),g=m("../../lib/extend").extendFlat,c=m("../plots"),a=m("../cartesian/axes"),h=m("../../components/dragelement"),l=m("../../components/fx"),s=m("../../components/dragelement/helpers"),p=s.freeMode,u=s.rectMode,i=m("../../components/titles"),x=m("../../components/selections").prepSelect,f=m("../../components/selections").selectOnClick,_=m("../../components/selections").clearOutline,b=m("../../components/selections").clearSelectionsCache,T=m("../cartesian/constants");function k(j,V){this.id=j.id,this.graphDiv=j.graphDiv,this.init(V),this.makeFramework(V),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}G.exports=k;var L=k.prototype;L.init=function(j){this.container=j._ternarylayer,this.defs=j._defs,this.layoutId=j._uid,this.traceHash={},this.layers={}},L.plot=function(j,V){var Z=V[this.id],Q=V._size;this._hasClipOnAxisFalse=!1;for(var X=0;X<j.length;X++)if(j[X][0].trace.cliponaxis===!1){this._hasClipOnAxisFalse=!0;break}this.updateLayers(Z),this.adjustLayout(Z,Q),c.generalUpdatePerTraceModule(this.graphDiv,this,j,Z),this.layers.plotbg.select("path").call(n.fill,Z.bgcolor)},L.makeFramework=function(j){var V=this.graphDiv,Z=j[this.id],Q=this.clipId="clip"+this.layoutId+this.id,X=this.clipIdRelative="clip-relative"+this.layoutId+this.id;this.clipDef=y.ensureSingleById(j._clips,"clipPath",Q,function($){$.append("path").attr("d","M0,0Z")}),this.clipDefRelative=y.ensureSingleById(j._clips,"clipPath",X,function($){$.append("path").attr("d","M0,0Z")}),this.plotContainer=y.ensureSingle(this.container,"g",this.id),this.updateLayers(Z),o.setClipUrl(this.layers.backplot,Q,V),o.setClipUrl(this.layers.grids,Q,V)},L.updateLayers=function(j){var V=this.layers,Z=["draglayer","plotbg","backplot","grids"];j.aaxis.layer==="below traces"&&Z.push("aaxis","aline"),j.baxis.layer==="below traces"&&Z.push("baxis","bline"),j.caxis.layer==="below traces"&&Z.push("caxis","cline"),Z.push("frontplot"),j.aaxis.layer==="above traces"&&Z.push("aaxis","aline"),j.baxis.layer==="above traces"&&Z.push("baxis","bline"),j.caxis.layer==="above traces"&&Z.push("caxis","cline");var Q=this.plotContainer.selectAll("g.toplevel").data(Z,String),X=["agrid","bgrid","cgrid"];Q.enter().append("g").attr("class",function($){return"toplevel "+$}).each(function($){var re=d.select(this);V[$]=re,$==="frontplot"?re.append("g").classed("scatterlayer",!0):$==="backplot"?re.append("g").classed("maplayer",!0):$==="plotbg"?re.append("path").attr("d","M0,0Z"):$==="aline"||$==="bline"||$==="cline"?re.append("path"):$==="grids"&&X.forEach(function(H){V[H]=re.append("g").classed("grid "+H,!0)})}),Q.order()};var A=Math.sqrt(4/3);L.adjustLayout=function(j,V){var Z,Q,X,$,re,H,N=this,U=j.domain,te=(U.x[0]+U.x[1])/2,B=(U.y[0]+U.y[1])/2,K=U.x[1]-U.x[0],J=U.y[1]-U.y[0],ee=K*V.w,ne=J*V.h,se=j.sum,oe=j.aaxis.min,me=j.baxis.min,ce=j.caxis.min;ee>A*ne?X=($=ne)*A:$=(X=ee)/A,re=K*X/ee,H=J*$/ne,Z=V.l+V.w*te-X/2,Q=V.t+V.h*(1-B)-$/2,N.x0=Z,N.y0=Q,N.w=X,N.h=$,N.sum=se,N.xaxis={type:"linear",range:[oe+2*ce-se,se-oe-2*me],domain:[te-re/2,te+re/2],_id:"x"},r(N.xaxis,N.graphDiv._fullLayout),N.xaxis.setScale(),N.xaxis.isPtWithinRange=function(Ie){return Ie.a>=N.aaxis.range[0]&&Ie.a<=N.aaxis.range[1]&&Ie.b>=N.baxis.range[1]&&Ie.b<=N.baxis.range[0]&&Ie.c>=N.caxis.range[1]&&Ie.c<=N.caxis.range[0]},N.yaxis={type:"linear",range:[oe,se-me-ce],domain:[B-H/2,B+H/2],_id:"y"},r(N.yaxis,N.graphDiv._fullLayout),N.yaxis.setScale(),N.yaxis.isPtWithinRange=function(){return!0};var ye=N.yaxis.domain[0],Se=N.aaxis=g({},j.aaxis,{range:[oe,se-me-ce],side:"left",tickangle:(+j.aaxis.tickangle||0)-30,domain:[ye,ye+H*A],anchor:"free",position:0,_id:"y",_length:X});r(Se,N.graphDiv._fullLayout),Se.setScale();var fe=N.baxis=g({},j.baxis,{range:[se-oe-ce,me],side:"bottom",domain:N.xaxis.domain,anchor:"free",position:0,_id:"x",_length:X});r(fe,N.graphDiv._fullLayout),fe.setScale();var ge=N.caxis=g({},j.caxis,{range:[se-oe-me,ce],side:"right",tickangle:(+j.caxis.tickangle||0)+30,domain:[ye,ye+H*A],anchor:"free",position:0,_id:"y",_length:X});r(ge,N.graphDiv._fullLayout),ge.setScale();var Te="M"+Z+","+(Q+$)+"h"+X+"l-"+X/2+",-"+$+"Z";N.clipDef.select("path").attr("d",Te),N.layers.plotbg.select("path").attr("d",Te);var le="M0,"+$+"h"+X+"l-"+X/2+",-"+$+"Z";N.clipDefRelative.select("path").attr("d",le);var ve=e(Z,Q);N.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",ve),N.clipDefRelative.select("path").attr("transform",null);var Me=e(Z-fe._offset,Q+$);N.layers.baxis.attr("transform",Me),N.layers.bgrid.attr("transform",Me);var we=e(Z+X/2,Q)+"rotate(30)"+e(0,-Se._offset);N.layers.aaxis.attr("transform",we),N.layers.agrid.attr("transform",we);var de=e(Z+X/2,Q)+"rotate(-30)"+e(0,-ge._offset);N.layers.caxis.attr("transform",de),N.layers.cgrid.attr("transform",de),N.drawAxes(!0),N.layers.aline.select("path").attr("d",Se.showline?"M"+Z+","+(Q+$)+"l"+X/2+",-"+$:"M0,0").call(n.stroke,Se.linecolor||"#000").style("stroke-width",(Se.linewidth||0)+"px"),N.layers.bline.select("path").attr("d",fe.showline?"M"+Z+","+(Q+$)+"h"+X:"M0,0").call(n.stroke,fe.linecolor||"#000").style("stroke-width",(fe.linewidth||0)+"px"),N.layers.cline.select("path").attr("d",ge.showline?"M"+(Z+X/2)+","+Q+"l"+X/2+","+$:"M0,0").call(n.stroke,ge.linecolor||"#000").style("stroke-width",(ge.linewidth||0)+"px"),N.graphDiv._context.staticPlot||N.initInteractions(),o.setClipUrl(N.layers.frontplot,N._hasClipOnAxisFalse?null:N.clipId,N.graphDiv)},L.drawAxes=function(j){var V=this.graphDiv,Z=this.id.substr(7)+"title",Q=this.layers,X=this.aaxis,$=this.baxis,re=this.caxis;if(this.drawAx(X),this.drawAx($),this.drawAx(re),j){var H=Math.max(X.showticklabels?X.tickfont.size/2:0,(re.showticklabels?.75*re.tickfont.size:0)+(re.ticks==="outside"?.87*re.ticklen:0)),N=($.showticklabels?$.tickfont.size:0)+($.ticks==="outside"?$.ticklen:0)+3;Q["a-title"]=i.draw(V,"a"+Z,{propContainer:X,propName:this.id+".aaxis.title",placeholder:t(V,"Click to enter Component A title"),attributes:{x:this.x0+this.w/2,y:this.y0-X.title.font.size/3-H,"text-anchor":"middle"}}),Q["b-title"]=i.draw(V,"b"+Z,{propContainer:$,propName:this.id+".baxis.title",placeholder:t(V,"Click to enter Component B title"),attributes:{x:this.x0-N,y:this.y0+this.h+.83*$.title.font.size+N,"text-anchor":"middle"}}),Q["c-title"]=i.draw(V,"c"+Z,{propContainer:re,propName:this.id+".caxis.title",placeholder:t(V,"Click to enter Component C title"),attributes:{x:this.x0+this.w+N,y:this.y0+this.h+.83*re.title.font.size+N,"text-anchor":"middle"}})}},L.drawAx=function(j){var V,Z=this.graphDiv,Q=j._name,X=Q.charAt(0),$=j._id,re=this.layers[Q],H=X+"tickLayout",N=(V=j).ticks+String(V.ticklen)+String(V.showticklabels);this[H]!==N&&(re.selectAll("."+$+"tick").remove(),this[H]=N),j.setScale();var U=a.calcTicks(j),te=a.clipEnds(j,U),B=a.makeTransTickFn(j),K=a.getTickSigns(j)[2],J=y.deg2rad(30),ee=K*(j.linewidth||1)/2,ne=K*j.ticklen,se=this.w,oe=this.h,me=X==="b"?"M0,"+ee+"l"+Math.sin(J)*ne+","+Math.cos(J)*ne:"M"+ee+",0l"+Math.cos(J)*ne+","+-Math.sin(J)*ne,ce={a:"M0,0l"+oe+",-"+se/2,b:"M0,0l-"+se/2+",-"+oe,c:"M0,0l-"+oe+","+se/2}[X];a.drawTicks(Z,j,{vals:j.ticks==="inside"?te:U,layer:re,path:me,transFn:B,crisp:!1}),a.drawGrid(Z,j,{vals:te,layer:this.layers[X+"grid"],path:ce,transFn:B,crisp:!1}),a.drawLabels(Z,j,{vals:U,layer:re,transFn:B,labelFns:a.makeLabelFns(j,0,30)})};var I=T.MINZOOM/2+.87,P="m-0.87,.5h"+I+"v3h-"+(I+5.2)+"l"+(I/2+2.6)+",-"+(.87*I+4.5)+"l2.6,1.5l-"+I/2+","+.87*I+"Z",S="m0.87,.5h-"+I+"v3h"+(I+5.2)+"l-"+(I/2+2.6)+",-"+(.87*I+4.5)+"l-2.6,1.5l"+I/2+","+.87*I+"Z",E="m0,1l"+I/2+","+.87*I+"l2.6,-1.5l-"+(I/2+2.6)+",-"+(.87*I+4.5)+"l-"+(I/2+2.6)+","+(.87*I+4.5)+"l2.6,1.5l"+I/2+",-"+.87*I+"Z",z=!0;function D(j){d.select(j).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}L.clearOutline=function(){b(this.dragOptions),_(this.dragOptions.gd)},L.initInteractions=function(){var j,V,Z,Q,X,$,re,H,N,U,te,B,K=this,J=K.layers.plotbg.select("path").node(),ee=K.graphDiv,ne=ee._fullLayout._zoomlayer;function se(le){var ve={};return ve[K.id+".aaxis.min"]=le.a,ve[K.id+".baxis.min"]=le.b,ve[K.id+".caxis.min"]=le.c,ve}function oe(le,ve){var Me=ee._fullLayout.clickmode;D(ee),le===2&&(ee.emit("plotly_doubleclick",null),w.call("_guiRelayout",ee,se({a:0,b:0,c:0}))),Me.indexOf("select")>-1&&le===1&&f(ve,ee,[K.xaxis],[K.yaxis],K.id,K.dragOptions),Me.indexOf("event")>-1&&l.click(ee,ve,K.id)}function me(le,ve){return 1-ve/K.h}function ce(le,ve){return 1-(le+(K.h-ve)/Math.sqrt(3))/K.w}function ye(le,ve){return(le-(K.h-ve)/Math.sqrt(3))/K.w}function Se(le,ve){var Me=Z+le*j,we=Q+ve*V,de=Math.max(0,Math.min(1,me(0,Q),me(0,we))),Ie=Math.max(0,Math.min(1,ce(Z,Q),ce(Me,we))),De=Math.max(0,Math.min(1,ye(Z,Q),ye(Me,we))),Oe=(de/2+De)*K.w,Ve=(1-de/2-Ie)*K.w,Fe=(Oe+Ve)/2,ze=Ve-Oe,Re=(1-de)*K.h,We=Re-ze/A;ze<T.MINZOOM?(re=X,te.attr("d",N),B.attr("d","M0,0Z")):(re={a:X.a+de*$,b:X.b+Ie*$,c:X.c+De*$},te.attr("d",N+"M"+Oe+","+Re+"H"+Ve+"L"+Fe+","+We+"L"+Oe+","+Re+"Z"),B.attr("d","M"+Z+","+Q+"m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2ZM"+Oe+","+Re+P+"M"+Ve+","+Re+S+"M"+Fe+","+We+E)),U||(te.transition().style("fill",H>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),B.transition().style("opacity",1).duration(200),U=!0),ee.emit("plotly_relayouting",se(re))}function fe(){D(ee),re!==X&&(w.call("_guiRelayout",ee,se(re)),z&&ee.data&&ee._context.showTips&&(y.notifier(t(ee,"Double-click to zoom back out"),"long"),z=!1))}function ge(le,ve){var Me=le/K.xaxis._m,we=ve/K.yaxis._m,de=[(re={a:X.a-we,b:X.b+(Me+we)/2,c:X.c-(Me-we)/2}).a,re.b,re.c].sort(y.sorterAsc),Ie=de.indexOf(re.a),De=de.indexOf(re.b),Oe=de.indexOf(re.c);de[0]<0&&(de[1]+de[0]/2<0?(de[2]+=de[0]+de[1],de[0]=de[1]=0):(de[2]+=de[0]/2,de[1]+=de[0]/2,de[0]=0),re={a:de[Ie],b:de[De],c:de[Oe]},ve=(X.a-re.a)*K.yaxis._m,le=(X.c-re.c-X.b+re.b)*K.xaxis._m);var Ve=e(K.x0+le,K.y0+ve);K.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",Ve);var Fe=e(-le,-ve);K.clipDefRelative.select("path").attr("transform",Fe),K.aaxis.range=[re.a,K.sum-re.b-re.c],K.baxis.range=[K.sum-re.a-re.c,re.b],K.caxis.range=[K.sum-re.a-re.b,re.c],K.drawAxes(!1),K._hasClipOnAxisFalse&&K.plotContainer.select(".scatterlayer").selectAll(".trace").call(o.hideOutsideRangePoints,K),ee.emit("plotly_relayouting",se(re))}function Te(){w.call("_guiRelayout",ee,se(re))}this.dragOptions={element:J,gd:ee,plotinfo:{id:K.id,domain:ee._fullLayout[K.id].domain,xaxis:K.xaxis,yaxis:K.yaxis},subplot:K.id,prepFn:function(le,ve,Me){K.dragOptions.xaxes=[K.xaxis],K.dragOptions.yaxes=[K.yaxis],j=ee._fullLayout._invScaleX,V=ee._fullLayout._invScaleY;var we=K.dragOptions.dragmode=ee._fullLayout.dragmode;p(we)?K.dragOptions.minDrag=1:K.dragOptions.minDrag=void 0,we==="zoom"?(K.dragOptions.moveFn=Se,K.dragOptions.clickFn=oe,K.dragOptions.doneFn=fe,function(de,Ie,De){var Oe=J.getBoundingClientRect();Z=Ie-Oe.left,Q=De-Oe.top,ee._fullLayout._calcInverseTransform(ee);var Ve=ee._fullLayout._invTransform,Fe=y.apply3DTransform(Ve)(Z,Q);Z=Fe[0],Q=Fe[1],X={a:K.aaxis.range[0],b:K.baxis.range[1],c:K.caxis.range[1]},re=X,$=K.aaxis.range[1]-X.a,H=v(K.graphDiv._fullLayout[K.id].bgcolor).getLuminance(),N="M0,"+K.h+"L"+K.w/2+", 0L"+K.w+","+K.h+"Z",U=!1,te=ne.append("path").attr("class","zoombox").attr("transform",e(K.x0,K.y0)).style({fill:H>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",N),B=ne.append("path").attr("class","zoombox-corners").attr("transform",e(K.x0,K.y0)).style({fill:n.background,stroke:n.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),K.clearOutline(ee)}(0,ve,Me)):we==="pan"?(K.dragOptions.moveFn=ge,K.dragOptions.clickFn=oe,K.dragOptions.doneFn=Te,X={a:K.aaxis.range[0],b:K.baxis.range[1],c:K.caxis.range[1]},re=X,K.clearOutline(ee)):(u(we)||p(we))&&x(le,ve,Me,K.dragOptions,we)}},J.onmousemove=function(le){l.hover(ee,le,K.id),ee._fullLayout._lasthover=J,ee._fullLayout._hoversubplot=K.id},J.onmouseout=function(le){ee._dragging||h.unhover(ee,le)},h.init(this.dragOptions)}},{"../../components/color":367,"../../components/dragelement":386,"../../components/dragelement/helpers":385,"../../components/drawing":389,"../../components/fx":407,"../../components/selections":455,"../../components/titles":476,"../../lib":515,"../../lib/extend":505,"../../registry":647,"../cartesian/axes":566,"../cartesian/constants":573,"../cartesian/set_convert":585,"../plots":628,"@plotly/d3":58,tinycolor2:313}],647:[function(m,G,Y){var d=m("./lib/loggers"),v=m("./lib/noop"),w=m("./lib/push_unique"),y=m("./lib/is_plain_object"),e=m("./lib/dom").addStyleRule,t=m("./lib/extend"),n=m("./plots/attributes"),o=m("./plots/layout_attributes"),r=t.extendFlat,g=t.extendDeepAll;function c(f){var _=f.name,b=f.categories,T=f.meta;if(Y.modules[_])d.log("Type "+_+" already registered");else{Y.subplotsRegistry[f.basePlotModule.name]||function(z){var D=z.name;if(Y.subplotsRegistry[D])return void d.log("Plot type "+D+" already registered.");for(var j in s(z),Y.subplotsRegistry[D]=z,Y.componentsRegistry)i(j,z.name)}(f.basePlotModule);for(var k={},L=0;L<b.length;L++)k[b[L]]=!0,Y.allCategories[b[L]]=!0;for(var A in Y.modules[_]={_module:f,categories:k},T&&Object.keys(T).length&&(Y.modules[_].meta=T),Y.allTypes.push(_),Y.componentsRegistry)p(A,_);f.layoutAttributes&&r(Y.traceLayoutAttributes,f.layoutAttributes);var I=f.basePlotModule,P=I.name;if(P==="mapbox"){var S=I.constants.styleRules;for(var E in S)e(".js-plotly-plot .plotly .mapboxgl-"+E,S[E])}P!=="geo"&&P!=="mapbox"||window.PlotlyGeoAssets!==void 0||(window.PlotlyGeoAssets={topojson:{}})}}function a(f){if(typeof f.name!="string")throw new Error("Component module *name* must be a string.");var _=f.name;for(var b in Y.componentsRegistry[_]=f,f.layoutAttributes&&(f.layoutAttributes._isLinkedToArray&&w(Y.layoutArrayContainers,_),s(f)),Y.modules)p(_,b);for(var T in Y.subplotsRegistry)i(_,T);for(var k in Y.transformsRegistry)u(_,k);f.schema&&f.schema.layout&&g(o,f.schema.layout)}function h(f){if(typeof f.name!="string")throw new Error("Transform module *name* must be a string.");var _="Transform module "+f.name,b=typeof f.transform=="function",T=typeof f.calcTransform=="function";if(!b&&!T)throw new Error(_+" is missing a *transform* or *calcTransform* method.");for(var k in b&&T&&d.log([_+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),y(f.attributes)||d.log(_+" registered without an *attributes* object."),typeof f.supplyDefaults!="function"&&d.log(_+" registered without a *supplyDefaults* method."),Y.transformsRegistry[f.name]=f,Y.componentsRegistry)u(k,f.name)}function l(f){var _=f.name,b=_.split("-")[0],T=f.dictionary,k=f.format,L=T&&Object.keys(T).length,A=k&&Object.keys(k).length,I=Y.localeRegistry,P=I[_];if(P||(I[_]=P={}),b!==_){var S=I[b];S||(I[b]=S={}),L&&S.dictionary===P.dictionary&&(S.dictionary=T),A&&S.format===P.format&&(S.format=k)}L&&(P.dictionary=T),A&&(P.format=k)}function s(f){if(f.layoutAttributes){var _=f.layoutAttributes._arrayAttrRegexps;if(_)for(var b=0;b<_.length;b++)w(Y.layoutArrayRegexes,_[b])}}function p(f,_){var b=Y.componentsRegistry[f].schema;if(b&&b.traces){var T=b.traces[_];T&&g(Y.modules[_]._module.attributes,T)}}function u(f,_){var b=Y.componentsRegistry[f].schema;if(b&&b.transforms){var T=b.transforms[_];T&&g(Y.transformsRegistry[_].attributes,T)}}function i(f,_){var b=Y.componentsRegistry[f].schema;if(b&&b.subplots){var T=Y.subplotsRegistry[_],k=T.layoutAttributes,L=T.attr==="subplot"?T.name:T.attr;Array.isArray(L)&&(L=L[0]);var A=b.subplots[L];k&&A&&g(k,A)}}function x(f){return typeof f=="object"&&(f=f.type),f}Y.modules={},Y.allCategories={},Y.allTypes=[],Y.subplotsRegistry={},Y.transformsRegistry={},Y.componentsRegistry={},Y.layoutArrayContainers=[],Y.layoutArrayRegexes=[],Y.traceLayoutAttributes={},Y.localeRegistry={},Y.apiMethodRegistry={},Y.collectableSubplotTypes=null,Y.register=function(f){if(Y.collectableSubplotTypes=null,!f)throw new Error("No argument passed to Plotly.register.");f&&!Array.isArray(f)&&(f=[f]);for(var _=0;_<f.length;_++){var b=f[_];if(!b)throw new Error("Invalid module was attempted to be registered!");switch(b.moduleType){case"trace":c(b);break;case"transform":h(b);break;case"component":a(b);break;case"locale":l(b);break;case"apiMethod":var T=b.name;Y.apiMethodRegistry[T]=b.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}},Y.getModule=function(f){var _=Y.modules[x(f)];return!!_&&_._module},Y.traceIs=function(f,_){if((f=x(f))==="various")return!1;var b=Y.modules[f];return b||(f&&d.log("Unrecognized trace type "+f+"."),b=Y.modules[n.type.dflt]),!!b.categories[_]},Y.getTransformIndices=function(f,_){for(var b=[],T=f.transforms||[],k=0;k<T.length;k++)T[k].type===_&&b.push(k);return b},Y.hasTransform=function(f,_){for(var b=f.transforms||[],T=0;T<b.length;T++)if(b[T].type===_)return!0;return!1},Y.getComponentMethod=function(f,_){var b=Y.componentsRegistry[f];return b&&b[_]||v},Y.call=function(){var f=arguments[0],_=[].slice.call(arguments,1);return Y.apiMethodRegistry[f].apply(null,_)}},{"./lib/dom":503,"./lib/extend":505,"./lib/is_plain_object":516,"./lib/loggers":519,"./lib/noop":524,"./lib/push_unique":530,"./plots/attributes":562,"./plots/layout_attributes":619}],648:[function(m,G,Y){var d=m("../registry"),v=m("../lib"),w=v.extendFlat,y=v.extendDeep;function e(t){var n;switch(t){case"themes__thumb":n={autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":n={title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:n={}}return n}G.exports=function(t,n){var o,r,g=t.data,c=t.layout,a=y([],g),h=y({},c,e(n.tileClass)),l=t._context||{};if(n.width&&(h.width=n.width),n.height&&(h.height=n.height),n.tileClass==="thumbnail"||n.tileClass==="themes__thumb"){h.annotations=[];var s=Object.keys(h);for(o=0;o<s.length;o++)r=s[o],["xaxis","yaxis","zaxis"].indexOf(r.slice(0,5))>-1&&(h[s[o]].title={text:""});for(o=0;o<a.length;o++){var p=a[o];p.showscale=!1,p.marker&&(p.marker.showscale=!1),d.traceIs(p,"pie-like")&&(p.textposition="none")}}if(Array.isArray(n.annotations))for(o=0;o<n.annotations.length;o++)h.annotations.push(n.annotations[o]);var u=Object.keys(h).filter(function(b){return b.match(/^scene\d*$/)});if(u.length){var i={};for(n.tileClass==="thumbnail"&&(i={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),o=0;o<u.length;o++){var x=h[u[o]];x.xaxis||(x.xaxis={}),x.yaxis||(x.yaxis={}),x.zaxis||(x.zaxis={}),w(x.xaxis,i),w(x.yaxis,i),w(x.zaxis,i),x._scene=null}}var f=document.createElement("div");n.tileClass&&(f.className=n.tileClass);var _={gd:f,td:f,layout:h,data:a,config:{staticPlot:n.staticPlot===void 0||n.staticPlot,plotGlPixelRatio:n.plotGlPixelRatio===void 0?2:n.plotGlPixelRatio,displaylogo:n.displaylogo||!1,showLink:n.showLink||!1,showTips:n.showTips||!1,mapboxAccessToken:l.mapboxAccessToken}};return n.setBackground!=="transparent"&&(_.config.setBackground=n.setBackground||"opaque"),_.gd.defaultLayout=e(n.tileClass),_}},{"../lib":515,"../registry":647}],649:[function(m,G,Y){var d=m("../lib"),v=m("../plot_api/to_image"),w=m("./filesaver"),y=m("./helpers");G.exports=function(e,t){var n;return d.isPlainObject(e)||(n=d.getGraphDiv(e)),(t=t||{}).format=t.format||"png",t.width=t.width||null,t.height=t.height||null,t.imageDataOnly=!0,new Promise(function(o,r){n&&n._snapshotInProgress&&r(new Error("Snapshotting already in progress.")),d.isIE()&&t.format!=="svg"&&r(new Error(y.MSG_IE_BAD_FORMAT)),n&&(n._snapshotInProgress=!0);var g=v(e,t),c=t.filename||e.fn||"newplot";c+="."+t.format.replace("-","."),g.then(function(a){return n&&(n._snapshotInProgress=!1),w(a,c,t.format)}).then(function(a){o(a)}).catch(function(a){n&&(n._snapshotInProgress=!1),r(a)})})}},{"../lib":515,"../plot_api/to_image":558,"./filesaver":650,"./helpers":651}],650:[function(m,G,Y){var d=m("../lib"),v=m("./helpers");G.exports=function(w,y,e){var t=document.createElement("a"),n="download"in t;return new Promise(function(o,r){var g,c;if(d.isIE())return g=v.createBlob(w,"svg"),window.navigator.msSaveBlob(g,y),g=null,o(y);if(n)return g=v.createBlob(w,e),c=v.createObjectURL(g),t.href=c,t.download=y,document.body.appendChild(t),t.click(),document.body.removeChild(t),v.revokeObjectURL(c),g=null,o(y);if(d.isSafari()){var a=e==="svg"?",":";base64,";return v.octetStream(a+encodeURIComponent(w)),o(y)}r(new Error("download error"))})}},{"../lib":515,"./helpers":651}],651:[function(m,G,Y){var d=m("../registry");Y.getDelay=function(w){return w._has&&(w._has("gl3d")||w._has("gl2d")||w._has("mapbox"))?500:0},Y.getRedrawFunc=function(w){return function(){d.getComponentMethod("colorbar","draw")(w)}},Y.encodeSVG=function(w){return"data:image/svg+xml,"+encodeURIComponent(w)},Y.encodeJSON=function(w){return"data:application/json,"+encodeURIComponent(w)};var v=window.URL||window.webkitURL;Y.createObjectURL=function(w){return v.createObjectURL(w)},Y.revokeObjectURL=function(w){return v.revokeObjectURL(w)},Y.createBlob=function(w,y){if(y==="svg")return new window.Blob([w],{type:"image/svg+xml;charset=utf-8"});if(y==="full-json")return new window.Blob([w],{type:"application/json;charset=utf-8"});var e=function(t){for(var n=t.length,o=new ArrayBuffer(n),r=new Uint8Array(o),g=0;g<n;g++)r[g]=t.charCodeAt(g);return o}(window.atob(w));return new window.Blob([e],{type:"image/"+y})},Y.octetStream=function(w){document.location.href="data:application/octet-stream"+w},Y.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,Y.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":647}],652:[function(m,G,Y){var d=m("./helpers"),v={getDelay:d.getDelay,getRedrawFunc:d.getRedrawFunc,clone:m("./cloneplot"),toSVG:m("./tosvg"),svgToImg:m("./svgtoimg"),toImage:m("./toimage"),downloadImage:m("./download")};G.exports=v},{"./cloneplot":648,"./download":649,"./helpers":651,"./svgtoimg":653,"./toimage":654,"./tosvg":655}],653:[function(m,G,Y){var d=m("../lib"),v=m("events").EventEmitter,w=m("./helpers");G.exports=function(y){var e=y.emitter||new v,t=new Promise(function(n,o){var r=window.Image,g=y.svg,c=y.format||"png";if(d.isIE()&&c!=="svg"){var a=new Error(w.MSG_IE_BAD_FORMAT);return o(a),y.promise?t:e.emit("error",a)}var h,l,s=y.canvas,p=y.scale||1,u=y.width||300,i=y.height||150,x=p*u,f=p*i,_=s.getContext("2d",{willReadFrequently:!0}),b=new r;c==="svg"||d.isSafari()?l=w.encodeSVG(g):(h=w.createBlob(g,"svg"),l=w.createObjectURL(h)),s.width=x,s.height=f,b.onload=function(){var T;switch(h=null,w.revokeObjectURL(l),c!=="svg"&&_.drawImage(b,0,0,x,f),c){case"jpeg":T=s.toDataURL("image/jpeg");break;case"png":T=s.toDataURL("image/png");break;case"webp":T=s.toDataURL("image/webp");break;case"svg":T=l;break;default:var k="Image format is not jpeg, png, svg or webp.";if(o(new Error(k)),!y.promise)return e.emit("error",k)}n(T),y.promise||e.emit("success",T)},b.onerror=function(T){if(h=null,w.revokeObjectURL(l),o(T),!y.promise)return e.emit("error",T)},b.src=l});return y.promise?t:e}},{"../lib":515,"./helpers":651,events:84}],654:[function(m,G,Y){var d=m("events").EventEmitter,v=m("../registry"),w=m("../lib"),y=m("./helpers"),e=m("./cloneplot"),t=m("./tosvg"),n=m("./svgtoimg");G.exports=function(o,r){var g=new d,c=e(o,{format:"png"}),a=c.gd;a.style.position="absolute",a.style.left="-5000px",document.body.appendChild(a);var h=y.getRedrawFunc(a);return v.call("_doPlot",a,c.data,c.layout,c.config).then(h).then(function(){var l=y.getDelay(a._fullLayout);setTimeout(function(){var s=t(a),p=document.createElement("canvas");p.id=w.randstr(),(g=n({format:r.format,width:a._fullLayout.width,height:a._fullLayout.height,canvas:p,emitter:g,svg:s})).clean=function(){a&&document.body.removeChild(a)}},l)}).catch(function(l){g.emit("error",l)}),g}},{"../lib":515,"../registry":647,"./cloneplot":648,"./helpers":651,"./svgtoimg":653,"./tosvg":655,events:84}],655:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../lib"),w=m("../components/drawing"),y=m("../components/color"),e=m("../constants/xmlns_namespaces"),t=/"/g,n=new RegExp('("TOBESTRIPPED)|(TOBESTRIPPED")',"g");G.exports=function(o,r,g){var c,a=o._fullLayout,h=a._paper,l=a._toppaper,s=a.width,p=a.height;h.insert("rect",":first-child").call(w.setRect,0,0,s,p).call(y.fill,a.paper_bgcolor);var u=a._basePlotModules||[];for(c=0;c<u.length;c++){var i=u[c];i.toSVG&&i.toSVG(o)}if(l){var x=l.node().childNodes,f=Array.prototype.slice.call(x);for(c=0;c<f.length;c++){var _=f[c];_.childNodes.length&&h.node().appendChild(_)}}a._draggers&&a._draggers.remove(),h.node().style.background="",h.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each(function(){var T=d.select(this);if(this.style.visibility!=="hidden"&&this.style.display!=="none"){T.style({visibility:null,display:null});var k=this.style.fontFamily;k&&k.indexOf('"')!==-1&&T.style("font-family",k.replace(t,"TOBESTRIPPED"))}else T.remove()}),h.selectAll(".gradient_filled,.pattern_filled").each(function(){var T=d.select(this),k=this.style.fill;k&&k.indexOf("url(")!==-1&&T.style("fill",k.replace(t,"TOBESTRIPPED"));var L=this.style.stroke;L&&L.indexOf("url(")!==-1&&T.style("stroke",L.replace(t,"TOBESTRIPPED"))}),r!=="pdf"&&r!=="eps"||h.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),h.node().setAttributeNS(e.xmlns,"xmlns",e.svg),h.node().setAttributeNS(e.xmlns,"xmlns:xlink",e.xlink),r==="svg"&&g&&(h.attr("width",g*s),h.attr("height",g*p),h.attr("viewBox","0 0 "+s+" "+p));var b=new window.XMLSerializer().serializeToString(h.node());return b=function(T){var k=d.select("body").append("div").style({display:"none"}).html(""),L=T.replace(/(&[^;]*;)/gi,function(A){return A==="&lt;"?"&#60;":A==="&rt;"?"&#62;":A.indexOf("<")!==-1||A.indexOf(">")!==-1?"":k.html(A).text()});return k.remove(),L}(b),b=(b=b.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")).replace(n,"'"),v.isIE()&&(b=(b=(b=b.replace(/"/gi,"'")).replace(/(\('#)([^']*)('\))/gi,'("#$2")')).replace(/(\\')/gi,'"')),b}},{"../components/color":367,"../components/drawing":389,"../constants/xmlns_namespaces":492,"../lib":515,"@plotly/d3":58}],656:[function(m,G,Y){var d=m("../../lib");G.exports=function(v,w){for(var y=0;y<v.length;y++)v[y].i=y;d.mergeArray(w.text,v,"tx"),d.mergeArray(w.hovertext,v,"htx");var e=w.marker;if(e){d.mergeArray(e.opacity,v,"mo",!0),d.mergeArray(e.color,v,"mc");var t=e.line;t&&(d.mergeArray(t.color,v,"mlc"),d.mergeArrayCastPositive(t.width,v,"mlw"))}}},{"../../lib":515}],657:[function(m,G,Y){var d=m("../scatter/attributes"),v=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,w=m("../../plots/template_attributes").hovertemplateAttrs,y=m("../../plots/template_attributes").texttemplateAttrs,e=m("../../components/colorscale/attributes"),t=m("../../plots/font_attributes"),n=m("./constants"),o=m("../../components/drawing/attributes").pattern,r=m("../../lib/extend").extendFlat,g=t({editType:"calc",arrayOk:!0,colorEditType:"style"}),c=r({},d.marker.line.width,{dflt:0}),a=r({width:c,editType:"calc"},e("marker.line")),h=r({line:a,editType:"calc"},e("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"},pattern:o});G.exports={x:d.x,x0:d.x0,dx:d.dx,y:d.y,y0:d.y0,dy:d.dy,xperiod:d.xperiod,yperiod:d.yperiod,xperiod0:d.xperiod0,yperiod0:d.yperiod0,xperiodalignment:d.xperiodalignment,yperiodalignment:d.yperiodalignment,xhoverformat:v("x"),yhoverformat:v("y"),text:d.text,texttemplate:y({editType:"plot"},{keys:n.eventDataKeys}),hovertext:d.hovertext,hovertemplate:w({},{keys:n.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:r({},g,{}),insidetextfont:r({},g,{}),outsidetextfont:r({},g,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:r({},d.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:h,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:d.selected.marker.opacity,color:d.selected.marker.color,editType:"style"},textfont:d.selected.textfont,editType:"style"},unselected:{marker:{opacity:d.unselected.marker.opacity,color:d.unselected.marker.color,editType:"style"},textfont:d.unselected.textfont,editType:"style"},_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../scatter/attributes":936,"./constants":659}],658:[function(m,G,Y){var d=m("../../plots/cartesian/axes"),v=m("../../plots/cartesian/align_period"),w=m("../../components/colorscale/helpers").hasColorscale,y=m("../../components/colorscale/calc"),e=m("./arrays_to_calcdata"),t=m("../scatter/calc_selection");G.exports=function(n,o){var r,g,c,a,h,l,s=d.getFromId(n,o.xaxis||"x"),p=d.getFromId(n,o.yaxis||"y"),u={msUTC:!(!o.base&&o.base!==0)};o.orientation==="h"?(r=s.makeCalcdata(o,"x",u),c=p.makeCalcdata(o,"y"),a=v(o,p,"y",c),h=!!o.yperiodalignment,l="y"):(r=p.makeCalcdata(o,"y",u),c=s.makeCalcdata(o,"x"),a=v(o,s,"x",c),h=!!o.xperiodalignment,l="x"),g=a.vals;for(var i=Math.min(g.length,r.length),x=new Array(i),f=0;f<i;f++)x[f]={p:g[f],s:r[f]},h&&(x[f].orig_p=c[f],x[f][l+"End"]=a.ends[f],x[f][l+"Start"]=a.starts[f]),o.ids&&(x[f].id=String(o.ids[f]));return w(o,"marker")&&y(n,o,{vals:o.marker.color,containerStr:"marker",cLetter:"c"}),w(o,"marker.line")&&y(n,o,{vals:o.marker.line.color,containerStr:"marker.line",cLetter:"c"}),e(x,o),t(x,o),x}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938,"./arrays_to_calcdata":656}],659:[function(m,G,Y){G.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],660:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../lib").isArrayOrTypedArray,w=m("../../constants/numerical").BADNUM,y=m("../../registry"),e=m("../../plots/cartesian/axes"),t=m("../../plots/cartesian/constraints").getAxisGroup,n=m("./sieve.js");function o(i,x,f,_,b){if(_.length){var T,k,L,A;switch(function(I,P){var S,E;for(S=0;S<P.length;S++){var z,D=P[S],j=D[0].trace,V=j.type==="funnel"?j._base:j.base,Z=j.orientation==="h"?j.xcalendar:j.ycalendar,Q=I.type==="category"||I.type==="multicategory"?function(){return null}:I.d2c;if(v(V)){for(E=0;E<Math.min(V.length,D.length);E++)z=Q(V[E],0,Z),d(z)?(D[E].b=+z,D[E].hasB=1):D[E].b=0;for(;E<D.length;E++)D[E].b=0}else{z=Q(V,0,Z);var X=d(z);for(z=X?z:0,E=0;E<D.length;E++)D[E].b=z,X&&(D[E].hasB=1)}}}(f,_),b.mode){case"overlay":r(x,f,_,b);break;case"group":for(T=[],k=[],L=0;L<_.length;L++)(A=_[L])[0].trace.offset===void 0?k.push(A):T.push(A);k.length&&function(I,P,S,E,z){var D=new n(E,{posAxis:P,sepNegVal:!1,overlapNoMerge:!z.norm});(function(j,V,Z,Q){for(var X=j._fullLayout,$=Z.positions,re=Z.distinctPositions,H=Z.minDiff,N=Z.traces,U=N.length,te=$.length!==re.length,B=H*(1-Q.gap),K=t(X,V._id)+N[0][0].trace.orientation,J=X._alignmentOpts[K]||{},ee=0;ee<U;ee++){var ne,se,oe=N[ee],me=oe[0].trace,ce=J[me.alignmentgroup]||{},ye=Object.keys(ce.offsetGroups||{}).length,Se=(ne=ye?B/ye:te?B/U:B)*(1-(Q.groupgap||0));se=ye?((2*me._offsetIndex+1-ye)*ne-Se)/2:te?((2*ee+1-U)*ne-Se)/2:-Se/2;var fe=oe[0].t;fe.barwidth=Se,fe.poffset=se,fe.bargroupwidth=B,fe.bardelta=H}Z.binWidth=N[0][0].t.barwidth/100,c(Z),a(V,Z),h(V,Z,te)})(I,P,D,z),function(j,V){for(var Z=j.traces,Q=0;Q<Z.length;Q++){var X=Z[Q];if(X[0].trace.base===void 0)for(var $=new n([X],{posAxis:V,sepNegVal:!0,overlapNoMerge:!0}),re=0;re<X.length;re++){var H=X[re];if(H.p!==w){var N=$.put(H.p,H.b+H.s);N&&(H.b=N)}}}}(D,P),z.norm?(s(D),p(S,D,z)):l(S,D)}(i,x,f,k,b),T.length&&r(x,f,T,b);break;case"stack":case"relative":for(T=[],k=[],L=0;L<_.length;L++)(A=_[L])[0].trace.base===void 0?k.push(A):T.push(A);k.length&&function(I,P,S,E,z){var D=new n(E,{posAxis:P,sepNegVal:z.mode==="relative",overlapNoMerge:!(z.norm||z.mode==="stack"||z.mode==="relative")});g(P,D,z),function(X,$,re){var H,N,U,te,B,K,J=u(X),ee=$.traces;for(te=0;te<ee.length;te++)if(H=ee[te],(N=H[0].trace).type==="funnel")for(B=0;B<H.length;B++)(K=H[B]).s!==w&&$.put(K.p,-.5*K.s);for(te=0;te<ee.length;te++){H=ee[te],N=H[0].trace,U=N.type==="funnel";var ne=[];for(B=0;B<H.length;B++)if((K=H[B]).s!==w){var se;se=U?K.s:K.s+K.b;var oe=$.put(K.p,se),me=oe+se;K.b=oe,K[J]=me,re.norm||(ne.push(me),K.hasB&&ne.push(oe))}re.norm||(N._extremes[X._id]=e.findExtremes(X,ne,{tozero:!0,padded:!0}))}}(S,D,z);for(var j=0;j<E.length;j++)for(var V=E[j],Z=0;Z<V.length;Z++){var Q=V[Z];Q.s!==w&&Q.b+Q.s===D.get(Q.p,Q.s)&&(Q._outmost=!0)}z.norm&&p(S,D,z)}(0,x,f,k,b),T.length&&r(x,f,T,b)}(function(I,P){var S,E,z,D=u(P),j={},V=1/0,Z=-1/0;for(S=0;S<I.length;S++)for(z=I[S],E=0;E<z.length;E++){var Q=z[E].p;d(Q)&&(V=Math.min(V,Q),Z=Math.max(Z,Q))}var X=1e4/(Z-V),$=j.round=function(K){return String(Math.round(X*(K-V)))};for(S=0;S<I.length;S++){(z=I[S])[0].t.extents=j;var re=z[0].t.poffset,H=Array.isArray(re);for(E=0;E<z.length;E++){var N=z[E],U=N[D]-N.w/2;if(d(U)){var te=N[D]+N.w/2,B=$(N.p);j[B]?j[B]=[Math.min(U,j[B][0]),Math.max(te,j[B][1])]:j[B]=[U,te]}N.p0=N.p+(H?re[E]:re),N.p1=N.p0+N.w,N.s0=N.b,N.s1=N.s0+N.s}}})(_,x)}}function r(i,x,f,_){for(var b=0;b<f.length;b++){var T=f[b],k=new n([T],{posAxis:i,sepNegVal:!1,overlapNoMerge:!_.norm});g(i,k,_),_.norm?(s(k),p(x,k,_)):l(x,k)}}function g(i,x,f){for(var _=x.minDiff,b=x.traces,T=_*(1-f.gap),k=T*(1-(f.groupgap||0)),L=-k/2,A=0;A<b.length;A++){var I=b[A][0].t;I.barwidth=k,I.poffset=L,I.bargroupwidth=T,I.bardelta=_}x.binWidth=b[0][0].t.barwidth/100,c(x),a(i,x),h(i,x)}function c(i){var x,f,_=i.traces;for(x=0;x<_.length;x++){var b,T=_[x],k=T[0],L=k.trace,A=k.t,I=L._offset||L.offset,P=A.poffset;if(v(I)){for(b=Array.prototype.slice.call(I,0,T.length),f=0;f<b.length;f++)d(b[f])||(b[f]=P);for(f=b.length;f<T.length;f++)b.push(P);A.poffset=b}else I!==void 0&&(A.poffset=I);var S=L._width||L.width,E=A.barwidth;if(v(S)){var z=Array.prototype.slice.call(S,0,T.length);for(f=0;f<z.length;f++)d(z[f])||(z[f]=E);for(f=z.length;f<T.length;f++)z.push(E);if(A.barwidth=z,I===void 0){for(b=[],f=0;f<T.length;f++)b.push(P+(E-z[f])/2);A.poffset=b}}else S!==void 0&&(A.barwidth=S,I===void 0&&(A.poffset=P+(E-S)/2))}}function a(i,x){for(var f=x.traces,_=u(i),b=0;b<f.length;b++)for(var T=f[b],k=T[0].t,L=k.poffset,A=Array.isArray(L),I=k.barwidth,P=Array.isArray(I),S=0;S<T.length;S++){var E=T[S],z=E.w=P?I[S]:I;E[_]=E.p+(A?L[S]:L)+z/2}}function h(i,x,f){var _=x.traces,b=x.minDiff/2;e.minDtick(i,x.minDiff,x.distinctPositions[0],f);for(var T=0;T<_.length;T++){var k,L,A,I,P=_[T],S=P[0],E=S.trace,z=[];for(I=0;I<P.length;I++)L=(k=P[I]).p-b,A=k.p+b,z.push(L,A);if(E.width||E.offset){var D=S.t,j=D.poffset,V=D.barwidth,Z=Array.isArray(j),Q=Array.isArray(V);for(I=0;I<P.length;I++){k=P[I];var X=Z?j[I]:j,$=Q?V[I]:V;A=(L=k.p+X)+$,z.push(L,A)}}E._extremes[i._id]=e.findExtremes(i,z,{padded:!1})}}function l(i,x){for(var f=x.traces,_=u(i),b=0;b<f.length;b++){for(var T=f[b],k=T[0].trace,L=[],A=!1,I=0;I<T.length;I++){var P=T[I],S=P.b,E=S+P.s;P[_]=E,L.push(E),P.hasB&&L.push(S),P.hasB&&P.b||(A=!0)}k._extremes[i._id]=e.findExtremes(i,L,{tozero:A,padded:!0})}}function s(i){for(var x=i.traces,f=0;f<x.length;f++)for(var _=x[f],b=0;b<_.length;b++){var T=_[b];T.s!==w&&i.put(T.p,T.b+T.s)}}function p(i,x,f){var _=x.traces,b=u(i),T=f.norm==="fraction"?1:100,k=T/1e9,L=i.l2c(i.c2l(0)),A=f.mode==="stack"?T:L;function I(re){return d(i.c2l(re))&&(re<L-k||re>A+k||!d(L))}for(var P=0;P<_.length;P++){for(var S=_[P],E=S[0].trace,z=[],D=!1,j=!1,V=0;V<S.length;V++){var Z=S[V];if(Z.s!==w){var Q=Math.abs(T/x.get(Z.p,Z.s));Z.b*=Q,Z.s*=Q;var X=Z.b,$=X+Z.s;Z[b]=$,z.push($),j=j||I($),Z.hasB&&(z.push(X),j=j||I(X)),Z.hasB&&Z.b||(D=!0)}}E._extremes[i._id]=e.findExtremes(i,z,{tozero:D,padded:j})}}function u(i){return i._id.charAt(0)}G.exports={crossTraceCalc:function(i,x){for(var f=x.xaxis,_=x.yaxis,b=i._fullLayout,T=i._fullData,k=i.calcdata,L=[],A=[],I=0;I<T.length;I++){var P=T[I];if(P.visible===!0&&y.traceIs(P,"bar")&&P.xaxis===f._id&&P.yaxis===_._id&&(P.orientation==="h"?L.push(k[I]):A.push(k[I]),P._computePh))for(var S=i.calcdata[I],E=0;E<S.length;E++)typeof S[E].ph0=="function"&&(S[E].ph0=S[E].ph0()),typeof S[E].ph1=="function"&&(S[E].ph1=S[E].ph1())}var z={xCat:f.type==="category"||f.type==="multicategory",yCat:_.type==="category"||_.type==="multicategory",mode:b.barmode,norm:b.barnorm,gap:b.bargap,groupgap:b.bargroupgap};o(i,f,_,A,z),o(i,_,f,L,z)},setGroupPositions:o}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../../plots/cartesian/constraints":574,"../../registry":647,"./sieve.js":670,"fast-isnumeric":190}],661:[function(m,G,Y){var d=m("../../lib"),v=m("../../components/color"),w=m("../../registry"),y=m("../scatter/xy_defaults"),e=m("../scatter/period_defaults"),t=m("./style_defaults"),n=m("../../plots/cartesian/constraints").getAxisGroup,o=m("./attributes"),r=d.coerceFont;function g(a,h,l,s){var p=h.orientation,u=h[{v:"x",h:"y"}[p]+"axis"],i=n(l,u)+p,x=l._alignmentOpts||{},f=s("alignmentgroup"),_=x[i];_||(_=x[i]={});var b=_[f];b?b.traces.push(h):b=_[f]={traces:[h],alignmentIndex:Object.keys(_).length,offsetGroups:{}};var T=s("offsetgroup"),k=b.offsetGroups,L=k[T];T&&(L||(L=k[T]={offsetIndex:Object.keys(k).length}),h._offsetIndex=L.offsetIndex)}function c(a,h,l,s,p,u){var i=(u=u||{}).moduleHasSelected!==!1,x=u.moduleHasUnselected!==!1,f=u.moduleHasConstrain!==!1,_=u.moduleHasCliponaxis!==!1,b=u.moduleHasTextangle!==!1,T=u.moduleHasInsideanchor!==!1,k=!!u.hasPathbar,L=Array.isArray(p)||p==="auto",A=L||p==="inside",I=L||p==="outside";if(A||I){var P=r(s,"textfont",l.font),S=d.extendFlat({},P),E=!(a.textfont&&a.textfont.color);if(E&&delete S.color,r(s,"insidetextfont",S),k){var z=d.extendFlat({},P);E&&delete z.color,r(s,"pathbar.textfont",z)}I&&r(s,"outsidetextfont",P),i&&s("selected.textfont.color"),x&&s("unselected.textfont.color"),f&&s("constraintext"),_&&s("cliponaxis"),b&&s("textangle"),s("texttemplate")}A&&T&&s("insidetextanchor")}G.exports={supplyDefaults:function(a,h,l,s){function p(f,_){return d.coerce(a,h,o,f,_)}if(y(a,h,s,p)){e(a,h,s,p),p("xhoverformat"),p("yhoverformat"),p("orientation",h.x&&!h.y?"h":"v"),p("base"),p("offset"),p("width"),p("text"),p("hovertext"),p("hovertemplate");var u=p("textposition");c(a,h,s,p,u,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),t(a,h,p,l,s);var i=(h.marker.line||{}).color,x=w.getComponentMethod("errorbars","supplyDefaults");x(a,h,i||v.defaultLine,{axis:"y"}),x(a,h,i||v.defaultLine,{axis:"x",inherit:"y"}),d.coerceSelectionMarkerOpacity(h,p)}else h.visible=!1},crossTraceDefaults:function(a,h){var l;function s(u){return d.coerce(l._input,l,o,u)}if(h.barmode==="group")for(var p=0;p<a.length;p++)(l=a[p]).type==="bar"&&(l._input,g(0,l,h,s))},handleGroupingDefaults:g,handleText:c}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/constraints":574,"../../registry":647,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":657,"./style_defaults":672}],662:[function(m,G,Y){G.exports=function(d,v,w){return d.x="xVal"in v?v.xVal:v.x,d.y="yVal"in v?v.yVal:v.y,v.xa&&(d.xaxis=v.xa),v.ya&&(d.yaxis=v.ya),w.orientation==="h"?(d.label=d.y,d.value=d.x):(d.label=d.x,d.value=d.y),d}},{}],663:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("tinycolor2"),w=m("../../lib").isArrayOrTypedArray;Y.coerceString=function(y,e,t){if(typeof e=="string"){if(e||!y.noBlank)return e}else if((typeof e=="number"||e===!0)&&!y.strict)return String(e);return t!==void 0?t:y.dflt},Y.coerceNumber=function(y,e,t){if(d(e)){e=+e;var n=y.min,o=y.max;if(!(n!==void 0&&e<n||o!==void 0&&e>o))return e}return t!==void 0?t:y.dflt},Y.coerceColor=function(y,e,t){return v(e).isValid()?e:t!==void 0?t:y.dflt},Y.coerceEnumerated=function(y,e,t){return y.coerceNumber&&(e=+e),y.values.indexOf(e)!==-1?e:t!==void 0?t:y.dflt},Y.getValue=function(y,e){var t;return Array.isArray(y)?e<y.length&&(t=y[e]):t=y,t},Y.getLineWidth=function(y,e){return 0<e.mlw?e.mlw:w(y.marker.line.width)?0:y.marker.line.width}},{"../../lib":515,"fast-isnumeric":190,tinycolor2:313}],664:[function(m,G,Y){var d=m("../../components/fx"),v=m("../../registry"),w=m("../../components/color"),y=m("../../lib").fillText,e=m("./helpers").getLineWidth,t=m("../../plots/cartesian/axes").hoverLabelText,n=m("../../constants/numerical").BADNUM;function o(g,c,a,h,l){var s,p,u,i,x,f,_,b=g.cd,T=b[0].trace,k=b[0].t,L=h==="closest",A=T.type==="waterfall",I=g.maxHoverDistance,P=g.maxSpikeDistance;T.orientation==="h"?(s=a,p=c,u="y",i="x",x=H,f=$):(s=c,p=a,u="x",i="y",f=H,x=$);var S=T[u+"period"],E=L||S;function z(ne){return j(ne,-1)}function D(ne){return j(ne,1)}function j(ne,se){var oe=ne.w;return ne[u]+se*oe/2}function V(ne){return ne[u+"End"]-ne[u+"Start"]}var Z=L?z:S?function(ne){return ne.p-V(ne)/2}:function(ne){return Math.min(z(ne),ne.p-k.bardelta/2)},Q=L?D:S?function(ne){return ne.p+V(ne)/2}:function(ne){return Math.max(D(ne),ne.p+k.bardelta/2)};function X(ne,se,oe){return l.finiteRange&&(oe=0),d.inbox(ne-s,se-s,oe+Math.min(1,Math.abs(se-ne)/_)-1)}function $(ne){return X(Z(ne),Q(ne),I)}function re(ne){var se=ne[i];if(A){var oe=Math.abs(ne.rawS)||0;p>0?se+=oe:p<0&&(se-=oe)}return se}function H(ne){var se=p,oe=ne.b,me=re(ne);return d.inbox(oe-se,me-se,I+(me-se)/(me-oe)-1)}var N=g[u+"a"],U=g[i+"a"];_=Math.abs(N.r2c(N.range[1])-N.r2c(N.range[0]));var te=d.getDistanceFunction(h,x,f,function(ne){return(x(ne)+f(ne))/2});if(d.getClosest(b,te,g),g.index!==!1&&b[g.index].p!==n){E||(Z=function(ne){return Math.min(z(ne),ne.p-k.bargroupwidth/2)},Q=function(ne){return Math.max(D(ne),ne.p+k.bargroupwidth/2)});var B=b[g.index],K=T.base?B.b+B.s:B.s;g[i+"0"]=g[i+"1"]=U.c2p(B[i],!0),g[i+"LabelVal"]=K;var J=k.extents[k.extents.round(B.p)];g[u+"0"]=N.c2p(L?Z(B):J[0],!0),g[u+"1"]=N.c2p(L?Q(B):J[1],!0);var ee=B.orig_p!==void 0;return g[u+"LabelVal"]=ee?B.orig_p:B.p,g.labelLabel=t(N,g[u+"LabelVal"],T[u+"hoverformat"]),g.valueLabel=t(U,g[i+"LabelVal"],T[i+"hoverformat"]),g.baseLabel=t(U,B.b,T[i+"hoverformat"]),g.spikeDistance=(function(ne){var se=p,oe=ne.b,me=re(ne);return d.inbox(oe-se,me-se,P+(me-se)/(me-oe)-1)}(B)+function(ne){return X(z(ne),D(ne),P)}(B))/2,g[u+"Spike"]=N.c2p(B.p,!0),y(B,T,g),g.hovertemplate=T.hovertemplate,g}}function r(g,c){var a=c.mcc||g.marker.color,h=c.mlcc||g.marker.line.color,l=e(g,c);return w.opacity(a)?a:w.opacity(h)&&l?h:void 0}G.exports={hoverPoints:function(g,c,a,h,l){var s=o(g,c,a,h,l);if(s){var p=s.cd,u=p[0].trace,i=p[s.index];return s.color=r(u,i),v.getComponentMethod("errorbars","hoverInfo")(i,u,s),[s]}},hoverOnBars:o,getTraceColor:r}},{"../../components/color":367,"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./helpers":663}],665:[function(m,G,Y){G.exports={attributes:m("./attributes"),layoutAttributes:m("./layout_attributes"),supplyDefaults:m("./defaults").supplyDefaults,crossTraceDefaults:m("./defaults").crossTraceDefaults,supplyLayoutDefaults:m("./layout_defaults"),calc:m("./calc"),crossTraceCalc:m("./cross_trace_calc").crossTraceCalc,colorbar:m("../scatter/marker_colorbar"),arraysToCalcdata:m("./arrays_to_calcdata"),plot:m("./plot").plot,style:m("./style").style,styleOnSelect:m("./style").styleOnSelect,hoverPoints:m("./hover").hoverPoints,eventData:m("./event_data"),selectPoints:m("./select"),moduleType:"trace",name:"bar",basePlotModule:m("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}},{"../../plots/cartesian":578,"../scatter/marker_colorbar":954,"./arrays_to_calcdata":656,"./attributes":657,"./calc":658,"./cross_trace_calc":660,"./defaults":661,"./event_data":662,"./hover":664,"./layout_attributes":666,"./layout_defaults":667,"./plot":668,"./select":669,"./style":671}],666:[function(m,G,Y){G.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],667:[function(m,G,Y){var d=m("../../registry"),v=m("../../plots/cartesian/axes"),w=m("../../lib"),y=m("./layout_attributes");G.exports=function(e,t,n){function o(u,i){return w.coerce(e,t,y,u,i)}for(var r=!1,g=!1,c=!1,a={},h=o("barmode"),l=0;l<n.length;l++){var s=n[l];if(d.traceIs(s,"bar")&&s.visible){if(r=!0,h==="group"){var p=s.xaxis+s.yaxis;a[p]&&(c=!0),a[p]=!0}s.visible&&s.type==="histogram"&&v.getFromId({_fullLayout:t},s[s.orientation==="v"?"xaxis":"yaxis"]).type!=="category"&&(g=!0)}}r?(h!=="overlay"&&o("barnorm"),o("bargap",g&&!c?0:.2),o("bargroupgap")):delete t.barmode}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"./layout_attributes":666}],668:[function(m,G,Y){var d=m("@plotly/d3"),v=m("fast-isnumeric"),w=m("../../lib"),y=m("../../lib/svg_text_utils"),e=m("../../components/color"),t=m("../../components/drawing"),n=m("../../registry"),o=m("../../plots/cartesian/axes").tickText,r=m("./uniform_text"),g=r.recordMinTextSize,c=r.clearMinTextSize,a=m("./style"),h=m("./helpers"),l=m("./constants"),s=m("./attributes"),p=s.text,u=s.textposition,i=m("../../components/fx/helpers").appendArrayPointValue,x=l.TEXTPAD;function f(P){return P.id}function _(P){if(P.ids)return f}function b(P,S){return P<S?1:-1}function T(P,S,E,z){var D;return!S.uniformtext.mode&&k(E)?(z&&(D=z()),P.transition().duration(E.duration).ease(E.easing).each("end",function(){D&&D()}).each("interrupt",function(){D&&D()})):P}function k(P){return P&&P.duration>0}function L(P){return P==="auto"?0:P}function A(P,S){var E=Math.PI/180*S,z=Math.abs(Math.sin(E)),D=Math.abs(Math.cos(E));return{x:P.width*D+P.height*z,y:P.width*z+P.height*D}}function I(P,S,E,z,D,j){var V=!!j.isHorizontal,Z=!!j.constrained,Q=j.angle||0,X=j.anchor||"end",$=X==="end",re=X==="start",H=((j.leftToRight||0)+1)/2,N=1-H,U=D.width,te=D.height,B=Math.abs(S-P),K=Math.abs(z-E),J=B>2*x&&K>2*x?x:0;B-=2*J,K-=2*J;var ee=L(Q);Q!=="auto"||U<=B&&te<=K||!(U>B||te>K)||(U>K||te>B)&&U<te==B<K||(ee+=90);var ne=A(D,ee),se=1;Z&&(se=Math.min(1,B/ne.x,K/ne.y));var oe=D.left*N+D.right*H,me=(D.top+D.bottom)/2,ce=(P+x)*N+(S-x)*H,ye=(E+z)/2,Se=0,fe=0;if(re||$){var ge=(V?ne.x:ne.y)/2,Te=V?b(P,S):b(E,z);V?re?(ce=P+Te*J,Se=-Te*ge):(ce=S-Te*J,Se=Te*ge):re?(ye=E+Te*J,fe=-Te*ge):(ye=z-Te*J,fe=Te*ge)}return{textX:oe,textY:me,targetX:ce,targetY:ye,anchorX:Se,anchorY:fe,scale:se,rotate:ee}}G.exports={plot:function(P,S,E,z,D,j){var V=S.xaxis,Z=S.yaxis,Q=P._fullLayout;D||(D={mode:Q.barmode,norm:Q.barmode,gap:Q.bargap,groupgap:Q.bargroupgap},c("bar",Q));var X=w.makeTraceGroups(z,E,"trace bars").each(function($){var re=d.select(this),H=$[0].trace,N=H.type==="waterfall",U=H.type==="funnel",te=H.type==="bar"||U,B=0;N&&H.connector.visible&&H.connector.mode==="between"&&(B=H.connector.line.width/2);var K=H.orientation==="h",J=k(D),ee=w.ensureSingle(re,"g","points"),ne=_(H),se=ee.selectAll("g.point").data(w.identity,ne);se.enter().append("g").classed("point",!0),se.exit().remove(),se.each(function(me,ce){var ye,Se,fe=d.select(this),ge=function(Fe,ze,Re,We){var $e=[],at=[],gt=We?ze:Re,xt=We?Re:ze;return $e[0]=gt.c2p(Fe.s0,!0),at[0]=xt.c2p(Fe.p0,!0),$e[1]=gt.c2p(Fe.s1,!0),at[1]=xt.c2p(Fe.p1,!0),We?[$e,at]:[at,$e]}(me,V,Z,K),Te=ge[0][0],le=ge[0][1],ve=ge[1][0],Me=ge[1][1],we=(K?le-Te:Me-ve)==0;if(we&&te&&h.getLineWidth(H,me)&&(we=!1),we||(we=!(v(Te)&&v(le)&&v(ve)&&v(Me))),me.isBlank=we,we&&(K?le=Te:Me=ve),B&&!we&&(K?(Te-=b(Te,le)*B,le+=b(Te,le)*B):(ve-=b(ve,Me)*B,Me+=b(ve,Me)*B)),H.type==="waterfall"){if(!we){var de=H[me.dir].marker;ye=de.line.width,Se=de.color}}else ye=h.getLineWidth(H,me),Se=me.mc||H.marker.color;function Ie(Fe){var ze=d.round(ye/2%1,2);return D.gap===0&&D.groupgap===0?d.round(Math.round(Fe)-ze,2):Fe}if(!P._context.staticPlot){var De=e.opacity(Se)<1||ye>.01?Ie:function(Fe,ze,Re){return Re&&Fe===ze?Fe:Math.abs(Fe-ze)>=2?Ie(Fe):Fe>ze?Math.ceil(Fe):Math.floor(Fe)};Te=De(Te,le,K),le=De(le,Te,K),ve=De(ve,Me,!K),Me=De(Me,ve,!K)}var Oe=T(w.ensureSingle(fe,"path"),Q,D,j);if(Oe.style("vector-effect","non-scaling-stroke").attr("d",isNaN((le-Te)*(Me-ve))||we&&P._context.staticPlot?"M0,0Z":"M"+Te+","+ve+"V"+Me+"H"+le+"V"+ve+"Z").call(t.setClipUrl,S.layerClipId,P),!Q.uniformtext.mode&&J){var Ve=t.makePointStyleFns(H);t.singlePointStyle(me,Oe,H,Ve,P)}(function(Fe,ze,Re,We,$e,at,gt,xt,mt,nt,Qe){var vt,jt=ze.xaxis,Gt=ze.yaxis,$t=Fe._fullLayout;function Zt(qt,gr,Cr){return w.ensureSingle(qt,"text").text(gr).attr({class:"bartext bartext-"+vt,"text-anchor":"middle","data-notex":1}).call(t.font,Cr).call(y.convertToTspans,Fe)}var cr=We[0].trace,Dt=cr.orientation==="h",Ne=function(qt,gr,Cr,mr,tr){var nr,Qt=gr[0].trace;return nr=Qt.texttemplate?function(dr,_r,Ir,Rr,Vr){var Xr=_r[0].trace,cn=w.castOption(Xr,Ir,"texttemplate");if(!cn)return"";var an,zn,on,Tn,Mn=Xr.type==="histogram",ei=Xr.type==="waterfall",Hr=Xr.type==="funnel",ln=Xr.orientation==="h";ln?(an="y",zn=Vr,on="x",Tn=Rr):(an="x",zn=Rr,on="y",Tn=Vr);function bn(Rt){return o(Tn,Tn.c2l(Rt),!0).text}var nn=_r[Ir],pn={};pn.label=nn.p,pn.labelLabel=pn[an+"Label"]=(qn=nn.p,o(zn,zn.c2l(qn),!0).text);var qn,sr=w.castOption(Xr,nn.i,"text");(sr===0||sr)&&(pn.text=sr),pn.value=nn.s,pn.valueLabel=pn[on+"Label"]=bn(nn.s);var xr={};i(xr,Xr,nn.i),(Mn||xr.x===void 0)&&(xr.x=ln?pn.value:pn.label),(Mn||xr.y===void 0)&&(xr.y=ln?pn.label:pn.value),(Mn||xr.xLabel===void 0)&&(xr.xLabel=ln?pn.valueLabel:pn.labelLabel),(Mn||xr.yLabel===void 0)&&(xr.yLabel=ln?pn.labelLabel:pn.valueLabel),ei&&(pn.delta=+nn.rawS||nn.s,pn.deltaLabel=bn(pn.delta),pn.final=nn.v,pn.finalLabel=bn(pn.final),pn.initial=pn.final-pn.delta,pn.initialLabel=bn(pn.initial)),Hr&&(pn.value=nn.s,pn.valueLabel=bn(pn.value),pn.percentInitial=nn.begR,pn.percentInitialLabel=w.formatPercent(nn.begR),pn.percentPrevious=nn.difR,pn.percentPreviousLabel=w.formatPercent(nn.difR),pn.percentTotal=nn.sumR,pn.percenTotalLabel=w.formatPercent(nn.sumR));var jr=w.castOption(Xr,nn.i,"customdata");return jr&&(pn.customdata=jr),w.texttemplateString(cn,pn,dr._d3locale,xr,pn,Xr._meta||{})}(qt,gr,Cr,mr,tr):Qt.textinfo?function(dr,_r,Ir,Rr){var Vr=dr[0].trace,Xr=Vr.orientation==="h",cn=Vr.type==="waterfall",an=Vr.type==="funnel";function zn(jr){return o(Xr?Ir:Rr,+jr,!0).text}var on,Tn=Vr.textinfo,Mn=dr[_r],ei=Tn.split("+"),Hr=[],ln=function(jr){return ei.indexOf(jr)!==-1};ln("label")&&Hr.push((bn=dr[_r].p,o(Xr?Rr:Ir,bn,!0).text));var bn;if(ln("text")&&((on=w.castOption(Vr,Mn.i,"text"))===0||on)&&Hr.push(on),cn){var nn=+Mn.rawS||Mn.s,pn=Mn.v,qn=pn-nn;ln("initial")&&Hr.push(zn(qn)),ln("delta")&&Hr.push(zn(nn)),ln("final")&&Hr.push(zn(pn))}if(an){ln("value")&&Hr.push(zn(Mn.s));var sr=0;ln("percent initial")&&sr++,ln("percent previous")&&sr++,ln("percent total")&&sr++;var xr=sr>1;ln("percent initial")&&(on=w.formatPercent(Mn.begR),xr&&(on+=" of initial"),Hr.push(on)),ln("percent previous")&&(on=w.formatPercent(Mn.difR),xr&&(on+=" of previous"),Hr.push(on)),ln("percent total")&&(on=w.formatPercent(Mn.sumR),xr&&(on+=" of total"),Hr.push(on))}return Hr.join("<br>")}(gr,Cr,mr,tr):h.getValue(Qt.text,Cr),h.coerceString(p,nr)}($t,We,$e,jt,Gt);vt=function(qt,gr){var Cr=h.getValue(qt.textposition,gr);return h.coerceEnumerated(u,Cr)}(cr,$e);var Ye=nt.mode==="stack"||nt.mode==="relative",pe=We[$e],_e=!Ye||pe._outmost;if(!Ne||vt==="none"||(pe.isBlank||at===gt||xt===mt)&&(vt==="auto"||vt==="inside"))return void Re.select("text").remove();var Be=$t.font,He=a.getBarColor(We[$e],cr),Je=a.getInsideTextFont(cr,$e,Be,He),Ze=a.getOutsideTextFont(cr,$e,Be),ct=Re.datum();Dt?jt.type==="log"&&ct.s0<=0&&(at=jt.range[0]<jt.range[1]?0:jt._length):Gt.type==="log"&&ct.s0<=0&&(xt=Gt.range[0]<Gt.range[1]?Gt._length:0);var lt,At,Ot,it,ht,Ut=Math.abs(gt-at)-2*x,Mt=Math.abs(mt-xt)-2*x;if(vt==="outside"&&(_e||pe.hasB||(vt="inside")),vt==="auto")if(_e){vt="inside",ht=w.ensureUniformFontSize(Fe,Je),lt=Zt(Re,Ne,ht),At=t.bBox(lt.node()),Ot=At.width,it=At.height;var It=Ot<=Ut&&it<=Mt,Le=Ot<=Mt&&it<=Ut,Xe=Dt?Ut>=Ot*(Mt/it):Mt>=it*(Ut/Ot);Ot>0&&it>0&&(It||Le||Xe)?vt="inside":(vt="outside",lt.remove(),lt=null)}else vt="inside";if(!lt){ht=w.ensureUniformFontSize(Fe,vt==="outside"?Ze:Je);var ot=(lt=Zt(Re,Ne,ht)).attr("transform");if(lt.attr("transform",""),At=t.bBox(lt.node()),Ot=At.width,it=At.height,lt.attr("transform",ot),Ot<=0||it<=0)return void lt.remove()}var pt,St,Vt=cr.textangle;vt==="outside"?(St=cr.constraintext==="both"||cr.constraintext==="outside",pt=function(qt,gr,Cr,mr,tr,nr){var Qt,dr=!!nr.isHorizontal,_r=!!nr.constrained,Ir=nr.angle||0,Rr=tr.width,Vr=tr.height,Xr=Math.abs(gr-qt),cn=Math.abs(mr-Cr);Qt=dr?cn>2*x?x:0:Xr>2*x?x:0;var an=1;_r&&(an=dr?Math.min(1,cn/Vr):Math.min(1,Xr/Rr));var zn=L(Ir),on=A(tr,zn),Tn=(dr?on.x:on.y)/2,Mn=(tr.left+tr.right)/2,ei=(tr.top+tr.bottom)/2,Hr=(qt+gr)/2,ln=(Cr+mr)/2,bn=0,nn=0,pn=dr?b(gr,qt):b(Cr,mr);return dr?(Hr=gr-pn*Qt,bn=pn*Tn):(ln=mr+pn*Qt,nn=-pn*Tn),{textX:Mn,textY:ei,targetX:Hr,targetY:ln,anchorX:bn,anchorY:nn,scale:an,rotate:zn}}(at,gt,xt,mt,At,{isHorizontal:Dt,constrained:St,angle:Vt})):(St=cr.constraintext==="both"||cr.constraintext==="inside",pt=I(at,gt,xt,mt,At,{isHorizontal:Dt,constrained:St,angle:Vt,anchor:cr.insidetextanchor})),pt.fontSize=ht.size,g(cr.type==="histogram"?"bar":cr.type,pt,$t),pe.transform=pt;var Jt=T(lt,$t,nt,Qe);w.setTransormAndDisplay(Jt,pt)})(P,S,fe,$,ce,Te,le,ve,Me,D,j),S.layerClipId&&t.hideOutsideRangePoint(me,fe.select("text"),V,Z,H.xcalendar,H.ycalendar)});var oe=H.cliponaxis===!1;t.setClipUrl(re,oe?null:S.layerClipId,P)});n.getComponentMethod("errorbars","plot")(P,X,S,D)},toMoveInsideBar:I}},{"../../components/color":367,"../../components/drawing":389,"../../components/fx/helpers":403,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"./attributes":657,"./constants":659,"./helpers":663,"./style":671,"./uniform_text":673,"@plotly/d3":58,"fast-isnumeric":190}],669:[function(m,G,Y){function d(v,w,y,e,t){var n=w.c2p(e?v.s0:v.p0,!0),o=w.c2p(e?v.s1:v.p1,!0),r=y.c2p(e?v.p0:v.s0,!0),g=y.c2p(e?v.p1:v.s1,!0);return t?[(n+o)/2,(r+g)/2]:e?[o,(r+g)/2]:[(n+o)/2,g]}G.exports=function(v,w){var y,e=v.cd,t=v.xaxis,n=v.yaxis,o=e[0].trace,r=o.type==="funnel",g=o.orientation==="h",c=[];if(w===!1)for(y=0;y<e.length;y++)e[y].selected=0;else for(y=0;y<e.length;y++){var a=e[y],h="ct"in a?a.ct:d(a,t,n,g,r);w.contains(h,!1,y,v)?(c.push({pointNumber:y,x:t.c2d(a.x),y:n.c2d(a.y)}),a.selected=1):a.selected=0}return c}},{}],670:[function(m,G,Y){G.exports=w;var d=m("../../lib").distinctVals,v=m("../../constants/numerical").BADNUM;function w(y,e){this.traces=y,this.sepNegVal=e.sepNegVal,this.overlapNoMerge=e.overlapNoMerge;for(var t=1/0,n=[],o=0;o<y.length;o++){for(var r=y[o],g=0;g<r.length;g++){var c=r[g];c.p!==v&&n.push(c.p)}r[0]&&r[0].width1&&(t=Math.min(r[0].width1,t))}this.positions=n;var a=d(n);this.distinctPositions=a.vals,a.vals.length===1&&t!==1/0?this.minDiff=t:this.minDiff=Math.min(a.minDiff,t);var h=(e.posAxis||{}).type;h!=="category"&&h!=="multicategory"||(this.minDiff=1),this.binWidth=this.minDiff,this.bins={}}w.prototype.put=function(y,e){var t=this.getLabel(y,e),n=this.bins[t]||0;return this.bins[t]=n+e,n},w.prototype.get=function(y,e){var t=this.getLabel(y,e);return this.bins[t]||0},w.prototype.getLabel=function(y,e){return(e<0&&this.sepNegVal?"v":"^")+(this.overlapNoMerge?y:Math.round(y/this.binWidth))}},{"../../constants/numerical":491,"../../lib":515}],671:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../components/color"),w=m("../../components/drawing"),y=m("../../lib"),e=m("../../registry"),t=m("./uniform_text").resizeText,n=m("./attributes"),o=n.textfont,r=n.insidetextfont,g=n.outsidetextfont,c=m("./helpers");function a(f,_,b){w.pointStyle(f.selectAll("path"),_,b),h(f,_,b)}function h(f,_,b){f.selectAll("text").each(function(T){var k=d.select(this),L=y.ensureUniformFontSize(b,l(k,T,_,b));w.font(k,L)})}function l(f,_,b,T){var k=T._fullLayout.font,L=b.textfont;if(f.classed("bartext-inside")){var A=x(_,b);L=p(b,_.i,k,A)}else f.classed("bartext-outside")&&(L=u(b,_.i,k));return L}function s(f,_,b){return i(o,f.textfont,_,b)}function p(f,_,b,T){var k=s(f,_,b);return(f._input.textfont===void 0||f._input.textfont.color===void 0||Array.isArray(f.textfont.color)&&f.textfont.color[_]===void 0)&&(k={color:v.contrast(T),family:k.family,size:k.size}),i(r,f.insidetextfont,_,k)}function u(f,_,b){var T=s(f,_,b);return i(g,f.outsidetextfont,_,T)}function i(f,_,b,T){_=_||{};var k=c.getValue(_.family,b),L=c.getValue(_.size,b),A=c.getValue(_.color,b);return{family:c.coerceString(f.family,k,T.family),size:c.coerceNumber(f.size,L,T.size),color:c.coerceColor(f.color,A,T.color)}}function x(f,_){return _.type==="waterfall"?_[f.dir].marker.color:f.mcc||f.mc||_.marker.color}G.exports={style:function(f){var _=d.select(f).selectAll("g.barlayer").selectAll("g.trace");t(f,_,"bar");var b=_.size(),T=f._fullLayout;_.style("opacity",function(k){return k[0].trace.opacity}).each(function(k){(T.barmode==="stack"&&b>1||T.bargap===0&&T.bargroupgap===0&&!k[0].trace.marker.line.width)&&d.select(this).attr("shape-rendering","crispEdges")}),_.selectAll("g.points").each(function(k){a(d.select(this),k[0].trace,f)}),e.getComponentMethod("errorbars","style")(_)},styleTextPoints:h,styleOnSelect:function(f,_,b){var T=_[0].trace;T.selectedpoints?function(k,L,A){w.selectedPointStyle(k.selectAll("path"),L),function(I,P,S){I.each(function(E){var z,D=d.select(this);if(E.selected){z=y.ensureUniformFontSize(S,l(D,E,P,S));var j=P.selected.textfont&&P.selected.textfont.color;j&&(z.color=j),w.font(D,z)}else w.selectedTextStyle(D,P)})}(k.selectAll("text"),L,A)}(b,T,f):(a(b,T,f),e.getComponentMethod("errorbars","style")(b))},getInsideTextFont:p,getOutsideTextFont:u,getBarColor:x,resizeText:t}},{"../../components/color":367,"../../components/drawing":389,"../../lib":515,"../../registry":647,"./attributes":657,"./helpers":663,"./uniform_text":673,"@plotly/d3":58}],672:[function(m,G,Y){var d=m("../../components/color"),v=m("../../components/colorscale/helpers").hasColorscale,w=m("../../components/colorscale/defaults"),y=m("../../lib").coercePattern;G.exports=function(e,t,n,o,r){var g=n("marker.color",o),c=v(e,"marker");c&&w(e,t,r,n,{prefix:"marker.",cLetter:"c"}),n("marker.line.color",d.defaultLine),v(e,"marker.line")&&w(e,t,r,n,{prefix:"marker.line.",cLetter:"c"}),n("marker.line.width"),n("marker.opacity"),y(n,"marker.pattern",g,c),n("selected.marker.color"),n("unselected.marker.color")}},{"../../components/color":367,"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515}],673:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../lib");function w(y){return"_"+y+"Text_minsize"}G.exports={recordMinTextSize:function(y,e,t){if(t.uniformtext.mode){var n=w(y),o=t.uniformtext.minsize,r=e.scale*e.fontSize;e.hide=r<o,t[n]=t[n]||1/0,e.hide||(t[n]=Math.min(t[n],Math.max(r,o)))}},clearMinTextSize:function(y,e){e[w(y)]=void 0},resizeText:function(y,e,t){var n=y._fullLayout,o=n["_"+t+"Text_minsize"];if(o){var r,g=n.uniformtext.mode==="hide";switch(t){case"funnelarea":case"pie":case"sunburst":r="g.slice";break;case"treemap":case"icicle":r="g.slice, g.pathbar";break;default:r="g.points > g.point"}e.selectAll(r).each(function(c){var a=c.transform;if(a){a.scale=g&&a.hide?0:o/a.fontSize;var h=d.select(this).select("text");v.setTransormAndDisplay(h,a)}})}}}},{"../../lib":515,"@plotly/d3":58}],674:[function(m,G,Y){var d=m("../../plots/template_attributes").hovertemplateAttrs,v=m("../../lib/extend").extendFlat,w=m("../scatterpolar/attributes"),y=m("../bar/attributes");G.exports={r:w.r,theta:w.theta,r0:w.r0,dr:w.dr,theta0:w.theta0,dtheta:w.dtheta,thetaunit:w.thetaunit,base:v({},y.base,{}),offset:v({},y.offset,{}),width:v({},y.width,{}),text:v({},y.text,{}),hovertext:v({},y.hovertext,{}),marker:y.marker,hoverinfo:w.hoverinfo,hovertemplate:d(),selected:y.selected,unselected:y.unselected}},{"../../lib/extend":505,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatterpolar/attributes":1011}],675:[function(m,G,Y){var d=m("../../components/colorscale/helpers").hasColorscale,v=m("../../components/colorscale/calc"),w=m("../bar/arrays_to_calcdata"),y=m("../bar/cross_trace_calc").setGroupPositions,e=m("../scatter/calc_selection"),t=m("../../registry").traceIs,n=m("../../lib").extendFlat;G.exports={calc:function(o,r){for(var g=o._fullLayout,c=r.subplot,a=g[c].radialaxis,h=g[c].angularaxis,l=a.makeCalcdata(r,"r"),s=h.makeCalcdata(r,"theta"),p=r._length,u=new Array(p),i=l,x=s,f=0;f<p;f++)u[f]={p:x[f],s:i[f]};function _(b){var T=r[b];T!==void 0&&(r["_"+b]=Array.isArray(T)?h.makeCalcdata(r,b):h.d2c(T,r.thetaunit))}return h.type==="linear"&&(_("width"),_("offset")),d(r,"marker")&&v(o,r,{vals:r.marker.color,containerStr:"marker",cLetter:"c"}),d(r,"marker.line")&&v(o,r,{vals:r.marker.line.color,containerStr:"marker.line",cLetter:"c"}),w(u,r),e(u,r),u},crossTraceCalc:function(o,r,g){for(var c=o.calcdata,a=[],h=0;h<c.length;h++){var l=c[h],s=l[0].trace;s.visible===!0&&t(s,"bar")&&s.subplot===g&&a.push(l)}var p=n({},r.radialaxis,{_id:"x"}),u=r.angularaxis;y(o,u,p,a,{mode:r.barmode,norm:r.barnorm,gap:r.bargap,groupgap:r.bargroupgap})}}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../lib":515,"../../registry":647,"../bar/arrays_to_calcdata":656,"../bar/cross_trace_calc":660,"../scatter/calc_selection":938}],676:[function(m,G,Y){var d=m("../../lib"),v=m("../scatterpolar/defaults").handleRThetaDefaults,w=m("../bar/style_defaults"),y=m("./attributes");G.exports=function(e,t,n,o){function r(g,c){return d.coerce(e,t,y,g,c)}v(e,t,o,r)?(r("thetaunit"),r("base"),r("offset"),r("width"),r("text"),r("hovertext"),r("hovertemplate"),w(e,t,r,n,o),d.coerceSelectionMarkerOpacity(t,r)):t.visible=!1}},{"../../lib":515,"../bar/style_defaults":672,"../scatterpolar/defaults":1013,"./attributes":674}],677:[function(m,G,Y){var d=m("../../components/fx"),v=m("../../lib"),w=m("../bar/hover").getTraceColor,y=v.fillText,e=m("../scatterpolar/hover").makeHoverPointText,t=m("../../plots/polar/helpers").isPtInsidePolygon;G.exports=function(n,o,r){var g=n.cd,c=g[0].trace,a=n.subplot,h=a.radialAxis,l=a.angularAxis,s=a.vangles,p=s?t:v.isPtInsideSector,u=n.maxHoverDistance,i=l._period||2*Math.PI,x=Math.abs(h.g2p(Math.sqrt(o*o+r*r))),f=Math.atan2(r,o);if(h.range[0]>h.range[1]&&(f+=Math.PI),d.getClosest(g,function(T){return p(x,f,[T.rp0,T.rp1],[T.thetag0,T.thetag1],s)?u+Math.min(1,Math.abs(T.thetag1-T.thetag0)/i)-1+(T.rp1-x)/(T.rp1-T.rp0)-1:1/0},n),n.index!==!1){var _=g[n.index];n.x0=n.x1=_.ct[0],n.y0=n.y1=_.ct[1];var b=v.extendFlat({},_,{r:_.s,theta:_.p});return y(_,c,n),e(b,c,a,n),n.hovertemplate=c.hovertemplate,n.color=w(c,_),n.xLabelVal=n.yLabelVal=void 0,_.s<0&&(n.idealAlign="left"),[n]}}},{"../../components/fx":407,"../../lib":515,"../../plots/polar/helpers":630,"../bar/hover":664,"../scatterpolar/hover":1015}],678:[function(m,G,Y){G.exports={moduleType:"trace",name:"barpolar",basePlotModule:m("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:m("./attributes"),layoutAttributes:m("./layout_attributes"),supplyDefaults:m("./defaults"),supplyLayoutDefaults:m("./layout_defaults"),calc:m("./calc").calc,crossTraceCalc:m("./calc").crossTraceCalc,plot:m("./plot"),colorbar:m("../scatter/marker_colorbar"),formatLabels:m("../scatterpolar/format_labels"),style:m("../bar/style").style,styleOnSelect:m("../bar/style").styleOnSelect,hoverPoints:m("./hover"),selectPoints:m("../bar/select"),meta:{}}},{"../../plots/polar":631,"../bar/select":669,"../bar/style":671,"../scatter/marker_colorbar":954,"../scatterpolar/format_labels":1014,"./attributes":674,"./calc":675,"./defaults":676,"./hover":677,"./layout_attributes":679,"./layout_defaults":680,"./plot":681}],679:[function(m,G,Y){G.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],680:[function(m,G,Y){var d=m("../../lib"),v=m("./layout_attributes");G.exports=function(w,y,e){var t,n={};function o(c,a){return d.coerce(w[t]||{},y[t],v,c,a)}for(var r=0;r<e.length;r++){var g=e[r];g.type==="barpolar"&&g.visible===!0&&(n[t=g.subplot]||(o("barmode"),o("bargap"),n[t]=1))}}},{"../../lib":515,"./layout_attributes":679}],681:[function(m,G,Y){var d=m("@plotly/d3"),v=m("fast-isnumeric"),w=m("../../lib"),y=m("../../components/drawing"),e=m("../../plots/polar/helpers");G.exports=function(t,n,o){var r=n.xaxis,g=n.yaxis,c=n.radialAxis,a=n.angularAxis,h=function(s){var p=s.cxx,u=s.cyy;return s.vangles?function(i,x,f,_){var b,T;w.angleDelta(f,_)>0?(b=f,T=_):(b=_,T=f);var k=[e.findEnclosingVertexAngles(b,s.vangles)[0],(b+T)/2,e.findEnclosingVertexAngles(T,s.vangles)[1]];return e.pathPolygonAnnulus(i,x,b,T,k,p,u)}:function(i,x,f,_){return w.pathAnnulus(i,x,f,_,p,u)}}(n),l=n.layers.frontplot.select("g.barlayer");w.makeTraceGroups(l,o,"trace bars").each(function(){var s=d.select(this),p=w.ensureSingle(s,"g","points").selectAll("g.point").data(w.identity);p.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),p.exit().remove(),p.each(function(u){var i,x=d.select(this),f=u.rp0=c.c2p(u.s0),_=u.rp1=c.c2p(u.s1),b=u.thetag0=a.c2g(u.p0),T=u.thetag1=a.c2g(u.p1);if(v(f)&&v(_)&&v(b)&&v(T)&&f!==_&&b!==T){var k=c.c2g(u.s1),L=(b+T)/2;u.ct=[r.c2p(k*Math.cos(L)),g.c2p(k*Math.sin(L))],i=h(f,_,b,T)}else i="M0,0Z";w.ensureSingle(x,"path").attr("d",i)}),y.setClipUrl(s,n._hasClipOnAxisFalse?n.clipIds.forTraces:null,t)})}},{"../../components/drawing":389,"../../lib":515,"../../plots/polar/helpers":630,"@plotly/d3":58,"fast-isnumeric":190}],682:[function(m,G,Y){var d=m("../scatter/attributes"),v=m("../bar/attributes"),w=m("../../components/color/attributes"),y=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=m("../../plots/template_attributes").hovertemplateAttrs,t=m("../../lib/extend").extendFlat,n=d.marker,o=n.line;G.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},xperiod:d.xperiod,yperiod:d.yperiod,xperiod0:d.xperiod0,yperiod0:d.yperiod0,xperiodalignment:d.xperiodalignment,yperiodalignment:d.yperiodalignment,xhoverformat:y("x"),yhoverformat:y("y"),name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:t({},n.symbol,{arrayOk:!1,editType:"plot"}),opacity:t({},n.opacity,{arrayOk:!1,dflt:1,editType:"style"}),angle:t({},n.angle,{arrayOk:!1,editType:"calc"}),size:t({},n.size,{arrayOk:!1,editType:"calc"}),color:t({},n.color,{arrayOk:!1,editType:"style"}),line:{color:t({},o.color,{arrayOk:!1,dflt:w.defaultLine,editType:"style"}),width:t({},o.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:d.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:v.offsetgroup,alignmentgroup:v.alignmentgroup,selected:{marker:d.selected.marker,editType:"style"},unselected:{marker:d.unselected.marker,editType:"style"},text:t({},d.text,{}),hovertext:t({},d.hovertext,{}),hovertemplate:e({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936}],683:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../plots/cartesian/axes"),w=m("../../plots/cartesian/align_period"),y=m("../../lib"),e=m("../../constants/numerical").BADNUM,t=y._;G.exports=function(p,u){var i,x,f,_,b,T,k,L=p._fullLayout,A=v.getFromId(p,u.xaxis||"x"),I=v.getFromId(p,u.yaxis||"y"),P=[],S=u.type==="violin"?"_numViolins":"_numBoxes";u.orientation==="h"?(f=A,_="x",b=I,T="y",k=!!u.yperiodalignment):(f=I,_="y",b=A,T="x",k=!!u.xperiodalignment);var E,z,D,j,V,Z,Q=function(Re,We,$e,at){var gt,xt=We+"0"in Re,mt="d"+We in Re;if(We in Re||xt&&mt){var nt=$e.makeCalcdata(Re,We);return[w(Re,$e,We,nt).vals,nt]}gt=xt?Re[We+"0"]:"name"in Re&&($e.type==="category"||d(Re.name)&&["linear","log"].indexOf($e.type)!==-1||y.isDateTime(Re.name)&&$e.type==="date")?Re.name:at;for(var Qe=$e.type==="multicategory"?$e.r2c_just_indices(gt):$e.d2c(gt,0,Re[We+"calendar"]),vt=Re._length,jt=new Array(vt),Gt=0;Gt<vt;Gt++)jt[Gt]=Qe;return[jt]}(u,T,b,L[S]),X=Q[0],$=Q[1],re=y.distinctVals(X,b),H=re.vals,N=re.minDiff/2,U=(u.boxpoints||u.points)==="all"?y.identity:function(Re){return Re.v<E.lf||Re.v>E.uf};if(u._hasPreCompStats){var te=u[_],B=function(Re){return f.d2c((u[Re]||[])[i])},K=1/0,J=-1/0;for(i=0;i<u._length;i++){var ee=X[i];if(d(ee)){if((E={}).pos=E[T]=ee,k&&$&&(E.orig_p=$[i]),E.q1=B("q1"),E.med=B("median"),E.q3=B("q3"),z=[],te&&y.isArrayOrTypedArray(te[i]))for(x=0;x<te[i].length;x++)(Z=f.d2c(te[i][x]))!==e&&(o(V={v:Z,i:[i,x]},u,[i,x]),z.push(V));if(E.pts=z.sort(r),j=(D=E[_]=z.map(g)).length,E.med!==e&&E.q1!==e&&E.q3!==e&&E.med>=E.q1&&E.q3>=E.med){var ne=B("lowerfence");E.lf=ne!==e&&ne<=E.q1?ne:c(E,D,j);var se=B("upperfence");E.uf=se!==e&&se>=E.q3?se:a(E,D,j);var oe=B("mean");E.mean=oe!==e?oe:j?y.mean(D,j):(E.q1+E.q3)/2;var me=B("sd");E.sd=oe!==e&&me>=0?me:j?y.stdev(D,j,E.mean):E.q3-E.q1,E.lo=h(E),E.uo=l(E);var ce=B("notchspan");ce=ce!==e&&ce>0?ce:s(E,j),E.ln=E.med-ce,E.un=E.med+ce;var ye=E.lf,Se=E.uf;u.boxpoints&&D.length&&(ye=Math.min(ye,D[0]),Se=Math.max(Se,D[j-1])),u.notched&&(ye=Math.min(ye,E.ln),Se=Math.max(Se,E.un)),E.min=ye,E.max=Se}else{var fe;y.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+E.q1,"median = "+E.med,"q3 = "+E.q3].join(`
`)),fe=E.med!==e?E.med:E.q1!==e?E.q3!==e?(E.q1+E.q3)/2:E.q1:E.q3!==e?E.q3:0,E.med=fe,E.q1=E.q3=fe,E.lf=E.uf=fe,E.mean=E.sd=fe,E.ln=E.un=fe,E.min=E.max=fe}K=Math.min(K,E.min),J=Math.max(J,E.max),E.pts2=z.filter(U),P.push(E)}}u._extremes[f._id]=v.findExtremes(f,[K,J],{padded:!0})}else{var ge=f.makeCalcdata(u,_),Te=function(Re,We){for(var $e=Re.length,at=new Array($e+1),gt=0;gt<$e;gt++)at[gt]=Re[gt]-We;return at[$e]=Re[$e-1]+We,at}(H,N),le=H.length,ve=function(Re){for(var We=new Array(Re),$e=0;$e<Re;$e++)We[$e]=[];return We}(le);for(i=0;i<u._length;i++)if(Z=ge[i],d(Z)){var Me=y.findBin(X[i],Te);Me>=0&&Me<le&&(o(V={v:Z,i},u,i),ve[Me].push(V))}var we=1/0,de=-1/0,Ie=u.quartilemethod,De=Ie==="exclusive",Oe=Ie==="inclusive";for(i=0;i<le;i++)if(ve[i].length>0){var Ve,Fe;(E={}).pos=E[T]=H[i],z=E.pts=ve[i].sort(r),j=(D=E[_]=z.map(g)).length,E.min=D[0],E.max=D[j-1],E.mean=y.mean(D,j),E.sd=y.stdev(D,j,E.mean),E.med=y.interp(D,.5),j%2&&(De||Oe)?(De?(Ve=D.slice(0,j/2),Fe=D.slice(j/2+1)):Oe&&(Ve=D.slice(0,j/2+1),Fe=D.slice(j/2)),E.q1=y.interp(Ve,.5),E.q3=y.interp(Fe,.5)):(E.q1=y.interp(D,.25),E.q3=y.interp(D,.75)),E.lf=c(E,D,j),E.uf=a(E,D,j),E.lo=h(E),E.uo=l(E);var ze=s(E,j);E.ln=E.med-ze,E.un=E.med+ze,we=Math.min(we,E.ln),de=Math.max(de,E.un),E.pts2=z.filter(U),P.push(E)}u._extremes[f._id]=v.findExtremes(f,u.notched?ge.concat([we,de]):ge,{padded:!0})}return function(Re,We){if(y.isArrayOrTypedArray(We.selectedpoints))for(var $e=0;$e<Re.length;$e++){for(var at=Re[$e].pts||[],gt={},xt=0;xt<at.length;xt++)gt[at[xt].i]=xt;y.tagSelected(at,We,gt)}}(P,u),P.length>0?(P[0].t={num:L[S],dPos:N,posLetter:T,valLetter:_,labels:{med:t(p,"median:"),min:t(p,"min:"),q1:t(p,"q1:"),q3:t(p,"q3:"),max:t(p,"max:"),mean:u.boxmean==="sd"?t(p,"mean \xB1 \u03C3:"):t(p,"mean:"),lf:t(p,"lower fence:"),uf:t(p,"upper fence:")}},L[S]++,P):[{t:{empty:!0}}]};var n={text:"tx",hovertext:"htx"};function o(p,u,i){for(var x in n)y.isArrayOrTypedArray(u[x])&&(Array.isArray(i)?y.isArrayOrTypedArray(u[x][i[0]])&&(p[n[x]]=u[x][i[0]][i[1]]):p[n[x]]=u[x][i])}function r(p,u){return p.v-u.v}function g(p){return p.v}function c(p,u,i){return i===0?p.q1:Math.min(p.q1,u[Math.min(y.findBin(2.5*p.q1-1.5*p.q3,u,!0)+1,i-1)])}function a(p,u,i){return i===0?p.q3:Math.max(p.q3,u[Math.max(y.findBin(2.5*p.q3-1.5*p.q1,u),0)])}function h(p){return 4*p.q1-3*p.q3}function l(p){return 4*p.q3-3*p.q1}function s(p,u){return u===0?0:1.57*(p.q3-p.q1)/Math.sqrt(u)}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"fast-isnumeric":190}],684:[function(m,G,Y){var d=m("../../plots/cartesian/axes"),v=m("../../lib"),w=m("../../plots/cartesian/constraints").getAxisGroup,y=["v","h"];function e(t,n,o,r){var g,c,a,h=n.calcdata,l=n._fullLayout,s=r._id,p=s.charAt(0),u=[],i=0;for(g=0;g<o.length;g++)for(a=h[o[g]],c=0;c<a.length;c++)u.push(r.c2l(a[c].pos,!0)),i+=(a[c].pts2||[]).length;if(u.length){var x=v.distinctVals(u);r.type!=="category"&&r.type!=="multicategory"||(x.minDiff=1);var f=x.minDiff/2;d.minDtick(r,x.minDiff,x.vals[0],!0);var _=l[t==="violin"?"_numViolins":"_numBoxes"],b=l[t+"mode"]==="group"&&_>1,T=1-l[t+"gap"],k=1-l[t+"groupgap"];for(g=0;g<o.length;g++){var L,A,I,P,S,E,z=(a=h[o[g]])[0].trace,D=a[0].t,j=z.width,V=z.side;if(j)L=A=P=j/2,I=0;else if(L=f,b){var Z=w(l,r._id)+z.orientation,Q=(l._alignmentOpts[Z]||{})[z.alignmentgroup]||{},X=Object.keys(Q.offsetGroups||{}).length,$=X||_;A=L*T*k/$,I=2*L*(((X?z._offsetIndex:D.num)+.5)/$-.5)*T,P=L*T/$}else A=L*T*k,I=0,P=L;D.dPos=L,D.bPos=I,D.bdPos=A,D.wHover=P;var re,H,N,U,te,B,K=I+A,J=Boolean(j);if(V==="positive"?(S=L*(j?1:.5),re=K,E=re=I):V==="negative"?(S=re=I,E=L*(j?1:.5),H=K):(S=E=L,re=H=K),(z.boxpoints||z.points)&&i>0){var ee=z.pointpos,ne=z.jitter,se=z.marker.size/2,oe=0;ee+ne>=0&&((oe=K*(ee+ne))>S?(J=!0,te=se,N=oe):oe>re&&(te=se,N=S)),oe<=S&&(N=S);var me=0;ee-ne<=0&&((me=-K*(ee-ne))>E?(J=!0,B=se,U=me):me>H&&(B=se,U=E)),me<=E&&(U=E)}else N=S,U=E;var ce=new Array(a.length);for(c=0;c<a.length;c++)ce[c]=a[c].pos;z._extremes[s]=d.findExtremes(r,ce,{padded:J,vpadminus:U,vpadplus:N,vpadLinearized:!0,ppadminus:{x:B,y:te}[p],ppadplus:{x:te,y:B}[p]})}}}G.exports={crossTraceCalc:function(t,n){for(var o=t.calcdata,r=n.xaxis,g=n.yaxis,c=0;c<y.length;c++){for(var a=y[c],h=a==="h"?g:r,l=[],s=0;s<o.length;s++){var p=o[s],u=p[0].t,i=p[0].trace;i.visible!==!0||i.type!=="box"&&i.type!=="candlestick"||u.empty||(i.orientation||"v")!==a||i.xaxis!==r._id||i.yaxis!==g._id||l.push(s)}e("box",t,l,h)}},setPositionOffset:e}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../plots/cartesian/constraints":574}],685:[function(m,G,Y){var d=m("../../lib"),v=m("../../registry"),w=m("../../components/color"),y=m("../scatter/period_defaults"),e=m("../bar/defaults").handleGroupingDefaults,t=m("../../plots/cartesian/axis_autotype"),n=m("./attributes");function o(g,c,a,h){function l(V){var Z=0;return V&&V.length&&(Z+=1,d.isArrayOrTypedArray(V[0])&&V[0].length&&(Z+=1)),Z}function s(V){return d.validate(g[V],n[V])}var p,u=a("y"),i=a("x");if(c.type==="box"){var x=a("q1"),f=a("median"),_=a("q3");c._hasPreCompStats=x&&x.length&&f&&f.length&&_&&_.length,p=Math.min(d.minRowLength(x),d.minRowLength(f),d.minRowLength(_))}var b,T,k=l(u),L=l(i),A=k&&d.minRowLength(u),I=L&&d.minRowLength(i),P=h.calendar,S={autotypenumbers:h.autotypenumbers};if(c._hasPreCompStats)switch(String(L)+String(k)){case"00":var E=s("x0")||s("dx");b=(s("y0")||s("dy"))&&!E?"h":"v",T=p;break;case"10":b="v",T=Math.min(p,I);break;case"20":b="h",T=Math.min(p,i.length);break;case"01":b="h",T=Math.min(p,A);break;case"02":b="v",T=Math.min(p,u.length);break;case"12":b="v",T=Math.min(p,I,u.length);break;case"21":b="h",T=Math.min(p,i.length,A);break;case"11":T=0;break;case"22":var z,D=!1;for(z=0;z<i.length;z++)if(t(i[z],P,S)==="category"){D=!0;break}if(D)b="v",T=Math.min(p,I,u.length);else{for(z=0;z<u.length;z++)if(t(u[z],P,S)==="category"){D=!0;break}D?(b="h",T=Math.min(p,i.length,A)):(b="v",T=Math.min(p,I,u.length))}}else k>0?(b="v",T=L>0?Math.min(I,A):Math.min(A)):L>0?(b="h",T=Math.min(I)):T=0;if(T){c._length=T;var j=a("orientation",b);c._hasPreCompStats?j==="v"&&L===0?(a("x0",0),a("dx",1)):j==="h"&&k===0&&(a("y0",0),a("dy",1)):j==="v"&&L===0?a("x0"):j==="h"&&k===0&&a("y0"),v.getComponentMethod("calendars","handleTraceDefaults")(g,c,["x","y"],h)}else c.visible=!1}function r(g,c,a,h){var l=h.prefix,s=d.coerce2(g,c,n,"marker.outliercolor"),p=a("marker.line.outliercolor"),u="outliers";c._hasPreCompStats?u="all":(s||p)&&(u="suspectedoutliers");var i=a(l+"points",u);i?(a("jitter",i==="all"?.3:0),a("pointpos",i==="all"?-1.5:0),a("marker.symbol"),a("marker.opacity"),a("marker.size"),a("marker.angle"),a("marker.color",c.line.color),a("marker.line.color"),a("marker.line.width"),i==="suspectedoutliers"&&(a("marker.line.outliercolor",c.marker.color),a("marker.line.outlierwidth")),a("selected.marker.color"),a("unselected.marker.color"),a("selected.marker.size"),a("unselected.marker.size"),a("text"),a("hovertext")):delete c.marker;var x=a("hoveron");x!=="all"&&x.indexOf("points")===-1||a("hovertemplate"),d.coerceSelectionMarkerOpacity(c,a)}G.exports={supplyDefaults:function(g,c,a,h){function l(_,b){return d.coerce(g,c,n,_,b)}if(o(g,c,l,h),c.visible!==!1){y(g,c,h,l),l("xhoverformat"),l("yhoverformat");var s=c._hasPreCompStats;s&&(l("lowerfence"),l("upperfence")),l("line.color",(g.marker||{}).color||a),l("line.width"),l("fillcolor",w.addOpacity(c.line.color,.5));var p=!1;if(s){var u=l("mean"),i=l("sd");u&&u.length&&(p=!0,i&&i.length&&(p="sd"))}l("boxmean",p),l("whiskerwidth"),l("width"),l("quartilemethod");var x=!1;if(s){var f=l("notchspan");f&&f.length&&(x=!0)}else d.validate(g.notchwidth,n.notchwidth)&&(x=!0);l("notched",x)&&l("notchwidth"),r(g,c,l,{prefix:"box"})}},crossTraceDefaults:function(g,c){var a,h;function l(u){return d.coerce(h._input,h,n,u)}for(var s=0;s<g.length;s++){var p=(h=g[s]).type;p!=="box"&&p!=="violin"||(a=h._input,c[p+"mode"]==="group"&&e(a,h,c,l))}},handleSampleDefaults:o,handlePointsDefaults:r}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axis_autotype":567,"../../registry":647,"../bar/defaults":661,"../scatter/period_defaults":956,"./attributes":682}],686:[function(m,G,Y){G.exports=function(d,v){return v.hoverOnBox&&(d.hoverOnBox=v.hoverOnBox),"xVal"in v&&(d.x=v.xVal),"yVal"in v&&(d.y=v.yVal),v.xa&&(d.xaxis=v.xa),v.ya&&(d.yaxis=v.ya),d}},{}],687:[function(m,G,Y){var d=m("../../plots/cartesian/axes"),v=m("../../lib"),w=m("../../components/fx"),y=m("../../components/color"),e=v.fillText;function t(o,r,g,c){var a,h,l,s,p,u,i,x,f,_,b,T,k,L,A=o.cd,I=o.xa,P=o.ya,S=A[0].trace,E=A[0].t,z=S.type==="violin",D=E.bdPos,j=E.wHover,V=function(fe){return l.c2l(fe.pos)+E.bPos-l.c2l(u)};z&&S.side!=="both"?(S.side==="positive"&&(f=function(fe){var ge=V(fe);return w.inbox(ge,ge+j,_)},T=D,k=0),S.side==="negative"&&(f=function(fe){var ge=V(fe);return w.inbox(ge-j,ge,_)},T=0,k=D)):(f=function(fe){var ge=V(fe);return w.inbox(ge-j,ge+j,_)},T=k=D),L=z?function(fe){return w.inbox(fe.span[0]-p,fe.span[1]-p,_)}:function(fe){return w.inbox(fe.min-p,fe.max-p,_)},S.orientation==="h"?(p=r,u=g,i=L,x=f,a="y",l=P,h="x",s=I):(p=g,u=r,i=f,x=L,a="x",l=I,h="y",s=P);var Z=Math.min(1,D/Math.abs(l.r2c(l.range[1])-l.r2c(l.range[0])));function Q(fe){return(i(fe)+x(fe))/2}_=o.maxHoverDistance-Z,b=o.maxSpikeDistance-Z;var X=w.getDistanceFunction(c,i,x,Q);if(w.getClosest(A,X,o),o.index===!1)return[];var $=A[o.index],re=S.line.color,H=(S.marker||{}).color;y.opacity(re)&&S.line.width?o.color=re:y.opacity(H)&&S.boxpoints?o.color=H:o.color=S.fillcolor,o[a+"0"]=l.c2p($.pos+E.bPos-k,!0),o[a+"1"]=l.c2p($.pos+E.bPos+T,!0),o[a+"LabelVal"]=$.orig_p!==void 0?$.orig_p:$.pos;var N=a+"Spike";o.spikeDistance=Q($)*b/_,o[N]=l.c2p($.pos,!0);var U=S.boxmean||(S.meanline||{}).visible,te=S.boxpoints||S.points,B=te&&U?["max","uf","q3","med","mean","q1","lf","min"]:te&&!U?["max","uf","q3","med","q1","lf","min"]:!te&&U?["max","q3","med","mean","q1","min"]:["max","q3","med","q1","min"],K=s.range[1]<s.range[0];S.orientation===(K?"v":"h")&&B.reverse();for(var J=o.spikeDistance,ee=o[N],ne=[],se=0;se<B.length;se++){var oe=B[se];if(oe in $){var me=$[oe],ce=s.c2p(me,!0),ye=v.extendFlat({},o);ye.attr=oe,ye[h+"0"]=ye[h+"1"]=ce,ye[h+"LabelVal"]=me,ye[h+"Label"]=(E.labels?E.labels[oe]+" ":"")+d.hoverLabelText(s,me,S[h+"hoverformat"]),ye.hoverOnBox=!0,oe==="mean"&&"sd"in $&&S.boxmean==="sd"&&(ye[h+"err"]=$.sd),ye.hovertemplate=!1,ne.push(ye)}}o.name="",o.spikeDistance=void 0,o[N]=void 0;for(var Se=0;Se<ne.length;Se++)ne[Se].attr!=="med"?(ne[Se].name="",ne[Se].spikeDistance=void 0,ne[Se][N]=void 0):(ne[Se].spikeDistance=J,ne[Se][N]=ee);return ne}function n(o,r,g){for(var c,a,h,l=o.cd,s=o.xa,p=o.ya,u=l[0].trace,i=s.c2p(r),x=p.c2p(g),f=w.quadrature(function(z){var D=Math.max(3,z.mrc||0);return Math.max(Math.abs(s.c2p(z.x)-i)-D,1-3/D)},function(z){var D=Math.max(3,z.mrc||0);return Math.max(Math.abs(p.c2p(z.y)-x)-D,1-3/D)}),_=!1,b=0;b<l.length;b++){a=l[b];for(var T=0;T<(a.pts||[]).length;T++){var k=f(h=a.pts[T]);k<=o.distance&&(o.distance=k,_=[b,T])}}if(!_)return!1;h=(a=l[_[0]]).pts[_[1]];var L=s.c2p(h.x,!0),A=p.c2p(h.y,!0),I=h.mrc||1;c=v.extendFlat({},o,{index:h.i,color:(u.marker||{}).color,name:u.name,x0:L-I,x1:L+I,y0:A-I,y1:A+I,spikeDistance:o.distance,hovertemplate:u.hovertemplate});var P,S=a.orig_p,E=S!==void 0?S:a.pos;return u.orientation==="h"?(P=p,c.xLabelVal=h.x,c.yLabelVal=E):(P=s,c.xLabelVal=E,c.yLabelVal=h.y),c[P._id.charAt(0)+"Spike"]=P.c2p(a.pos,!0),e(h,u,c),c}G.exports={hoverPoints:function(o,r,g,c){var a,h=o.cd[0].trace.hoveron,l=[];return h.indexOf("boxes")!==-1&&(l=l.concat(t(o,r,g,c))),h.indexOf("points")!==-1&&(a=n(o,r,g)),c==="closest"?a?[a]:l:(a&&l.push(a),l)},hoverOnBoxes:t,hoverOnPoints:n}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"../../plots/cartesian/axes":566}],688:[function(m,G,Y){G.exports={attributes:m("./attributes"),layoutAttributes:m("./layout_attributes"),supplyDefaults:m("./defaults").supplyDefaults,crossTraceDefaults:m("./defaults").crossTraceDefaults,supplyLayoutDefaults:m("./layout_defaults").supplyLayoutDefaults,calc:m("./calc"),crossTraceCalc:m("./cross_trace_calc").crossTraceCalc,plot:m("./plot").plot,style:m("./style").style,styleOnSelect:m("./style").styleOnSelect,hoverPoints:m("./hover").hoverPoints,eventData:m("./event_data"),selectPoints:m("./select"),moduleType:"trace",name:"box",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"./attributes":682,"./calc":683,"./cross_trace_calc":684,"./defaults":685,"./event_data":686,"./hover":687,"./layout_attributes":689,"./layout_defaults":690,"./plot":691,"./select":692,"./style":693}],689:[function(m,G,Y){G.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],690:[function(m,G,Y){var d=m("../../registry"),v=m("../../lib"),w=m("./layout_attributes");function y(e,t,n,o,r){for(var g=r+"Layout",c=!1,a=0;a<n.length;a++){var h=n[a];if(d.traceIs(h,g)){c=!0;break}}c&&(o(r+"mode"),o(r+"gap"),o(r+"groupgap"))}G.exports={supplyLayoutDefaults:function(e,t,n){y(0,0,n,function(o,r){return v.coerce(e,t,w,o,r)},"box")},_supply:y}},{"../../lib":515,"../../registry":647,"./layout_attributes":689}],691:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../components/drawing");function y(n,o,r,g){var c,a,h=r.orientation==="h",l=o.val,s=o.pos,p=!!s.rangebreaks,u=g.bPos,i=g.wdPos||0,x=g.bPosPxOffset||0,f=r.whiskerwidth||0,_=r.notched||!1,b=_?1-2*r.notchwidth:1;Array.isArray(g.bdPos)?(c=g.bdPos[0],a=g.bdPos[1]):(c=g.bdPos,a=g.bdPos);var T=n.selectAll("path.box").data(r.type!=="violin"||r.box.visible?v.identity:[]);T.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),T.exit().remove(),T.each(function(k){if(k.empty)return"M0,0Z";var L=s.c2l(k.pos+u,!0),A=s.l2p(L-c)+x,I=s.l2p(L+a)+x,P=p?(A+I)/2:s.l2p(L)+x,S=r.whiskerwidth,E=p?A*S+(1-S)*P:s.l2p(L-i)+x,z=p?I*S+(1-S)*P:s.l2p(L+i)+x,D=s.l2p(L-c*b)+x,j=s.l2p(L+a*b)+x,V=l.c2p(k.q1,!0),Z=l.c2p(k.q3,!0),Q=v.constrain(l.c2p(k.med,!0),Math.min(V,Z)+1,Math.max(V,Z)-1),X=k.lf===void 0||r.boxpoints===!1,$=l.c2p(X?k.min:k.lf,!0),re=l.c2p(X?k.max:k.uf,!0),H=l.c2p(k.ln,!0),N=l.c2p(k.un,!0);h?d.select(this).attr("d","M"+Q+","+D+"V"+j+"M"+V+","+A+"V"+I+(_?"H"+H+"L"+Q+","+j+"L"+N+","+I:"")+"H"+Z+"V"+A+(_?"H"+N+"L"+Q+","+D+"L"+H+","+A:"")+"ZM"+V+","+P+"H"+$+"M"+Z+","+P+"H"+re+(f===0?"":"M"+$+","+E+"V"+z+"M"+re+","+E+"V"+z)):d.select(this).attr("d","M"+D+","+Q+"H"+j+"M"+A+","+V+"H"+I+(_?"V"+H+"L"+j+","+Q+"L"+I+","+N:"")+"V"+Z+"H"+A+(_?"V"+N+"L"+D+","+Q+"L"+A+","+H:"")+"ZM"+P+","+V+"V"+$+"M"+P+","+Z+"V"+re+(f===0?"":"M"+E+","+$+"H"+z+"M"+E+","+re+"H"+z))})}function e(n,o,r,g){var c=o.x,a=o.y,h=g.bdPos,l=g.bPos,s=r.boxpoints||r.points;v.seedPseudoRandom();var p=n.selectAll("g.points").data(s?function(i){return i.forEach(function(x){x.t=g,x.trace=r}),i}:[]);p.enter().append("g").attr("class","points"),p.exit().remove();var u=p.selectAll("path").data(function(i){var x,f,_=i.pts2,b=Math.max((i.max-i.min)/10,i.q3-i.q1),T=1e-9*b,k=.01*b,L=[],A=0;if(r.jitter){if(b===0)for(A=1,L=new Array(_.length),x=0;x<_.length;x++)L[x]=1;else for(x=0;x<_.length;x++){var I=Math.max(0,x-5),P=_[I].v,S=Math.min(_.length-1,x+5),E=_[S].v;s!=="all"&&(_[x].v<i.lf?E=Math.min(E,i.lf):P=Math.max(P,i.uf));var z=Math.sqrt(k*(S-I)/(E-P+T))||0;z=v.constrain(Math.abs(z),0,1),L.push(z),A=Math.max(z,A)}f=2*r.jitter/(A||1)}for(x=0;x<_.length;x++){var D=_[x],j=D.v,V=r.jitter?f*L[x]*(v.pseudoRandom()-.5):0,Z=i.pos+l+h*(r.pointpos+V);r.orientation==="h"?(D.y=Z,D.x=j):(D.x=Z,D.y=j),s==="suspectedoutliers"&&j<i.uo&&j>i.lo&&(D.so=!0)}return _});u.enter().append("path").classed("point",!0),u.exit().remove(),u.call(w.translatePoints,c,a)}function t(n,o,r,g){var c,a,h=o.val,l=o.pos,s=!!l.rangebreaks,p=g.bPos,u=g.bPosPxOffset||0,i=r.boxmean||(r.meanline||{}).visible;Array.isArray(g.bdPos)?(c=g.bdPos[0],a=g.bdPos[1]):(c=g.bdPos,a=g.bdPos);var x=n.selectAll("path.mean").data(r.type==="box"&&r.boxmean||r.type==="violin"&&r.box.visible&&r.meanline.visible?v.identity:[]);x.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),x.exit().remove(),x.each(function(f){var _=l.c2l(f.pos+p,!0),b=l.l2p(_-c)+u,T=l.l2p(_+a)+u,k=s?(b+T)/2:l.l2p(_)+u,L=h.c2p(f.mean,!0),A=h.c2p(f.mean-f.sd,!0),I=h.c2p(f.mean+f.sd,!0);r.orientation==="h"?d.select(this).attr("d","M"+L+","+b+"V"+T+(i==="sd"?"m0,0L"+A+","+k+"L"+L+","+b+"L"+I+","+k+"Z":"")):d.select(this).attr("d","M"+b+","+L+"H"+T+(i==="sd"?"m0,0L"+k+","+A+"L"+b+","+L+"L"+k+","+I+"Z":""))})}G.exports={plot:function(n,o,r,g){var c=o.xaxis,a=o.yaxis;v.makeTraceGroups(g,r,"trace boxes").each(function(h){var l,s,p=d.select(this),u=h[0],i=u.t,x=u.trace;i.wdPos=i.bdPos*x.whiskerwidth,x.visible!==!0||i.empty?p.remove():(x.orientation==="h"?(l=a,s=c):(l=c,s=a),y(p,{pos:l,val:s},x,i),e(p,{x:c,y:a},x,i),t(p,{pos:l,val:s},x,i))})},plotBoxAndWhiskers:y,plotPoints:e,plotBoxMean:t}},{"../../components/drawing":389,"../../lib":515,"@plotly/d3":58}],692:[function(m,G,Y){G.exports=function(d,v){var w,y,e=d.cd,t=d.xaxis,n=d.yaxis,o=[];if(v===!1)for(w=0;w<e.length;w++)for(y=0;y<(e[w].pts||[]).length;y++)e[w].pts[y].selected=0;else for(w=0;w<e.length;w++)for(y=0;y<(e[w].pts||[]).length;y++){var r=e[w].pts[y],g=t.c2p(r.x),c=n.c2p(r.y);v.contains([g,c],null,r.i,d)?(o.push({pointNumber:r.i,x:t.c2d(r.x),y:n.c2d(r.y)}),r.selected=1):r.selected=0}return o}},{}],693:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../components/color"),w=m("../../components/drawing");G.exports={style:function(y,e,t){var n=t||d.select(y).selectAll("g.trace.boxes");n.style("opacity",function(o){return o[0].trace.opacity}),n.each(function(o){var r=d.select(this),g=o[0].trace,c=g.line.width;function a(s,p,u,i){s.style("stroke-width",p+"px").call(v.stroke,u).call(v.fill,i)}var h=r.selectAll("path.box");if(g.type==="candlestick")h.each(function(s){if(!s.empty){var p=d.select(this),u=g[s.dir];a(p,u.line.width,u.line.color,u.fillcolor),p.style("opacity",g.selectedpoints&&!s.selected?.3:1)}});else{a(h,c,g.line.color,g.fillcolor),r.selectAll("path.mean").style({"stroke-width":c,"stroke-dasharray":2*c+"px,"+c+"px"}).call(v.stroke,g.line.color);var l=r.selectAll("path.point");w.pointStyle(l,g,y)}})},styleOnSelect:function(y,e,t){var n=e[0].trace,o=t.selectAll("path.point");n.selectedpoints?w.selectedPointStyle(o,n):w.pointStyle(o,n,y)}}},{"../../components/color":367,"../../components/drawing":389,"@plotly/d3":58}],694:[function(m,G,Y){var d=m("../../lib").extendFlat,v=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,w=m("../ohlc/attributes"),y=m("../box/attributes");function e(t){return{line:{color:d({},y.line.color,{dflt:t}),width:y.line.width,editType:"style"},fillcolor:y.fillcolor,editType:"style"}}G.exports={xperiod:w.xperiod,xperiod0:w.xperiod0,xperiodalignment:w.xperiodalignment,xhoverformat:v("x"),yhoverformat:v("y"),x:w.x,open:w.open,high:w.high,low:w.low,close:w.close,line:{width:d({},y.line.width,{}),editType:"style"},increasing:e(w.increasing.line.color.dflt),decreasing:e(w.decreasing.line.color.dflt),text:w.text,hovertext:w.hovertext,whiskerwidth:d({},y.whiskerwidth,{dflt:0}),hoverlabel:w.hoverlabel}},{"../../lib":515,"../../plots/cartesian/axis_format_attributes":569,"../box/attributes":682,"../ohlc/attributes":881}],695:[function(m,G,Y){var d=m("../../lib"),v=m("../../plots/cartesian/axes"),w=m("../../plots/cartesian/align_period"),y=m("../ohlc/calc").calcCommon;function e(t,n,o,r){return{min:o,q1:Math.min(t,r),med:r,q3:Math.max(t,r),max:n}}G.exports=function(t,n){var o=t._fullLayout,r=v.getFromId(t,n.xaxis),g=v.getFromId(t,n.yaxis),c=r.makeCalcdata(n,"x"),a=w(n,r,"x",c).vals,h=y(t,n,c,a,g,e);return h.length?(d.extendFlat(h[0].t,{num:o._numBoxes,dPos:d.distinctVals(a).minDiff/2,posLetter:"x",valLetter:"y"}),o._numBoxes++,h):[{t:{empty:!0}}]}},{"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../ohlc/calc":882}],696:[function(m,G,Y){var d=m("../../lib"),v=m("../../components/color"),w=m("../ohlc/ohlc_defaults"),y=m("../scatter/period_defaults"),e=m("./attributes");function t(n,o,r,g){var c=r(g+".line.color");r(g+".line.width",o.line.width),r(g+".fillcolor",v.addOpacity(c,.5))}G.exports=function(n,o,r,g){function c(a,h){return d.coerce(n,o,e,a,h)}w(n,o,c,g)?(y(n,o,g,c,{x:!0}),c("xhoverformat"),c("yhoverformat"),c("line.width"),t(n,o,c,"increasing"),t(n,o,c,"decreasing"),c("text"),c("hovertext"),c("whiskerwidth"),g._requestRangeslider[o.xaxis]=!0):o.visible=!1}},{"../../components/color":367,"../../lib":515,"../ohlc/ohlc_defaults":886,"../scatter/period_defaults":956,"./attributes":694}],697:[function(m,G,Y){G.exports={moduleType:"trace",name:"candlestick",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:m("./attributes"),layoutAttributes:m("../box/layout_attributes"),supplyLayoutDefaults:m("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:m("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:m("./defaults"),calc:m("./calc"),plot:m("../box/plot").plot,layerName:"boxlayer",style:m("../box/style").style,hoverPoints:m("../ohlc/hover").hoverPoints,selectPoints:m("../ohlc/select")}},{"../../plots/cartesian":578,"../box/cross_trace_calc":684,"../box/layout_attributes":689,"../box/layout_defaults":690,"../box/plot":691,"../box/style":693,"../ohlc/hover":884,"../ohlc/select":888,"./attributes":694,"./calc":695,"./defaults":696}],698:[function(m,G,Y){var d=m("./axis_defaults"),v=m("../../plot_api/plot_template");G.exports=function(w,y,e,t,n){t("a")||(t("da"),t("a0")),t("b")||(t("db"),t("b0")),function(o,r,g,c){["aaxis","baxis"].forEach(function(a){var h=a.charAt(0),l=o[a]||{},s=v.newContainer(r,a),p={noTicklabelstep:!0,tickfont:"x",id:h+"axis",letter:h,font:r.font,name:a,data:o[h],calendar:r.calendar,dfltColor:c,bgColor:g.paper_bgcolor,autotypenumbersDflt:g.autotypenumbers,fullLayout:g};d(l,s,p),s._categories=s._categories||[],o[a]||l.type==="-"||(o[a]={type:l.type})})}(w,y,e,n)}},{"../../plot_api/plot_template":555,"./axis_defaults":703}],699:[function(m,G,Y){var d=m("../../lib").isArrayOrTypedArray;G.exports=function(v){return function w(y,e){if(!d(y)||e>=10)return null;for(var t=1/0,n=-1/0,o=y.length,r=0;r<o;r++){var g=y[r];if(d(g)){var c=w(g,e+1);c&&(t=Math.min(c[0],t),n=Math.max(c[1],n))}else t=Math.min(g,t),n=Math.max(g,n)}return[t,n]}(v,0)}},{"../../lib":515}],700:[function(m,G,Y){var d=m("../../plots/font_attributes"),v=m("./axis_attributes"),w=m("../../components/color/attributes"),y=d({editType:"calc"});y.family.dflt='"Open Sans", verdana, arial, sans-serif',y.size.dflt=12,y.color.dflt=w.defaultLine,G.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:v,baxis:v,font:y,color:{valType:"color",dflt:w.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":366,"../../plots/font_attributes":594,"./axis_attributes":702}],701:[function(m,G,Y){var d=m("../../lib").isArrayOrTypedArray;G.exports=function(v,w,y,e){var t,n,o,r,g,c,a,h,l,s,p,u,i,x=d(y)?"a":"b",f=(x==="a"?v.aaxis:v.baxis).smoothing,_=x==="a"?v.a2i:v.b2j,b=x==="a"?y:e,T=x==="a"?e:y,k=x==="a"?w.a.length:w.b.length,L=x==="a"?w.b.length:w.a.length,A=Math.floor(x==="a"?v.b2j(T):v.a2i(T)),I=x==="a"?function(re){return v.evalxy([],re,A)}:function(re){return v.evalxy([],A,re)};f&&(o=Math.max(0,Math.min(L-2,A)),r=A-o,n=x==="a"?function(re,H){return v.dxydi([],re,o,H,r)}:function(re,H){return v.dxydj([],o,re,r,H)});var P=_(b[0]),S=_(b[1]),E=P<S?1:-1,z=1e-8*(S-P),D=E>0?Math.floor:Math.ceil,j=E>0?Math.ceil:Math.floor,V=E>0?Math.min:Math.max,Z=E>0?Math.max:Math.min,Q=D(P+z),X=j(S-z),$=[[a=I(P)]];for(t=Q;t*E<X*E;t+=E)g=[],p=Z(P,t),i=(u=V(S,t+E))-p,c=Math.max(0,Math.min(k-2,Math.floor(.5*(p+u)))),h=I(u),f&&(l=n(c,p-c),s=n(c,u-c),g.push([a[0]+l[0]/3*i,a[1]+l[1]/3*i]),g.push([h[0]-s[0]/3*i,h[1]-s[1]/3*i])),g.push(h),$.push(g),a=h;return $}},{"../../lib":515}],702:[function(m,G,Y){var d=m("../../plots/font_attributes"),v=m("../../components/color/attributes"),w=m("../../plots/cartesian/layout_attributes"),y=m("../../plots/cartesian/axis_format_attributes").descriptionWithDates,e=m("../../plot_api/edit_types").overrideAll,t=m("../../components/drawing/attributes").dash,n=m("../../lib/extend").extendFlat;G.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:d({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autotypenumbers:w.autotypenumbers,autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:d({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},minexponent:{valType:"number",dflt:3,min:0,editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc",description:y("tick label")},tickformatstops:e(w.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:v.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},griddash:n({},t,{editType:"calc"}),showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgriddash:n({},t,{editType:"calc"}),minorgridcolor:{valType:"color",dflt:v.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:d({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":366,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/layout_attributes":579,"../../plots/font_attributes":594}],703:[function(m,G,Y){var d=m("./attributes"),v=m("../../components/color").addOpacity,w=m("../../registry"),y=m("../../lib"),e=m("../../plots/cartesian/tick_value_defaults"),t=m("../../plots/cartesian/tick_label_defaults"),n=m("../../plots/cartesian/prefix_suffix_defaults"),o=m("../../plots/cartesian/category_order_defaults"),r=m("../../plots/cartesian/set_convert"),g=m("../../plots/cartesian/axis_autotype");G.exports=function(c,a,h){var l=h.letter,s=h.font||{},p=d[l+"axis"];function u(E,z){return y.coerce(c,a,p,E,z)}function i(E,z){return y.coerce2(c,a,p,E,z)}h.name&&(a._name=h.name,a._id=h.name),u("autotypenumbers",h.autotypenumbersDflt);var x=u("type");x==="-"&&(h.data&&function(E,z){if(E.type==="-"){var D=E._id.charAt(0),j=E[D+"calendar"];E.type=g(z,j,{autotypenumbers:E.autotypenumbers})}}(a,h.data),a.type==="-"?a.type="linear":x=c.type=a.type),u("smoothing"),u("cheatertype"),u("showticklabels"),u("labelprefix",l+" = "),u("labelsuffix"),u("showtickprefix"),u("showticksuffix"),u("separatethousands"),u("tickformat"),u("exponentformat"),u("minexponent"),u("showexponent"),u("categoryorder"),u("tickmode"),u("tickvals"),u("ticktext"),u("tick0"),u("dtick"),a.tickmode==="array"&&(u("arraytick0"),u("arraydtick")),u("labelpadding"),a._hovertitle=l,x==="date"&&w.getComponentMethod("calendars","handleDefaults")(c,a,"calendar",h.calendar),r(a,h.fullLayout),a.c2p=y.identity;var f=u("color",h.dfltColor),_=f===c.color?f:s.color;u("title.text")&&(y.coerceFont(u,"title.font",{family:s.family,size:y.bigFont(s.size),color:_}),u("title.offset")),u("tickangle"),u("autorange",!a.isValidRange(c.range))&&u("rangemode"),u("range"),a.cleanRange(),u("fixedrange"),e(c,a,u,x),n(c,a,u,x,h),t(c,a,u,x,h),o(c,a,u,{data:h.data,dataAttr:l});var b=i("gridcolor",v(f,.3)),T=i("gridwidth"),k=i("griddash"),L=u("showgrid");L||(delete a.gridcolor,delete a.gridwidth,delete a.griddash);var A=i("startlinecolor",f),I=i("startlinewidth",T);u("startline",a.showgrid||!!A||!!I)||(delete a.startlinecolor,delete a.startlinewidth);var P=i("endlinecolor",f),S=i("endlinewidth",T);return u("endline",a.showgrid||!!P||!!S)||(delete a.endlinecolor,delete a.endlinewidth),L?(u("minorgridcount"),u("minorgridwidth",T),u("minorgriddash",k),u("minorgridcolor",v(b,.06)),a.minorgridcount||(delete a.minorgridwidth,delete a.minorgriddash,delete a.minorgridcolor)):(delete a.gridcolor,delete a.gridwidth,delete a.griddash),a.showticklabels==="none"&&(delete a.tickfont,delete a.tickangle,delete a.showexponent,delete a.exponentformat,delete a.minexponent,delete a.tickformat,delete a.showticksuffix,delete a.showtickprefix),a.showticksuffix||delete a.ticksuffix,a.showtickprefix||delete a.tickprefix,u("tickmode"),a}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axis_autotype":567,"../../plots/cartesian/category_order_defaults":571,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/set_convert":585,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_value_defaults":589,"../../registry":647,"./attributes":700}],704:[function(m,G,Y){var d=m("../../plots/cartesian/axes"),v=m("../../lib").isArray1D,w=m("./cheater_basis"),y=m("./array_minmax"),e=m("./calc_gridlines"),t=m("./calc_labels"),n=m("./calc_clippath"),o=m("../heatmap/clean_2d_array"),r=m("./smooth_fill_2d_array"),g=m("../heatmap/convert_column_xyz"),c=m("./set_convert");G.exports=function(a,h){var l=d.getFromId(a,h.xaxis),s=d.getFromId(a,h.yaxis),p=h.aaxis,u=h.baxis,i=h.x,x=h.y,f=[];i&&v(i)&&f.push("x"),x&&v(x)&&f.push("y"),f.length&&g(h,p,u,"a","b",f);var _=h._a=h._a||h.a,b=h._b=h._b||h.b;i=h._x||h.x,x=h._y||h.y;var T={};if(h._cheater){var k=p.cheatertype==="index"?_.length:_,L=u.cheatertype==="index"?b.length:b;i=w(k,L,h.cheaterslope)}h._x=i=o(i),h._y=x=o(x),r(i,_,b),r(x,_,b),c(h),h.setScale();var A=y(i),I=y(x),P=.5*(A[1]-A[0]),S=.5*(A[1]+A[0]),E=.5*(I[1]-I[0]),z=.5*(I[1]+I[0]);return A=[S-1.3*P,S+1.3*P],I=[z-1.3*E,z+1.3*E],h._extremes[l._id]=d.findExtremes(l,A,{padded:!0}),h._extremes[s._id]=d.findExtremes(s,I,{padded:!0}),e(h,"a","b"),e(h,"b","a"),t(h,p),t(h,u),T.clipsegments=n(h._xctrl,h._yctrl,p,u),T.x=i,T.y=x,T.a=_,T.b=b,[T]}},{"../../lib":515,"../../plots/cartesian/axes":566,"../heatmap/clean_2d_array":803,"../heatmap/convert_column_xyz":805,"./array_minmax":699,"./calc_clippath":705,"./calc_gridlines":706,"./calc_labels":707,"./cheater_basis":709,"./set_convert":722,"./smooth_fill_2d_array":723}],705:[function(m,G,Y){G.exports=function(d,v,w,y){var e,t,n,o=[],r=!!w.smoothing,g=!!y.smoothing,c=d[0].length-1,a=d.length-1;for(e=0,t=[],n=[];e<=c;e++)t[e]=d[0][e],n[e]=v[0][e];for(o.push({x:t,y:n,bicubic:r}),e=0,t=[],n=[];e<=a;e++)t[e]=d[e][c],n[e]=v[e][c];for(o.push({x:t,y:n,bicubic:g}),e=c,t=[],n=[];e>=0;e--)t[c-e]=d[a][e],n[c-e]=v[a][e];for(o.push({x:t,y:n,bicubic:r}),e=a,t=[],n=[];e>=0;e--)t[a-e]=d[e][0],n[a-e]=v[e][0];return o.push({x:t,y:n,bicubic:g}),o}},{}],706:[function(m,G,Y){var d=m("../../plots/cartesian/axes"),v=m("../../lib/extend").extendFlat;G.exports=function(w,y,e){var t,n,o,r,g,c,a,h,l,s,p,u,i,x,f=w["_"+y],_=w[y+"axis"],b=_._gridlines=[],T=_._minorgridlines=[],k=_._boundarylines=[],L=w["_"+e],A=w[e+"axis"];_.tickmode==="array"&&(_.tickvals=f.slice());var I=w._xctrl,P=w._yctrl,S=I[0].length,E=I.length,z=w._a.length,D=w._b.length;d.prepTicks(_),_.tickmode==="array"&&delete _.tickvals;var j=_.smoothing?3:1;function V(Q){var X,$,re,H,N,U,te,B,K,J,ee,ne,se=[],oe=[],me={};if(y==="b")for($=w.b2j(Q),re=Math.floor(Math.max(0,Math.min(D-2,$))),H=$-re,me.length=D,me.crossLength=z,me.xy=function(ce){return w.evalxy([],ce,$)},me.dxy=function(ce,ye){return w.dxydi([],ce,re,ye,H)},X=0;X<z;X++)U=Math.min(z-2,X),te=X-U,B=w.evalxy([],X,$),A.smoothing&&X>0&&(K=w.dxydi([],X-1,re,0,H),se.push(N[0]+K[0]/3),oe.push(N[1]+K[1]/3),J=w.dxydi([],X-1,re,1,H),se.push(B[0]-J[0]/3),oe.push(B[1]-J[1]/3)),se.push(B[0]),oe.push(B[1]),N=B;else for(X=w.a2i(Q),U=Math.floor(Math.max(0,Math.min(z-2,X))),te=X-U,me.length=z,me.crossLength=D,me.xy=function(ce){return w.evalxy([],X,ce)},me.dxy=function(ce,ye){return w.dxydj([],U,ce,te,ye)},$=0;$<D;$++)re=Math.min(D-2,$),H=$-re,B=w.evalxy([],X,$),A.smoothing&&$>0&&(ee=w.dxydj([],U,$-1,te,0),se.push(N[0]+ee[0]/3),oe.push(N[1]+ee[1]/3),ne=w.dxydj([],U,$-1,te,1),se.push(B[0]-ne[0]/3),oe.push(B[1]-ne[1]/3)),se.push(B[0]),oe.push(B[1]),N=B;return me.axisLetter=y,me.axis=_,me.crossAxis=A,me.value=Q,me.constvar=e,me.index=h,me.x=se,me.y=oe,me.smoothing=A.smoothing,me}function Z(Q){var X,$,re,H,N,U=[],te=[],B={};if(B.length=f.length,B.crossLength=L.length,y==="b")for(re=Math.max(0,Math.min(D-2,Q)),N=Math.min(1,Math.max(0,Q-re)),B.xy=function(K){return w.evalxy([],K,Q)},B.dxy=function(K,J){return w.dxydi([],K,re,J,N)},X=0;X<S;X++)U[X]=I[Q*j][X],te[X]=P[Q*j][X];else for($=Math.max(0,Math.min(z-2,Q)),H=Math.min(1,Math.max(0,Q-$)),B.xy=function(K){return w.evalxy([],Q,K)},B.dxy=function(K,J){return w.dxydj([],$,K,H,J)},X=0;X<E;X++)U[X]=I[X][Q*j],te[X]=P[X][Q*j];return B.axisLetter=y,B.axis=_,B.crossAxis=A,B.value=f[Q],B.constvar=e,B.index=Q,B.x=U,B.y=te,B.smoothing=A.smoothing,B}if(_.tickmode==="array"){for(r=5e-15,c=(g=[Math.floor((f.length-1-_.arraytick0)/_.arraydtick*(1+r)),Math.ceil(-_.arraytick0/_.arraydtick/(1+r))].sort(function(Q,X){return Q-X}))[0]-1,a=g[1]+1,h=c;h<a;h++)(n=_.arraytick0+_.arraydtick*h)<0||n>f.length-1||b.push(v(Z(n),{color:_.gridcolor,width:_.gridwidth,dash:_.griddash}));for(h=c;h<a;h++)if(o=_.arraytick0+_.arraydtick*h,p=Math.min(o+_.arraydtick,f.length-1),!(o<0||o>f.length-1||p<0||p>f.length-1))for(u=f[o],i=f[p],t=0;t<_.minorgridcount;t++)(x=p-o)<=0||(s=u+(i-u)*(t+1)/(_.minorgridcount+1)*(_.arraydtick/x))<f[0]||s>f[f.length-1]||T.push(v(V(s),{color:_.minorgridcolor,width:_.minorgridwidth,dash:_.minorgriddash}));_.startline&&k.push(v(Z(0),{color:_.startlinecolor,width:_.startlinewidth})),_.endline&&k.push(v(Z(f.length-1),{color:_.endlinecolor,width:_.endlinewidth}))}else{for(r=5e-15,c=(g=[Math.floor((f[f.length-1]-_.tick0)/_.dtick*(1+r)),Math.ceil((f[0]-_.tick0)/_.dtick/(1+r))].sort(function(Q,X){return Q-X}))[0],a=g[1],h=c;h<=a;h++)l=_.tick0+_.dtick*h,b.push(v(V(l),{color:_.gridcolor,width:_.gridwidth,dash:_.griddash}));for(h=c-1;h<a+1;h++)for(l=_.tick0+_.dtick*h,t=0;t<_.minorgridcount;t++)(s=l+_.dtick*(t+1)/(_.minorgridcount+1))<f[0]||s>f[f.length-1]||T.push(v(V(s),{color:_.minorgridcolor,width:_.minorgridwidth,dash:_.minorgriddash}));_.startline&&k.push(v(V(f[0]),{color:_.startlinecolor,width:_.startlinewidth})),_.endline&&k.push(v(V(f[f.length-1]),{color:_.endlinecolor,width:_.endlinewidth}))}}},{"../../lib/extend":505,"../../plots/cartesian/axes":566}],707:[function(m,G,Y){var d=m("../../plots/cartesian/axes"),v=m("../../lib/extend").extendFlat;G.exports=function(w,y){var e,t,n,o=y._labels=[],r=y._gridlines;for(e=0;e<r.length;e++)n=r[e],["start","both"].indexOf(y.showticklabels)!==-1&&(t=d.tickText(y,n.value),v(t,{prefix:void 0,suffix:void 0,endAnchor:!0,xy:n.xy(0),dxy:n.dxy(0,0),axis:n.axis,length:n.crossAxis.length,font:n.axis.tickfont,isFirst:e===0,isLast:e===r.length-1}),o.push(t)),["end","both"].indexOf(y.showticklabels)!==-1&&(t=d.tickText(y,n.value),v(t,{endAnchor:!1,xy:n.xy(n.crossLength-1),dxy:n.dxy(n.crossLength-2,1),axis:n.axis,length:n.crossAxis.length,font:n.axis.tickfont,isFirst:e===0,isLast:e===r.length-1}),o.push(t))}},{"../../lib/extend":505,"../../plots/cartesian/axes":566}],708:[function(m,G,Y){G.exports=function(d,v,w,y){var e=d[0]-v[0],t=d[1]-v[1],n=w[0]-v[0],o=w[1]-v[1],r=Math.pow(e*e+t*t,.25),g=Math.pow(n*n+o*o,.25),c=(g*g*e-r*r*n)*y,a=(g*g*t-r*r*o)*y,h=g*(r+g)*3,l=r*(r+g)*3;return[[v[0]+(h&&c/h),v[1]+(h&&a/h)],[v[0]-(l&&c/l),v[1]-(l&&a/l)]]}},{}],709:[function(m,G,Y){var d=m("../../lib").isArrayOrTypedArray;G.exports=function(v,w,y){var e,t,n,o,r,g,c=[],a=d(v)?v.length:v,h=d(w)?w.length:w,l=d(v)?v:null,s=d(w)?w:null;l&&(n=(l.length-1)/(l[l.length-1]-l[0])/(a-1)),s&&(o=(s.length-1)/(s[s.length-1]-s[0])/(h-1));var p=1/0,u=-1/0;for(t=0;t<h;t++)for(c[t]=[],r=s?(s[t]-s[0])*o:t/(h-1),e=0;e<a;e++)g=(l?(l[e]-l[0])*n:e/(a-1))-r*y,p=Math.min(g,p),u=Math.max(g,u),c[t][e]=g;var i=1/(u-p),x=-p*i;for(t=0;t<h;t++)for(e=0;e<a;e++)c[t][e]=i*c[t][e]+x;return c}},{"../../lib":515}],710:[function(m,G,Y){var d=m("./catmull_rom"),v=m("../../lib").ensureArray;function w(y,e,t){var n=-.5*t[0]+1.5*e[0],o=-.5*t[1]+1.5*e[1];return[(2*n+y[0])/3,(2*o+y[1])/3]}G.exports=function(y,e,t,n,o,r){var g,c,a,h,l,s,p,u,i,x,f=t[0].length,_=t.length,b=o?3*f-2:f,T=r?3*_-2:_;for(y=v(y,T),e=v(e,T),a=0;a<T;a++)y[a]=v(y[a],b),e[a]=v(e[a],b);for(c=0,h=0;c<_;c++,h+=r?3:1)for(l=y[h],s=e[h],p=t[c],u=n[c],g=0,a=0;g<f;g++,a+=o?3:1)l[a]=p[g],s[a]=u[g];if(o)for(c=0,h=0;c<_;c++,h+=r?3:1){for(g=1,a=3;g<f-1;g++,a+=3)i=d([t[c][g-1],n[c][g-1]],[t[c][g],n[c][g]],[t[c][g+1],n[c][g+1]],o),y[h][a-1]=i[0][0],e[h][a-1]=i[0][1],y[h][a+1]=i[1][0],e[h][a+1]=i[1][1];x=w([y[h][0],e[h][0]],[y[h][2],e[h][2]],[y[h][3],e[h][3]]),y[h][1]=x[0],e[h][1]=x[1],x=w([y[h][b-1],e[h][b-1]],[y[h][b-3],e[h][b-3]],[y[h][b-4],e[h][b-4]]),y[h][b-2]=x[0],e[h][b-2]=x[1]}if(r)for(a=0;a<b;a++){for(h=3;h<T-3;h+=3)i=d([y[h-3][a],e[h-3][a]],[y[h][a],e[h][a]],[y[h+3][a],e[h+3][a]],r),y[h-1][a]=i[0][0],e[h-1][a]=i[0][1],y[h+1][a]=i[1][0],e[h+1][a]=i[1][1];x=w([y[0][a],e[0][a]],[y[2][a],e[2][a]],[y[3][a],e[3][a]]),y[1][a]=x[0],e[1][a]=x[1],x=w([y[T-1][a],e[T-1][a]],[y[T-3][a],e[T-3][a]],[y[T-4][a],e[T-4][a]]),y[T-2][a]=x[0],e[T-2][a]=x[1]}if(o&&r)for(h=1;h<T;h+=(h+1)%3==0?2:1){for(a=3;a<b-3;a+=3)i=d([y[h][a-3],e[h][a-3]],[y[h][a],e[h][a]],[y[h][a+3],e[h][a+3]],o),y[h][a-1]=.5*(y[h][a-1]+i[0][0]),e[h][a-1]=.5*(e[h][a-1]+i[0][1]),y[h][a+1]=.5*(y[h][a+1]+i[1][0]),e[h][a+1]=.5*(e[h][a+1]+i[1][1]);x=w([y[h][0],e[h][0]],[y[h][2],e[h][2]],[y[h][3],e[h][3]]),y[h][1]=.5*(y[h][1]+x[0]),e[h][1]=.5*(e[h][1]+x[1]),x=w([y[h][b-1],e[h][b-1]],[y[h][b-3],e[h][b-3]],[y[h][b-4],e[h][b-4]]),y[h][b-2]=.5*(y[h][b-2]+x[0]),e[h][b-2]=.5*(e[h][b-2]+x[1])}return[y,e]}},{"../../lib":515,"./catmull_rom":708}],711:[function(m,G,Y){G.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],712:[function(m,G,Y){G.exports=function(d,v,w){return v&&w?function(y,e,t,n,o){var r,g,c,a,h,l;y||(y=[]),e*=3,t*=3;var s=n*n,p=1-n,u=p*p,i=p*n*2,x=-3*u,f=3*(u-i),_=3*(i-s),b=3*s,T=o*o,k=T*o,L=1-o,A=L*L,I=A*L;for(l=0;l<d.length;l++)r=x*(h=d[l])[t][e]+f*h[t][e+1]+_*h[t][e+2]+b*h[t][e+3],g=x*h[t+1][e]+f*h[t+1][e+1]+_*h[t+1][e+2]+b*h[t+1][e+3],c=x*h[t+2][e]+f*h[t+2][e+1]+_*h[t+2][e+2]+b*h[t+2][e+3],a=x*h[t+3][e]+f*h[t+3][e+1]+_*h[t+3][e+2]+b*h[t+3][e+3],y[l]=I*r+3*(A*o*g+L*T*c)+k*a;return y}:v?function(y,e,t,n,o){var r,g,c,a;y||(y=[]),e*=3;var h=n*n,l=1-n,s=l*l,p=l*n*2,u=-3*s,i=3*(s-p),x=3*(p-h),f=3*h,_=1-o;for(c=0;c<d.length;c++)r=u*(a=d[c])[t][e]+i*a[t][e+1]+x*a[t][e+2]+f*a[t][e+3],g=u*a[t+1][e]+i*a[t+1][e+1]+x*a[t+1][e+2]+f*a[t+1][e+3],y[c]=_*r+o*g;return y}:w?function(y,e,t,n,o){var r,g,c,a,h,l;y||(y=[]),t*=3;var s=o*o,p=s*o,u=1-o,i=u*u,x=i*u;for(h=0;h<d.length;h++)r=(l=d[h])[t][e+1]-l[t][e],g=l[t+1][e+1]-l[t+1][e],c=l[t+2][e+1]-l[t+2][e],a=l[t+3][e+1]-l[t+3][e],y[h]=x*r+3*(i*o*g+u*s*c)+p*a;return y}:function(y,e,t,n,o){var r,g,c,a;y||(y=[]);var h=1-o;for(c=0;c<d.length;c++)r=(a=d[c])[t][e+1]-a[t][e],g=a[t+1][e+1]-a[t+1][e],y[c]=h*r+o*g;return y}}},{}],713:[function(m,G,Y){G.exports=function(d,v,w){return v&&w?function(y,e,t,n,o){var r,g,c,a,h,l;y||(y=[]),e*=3,t*=3;var s=n*n,p=s*n,u=1-n,i=u*u,x=i*u,f=o*o,_=1-o,b=_*_,T=_*o*2,k=-3*b,L=3*(b-T),A=3*(T-f),I=3*f;for(l=0;l<d.length;l++)r=k*(h=d[l])[t][e]+L*h[t+1][e]+A*h[t+2][e]+I*h[t+3][e],g=k*h[t][e+1]+L*h[t+1][e+1]+A*h[t+2][e+1]+I*h[t+3][e+1],c=k*h[t][e+2]+L*h[t+1][e+2]+A*h[t+2][e+2]+I*h[t+3][e+2],a=k*h[t][e+3]+L*h[t+1][e+3]+A*h[t+2][e+3]+I*h[t+3][e+3],y[l]=x*r+3*(i*n*g+u*s*c)+p*a;return y}:v?function(y,e,t,n,o){var r,g,c,a,h,l;y||(y=[]),e*=3;var s=o*o,p=s*o,u=1-o,i=u*u,x=i*u;for(h=0;h<d.length;h++)r=(l=d[h])[t+1][e]-l[t][e],g=l[t+1][e+1]-l[t][e+1],c=l[t+1][e+2]-l[t][e+2],a=l[t+1][e+3]-l[t][e+3],y[h]=x*r+3*(i*o*g+u*s*c)+p*a;return y}:w?function(y,e,t,n,o){var r,g,c,a;y||(y=[]),t*=3;var h=1-n,l=o*o,s=1-o,p=s*s,u=s*o*2,i=-3*p,x=3*(p-u),f=3*(u-l),_=3*l;for(c=0;c<d.length;c++)r=i*(a=d[c])[t][e]+x*a[t+1][e]+f*a[t+2][e]+_*a[t+3][e],g=i*a[t][e+1]+x*a[t+1][e+1]+f*a[t+2][e+1]+_*a[t+3][e+1],y[c]=h*r+n*g;return y}:function(y,e,t,n,o){var r,g,c,a;y||(y=[]);var h=1-n;for(c=0;c<d.length;c++)r=(a=d[c])[t+1][e]-a[t][e],g=a[t+1][e+1]-a[t][e+1],y[c]=h*r+n*g;return y}}},{}],714:[function(m,G,Y){G.exports=function(d,v,w,y,e){var t=v-2,n=w-2;return y&&e?function(o,r,g){var c,a,h,l,s,p;o||(o=[]);var u=Math.max(0,Math.min(Math.floor(r),t)),i=Math.max(0,Math.min(Math.floor(g),n)),x=Math.max(0,Math.min(1,r-u)),f=Math.max(0,Math.min(1,g-i));u*=3,i*=3;var _=x*x,b=_*x,T=1-x,k=T*T,L=k*T,A=f*f,I=A*f,P=1-f,S=P*P,E=S*P;for(p=0;p<d.length;p++)c=L*(s=d[p])[i][u]+3*(k*x*s[i][u+1]+T*_*s[i][u+2])+b*s[i][u+3],a=L*s[i+1][u]+3*(k*x*s[i+1][u+1]+T*_*s[i+1][u+2])+b*s[i+1][u+3],h=L*s[i+2][u]+3*(k*x*s[i+2][u+1]+T*_*s[i+2][u+2])+b*s[i+2][u+3],l=L*s[i+3][u]+3*(k*x*s[i+3][u+1]+T*_*s[i+3][u+2])+b*s[i+3][u+3],o[p]=E*c+3*(S*f*a+P*A*h)+I*l;return o}:y?function(o,r,g){o||(o=[]);var c,a,h,l,s,p,u=Math.max(0,Math.min(Math.floor(r),t)),i=Math.max(0,Math.min(Math.floor(g),n)),x=Math.max(0,Math.min(1,r-u)),f=Math.max(0,Math.min(1,g-i));u*=3;var _=x*x,b=_*x,T=1-x,k=T*T,L=k*T,A=1-f;for(s=0;s<d.length;s++)c=A*(p=d[s])[i][u]+f*p[i+1][u],a=A*p[i][u+1]+f*p[i+1][u+1],h=A*p[i][u+2]+f*p[i+1][u+1],l=A*p[i][u+3]+f*p[i+1][u+1],o[s]=L*c+3*(k*x*a+T*_*h)+b*l;return o}:e?function(o,r,g){o||(o=[]);var c,a,h,l,s,p,u=Math.max(0,Math.min(Math.floor(r),t)),i=Math.max(0,Math.min(Math.floor(g),n)),x=Math.max(0,Math.min(1,r-u)),f=Math.max(0,Math.min(1,g-i));i*=3;var _=f*f,b=_*f,T=1-f,k=T*T,L=k*T,A=1-x;for(s=0;s<d.length;s++)c=A*(p=d[s])[i][u]+x*p[i][u+1],a=A*p[i+1][u]+x*p[i+1][u+1],h=A*p[i+2][u]+x*p[i+2][u+1],l=A*p[i+3][u]+x*p[i+3][u+1],o[s]=L*c+3*(k*f*a+T*_*h)+b*l;return o}:function(o,r,g){o||(o=[]);var c,a,h,l,s=Math.max(0,Math.min(Math.floor(r),t)),p=Math.max(0,Math.min(Math.floor(g),n)),u=Math.max(0,Math.min(1,r-s)),i=Math.max(0,Math.min(1,g-p)),x=1-i,f=1-u;for(h=0;h<d.length;h++)c=f*(l=d[h])[p][s]+u*l[p][s+1],a=f*l[p+1][s]+u*l[p+1][s+1],o[h]=x*c+i*a;return o}}},{}],715:[function(m,G,Y){var d=m("../../lib"),v=m("./xy_defaults"),w=m("./ab_defaults"),y=m("./attributes"),e=m("../../components/color/attributes");G.exports=function(t,n,o,r){function g(a,h){return d.coerce(t,n,y,a,h)}n._clipPathId="clip"+n.uid+"carpet";var c=g("color",e.defaultLine);d.coerceFont(g,"font"),g("carpet"),w(t,n,r,g,c),n.a&&n.b?(n.a.length<3&&(n.aaxis.smoothing=0),n.b.length<3&&(n.baxis.smoothing=0),v(t,n,g)||(n.visible=!1),n._cheater&&g("cheaterslope")):n.visible=!1}},{"../../components/color/attributes":366,"../../lib":515,"./ab_defaults":698,"./attributes":700,"./xy_defaults":724}],716:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),plot:m("./plot"),calc:m("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":578,"./attributes":700,"./calc":704,"./defaults":715,"./plot":721}],717:[function(m,G,Y){G.exports=function(d,v){for(var w,y=d._fullData.length,e=0;e<y;e++){var t=d._fullData[e];if(t.index!==v.index&&t.type==="carpet"&&(w||(w=t),t.carpet===v.carpet))return t}return w}},{}],718:[function(m,G,Y){G.exports=function(d,v,w){if(d.length===0)return"";var y,e=[],t=w?3:1;for(y=0;y<d.length;y+=t)e.push(d[y]+","+v[y]),w&&y<d.length-t&&(e.push("C"),e.push([d[y+1]+","+v[y+1],d[y+2]+","+v[y+2]+" "].join(" ")));return e.join(w?"":"L")}},{}],719:[function(m,G,Y){var d=m("../../lib").isArrayOrTypedArray;G.exports=function(v,w,y){var e;for(d(v)?v.length>w.length&&(v=v.slice(0,w.length)):v=[],e=0;e<w.length;e++)v[e]=y(w[e]);return v}},{"../../lib":515}],720:[function(m,G,Y){G.exports=function(d,v,w,y,e,t){var n=e[0]*d.dpdx(v),o=e[1]*d.dpdy(w),r=1,g=1;if(t){var c=Math.sqrt(e[0]*e[0]+e[1]*e[1]),a=Math.sqrt(t[0]*t[0]+t[1]*t[1]),h=(e[0]*t[0]+e[1]*t[1])/c/a;g=Math.max(0,h)}var l=180*Math.atan2(o,n)/Math.PI;return l<-90?(l+=180,r=-r):l>90&&(l-=180,r=-r),{angle:l,flip:r,p:d.c2p(y,v,w),offsetMultplier:g}}},{}],721:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../components/drawing"),w=m("./map_1d_array"),y=m("./makepath"),e=m("./orient_text"),t=m("../../lib/svg_text_utils"),n=m("../../lib"),o=n.strRotate,r=n.strTranslate,g=m("../../constants/alignment");function c(p,u,i,x,f,_){var b="const-"+f+"-lines",T=i.selectAll("."+b).data(_);T.enter().append("path").classed(b,!0).style("vector-effect","non-scaling-stroke"),T.each(function(k){var L=k,A=L.x,I=L.y,P=w([],A,p.c2p),S=w([],I,u.c2p),E="M"+y(P,S,L.smoothing);d.select(this).attr("d",E).style("stroke-width",L.width).style("stroke",L.color).style("stroke-dasharray",v.dashStyle(L.dash,L.width)).style("fill","none")}),T.exit().remove()}function a(p,u,i,x,f,_,b,T){var k=_.selectAll("text."+T).data(b);k.enter().append("text").classed(T,!0);var L=0,A={};return k.each(function(I,P){var S;if(I.axis.tickangle==="auto")S=e(x,u,i,I.xy,I.dxy);else{var E=(I.axis.tickangle+180)*Math.PI/180;S=e(x,u,i,I.xy,[Math.cos(E),Math.sin(E)])}P||(A={angle:S.angle,flip:S.flip});var z=(I.endAnchor?-1:1)*S.flip,D=d.select(this).attr({"text-anchor":z>0?"start":"end","data-notex":1}).call(v.font,I.font).text(I.text).call(t.convertToTspans,p),j=v.bBox(this);D.attr("transform",r(S.p[0],S.p[1])+o(S.angle)+r(I.axis.labelpadding*z,.3*j.height)),L=Math.max(L,j.width+I.axis.labelpadding)}),k.exit().remove(),A.maxExtent=L,A}G.exports=function(p,u,i,x){var f=u.xaxis,_=u.yaxis,b=p._fullLayout._clips;n.makeTraceGroups(x,i,"trace").each(function(T){var k=d.select(this),L=T[0],A=L.trace,I=A.aaxis,P=A.baxis,S=n.ensureSingle(k,"g","minorlayer"),E=n.ensureSingle(k,"g","majorlayer"),z=n.ensureSingle(k,"g","boundarylayer"),D=n.ensureSingle(k,"g","labellayer");k.style("opacity",A.opacity),c(f,_,E,I,"a",I._gridlines),c(f,_,E,P,"b",P._gridlines),c(f,_,S,I,"a",I._minorgridlines),c(f,_,S,P,"b",P._minorgridlines),c(f,_,z,I,"a-boundary",I._boundarylines),c(f,_,z,P,"b-boundary",P._boundarylines);var j=a(p,f,_,A,L,D,I._labels,"a-label"),V=a(p,f,_,A,L,D,P._labels,"b-label");(function(Z,Q,X,$,re,H,N,U){var te,B,K,J,ee=n.aggNums(Math.min,null,X.a),ne=n.aggNums(Math.max,null,X.a),se=n.aggNums(Math.min,null,X.b),oe=n.aggNums(Math.max,null,X.b);te=.5*(ee+ne),B=se,K=X.ab2xy(te,B,!0),J=X.dxyda_rough(te,B),N.angle===void 0&&n.extendFlat(N,e(X,re,H,K,X.dxydb_rough(te,B))),s(Z,Q,X,$,K,J,X.aaxis,re,H,N,"a-title"),te=ee,B=.5*(se+oe),K=X.ab2xy(te,B,!0),J=X.dxydb_rough(te,B),U.angle===void 0&&n.extendFlat(U,e(X,re,H,K,X.dxyda_rough(te,B))),s(Z,Q,X,$,K,J,X.baxis,re,H,U,"b-title")})(p,D,A,L,f,_,j,V),function(Z,Q,X,$,re){var H,N,U,te,B=X.select("#"+Z._clipPathId);B.size()||(B=X.append("clipPath").classed("carpetclip",!0));var K=n.ensureSingle(B,"path","carpetboundary"),J=Q.clipsegments,ee=[];for(te=0;te<J.length;te++)H=J[te],N=w([],H.x,$.c2p),U=w([],H.y,re.c2p),ee.push(y(N,U,H.bicubic));var ne="M"+ee.join("L")+"Z";B.attr("id",Z._clipPathId),K.attr("d",ne)}(A,L,b,f,_)})};var h=g.LINE_SPACING,l=(1-g.MID_SHIFT)/h+1;function s(p,u,i,x,f,_,b,T,k,L,A){var I=[];b.title.text&&I.push(b.title.text);var P=u.selectAll("text."+A).data(I),S=L.maxExtent;P.enter().append("text").classed(A,!0),P.each(function(){var E=e(i,T,k,f,_);["start","both"].indexOf(b.showticklabels)===-1&&(S=0);var z=b.title.font.size;S+=z+b.title.offset;var D=(L.angle+(L.flip<0?180:0)-E.angle+450)%360,j=D>90&&D<270,V=d.select(this);V.text(b.title.text).call(t.convertToTspans,p),j&&(S=(-t.lineCount(V)+l)*h*z-S),V.attr("transform",r(E.p[0],E.p[1])+o(E.angle)+r(0,S)).attr("text-anchor","middle").call(v.font,b.title.font)}),P.exit().remove()}},{"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"./makepath":718,"./map_1d_array":719,"./orient_text":720,"@plotly/d3":58}],722:[function(m,G,Y){var d=m("./constants"),v=m("../../lib/search").findBin,w=m("./compute_control_points"),y=m("./create_spline_evaluator"),e=m("./create_i_derivative_evaluator"),t=m("./create_j_derivative_evaluator");G.exports=function(n){var o=n._a,r=n._b,g=o.length,c=r.length,a=n.aaxis,h=n.baxis,l=o[0],s=o[g-1],p=r[0],u=r[c-1],i=o[o.length-1]-o[0],x=r[r.length-1]-r[0],f=i*d.RELATIVE_CULL_TOLERANCE,_=x*d.RELATIVE_CULL_TOLERANCE;l-=f,s+=f,p-=_,u+=_,n.isVisible=function(b,T){return b>l&&b<s&&T>p&&T<u},n.isOccluded=function(b,T){return b<l||b>s||T<p||T>u},n.setScale=function(){var b=n._x,T=n._y,k=w(n._xctrl,n._yctrl,b,T,a.smoothing,h.smoothing);n._xctrl=k[0],n._yctrl=k[1],n.evalxy=y([n._xctrl,n._yctrl],g,c,a.smoothing,h.smoothing),n.dxydi=e([n._xctrl,n._yctrl],a.smoothing,h.smoothing),n.dxydj=t([n._xctrl,n._yctrl],a.smoothing,h.smoothing)},n.i2a=function(b){var T=Math.max(0,Math.floor(b[0]),g-2),k=b[0]-T;return(1-k)*o[T]+k*o[T+1]},n.j2b=function(b){var T=Math.max(0,Math.floor(b[1]),g-2),k=b[1]-T;return(1-k)*r[T]+k*r[T+1]},n.ij2ab=function(b){return[n.i2a(b[0]),n.j2b(b[1])]},n.a2i=function(b){var T=Math.max(0,Math.min(v(b,o),g-2)),k=o[T],L=o[T+1];return Math.max(0,Math.min(g-1,T+(b-k)/(L-k)))},n.b2j=function(b){var T=Math.max(0,Math.min(v(b,r),c-2)),k=r[T],L=r[T+1];return Math.max(0,Math.min(c-1,T+(b-k)/(L-k)))},n.ab2ij=function(b){return[n.a2i(b[0]),n.b2j(b[1])]},n.i2c=function(b,T){return n.evalxy([],b,T)},n.ab2xy=function(b,T,k){if(!k&&(b<o[0]||b>o[g-1]|T<r[0]||T>r[c-1]))return[!1,!1];var L=n.a2i(b),A=n.b2j(T),I=n.evalxy([],L,A);if(k){var P,S,E,z,D=0,j=0,V=[];b<o[0]?(P=0,S=0,D=(b-o[0])/(o[1]-o[0])):b>o[g-1]?(P=g-2,S=1,D=(b-o[g-1])/(o[g-1]-o[g-2])):S=L-(P=Math.max(0,Math.min(g-2,Math.floor(L)))),T<r[0]?(E=0,z=0,j=(T-r[0])/(r[1]-r[0])):T>r[c-1]?(E=c-2,z=1,j=(T-r[c-1])/(r[c-1]-r[c-2])):z=A-(E=Math.max(0,Math.min(c-2,Math.floor(A)))),D&&(n.dxydi(V,P,E,S,z),I[0]+=V[0]*D,I[1]+=V[1]*D),j&&(n.dxydj(V,P,E,S,z),I[0]+=V[0]*j,I[1]+=V[1]*j)}return I},n.c2p=function(b,T,k){return[T.c2p(b[0]),k.c2p(b[1])]},n.p2x=function(b,T,k){return[T.p2c(b[0]),k.p2c(b[1])]},n.dadi=function(b){var T=Math.max(0,Math.min(o.length-2,b));return o[T+1]-o[T]},n.dbdj=function(b){var T=Math.max(0,Math.min(r.length-2,b));return r[T+1]-r[T]},n.dxyda=function(b,T,k,L){var A=n.dxydi(null,b,T,k,L),I=n.dadi(b,k);return[A[0]/I,A[1]/I]},n.dxydb=function(b,T,k,L){var A=n.dxydj(null,b,T,k,L),I=n.dbdj(T,L);return[A[0]/I,A[1]/I]},n.dxyda_rough=function(b,T,k){var L=i*(k||.1),A=n.ab2xy(b+L,T,!0),I=n.ab2xy(b-L,T,!0);return[.5*(A[0]-I[0])/L,.5*(A[1]-I[1])/L]},n.dxydb_rough=function(b,T,k){var L=x*(k||.1),A=n.ab2xy(b,T+L,!0),I=n.ab2xy(b,T-L,!0);return[.5*(A[0]-I[0])/L,.5*(A[1]-I[1])/L]},n.dpdx=function(b){return b._m},n.dpdy=function(b){return b._m}}},{"../../lib/search":535,"./compute_control_points":710,"./constants":711,"./create_i_derivative_evaluator":712,"./create_j_derivative_evaluator":713,"./create_spline_evaluator":714}],723:[function(m,G,Y){var d=m("../../lib");G.exports=function(v,w,y){var e,t,n,o=[],r=[],g=v[0].length,c=v.length;function a(Q,X){var $,re=0,H=0;return Q>0&&($=v[X][Q-1])!==void 0&&(H++,re+=$),Q<g-1&&($=v[X][Q+1])!==void 0&&(H++,re+=$),X>0&&($=v[X-1][Q])!==void 0&&(H++,re+=$),X<c-1&&($=v[X+1][Q])!==void 0&&(H++,re+=$),re/Math.max(1,H)}var h,l,s,p,u,i,x,f,_,b,T,k=0;for(e=0;e<g;e++)for(t=0;t<c;t++)v[t][e]===void 0&&(o.push(e),r.push(t),v[t][e]=a(e,t)),k=Math.max(k,Math.abs(v[t][e]));if(!o.length)return v;var L=0,A=0,I=o.length;do{for(L=0,n=0;n<I;n++){e=o[n],t=r[n];var P,S,E,z,D,j,V=0,Z=0;e===0?(E=w[D=Math.min(g-1,2)],z=w[1],P=v[t][D],Z+=(S=v[t][1])+(S-P)*(w[0]-z)/(z-E),V++):e===g-1&&(E=w[D=Math.max(0,g-3)],z=w[g-2],P=v[t][D],Z+=(S=v[t][g-2])+(S-P)*(w[g-1]-z)/(z-E),V++),(e===0||e===g-1)&&t>0&&t<c-1&&(h=y[t+1]-y[t],Z+=((l=y[t]-y[t-1])*v[t+1][e]+h*v[t-1][e])/(l+h),V++),t===0?(E=y[j=Math.min(c-1,2)],z=y[1],P=v[j][e],Z+=(S=v[1][e])+(S-P)*(y[0]-z)/(z-E),V++):t===c-1&&(E=y[j=Math.max(0,c-3)],z=y[c-2],P=v[j][e],Z+=(S=v[c-2][e])+(S-P)*(y[c-1]-z)/(z-E),V++),(t===0||t===c-1)&&e>0&&e<g-1&&(h=w[e+1]-w[e],Z+=((l=w[e]-w[e-1])*v[t][e+1]+h*v[t][e-1])/(l+h),V++),V?Z/=V:(s=w[e+1]-w[e],p=w[e]-w[e-1],f=(u=y[t+1]-y[t])*(i=y[t]-y[t-1])*(u+i),Z=((x=s*p*(s+p))*(i*v[t+1][e]+u*v[t-1][e])+f*(p*v[t][e+1]+s*v[t][e-1]))/(f*(p+s)+x*(i+u))),L+=(b=(_=Z-v[t][e])/k)*b,T=V?0:.85,v[t][e]+=_*(1+T)}L=Math.sqrt(L)}while(A++<100&&L>1e-5);return d.log("Smoother converged to",L,"after",A,"iterations"),v}},{"../../lib":515}],724:[function(m,G,Y){var d=m("../../lib").isArray1D;G.exports=function(v,w,y){var e=y("x"),t=e&&e.length,n=y("y"),o=n&&n.length;if(!t&&!o)return!1;if(w._cheater=!e,t&&!d(e)||o&&!d(n))w._length=null;else{var r=t?e.length:1/0;o&&(r=Math.min(r,n.length)),w.a&&w.a.length&&(r=Math.min(r,w.a.length)),w.b&&w.b.length&&(r=Math.min(r,w.b.length)),w._length=r}return!0}},{"../../lib":515}],725:[function(m,G,Y){var d=m("../../plots/template_attributes").hovertemplateAttrs,v=m("../scattergeo/attributes"),w=m("../../components/colorscale/attributes"),y=m("../../plots/attributes"),e=m("../../components/color/attributes").defaultLine,t=m("../../lib/extend").extendFlat,n=v.marker.line;G.exports=t({locations:{valType:"data_array",editType:"calc"},locationmode:v.locationmode,z:{valType:"data_array",editType:"calc"},geojson:t({},v.geojson,{}),featureidkey:v.featureidkey,text:t({},v.text,{}),hovertext:t({},v.hovertext,{}),marker:{line:{color:t({},n.color,{dflt:e}),width:t({},n.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:v.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:v.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:t({},y.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:d(),showlegend:t({},y.showlegend,{dflt:!1})},w("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":366,"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scattergeo/attributes":978}],726:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../constants/numerical").BADNUM,w=m("../../components/colorscale/calc"),y=m("../scatter/arrays_to_calcdata"),e=m("../scatter/calc_selection");function t(n){return n&&typeof n=="string"}G.exports=function(n,o){var r,g=o._length,c=new Array(g);r=o.geojson?function(p){return t(p)||d(p)}:t;for(var a=0;a<g;a++){var h=c[a]={},l=o.locations[a],s=o.z[a];r(l)&&d(s)?(h.loc=l,h.z=s):(h.loc=null,h.z=v),h.index=a}return y(c,o),w(n,o,{vals:o.z,containerStr:"",cLetter:"z"}),e(c,o),c}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../scatter/arrays_to_calcdata":935,"../scatter/calc_selection":938,"fast-isnumeric":190}],727:[function(m,G,Y){var d=m("../../lib"),v=m("../../components/colorscale/defaults"),w=m("./attributes");G.exports=function(y,e,t,n){function o(h,l){return d.coerce(y,e,w,h,l)}var r=o("locations"),g=o("z");if(r&&r.length&&d.isArrayOrTypedArray(g)&&g.length){e._length=Math.min(r.length,g.length);var c,a=o("geojson");(typeof a=="string"&&a!==""||d.isPlainObject(a))&&(c="geojson-id"),o("locationmode",c)==="geojson-id"&&o("featureidkey"),o("text"),o("hovertext"),o("hovertemplate"),o("marker.line.width")&&o("marker.line.color"),o("marker.opacity"),v(y,e,n,o,{prefix:"",cLetter:"z"}),d.coerceSelectionMarkerOpacity(e,o)}else e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":725}],728:[function(m,G,Y){G.exports=function(d,v,w,y,e){d.location=v.location,d.z=v.z;var t=y[e];return t.fIn&&t.fIn.properties&&(d.properties=t.fIn.properties),d.ct=t.ct,d}},{}],729:[function(m,G,Y){var d=m("../../plots/cartesian/axes"),v=m("./attributes"),w=m("../../lib").fillText;G.exports=function(y,e,t){var n,o,r,g,c=y.cd,a=c[0].trace,h=y.subplot,l=[e,t],s=[e+360,t];for(o=0;o<c.length;o++)if(g=!1,(n=c[o])._polygons){for(r=0;r<n._polygons.length;r++)n._polygons[r].contains(l)&&(g=!g),n._polygons[r].contains(s)&&(g=!g);if(g)break}if(g&&n)return y.x0=y.x1=y.xa.c2p(n.ct),y.y0=y.y1=y.ya.c2p(n.ct),y.index=n.index,y.location=n.loc,y.z=n.z,y.zLabel=d.tickText(h.mockAxis,h.mockAxis.c2l(n.z),"hover").text,y.hovertemplate=n.hovertemplate,function(p,u,i){if(!u.hovertemplate){var x=i.hi||u.hoverinfo,f=String(i.loc),_=x==="all"?v.hoverinfo.flags:x.split("+"),b=_.indexOf("name")!==-1,T=_.indexOf("location")!==-1,k=_.indexOf("z")!==-1,L=_.indexOf("text")!==-1,A=[];!b&&T?p.nameOverride=f:(b&&(p.nameOverride=u.name),T&&A.push(f)),k&&A.push(p.zLabel),L&&w(i,u,A),p.extraText=A.join("<br>")}}(y,a,n),[y]}},{"../../lib":515,"../../plots/cartesian/axes":566,"./attributes":725}],730:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../heatmap/colorbar"),calc:m("./calc"),calcGeoJSON:m("./plot").calcGeoJSON,plot:m("./plot").plot,style:m("./style").style,styleOnSelect:m("./style").styleOnSelect,hoverPoints:m("./hover"),eventData:m("./event_data"),selectPoints:m("./select"),moduleType:"trace",name:"choropleth",basePlotModule:m("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":598,"../heatmap/colorbar":804,"./attributes":725,"./calc":726,"./defaults":727,"./event_data":728,"./hover":729,"./plot":731,"./select":732,"./style":733}],731:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../lib/geo_location_utils"),y=m("../../lib/topojson_utils").getTopojsonFeatures,e=m("../../plots/cartesian/autorange").findExtremes,t=m("./style").style;G.exports={calcGeoJSON:function(n,o){for(var r=n[0].trace,g=o[r.geo],c=g._subplot,a=r.locationmode,h=r._length,l=a==="geojson-id"?w.extractTraceFeature(n):y(r,c.topojson),s=[],p=[],u=0;u<h;u++){var i=n[u],x=a==="geojson-id"?i.fOut:w.locationToFeature(a,i.loc,l);if(x){i.geojson=x,i.ct=x.properties.ct,i._polygons=w.feature2polygons(x);var f=w.computeBbox(x);s.push(f[0],f[2]),p.push(f[1],f[3])}else i.geojson=null}if(g.fitbounds==="geojson"&&a==="geojson-id"){var _=w.computeBbox(w.getTraceGeojson(r));s=[_[0],_[2]],p=[_[1],_[3]]}var b={padded:!0};r._extremes.lon=e(g.lonaxis._ax,s,b),r._extremes.lat=e(g.lataxis._ax,p,b)},plot:function(n,o,r){var g=o.layers.backplot.select(".choroplethlayer");v.makeTraceGroups(g,r,"trace choropleth").each(function(c){var a=d.select(this).selectAll("path.choroplethlocation").data(v.identity);a.enter().append("path").classed("choroplethlocation",!0),a.exit().remove(),t(n,c)})}}},{"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/topojson_utils":544,"../../plots/cartesian/autorange":565,"./style":733,"@plotly/d3":58}],732:[function(m,G,Y){G.exports=function(d,v){var w,y,e,t,n,o=d.cd,r=d.xaxis,g=d.yaxis,c=[];if(v===!1)for(w=0;w<o.length;w++)o[w].selected=0;else for(w=0;w<o.length;w++)(e=(y=o[w]).ct)&&(t=r.c2p(e),n=g.c2p(e),v.contains([t,n],null,w,d)?(c.push({pointNumber:w,lon:e[0],lat:e[1]}),y.selected=1):y.selected=0);return c}},{}],733:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../components/color"),w=m("../../components/drawing"),y=m("../../components/colorscale");function e(t,n){var o=n[0].trace,r=n[0].node3.selectAll(".choroplethlocation"),g=o.marker||{},c=g.line||{},a=y.makeColorScaleFuncFromTrace(o);r.each(function(h){d.select(this).attr("fill",a(h.z)).call(v.stroke,h.mlc||c.color).call(w.dashLine,"",h.mlw||c.width||0).style("opacity",g.opacity)}),w.selectedPointStyle(r,o)}G.exports={style:function(t,n){n&&e(t,n)},styleOnSelect:function(t,n){var o=n[0].node3,r=n[0].trace;r.selectedpoints?w.selectedPointStyle(o.selectAll(".choroplethlocation"),r):e(0,n)}}},{"../../components/color":367,"../../components/colorscale":379,"../../components/drawing":389,"@plotly/d3":58}],734:[function(m,G,Y){var d=m("../choropleth/attributes"),v=m("../../components/colorscale/attributes"),w=m("../../plots/template_attributes").hovertemplateAttrs,y=m("../../plots/attributes"),e=m("../../lib/extend").extendFlat;G.exports=e({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:e({},d.featureidkey,{}),below:{valType:"string",editType:"plot"},text:d.text,hovertext:d.hovertext,marker:{line:{color:e({},d.marker.line.color,{editType:"plot"}),width:e({},d.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:e({},d.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:e({},d.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:e({},d.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:d.hoverinfo,hovertemplate:w({},{keys:["properties"]}),showlegend:e({},y.showlegend,{dflt:!1})},v("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../choropleth/attributes":725}],735:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("../../components/colorscale"),y=m("../../components/drawing"),e=m("../../lib/geojson_utils").makeBlank,t=m("../../lib/geo_location_utils");function n(o){var r,g=o[0].trace,c=g._opts;if(g.selectedpoints){for(var a=y.makeSelectedPointStyleFns(g),h=0;h<o.length;h++){var l=o[h];l.fOut&&(l.fOut.properties.mo2=a.selectedOpacityFn(l))}r={type:"identity",property:"mo2"}}else r=v.isArrayOrTypedArray(g.marker.opacity)?{type:"identity",property:"mo"}:g.marker.opacity;return v.extendFlat(c.fill.paint,{"fill-opacity":r}),v.extendFlat(c.line.paint,{"line-opacity":r}),c}G.exports={convert:function(o){var r=o[0].trace,g=r.visible===!0&&r._length!==0,c={layout:{visibility:"none"},paint:{}},a={layout:{visibility:"none"},paint:{}},h=r._opts={fill:c,line:a,geojson:e()};if(!g)return h;var l=t.extractTraceFeature(o);if(!l)return h;var s,p,u,i=w.makeColorScaleFuncFromTrace(r),x=r.marker,f=x.line||{};v.isArrayOrTypedArray(x.opacity)&&(s=function(A){var I=A.mo;return d(I)?+v.constrain(I,0,1):0}),v.isArrayOrTypedArray(f.color)&&(p=function(A){return A.mlc}),v.isArrayOrTypedArray(f.width)&&(u=function(A){return A.mlw});for(var _=0;_<o.length;_++){var b=o[_],T=b.fOut;if(T){var k=T.properties;k.fc=i(b.z),s&&(k.mo=s(b)),p&&(k.mlc=p(b)),u&&(k.mlw=u(b)),b.ct=k.ct,b._polygons=t.feature2polygons(T)}}var L=s?{type:"identity",property:"mo"}:x.opacity;return v.extendFlat(c.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":L}),v.extendFlat(a.paint,{"line-color":p?{type:"identity",property:"mlc"}:f.color,"line-width":u?{type:"identity",property:"mlw"}:f.width,"line-opacity":L}),c.layout.visibility="visible",a.layout.visibility="visible",h.geojson={type:"FeatureCollection",features:l},n(o),h},convertOnSelect:n}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/geojson_utils":509,"fast-isnumeric":190}],736:[function(m,G,Y){var d=m("../../lib"),v=m("../../components/colorscale/defaults"),w=m("./attributes");G.exports=function(y,e,t,n){function o(a,h){return d.coerce(y,e,w,a,h)}var r=o("locations"),g=o("z"),c=o("geojson");d.isArrayOrTypedArray(r)&&r.length&&d.isArrayOrTypedArray(g)&&g.length&&(typeof c=="string"&&c!==""||d.isPlainObject(c))?(o("featureidkey"),e._length=Math.min(r.length,g.length),o("below"),o("text"),o("hovertext"),o("hovertemplate"),o("marker.line.width")&&o("marker.line.color"),o("marker.opacity"),v(y,e,n,o,{prefix:"",cLetter:"z"}),d.coerceSelectionMarkerOpacity(e,o)):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":734}],737:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../heatmap/colorbar"),calc:m("../choropleth/calc"),plot:m("./plot"),hoverPoints:m("../choropleth/hover"),eventData:m("../choropleth/event_data"),selectPoints:m("../choropleth/select"),styleOnSelect:function(d,v){v&&v[0].trace._glTrace.updateOnSelect(v)},getBelow:function(d,v){for(var w=v.getMapLayers(),y=w.length-2;y>=0;y--){var e=w[y].id;if(typeof e=="string"&&e.indexOf("water")===0){for(var t=y+1;t<w.length;t++)if(typeof(e=w[t].id)=="string"&&e.indexOf("plotly-")===-1)return e}}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:m("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":622,"../choropleth/calc":726,"../choropleth/event_data":728,"../choropleth/hover":729,"../choropleth/select":732,"../heatmap/colorbar":804,"./attributes":734,"./defaults":736,"./plot":738}],738:[function(m,G,Y){var d=m("./convert").convert,v=m("./convert").convertOnSelect,w=m("../../plots/mapbox/constants").traceLayerPrefix;function y(t,n){this.type="choroplethmapbox",this.subplot=t,this.uid=n,this.sourceId="source-"+n,this.layerList=[["fill",w+n+"-fill"],["line",w+n+"-line"]],this.below=null}var e=y.prototype;e.update=function(t){this._update(d(t)),t[0].trace._glTrace=this},e.updateOnSelect=function(t){this._update(v(t))},e._update=function(t){var n=this.subplot,o=this.layerList,r=n.belowLookup["trace-"+this.uid];n.map.getSource(this.sourceId).setData(t.geojson),r!==this.below&&(this._removeLayers(),this._addLayers(t,r),this.below=r);for(var g=0;g<o.length;g++){var c=o[g],a=c[0],h=c[1],l=t[a];n.setOptions(h,"setLayoutProperty",l.layout),l.layout.visibility==="visible"&&n.setOptions(h,"setPaintProperty",l.paint)}},e._addLayers=function(t,n){for(var o=this.subplot,r=this.layerList,g=this.sourceId,c=0;c<r.length;c++){var a=r[c],h=a[0],l=t[h];o.addLayer({type:h,id:a[1],source:g,layout:l.layout,paint:l.paint},n)}},e._removeLayers=function(){for(var t=this.subplot.map,n=this.layerList,o=n.length-1;o>=0;o--)t.removeLayer(n[o][1])},e.dispose=function(){var t=this.subplot.map;this._removeLayers(),t.removeSource(this.sourceId)},G.exports=function(t,n){var o=n[0].trace,r=new y(t,o.uid),g=r.sourceId,c=d(n),a=r.below=t.belowLookup["trace-"+o.uid];return t.map.addSource(g,{type:"geojson",data:c.geojson}),r._addLayers(c,a),n[0].trace._glTrace=r,r}},{"../../plots/mapbox/constants":620,"./convert":735}],739:[function(m,G,Y){var d=m("../../components/colorscale/attributes"),v=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,w=m("../../plots/template_attributes").hovertemplateAttrs,y=m("../mesh3d/attributes"),e=m("../../plots/attributes"),t=m("../../lib/extend").extendFlat,n={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:w({editType:"calc"},{keys:["norm"]}),uhoverformat:v("u",1),vhoverformat:v("v",1),whoverformat:v("w",1),xhoverformat:v("x"),yhoverformat:v("y"),zhoverformat:v("z"),showlegend:t({},e.showlegend,{dflt:!1})};t(n,d("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(o){n[o]=y[o]}),n.hoverinfo=t({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),n.transforms=void 0,G.exports=n},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],740:[function(m,G,Y){var d=m("../../components/colorscale/calc");G.exports=function(v,w){for(var y=w.u,e=w.v,t=w.w,n=Math.min(w.x.length,w.y.length,w.z.length,y.length,e.length,t.length),o=-1/0,r=1/0,g=0;g<n;g++){var c=y[g],a=e[g],h=t[g],l=Math.sqrt(c*c+a*a+h*h);o=Math.max(o,l),r=Math.min(r,l)}w._len=n,w._normMax=o,d(v,w,{vals:[r,o],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],741:[function(m,G,Y){var d=m("../../../stackgl_modules").gl_cone3d,v=m("../../../stackgl_modules").gl_cone3d.createConeMesh,w=m("../../lib").simpleMap,y=m("../../lib/gl_format_color").parseColorScale,e=m("../../components/colorscale").extractOpts,t=m("../../plots/gl3d/zip3");function n(h,l){this.scene=h,this.uid=l,this.mesh=null,this.data=null}var o=n.prototype;o.handlePick=function(h){if(h.object===this.mesh){var l=h.index=h.data.index,s=this.data.x[l],p=this.data.y[l],u=this.data.z[l],i=this.data.u[l],x=this.data.v[l],f=this.data.w[l];h.traceCoordinate=[s,p,u,i,x,f,Math.sqrt(i*i+x*x+f*f)];var _=this.data.hovertext||this.data.text;return Array.isArray(_)&&_[l]!==void 0?h.textLabel=_[l]:_&&(h.textLabel=_),!0}};var r={xaxis:0,yaxis:1,zaxis:2},g={tip:1,tail:0,cm:.25,center:.5},c={tip:1,tail:1,cm:.75,center:.5};function a(h,l){var s=h.fullSceneLayout,p=h.dataScale,u={};function i(b,T){var k=s[T],L=p[r[T]];return w(b,function(A){return k.d2l(A)*L})}u.vectors=t(i(l.u,"xaxis"),i(l.v,"yaxis"),i(l.w,"zaxis"),l._len),u.positions=t(i(l.x,"xaxis"),i(l.y,"yaxis"),i(l.z,"zaxis"),l._len);var x=e(l);u.colormap=y(l),u.vertexIntensityBounds=[x.min/l._normMax,x.max/l._normMax],u.coneOffset=g[l.anchor],l.sizemode==="scaled"?u.coneSize=l.sizeref||.5:u.coneSize=l.sizeref&&l._normMax?l.sizeref/l._normMax:.5;var f=d(u),_=l.lightposition;return f.lightPosition=[_.x,_.y,_.z],f.ambient=l.lighting.ambient,f.diffuse=l.lighting.diffuse,f.specular=l.lighting.specular,f.roughness=l.lighting.roughness,f.fresnel=l.lighting.fresnel,f.opacity=l.opacity,l._pad=c[l.anchor]*f.vectorScale*f.coneScale*l._normMax,f}o.update=function(h){this.data=h;var l=a(this.scene,h);this.mesh.update(l)},o.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},G.exports=function(h,l){var s=h.glplot.gl,p=a(h,l),u=v(s,p),i=new n(h,l.uid);return i.mesh=u,i.data=l,u._trace=i,h.glplot.add(u),i}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/gl3d/zip3":618}],742:[function(m,G,Y){var d=m("../../lib"),v=m("../../components/colorscale/defaults"),w=m("./attributes");G.exports=function(y,e,t,n){function o(s,p){return d.coerce(y,e,w,s,p)}var r=o("u"),g=o("v"),c=o("w"),a=o("x"),h=o("y"),l=o("z");r&&r.length&&g&&g.length&&c&&c.length&&a&&a.length&&h&&h.length&&l&&l.length?(o("sizeref"),o("sizemode"),o("anchor"),o("lighting.ambient"),o("lighting.diffuse"),o("lighting.specular"),o("lighting.roughness"),o("lighting.fresnel"),o("lightposition.x"),o("lightposition.y"),o("lightposition.z"),v(y,e,n,o,{prefix:"",cLetter:"c"}),o("text"),o("hovertext"),o("hovertemplate"),o("uhoverformat"),o("vhoverformat"),o("whoverformat"),o("xhoverformat"),o("yhoverformat"),o("zhoverformat"),e._length=null):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":739}],743:[function(m,G,Y){G.exports={moduleType:"trace",name:"cone",basePlotModule:m("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:m("./calc"),plot:m("./convert"),eventData:function(d,v){return d.norm=v.traceCoordinate[6],d},meta:{}}},{"../../plots/gl3d":607,"./attributes":739,"./calc":740,"./convert":741,"./defaults":742}],744:[function(m,G,Y){var d=m("../heatmap/attributes"),v=m("../scatter/attributes"),w=m("../../plots/cartesian/axis_format_attributes"),y=w.axisHoverFormat,e=w.descriptionOnlyNumbers,t=m("../../components/colorscale/attributes"),n=m("../../components/drawing/attributes").dash,o=m("../../plots/font_attributes"),r=m("../../lib/extend").extendFlat,g=m("../../constants/filter_ops"),c=g.COMPARISON_OPS2,a=g.INTERVAL_OPS,h=v.line;G.exports=r({z:d.z,x:d.x,x0:d.x0,dx:d.dx,y:d.y,y0:d.y0,dy:d.dy,xperiod:d.xperiod,yperiod:d.yperiod,xperiod0:v.xperiod0,yperiod0:v.yperiod0,xperiodalignment:d.xperiodalignment,yperiodalignment:d.yperiodalignment,text:d.text,hovertext:d.hovertext,transpose:d.transpose,xtype:d.xtype,ytype:d.ytype,xhoverformat:y("x"),yhoverformat:y("y"),zhoverformat:y("z",1),hovertemplate:d.hovertemplate,texttemplate:r({},d.texttemplate,{}),textfont:r({},d.textfont,{}),hoverongaps:d.hoverongaps,connectgaps:r({},d.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:o({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot",description:e("contour label")},operation:{valType:"enumerated",values:[].concat(c).concat(a),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:r({},h.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:n,smoothing:r({},h.smoothing,{}),editType:"plot"}},t("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../constants/filter_ops":487,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../heatmap/attributes":801,"../scatter/attributes":936}],745:[function(m,G,Y){var d=m("../../components/colorscale"),v=m("../heatmap/calc"),w=m("./set_contours"),y=m("./end_plus");G.exports=function(e,t){var n=v(e,t),o=n[0].z;w(t,o);var r,g=t.contours,c=d.extractOpts(t);if(g.coloring==="heatmap"&&c.auto&&t.autocontour===!1){var a=g.start,h=y(g),l=g.size||1,s=Math.floor((h-a)/l)+1;isFinite(l)||(l=1,s=1);var p=a-l/2;r=[p,p+s*l]}else r=o;return d.calc(e,t,{vals:r,cLetter:"z"}),n}},{"../../components/colorscale":379,"../heatmap/calc":802,"./end_plus":755,"./set_contours":763}],746:[function(m,G,Y){G.exports=function(d,v){var w,y=d[0],e=y.z;switch(v.type){case"levels":var t=Math.min(e[0][0],e[0][1]);for(w=0;w<d.length;w++){var n=d[w];n.prefixBoundary=!n.edgepaths.length&&(t>n.level||n.starts.length&&t===n.level)}break;case"constraint":if(y.prefixBoundary=!1,y.edgepaths.length)return;var o=y.x.length,r=y.y.length,g=-1/0,c=1/0;for(w=0;w<r;w++)c=Math.min(c,e[w][0]),c=Math.min(c,e[w][o-1]),g=Math.max(g,e[w][0]),g=Math.max(g,e[w][o-1]);for(w=1;w<o-1;w++)c=Math.min(c,e[0][w]),c=Math.min(c,e[r-1][w]),g=Math.max(g,e[0][w]),g=Math.max(g,e[r-1][w]);var a,h,l=v.value;switch(v._operation){case">":l>g&&(y.prefixBoundary=!0);break;case"<":(l<c||y.starts.length&&l===c)&&(y.prefixBoundary=!0);break;case"[]":a=Math.min(l[0],l[1]),((h=Math.max(l[0],l[1]))<c||a>g||y.starts.length&&h===c)&&(y.prefixBoundary=!0);break;case"][":a=Math.min(l[0],l[1]),h=Math.max(l[0],l[1]),a<c&&h>g&&(y.prefixBoundary=!0)}}}},{}],747:[function(m,G,Y){var d=m("../../components/colorscale"),v=m("./make_color_map"),w=m("./end_plus");G.exports={min:"zmin",max:"zmax",calc:function(y,e,t){var n=e.contours,o=e.line,r=n.size||1,g=n.coloring,c=v(e,{isColorbar:!0});if(g==="heatmap"){var a=d.extractOpts(e);t._fillgradient=a.reversescale?d.flipScale(a.colorscale):a.colorscale,t._zrange=[a.min,a.max]}else g==="fill"&&(t._fillcolor=c);t._line={color:g==="lines"?c:o.color,width:n.showlines!==!1?o.width:0,dash:o.dash},t._levels={start:n.start,end:w(n),size:r}}}},{"../../components/colorscale":379,"./end_plus":755,"./make_color_map":760}],748:[function(m,G,Y){G.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],749:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("./label_defaults"),w=m("../../components/color"),y=w.addOpacity,e=w.opacity,t=m("../../constants/filter_ops"),n=t.CONSTRAINT_REDUCTION,o=t.COMPARISON_OPS2;G.exports=function(r,g,c,a,h,l){var s,p,u,i=g.contours,x=c("contours.operation");i._operation=n[x],function(f,_){var b;o.indexOf(_.operation)===-1?(f("contours.value",[0,1]),Array.isArray(_.value)?_.value.length>2?_.value=_.value.slice(2):_.length===0?_.value=[0,1]:_.length<2?(b=parseFloat(_.value[0]),_.value=[b,b+1]):_.value=[parseFloat(_.value[0]),parseFloat(_.value[1])]:d(_.value)&&(b=parseFloat(_.value),_.value=[b,b+1])):(f("contours.value",0),d(_.value)||(Array.isArray(_.value)?_.value=parseFloat(_.value[0]):_.value=0))}(c,i),x==="="?s=i.showlines=!0:(s=c("contours.showlines"),u=c("fillcolor",y((r.line||{}).color||h,.5))),s&&(p=c("line.color",u&&e(u)?y(g.fillcolor,1):h),c("line.width",2),c("line.dash")),c("line.smoothing"),v(c,a,p,l)}},{"../../components/color":367,"../../constants/filter_ops":487,"./label_defaults":759,"fast-isnumeric":190}],750:[function(m,G,Y){var d=m("../../constants/filter_ops"),v=m("fast-isnumeric");function w(t,n){var o,r=Array.isArray(n);function g(c){return v(c)?+c:null}return d.COMPARISON_OPS2.indexOf(t)!==-1?o=g(r?n[0]:n):d.INTERVAL_OPS.indexOf(t)!==-1?o=r?[g(n[0]),g(n[1])]:[g(n),g(n)]:d.SET_OPS.indexOf(t)!==-1&&(o=r?n.map(g):[g(n)]),o}function y(t){return function(n){n=w(t,n);var o=Math.min(n[0],n[1]),r=Math.max(n[0],n[1]);return{start:o,end:r,size:r-o}}}function e(t){return function(n){return{start:n=w(t,n),end:1/0,size:1/0}}}G.exports={"[]":y("[]"),"][":y("]["),">":e(">"),"<":e("<"),"=":e("=")}},{"../../constants/filter_ops":487,"fast-isnumeric":190}],751:[function(m,G,Y){G.exports=function(d,v,w,y){var e=y("contours.start"),t=y("contours.end"),n=e===!1||t===!1,o=w("contours.size");!(n?v.autocontour=!0:w("autocontour",!1))&&o||w("ncontours")}},{}],752:[function(m,G,Y){var d=m("../../lib");function v(w){return d.extendFlat({},w,{edgepaths:d.extendDeep([],w.edgepaths),paths:d.extendDeep([],w.paths),starts:d.extendDeep([],w.starts)})}G.exports=function(w,y){var e,t,n,o=function(c){return c.reverse()},r=function(c){return c};switch(y){case"=":case"<":return w;case">":for(w.length!==1&&d.warn("Contour data invalid for the specified inequality operation."),t=w[0],e=0;e<t.edgepaths.length;e++)t.edgepaths[e]=o(t.edgepaths[e]);for(e=0;e<t.paths.length;e++)t.paths[e]=o(t.paths[e]);for(e=0;e<t.starts.length;e++)t.starts[e]=o(t.starts[e]);return w;case"][":var g=o;o=r,r=g;case"[]":for(w.length!==2&&d.warn("Contour data invalid for the specified inequality range operation."),t=v(w[0]),n=v(w[1]),e=0;e<t.edgepaths.length;e++)t.edgepaths[e]=o(t.edgepaths[e]);for(e=0;e<t.paths.length;e++)t.paths[e]=o(t.paths[e]);for(e=0;e<t.starts.length;e++)t.starts[e]=o(t.starts[e]);for(;n.edgepaths.length;)t.edgepaths.push(r(n.edgepaths.shift()));for(;n.paths.length;)t.paths.push(r(n.paths.shift()));for(;n.starts.length;)t.starts.push(r(n.starts.shift()));return[t]}}},{"../../lib":515}],753:[function(m,G,Y){var d=m("../../lib"),v=m("../heatmap/xyz_defaults"),w=m("../scatter/period_defaults"),y=m("./constraint_defaults"),e=m("./contours_defaults"),t=m("./style_defaults"),n=m("../heatmap/label_defaults"),o=m("./attributes");G.exports=function(r,g,c,a){function h(s,p){return d.coerce(r,g,o,s,p)}if(v(r,g,h,a)){w(r,g,a,h),h("xhoverformat"),h("yhoverformat"),h("text"),h("hovertext"),h("hoverongaps"),h("hovertemplate");var l=h("contours.type")==="constraint";h("connectgaps",d.isArray1D(g.z)),l?y(r,g,h,a,c):(e(r,g,h,function(s){return d.coerce2(r,g,o,s)}),t(r,g,h,a)),g.contours&&g.contours.coloring==="heatmap"&&n(h,a)}else g.visible=!1}},{"../../lib":515,"../heatmap/label_defaults":811,"../heatmap/xyz_defaults":816,"../scatter/period_defaults":956,"./attributes":744,"./constraint_defaults":749,"./contours_defaults":751,"./style_defaults":765}],754:[function(m,G,Y){var d=m("../../lib"),v=m("./constraint_mapping"),w=m("./end_plus");G.exports=function(y,e,t){for(var n=y.type==="constraint"?v[y._operation](y.value):y,o=n.size,r=[],g=w(n),c=t.trace._carpetTrace,a=c?{xaxis:c.aaxis,yaxis:c.baxis,x:t.a,y:t.b}:{xaxis:e.xaxis,yaxis:e.yaxis,x:t.x,y:t.y},h=n.start;h<g;h+=o)if(r.push(d.extendFlat({level:h,crossings:{},starts:[],edgepaths:[],paths:[],z:t.z,smoothing:t.trace.line.smoothing},a)),r.length>1e3){d.warn("Too many contours, clipping at 1000",y);break}return r}},{"../../lib":515,"./constraint_mapping":750,"./end_plus":755}],755:[function(m,G,Y){G.exports=function(d){return d.end+d.size/1e6}},{}],756:[function(m,G,Y){var d=m("../../lib"),v=m("./constants");function w(t,n,o,r){return Math.abs(t[0]-n[0])<o&&Math.abs(t[1]-n[1])<r}function y(t,n,o,r,g){var c,a=n.join(","),h=t.crossings[a],l=function(K,J,ee){var ne=0,se=0;return K>20&&J?K===208||K===1114?ne=ee[0]===0?1:-1:se=ee[1]===0?1:-1:v.BOTTOMSTART.indexOf(K)!==-1?se=1:v.LEFTSTART.indexOf(K)!==-1?ne=1:v.TOPSTART.indexOf(K)!==-1?se=-1:ne=-1,[ne,se]}(h,o,n),s=[e(t,n,[-l[0],-l[1]])],p=t.z.length,u=t.z[0].length,i=n.slice(),x=l.slice();for(c=0;c<1e4;c++){if(h>20?(h=v.CHOOSESADDLE[h][(l[0]||l[1])<0?0:1],t.crossings[a]=v.SADDLEREMAINDER[h]):delete t.crossings[a],!(l=v.NEWDELTA[h])){d.log("Found bad marching index:",h,n,t.level);break}s.push(e(t,n,l)),n[0]+=l[0],n[1]+=l[1],a=n.join(","),w(s[s.length-1],s[s.length-2],r,g)&&s.pop();var f=l[0]&&(n[0]<0||n[0]>u-2)||l[1]&&(n[1]<0||n[1]>p-2);if(n[0]===i[0]&&n[1]===i[1]&&l[0]===x[0]&&l[1]===x[1]||o&&f)break;h=t.crossings[a]}c===1e4&&d.log("Infinite loop in contour?");var _,b,T,k,L,A,I,P,S,E,z,D,j,V,Z,Q=w(s[0],s[s.length-1],r,g),X=0,$=.2*t.smoothing,re=[],H=0;for(c=1;c<s.length;c++)D=s[c],j=s[c-1],V=void 0,Z=void 0,V=D[2]-j[2],Z=D[3]-j[3],X+=I=Math.sqrt(V*V+Z*Z),re.push(I);var N=X/re.length*$;function U(K){return s[K%s.length]}for(c=s.length-2;c>=H;c--)if((_=re[c])<N){for(T=0,b=c-1;b>=H&&_+re[b]<N;b--)_+=re[b];if(Q&&c===s.length-2)for(T=0;T<b&&_+re[T]<N;T++)_+=re[T];L=c-b+T+1,A=Math.floor((c+b+T+2)/2),k=Q||c!==s.length-2?Q||b!==-1?L%2?U(A):[(U(A)[0]+U(A+1)[0])/2,(U(A)[1]+U(A+1)[1])/2]:s[0]:s[s.length-1],s.splice(b+1,c-b+1,k),c=b+1,T&&(H=T),Q&&(c===s.length-2?s[T]=s[s.length-1]:c===0&&(s[s.length-1]=s[0]))}for(s.splice(0,H),c=0;c<s.length;c++)s[c].length=2;if(!(s.length<2))if(Q)s.pop(),t.paths.push(s);else{o||d.log("Unclosed interior contour?",t.level,i.join(","),s.join("L"));var te=!1;for(P=0;P<t.edgepaths.length;P++)if(E=t.edgepaths[P],!te&&w(E[0],s[s.length-1],r,g)){s.pop(),te=!0;var B=!1;for(S=0;S<t.edgepaths.length;S++)if(w((z=t.edgepaths[S])[z.length-1],s[0],r,g)){B=!0,s.shift(),t.edgepaths.splice(P,1),S===P?t.paths.push(s.concat(z)):(S>P&&S--,t.edgepaths[S]=z.concat(s,E));break}B||(t.edgepaths[P]=s.concat(E))}for(P=0;P<t.edgepaths.length&&!te;P++)w((E=t.edgepaths[P])[E.length-1],s[0],r,g)&&(s.shift(),t.edgepaths[P]=E.concat(s),te=!0);te||t.edgepaths.push(s)}}function e(t,n,o){var r=n[0]+Math.max(o[0],0),g=n[1]+Math.max(o[1],0),c=t.z[g][r],a=t.xaxis,h=t.yaxis;if(o[1]){var l=(t.level-c)/(t.z[g][r+1]-c),s=(l!==1?(1-l)*a.c2l(t.x[r]):0)+(l!==0?l*a.c2l(t.x[r+1]):0);return[a.c2p(a.l2c(s),!0),h.c2p(t.y[g],!0),r+l,g]}var p=(t.level-c)/(t.z[g+1][r]-c),u=(p!==1?(1-p)*h.c2l(t.y[g]):0)+(p!==0?p*h.c2l(t.y[g+1]):0);return[a.c2p(t.x[r],!0),h.c2p(h.l2c(u),!0),r,g+p]}G.exports=function(t,n,o){var r,g,c,a;for(n=n||.01,o=o||.01,g=0;g<t.length;g++){for(c=t[g],a=0;a<c.starts.length;a++)y(c,c.starts[a],"edge",n,o);for(r=0;Object.keys(c.crossings).length&&r<1e4;)r++,y(c,Object.keys(c.crossings)[0].split(",").map(Number),void 0,n,o);r===1e4&&d.log("Infinite loop in contour?")}}},{"../../lib":515,"./constants":748}],757:[function(m,G,Y){var d=m("../../components/color"),v=m("../heatmap/hover");G.exports=function(w,y,e,t,n){n||(n={}),n.isContour=!0;var o=v(w,y,e,t,n);return o&&o.forEach(function(r){var g=r.trace;g.contours.type==="constraint"&&(g.fillcolor&&d.opacity(g.fillcolor)?r.color=d.addOpacity(g.fillcolor,1):g.contours.showlines&&d.opacity(g.line.color)&&(r.color=d.addOpacity(g.line.color,1)))}),o}},{"../../components/color":367,"../heatmap/hover":808}],758:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),calc:m("./calc"),plot:m("./plot").plot,style:m("./style"),colorbar:m("./colorbar"),hoverPoints:m("./hover"),moduleType:"trace",name:"contour",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":578,"./attributes":744,"./calc":745,"./colorbar":747,"./defaults":753,"./hover":757,"./plot":762,"./style":764}],759:[function(m,G,Y){var d=m("../../lib");G.exports=function(v,w,y,e){if(e||(e={}),v("contours.showlabels")){var t=w.font;d.coerceFont(v,"contours.labelfont",{family:t.family,size:t.size,color:y}),v("contours.labelformat")}e.hasHover!==!1&&v("zhoverformat")}},{"../../lib":515}],760:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../components/colorscale"),w=m("./end_plus");G.exports=function(y){var e=y.contours,t=e.start,n=w(e),o=e.size||1,r=Math.floor((n-t)/o)+1,g=e.coloring==="lines"?0:1,c=v.extractOpts(y);isFinite(o)||(o=1,r=1);var a,h,l=c.reversescale?v.flipScale(c.colorscale):c.colorscale,s=l.length,p=new Array(s),u=new Array(s);if(e.coloring==="heatmap"){var i=c.min,x=c.max;for(h=0;h<s;h++)a=l[h],p[h]=a[0]*(x-i)+i,u[h]=a[1];var f=d.extent([i,x,e.start,e.start+o*(r-1)]),_=f[i<x?0:1],b=f[i<x?1:0];_!==i&&(p.splice(0,0,_),u.splice(0,0,u[0])),b!==x&&(p.push(b),u.push(u[u.length-1]))}else for(h=0;h<s;h++)a=l[h],p[h]=(a[0]*(r+g-1)-g/2)*o+t,u[h]=a[1];return v.makeColorScaleFunc({domain:p,range:u},{noNumericCheck:!0})}},{"../../components/colorscale":379,"./end_plus":755,"@plotly/d3":58}],761:[function(m,G,Y){var d=m("./constants");function v(w,y){var e=(y[0][0]>w?0:1)+(y[0][1]>w?0:2)+(y[1][1]>w?0:4)+(y[1][0]>w?0:8);return e===5||e===10?w>(y[0][0]+y[0][1]+y[1][0]+y[1][1])/4?e===5?713:1114:e===5?104:208:e===15?0:e}G.exports=function(w){var y,e,t,n,o,r,g,c,a,h=w[0].z,l=h.length,s=h[0].length,p=l===2||s===2;for(e=0;e<l-1;e++)for(n=[],e===0&&(n=n.concat(d.BOTTOMSTART)),e===l-2&&(n=n.concat(d.TOPSTART)),y=0;y<s-1;y++)for(t=n.slice(),y===0&&(t=t.concat(d.LEFTSTART)),y===s-2&&(t=t.concat(d.RIGHTSTART)),o=y+","+e,r=[[h[e][y],h[e][y+1]],[h[e+1][y],h[e+1][y+1]]],a=0;a<w.length;a++)(g=v((c=w[a]).level,r))&&(c.crossings[o]=g,t.indexOf(g)!==-1&&(c.starts.push([y,e]),p&&t.indexOf(g,t.indexOf(g)+1)!==-1&&c.starts.push([y,e])))}},{"./constants":748}],762:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../components/drawing"),y=m("../../components/colorscale"),e=m("../../lib/svg_text_utils"),t=m("../../plots/cartesian/axes"),n=m("../../plots/cartesian/set_convert"),o=m("../heatmap/plot"),r=m("./make_crossings"),g=m("./find_all_paths"),c=m("./empty_pathinfo"),a=m("./convert_to_constraints"),h=m("./close_boundaries"),l=m("./constants"),s=l.LABELOPTIMIZER;function p(x,f){var _,b,T,k,L,A,I,P="",S=0,E=x.edgepaths.map(function(Q,X){return X}),z=!0;function D(Q){return Math.abs(Q[1]-f[2][1])<.01}function j(Q){return Math.abs(Q[0]-f[0][0])<.01}function V(Q){return Math.abs(Q[0]-f[2][0])<.01}for(;E.length;){for(A=w.smoothopen(x.edgepaths[S],x.smoothing),P+=z?A:A.replace(/^M/,"L"),E.splice(E.indexOf(S),1),_=x.edgepaths[S][x.edgepaths[S].length-1],k=-1,T=0;T<4;T++){if(!_){v.log("Missing end?",S,x);break}for(I=_,Math.abs(I[1]-f[0][1])<.01&&!V(_)?b=f[1]:j(_)?b=f[0]:D(_)?b=f[3]:V(_)&&(b=f[2]),L=0;L<x.edgepaths.length;L++){var Z=x.edgepaths[L][0];Math.abs(_[0]-b[0])<.01?Math.abs(_[0]-Z[0])<.01&&(Z[1]-_[1])*(b[1]-Z[1])>=0&&(b=Z,k=L):Math.abs(_[1]-b[1])<.01?Math.abs(_[1]-Z[1])<.01&&(Z[0]-_[0])*(b[0]-Z[0])>=0&&(b=Z,k=L):v.log("endpt to newendpt is not vert. or horz.",_,b,Z)}if(_=b,k>=0)break;P+="L"+b}if(k===x.edgepaths.length){v.log("unclosed perimeter path");break}S=k,(z=E.indexOf(S)===-1)&&(S=E[0],P+="Z")}for(S=0;S<x.paths.length;S++)P+=w.smoothclosed(x.paths[S],x.smoothing);return P}function u(x,f,_,b){var T=f.width/2,k=f.height/2,L=x.x,A=x.y,I=x.theta,P=Math.cos(I)*T,S=Math.sin(I)*T,E=(L>b.center?b.right-L:L-b.left)/(P+Math.abs(Math.sin(I)*k)),z=(A>b.middle?b.bottom-A:A-b.top)/(Math.abs(S)+Math.cos(I)*k);if(E<1||z<1)return 1/0;var D=s.EDGECOST*(1/(E-1)+1/(z-1));D+=s.ANGLECOST*I*I;for(var j=L-P,V=A-S,Z=L+P,Q=A+S,X=0;X<_.length;X++){var $=_[X],re=Math.cos($.theta)*$.width/2,H=Math.sin($.theta)*$.width/2,N=2*v.segmentDistance(j,V,Z,Q,$.x-re,$.y-H,$.x+re,$.y+H)/(f.height+$.height),U=$.level===f.level,te=U?s.SAMELEVELDISTANCE:1;if(N<=te)return 1/0;D+=s.NEIGHBORCOST*(U?s.SAMELEVELFACTOR:1)/(N-te)}return D}function i(x){var f,_,b=x.trace._emptypoints,T=[],k=x.z.length,L=x.z[0].length,A=[];for(f=0;f<L;f++)A.push(1);for(f=0;f<k;f++)T.push(A.slice());for(f=0;f<b.length;f++)T[(_=b[f])[0]][_[1]]=0;return x.zmask=T,T}Y.plot=function(x,f,_,b){var T=f.xaxis,k=f.yaxis;v.makeTraceGroups(b,_,"contour").each(function(L){var A=d.select(this),I=L[0],P=I.trace,S=I.x,E=I.y,z=P.contours,D=c(z,f,I),j=v.ensureSingle(A,"g","heatmapcoloring"),V=[];z.coloring==="heatmap"&&(V=[L]),o(x,f,V,j),r(D),g(D);var Z=T.c2p(S[0],!0),Q=T.c2p(S[S.length-1],!0),X=k.c2p(E[0],!0),$=k.c2p(E[E.length-1],!0),re=[[Z,$],[Q,$],[Q,X],[Z,X]],H=D;z.type==="constraint"&&(H=a(D,z._operation)),function(N,U,te){var B=v.ensureSingle(N,"g","contourbg").selectAll("path").data(te.coloring==="fill"?[0]:[]);B.enter().append("path"),B.exit().remove(),B.attr("d","M"+U.join("L")+"Z").style("stroke","none")}(A,re,z),function(N,U,te,B){var K=B.coloring==="fill"||B.type==="constraint"&&B._operation!=="=",J="M"+te.join("L")+"Z";K&&h(U,B);var ee=v.ensureSingle(N,"g","contourfill").selectAll("path").data(K?U:[]);ee.enter().append("path"),ee.exit().remove(),ee.each(function(ne){var se=(ne.prefixBoundary?J:"")+p(ne,te);se?d.select(this).attr("d",se).style("stroke","none"):d.select(this).remove()})}(A,H,re,z),function(N,U,te,B,K){var J=v.ensureSingle(N,"g","contourlines"),ee=K.showlines!==!1,ne=K.showlabels,se=ee&&ne,oe=Y.createLines(J,ee||ne,U),me=Y.createLineClip(J,se,te,B.trace.uid),ce=N.selectAll("g.contourlabels").data(ne?[0]:[]);if(ce.exit().remove(),ce.enter().append("g").classed("contourlabels",!0),ne){var ye=[],Se=[];v.clearLocationCache();var fe=Y.labelFormatter(te,B),ge=w.tester.append("text").attr("data-notex",1).call(w.font,K.labelfont),Te=U[0].xaxis,le=U[0].yaxis,ve=Te._length,Me=le._length,we=Te.range,de=le.range,Ie=v.aggNums(Math.min,null,B.x),De=v.aggNums(Math.max,null,B.x),Oe=v.aggNums(Math.min,null,B.y),Ve=v.aggNums(Math.max,null,B.y),Fe=Math.max(Te.c2p(Ie,!0),0),ze=Math.min(Te.c2p(De,!0),ve),Re=Math.max(le.c2p(Ve,!0),0),We=Math.min(le.c2p(Oe,!0),Me),$e={};we[0]<we[1]?($e.left=Fe,$e.right=ze):($e.left=ze,$e.right=Fe),de[0]<de[1]?($e.top=Re,$e.bottom=We):($e.top=We,$e.bottom=Re),$e.middle=($e.top+$e.bottom)/2,$e.center=($e.left+$e.right)/2,ye.push([[$e.left,$e.top],[$e.right,$e.top],[$e.right,$e.bottom],[$e.left,$e.bottom]]);var at=Math.sqrt(ve*ve+Me*Me),gt=l.LABELDISTANCE*at/Math.max(1,U.length/l.LABELINCREASE);oe.each(function(xt){var mt=Y.calcTextOpts(xt.level,fe,ge,te);d.select(this).selectAll("path").each(function(){var nt=v.getVisibleSegment(this,$e,mt.height/2);if(nt&&!(nt.len<(mt.width+mt.height)*l.LABELMIN))for(var Qe=Math.min(Math.ceil(nt.len/gt),l.LABELMAX),vt=0;vt<Qe;vt++){var jt=Y.findBestTextLocation(this,nt,mt,Se,$e);if(!jt)break;Y.addLabelData(jt,mt,Se,ye)}})}),ge.remove(),Y.drawLabels(ce,Se,te,me,se?ye:null)}ne&&!ee&&oe.remove()}(A,D,x,I,z),function(N,U,te,B,K){var J=B.trace,ee=te._fullLayout._clips,ne="clip"+J.uid,se=ee.selectAll("#"+ne).data(J.connectgaps?[]:[0]);if(se.enter().append("clipPath").classed("contourclip",!0).attr("id",ne),se.exit().remove(),J.connectgaps===!1){var oe={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:U.xaxis,yaxis:U.yaxis,x:B.x,y:B.y,z:i(B),smoothing:0};r([oe]),g([oe]),h([oe],{type:"levels"}),v.ensureSingle(se,"path","").attr("d",(oe.prefixBoundary?"M"+K.join("L")+"Z":"")+p(oe,K))}else ne=null;w.setClipUrl(N,ne,te)}(A,f,x,I,re)})},Y.createLines=function(x,f,_){var b=_[0].smoothing,T=x.selectAll("g.contourlevel").data(f?_:[]);if(T.exit().remove(),T.enter().append("g").classed("contourlevel",!0),f){var k=T.selectAll("path.openline").data(function(A){return A.pedgepaths||A.edgepaths});k.exit().remove(),k.enter().append("path").classed("openline",!0),k.attr("d",function(A){return w.smoothopen(A,b)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var L=T.selectAll("path.closedline").data(function(A){return A.ppaths||A.paths});L.exit().remove(),L.enter().append("path").classed("closedline",!0),L.attr("d",function(A){return w.smoothclosed(A,b)}).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return T},Y.createLineClip=function(x,f,_,b){var T=f?"clipline"+b:null,k=_._fullLayout._clips.selectAll("#"+T).data(f?[0]:[]);return k.exit().remove(),k.enter().append("clipPath").classed("contourlineclip",!0).attr("id",T),w.setClipUrl(x,T,_),k},Y.labelFormatter=function(x,f){var _=x._fullLayout,b=f.trace,T=b.contours,k={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(T.labelformat)k.tickformat=T.labelformat,n(k,_);else{var L=y.extractOpts(b);if(L&&L.colorbar&&L.colorbar._axis)k=L.colorbar._axis;else{if(T.type==="constraint"){var A=T.value;Array.isArray(A)?k.range=[A[0],A[A.length-1]]:k.range=[A,A]}else k.range=[T.start,T.end],k.nticks=(T.end-T.start)/T.size;k.range[0]===k.range[1]&&(k.range[1]+=k.range[0]||1),k.nticks||(k.nticks=1e3),n(k,_),t.prepTicks(k),k._tmin=null,k._tmax=null}}return function(I){return t.tickText(k,I).text}},Y.calcTextOpts=function(x,f,_,b){var T=f(x);_.text(T).call(e.convertToTspans,b);var k=_.node(),L=w.bBox(k,!0);return{text:T,width:L.width,height:L.height,fontSize:+k.style["font-size"].replace("px",""),level:x,dy:(L.top+L.bottom)/2}},Y.findBestTextLocation=function(x,f,_,b,T){var k,L,A,I,P,S=_.width;f.isClosed?(L=f.len/s.INITIALSEARCHPOINTS,k=f.min+L/2,A=f.max):(L=(f.len-S)/(s.INITIALSEARCHPOINTS+1),k=f.min+L+S/2,A=f.max-(L+S)/2);for(var E=1/0,z=0;z<s.ITERATIONS;z++){for(var D=k;D<A;D+=L){var j=v.getTextLocation(x,f.total,D,S),V=u(j,_,b,T);V<E&&(E=V,P=j,I=D)}if(E>2*s.MAXCOST)break;z&&(L/=2),A=(k=I-L/2)+1.5*L}if(E<=s.MAXCOST)return P},Y.addLabelData=function(x,f,_,b){var T=f.fontSize,k=f.width+T/3,L=Math.max(0,f.height-T/3),A=x.x,I=x.y,P=x.theta,S=Math.sin(P),E=Math.cos(P),z=function(j,V){return[A+j*E-V*S,I+j*S+V*E]},D=[z(-k/2,-L/2),z(-k/2,L/2),z(k/2,L/2),z(k/2,-L/2)];_.push({text:f.text,x:A,y:I,dy:f.dy,theta:P,level:f.level,width:k,height:L}),b.push(D)},Y.drawLabels=function(x,f,_,b,T){var k=x.selectAll("text").data(f,function(I){return I.text+","+I.x+","+I.y+","+I.theta});if(k.exit().remove(),k.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each(function(I){var P=I.x+Math.sin(I.theta)*I.dy,S=I.y-Math.cos(I.theta)*I.dy;d.select(this).text(I.text).attr({x:P,y:S,transform:"rotate("+180*I.theta/Math.PI+" "+P+" "+S+")"}).call(e.convertToTspans,_)}),T){for(var L="",A=0;A<T.length;A++)L+="M"+T[A].join("L")+"Z";v.ensureSingle(b,"path","").attr("d",L)}}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/set_convert":585,"../heatmap/plot":813,"./close_boundaries":746,"./constants":748,"./convert_to_constraints":752,"./empty_pathinfo":754,"./find_all_paths":756,"./make_crossings":761,"@plotly/d3":58}],763:[function(m,G,Y){var d=m("../../plots/cartesian/axes"),v=m("../../lib");function w(y,e,t){var n={type:"linear",range:[y,e]};return d.autoTicks(n,(e-y)/(t||15)),n}G.exports=function(y,e){var t=y.contours;if(y.autocontour){var n=y.zmin,o=y.zmax;(y.zauto||n===void 0)&&(n=v.aggNums(Math.min,null,e)),(y.zauto||o===void 0)&&(o=v.aggNums(Math.max,null,e));var r=w(n,o,y.ncontours);t.size=r.dtick,t.start=d.tickFirst(r),r.range.reverse(),t.end=d.tickFirst(r),t.start===n&&(t.start+=t.size),t.end===o&&(t.end-=t.size),t.start>t.end&&(t.start=t.end=(t.start+t.end)/2),y._input.contours||(y._input.contours={}),v.extendFlat(y._input.contours,{start:t.start,end:t.end,size:t.size}),y._input.autocontour=!0}else if(t.type!=="constraint"){var g,c=t.start,a=t.end,h=y._input.contours;c>a&&(t.start=h.start=a,a=t.end=h.end=c,c=t.start),!(t.size>0)&&(g=c===a?1:w(c,a,y.ncontours).dtick,h.size=t.size=g)}}},{"../../lib":515,"../../plots/cartesian/axes":566}],764:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../components/drawing"),w=m("../heatmap/style"),y=m("./make_color_map");G.exports=function(e){var t=d.select(e).selectAll("g.contour");t.style("opacity",function(n){return n[0].trace.opacity}),t.each(function(n){var o=d.select(this),r=n[0].trace,g=r.contours,c=r.line,a=g.size||1,h=g.start,l=g.type==="constraint",s=!l&&g.coloring==="lines",p=!l&&g.coloring==="fill",u=s||p?y(r):null;o.selectAll("g.contourlevel").each(function(f){d.select(this).selectAll("path").call(v.lineGroupStyle,c.width,s?u(f.level):c.color,c.dash)});var i=g.labelfont;if(o.selectAll("g.contourlabels text").each(function(f){v.font(d.select(this),{family:i.family,size:i.size,color:i.color||(s?u(f.level):c.color)})}),l)o.selectAll("g.contourfill path").style("fill",r.fillcolor);else if(p){var x;o.selectAll("g.contourfill path").style("fill",function(f){return x===void 0&&(x=f.level),u(f.level+.5*a)}),x===void 0&&(x=h),o.selectAll("g.contourbg path").style("fill",u(x-.5*a))}}),w(e)}},{"../../components/drawing":389,"../heatmap/style":814,"./make_color_map":760,"@plotly/d3":58}],765:[function(m,G,Y){var d=m("../../components/colorscale/defaults"),v=m("./label_defaults");G.exports=function(w,y,e,t,n){var o,r=e("contours.coloring"),g="";r==="fill"&&(o=e("contours.showlines")),o!==!1&&(r!=="lines"&&(g=e("line.color","#000")),e("line.width",.5),e("line.dash")),r!=="none"&&(w.showlegend!==!0&&(y.showlegend=!1),y._dfltShowLegend=!1,d(w,y,t,e,{prefix:"",cLetter:"z"})),e("line.smoothing"),v(e,t,g,n)}},{"../../components/colorscale/defaults":377,"./label_defaults":759}],766:[function(m,G,Y){var d=m("../heatmap/attributes"),v=m("../contour/attributes"),w=m("../../components/colorscale/attributes"),y=m("../../lib/extend").extendFlat,e=v.contours;G.exports=y({carpet:{valType:"string",editType:"calc"},z:d.z,a:d.x,a0:d.x0,da:d.dx,b:d.y,b0:d.y0,db:d.dy,text:d.text,hovertext:d.hovertext,transpose:d.transpose,atype:d.xtype,btype:d.ytype,fillcolor:v.fillcolor,autocontour:v.autocontour,ncontours:v.ncontours,contours:{type:e.type,start:e.start,end:e.end,size:e.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:e.showlines,showlabels:e.showlabels,labelfont:e.labelfont,labelformat:e.labelformat,operation:e.operation,value:e.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:v.line.color,width:v.line.width,dash:v.line.dash,smoothing:v.line.smoothing,editType:"plot"},transforms:void 0},w("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../contour/attributes":744,"../heatmap/attributes":801}],767:[function(m,G,Y){var d=m("../../components/colorscale/calc"),v=m("../../lib"),w=m("../heatmap/convert_column_xyz"),y=m("../heatmap/clean_2d_array"),e=m("../heatmap/interp2d"),t=m("../heatmap/find_empties"),n=m("../heatmap/make_bound_array"),o=m("./defaults"),r=m("../carpet/lookup_carpetid"),g=m("../contour/set_contours");G.exports=function(c,a){var h=a._carpetTrace=r(c,a);if(h&&h.visible&&h.visible!=="legendonly"){if(!a.a||!a.b){var l=c.data[h.index],s=c.data[a.index];s.a||(s.a=l.a),s.b||(s.b=l.b),o(s,a,a._defaultColor,c._fullLayout)}var p=function(u,i){var x,f,_,b,T,k,L,A=i._carpetTrace,I=A.aaxis,P=A.baxis;I._minDtick=0,P._minDtick=0,v.isArray1D(i.z)&&w(i,I,P,"a","b",["z"]),x=i._a=i._a||i.a,b=i._b=i._b||i.b,x=x?I.makeCalcdata(i,"_a"):[],b=b?P.makeCalcdata(i,"_b"):[],f=i.a0||0,_=i.da||1,T=i.b0||0,k=i.db||1,L=i._z=y(i._z||i.z,i.transpose),i._emptypoints=t(L),e(L,i._emptypoints);var S=v.maxRowLength(L),E=i.xtype==="scaled"?"":x,z=n(i,E,f,_,S,I),D=i.ytype==="scaled"?"":b,j=n(i,D,T,k,L.length,P),V={a:z,b:j,z:L};return i.contours.type==="levels"&&i.contours.coloring!=="none"&&d(u,i,{vals:L,containerStr:"",cLetter:"z"}),[V]}(c,a);return g(a,a._z),p}}},{"../../components/colorscale/calc":375,"../../lib":515,"../carpet/lookup_carpetid":717,"../contour/set_contours":763,"../heatmap/clean_2d_array":803,"../heatmap/convert_column_xyz":805,"../heatmap/find_empties":807,"../heatmap/interp2d":810,"../heatmap/make_bound_array":812,"./defaults":768}],768:[function(m,G,Y){var d=m("../../lib"),v=m("../heatmap/xyz_defaults"),w=m("./attributes"),y=m("../contour/constraint_defaults"),e=m("../contour/contours_defaults"),t=m("../contour/style_defaults");G.exports=function(n,o,r,g){function c(a,h){return d.coerce(n,o,w,a,h)}if(c("carpet"),n.a&&n.b){if(!v(n,o,c,g,"a","b"))return void(o.visible=!1);c("text"),c("contours.type")==="constraint"?y(n,o,c,g,r,{hasHover:!1}):(e(n,o,c,function(a){return d.coerce2(n,o,w,a)}),t(n,o,c,g,{hasHover:!1}))}else o._defaultColor=r,o._length=null}},{"../../lib":515,"../contour/constraint_defaults":749,"../contour/contours_defaults":751,"../contour/style_defaults":765,"../heatmap/xyz_defaults":816,"./attributes":766}],769:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../contour/colorbar"),calc:m("./calc"),plot:m("./plot"),style:m("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":578,"../contour/colorbar":747,"../contour/style":764,"./attributes":766,"./calc":767,"./defaults":768,"./plot":770}],770:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../carpet/map_1d_array"),w=m("../carpet/makepath"),y=m("../../components/drawing"),e=m("../../lib"),t=m("../contour/make_crossings"),n=m("../contour/find_all_paths"),o=m("../contour/plot"),r=m("../contour/constants"),g=m("../contour/convert_to_constraints"),c=m("../contour/empty_pathinfo"),a=m("../contour/close_boundaries"),h=m("../carpet/lookup_carpetid"),l=m("../carpet/axis_aligned_line");function s(i,x,f){var _=i.getPointAtLength(x),b=i.getPointAtLength(f),T=b.x-_.x,k=b.y-_.y,L=Math.sqrt(T*T+k*k);return[T/L,k/L]}function p(i){var x=Math.sqrt(i[0]*i[0]+i[1]*i[1]);return[i[0]/x,i[1]/x]}function u(i,x){var f=Math.abs(i[0]*x[0]+i[1]*x[1]);return Math.sqrt(1-f*f)/f}G.exports=function(i,x,f,_){var b=x.xaxis,T=x.yaxis;e.makeTraceGroups(_,f,"contour").each(function(k){var L=d.select(this),A=k[0],I=A.trace,P=I._carpetTrace=h(i,I),S=i.calcdata[P.index][0];if(P.visible&&P.visible!=="legendonly"){var E=A.a,z=A.b,D=I.contours,j=c(D,x,A),V=D.type==="constraint",Z=D._operation,Q=V?Z==="="?"lines":"fill":D.coloring,X=[[E[0],z[z.length-1]],[E[E.length-1],z[z.length-1]],[E[E.length-1],z[0]],[E[0],z[0]]];t(j);var $=1e-8*(E[E.length-1]-E[0]),re=1e-8*(z[z.length-1]-z[0]);n(j,$,re);var H,N,U,te,B=j;D.type==="constraint"&&(B=g(j,Z)),function(ne,se){var oe,me,ce,ye,Se,fe,ge,Te,le;for(oe=0;oe<ne.length;oe++){for(ye=ne[oe],Se=ye.pedgepaths=[],fe=ye.ppaths=[],me=0;me<ye.edgepaths.length;me++){for(le=ye.edgepaths[me],ge=[],ce=0;ce<le.length;ce++)ge[ce]=se(le[ce]);Se.push(ge)}for(me=0;me<ye.paths.length;me++){for(le=ye.paths[me],Te=[],ce=0;ce<le.length;ce++)Te[ce]=se(le[ce]);fe.push(Te)}}}(j,ee);var K=[];for(te=S.clipsegments.length-1;te>=0;te--)H=S.clipsegments[te],N=v([],H.x,b.c2p),U=v([],H.y,T.c2p),N.reverse(),U.reverse(),K.push(w(N,U,H.bicubic));var J="M"+K.join("L")+"Z";(function(ne,se,oe,me,ce,ye){var Se,fe,ge,Te,le=e.ensureSingle(ne,"g","contourbg").selectAll("path").data(ye!=="fill"||ce?[]:[0]);le.enter().append("path"),le.exit().remove();var ve=[];for(Te=0;Te<se.length;Te++)Se=se[Te],fe=v([],Se.x,oe.c2p),ge=v([],Se.y,me.c2p),ve.push(w(fe,ge,Se.bicubic));le.attr("d","M"+ve.join("L")+"Z").style("stroke","none")})(L,S.clipsegments,b,T,V,Q),function(ne,se,oe,me,ce,ye,Se,fe,ge,Te,le){var ve=Te==="fill";ve&&a(ce,ne.contours);var Me=e.ensureSingle(se,"g","contourfill").selectAll("path").data(ve?ce:[]);Me.enter().append("path"),Me.exit().remove(),Me.each(function(we){var de=(we.prefixBoundary?le:"")+function(Ie,De,Oe,Ve,Fe,ze,Re,We){var $e,at,gt,xt,mt,nt,Qe,vt="",jt=De.edgepaths.map(function(He,Je){return Je}),Gt=!0,$t=1e-4*Math.abs(Oe[0][0]-Oe[2][0]),Zt=1e-4*Math.abs(Oe[0][1]-Oe[2][1]);function cr(He){return Math.abs(He[1]-Oe[0][1])<Zt}function Dt(He){return Math.abs(He[1]-Oe[2][1])<Zt}function Ne(He){return Math.abs(He[0]-Oe[0][0])<$t}function Ye(He){return Math.abs(He[0]-Oe[2][0])<$t}function pe(He,Je){var Ze,ct,lt,At,Ot="";for(cr(He)&&!Ye(He)||Dt(He)&&!Ne(He)?(At=Fe.aaxis,lt=l(Fe,ze,[He[0],Je[0]],.5*(He[1]+Je[1]))):(At=Fe.baxis,lt=l(Fe,ze,.5*(He[0]+Je[0]),[He[1],Je[1]])),Ze=1;Ze<lt.length;Ze++)for(Ot+=At.smoothing?"C":"L",ct=0;ct<lt[Ze].length;ct++){var it=lt[Ze][ct];Ot+=[Re.c2p(it[0]),We.c2p(it[1])]+" "}return Ot}for($e=0,at=null;jt.length;){var _e=De.edgepaths[$e][0];for(at&&(vt+=pe(at,_e)),Qe=y.smoothopen(De.edgepaths[$e].map(Ve),De.smoothing),vt+=Gt?Qe:Qe.replace(/^M/,"L"),jt.splice(jt.indexOf($e),1),at=De.edgepaths[$e][De.edgepaths[$e].length-1],mt=-1,xt=0;xt<4;xt++){if(!at){e.log("Missing end?",$e,De);break}for(cr(at)&&!Ye(at)?gt=Oe[1]:Ne(at)?gt=Oe[0]:Dt(at)?gt=Oe[3]:Ye(at)&&(gt=Oe[2]),nt=0;nt<De.edgepaths.length;nt++){var Be=De.edgepaths[nt][0];Math.abs(at[0]-gt[0])<$t?Math.abs(at[0]-Be[0])<$t&&(Be[1]-at[1])*(gt[1]-Be[1])>=0&&(gt=Be,mt=nt):Math.abs(at[1]-gt[1])<Zt?Math.abs(at[1]-Be[1])<Zt&&(Be[0]-at[0])*(gt[0]-Be[0])>=0&&(gt=Be,mt=nt):e.log("endpt to newendpt is not vert. or horz.",at,gt,Be)}if(mt>=0)break;vt+=pe(at,gt),at=gt}if(mt===De.edgepaths.length){e.log("unclosed perimeter path");break}$e=mt,(Gt=jt.indexOf($e)===-1)&&($e=jt[0],vt+=pe(at,gt)+"Z",at=null)}for($e=0;$e<De.paths.length;$e++)vt+=y.smoothclosed(De.paths[$e].map(Ve),De.smoothing);return vt}(0,we,ye,Se,fe,ge,oe,me);de?d.select(this).attr("d",de).style("stroke","none"):d.select(this).remove()})}(I,L,b,T,B,X,ee,P,S,Q,J),function(ne,se,oe,me,ce,ye,Se){var fe=e.ensureSingle(ne,"g","contourlines"),ge=ce.showlines!==!1,Te=ce.showlabels,le=ge&&Te,ve=o.createLines(fe,ge||Te,se),Me=o.createLineClip(fe,le,oe,me.trace.uid),we=ne.selectAll("g.contourlabels").data(Te?[0]:[]);if(we.exit().remove(),we.enter().append("g").classed("contourlabels",!0),Te){var de=ye.xaxis,Ie=ye.yaxis,De=de._length,Oe=Ie._length,Ve=[[[0,0],[De,0],[De,Oe],[0,Oe]]],Fe=[];e.clearLocationCache();var ze=o.labelFormatter(oe,me),Re=y.tester.append("text").attr("data-notex",1).call(y.font,ce.labelfont),We={left:0,right:De,center:De/2,top:0,bottom:Oe,middle:Oe/2},$e=Math.sqrt(De*De+Oe*Oe),at=r.LABELDISTANCE*$e/Math.max(1,se.length/r.LABELINCREASE);ve.each(function(gt){var xt=o.calcTextOpts(gt.level,ze,Re,oe);d.select(this).selectAll("path").each(function(mt){var nt=e.getVisibleSegment(this,We,xt.height/2);if(nt&&(function(Gt,$t,Zt,cr,Dt,Ne){for(var Ye,pe=0;pe<Zt.pedgepaths.length;pe++)$t===Zt.pedgepaths[pe]&&(Ye=Zt.edgepaths[pe]);if(!Ye)return;var _e=Dt.a[0],Be=Dt.a[Dt.a.length-1],He=Dt.b[0],Je=Dt.b[Dt.b.length-1];function Ze(it,ht){var Ut,Mt=0;return(Math.abs(it[0]-_e)<.1||Math.abs(it[0]-Be)<.1)&&(Ut=p(Dt.dxydb_rough(it[0],it[1],.1)),Mt=Math.max(Mt,Ne*u(ht,Ut)/2)),(Math.abs(it[1]-He)<.1||Math.abs(it[1]-Je)<.1)&&(Ut=p(Dt.dxyda_rough(it[0],it[1],.1)),Mt=Math.max(Mt,Ne*u(ht,Ut)/2)),Mt}var ct=s(Gt,0,1),lt=s(Gt,cr.total,cr.total-1),At=Ze(Ye[0],ct),Ot=cr.total-Ze(Ye[Ye.length-1],lt);cr.min<At&&(cr.min=At),cr.max>Ot&&(cr.max=Ot),cr.len=cr.max-cr.min}(this,mt,gt,nt,Se,xt.height),!(nt.len<(xt.width+xt.height)*r.LABELMIN)))for(var Qe=Math.min(Math.ceil(nt.len/at),r.LABELMAX),vt=0;vt<Qe;vt++){var jt=o.findBestTextLocation(this,nt,xt,Fe,We);if(!jt)break;o.addLabelData(jt,xt,Fe,Ve)}})}),Re.remove(),o.drawLabels(we,Fe,oe,Me,le?Ve:null)}Te&&!ge&&ve.remove()}(L,j,i,A,D,x,P),y.setClipUrl(L,P._clipPathId,i)}function ee(ne){var se=P.ab2xy(ne[0],ne[1],!0);return[b.c2p(se[0]),T.c2p(se[1])]}})}},{"../../components/drawing":389,"../../lib":515,"../carpet/axis_aligned_line":701,"../carpet/lookup_carpetid":717,"../carpet/makepath":718,"../carpet/map_1d_array":719,"../contour/close_boundaries":746,"../contour/constants":748,"../contour/convert_to_constraints":752,"../contour/empty_pathinfo":754,"../contour/find_all_paths":756,"../contour/make_crossings":761,"../contour/plot":762,"@plotly/d3":58}],771:[function(m,G,Y){var d=m("../../components/colorscale/attributes"),v=m("../../plots/template_attributes").hovertemplateAttrs,w=m("../../plots/attributes"),y=m("../scattermapbox/attributes"),e=m("../../lib/extend").extendFlat;G.exports=e({lon:y.lon,lat:y.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:y.text,hovertext:y.hovertext,hoverinfo:e({},w.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:v(),showlegend:e({},w.showlegend,{dflt:!1})},d("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scattermapbox/attributes":1002}],772:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../lib").isArrayOrTypedArray,w=m("../../constants/numerical").BADNUM,y=m("../../components/colorscale/calc"),e=m("../../lib")._;G.exports=function(t,n){for(var o=n._length,r=new Array(o),g=n.z,c=v(g)&&g.length,a=0;a<o;a++){var h=r[a]={},l=n.lon[a],s=n.lat[a];if(h.lonlat=d(l)&&d(s)?[+l,+s]:[w,w],c){var p=g[a];h.z=d(p)?p:w}}return y(t,n,{vals:c?g:[0,1],containerStr:"",cLetter:"z"}),o&&(r[0].t={labels:{lat:e(t,"lat:")+" ",lon:e(t,"lon:")+" "}}),r}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],773:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("../../components/color"),y=m("../../components/colorscale"),e=m("../../constants/numerical").BADNUM,t=m("../../lib/geojson_utils").makeBlank;G.exports=function(n){var o=n[0].trace,r=o.visible===!0&&o._length!==0,g=o._opts={heatmap:{layout:{visibility:"none"},paint:{}},geojson:t()};if(!r)return g;var c,a=[],h=o.z,l=o.radius,s=v.isArrayOrTypedArray(h)&&h.length,p=v.isArrayOrTypedArray(l);for(c=0;c<n.length;c++){var u=n[c],i=u.lonlat;if(i[0]!==e){var x={};if(s){var f=u.z;x.z=f!==e?f:0}p&&(x.r=d(l[c])&&l[c]>0?+l[c]:0),a.push({type:"Feature",geometry:{type:"Point",coordinates:i},properties:x})}}var _=y.extractOpts(o),b=_.reversescale?y.flipScale(_.colorscale):_.colorscale,T=b[0][1],k=["interpolate",["linear"],["heatmap-density"],0,w.opacity(T)<1?T:w.addOpacity(T,0)];for(c=1;c<b.length;c++)k.push(b[c][0],b[c][1]);var L=["interpolate",["linear"],["get","z"],_.min,0,_.max,1];return v.extendFlat(g.heatmap.paint,{"heatmap-weight":s?L:1/(_.max-_.min),"heatmap-color":k,"heatmap-radius":p?{type:"identity",property:"r"}:o.radius,"heatmap-opacity":o.opacity}),g.geojson={type:"FeatureCollection",features:a},g.heatmap.layout.visibility="visible",g}},{"../../components/color":367,"../../components/colorscale":379,"../../constants/numerical":491,"../../lib":515,"../../lib/geojson_utils":509,"fast-isnumeric":190}],774:[function(m,G,Y){var d=m("../../lib"),v=m("../../components/colorscale/defaults"),w=m("./attributes");G.exports=function(y,e,t,n){function o(a,h){return d.coerce(y,e,w,a,h)}var r=o("lon")||[],g=o("lat")||[],c=Math.min(r.length,g.length);c?(e._length=c,o("z"),o("radius"),o("below"),o("text"),o("hovertext"),o("hovertemplate"),v(y,e,n,o,{prefix:"",cLetter:"z"})):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":771}],775:[function(m,G,Y){G.exports=function(d,v){return d.lon=v.lon,d.lat=v.lat,d.z=v.z,d}},{}],776:[function(m,G,Y){var d=m("../../plots/cartesian/axes"),v=m("../scattermapbox/hover").hoverPoints,w=m("../scattermapbox/hover").getExtraText;G.exports=function(y,e,t){var n=v(y,e,t);if(n){var o=n[0],r=o.cd,g=r[0].trace,c=r[o.index];if(delete o.color,"z"in c){var a=o.subplot.mockAxis;o.z=c.z,o.zLabel=d.tickText(a,a.c2l(c.z),"hover").text}return o.extraText=w(g,c,r[0].t.labels),[o]}}},{"../../plots/cartesian/axes":566,"../scattermapbox/hover":1007}],777:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../heatmap/colorbar"),formatLabels:m("../scattermapbox/format_labels"),calc:m("./calc"),plot:m("./plot"),hoverPoints:m("./hover"),eventData:m("./event_data"),getBelow:function(d,v){for(var w=v.getMapLayers(),y=0;y<w.length;y++){var e=w[y],t=e.id;if(e.type==="symbol"&&typeof t=="string"&&t.indexOf("plotly-")===-1)return t}},moduleType:"trace",name:"densitymapbox",basePlotModule:m("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":622,"../heatmap/colorbar":804,"../scattermapbox/format_labels":1006,"./attributes":771,"./calc":772,"./defaults":774,"./event_data":775,"./hover":776,"./plot":778}],778:[function(m,G,Y){var d=m("./convert"),v=m("../../plots/mapbox/constants").traceLayerPrefix;function w(e,t){this.type="densitymapbox",this.subplot=e,this.uid=t,this.sourceId="source-"+t,this.layerList=[["heatmap",v+t+"-heatmap"]],this.below=null}var y=w.prototype;y.update=function(e){var t=this.subplot,n=this.layerList,o=d(e),r=t.belowLookup["trace-"+this.uid];t.map.getSource(this.sourceId).setData(o.geojson),r!==this.below&&(this._removeLayers(),this._addLayers(o,r),this.below=r);for(var g=0;g<n.length;g++){var c=n[g],a=c[0],h=c[1],l=o[a];t.setOptions(h,"setLayoutProperty",l.layout),l.layout.visibility==="visible"&&t.setOptions(h,"setPaintProperty",l.paint)}},y._addLayers=function(e,t){for(var n=this.subplot,o=this.layerList,r=this.sourceId,g=0;g<o.length;g++){var c=o[g],a=c[0],h=e[a];n.addLayer({type:a,id:c[1],source:r,layout:h.layout,paint:h.paint},t)}},y._removeLayers=function(){for(var e=this.subplot.map,t=this.layerList,n=t.length-1;n>=0;n--)e.removeLayer(t[n][1])},y.dispose=function(){var e=this.subplot.map;this._removeLayers(),e.removeSource(this.sourceId)},G.exports=function(e,t){var n=t[0].trace,o=new w(e,n.uid),r=o.sourceId,g=d(t),c=o.below=e.belowLookup["trace-"+n.uid];return e.map.addSource(r,{type:"geojson",data:g.geojson}),o._addLayers(g,c),o}},{"../../plots/mapbox/constants":620,"./convert":773}],779:[function(m,G,Y){var d=m("../../lib");G.exports=function(v,w){for(var y=0;y<v.length;y++)v[y].i=y;d.mergeArray(w.text,v,"tx"),d.mergeArray(w.hovertext,v,"htx");var e=w.marker;if(e){d.mergeArray(e.opacity,v,"mo"),d.mergeArray(e.color,v,"mc");var t=e.line;t&&(d.mergeArray(t.color,v,"mlc"),d.mergeArrayCastPositive(t.width,v,"mlw"))}}},{"../../lib":515}],780:[function(m,G,Y){var d,v=m("../bar/attributes"),w=m("../scatter/attributes").line,y=m("../../plots/attributes"),e=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,t=m("../../plots/template_attributes").hovertemplateAttrs,n=m("../../plots/template_attributes").texttemplateAttrs,o=m("./constants"),r=m("../../lib/extend").extendFlat,g=m("../../components/color");G.exports={x:v.x,x0:v.x0,dx:v.dx,y:v.y,y0:v.y0,dy:v.dy,xperiod:v.xperiod,yperiod:v.yperiod,xperiod0:v.xperiod0,yperiod0:v.yperiod0,xperiodalignment:v.xperiodalignment,yperiodalignment:v.yperiodalignment,xhoverformat:e("x"),yhoverformat:e("y"),hovertext:v.hovertext,hovertemplate:t({},{keys:o.eventDataKeys}),hoverinfo:r({},y.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:n({editType:"plot"},{keys:o.eventDataKeys.concat(["label","value"])}),text:v.text,textposition:v.textposition,insidetextanchor:r({},v.insidetextanchor,{dflt:"middle"}),textangle:r({},v.textangle,{dflt:0}),textfont:v.textfont,insidetextfont:v.insidetextfont,outsidetextfont:v.outsidetextfont,constraintext:v.constraintext,cliponaxis:v.cliponaxis,orientation:r({},v.orientation,{}),offset:r({},v.offset,{arrayOk:!1}),width:r({},v.width,{arrayOk:!1}),marker:(d=r({},v.marker),delete d.pattern,d),connector:{fillcolor:{valType:"color",editType:"style"},line:{color:r({},w.color,{dflt:g.defaultLine}),width:r({},w.width,{dflt:0,editType:"plot"}),dash:w.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:v.offsetgroup,alignmentgroup:v.alignmentgroup}},{"../../components/color":367,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936,"./constants":782}],781:[function(m,G,Y){var d=m("../../plots/cartesian/axes"),v=m("../../plots/cartesian/align_period"),w=m("./arrays_to_calcdata"),y=m("../scatter/calc_selection"),e=m("../../constants/numerical").BADNUM;function t(n){return n===e?0:n}G.exports=function(n,o){var r,g,c,a,h,l,s,p,u=d.getFromId(n,o.xaxis||"x"),i=d.getFromId(n,o.yaxis||"y");o.orientation==="h"?(r=u.makeCalcdata(o,"x"),c=i.makeCalcdata(o,"y"),a=v(o,i,"y",c),h=!!o.yperiodalignment,l="y"):(r=i.makeCalcdata(o,"y"),c=u.makeCalcdata(o,"x"),a=v(o,u,"x",c),h=!!o.xperiodalignment,l="x"),g=a.vals;var x,f=Math.min(g.length,r.length),_=new Array(f);for(o._base=[],s=0;s<f;s++){r[s]<0&&(r[s]=e);var b=!1;r[s]!==e&&s+1<f&&r[s+1]!==e&&(b=!0),p=_[s]={p:g[s],s:r[s],cNext:b},o._base[s]=-.5*p.s,h&&(_[s].orig_p=c[s],_[s][l+"End"]=a.ends[s],_[s][l+"Start"]=a.starts[s]),o.ids&&(p.id=String(o.ids[s])),s===0&&(_[0].vTotal=0),_[0].vTotal+=t(p.s),p.begR=t(p.s)/t(_[0].s)}for(s=0;s<f;s++)(p=_[s]).s!==e&&(p.sumR=p.s/_[0].vTotal,p.difR=x!==void 0?p.s/x:1,x=p.s);return w(_,o),y(_,o),_}},{"../../constants/numerical":491,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938,"./arrays_to_calcdata":779}],782:[function(m,G,Y){G.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],783:[function(m,G,Y){var d=m("../bar/cross_trace_calc").setGroupPositions;G.exports=function(v,w){var y,e,t=v._fullLayout,n=v._fullData,o=v.calcdata,r=w.xaxis,g=w.yaxis,c=[],a=[],h=[];for(e=0;e<n.length;e++){var l=n[e],s=l.orientation==="h";l.visible===!0&&l.xaxis===r._id&&l.yaxis===g._id&&l.type==="funnel"&&(y=o[e],s?h.push(y):a.push(y),c.push(y))}var p={mode:t.funnelmode,norm:t.funnelnorm,gap:t.funnelgap,groupgap:t.funnelgroupgap};for(d(v,r,g,a,p),d(v,g,r,h,p),e=0;e<c.length;e++){y=c[e];for(var u=0;u<y.length;u++)u+1<y.length&&(y[u].nextP0=y[u+1].p0,y[u].nextS0=y[u+1].s0,y[u].nextP1=y[u+1].p1,y[u].nextS1=y[u+1].s1)}}},{"../bar/cross_trace_calc":660}],784:[function(m,G,Y){var d=m("../../lib"),v=m("../bar/defaults").handleGroupingDefaults,w=m("../bar/defaults").handleText,y=m("../scatter/xy_defaults"),e=m("../scatter/period_defaults"),t=m("./attributes"),n=m("../../components/color");G.exports={supplyDefaults:function(o,r,g,c){function a(p,u){return d.coerce(o,r,t,p,u)}if(y(o,r,c,a)){e(o,r,c,a),a("xhoverformat"),a("yhoverformat"),a("orientation",r.y&&!r.x?"v":"h"),a("offset"),a("width");var h=a("text");a("hovertext"),a("hovertemplate");var l=a("textposition");w(o,r,c,a,l,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),r.textposition==="none"||r.texttemplate||a("textinfo",Array.isArray(h)?"text+value":"value");var s=a("marker.color",g);a("marker.line.color",n.defaultLine),a("marker.line.width"),a("connector.visible")&&(a("connector.fillcolor",function(p){var u=d.isArrayOrTypedArray(p)?"#000":p;return n.addOpacity(u,.5*n.opacity(u))}(s)),a("connector.line.width")&&(a("connector.line.color"),a("connector.line.dash")))}else r.visible=!1},crossTraceDefaults:function(o,r){var g,c;function a(l){return d.coerce(c._input,c,t,l)}if(r.funnelmode==="group")for(var h=0;h<o.length;h++)g=(c=o[h])._input,v(g,c,r,a)}}},{"../../components/color":367,"../../lib":515,"../bar/defaults":661,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":780}],785:[function(m,G,Y){G.exports=function(d,v){return d.x="xVal"in v?v.xVal:v.x,d.y="yVal"in v?v.yVal:v.y,"percentInitial"in v&&(d.percentInitial=v.percentInitial),"percentPrevious"in v&&(d.percentPrevious=v.percentPrevious),"percentTotal"in v&&(d.percentTotal=v.percentTotal),v.xa&&(d.xaxis=v.xa),v.ya&&(d.yaxis=v.ya),d}},{}],786:[function(m,G,Y){var d=m("../../components/color").opacity,v=m("../bar/hover").hoverOnBars,w=m("../../lib").formatPercent;G.exports=function(y,e,t,n,o){var r=v(y,e,t,n,o);if(r){var g=r.cd,c=g[0].trace,a=c.orientation==="h",h=g[r.index];r[(a?"x":"y")+"LabelVal"]=h.s,r.percentInitial=h.begR,r.percentInitialLabel=w(h.begR,1),r.percentPrevious=h.difR,r.percentPreviousLabel=w(h.difR,1),r.percentTotal=h.sumR,r.percentTotalLabel=w(h.sumR,1);var l=h.hi||c.hoverinfo,s=[];if(l&&l!=="none"&&l!=="skip"){var p=l==="all",u=l.split("+"),i=function(x){return p||u.indexOf(x)!==-1};i("percent initial")&&s.push(r.percentInitialLabel+" of initial"),i("percent previous")&&s.push(r.percentPreviousLabel+" of previous"),i("percent total")&&s.push(r.percentTotalLabel+" of total")}return r.extraText=s.join("<br>"),r.color=function(x,f){var _=x.marker,b=f.mc||_.color,T=f.mlc||_.line.color,k=f.mlw||_.line.width;if(d(b))return b;if(d(T)&&k)return T}(c,h),[r]}}},{"../../components/color":367,"../../lib":515,"../bar/hover":664}],787:[function(m,G,Y){G.exports={attributes:m("./attributes"),layoutAttributes:m("./layout_attributes"),supplyDefaults:m("./defaults").supplyDefaults,crossTraceDefaults:m("./defaults").crossTraceDefaults,supplyLayoutDefaults:m("./layout_defaults"),calc:m("./calc"),crossTraceCalc:m("./cross_trace_calc"),plot:m("./plot"),style:m("./style").style,hoverPoints:m("./hover"),eventData:m("./event_data"),selectPoints:m("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:m("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../bar/select":669,"./attributes":780,"./calc":781,"./cross_trace_calc":783,"./defaults":784,"./event_data":785,"./hover":786,"./layout_attributes":788,"./layout_defaults":789,"./plot":790,"./style":791}],788:[function(m,G,Y){G.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],789:[function(m,G,Y){var d=m("../../lib"),v=m("./layout_attributes");G.exports=function(w,y,e){var t=!1;function n(g,c){return d.coerce(w,y,v,g,c)}for(var o=0;o<e.length;o++){var r=e[o];if(r.visible&&r.type==="funnel"){t=!0;break}}t&&(n("funnelmode"),n("funnelgap",.2),n("funnelgroupgap"))}},{"../../lib":515,"./layout_attributes":788}],790:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../components/drawing"),y=m("../../constants/numerical").BADNUM,e=m("../bar/plot"),t=m("../bar/uniform_text").clearMinTextSize;function n(o,r,g,c){var a=[],h=[],l=c?r:g,s=c?g:r;return a[0]=l.c2p(o.s0,!0),h[0]=s.c2p(o.p0,!0),a[1]=l.c2p(o.s1,!0),h[1]=s.c2p(o.p1,!0),a[2]=l.c2p(o.nextS0,!0),h[2]=s.c2p(o.nextP0,!0),a[3]=l.c2p(o.nextS1,!0),h[3]=s.c2p(o.nextP1,!0),c?[a,h]:[h,a]}G.exports=function(o,r,g,c){var a=o._fullLayout;t("funnel",a),function(h,l,s,p){var u=l.xaxis,i=l.yaxis;v.makeTraceGroups(p,s,"trace bars").each(function(x){var f=d.select(this),_=x[0].trace,b=v.ensureSingle(f,"g","regions");if(_.connector&&_.connector.visible){var T=_.orientation==="h",k=b.selectAll("g.region").data(v.identity);k.enter().append("g").classed("region",!0),k.exit().remove();var L=k.size();k.each(function(A,I){if(I===L-1||A.cNext){var P=n(A,u,i,T),S=P[0],E=P[1],z="";S[0]!==y&&E[0]!==y&&S[1]!==y&&E[1]!==y&&S[2]!==y&&E[2]!==y&&S[3]!==y&&E[3]!==y&&(z+=T?"M"+S[0]+","+E[1]+"L"+S[2]+","+E[2]+"H"+S[3]+"L"+S[1]+","+E[1]+"Z":"M"+S[1]+","+E[1]+"L"+S[2]+","+E[3]+"V"+E[2]+"L"+S[1]+","+E[0]+"Z"),z===""&&(z="M0,0Z"),v.ensureSingle(d.select(this),"path").attr("d",z).call(w.setClipUrl,l.layerClipId,h)}})}else b.remove()})}(o,r,g,c),function(h,l,s,p){var u=l.xaxis,i=l.yaxis;v.makeTraceGroups(p,s,"trace bars").each(function(x){var f=d.select(this),_=x[0].trace,b=v.ensureSingle(f,"g","lines");if(_.connector&&_.connector.visible&&_.connector.line.width){var T=_.orientation==="h",k=b.selectAll("g.line").data(v.identity);k.enter().append("g").classed("line",!0),k.exit().remove();var L=k.size();k.each(function(A,I){if(I===L-1||A.cNext){var P=n(A,u,i,T),S=P[0],E=P[1],z="";S[3]!==void 0&&E[3]!==void 0&&(T?(z+="M"+S[0]+","+E[1]+"L"+S[2]+","+E[2],z+="M"+S[1]+","+E[1]+"L"+S[3]+","+E[2]):(z+="M"+S[1]+","+E[1]+"L"+S[2]+","+E[3],z+="M"+S[1]+","+E[0]+"L"+S[2]+","+E[2])),z===""&&(z="M0,0Z"),v.ensureSingle(d.select(this),"path").attr("d",z).call(w.setClipUrl,l.layerClipId,h)}})}else b.remove()})}(o,r,g,c),e.plot(o,r,g,c,{mode:a.funnelmode,norm:a.funnelmode,gap:a.funnelgap,groupgap:a.funnelgroupgap})}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../bar/plot":668,"../bar/uniform_text":673,"@plotly/d3":58}],791:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../components/drawing"),w=m("../../components/color"),y=m("../../constants/interactions").DESELECTDIM,e=m("../bar/style"),t=m("../bar/uniform_text").resizeText,n=e.styleTextPoints;G.exports={style:function(o,r,g){var c=g||d.select(o).selectAll("g.funnellayer").selectAll("g.trace");t(o,c,"funnel"),c.style("opacity",function(a){return a[0].trace.opacity}),c.each(function(a){var h=d.select(this),l=a[0].trace;h.selectAll(".point > path").each(function(s){if(!s.isBlank){var p=l.marker;d.select(this).call(w.fill,s.mc||p.color).call(w.stroke,s.mlc||p.line.color).call(v.dashLine,p.line.dash,s.mlw||p.line.width).style("opacity",l.selectedpoints&&!s.selected?y:1)}}),n(h,l,o),h.selectAll(".regions").each(function(){d.select(this).selectAll("path").style("stroke-width",0).call(w.fill,l.connector.fillcolor)}),h.selectAll(".lines").each(function(){var s=l.connector.line;v.lineGroupStyle(d.select(this).selectAll("path"),s.width,s.color,s.dash)})})}}},{"../../components/color":367,"../../components/drawing":389,"../../constants/interactions":490,"../bar/style":671,"../bar/uniform_text":673,"@plotly/d3":58}],792:[function(m,G,Y){var d=m("../pie/attributes"),v=m("../../plots/attributes"),w=m("../../plots/domain").attributes,y=m("../../plots/template_attributes").hovertemplateAttrs,e=m("../../plots/template_attributes").texttemplateAttrs,t=m("../../lib/extend").extendFlat;G.exports={labels:d.labels,label0:d.label0,dlabel:d.dlabel,values:d.values,marker:{colors:d.marker.colors,line:{color:t({},d.marker.line.color,{dflt:null}),width:t({},d.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:d.text,hovertext:d.hovertext,scalegroup:t({},d.scalegroup,{}),textinfo:t({},d.textinfo,{flags:["label","text","value","percent"]}),texttemplate:e({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:t({},v.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:y({},{keys:["label","color","value","text","percent"]}),textposition:t({},d.textposition,{values:["inside","none"],dflt:"inside"}),textfont:d.textfont,insidetextfont:d.insidetextfont,title:{text:d.title.text,font:d.title.font,position:t({},d.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:w({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910}],793:[function(m,G,Y){var d=m("../../plots/plots");Y.name="funnelarea",Y.plot=function(v,w,y,e){d.plotBasePlot(Y.name,v,w,y,e)},Y.clean=function(v,w,y,e){d.cleanBasePlot(Y.name,v,w,y,e)}},{"../../plots/plots":628}],794:[function(m,G,Y){var d=m("../pie/calc");G.exports={calc:function(v,w){return d.calc(v,w)},crossTraceCalc:function(v){d.crossTraceCalc(v,{type:"funnelarea"})}}},{"../pie/calc":912}],795:[function(m,G,Y){var d=m("../../lib"),v=m("./attributes"),w=m("../../plots/domain").defaults,y=m("../bar/defaults").handleText,e=m("../pie/defaults").handleLabelsAndValues;G.exports=function(t,n,o,r){function g(x,f){return d.coerce(t,n,v,x,f)}var c=g("labels"),a=g("values"),h=e(c,a),l=h.len;if(n._hasLabels=h.hasLabels,n._hasValues=h.hasValues,!n._hasLabels&&n._hasValues&&(g("label0"),g("dlabel")),l){n._length=l,g("marker.line.width")&&g("marker.line.color",r.paper_bgcolor),g("marker.colors"),g("scalegroup");var s,p=g("text"),u=g("texttemplate");if(u||(s=g("textinfo",Array.isArray(p)?"text+percent":"percent")),g("hovertext"),g("hovertemplate"),u||s&&s!=="none"){var i=g("textposition");y(t,n,r,g,i,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}w(n,r,g),g("title.text")&&(g("title.position"),d.coerceFont(g,"title.font",r.font)),g("aspectratio"),g("baseratio")}else n.visible=!1}},{"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"../pie/defaults":913,"./attributes":792}],796:[function(m,G,Y){G.exports={moduleType:"trace",name:"funnelarea",basePlotModule:m("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:m("./attributes"),layoutAttributes:m("./layout_attributes"),supplyDefaults:m("./defaults"),supplyLayoutDefaults:m("./layout_defaults"),calc:m("./calc").calc,crossTraceCalc:m("./calc").crossTraceCalc,plot:m("./plot"),style:m("./style"),styleOne:m("../pie/style_one"),meta:{}}},{"../pie/style_one":921,"./attributes":792,"./base_plot":793,"./calc":794,"./defaults":795,"./layout_attributes":797,"./layout_defaults":798,"./plot":799,"./style":800}],797:[function(m,G,Y){var d=m("../pie/layout_attributes").hiddenlabels;G.exports={hiddenlabels:d,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":917}],798:[function(m,G,Y){var d=m("../../lib"),v=m("./layout_attributes");G.exports=function(w,y){function e(t,n){return d.coerce(w,y,v,t,n)}e("hiddenlabels"),e("funnelareacolorway",y.colorway),e("extendfunnelareacolors")}},{"../../lib":515,"./layout_attributes":797}],799:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../components/drawing"),w=m("../../lib"),y=w.strScale,e=w.strTranslate,t=m("../../lib/svg_text_utils"),n=m("../bar/plot").toMoveInsideBar,o=m("../bar/uniform_text"),r=o.recordMinTextSize,g=o.clearMinTextSize,c=m("../pie/helpers"),a=m("../pie/plot"),h=a.attachFxHandlers,l=a.determineInsideTextFont,s=a.layoutAreas,p=a.prerenderTitles,u=a.positionTitleOutside,i=a.formatSliceLabel;function x(f,_){return"l"+(_[0]-f[0])+","+(_[1]-f[1])}G.exports=function(f,_){var b=f._context.staticPlot,T=f._fullLayout;g("funnelarea",T),p(_,f),s(_,T._size),w.makeTraceGroups(T._funnelarealayer,_,"trace").each(function(k){var L=d.select(this),A=k[0],I=A.trace;(function(P){if(!P.length)return;var S=P[0],E=S.trace,z=E.aspectratio,D=E.baseratio;D>.999&&(D=.999);var j,V=Math.pow(D,2),Z=S.vTotal,Q=Z,X=Z*V/(1-V)/Z;function $(){var Te,le={x:Te=Math.sqrt(X),y:-Te};return[le.x,le.y]}var re,H,N=[];for(N.push($()),re=P.length-1;re>-1;re--)if(!(H=P[re]).hidden){var U=H.v/Q;X+=U,N.push($())}var te=1/0,B=-1/0;for(re=0;re<N.length;re++)j=N[re],te=Math.min(te,j[1]),B=Math.max(B,j[1]);for(re=0;re<N.length;re++)N[re][1]-=(B+te)/2;var K=N[N.length-1][0],J=S.r,ee=(B-te)/2,ne=J/K,se=J/ee*z;for(S.r=se*ee,re=0;re<N.length;re++)N[re][0]*=ne,N[re][1]*=se;var oe=[-(j=N[0])[0],j[1]],me=[j[0],j[1]],ce=0;for(re=P.length-1;re>-1;re--)if(!(H=P[re]).hidden){var ye=N[ce+=1][0],Se=N[ce][1];H.TL=[-ye,Se],H.TR=[ye,Se],H.BL=oe,H.BR=me,H.pxmid=(fe=H.TR,ge=H.BR,[.5*(fe[0]+ge[0]),.5*(fe[1]+ge[1])]),oe=H.TL,me=H.TR}var fe,ge})(k),L.each(function(){var P=d.select(this).selectAll("g.slice").data(k);P.enter().append("g").classed("slice",!0),P.exit().remove(),P.each(function(E,z){if(E.hidden)d.select(this).selectAll("path,g").remove();else{E.pointNumber=E.i,E.curveNumber=I.index;var D=A.cx,j=A.cy,V=d.select(this),Z=V.selectAll("path.surface").data([E]);Z.enter().append("path").classed("surface",!0).style({"pointer-events":b?"none":"all"}),V.call(h,f,k);var Q="M"+(D+E.TR[0])+","+(j+E.TR[1])+x(E.TR,E.BR)+x(E.BR,E.BL)+x(E.BL,E.TL)+"Z";Z.attr("d",Q),i(f,E,A);var X=c.castOption(I.textposition,E.pts),$=V.selectAll("g.slicetext").data(E.text&&X!=="none"?[0]:[]);$.enter().append("g").classed("slicetext",!0),$.exit().remove(),$.each(function(){var re=w.ensureSingle(d.select(this),"text","",function(ee){ee.attr("data-notex",1)}),H=w.ensureUniformFontSize(f,l(I,E,T.font));re.text(E.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(v.font,H).call(t.convertToTspans,f);var N,U,te,B=v.bBox(re.node()),K=Math.min(E.BL[1],E.BR[1])+j,J=Math.max(E.TL[1],E.TR[1])+j;U=Math.max(E.TL[0],E.BL[0])+D,te=Math.min(E.TR[0],E.BR[0])+D,(N=n(U,te,K,J,B,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"})).fontSize=H.size,r(I.type,N,T),k[z].transform=N,w.setTransormAndDisplay(re,N)})}});var S=d.select(this).selectAll("g.titletext").data(I.title.text?[0]:[]);S.enter().append("g").classed("titletext",!0),S.exit().remove(),S.each(function(){var E=w.ensureSingle(d.select(this),"text","",function(j){j.attr("data-notex",1)}),z=I.title.text;I._meta&&(z=w.templateString(z,I._meta)),E.text(z).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(v.font,I.title.font).call(t.convertToTspans,f);var D=u(A,T._size);E.attr("transform",e(D.x,D.y)+y(Math.min(1,D.scale))+e(D.tx,D.ty))})})})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../bar/plot":668,"../bar/uniform_text":673,"../pie/helpers":915,"../pie/plot":919,"@plotly/d3":58}],800:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../pie/style_one"),w=m("../bar/uniform_text").resizeText;G.exports=function(y){var e=y._fullLayout._funnelarealayer.selectAll(".trace");w(y,e,"funnelarea"),e.each(function(t){var n=t[0].trace,o=d.select(this);o.style({opacity:n.opacity}),o.selectAll("path.surface").each(function(r){d.select(this).call(v,r,n)})})}},{"../bar/uniform_text":673,"../pie/style_one":921,"@plotly/d3":58}],801:[function(m,G,Y){var d=m("../scatter/attributes"),v=m("../../plots/attributes"),w=m("../../plots/font_attributes"),y=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=m("../../plots/template_attributes").hovertemplateAttrs,t=m("../../plots/template_attributes").texttemplateAttrs,n=m("../../components/colorscale/attributes"),o=m("../../lib/extend").extendFlat;G.exports=o({z:{valType:"data_array",editType:"calc"},x:o({},d.x,{impliedEdits:{xtype:"array"}}),x0:o({},d.x0,{impliedEdits:{xtype:"scaled"}}),dx:o({},d.dx,{impliedEdits:{xtype:"scaled"}}),y:o({},d.y,{impliedEdits:{ytype:"array"}}),y0:o({},d.y0,{impliedEdits:{ytype:"scaled"}}),dy:o({},d.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:o({},d.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:o({},d.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:o({},d.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:o({},d.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:o({},d.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:o({},d.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},hoverongaps:{valType:"boolean",dflt:!0,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},xhoverformat:y("x"),yhoverformat:y("y"),zhoverformat:y("z",1),hovertemplate:e(),texttemplate:t({arrayOk:!1,editType:"plot"},{keys:["x","y","z","text"]}),textfont:w({editType:"plot",autoSize:!0,autoColor:!0,colorEditType:"style"}),showlegend:o({},v.showlegend,{dflt:!1})},{transforms:void 0},n("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../scatter/attributes":936}],802:[function(m,G,Y){var d=m("../../registry"),v=m("../../lib"),w=m("../../plots/cartesian/axes"),y=m("../../plots/cartesian/align_period"),e=m("../histogram2d/calc"),t=m("../../components/colorscale/calc"),n=m("./convert_column_xyz"),o=m("./clean_2d_array"),r=m("./interp2d"),g=m("./find_empties"),c=m("./make_bound_array"),a=m("../../constants/numerical").BADNUM;function h(l){for(var s=[],p=l.length,u=0;u<p;u++){var i=l[u];i!==a&&s.push(i)}return s}G.exports=function(l,s){var p,u,i,x,f,_,b,T,k,L,A,I=w.getFromId(l,s.xaxis||"x"),P=w.getFromId(l,s.yaxis||"y"),S=d.traceIs(s,"contour"),E=d.traceIs(s,"histogram"),z=d.traceIs(s,"gl2d"),D=S?"best":s.zsmooth;if(I._minDtick=0,P._minDtick=0,E)x=(A=e(l,s)).orig_x,p=A.x,u=A.x0,i=A.dx,T=A.orig_y,f=A.y,_=A.y0,b=A.dy,k=A.z;else{var j=s.z;v.isArray1D(j)?(n(s,I,P,"x","y",["z"]),p=s._x,f=s._y,j=s._z):(x=s.x?I.makeCalcdata(s,"x"):[],T=s.y?P.makeCalcdata(s,"y"):[],p=y(s,I,"x",x).vals,f=y(s,P,"y",T).vals,s._x=p,s._y=f),u=s.x0,i=s.dx,_=s.y0,b=s.dy,k=o(j,s,I,P)}function V(J){D=s._input.zsmooth=s.zsmooth=!1,v.warn('cannot use zsmooth: "fast": '+J)}if((I.rangebreaks||P.rangebreaks)&&(k=function(J,ee,ne){for(var se=[],oe=-1,me=0;me<ne.length;me++)if(ee[me]!==a){oe++,se[oe]=[];for(var ce=0;ce<ne[me].length;ce++)J[ce]!==a&&se[oe].push(ne[me][ce])}return se}(p,f,k),E||(p=h(p),f=h(f),s._x=p,s._y=f)),E||!S&&!s.connectgaps||(s._emptypoints=g(k),r(k,s._emptypoints)),D==="fast"){if(I.type==="log"||P.type==="log")V("log axis found");else if(!E){if(p.length){var Z=(p[p.length-1]-p[0])/(p.length-1),Q=Math.abs(Z/100);for(L=0;L<p.length-1;L++)if(Math.abs(p[L+1]-p[L]-Z)>Q){V("x scale is not linear");break}}if(f.length&&D==="fast"){var X=(f[f.length-1]-f[0])/(f.length-1),$=Math.abs(X/100);for(L=0;L<f.length-1;L++)if(Math.abs(f[L+1]-f[L]-X)>$){V("y scale is not linear");break}}}}var re=v.maxRowLength(k),H=s.xtype==="scaled"?"":p,N=c(s,H,u,i,re,I),U=s.ytype==="scaled"?"":f,te=c(s,U,_,b,k.length,P);z||(s._extremes[I._id]=w.findExtremes(I,N),s._extremes[P._id]=w.findExtremes(P,te));var B={x:N,y:te,z:k,text:s._text||s.text,hovertext:s._hovertext||s.hovertext};if(s.xperiodalignment&&x&&(B.orig_x=x),s.yperiodalignment&&T&&(B.orig_y=T),H&&H.length===N.length-1&&(B.xCenter=H),U&&U.length===te.length-1&&(B.yCenter=U),E&&(B.xRanges=A.xRanges,B.yRanges=A.yRanges,B.pts=A.pts),S||t(l,s,{vals:k,cLetter:"z"}),S&&s.contours&&s.contours.coloring==="heatmap"){var K={type:s.type==="contour"?"heatmap":"histogram2d",xcalendar:s.xcalendar,ycalendar:s.ycalendar};B.xfill=c(K,H,u,i,re,I),B.yfill=c(K,U,_,b,k.length,P)}return[B]}},{"../../components/colorscale/calc":375,"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../../registry":647,"../histogram2d/calc":835,"./clean_2d_array":803,"./convert_column_xyz":805,"./find_empties":807,"./interp2d":810,"./make_bound_array":812}],803:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("../../constants/numerical").BADNUM;G.exports=function(y,e,t,n){var o,r,g,c,a,h;function l(f){if(d(f))return+f}if(e&&e.transpose){for(o=0,a=0;a<y.length;a++)o=Math.max(o,y[a].length);if(o===0)return!1;g=function(f){return f.length},c=function(f,_,b){return(f[b]||[])[_]}}else o=y.length,g=function(f,_){return f[_].length},c=function(f,_,b){return(f[_]||[])[b]};var s=function(f,_,b){return _===w||b===w?w:c(f,_,b)};function p(f){if(e&&e.type!=="carpet"&&e.type!=="contourcarpet"&&f&&f.type==="category"&&e["_"+f._id.charAt(0)].length){var _=f._id.charAt(0),b={},T=e["_"+_+"CategoryMap"]||e[_];for(a=0;a<T.length;a++)b[T[a]]=a;return function(k){var L=b[f._categories[k]];return L+1?L:w}}return v.identity}var u=p(t),i=p(n);n&&n.type==="category"&&(o=n._categories.length);var x=new Array(o);for(a=0;a<o;a++)for(r=t&&t.type==="category"?t._categories.length:g(y,a),x[a]=new Array(r),h=0;h<r;h++)x[a][h]=l(s(y,i(a),u(h)));return x}},{"../../constants/numerical":491,"../../lib":515,"fast-isnumeric":190}],804:[function(m,G,Y){G.exports={min:"zmin",max:"zmax"}},{}],805:[function(m,G,Y){var d=m("../../lib"),v=m("../../constants/numerical").BADNUM,w=m("../../plots/cartesian/align_period");G.exports=function(y,e,t,n,o,r){var g=y._length,c=e.makeCalcdata(y,n),a=t.makeCalcdata(y,o);c=w(y,e,n,c).vals,a=w(y,t,o,a).vals;var h,l,s,p,u=y.text,i=u!==void 0&&d.isArray1D(u),x=y.hovertext,f=x!==void 0&&d.isArray1D(x),_=d.distinctVals(c),b=_.vals,T=d.distinctVals(a),k=T.vals,L=[],A=k.length,I=b.length;for(h=0;h<r.length;h++)L[h]=d.init2dArray(A,I);i&&(s=d.init2dArray(A,I)),f&&(p=d.init2dArray(A,I));var P=d.init2dArray(A,I);for(h=0;h<g;h++)if(c[h]!==v&&a[h]!==v){var S=d.findBin(c[h]+_.minDiff/2,b),E=d.findBin(a[h]+T.minDiff/2,k);for(l=0;l<r.length;l++){var z=y[r[l]];L[l][E][S]=z[h],P[E][S]=h}i&&(s[E][S]=u[h]),f&&(p[E][S]=x[h])}for(y["_"+n]=b,y["_"+o]=k,l=0;l<r.length;l++)y["_"+r[l]]=L[l];i&&(y._text=s),f&&(y._hovertext=p),e&&e.type==="category"&&(y["_"+n+"CategoryMap"]=b.map(function(D){return e._categories[D]})),t&&t.type==="category"&&(y["_"+o+"CategoryMap"]=k.map(function(D){return t._categories[D]})),y._after2before=P}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563}],806:[function(m,G,Y){var d=m("../../lib"),v=m("./xyz_defaults"),w=m("./label_defaults"),y=m("../scatter/period_defaults"),e=m("./style_defaults"),t=m("../../components/colorscale/defaults"),n=m("./attributes");G.exports=function(o,r,g,c){function a(h,l){return d.coerce(o,r,n,h,l)}v(o,r,a,c)?(y(o,r,c,a),a("xhoverformat"),a("yhoverformat"),a("text"),a("hovertext"),a("hovertemplate"),w(a,c),e(o,r,a,c),a("hoverongaps"),a("connectgaps",d.isArray1D(r.z)&&r.zsmooth!==!1),t(o,r,c,a,{prefix:"",cLetter:"z"})):r.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"../scatter/period_defaults":956,"./attributes":801,"./label_defaults":811,"./style_defaults":815,"./xyz_defaults":816}],807:[function(m,G,Y){var d=m("../../lib").maxRowLength;G.exports=function(v){var w,y,e,t,n,o,r,g,c=[],a={},h=[],l=v[0],s=[],p=[0,0,0],u=d(v);for(y=0;y<v.length;y++)for(w=s,s=l,l=v[y+1]||[],e=0;e<u;e++)s[e]===void 0&&((o=(s[e-1]!==void 0?1:0)+(s[e+1]!==void 0?1:0)+(w[e]!==void 0?1:0)+(l[e]!==void 0?1:0))?(y===0&&o++,e===0&&o++,y===v.length-1&&o++,e===s.length-1&&o++,o<4&&(a[[y,e]]=[y,e,o]),c.push([y,e,o])):h.push([y,e]));for(;h.length;){for(r={},g=!1,n=h.length-1;n>=0;n--)(o=((a[[(y=(t=h[n])[0])-1,e=t[1]]]||p)[2]+(a[[y+1,e]]||p)[2]+(a[[y,e-1]]||p)[2]+(a[[y,e+1]]||p)[2])/20)&&(r[t]=[y,e,o],h.splice(n,1),g=!0);if(!g)throw"findEmpties iterated with no new neighbors";for(t in r)a[t]=r[t],c.push(r[t])}return c.sort(function(i,x){return x[2]-i[2]})}},{"../../lib":515}],808:[function(m,G,Y){var d=m("../../components/fx"),v=m("../../lib"),w=m("../../plots/cartesian/axes"),y=m("../../components/colorscale").extractOpts;G.exports=function(e,t,n,o,r){r||(r={});var g,c,a,h,l=r.isContour,s=e.cd[0],p=s.trace,u=e.xa,i=e.ya,x=s.x,f=s.y,_=s.z,b=s.xCenter,T=s.yCenter,k=s.zmask,L=p.zhoverformat,A=x,I=f;if(e.index!==!1){try{a=Math.round(e.index[1]),h=Math.round(e.index[0])}catch{return void v.error("Error hovering on heatmap, pointNumber must be [row,col], found:",e.index)}if(a<0||a>=_[0].length||h<0||h>_.length)return}else{if(d.inbox(t-x[0],t-x[x.length-1],0)>0||d.inbox(n-f[0],n-f[f.length-1],0)>0)return;if(l){var P;for(A=[2*x[0]-x[1]],P=1;P<x.length;P++)A.push((x[P]+x[P-1])/2);for(A.push([2*x[x.length-1]-x[x.length-2]]),I=[2*f[0]-f[1]],P=1;P<f.length;P++)I.push((f[P]+f[P-1])/2);I.push([2*f[f.length-1]-f[f.length-2]])}a=Math.max(0,Math.min(A.length-2,v.findBin(t,A))),h=Math.max(0,Math.min(I.length-2,v.findBin(n,I)))}var S,E,z=u.c2p(x[a]),D=u.c2p(x[a+1]),j=i.c2p(f[h]),V=i.c2p(f[h+1]);l?(S=s.orig_x||x,E=s.orig_y||f,D=z,g=S[a],V=j,c=E[h]):(S=s.orig_x||b||x,E=s.orig_y||T||f,g=b?S[a]:(S[a]+S[a+1])/2,c=T?E[h]:(E[h]+E[h+1])/2,u&&u.type==="category"&&(g=x[a]),i&&i.type==="category"&&(c=f[h]),p.zsmooth&&(z=D=u.c2p(g),j=V=i.c2p(c)));var Z=_[h][a];if(k&&!k[h][a]&&(Z=void 0),Z!==void 0||p.hoverongaps){var Q;Array.isArray(s.hovertext)&&Array.isArray(s.hovertext[h])?Q=s.hovertext[h][a]:Array.isArray(s.text)&&Array.isArray(s.text[h])&&(Q=s.text[h][a]);var X=y(p),$={type:"linear",range:[X.min,X.max],hoverformat:L,_separators:u._separators,_numFormat:u._numFormat},re=w.tickText($,Z,"hover").text;return[v.extendFlat(e,{index:p._after2before?p._after2before[h][a]:[h,a],distance:e.maxHoverDistance,spikeDistance:e.maxSpikeDistance,x0:z,x1:D,y0:j,y1:V,xLabelVal:g,yLabelVal:c,zLabelVal:Z,zLabel:re,text:Q})]}}},{"../../components/colorscale":379,"../../components/fx":407,"../../lib":515,"../../plots/cartesian/axes":566}],809:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),calc:m("./calc"),plot:m("./plot"),colorbar:m("./colorbar"),style:m("./style"),hoverPoints:m("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":578,"./attributes":801,"./calc":802,"./colorbar":804,"./defaults":806,"./hover":808,"./plot":813,"./style":814}],810:[function(m,G,Y){var d=m("../../lib"),v=[[-1,0],[1,0],[0,-1],[0,1]];function w(e){return .5-.25*Math.min(1,.5*e)}function y(e,t,n){var o,r,g,c,a,h,l,s,p,u,i,x,f,_=0;for(c=0;c<t.length;c++){for(r=(o=t[c])[0],g=o[1],i=e[r][g],u=0,p=0,a=0;a<4;a++)(l=e[r+(h=v[a])[0]])&&(s=l[g+h[1]])!==void 0&&(u===0?x=f=s:(x=Math.min(x,s),f=Math.max(f,s)),p++,u+=s);if(p===0)throw"iterateInterp2d order is wrong: no defined neighbors";e[r][g]=u/p,i===void 0?p<4&&(_=1):(e[r][g]=(1+n)*e[r][g]-n*i,f>x&&(_=Math.max(_,Math.abs(e[r][g]-i)/(f-x))))}return _}G.exports=function(e,t){var n,o=1;for(y(e,t),n=0;n<t.length&&!(t[n][2]<4);n++);for(t=t.slice(n),n=0;n<100&&o>.01;n++)o=y(e,t,w(o));return o>.01&&d.log("interp2d didn't converge quickly",o),e}},{"../../lib":515}],811:[function(m,G,Y){var d=m("../../lib");G.exports=function(v,w){v("texttemplate");var y=d.extendFlat({},w.font,{color:"auto",size:"auto"});d.coerceFont(v,"textfont",y)}},{"../../lib":515}],812:[function(m,G,Y){var d=m("../../registry"),v=m("../../lib").isArrayOrTypedArray;G.exports=function(w,y,e,t,n,o){var r,g,c,a=[],h=d.traceIs(w,"contour"),l=d.traceIs(w,"histogram"),s=d.traceIs(w,"gl2d");if(v(y)&&y.length>1&&!l&&o.type!=="category"){var p=y.length;if(!(p<=n))return h?y.slice(0,n):y.slice(0,n+1);if(h||s)a=y.slice(0,n);else if(n===1)a=[y[0]-.5,y[0]+.5];else{for(a=[1.5*y[0]-.5*y[1]],c=1;c<p;c++)a.push(.5*(y[c-1]+y[c]));a.push(1.5*y[p-1]-.5*y[p-2])}if(p<n){var u=a[a.length-1],i=u-a[a.length-2];for(c=p;c<n;c++)u+=i,a.push(u)}}else{var x=w[o._id.charAt(0)+"calendar"];for(l?r=o.r2c(e,0,x):v(y)&&y.length===1?r=y[0]:e===void 0?r=0:r=(o.type==="log"?o.d2c:o.r2c)(e,0,x),g=t||1,c=h||s?0:-.5;c<n;c++)a.push(r+g*c)}return a}},{"../../lib":515,"../../registry":647}],813:[function(m,G,Y){var d=m("@plotly/d3"),v=m("tinycolor2"),w=m("../../registry"),y=m("../../components/drawing"),e=m("../../plots/cartesian/axes"),t=m("../../lib"),n=m("../../lib/svg_text_utils"),o=m("../scatter/format_labels"),r=m("../../components/color"),g=m("../../components/colorscale").extractOpts,c=m("../../components/colorscale").makeColorScaleFuncFromTrace,a=m("../../constants/xmlns_namespaces"),h=m("../../constants/alignment").LINE_SPACING;function l(x){return x.selectAll("g.heatmap-label")}function s(x){l(x).remove()}function p(x,f){var _=f.length-2,b=t.constrain(t.findBin(x,f),0,_),T=f[b],k=f[b+1],L=t.constrain(b+(x-T)/(k-T)-.5,0,_),A=Math.round(L),I=Math.abs(L-A);return L&&L!==_&&I?{bin0:A,frac:I,bin1:Math.round(A+I/(L-A))}:{bin0:A,bin1:A,frac:0}}function u(x,f){var _=f.length-1,b=t.constrain(t.findBin(x,f),0,_),T=f[b],k=(x-T)/(f[b+1]-T)||0;return k<=0?{bin0:b,bin1:b,frac:0}:k<.5?{bin0:b,bin1:b+1,frac:k}:{bin0:b+1,bin1:b,frac:1-k}}function i(x,f,_){x[f]=_[0],x[f+1]=_[1],x[f+2]=_[2],x[f+3]=Math.round(255*_[3])}G.exports=function(x,f,_,b){var T=f.xaxis,k=f.yaxis;t.makeTraceGroups(b,_,"hm").each(function(L){var A,I,P,S,E,z,D,j,V=d.select(this),Z=L[0],Q=Z.trace,X=Q.xgap||0,$=Q.ygap||0,re=Z.z,H=Z.x,N=Z.y,U=Z.xCenter,te=Z.yCenter,B=w.traceIs(Q,"contour"),K=B?"best":Q.zsmooth,J=re.length,ee=t.maxRowLength(re),ne=!1,se=!1;for(z=0;A===void 0&&z<H.length-1;)A=T.c2p(H[z]),z++;for(z=H.length-1;I===void 0&&z>0;)I=T.c2p(H[z]),z--;for(I<A&&(P=I,I=A,A=P,ne=!0),z=0;S===void 0&&z<N.length-1;)S=k.c2p(N[z]),z++;for(z=N.length-1;E===void 0&&z>0;)E=k.c2p(N[z]),z--;if(E<S&&(P=S,S=E,E=P,se=!0),B&&(U=H,te=N,H=Z.xfill,N=Z.yfill),K!=="fast"){var oe=K==="best"?0:.5;A=Math.max(-oe*T._length,A),I=Math.min((1+oe)*T._length,I),S=Math.max(-oe*k._length,S),E=Math.min((1+oe)*k._length,E)}var me,ce,ye=Math.round(I-A),Se=Math.round(E-S);if(ye<=0||Se<=0)return V.selectAll("image").data([]).exit().remove(),void s(V);K==="fast"?(me=ee,ce=J):(me=ye,ce=Se);var fe=document.createElement("canvas");fe.width=me,fe.height=ce;var ge,Te,le=fe.getContext("2d"),ve=c(Q,{noNumericCheck:!0,returnArray:!0});K==="fast"?(ge=ne?function(on){return ee-1-on}:t.identity,Te=se?function(on){return J-1-on}:t.identity):(ge=function(on){return t.constrain(Math.round(T.c2p(H[on])-A),0,ye)},Te=function(on){return t.constrain(Math.round(k.c2p(N[on])-S),0,Se)});var Me,we,de,Ie,De=Te(0),Oe=[De,De],Ve=ne?0:1,Fe=se?0:1,ze=0,Re=0,We=0,$e=0;function at(on,Tn){if(on!==void 0){var Mn=ve(on);return Mn[0]=Math.round(Mn[0]),Mn[1]=Math.round(Mn[1]),Mn[2]=Math.round(Mn[2]),ze+=Tn,Re+=Mn[0]*Tn,We+=Mn[1]*Tn,$e+=Mn[2]*Tn,Mn}return[0,0,0,0]}function gt(on,Tn,Mn,ei){var Hr=on[Mn.bin0];if(Hr===void 0)return at(void 0,1);var ln,bn=on[Mn.bin1],nn=Tn[Mn.bin0],pn=Tn[Mn.bin1],qn=bn-Hr||0,sr=nn-Hr||0;return ln=bn===void 0?pn===void 0?0:nn===void 0?2*(pn-Hr):2*(2*pn-nn-Hr)/3:pn===void 0?nn===void 0?0:2*(2*Hr-bn-nn)/3:nn===void 0?2*(2*pn-bn-Hr)/3:pn+Hr-bn-nn,at(Hr+Mn.frac*qn+ei.frac*(sr+Mn.frac*ln))}if(K){var xt,mt=0;try{xt=new Uint8Array(ye*Se*4)}catch{xt=new Array(ye*Se*4)}if(K==="best"){var nt,Qe,vt,jt=U||H,Gt=te||N,$t=new Array(jt.length),Zt=new Array(Gt.length),cr=new Array(ye),Dt=U?u:p,Ne=te?u:p;for(z=0;z<jt.length;z++)$t[z]=Math.round(T.c2p(jt[z])-A);for(z=0;z<Gt.length;z++)Zt[z]=Math.round(k.c2p(Gt[z])-S);for(z=0;z<ye;z++)cr[z]=Dt(z,$t);for(D=0;D<Se;D++)for(Qe=re[(nt=Ne(D,Zt)).bin0],vt=re[nt.bin1],z=0;z<ye;z++,mt+=4)i(xt,mt,Ie=gt(Qe,vt,cr[z],nt))}else for(D=0;D<J;D++)for(de=re[D],Oe=Te(D),z=0;z<ye;z++)Ie=at(de[z],1),i(xt,mt=4*(Oe*ye+ge(z)),Ie);var Ye=le.createImageData(ye,Se);try{Ye.data.set(xt)}catch{var pe=Ye.data,_e=pe.length;for(D=0;D<_e;D++)pe[D]=xt[D]}le.putImageData(Ye,0,0)}else{var Be=Math.floor(X/2),He=Math.floor($/2);for(D=0;D<J;D++)if(de=re[D],Oe.reverse(),Oe[Fe]=Te(D+1),Oe[0]!==Oe[1]&&Oe[0]!==void 0&&Oe[1]!==void 0)for(Me=[we=ge(0),we],z=0;z<ee;z++)Me.reverse(),Me[Ve]=ge(z+1),Me[0]!==Me[1]&&Me[0]!==void 0&&Me[1]!==void 0&&(Ie=at(de[z],(Me[1]-Me[0])*(Oe[1]-Oe[0])),le.fillStyle="rgba("+Ie.join(",")+")",le.fillRect(Me[0]+Be,Oe[0]+He,Me[1]-Me[0]-X,Oe[1]-Oe[0]-$))}Re=Math.round(Re/ze),We=Math.round(We/ze),$e=Math.round($e/ze);var Je=v("rgb("+Re+","+We+","+$e+")");x._hmpixcount=(x._hmpixcount||0)+ze,x._hmlumcount=(x._hmlumcount||0)+ze*Je.getLuminance();var Ze=V.selectAll("image").data(L);Ze.enter().append("svg:image").attr({xmlns:a.svg,preserveAspectRatio:"none"}),Ze.attr({height:Se,width:ye,x:A,y:S,"xlink:href":fe.toDataURL("image/png")}),s(V);var ct=Q.texttemplate;if(ct){var lt=g(Q),At={type:"linear",range:[lt.min,lt.max],_separators:T._separators,_numFormat:T._numFormat},Ot=Q.type==="histogram2dcontour",it=Q.type==="contour",ht=it?J-1:J,Ut=it?1:0,Mt=it?ee-1:ee,It=[];for(z=it?1:0;z<ht;z++){var Le;if(it)Le=Z.y[z];else if(Ot){if(z===0||z===J-1)continue;Le=Z.y[z]}else if(Z.yCenter)Le=Z.yCenter[z];else{if(z+1===J&&Z.y[z+1]===void 0)continue;Le=(Z.y[z]+Z.y[z+1])/2}var Xe=Math.round(k.c2p(Le));if(!(0>Xe||Xe>k._length))for(D=Ut;D<Mt;D++){var ot;if(it)ot=Z.x[D];else if(Ot){if(D===0||D===ee-1)continue;ot=Z.x[D]}else if(Z.xCenter)ot=Z.xCenter[D];else{if(D+1===ee&&Z.x[D+1]===void 0)continue;ot=(Z.x[D]+Z.x[D+1])/2}var pt=Math.round(T.c2p(ot));if(!(0>pt||pt>T._length)){var St=o({x:ot,y:Le},Q,x._fullLayout);St.x=ot,St.y=Le;var Vt=Z.z[z][D];Vt===void 0?(St.z="",St.zLabel=""):(St.z=Vt,St.zLabel=e.tickText(At,Vt,"hover").text);var Jt=Z.text&&Z.text[z]&&Z.text[z][D];Jt!==void 0&&Jt!==!1||(Jt=""),St.text=Jt;var qt=t.texttemplateString(ct,St,x._fullLayout._d3locale,St,Q._meta||{});if(qt){var gr=qt.split("<br>"),Cr=gr.length,mr=0;for(j=0;j<Cr;j++)mr=Math.max(mr,gr[j].length);It.push({l:Cr,c:mr,t:qt,x:pt,y:Xe,z:Vt})}}}}var tr=Q.textfont,nr=tr.family,Qt=tr.size,dr=x._fullLayout.font.size;if(!Qt||Qt==="auto"){var _r=1/0,Ir=1/0,Rr=0,Vr=0;for(j=0;j<It.length;j++){var Xr=It[j];if(Rr=Math.max(Rr,Xr.l),Vr=Math.max(Vr,Xr.c),j<It.length-1){var cn=It[j+1],an=Math.abs(cn.x-Xr.x),zn=Math.abs(cn.y-Xr.y);an&&(_r=Math.min(_r,an)),zn&&(Ir=Math.min(Ir,zn))}}isFinite(_r)&&isFinite(Ir)?(_r-=X,Ir-=$,_r/=Vr,Ir/=Rr,_r/=h/2,Ir/=h,Qt=Math.min(Math.floor(_r),Math.floor(Ir),dr)):Qt=dr}if(Qt<=0||!isFinite(Qt))return;l(V).data(It).enter().append("g").classed("heatmap-label",1).append("text").attr("text-anchor","middle").each(function(on){var Tn=d.select(this),Mn=tr.color;Mn&&Mn!=="auto"||(Mn=r.contrast("rgba("+ve(on.z).join()+")")),Tn.attr("data-notex",1).call(n.positionText,function(ei){return ei.x}(on),function(ei){return ei.y-Qt*(ei.l*h/2-1)}(on)).call(y.font,nr,Qt,Mn).text(on.t).call(n.convertToTspans,x)})}})}},{"../../components/color":367,"../../components/colorscale":379,"../../components/drawing":389,"../../constants/alignment":483,"../../constants/xmlns_namespaces":492,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../registry":647,"../scatter/format_labels":945,"@plotly/d3":58,tinycolor2:313}],814:[function(m,G,Y){var d=m("@plotly/d3");G.exports=function(v){d.select(v).selectAll(".hm image").style("opacity",function(w){return w.trace.opacity})}},{"@plotly/d3":58}],815:[function(m,G,Y){G.exports=function(d,v,w){w("zsmooth")===!1&&(w("xgap"),w("ygap")),w("zhoverformat")}},{}],816:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("../../registry");function y(e,t){var n=t(e);return(n?t(e+"type","array"):"scaled")==="scaled"&&(t(e+"0"),t("d"+e)),n}G.exports=function(e,t,n,o,r,g){var c,a,h=n("z");if(r=r||"x",g=g||"y",h===void 0||!h.length)return 0;if(v.isArray1D(e.z)){c=n(r),a=n(g);var l=v.minRowLength(c),s=v.minRowLength(a);if(l===0||s===0)return 0;t._length=Math.min(l,s,h.length)}else{if(c=y(r,n),a=y(g,n),!function(p){for(var u,i=!0,x=!1,f=!1,_=0;_<p.length;_++){if(u=p[_],!v.isArrayOrTypedArray(u)){i=!1;break}u.length>0&&(x=!0);for(var b=0;b<u.length;b++)if(d(u[b])){f=!0;break}}return i&&x&&f}(h))return 0;n("transpose"),t._length=null}return e.type==="heatmapgl"||w.getComponentMethod("calendars","handleTraceDefaults")(e,t,[r,g],o),!0}},{"../../lib":515,"../../registry":647,"fast-isnumeric":190}],817:[function(m,G,Y){for(var d=m("../heatmap/attributes"),v=m("../../components/colorscale/attributes"),w=m("../../lib/extend").extendFlat,y=m("../../plot_api/edit_types").overrideAll,e=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],t={},n=0;n<e.length;n++){var o=e[n];t[o]=d[o]}t.zsmooth={valType:"enumerated",values:["fast",!1],dflt:"fast",editType:"calc"},w(t,v("",{cLetter:"z",autoColorDflt:!1})),G.exports=y(t,"calc","nested")},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../heatmap/attributes":801}],818:[function(m,G,Y){var d=m("../../../stackgl_modules").gl_heatmap2d,v=m("../../plots/cartesian/axes"),w=m("../../lib/str2rgbarray");function y(t,n){this.scene=t,this.uid=n,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={zsmooth:"fast",z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=d(t.glplot,this.options),this.heatmap._trace=this}var e=y.prototype;e.handlePick=function(t){var n=this.options,o=n.shape,r=t.pointId,g=r%o[0],c=Math.floor(r/o[0]),a=r;return{trace:this,dataCoord:t.dataCoord,traceCoord:[n.x[g],n.y[c],n.z[a]],textLabel:this.textLabels[r],name:this.name,pointIndex:[c,g],hoverinfo:this.hoverinfo}},e.update=function(t,n){var o=n[0];this.index=t.index,this.name=t.name,this.hoverinfo=t.hoverinfo;var r=o.z;this.options.z=[].concat.apply([],r);var g=r[0].length,c=r.length;this.options.shape=[g,c],this.options.x=o.x,this.options.y=o.y,this.options.zsmooth=t.zsmooth;var a=function(u){for(var i=u.colorscale,x=u.zmin,f=u.zmax,_=i.length,b=new Array(_),T=new Array(4*_),k=0;k<_;k++){var L=i[k],A=w(L[1]);b[k]=x+L[0]*(f-x);for(var I=0;I<4;I++)T[4*k+I]=A[I]}return{colorLevels:b,colorValues:T}}(t);this.options.colorLevels=a.colorLevels,this.options.colorValues=a.colorValues,this.textLabels=[].concat.apply([],t.text),this.heatmap.update(this.options);var h,l,s=this.scene.xaxis,p=this.scene.yaxis;t.zsmooth===!1&&(h={ppad:o.x[1]-o.x[0]},l={ppad:o.y[1]-o.y[0]}),t._extremes[s._id]=v.findExtremes(s,o.x,h),t._extremes[p._id]=v.findExtremes(p,o.y,l)},e.dispose=function(){this.heatmap.dispose()},G.exports=function(t,n,o){var r=new y(t,n.uid);return r.update(n,o),r}},{"../../../stackgl_modules":1133,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566}],819:[function(m,G,Y){var d=m("../../lib"),v=m("../heatmap/xyz_defaults"),w=m("../../components/colorscale/defaults"),y=m("./attributes");G.exports=function(e,t,n,o){function r(g,c){return d.coerce(e,t,y,g,c)}v(e,t,r,o)?(r("text"),r("zsmooth"),w(e,t,o,r,{prefix:"",cLetter:"z"})):t.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"../heatmap/xyz_defaults":816,"./attributes":817}],820:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../heatmap/colorbar"),calc:m("../heatmap/calc"),plot:m("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:m("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":605,"../heatmap/calc":802,"../heatmap/colorbar":804,"./attributes":817,"./convert":818,"./defaults":819}],821:[function(m,G,Y){var d=m("../bar/attributes"),v=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,w=m("../../plots/template_attributes").hovertemplateAttrs,y=m("../../plots/template_attributes").texttemplateAttrs,e=m("../../plots/font_attributes"),t=m("./bin_attributes"),n=m("./constants"),o=m("../../lib/extend").extendFlat;G.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},xhoverformat:v("x"),yhoverformat:v("y"),text:o({},d.text,{}),hovertext:o({},d.hovertext,{}),orientation:d.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:t("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:t("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:w({},{keys:n.eventDataKeys}),texttemplate:y({arrayOk:!1,editType:"plot"},{keys:["label","value"]}),textposition:o({},d.textposition,{arrayOk:!1}),textfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),outsidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextfont:e({arrayOk:!1,editType:"plot",colorEditType:"style"}),insidetextanchor:d.insidetextanchor,textangle:d.textangle,cliponaxis:d.cliponaxis,constraintext:d.constraintext,marker:d.marker,offsetgroup:d.offsetgroup,alignmentgroup:d.alignmentgroup,selected:d.selected,unselected:d.unselected,_deprecated:{bardir:d._deprecated.bardir}}},{"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"../bar/attributes":657,"./bin_attributes":823,"./constants":827}],822:[function(m,G,Y){G.exports=function(d,v){for(var w=d.length,y=0,e=0;e<w;e++)v[e]?(d[e]/=v[e],y+=d[e]):d[e]=null;return y}},{}],823:[function(m,G,Y){G.exports=function(d,v){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],824:[function(m,G,Y){var d=m("fast-isnumeric");G.exports={count:function(v,w,y){return y[v]++,1},sum:function(v,w,y,e){var t=e[w];return d(t)?(t=Number(t),y[v]+=t,t):0},avg:function(v,w,y,e,t){var n=e[w];return d(n)&&(n=Number(n),y[v]+=n,t[v]++),0},min:function(v,w,y,e){var t=e[w];if(d(t)){if(t=Number(t),!d(y[v]))return y[v]=t,t;if(y[v]>t){var n=t-y[v];return y[v]=t,n}}return 0},max:function(v,w,y,e){var t=e[w];if(d(t)){if(t=Number(t),!d(y[v]))return y[v]=t,t;if(y[v]<t){var n=t-y[v];return y[v]=t,n}}return 0}}},{"fast-isnumeric":190}],825:[function(m,G,Y){var d=m("../../constants/numerical"),v=d.ONEAVGYEAR,w=d.ONEAVGMONTH,y=d.ONEDAY,e=d.ONEHOUR,t=d.ONEMIN,n=d.ONESEC,o=m("../../plots/cartesian/axes").tickIncrement;function r(h,l,s,p){if(h*l<=0)return 1/0;for(var u=Math.abs(l-h),i=s.type==="date",x=g(u,i),f=0;f<10;f++){var _=g(80*x,i);if(x===_||!c(_,h,l,i,s,p))break;x=_}return x}function g(h,l){return l&&h>n?h>y?h>1.1*v?v:h>1.1*w?w:y:h>e?e:h>t?t:n:Math.pow(10,Math.floor(Math.log(h)/Math.LN10))}function c(h,l,s,p,u,i){if(p&&h>y){var x=a(l,u,i),f=a(s,u,i),_=h===v?0:1;return x[_]!==f[_]}return Math.floor(s/h)-Math.floor(l/h)>.1}function a(h,l,s){var p=l.c2d(h,v,s).split("-");return p[0]===""&&(p.unshift(),p[0]="-"+p[0]),p}G.exports=function(h,l,s,p,u){var i,x,f=-1.1*l,_=-.1*l,b=h-_,T=s[0],k=s[1],L=Math.min(r(T+_,T+b,p,u),r(k+_,k+b,p,u)),A=Math.min(r(T+f,T+_,p,u),r(k+f,k+_,p,u));if(L>A&&A<Math.abs(k-T)/4e3?(i=L,x=!1):(i=Math.min(L,A),x=!0),p.type==="date"&&i>y){var I=i===v?1:6,P=i===v?"M12":"M1";return function(S,E){var z=p.c2d(S,v,u),D=z.indexOf("-",I);D>0&&(z=z.substr(0,D));var j=p.d2c(z,0,u);if(j<S){var V=o(j,P,!1,u);(j+V)/2<S+h&&(j=V)}return E&&x?o(j,P,!0,u):j}}return function(S,E){var z=i*Math.round(S/i);return z+i/10<S&&z+.9*i<S+h&&(z+=i),E&&x&&(z-=i),z}}},{"../../constants/numerical":491,"../../plots/cartesian/axes":566}],826:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("../../registry"),y=m("../../plots/cartesian/axes"),e=m("../bar/arrays_to_calcdata"),t=m("./bin_functions"),n=m("./norm_functions"),o=m("./average"),r=m("./bin_label_vals");function g(c,a,h,l,s){var p,u,i,x,f,_,b,T=l+"bins",k=c._fullLayout,L=a["_"+l+"bingroup"],A=k._histogramBinOpts[L],I=k.barmode==="overlay",P=function(ce){return h.r2c(ce,0,x)},S=function(ce){return h.c2r(ce,0,x)},E=h.type==="date"?function(ce){return ce||ce===0?v.cleanDate(ce,null,x):null}:function(ce){return d(ce)?Number(ce):null};function z(ce,ye,Se){ye[ce+"Found"]?(ye[ce]=E(ye[ce]),ye[ce]===null&&(ye[ce]=Se[ce])):(_[ce]=ye[ce]=Se[ce],v.nestedProperty(u[0],T+"."+ce).set(Se[ce]))}if(a["_"+l+"autoBinFinished"])delete a["_"+l+"autoBinFinished"];else{u=A.traces;var D=[],j=!0,V=!1,Z=!1;for(p=0;p<u.length;p++)if((i=u[p]).visible){var Q=A.dirs[p];f=i["_"+Q+"pos0"]=h.makeCalcdata(i,Q),D=v.concat(D,f),delete i["_"+l+"autoBinFinished"],a.visible===!0&&(j?j=!1:(delete i._autoBin,i["_"+l+"autoBinFinished"]=1),w.traceIs(i,"2dMap")&&(V=!0),i.type==="histogram2dcontour"&&(Z=!0))}x=u[0][l+"calendar"];var X=y.autoBin(D,h,A.nbins,V,x,A.sizeFound&&A.size),$=u[0]._autoBin={};if(_=$[A.dirs[0]]={},Z&&(A.size||(X.start=S(y.tickIncrement(P(X.start),X.size,!0,x))),A.end===void 0&&(X.end=S(y.tickIncrement(P(X.end),X.size,!1,x)))),I&&!w.traceIs(a,"2dMap")&&X._dataSpan===0&&h.type!=="category"&&h.type!=="multicategory"){if(s)return[X,f,!0];X=function(ce,ye,Se,fe,ge){var Te,le,ve,Me=ce._fullLayout,we=function(gt,xt){for(var mt=xt.xaxis,nt=xt.yaxis,Qe=xt.orientation,vt=[],jt=gt._fullData,Gt=0;Gt<jt.length;Gt++){var $t=jt[Gt];$t.type==="histogram"&&$t.visible===!0&&$t.orientation===Qe&&$t.xaxis===mt&&$t.yaxis===nt&&vt.push($t)}return vt}(ce,ye),de=!1,Ie=1/0,De=[ye];for(Te=0;Te<we.length;Te++)if((le=we[Te])===ye)de=!0;else if(de){var Oe=g(ce,le,Se,fe,!0),Ve=Oe[0],Fe=Oe[2];le["_"+fe+"autoBinFinished"]=1,le["_"+fe+"pos0"]=Oe[1],Fe?De.push(le):Ie=Math.min(Ie,Ve.size)}else ve=Me._histogramBinOpts[le["_"+fe+"bingroup"]],Ie=Math.min(Ie,ve.size||le[ge].size);var ze=new Array(De.length);for(Te=0;Te<De.length;Te++)for(var Re=De[Te]["_"+fe+"pos0"],We=0;We<Re.length;We++)if(Re[We]!==void 0){ze[Te]=Re[We];break}for(isFinite(Ie)||(Ie=v.distinctVals(ze).minDiff),Te=0;Te<De.length;Te++){var $e=(le=De[Te])[fe+"calendar"],at={start:Se.c2r(ze[Te]-Ie/2,0,$e),end:Se.c2r(ze[Te]+Ie/2,0,$e),size:Ie};le._input[ge]=le[ge]=at,(ve=Me._histogramBinOpts[le["_"+fe+"bingroup"]])&&v.extendFlat(ve,at)}return ye[ge]}(c,a,h,l,T)}(b=i.cumulative||{}).enabled&&b.currentbin!=="include"&&(b.direction==="decreasing"?X.start=S(y.tickIncrement(P(X.start),X.size,!0,x)):X.end=S(y.tickIncrement(P(X.end),X.size,!1,x))),A.size=X.size,A.sizeFound||(_.size=X.size,v.nestedProperty(u[0],T+".size").set(X.size)),z("start",A,X),z("end",A,X)}f=a["_"+l+"pos0"],delete a["_"+l+"pos0"];var re=a._input[T]||{},H=v.extendFlat({},A),N=A.start,U=h.r2l(re.start),te=U!==void 0;if((A.startFound||te)&&U!==h.r2l(N)){var B=te?U:v.aggNums(Math.min,null,f),K={type:h.type==="category"||h.type==="multicategory"?"linear":h.type,r2l:h.r2l,dtick:A.size,tick0:N,calendar:x,range:[B,y.tickIncrement(B,A.size,!1,x)].map(h.l2r)},J=y.tickFirst(K);J>h.r2l(B)&&(J=y.tickIncrement(J,A.size,!0,x)),H.start=h.l2r(J),te||v.nestedProperty(a,T+".start").set(H.start)}var ee=A.end,ne=h.r2l(re.end),se=ne!==void 0;if((A.endFound||se)&&ne!==h.r2l(ee)){var oe=se?ne:v.aggNums(Math.max,null,f);H.end=h.l2r(oe),se||v.nestedProperty(a,T+".start").set(H.end)}var me="autobin"+l;return a._input[me]===!1&&(a._input[T]=v.extendFlat({},a[T]||{}),delete a._input[me],delete a[me]),[H,f]}G.exports={calc:function(c,a){var h,l,s,p,u=[],i=[],x=a.orientation==="h",f=y.getFromId(c,x?a.yaxis:a.xaxis),_=x?"y":"x",b={x:"y",y:"x"}[_],T=a[_+"calendar"],k=a.cumulative,L=g(c,a,f,_),A=L[0],I=L[1],P=typeof A.size=="string",S=[],E=P?S:A,z=[],D=[],j=[],V=0,Z=a.histnorm,Q=a.histfunc,X=Z.indexOf("density")!==-1;k.enabled&&X&&(Z=Z.replace(/ ?density$/,""),X=!1);var $,re=Q==="max"||Q==="min"?null:0,H=t.count,N=n[Z],U=!1,te=function(le){return f.r2c(le,0,T)};for(v.isArrayOrTypedArray(a[b])&&Q!=="count"&&($=a[b],U=Q==="avg",H=t[Q]),h=te(A.start),s=te(A.end)+(h-y.tickIncrement(h,A.size,!1,T))/1e6;h<s&&u.length<1e6&&(l=y.tickIncrement(h,A.size,!1,T),u.push((h+l)/2),i.push(re),j.push([]),S.push(h),X&&z.push(1/(l-h)),U&&D.push(0),!(l<=h));)h=l;S.push(h),P||f.type!=="date"||(E={start:te(E.start),end:te(E.end),size:E.size}),c._fullLayout._roundFnOpts||(c._fullLayout._roundFnOpts={});var B=a["_"+_+"bingroup"],K={leftGap:1/0,rightGap:1/0};B&&(c._fullLayout._roundFnOpts[B]||(c._fullLayout._roundFnOpts[B]=K),K=c._fullLayout._roundFnOpts[B]);var J,ee=i.length,ne=!0,se=K.leftGap,oe=K.rightGap,me={};for(h=0;h<I.length;h++){var ce=I[h];(p=v.findBin(ce,E))>=0&&p<ee&&(V+=H(p,h,i,$,D),ne&&j[p].length&&ce!==I[j[p][0]]&&(ne=!1),j[p].push(h),me[h]=p,se=Math.min(se,ce-S[p]),oe=Math.min(oe,S[p+1]-ce))}K.leftGap=se,K.rightGap=oe,ne||(J=function(le,ve){return function(){var Me=c._fullLayout._roundFnOpts[B];return r(Me.leftGap,Me.rightGap,S,f,T)(le,ve)}}),U&&(V=o(i,D)),N&&N(i,V,z),k.enabled&&function(le,ve,Me){var we,de,Ie;function De(Ve){Ie=le[Ve],le[Ve]/=2}function Oe(Ve){de=le[Ve],le[Ve]=Ie+de/2,Ie+=de}if(Me==="half")if(ve==="increasing")for(De(0),we=1;we<le.length;we++)Oe(we);else for(De(le.length-1),we=le.length-2;we>=0;we--)Oe(we);else if(ve==="increasing"){for(we=1;we<le.length;we++)le[we]+=le[we-1];Me==="exclude"&&(le.unshift(0),le.pop())}else{for(we=le.length-2;we>=0;we--)le[we]+=le[we+1];Me==="exclude"&&(le.push(0),le.shift())}}(i,k.direction,k.currentbin);var ye=Math.min(u.length,i.length),Se=[],fe=0,ge=ye-1;for(h=0;h<ye;h++)if(i[h]){fe=h;break}for(h=ye-1;h>=fe;h--)if(i[h]){ge=h;break}for(h=fe;h<=ge;h++)if(d(u[h])&&d(i[h])){var Te={p:u[h],s:i[h],b:0};k.enabled||(Te.pts=j[h],ne?Te.ph0=Te.ph1=j[h].length?I[j[h][0]]:u[h]:(a._computePh=!0,Te.ph0=J(S[h]),Te.ph1=J(S[h+1],!0))),Se.push(Te)}return Se.length===1&&(Se[0].width1=y.tickIncrement(Se[0].p,A.size,!1,T)-Se[0].p),e(Se,a),v.isArrayOrTypedArray(a.selectedpoints)&&v.tagSelected(Se,a,me),Se},calcAllAutoBins:g}},{"../../lib":515,"../../plots/cartesian/axes":566,"../../registry":647,"../bar/arrays_to_calcdata":656,"./average":822,"./bin_functions":824,"./bin_label_vals":825,"./norm_functions":833,"fast-isnumeric":190}],827:[function(m,G,Y){G.exports={eventDataKeys:["binNumber"]}},{}],828:[function(m,G,Y){var d=m("../../lib"),v=m("../../plots/cartesian/axis_ids"),w=m("../../registry").traceIs,y=m("../bar/defaults").handleGroupingDefaults,e=d.nestedProperty,t=m("../../plots/cartesian/constraints").getAxisGroup,n=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],o=["x","y"];G.exports=function(r,g){var c,a,h,l,s,p,u,i=g._histogramBinOpts={},x=[],f={},_=[];function b(X,$){return d.coerce(c._input,c,c._module.attributes,X,$)}function T(X){return X.orientation==="v"?"x":"y"}function k(X,$,re){var H=X.uid+"__"+re;$||($=H);var N=function(K,J){return v.getFromTrace({_fullLayout:g},K,J).type}(X,re),U=X[re+"calendar"]||"",te=i[$],B=!0;te&&(N===te.axType&&U===te.calendar?(B=!1,te.traces.push(X),te.dirs.push(re)):($=H,N!==te.axType&&d.warn(["Attempted to group the bins of trace",X.index,"set on a","type:"+N,"axis","with bins on","type:"+te.axType,"axis."].join(" ")),U!==te.calendar&&d.warn(["Attempted to group the bins of trace",X.index,"set with a",U,"calendar","with bins",te.calendar?"on a "+te.calendar+" calendar":"w/o a set calendar"].join(" ")))),B&&(i[$]={traces:[X],dirs:[re],axType:N,calendar:X[re+"calendar"]||""}),X["_"+re+"bingroup"]=$}for(s=0;s<r.length;s++)c=r[s],w(c,"histogram")&&(x.push(c),delete c._xautoBinFinished,delete c._yautoBinFinished,w(c,"2dMap")||y(c._input,c,g,b));var L=g._alignmentOpts||{};for(s=0;s<x.length;s++){if(c=x[s],h="",!w(c,"2dMap")){if(l=T(c),g.barmode==="group"&&c.alignmentgroup){var A=c[l+"axis"],I=t(g,A)+c.orientation;(L[I]||{})[c.alignmentgroup]&&(h=I)}h||g.barmode==="overlay"||(h=t(g,c.xaxis)+t(g,c.yaxis)+T(c))}h?(f[h]||(f[h]=[]),f[h].push(c)):_.push(c)}for(h in f)if((a=f[h]).length!==1){var P=!1;for(a.length&&(c=a[0],P=b("bingroup")),h=P||h,s=0;s<a.length;s++){var S=(c=a[s])._input.bingroup;S&&S!==h&&d.warn(["Trace",c.index,"must match","within bingroup",h+".","Ignoring its bingroup:",S,"setting."].join(" ")),c.bingroup=h,k(c,h,T(c))}}else _.push(a[0]);for(s=0;s<_.length;s++){c=_[s];var E=b("bingroup");if(w(c,"2dMap"))for(u=0;u<2;u++){var z=b((l=o[u])+"bingroup",E?E+"__"+l:null);k(c,z,l)}else k(c,E,T(c))}for(h in i){var D=i[h];for(a=D.traces,p=0;p<n.length;p++){var j,V,Z=n[p],Q=Z.name;if(Q!=="nbins"||!D.sizeFound){for(s=0;s<a.length;s++){if(c=a[s],l=D.dirs[s],j=Z.aStr[l],e(c._input,j).get()!==void 0){D[Q]=b(j),D[Q+"Found"]=!0;break}(V=(c._autoBin||{})[l]||{})[Q]&&e(c,j).set(V[Q])}if(Q==="start"||Q==="end")for(;s<a.length;s++)(c=a[s])["_"+l+"bingroup"]&&b(j,(V=(c._autoBin||{})[l]||{})[Q]);Q!=="nbins"||D.sizeFound||D.nbinsFound||(c=a[0],D[Q]=b(j))}}}}},{"../../lib":515,"../../plots/cartesian/axis_ids":570,"../../plots/cartesian/constraints":574,"../../registry":647,"../bar/defaults":661}],829:[function(m,G,Y){var d=m("../../registry"),v=m("../../lib"),w=m("../../components/color"),y=m("../bar/defaults").handleText,e=m("../bar/style_defaults"),t=m("./attributes");G.exports=function(n,o,r,g){function c(_,b){return v.coerce(n,o,t,_,b)}var a=c("x"),h=c("y");c("cumulative.enabled")&&(c("cumulative.direction"),c("cumulative.currentbin")),c("text");var l=c("textposition");y(n,o,g,c,l,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),c("hovertext"),c("hovertemplate"),c("xhoverformat"),c("yhoverformat");var s=c("orientation",h&&!a?"h":"v"),p=s==="v"?"x":"y",u=s==="v"?"y":"x",i=a&&h?Math.min(v.minRowLength(a)&&v.minRowLength(h)):v.minRowLength(o[p]||[]);if(i){o._length=i,d.getComponentMethod("calendars","handleTraceDefaults")(n,o,["x","y"],g),o[u]&&c("histfunc"),c("histnorm"),c("autobin"+p),e(n,o,c,r,g),v.coerceSelectionMarkerOpacity(o,c);var x=(o.marker.line||{}).color,f=d.getComponentMethod("errorbars","supplyDefaults");f(n,o,x||w.defaultLine,{axis:"y"}),f(n,o,x||w.defaultLine,{axis:"x",inherit:"y"})}else o.visible=!1}},{"../../components/color":367,"../../lib":515,"../../registry":647,"../bar/defaults":661,"../bar/style_defaults":672,"./attributes":821}],830:[function(m,G,Y){G.exports=function(d,v,w,y,e){if(d.x="xVal"in v?v.xVal:v.x,d.y="yVal"in v?v.yVal:v.y,"zLabelVal"in v&&(d.z=v.zLabelVal),v.xa&&(d.xaxis=v.xa),v.ya&&(d.yaxis=v.ya),!(w.cumulative||{}).enabled){var t,n=Array.isArray(e)?y[0].pts[e[0]][e[1]]:y[e].pts;if(d.pointNumbers=n,d.binNumber=d.pointNumber,delete d.pointNumber,delete d.pointIndex,w._indexToPoints){t=[];for(var o=0;o<n.length;o++)t=t.concat(w._indexToPoints[n[o]])}else t=n;d.pointIndices=t}return d}},{}],831:[function(m,G,Y){var d=m("../bar/hover").hoverPoints,v=m("../../plots/cartesian/axes").hoverLabelText;G.exports=function(w,y,e,t,n){var o=d(w,y,e,t,n);if(o){var r=(w=o[0]).cd[w.index],g=w.cd[0].trace;if(!g.cumulative.enabled){var c=g.orientation==="h"?"y":"x";w[c+"Label"]=v(w[c+"a"],[r.ph0,r.ph1],g[c+"hoverformat"])}return o}}},{"../../plots/cartesian/axes":566,"../bar/hover":664}],832:[function(m,G,Y){G.exports={attributes:m("./attributes"),layoutAttributes:m("../bar/layout_attributes"),supplyDefaults:m("./defaults"),crossTraceDefaults:m("./cross_trace_defaults"),supplyLayoutDefaults:m("../bar/layout_defaults"),calc:m("./calc").calc,crossTraceCalc:m("../bar/cross_trace_calc").crossTraceCalc,plot:m("../bar/plot").plot,layerName:"barlayer",style:m("../bar/style").style,styleOnSelect:m("../bar/style").styleOnSelect,colorbar:m("../scatter/marker_colorbar"),hoverPoints:m("./hover"),selectPoints:m("../bar/select"),eventData:m("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:m("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../bar/cross_trace_calc":660,"../bar/layout_attributes":666,"../bar/layout_defaults":667,"../bar/plot":668,"../bar/select":669,"../bar/style":671,"../scatter/marker_colorbar":954,"./attributes":821,"./calc":826,"./cross_trace_defaults":828,"./defaults":829,"./event_data":830,"./hover":831}],833:[function(m,G,Y){G.exports={percent:function(d,v){for(var w=d.length,y=100/v,e=0;e<w;e++)d[e]*=y},probability:function(d,v){for(var w=d.length,y=0;y<w;y++)d[y]/=v},density:function(d,v,w,y){var e=d.length;y=y||1;for(var t=0;t<e;t++)d[t]*=w[t]*y},"probability density":function(d,v,w,y){var e=d.length;y&&(v/=y);for(var t=0;t<e;t++)d[t]*=w[t]/v}}},{}],834:[function(m,G,Y){var d=m("../histogram/attributes"),v=m("../histogram/bin_attributes"),w=m("../heatmap/attributes"),y=m("../../plots/attributes"),e=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,t=m("../../plots/template_attributes").hovertemplateAttrs,n=m("../../plots/template_attributes").texttemplateAttrs,o=m("../../components/colorscale/attributes"),r=m("../../lib/extend").extendFlat;G.exports=r({x:d.x,y:d.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:d.histnorm,histfunc:d.histfunc,nbinsx:d.nbinsx,xbins:v("x"),nbinsy:d.nbinsy,ybins:v("y"),autobinx:d.autobinx,autobiny:d.autobiny,bingroup:r({},d.bingroup,{}),xbingroup:r({},d.bingroup,{}),ybingroup:r({},d.bingroup,{}),xgap:w.xgap,ygap:w.ygap,zsmooth:w.zsmooth,xhoverformat:e("x"),yhoverformat:e("y"),zhoverformat:e("z",1),hovertemplate:t({},{keys:"z"}),texttemplate:n({arrayOk:!1,editType:"plot"},{keys:"z"}),textfont:w.textfont,showlegend:r({},y.showlegend,{dflt:!1})},o("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../heatmap/attributes":801,"../histogram/attributes":821,"../histogram/bin_attributes":823}],835:[function(m,G,Y){var d=m("../../lib"),v=m("../../plots/cartesian/axes"),w=m("../histogram/bin_functions"),y=m("../histogram/norm_functions"),e=m("../histogram/average"),t=m("../histogram/bin_label_vals"),n=m("../histogram/calc").calcAllAutoBins;function o(c,a,h,l){var s,p=new Array(c);if(l)for(s=0;s<c;s++)p[s]=1/(a[s+1]-a[s]);else{var u=1/h;for(s=0;s<c;s++)p[s]=u}return p}function r(c,a){return{start:c(a.start),end:c(a.end),size:a.size}}function g(c,a,h,l,s,p){var u,i=c.length-1,x=new Array(i),f=t(h,l,c,s,p);for(u=0;u<i;u++){var _=(a||[])[u];x[u]=_===void 0?[f(c[u]),f(c[u+1],!0)]:[_,_]}return x}G.exports=function(c,a){var h,l,s,p,u=v.getFromId(c,a.xaxis),i=v.getFromId(c,a.yaxis),x=a.xcalendar,f=a.ycalendar,_=function(nt){return u.r2c(nt,0,x)},b=function(nt){return i.r2c(nt,0,f)},T=n(c,a,u,"x"),k=T[0],L=T[1],A=n(c,a,i,"y"),I=A[0],P=A[1],S=a._length;L.length>S&&L.splice(S,L.length-S),P.length>S&&P.splice(S,P.length-S);var E=[],z=[],D=[],j=typeof k.size=="string",V=typeof I.size=="string",Z=[],Q=[],X=j?Z:k,$=V?Q:I,re=0,H=[],N=[],U=a.histnorm,te=a.histfunc,B=U.indexOf("density")!==-1,K=te==="max"||te==="min"?null:0,J=w.count,ee=y[U],ne=!1,se=[],oe=[],me="z"in a?a.z:"marker"in a&&Array.isArray(a.marker.color)?a.marker.color:"";me&&te!=="count"&&(ne=te==="avg",J=w[te]);var ce=k.size,ye=_(k.start),Se=_(k.end)+(ye-v.tickIncrement(ye,ce,!1,x))/1e6;for(h=ye;h<Se;h=v.tickIncrement(h,ce,!1,x))z.push(K),Z.push(h),ne&&D.push(0);Z.push(h);var fe,ge=z.length,Te=(h-ye)/ge,le=(fe=ye+Te/2,u.c2r(fe,0,x)),ve=I.size,Me=b(I.start),we=b(I.end)+(Me-v.tickIncrement(Me,ve,!1,f))/1e6;for(h=Me;h<we;h=v.tickIncrement(h,ve,!1,f)){E.push(z.slice()),Q.push(h);var de=new Array(ge);for(l=0;l<ge;l++)de[l]=[];N.push(de),ne&&H.push(D.slice())}Q.push(h);var Ie=E.length,De=(h-Me)/Ie,Oe=function(nt){return i.c2r(nt,0,f)}(Me+De/2);B&&(se=o(z.length,X,Te,j),oe=o(E.length,$,De,V)),j||u.type!=="date"||(X=r(_,X)),V||i.type!=="date"||($=r(b,$));var Ve=!0,Fe=!0,ze=new Array(ge),Re=new Array(Ie),We=1/0,$e=1/0,at=1/0,gt=1/0;for(h=0;h<S;h++){var xt=L[h],mt=P[h];s=d.findBin(xt,X),p=d.findBin(mt,$),s>=0&&s<ge&&p>=0&&p<Ie&&(re+=J(s,h,E[p],me,H[p]),N[p][s].push(h),Ve&&(ze[s]===void 0?ze[s]=xt:ze[s]!==xt&&(Ve=!1)),Fe&&(Re[p]===void 0?Re[p]=mt:Re[p]!==mt&&(Fe=!1)),We=Math.min(We,xt-Z[s]),$e=Math.min($e,Z[s+1]-xt),at=Math.min(at,mt-Q[p]),gt=Math.min(gt,Q[p+1]-mt))}if(ne)for(p=0;p<Ie;p++)re+=e(E[p],H[p]);if(ee)for(p=0;p<Ie;p++)ee(E[p],re,se,oe[p]);return{x:L,xRanges:g(Z,Ve&&ze,We,$e,u,x),x0:le,dx:Te,y:P,yRanges:g(Q,Fe&&Re,at,gt,i,f),y0:Oe,dy:De,z:E,pts:N}}},{"../../lib":515,"../../plots/cartesian/axes":566,"../histogram/average":822,"../histogram/bin_functions":824,"../histogram/bin_label_vals":825,"../histogram/calc":826,"../histogram/norm_functions":833}],836:[function(m,G,Y){var d=m("../../lib"),v=m("./sample_defaults"),w=m("../heatmap/style_defaults"),y=m("../../components/colorscale/defaults"),e=m("../heatmap/label_defaults"),t=m("./attributes");G.exports=function(n,o,r,g){function c(a,h){return d.coerce(n,o,t,a,h)}v(n,o,c,g),o.visible!==!1&&(w(n,o,c,g),y(n,o,g,c,{prefix:"",cLetter:"z"}),c("hovertemplate"),e(c,g),c("xhoverformat"),c("yhoverformat"))}},{"../../components/colorscale/defaults":377,"../../lib":515,"../heatmap/label_defaults":811,"../heatmap/style_defaults":815,"./attributes":834,"./sample_defaults":839}],837:[function(m,G,Y){var d=m("../heatmap/hover"),v=m("../../plots/cartesian/axes").hoverLabelText;G.exports=function(w,y,e,t,n){var o=d(w,y,e,t,n);if(o){var r=(w=o[0]).index,g=r[0],c=r[1],a=w.cd[0],h=a.trace,l=a.xRanges[c],s=a.yRanges[g];return w.xLabel=v(w.xa,[l[0],l[1]],h.xhoverformat),w.yLabel=v(w.ya,[s[0],s[1]],h.yhoverformat),o}}},{"../../plots/cartesian/axes":566,"../heatmap/hover":808}],838:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),crossTraceDefaults:m("../histogram/cross_trace_defaults"),calc:m("../heatmap/calc"),plot:m("../heatmap/plot"),layerName:"heatmaplayer",colorbar:m("../heatmap/colorbar"),style:m("../heatmap/style"),hoverPoints:m("./hover"),eventData:m("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../heatmap/calc":802,"../heatmap/colorbar":804,"../heatmap/plot":813,"../heatmap/style":814,"../histogram/cross_trace_defaults":828,"../histogram/event_data":830,"./attributes":834,"./defaults":836,"./hover":837}],839:[function(m,G,Y){var d=m("../../registry"),v=m("../../lib");G.exports=function(w,y,e,t){var n=e("x"),o=e("y"),r=v.minRowLength(n),g=v.minRowLength(o);r&&g?(y._length=Math.min(r,g),d.getComponentMethod("calendars","handleTraceDefaults")(w,y,["x","y"],t),(e("z")||e("marker.color"))&&e("histfunc"),e("histnorm"),e("autobinx"),e("autobiny")):y.visible=!1}},{"../../lib":515,"../../registry":647}],840:[function(m,G,Y){var d=m("../histogram2d/attributes"),v=m("../contour/attributes"),w=m("../../components/colorscale/attributes"),y=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=m("../../lib/extend").extendFlat;G.exports=e({x:d.x,y:d.y,z:d.z,marker:d.marker,histnorm:d.histnorm,histfunc:d.histfunc,nbinsx:d.nbinsx,xbins:d.xbins,nbinsy:d.nbinsy,ybins:d.ybins,autobinx:d.autobinx,autobiny:d.autobiny,bingroup:d.bingroup,xbingroup:d.xbingroup,ybingroup:d.ybingroup,autocontour:v.autocontour,ncontours:v.ncontours,contours:v.contours,line:{color:v.line.color,width:e({},v.line.width,{dflt:.5}),dash:v.line.dash,smoothing:v.line.smoothing,editType:"plot"},xhoverformat:y("x"),yhoverformat:y("y"),zhoverformat:y("z",1),hovertemplate:d.hovertemplate,texttemplate:v.texttemplate,textfont:v.textfont},w("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../contour/attributes":744,"../histogram2d/attributes":834}],841:[function(m,G,Y){var d=m("../../lib"),v=m("../histogram2d/sample_defaults"),w=m("../contour/contours_defaults"),y=m("../contour/style_defaults"),e=m("../heatmap/label_defaults"),t=m("./attributes");G.exports=function(n,o,r,g){function c(a,h){return d.coerce(n,o,t,a,h)}v(n,o,c,g),o.visible!==!1&&(w(n,o,c,function(a){return d.coerce2(n,o,t,a)}),y(n,o,c,g),c("xhoverformat"),c("yhoverformat"),c("hovertemplate"),o.contours&&o.contours.coloring==="heatmap"&&e(c,g))}},{"../../lib":515,"../contour/contours_defaults":751,"../contour/style_defaults":765,"../heatmap/label_defaults":811,"../histogram2d/sample_defaults":839,"./attributes":840}],842:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),crossTraceDefaults:m("../histogram/cross_trace_defaults"),calc:m("../contour/calc"),plot:m("../contour/plot").plot,layerName:"contourlayer",style:m("../contour/style"),colorbar:m("../contour/colorbar"),hoverPoints:m("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":578,"../contour/calc":745,"../contour/colorbar":747,"../contour/hover":757,"../contour/plot":762,"../contour/style":764,"../histogram/cross_trace_defaults":828,"./attributes":840,"./defaults":841}],843:[function(m,G,Y){var d=m("../../plots/template_attributes").hovertemplateAttrs,v=m("../../plots/template_attributes").texttemplateAttrs,w=m("../../components/colorscale/attributes"),y=m("../../plots/domain").attributes,e=m("../pie/attributes"),t=m("../sunburst/attributes"),n=m("../treemap/attributes"),o=m("../treemap/constants"),r=m("../../lib/extend").extendFlat;G.exports={labels:t.labels,parents:t.parents,values:t.values,branchvalues:t.branchvalues,count:t.count,level:t.level,maxdepth:t.maxdepth,tiling:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"plot"},flip:n.tiling.flip,pad:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},marker:r({colors:t.marker.colors,line:t.marker.line,editType:"calc"},w("marker",{colorAttr:"colors",anim:!1})),leaf:t.leaf,pathbar:n.pathbar,text:e.text,textinfo:t.textinfo,texttemplate:v({editType:"plot"},{keys:o.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:t.hoverinfo,hovertemplate:d({},{keys:o.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:n.outsidetextfont,textposition:n.textposition,sort:e.sort,root:t.root,domain:y({name:"icicle",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"../sunburst/attributes":1058,"../treemap/attributes":1084,"../treemap/constants":1087}],844:[function(m,G,Y){var d=m("../../plots/plots");Y.name="icicle",Y.plot=function(v,w,y,e){d.plotBasePlot(Y.name,v,w,y,e)},Y.clean=function(v,w,y,e){d.cleanBasePlot(Y.name,v,w,y,e)}},{"../../plots/plots":628}],845:[function(m,G,Y){var d=m("../sunburst/calc");Y.calc=function(v,w){return d.calc(v,w)},Y.crossTraceCalc=function(v){return d._runCrossTraceCalc("icicle",v)}},{"../sunburst/calc":1060}],846:[function(m,G,Y){var d=m("../../lib"),v=m("./attributes"),w=m("../../components/color"),y=m("../../plots/domain").defaults,e=m("../bar/defaults").handleText,t=m("../bar/constants").TEXTPAD,n=m("../../components/colorscale"),o=n.hasColorscale,r=n.handleDefaults;G.exports=function(g,c,a,h){function l(_,b){return d.coerce(g,c,v,_,b)}var s=l("labels"),p=l("parents");if(s&&s.length&&p&&p.length){var u=l("values");u&&u.length?l("branchvalues"):l("count"),l("level"),l("maxdepth"),l("tiling.orientation"),l("tiling.flip"),l("tiling.pad");var i=l("text");l("texttemplate"),c.texttemplate||l("textinfo",Array.isArray(i)?"text+label":"label"),l("hovertext"),l("hovertemplate");var x=l("pathbar.visible");e(g,c,h,l,"auto",{hasPathbar:x,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),l("textposition"),l("marker.line.width")&&l("marker.line.color",h.paper_bgcolor),l("marker.colors");var f=c._hasColorscale=o(g,"marker","colors")||(g.marker||{}).coloraxis;f&&r(g,c,h,l,{prefix:"marker.",cLetter:"c"}),l("leaf.opacity",f?1:.7),c._hovered={marker:{line:{width:2,color:w.contrast(h.paper_bgcolor)}}},x&&(l("pathbar.thickness",c.pathbar.textfont.size+2*t),l("pathbar.side"),l("pathbar.edgeshape")),l("sort"),l("root.color"),y(c,h,l),c._length=null}else c.visible=!1}},{"../../components/color":367,"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/constants":659,"../bar/defaults":661,"./attributes":843}],847:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../components/drawing"),y=m("../../lib/svg_text_utils"),e=m("./partition"),t=m("./style").styleOne,n=m("../treemap/constants"),o=m("../sunburst/helpers"),r=m("../sunburst/fx"),g=m("../sunburst/plot").formatSliceLabel;G.exports=function(c,a,h,l,s){var p=s.width,u=s.height,i=s.viewX,x=s.viewY,f=s.pathSlice,_=s.toMoveInsideSlice,b=s.strTransform,T=s.hasTransition,k=s.handleSlicesExit,L=s.makeUpdateSliceInterpolator,A=s.makeUpdateTextInterpolator,I=s.prevEntry,P=c._context.staticPlot,S=c._fullLayout,E=a[0].trace,z=E.textposition.indexOf("left")!==-1,D=E.textposition.indexOf("right")!==-1,j=E.textposition.indexOf("bottom")!==-1,V=e(h,[p,u],{flipX:E.tiling.flip.indexOf("x")>-1,flipY:E.tiling.flip.indexOf("y")>-1,orientation:E.tiling.orientation,pad:{inner:E.tiling.pad},maxDepth:E._maxDepth}).descendants(),Z=1/0,Q=-1/0;V.forEach(function(N){var U=N.depth;U>=E._maxDepth?(N.x0=N.x1=(N.x0+N.x1)/2,N.y0=N.y1=(N.y0+N.y1)/2):(Z=Math.min(Z,U),Q=Math.max(Q,U))}),l=l.data(V,o.getPtId),E._maxVisibleLayers=isFinite(Q)?Q-Z+1:0,l.enter().append("g").classed("slice",!0),k(l,!1,{},[p,u],f),l.order();var X=null;if(T&&I){var $=o.getPtId(I);l.each(function(N){X===null&&o.getPtId(N)===$&&(X={x0:N.x0,x1:N.x1,y0:N.y0,y1:N.y1})})}var re=function(){return X||{x0:0,x1:p,y0:0,y1:u}},H=l;return T&&(H=H.transition().each("end",function(){var N=d.select(this);o.setSliceCursor(N,c,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),H.each(function(N){N._x0=i(N.x0),N._x1=i(N.x1),N._y0=x(N.y0),N._y1=x(N.y1),N._hoverX=i(N.x1-E.tiling.pad),N._hoverY=x(j?N.y1-E.tiling.pad/2:N.y0+E.tiling.pad/2);var U=d.select(this),te=v.ensureSingle(U,"path","surface",function(ee){ee.style("pointer-events",P?"none":"all")});T?te.transition().attrTween("d",function(ee){var ne=L(ee,!1,re(),[p,u],{orientation:E.tiling.orientation,flipX:E.tiling.flip.indexOf("x")>-1,flipY:E.tiling.flip.indexOf("y")>-1});return function(se){return f(ne(se))}}):te.attr("d",f),U.call(r,h,c,a,{styleOne:t,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(o.setSliceCursor,c,{isTransitioning:c._transitioning}),te.call(t,N,E,{hovered:!1}),N.x0===N.x1||N.y0===N.y1?N._text="":N._text=g(N,h,E,a,S)||"";var B=v.ensureSingle(U,"g","slicetext"),K=v.ensureSingle(B,"text","",function(ee){ee.attr("data-notex",1)}),J=v.ensureUniformFontSize(c,o.determineTextFont(E,N,S.font));K.text(N._text||" ").classed("slicetext",!0).attr("text-anchor",D?"end":z?"start":"middle").call(w.font,J).call(y.convertToTspans,c),N.textBB=w.bBox(K.node()),N.transform=_(N,{fontSize:J.size}),N.transform.fontSize=J.size,T?K.transition().attrTween("transform",function(ee){var ne=A(ee,!1,re(),[p,u]);return function(se){return b(ne(se))}}):K.attr("transform",b(N))}),X}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"../sunburst/plot":1068,"../treemap/constants":1087,"./partition":851,"./style":853,"@plotly/d3":58}],848:[function(m,G,Y){G.exports={moduleType:"trace",name:"icicle",basePlotModule:m("./base_plot"),categories:[],animatable:!0,attributes:m("./attributes"),layoutAttributes:m("./layout_attributes"),supplyDefaults:m("./defaults"),supplyLayoutDefaults:m("./layout_defaults"),calc:m("./calc").calc,crossTraceCalc:m("./calc").crossTraceCalc,plot:m("./plot"),style:m("./style").style,colorbar:m("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":843,"./base_plot":844,"./calc":845,"./defaults":846,"./layout_attributes":849,"./layout_defaults":850,"./plot":852,"./style":853}],849:[function(m,G,Y){G.exports={iciclecolorway:{valType:"colorlist",editType:"calc"},extendiciclecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],850:[function(m,G,Y){var d=m("../../lib"),v=m("./layout_attributes");G.exports=function(w,y){function e(t,n){return d.coerce(w,y,v,t,n)}e("iciclecolorway",y.colorway),e("extendiciclecolors")}},{"../../lib":515,"./layout_attributes":849}],851:[function(m,G,Y){var d=m("d3-hierarchy"),v=m("../treemap/flip_tree");G.exports=function(w,y,e){var t=e.flipX,n=e.flipY,o=e.orientation==="h",r=e.maxDepth,g=y[0],c=y[1];r&&(g=(w.height+1)*y[0]/Math.min(w.height+1,r),c=(w.height+1)*y[1]/Math.min(w.height+1,r));var a=d.partition().padding(e.pad.inner).size(o?[y[1],g]:[y[0],c])(w);return(o||t||n)&&v(a,y,{swapXY:o,flipX:t,flipY:n}),a}},{"../treemap/flip_tree":1092,"d3-hierarchy":115}],852:[function(m,G,Y){var d=m("../treemap/draw"),v=m("./draw_descendants");G.exports=function(w,y,e,t){return d(w,y,e,t,{type:"icicle",drawDescendants:v})}},{"../treemap/draw":1089,"./draw_descendants":847}],853:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../components/color"),w=m("../../lib"),y=m("../bar/uniform_text").resizeText;function e(t,n,o){var r=n.data.data,g=!n.children,c=r.i,a=w.castOption(o,c,"marker.line.color")||v.defaultLine,h=w.castOption(o,c,"marker.line.width")||0;t.style("stroke-width",h).call(v.fill,r.color).call(v.stroke,a).style("opacity",g?o.leaf.opacity:null)}G.exports={style:function(t){var n=t._fullLayout._iciclelayer.selectAll(".trace");y(t,n,"icicle"),n.each(function(o){var r=d.select(this),g=o[0].trace;r.style("opacity",g.opacity),r.selectAll("path.surface").each(function(c){d.select(this).call(e,c,g)})})},styleOne:e}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"@plotly/d3":58}],854:[function(m,G,Y){for(var d=m("../../plots/attributes"),v=m("../../plots/template_attributes").hovertemplateAttrs,w=m("../../lib/extend").extendFlat,y=m("./constants").colormodel,e=["rgb","rgba","rgba256","hsl","hsla"],t=[],n=[],o=0;o<e.length;o++){var r=y[e[o]];t.push("For the `"+e[o]+"` colormodel, it is ["+(r.zminDflt||r.min).join(", ")+"]."),n.push("For the `"+e[o]+"` colormodel, it is ["+(r.zmaxDflt||r.max).join(", ")+"].")}G.exports=w({source:{valType:"string",editType:"calc"},z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:e,editType:"calc"},zsmooth:{valType:"enumerated",values:["fast",!1],dflt:!1,editType:"plot"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:w({},d.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:v({},{keys:["z","color","colormodel"]}),transforms:void 0})},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"./constants":856}],855:[function(m,G,Y){var d=m("../../lib"),v=m("./constants"),w=m("fast-isnumeric"),y=m("../../plots/cartesian/axes"),e=m("../../lib").maxRowLength,t=m("./helpers").getImageSize;function n(r,g,c,a){return function(h){return d.constrain((h-r)*g,c,a)}}function o(r,g){return function(c){return d.constrain(c,r,g)}}G.exports=function(r,g){var c,a;if(g._hasZ)c=g.z.length,a=e(g.z);else if(g._hasSource){var h=t(g.source);c=h.height,a=h.width}var l,s=y.getFromId(r,g.xaxis||"x"),p=y.getFromId(r,g.yaxis||"y"),u=s.d2c(g.x0)-g.dx/2,i=p.d2c(g.y0)-g.dy/2,x=[u,u+a*g.dx],f=[i,i+c*g.dy];if(s&&s.type==="log")for(l=0;l<a;l++)x.push(u+l*g.dx);if(p&&p.type==="log")for(l=0;l<c;l++)f.push(i+l*g.dy);return g._extremes[s._id]=y.findExtremes(s,x),g._extremes[p._id]=y.findExtremes(p,f),g._scaler=function(_){var b=v.colormodel[_.colormodel],T=(b.colormodel||_.colormodel).length;_._sArray=[];for(var k=0;k<T;k++)b.min[k]!==_.zmin[k]||b.max[k]!==_.zmax[k]?_._sArray.push(n(_.zmin[k],(b.max[k]-b.min[k])/(_.zmax[k]-_.zmin[k]),b.min[k],b.max[k])):_._sArray.push(o(b.min[k],b.max[k]));return function(L){for(var A=L.slice(0,T),I=0;I<T;I++){var P=A[I];if(!w(P))return!1;A[I]=_._sArray[I](P)}return A}}(g),[{x0:u,y0:i,z:g.z,w:a,h:c}]}},{"../../lib":515,"../../plots/cartesian/axes":566,"./constants":856,"./helpers":859,"fast-isnumeric":190}],856:[function(m,G,Y){G.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(d){return d.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(d){return d.slice(0,4)},suffix:["","","",""]},rgba256:{colormodel:"rgba",zminDflt:[0,0,0,0],zmaxDflt:[255,255,255,255],min:[0,0,0,0],max:[255,255,255,1],fmt:function(d){return d.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(d){var v=d.slice(0,3);return v[1]=v[1]+"%",v[2]=v[2]+"%",v},suffix:["\xB0","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(d){var v=d.slice(0,4);return v[1]=v[1]+"%",v[2]=v[2]+"%",v},suffix:["\xB0","%","%",""]}},pixelatedStyle:["image-rendering: optimizeSpeed","image-rendering: -moz-crisp-edges","image-rendering: -o-crisp-edges","image-rendering: -webkit-optimize-contrast","image-rendering: optimize-contrast","image-rendering: crisp-edges","image-rendering: pixelated",""].join("; ")}},{}],857:[function(m,G,Y){var d=m("../../lib"),v=m("./attributes"),w=m("./constants"),y=m("../../snapshot/helpers").IMAGE_URL_PREFIX;G.exports=function(e,t){function n(g,c){return d.coerce(e,t,v,g,c)}n("source"),t.source&&!t.source.match(y)&&delete t.source,t._hasSource=!!t.source;var o,r=n("z");t._hasZ=!(r===void 0||!r.length||!r[0]||!r[0].length),t._hasZ||t._hasSource?(n("x0"),n("y0"),n("dx"),n("dy"),t._hasZ?(n("colormodel","rgb"),n("zmin",(o=w.colormodel[t.colormodel]).zminDflt||o.min),n("zmax",o.zmaxDflt||o.max)):t._hasSource&&(t.colormodel="rgba256",o=w.colormodel[t.colormodel],t.zmin=o.zminDflt,t.zmax=o.zmaxDflt),n("zsmooth"),n("text"),n("hovertext"),n("hovertemplate"),t._length=null):t.visible=!1}},{"../../lib":515,"../../snapshot/helpers":651,"./attributes":854,"./constants":856}],858:[function(m,G,Y){G.exports=function(d,v){return"xVal"in v&&(d.x=v.xVal),"yVal"in v&&(d.y=v.yVal),v.xa&&(d.xaxis=v.xa),v.ya&&(d.yaxis=v.ya),d.color=v.color,d.colormodel=v.trace.colormodel,d.z||(d.z=v.color),d}},{}],859:[function(m,G,Y){var d=m("probe-image-size/sync"),v=m("../../snapshot/helpers").IMAGE_URL_PREFIX,w=m("buffer/").Buffer;Y.getImageSize=function(y){var e=y.replace(v,""),t=new w(e,"base64");return d(t)}},{"../../snapshot/helpers":651,"buffer/":85,"probe-image-size/sync":277}],860:[function(m,G,Y){var d=m("../../components/fx"),v=m("../../lib"),w=m("./constants");G.exports=function(y,e,t){var n=y.cd[0],o=n.trace,r=y.xa,g=y.ya;if(!(d.inbox(e-n.x0,e-(n.x0+n.w*o.dx),0)>0||d.inbox(t-n.y0,t-(n.y0+n.h*o.dy),0)>0)){var c,a=Math.floor((e-n.x0)/o.dx),h=Math.floor(Math.abs(t-n.y0)/o.dy);if(o._hasZ?c=n.z[h][a]:o._hasSource&&(c=o._canvas.el.getContext("2d",{willReadFrequently:!0}).getImageData(a,h,1,1).data),c){var l,s=n.hi||o.hoverinfo;if(s){var p=s.split("+");p.indexOf("all")!==-1&&(p=["color"]),p.indexOf("color")!==-1&&(l=!0)}var u,i=w.colormodel[o.colormodel],x=i.colormodel||o.colormodel,f=x.length,_=o._scaler(c),b=i.suffix,T=[];(o.hovertemplate||l)&&(T.push("["+[_[0]+b[0],_[1]+b[1],_[2]+b[2]].join(", ")),f===4&&T.push(", "+_[3]+b[3]),T.push("]"),T=T.join(""),y.extraText=x.toUpperCase()+": "+T),Array.isArray(o.hovertext)&&Array.isArray(o.hovertext[h])?u=o.hovertext[h][a]:Array.isArray(o.text)&&Array.isArray(o.text[h])&&(u=o.text[h][a]);var k=g.c2p(n.y0+(h+.5)*o.dy),L=n.x0+(a+.5)*o.dx,A=n.y0+(h+.5)*o.dy,I="["+c.slice(0,o.colormodel.length).join(", ")+"]";return[v.extendFlat(y,{index:[h,a],x0:r.c2p(n.x0+a*o.dx),x1:r.c2p(n.x0+(a+1)*o.dx),y0:k,y1:k,color:_,xVal:L,xLabelVal:L,yVal:A,yLabelVal:A,zLabelVal:I,text:u,hovertemplateLabels:{zLabel:I,colorLabel:T,"color[0]Label":_[0]+b[0],"color[1]Label":_[1]+b[1],"color[2]Label":_[2]+b[2],"color[3]Label":_[3]+b[3]}})]}}}},{"../../components/fx":407,"../../lib":515,"./constants":856}],861:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),calc:m("./calc"),plot:m("./plot"),style:m("./style"),hoverPoints:m("./hover"),eventData:m("./event_data"),moduleType:"trace",name:"image",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:!1,meta:{}}},{"../../plots/cartesian":578,"./attributes":854,"./calc":855,"./defaults":857,"./event_data":858,"./hover":860,"./plot":862,"./style":863}],862:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../lib"),w=v.strTranslate,y=m("../../constants/xmlns_namespaces"),e=m("./constants"),t=v.isIOS()||v.isSafari()||v.isIE();G.exports=function(n,o,r,g){var c=o.xaxis,a=o.yaxis,h=!(t||n._context._exportedPlot);v.makeTraceGroups(g,r,"im").each(function(l){var s=d.select(this),p=l[0],u=p.trace,i=(u.zsmooth==="fast"||u.zsmooth===!1&&h)&&!u._hasZ&&u._hasSource&&c.type==="linear"&&a.type==="linear";u._realImage=i;var x,f,_,b,T,k,L=p.z,A=p.x0,I=p.y0,P=p.w,S=p.h,E=u.dx,z=u.dy;for(k=0;x===void 0&&k<P;)x=c.c2p(A+k*E),k++;for(k=P;f===void 0&&k>0;)f=c.c2p(A+k*E),k--;for(k=0;b===void 0&&k<S;)b=a.c2p(I+k*z),k++;for(k=S;T===void 0&&k>0;)T=a.c2p(I+k*z),k--;f<x&&(_=f,f=x,x=_),T<b&&(_=b,b=T,T=_),!i&&(x=Math.max(-.5*c._length,x),f=Math.min(1.5*c._length,f),b=Math.max(-.5*a._length,b),T=Math.min(1.5*a._length,T));var D=Math.round(f-x),j=Math.round(T-b);if(D<=0||j<=0)s.selectAll("image").data([]).exit().remove();else{var V=s.selectAll("image").data([l]);V.enter().append("svg:image").attr({xmlns:y.svg,preserveAspectRatio:"none"}),V.exit().remove();var Z=u.zsmooth===!1?e.pixelatedStyle:"";if(i){var Q=v.simpleMap(c.range,c.r2l),X=v.simpleMap(a.range,a.r2l),$=Q[1]<Q[0],re=X[1]>X[0];if($||re){var H=x+D/2,N=b+j/2;Z+="transform:"+w(H+"px",N+"px")+"scale("+($?-1:1)+","+(re?-1:1)+")"+w(-H+"px",-N+"px")+";"}}V.attr("style",Z);var U=new Promise(function(B){if(u._hasZ)B();else if(u._hasSource)if(u._canvas&&u._canvas.el.width===P&&u._canvas.el.height===S&&u._canvas.source===u.source)B();else{var K=document.createElement("canvas");K.width=P,K.height=S;var J=K.getContext("2d",{willReadFrequently:!0});u._image=u._image||new Image;var ee=u._image;ee.onload=function(){J.drawImage(ee,0,0),u._canvas={el:K,source:u.source},B()},ee.setAttribute("src",u.source)}}).then(function(){var B;if(u._hasZ)B=te(function(J,ee){return L[ee][J]}).toDataURL("image/png");else if(u._hasSource)if(i)B=u.source;else{var K=u._canvas.el.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,P,S).data;B=te(function(J,ee){var ne=4*(ee*P+J);return[K[ne],K[ne+1],K[ne+2],K[ne+3]]}).toDataURL("image/png")}V.attr({"xlink:href":B,height:j,width:D,x,y:b})});n._promises.push(U)}function te(B){var K=document.createElement("canvas");K.width=D,K.height=j;var J,ee=K.getContext("2d",{willReadFrequently:!0}),ne=function(le){return v.constrain(Math.round(c.c2p(A+le*E)-x),0,D)},se=function(le){return v.constrain(Math.round(a.c2p(I+le*z)-b),0,j)},oe=e.colormodel[u.colormodel],me=oe.colormodel||u.colormodel,ce=oe.fmt;for(k=0;k<p.w;k++){var ye=ne(k),Se=ne(k+1);if(Se!==ye&&!isNaN(Se)&&!isNaN(ye))for(var fe=0;fe<p.h;fe++){var ge=se(fe),Te=se(fe+1);Te===ge||isNaN(Te)||isNaN(ge)||!B(k,fe)||(J=u._scaler(B(k,fe)),ee.fillStyle=J?me+"("+ce(J).join(",")+")":"rgba(0,0,0,0)",ee.fillRect(ye,ge,Se-ye,Te-ge))}}return K}})}},{"../../constants/xmlns_namespaces":492,"../../lib":515,"./constants":856,"@plotly/d3":58}],863:[function(m,G,Y){var d=m("@plotly/d3");G.exports=function(v){d.select(v).selectAll(".im image").style("opacity",function(w){return w[0].trace.opacity})}},{"@plotly/d3":58}],864:[function(m,G,Y){var d=m("../../lib/extend").extendFlat,v=m("../../lib/extend").extendDeep,w=m("../../plot_api/edit_types").overrideAll,y=m("../../plots/font_attributes"),e=m("../../components/color/attributes"),t=m("../../plots/domain").attributes,n=m("../../plots/cartesian/layout_attributes"),o=m("../../plot_api/plot_template").templatedArray,r=m("../../constants/delta.js"),g=m("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,c=y({editType:"plot",colorEditType:"plot"}),a={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:e.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},h={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},l=o("step",v({},a,{range:h}));G.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:t({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:d({},c,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot",description:g("value")},font:d({},c,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot",description:g("value")},increasing:{symbol:{valType:"string",dflt:r.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:r.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:r.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:r.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:d({},c,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:v({},a,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:e.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:w({range:h,visible:d({},n.visible,{dflt:!0}),tickmode:n.tickmode,nticks:n.nticks,tick0:n.tick0,dtick:n.dtick,tickvals:n.tickvals,ticktext:n.ticktext,ticks:d({},n.ticks,{dflt:"outside"}),ticklen:n.ticklen,tickwidth:n.tickwidth,tickcolor:n.tickcolor,ticklabelstep:n.ticklabelstep,showticklabels:n.showticklabels,tickfont:y({}),tickangle:n.tickangle,tickformat:n.tickformat,tickformatstops:n.tickformatstops,tickprefix:n.tickprefix,showtickprefix:n.showtickprefix,ticksuffix:n.ticksuffix,showticksuffix:n.showticksuffix,separatethousands:n.separatethousands,exponentformat:n.exponentformat,minexponent:n.minexponent,showexponent:n.showexponent,editType:"plot"},"plot"),steps:l,threshold:{line:{color:d({},a.line.color,{}),width:d({},a.line.width,{dflt:1}),editType:"plot"},thickness:d({},a.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":366,"../../constants/delta.js":485,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/layout_attributes":579,"../../plots/domain":593,"../../plots/font_attributes":594}],865:[function(m,G,Y){var d=m("../../plots/plots");Y.name="indicator",Y.plot=function(v,w,y,e){d.plotBasePlot(Y.name,v,w,y,e)},Y.clean=function(v,w,y,e){d.cleanBasePlot(Y.name,v,w,y,e)}},{"../../plots/plots":628}],866:[function(m,G,Y){G.exports={calc:function(d,v){var w=[],y=v.value;typeof v._lastValue!="number"&&(v._lastValue=v.value);var e=v._lastValue,t=e;return v._hasDelta&&typeof v.delta.reference=="number"&&(t=v.delta.reference),w[0]={y,lastY:e,delta:y-t,relativeDelta:(y-t)/t},w}}},{}],867:[function(m,G,Y){G.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],868:[function(m,G,Y){var d=m("../../lib"),v=m("./attributes"),w=m("../../plots/domain").defaults,y=m("../../plot_api/plot_template"),e=m("../../plots/array_container_defaults"),t=m("./constants.js"),n=m("../../plots/cartesian/tick_value_defaults"),o=m("../../plots/cartesian/tick_mark_defaults"),r=m("../../plots/cartesian/tick_label_defaults"),g=m("../../plots/cartesian/prefix_suffix_defaults");function c(a,h){function l(s,p){return d.coerce(a,h,v.gauge.steps,s,p)}l("color"),l("line.color"),l("line.width"),l("range"),l("thickness")}G.exports={supplyDefaults:function(a,h,l,s){function p(P,S){return d.coerce(a,h,v,P,S)}w(h,s,p),p("mode"),h._hasNumber=h.mode.indexOf("number")!==-1,h._hasDelta=h.mode.indexOf("delta")!==-1,h._hasGauge=h.mode.indexOf("gauge")!==-1;var u=p("value");h._range=[0,typeof u=="number"?1.5*u:1];var i,x,f,_,b,T,k=new Array(2);function L(P,S){return d.coerce(f,_,v.gauge,P,S)}function A(P,S){return d.coerce(b,T,v.gauge.axis,P,S)}if(h._hasNumber&&(p("number.valueformat"),p("number.font.color",s.font.color),p("number.font.family",s.font.family),p("number.font.size"),h.number.font.size===void 0&&(h.number.font.size=t.defaultNumberFontSize,k[0]=!0),p("number.prefix"),p("number.suffix"),i=h.number.font.size),h._hasDelta&&(p("delta.font.color",s.font.color),p("delta.font.family",s.font.family),p("delta.font.size"),h.delta.font.size===void 0&&(h.delta.font.size=(h._hasNumber?.5:1)*(i||t.defaultNumberFontSize),k[1]=!0),p("delta.reference",h.value),p("delta.relative"),p("delta.valueformat",h.delta.relative?"2%":""),p("delta.increasing.symbol"),p("delta.increasing.color"),p("delta.decreasing.symbol"),p("delta.decreasing.color"),p("delta.position"),p("delta.prefix"),p("delta.suffix"),x=h.delta.font.size),h._scaleNumbers=(!h._hasNumber||k[0])&&(!h._hasDelta||k[1])||!1,p("title.font.color",s.font.color),p("title.font.family",s.font.family),p("title.font.size",.25*(i||x||t.defaultNumberFontSize)),p("title.text"),h._hasGauge){(f=a.gauge)||(f={}),_=y.newContainer(h,"gauge"),L("shape"),(h._isBullet=h.gauge.shape==="bullet")||p("title.align","center"),(h._isAngular=h.gauge.shape==="angular")||p("align","center"),L("bgcolor",s.paper_bgcolor),L("borderwidth"),L("bordercolor"),L("bar.color"),L("bar.line.color"),L("bar.line.width"),L("bar.thickness",t.valueThickness*(h.gauge.shape==="bullet"?.5:1)),e(f,_,{name:"steps",handleItemDefaults:c}),L("threshold.value"),L("threshold.thickness"),L("threshold.line.width"),L("threshold.line.color"),b={},f&&(b=f.axis||{}),T=y.newContainer(_,"axis"),A("visible"),h._range=A("range",h._range);var I={outerTicks:!0};n(b,T,A,"linear"),g(b,T,A,"linear",I),r(b,T,A,"linear",I),o(b,T,A,I)}else p("title.align","center"),p("align","center"),h._isAngular=h._isBullet=!1;h._length=null}}},{"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../../plots/cartesian/prefix_suffix_defaults":583,"../../plots/cartesian/tick_label_defaults":587,"../../plots/cartesian/tick_mark_defaults":588,"../../plots/cartesian/tick_value_defaults":589,"../../plots/domain":593,"./attributes":864,"./constants.js":867}],869:[function(m,G,Y){G.exports={moduleType:"trace",name:"indicator",basePlotModule:m("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:m("./attributes"),supplyDefaults:m("./defaults").supplyDefaults,calc:m("./calc").calc,plot:m("./plot"),meta:{}}},{"./attributes":864,"./base_plot":865,"./calc":866,"./defaults":868,"./plot":870}],870:[function(m,G,Y){var d=m("@plotly/d3"),v=m("d3-interpolate").interpolate,w=m("d3-interpolate").interpolateNumber,y=m("../../lib"),e=y.strScale,t=y.strTranslate,n=y.rad2deg,o=m("../../constants/alignment").MID_SHIFT,r=m("../../components/drawing"),g=m("./constants"),c=m("../../lib/svg_text_utils"),a=m("../../plots/cartesian/axes"),h=m("../../plots/cartesian/axis_defaults"),l=m("../../plots/cartesian/position_defaults"),s=m("../../plots/cartesian/layout_attributes"),p=m("../../components/color"),u={left:"start",center:"middle",right:"end"},i={left:0,center:.5,right:1},x=/[yzafpn\xb5mkMGTPEZY]/;function f(A){return A&&A.duration>0}function _(A){A.each(function(I){p.stroke(d.select(this),I.line.color)}).each(function(I){p.fill(d.select(this),I.color)}).style("stroke-width",function(I){return I.line.width})}function b(A,I,P){var S=A._fullLayout,E=y.extendFlat({type:"linear",ticks:"outside",range:P,showline:!0},I),z={type:"linear",_id:"x"+I._id},D={letter:"x",font:S.font,noHover:!0,noTickson:!0};function j(V,Z){return y.coerce(E,z,s,V,Z)}return h(E,z,j,D,S),l(E,z,j,D),z}function T(A,I,P){return[Math.min(I/A.width,P/A.height),A,I+"x"+P]}function k(A,I,P,S){var E=document.createElementNS("http://www.w3.org/2000/svg","text"),z=d.select(E);return z.text(A).attr("x",0).attr("y",0).attr("text-anchor",P).attr("data-unformatted",A).call(c.convertToTspans,S).call(r.font,I),r.bBox(z.node())}function L(A,I,P,S,E,z){var D="_cache"+I;A[D]&&A[D].key===E||(A[D]={key:E,value:P});var j=y.aggNums(z,null,[A[D].value,S],2);return A[D].value=j,j}G.exports=function(A,I,P,S){var E,z=A._fullLayout;f(P)&&S&&(E=S()),y.makeTraceGroups(z._indicatorlayer,I,"trace").each(function(D){var j,V,Z,Q,X,$=D[0].trace,re=d.select(this),H=$._hasGauge,N=$._isAngular,U=$._isBullet,te=$.domain,B={w:z._size.w*(te.x[1]-te.x[0]),h:z._size.h*(te.y[1]-te.y[0]),l:z._size.l+z._size.w*te.x[0],r:z._size.r+z._size.w*(1-te.x[1]),t:z._size.t+z._size.h*(1-te.y[1]),b:z._size.b+z._size.h*te.y[0]},K=B.l+B.w/2,J=B.t+B.h/2,ee=Math.min(B.w/2,B.h),ne=g.innerRadius*ee,se=$.align||"center";if(V=J,H){if(N&&(j=K,V=J+ee/2,Z=function(Te){return function(le,ve){var Me=Math.sqrt(le.width/2*(le.width/2)+le.height*le.height);return[ve/Me,le,ve]}(Te,.9*ne)}),U){var oe=g.bulletPadding,me=1-g.bulletNumberDomainSize+oe;j=B.l+(me+(1-me)*i[se])*B.w,Z=function(Te){return T(Te,(g.bulletNumberDomainSize-oe)*B.w,B.h)}}}else j=B.l+i[se]*B.w,Z=function(Te){return T(Te,B.w,B.h)};(function(Te,le,ve,Me){var we,de,Ie,De=ve[0].trace,Oe=Me.numbersX,Ve=Me.numbersY,Fe=De.align||"center",ze=u[Fe],Re=Me.transitionOpts,We=Me.onComplete,$e=y.ensureSingle(le,"g","numbers"),at=[];De._hasNumber&&at.push("number"),De._hasDelta&&(at.push("delta"),De.delta.position==="left"&&at.reverse());var gt=$e.selectAll("text").data(at);function xt(Zt,cr,Dt,Ne){if(!Zt.match("s")||Dt>=0==Ne>=0||cr(Dt).slice(-1).match(x)||cr(Ne).slice(-1).match(x))return cr;var Ye=Zt.slice().replace("s","f").replace(/\d+/,function(_e){return parseInt(_e)-1}),pe=b(Te,{tickformat:Ye});return function(_e){return Math.abs(_e)<1?a.tickText(pe,_e).text:cr(_e)}}gt.enter().append("text"),gt.attr("text-anchor",function(){return ze}).attr("class",function(Zt){return Zt}).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),gt.exit().remove();var mt,nt=De.mode+De.align;if(De._hasDelta&&(mt=function(){var Zt=b(Te,{tickformat:De.delta.valueformat},De._range);Zt.setScale(),a.prepTicks(Zt);var cr=function(Je){return a.tickText(Zt,Je).text},Dt=De.delta.suffix,Ne=De.delta.prefix,Ye=function(Je){return De.delta.relative?Je.relativeDelta:Je.delta},pe=function(Je,Ze){return Je===0||typeof Je!="number"||isNaN(Je)?"-":(Je>0?De.delta.increasing.symbol:De.delta.decreasing.symbol)+Ne+Ze(Je)+Dt},_e=function(Je){return Je.delta>=0?De.delta.increasing.color:De.delta.decreasing.color};De._deltaLastValue===void 0&&(De._deltaLastValue=Ye(ve[0]));var Be=$e.select("text.delta");function He(){Be.text(pe(Ye(ve[0]),cr)).call(p.fill,_e(ve[0])).call(c.convertToTspans,Te)}return Be.call(r.font,De.delta.font).call(p.fill,_e({delta:De._deltaLastValue})),f(Re)?Be.transition().duration(Re.duration).ease(Re.easing).tween("text",function(){var Je=d.select(this),Ze=Ye(ve[0]),ct=De._deltaLastValue,lt=xt(De.delta.valueformat,cr,ct,Ze),At=w(ct,Ze);return De._deltaLastValue=Ze,function(Ot){Je.text(pe(At(Ot),lt)),Je.call(p.fill,_e({delta:At(Ot)}))}}).each("end",function(){He(),We&&We()}).each("interrupt",function(){He(),We&&We()}):He(),de=k(pe(Ye(ve[0]),cr),De.delta.font,ze,Te),Be}(),nt+=De.delta.position+De.delta.font.size+De.delta.font.family+De.delta.valueformat,nt+=De.delta.increasing.symbol+De.delta.decreasing.symbol,Ie=de),De._hasNumber&&(function(){var Zt=b(Te,{tickformat:De.number.valueformat},De._range);Zt.setScale(),a.prepTicks(Zt);var cr=function(_e){return a.tickText(Zt,_e).text},Dt=De.number.suffix,Ne=De.number.prefix,Ye=$e.select("text.number");function pe(){var _e=typeof ve[0].y=="number"?Ne+cr(ve[0].y)+Dt:"-";Ye.text(_e).call(r.font,De.number.font).call(c.convertToTspans,Te)}f(Re)?Ye.transition().duration(Re.duration).ease(Re.easing).each("end",function(){pe(),We&&We()}).each("interrupt",function(){pe(),We&&We()}).attrTween("text",function(){var _e=d.select(this),Be=w(ve[0].lastY,ve[0].y);De._lastValue=ve[0].y;var He=xt(De.number.valueformat,cr,ve[0].lastY,ve[0].y);return function(Je){_e.text(Ne+He(Be(Je))+Dt)}}):pe(),we=k(Ne+cr(ve[0].y)+Dt,De.number.font,ze,Te)}(),nt+=De.number.font.size+De.number.font.family+De.number.valueformat+De.number.suffix+De.number.prefix,Ie=we),De._hasDelta&&De._hasNumber){var Qe,vt,jt=[(we.left+we.right)/2,(we.top+we.bottom)/2],Gt=[(de.left+de.right)/2,(de.top+de.bottom)/2],$t=.75*De.delta.font.size;De.delta.position==="left"&&(Qe=L(De,"deltaPos",0,-1*(we.width*i[De.align]+de.width*(1-i[De.align])+$t),nt,Math.min),vt=jt[1]-Gt[1],Ie={width:we.width+de.width+$t,height:Math.max(we.height,de.height),left:de.left+Qe,right:we.right,top:Math.min(we.top,de.top+vt),bottom:Math.max(we.bottom,de.bottom+vt)}),De.delta.position==="right"&&(Qe=L(De,"deltaPos",0,we.width*(1-i[De.align])+de.width*i[De.align]+$t,nt,Math.max),vt=jt[1]-Gt[1],Ie={width:we.width+de.width+$t,height:Math.max(we.height,de.height),left:we.left,right:de.right+Qe,top:Math.min(we.top,de.top+vt),bottom:Math.max(we.bottom,de.bottom+vt)}),De.delta.position==="bottom"&&(Qe=null,vt=de.height,Ie={width:Math.max(we.width,de.width),height:we.height+de.height,left:Math.min(we.left,de.left),right:Math.max(we.right,de.right),top:we.bottom-we.height,bottom:we.bottom+de.height}),De.delta.position==="top"&&(Qe=null,vt=we.top,Ie={width:Math.max(we.width,de.width),height:we.height+de.height,left:Math.min(we.left,de.left),right:Math.max(we.right,de.right),top:we.bottom-we.height-de.height,bottom:we.bottom}),mt.attr({dx:Qe,dy:vt})}(De._hasNumber||De._hasDelta)&&$e.attr("transform",function(){var Zt=Me.numbersScaler(Ie);nt+=Zt[2];var cr,Dt=L(De,"numbersScale",1,Zt[0],nt,Math.min);De._scaleNumbers||(Dt=1),cr=De._isAngular?Ve-Dt*Ie.bottom:Ve-Dt*(Ie.top+Ie.bottom)/2,De._numbersTop=Dt*Ie.top+cr;var Ne=Ie[Fe];Fe==="center"&&(Ne=(Ie.left+Ie.right)/2);var Ye=Oe-Dt*Ne;return Ye=L(De,"numbersTranslate",0,Ye,nt,Math.max),t(Ye,cr)+e(Dt)})})(A,re,D,{numbersX:j,numbersY:V,numbersScaler:Z,transitionOpts:P,onComplete:E}),H&&(Q={range:$.gauge.axis.range,color:$.gauge.bgcolor,line:{color:$.gauge.bordercolor,width:0},thickness:1},X={range:$.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:$.gauge.bordercolor,width:$.gauge.borderwidth},thickness:1});var ce=re.selectAll("g.angular").data(N?D:[]);ce.exit().remove();var ye=re.selectAll("g.angularaxis").data(N?D:[]);ye.exit().remove(),N&&function(Te,le,ve,Me){var we,de,Ie,De,Oe=ve[0].trace,Ve=Me.size,Fe=Me.radius,ze=Me.innerRadius,Re=Me.gaugeBg,We=Me.gaugeOutline,$e=[Ve.l+Ve.w/2,Ve.t+Ve.h/2+Fe/2],at=Me.gauge,gt=Me.layer,xt=Me.transitionOpts,mt=Me.onComplete,nt=Math.PI/2;function Qe(Ot){var it=Oe.gauge.axis.range[0],ht=(Ot-it)/(Oe.gauge.axis.range[1]-it)*Math.PI-nt;return ht<-nt?-nt:ht>nt?nt:ht}function vt(Ot){return d.svg.arc().innerRadius((ze+Fe)/2-Ot/2*(Fe-ze)).outerRadius((ze+Fe)/2+Ot/2*(Fe-ze)).startAngle(-nt)}function jt(Ot){Ot.attr("d",function(it){return vt(it.thickness).startAngle(Qe(it.range[0])).endAngle(Qe(it.range[1]))()})}at.enter().append("g").classed("angular",!0),at.attr("transform",t($e[0],$e[1])),gt.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),gt.selectAll("g.xangularaxistick,path,text").remove(),(we=b(Te,Oe.gauge.axis)).type="linear",we.range=Oe.gauge.axis.range,we._id="xangularaxis",we.ticklabeloverflow="allow",we.setScale();var Gt=function(Ot){return(we.range[0]-Ot.x)/(we.range[1]-we.range[0])*Math.PI+Math.PI},$t={},Zt=a.makeLabelFns(we,0).labelStandoff;$t.xFn=function(Ot){var it=Gt(Ot);return Math.cos(it)*Zt},$t.yFn=function(Ot){var it=Gt(Ot),ht=Math.sin(it)>0?.2:1;return-Math.sin(it)*(Zt+Ot.fontSize*ht)+Math.abs(Math.cos(it))*(Ot.fontSize*o)},$t.anchorFn=function(Ot){var it=Gt(Ot),ht=Math.cos(it);return Math.abs(ht)<.1?"middle":ht>0?"start":"end"},$t.heightFn=function(Ot,it,ht){var Ut=Gt(Ot);return-.5*(1+Math.sin(Ut))*ht};var cr=function(Ot){return t($e[0]+Fe*Math.cos(Ot),$e[1]-Fe*Math.sin(Ot))};if(Ie=function(Ot){return cr(Gt(Ot))},de=a.calcTicks(we),De=a.getTickSigns(we)[2],we.visible){De=we.ticks==="inside"?-1:1;var Dt=(we.linewidth||1)/2;a.drawTicks(Te,we,{vals:de,layer:gt,path:"M"+De*Dt+",0h"+De*we.ticklen,transFn:function(Ot){var it=Gt(Ot);return cr(it)+"rotate("+-n(it)+")"}}),a.drawLabels(Te,we,{vals:de,layer:gt,transFn:Ie,labelFns:$t})}var Ne=[Re].concat(Oe.gauge.steps),Ye=at.selectAll("g.bg-arc").data(Ne);Ye.enter().append("g").classed("bg-arc",!0).append("path"),Ye.select("path").call(jt).call(_),Ye.exit().remove();var pe=vt(Oe.gauge.bar.thickness),_e=at.selectAll("g.value-arc").data([Oe.gauge.bar]);_e.enter().append("g").classed("value-arc",!0).append("path");var Be=_e.select("path");f(xt)?(Be.transition().duration(xt.duration).ease(xt.easing).each("end",function(){mt&&mt()}).each("interrupt",function(){mt&&mt()}).attrTween("d",(He=pe,Je=Qe(ve[0].lastY),Ze=Qe(ve[0].y),function(){var Ot=v(Je,Ze);return function(it){return He.endAngle(Ot(it))()}})),Oe._lastValue=ve[0].y):Be.attr("d",typeof ve[0].y=="number"?pe.endAngle(Qe(ve[0].y)):"M0,0Z");var He,Je,Ze;Be.call(_),_e.exit().remove(),Ne=[];var ct=Oe.gauge.threshold.value;(ct||ct===0)&&Ne.push({range:[ct,ct],color:Oe.gauge.threshold.color,line:{color:Oe.gauge.threshold.line.color,width:Oe.gauge.threshold.line.width},thickness:Oe.gauge.threshold.thickness});var lt=at.selectAll("g.threshold-arc").data(Ne);lt.enter().append("g").classed("threshold-arc",!0).append("path"),lt.select("path").call(jt).call(_),lt.exit().remove();var At=at.selectAll("g.gauge-outline").data([We]);At.enter().append("g").classed("gauge-outline",!0).append("path"),At.select("path").call(jt).call(_),At.exit().remove()}(A,0,D,{radius:ee,innerRadius:ne,gauge:ce,layer:ye,size:B,gaugeBg:Q,gaugeOutline:X,transitionOpts:P,onComplete:E});var Se=re.selectAll("g.bullet").data(U?D:[]);Se.exit().remove();var fe=re.selectAll("g.bulletaxis").data(U?D:[]);fe.exit().remove(),U&&function(Te,le,ve,Me){var we,de,Ie,De,Oe,Ve=ve[0].trace,Fe=Me.gauge,ze=Me.layer,Re=Me.gaugeBg,We=Me.gaugeOutline,$e=Me.size,at=Ve.domain,gt=Me.transitionOpts,xt=Me.onComplete;Fe.enter().append("g").classed("bullet",!0),Fe.attr("transform",t($e.l,$e.t)),ze.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),ze.selectAll("g.xbulletaxistick,path,text").remove();var mt=$e.h,nt=Ve.gauge.bar.thickness*mt,Qe=at.x[0],vt=at.x[0]+(at.x[1]-at.x[0])*(Ve._hasNumber||Ve._hasDelta?1-g.bulletNumberDomainSize:1);(we=b(Te,Ve.gauge.axis))._id="xbulletaxis",we.domain=[Qe,vt],we.setScale(),de=a.calcTicks(we),Ie=a.makeTransTickFn(we),De=a.getTickSigns(we)[2],Oe=$e.t+$e.h,we.visible&&(a.drawTicks(Te,we,{vals:we.ticks==="inside"?a.clipEnds(we,de):de,layer:ze,path:a.makeTickPath(we,Oe,De),transFn:Ie}),a.drawLabels(Te,we,{vals:de,layer:ze,transFn:Ie,labelFns:a.makeLabelFns(we,Oe)}));function jt(Ye){Ye.attr("width",function(pe){return Math.max(0,we.c2p(pe.range[1])-we.c2p(pe.range[0]))}).attr("x",function(pe){return we.c2p(pe.range[0])}).attr("y",function(pe){return .5*(1-pe.thickness)*mt}).attr("height",function(pe){return pe.thickness*mt})}var Gt=[Re].concat(Ve.gauge.steps),$t=Fe.selectAll("g.bg-bullet").data(Gt);$t.enter().append("g").classed("bg-bullet",!0).append("rect"),$t.select("rect").call(jt).call(_),$t.exit().remove();var Zt=Fe.selectAll("g.value-bullet").data([Ve.gauge.bar]);Zt.enter().append("g").classed("value-bullet",!0).append("rect"),Zt.select("rect").attr("height",nt).attr("y",(mt-nt)/2).call(_),f(gt)?Zt.select("rect").transition().duration(gt.duration).ease(gt.easing).each("end",function(){xt&&xt()}).each("interrupt",function(){xt&&xt()}).attr("width",Math.max(0,we.c2p(Math.min(Ve.gauge.axis.range[1],ve[0].y)))):Zt.select("rect").attr("width",typeof ve[0].y=="number"?Math.max(0,we.c2p(Math.min(Ve.gauge.axis.range[1],ve[0].y))):0),Zt.exit().remove();var cr=ve.filter(function(){return Ve.gauge.threshold.value||Ve.gauge.threshold.value===0}),Dt=Fe.selectAll("g.threshold-bullet").data(cr);Dt.enter().append("g").classed("threshold-bullet",!0).append("line"),Dt.select("line").attr("x1",we.c2p(Ve.gauge.threshold.value)).attr("x2",we.c2p(Ve.gauge.threshold.value)).attr("y1",(1-Ve.gauge.threshold.thickness)/2*mt).attr("y2",(1-(1-Ve.gauge.threshold.thickness)/2)*mt).call(p.stroke,Ve.gauge.threshold.line.color).style("stroke-width",Ve.gauge.threshold.line.width),Dt.exit().remove();var Ne=Fe.selectAll("g.gauge-outline").data([We]);Ne.enter().append("g").classed("gauge-outline",!0).append("rect"),Ne.select("rect").call(jt).call(_),Ne.exit().remove()}(A,0,D,{gauge:Se,layer:fe,size:B,gaugeBg:Q,gaugeOutline:X,transitionOpts:P,onComplete:E});var ge=re.selectAll("text.title").data(D);ge.exit().remove(),ge.enter().append("text").classed("title",!0),ge.attr("text-anchor",function(){return U?u.right:u[$.title.align]}).text($.title.text).call(r.font,$.title.font).call(c.convertToTspans,A),ge.attr("transform",function(){var Te,le=B.l+B.w*i[$.title.align],ve=g.titlePadding,Me=r.bBox(ge.node());return H?(N&&($.gauge.axis.visible?Te=r.bBox(ye.node()).top-ve-Me.bottom:Te=B.t+B.h/2-ee/2-Me.bottom-ve),U&&(Te=V-(Me.top+Me.bottom)/2,le=B.l-g.bulletPadding*B.w)):Te=$._numbersTop-ve-Me.bottom,t(le,Te)})})}},{"../../components/color":367,"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_defaults":568,"../../plots/cartesian/layout_attributes":579,"../../plots/cartesian/position_defaults":582,"./constants":867,"@plotly/d3":58,"d3-interpolate":116}],871:[function(m,G,Y){var d=m("../../components/colorscale/attributes"),v=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,w=m("../../plots/template_attributes").hovertemplateAttrs,y=m("../mesh3d/attributes"),e=m("../../plots/attributes"),t=m("../../lib/extend").extendFlat,n=m("../../plot_api/edit_types").overrideAll,o=G.exports=n(t({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}},caps:{x:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},y:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}},z:{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:w(),xhoverformat:v("x"),yhoverformat:v("y"),zhoverformat:v("z"),valuehoverformat:v("value",1),showlegend:t({},e.showlegend,{dflt:!1})},d("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:y.opacity,lightposition:y.lightposition,lighting:y.lighting,flatshading:y.flatshading,contour:y.contour,hoverinfo:t({},e.hoverinfo)}),"calc","nested");o.flatshading.dflt=!0,o.lighting.facenormalsepsilon.dflt=0,o.x.editType=o.y.editType=o.z.editType=o.value.editType="calc+clearAxisTypes",o.transforms=void 0},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],872:[function(m,G,Y){var d=m("../../components/colorscale/calc"),v=m("../streamtube/calc").processGrid,w=m("../streamtube/calc").filter;G.exports=function(y,e){e._len=Math.min(e.x.length,e.y.length,e.z.length,e.value.length),e._x=w(e.x,e._len),e._y=w(e.y,e._len),e._z=w(e.z,e._len),e._value=w(e.value,e._len);var t=v(e);e._gridFill=t.fill,e._Xs=t.Xs,e._Ys=t.Ys,e._Zs=t.Zs,e._len=t.len;for(var n=1/0,o=-1/0,r=0;r<e._len;r++){var g=e._value[r];n=Math.min(n,g),o=Math.max(o,g)}e._minValues=n,e._maxValues=o,e._vMin=e.isomin===void 0||e.isomin===null?n:e.isomin,e._vMax=e.isomax===void 0||e.isomin===null?o:e.isomax,d(y,e,{vals:[e._vMin,e._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375,"../streamtube/calc":1054}],873:[function(m,G,Y){var d=m("../../../stackgl_modules").gl_mesh3d,v=m("../../lib/gl_format_color").parseColorScale,w=m("../../lib/str2rgbarray"),y=m("../../components/colorscale").extractOpts,e=m("../../plots/gl3d/zip3"),t=function(c,a){for(var h=a.length-1;h>0;h--){var l=Math.min(a[h],a[h-1]),s=Math.max(a[h],a[h-1]);if(s>l&&l<c&&c<=s)return{id:h,distRatio:(s-c)/(s-l)}}return{id:0,distRatio:0}};function n(c,a,h){this.scene=c,this.uid=h,this.mesh=a,this.name="",this.data=null,this.showContour=!1}var o=n.prototype;o.handlePick=function(c){if(c.object===this.mesh){var a=c.data.index,h=this.data._meshX[a],l=this.data._meshY[a],s=this.data._meshZ[a],p=this.data._Ys.length,u=this.data._Zs.length,i=t(h,this.data._Xs).id,x=t(l,this.data._Ys).id,f=t(s,this.data._Zs).id,_=c.index=f+u*x+u*p*i;c.traceCoordinate=[this.data._meshX[_],this.data._meshY[_],this.data._meshZ[_],this.data._value[_]];var b=this.data.hovertext||this.data.text;return Array.isArray(b)&&b[_]!==void 0?c.textLabel=b[_]:b&&(c.textLabel=b),!0}},o.update=function(c){var a=this.scene,h=a.fullSceneLayout;function l(u,i,x,f){return i.map(function(_){return u.d2l(_,0,f)*x})}this.data=g(c);var s={positions:e(l(h.xaxis,c._meshX,a.dataScale[0],c.xcalendar),l(h.yaxis,c._meshY,a.dataScale[1],c.ycalendar),l(h.zaxis,c._meshZ,a.dataScale[2],c.zcalendar)),cells:e(c._meshI,c._meshJ,c._meshK),lightPosition:[c.lightposition.x,c.lightposition.y,c.lightposition.z],ambient:c.lighting.ambient,diffuse:c.lighting.diffuse,specular:c.lighting.specular,roughness:c.lighting.roughness,fresnel:c.lighting.fresnel,vertexNormalsEpsilon:c.lighting.vertexnormalsepsilon,faceNormalsEpsilon:c.lighting.facenormalsepsilon,opacity:c.opacity,contourEnable:c.contour.show,contourColor:w(c.contour.color).slice(0,3),contourWidth:c.contour.width,useFacetNormals:c.flatshading},p=y(c);s.vertexIntensity=c._meshIntensity,s.vertexIntensityBounds=[p.min,p.max],s.colormap=v(c),this.mesh.update(s)},o.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};var r=["xyz","xzy","yxz","yzx","zxy","zyx"];function g(c){c._meshI=[],c._meshJ=[],c._meshK=[];var a,h,l,s,p,u,i,x=c.surface.show,f=c.spaceframe.show,_=c.surface.fill,b=c.spaceframe.fill,T=!1,k=!1,L=0,A=c._Xs,I=c._Ys,P=c._Zs,S=A.length,E=I.length,z=P.length,D=r.indexOf(c._gridFill.replace(/-/g,"").replace(/\+/g,"")),j=function(Fe,ze,Re){switch(D){case 5:return Re+z*ze+z*E*Fe;case 4:return Re+z*Fe+z*S*ze;case 3:return ze+E*Re+E*z*Fe;case 2:return ze+E*Fe+E*S*Re;case 1:return Fe+S*Re+S*z*ze;default:return Fe+S*ze+S*E*Re}},V=c._minValues,Z=c._maxValues,Q=c._vMin,X=c._vMax;function $(Fe,ze,Re){for(var We=u.length,$e=h;$e<We;$e++)if(Fe===l[$e]&&ze===s[$e]&&Re===p[$e])return $e;return-1}function re(){h=a}function H(){l=[],s=[],p=[],u=[],a=0,re()}function N(Fe,ze,Re,We){return l.push(Fe),s.push(ze),p.push(Re),u.push(We),++a-1}function U(Fe,ze,Re){for(var We=[],$e=0;$e<Fe.length;$e++)We[$e]=Fe[$e]*(1-Re)+Re*ze[$e];return We}function te(Fe){i=Fe}function B(Fe,ze){return Fe==="all"||Fe===null||Fe.indexOf(ze)>-1}function K(Fe,ze){return Fe===null?ze:Fe}function J(Fe,ze,Re){re();var We,$e,at,gt=[ze],xt=[Re];if(i>=1)gt=[ze],xt=[Re];else if(i>0){var mt=function(Dt,Ne){var Ye=Dt[0],pe=Dt[1],_e=Dt[2],Be=function(it,ht,Ut){for(var Mt=[],It=0;It<it.length;It++)Mt[It]=(it[It]+ht[It]+Ut[It])/3;return Mt}(Ye,pe,_e),He=Math.sqrt(1-i),Je=U(Be,Ye,He),Ze=U(Be,pe,He),ct=U(Be,_e,He),lt=Ne[0],At=Ne[1],Ot=Ne[2];return{xyzv:[[Ye,pe,Ze],[Ze,Je,Ye],[pe,_e,ct],[ct,Ze,pe],[_e,Ye,Je],[Je,ct,_e]],abc:[[lt,At,-1],[-1,-1,lt],[At,Ot,-1],[-1,-1,At],[Ot,lt,-1],[-1,-1,Ot]]}}(ze,Re);gt=mt.xyzv,xt=mt.abc}for(var nt=0;nt<gt.length;nt++){ze=gt[nt],Re=xt[nt];for(var Qe=[],vt=0;vt<3;vt++){var jt=ze[vt][0],Gt=ze[vt][1],$t=ze[vt][2],Zt=ze[vt][3],cr=Re[vt]>-1?Re[vt]:$(jt,Gt,$t);Qe[vt]=cr>-1?cr:N(jt,Gt,$t,K(Fe,Zt))}We=Qe[0],$e=Qe[1],at=Qe[2],c._meshI.push(We),c._meshJ.push($e),c._meshK.push(at),++L}}function ee(Fe,ze,Re,We){var $e=Fe[3];$e<Re&&($e=Re),$e>We&&($e=We);for(var at=(Fe[3]-$e)/(Fe[3]-ze[3]+1e-9),gt=[],xt=0;xt<4;xt++)gt[xt]=(1-at)*Fe[xt]+at*ze[xt];return gt}function ne(Fe,ze,Re){return Fe>=ze&&Fe<=Re}function se(Fe){var ze=.001*(X-Q);return Fe>=Q-ze&&Fe<=X+ze}function oe(Fe){for(var ze=[],Re=0;Re<4;Re++){var We=Fe[Re];ze.push([c._x[We],c._y[We],c._z[We],c._value[We]])}return ze}function me(Fe,ze,Re,We,$e,at){at||(at=1),Re=[-1,-1,-1];var gt=!1,xt=[ne(ze[0][3],We,$e),ne(ze[1][3],We,$e),ne(ze[2][3],We,$e)];if(!xt[0]&&!xt[1]&&!xt[2])return!1;var mt=function(Qe,vt,jt){return se(vt[0][3])&&se(vt[1][3])&&se(vt[2][3])?(J(Qe,vt,jt),!0):at<3&&me(Qe,vt,jt,Q,X,++at)};if(xt[0]&&xt[1]&&xt[2])return mt(Fe,ze,Re)||gt;var nt=!1;return[[0,1,2],[2,0,1],[1,2,0]].forEach(function(Qe){if(xt[Qe[0]]&&xt[Qe[1]]&&!xt[Qe[2]]){var vt=ze[Qe[0]],jt=ze[Qe[1]],Gt=ze[Qe[2]],$t=ee(Gt,vt,We,$e),Zt=ee(Gt,jt,We,$e);gt=mt(Fe,[Zt,$t,vt],[-1,-1,Re[Qe[0]]])||gt,gt=mt(Fe,[vt,jt,Zt],[Re[Qe[0]],Re[Qe[1]],-1])||gt,nt=!0}}),nt||[[0,1,2],[1,2,0],[2,0,1]].forEach(function(Qe){if(xt[Qe[0]]&&!xt[Qe[1]]&&!xt[Qe[2]]){var vt=ze[Qe[0]],jt=ze[Qe[1]],Gt=ze[Qe[2]],$t=ee(jt,vt,We,$e),Zt=ee(Gt,vt,We,$e);gt=mt(Fe,[Zt,$t,vt],[-1,-1,Re[Qe[0]]])||gt,nt=!0}}),gt}function ce(Fe,ze,Re,We){var $e=!1,at=oe(ze),gt=[ne(at[0][3],Re,We),ne(at[1][3],Re,We),ne(at[2][3],Re,We),ne(at[3][3],Re,We)];if(!(gt[0]||gt[1]||gt[2]||gt[3]))return $e;if(gt[0]&&gt[1]&&gt[2]&&gt[3])return k&&($e=function(mt,nt,Qe){var vt=function(jt,Gt,$t){J(mt,[nt[jt],nt[Gt],nt[$t]],[Qe[jt],Qe[Gt],Qe[$t]])};vt(0,1,2),vt(3,0,1),vt(2,3,0),vt(1,2,3)}(Fe,at,ze)||$e),$e;var xt=!1;return[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach(function(mt){if(gt[mt[0]]&&gt[mt[1]]&&gt[mt[2]]&&!gt[mt[3]]){var nt=at[mt[0]],Qe=at[mt[1]],vt=at[mt[2]],jt=at[mt[3]];if(k)$e=J(Fe,[nt,Qe,vt],[ze[mt[0]],ze[mt[1]],ze[mt[2]]])||$e;else{var Gt=ee(jt,nt,Re,We),$t=ee(jt,Qe,Re,We),Zt=ee(jt,vt,Re,We);$e=J(null,[Gt,$t,Zt],[-1,-1,-1])||$e}xt=!0}}),xt||([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach(function(mt){if(gt[mt[0]]&&gt[mt[1]]&&!gt[mt[2]]&&!gt[mt[3]]){var nt=at[mt[0]],Qe=at[mt[1]],vt=at[mt[2]],jt=at[mt[3]],Gt=ee(vt,nt,Re,We),$t=ee(vt,Qe,Re,We),Zt=ee(jt,Qe,Re,We),cr=ee(jt,nt,Re,We);k?($e=J(Fe,[nt,cr,Gt],[ze[mt[0]],-1,-1])||$e,$e=J(Fe,[Qe,$t,Zt],[ze[mt[1]],-1,-1])||$e):$e=function(Dt,Ne,Ye){var pe=function(_e,Be,He){J(Dt,[Ne[_e],Ne[Be],Ne[He]],[Ye[_e],Ye[Be],Ye[He]])};pe(0,1,2),pe(2,3,0)}(null,[Gt,$t,Zt,cr],[-1,-1,-1,-1])||$e,xt=!0}}),xt||[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach(function(mt){if(gt[mt[0]]&&!gt[mt[1]]&&!gt[mt[2]]&&!gt[mt[3]]){var nt=at[mt[0]],Qe=at[mt[1]],vt=at[mt[2]],jt=at[mt[3]],Gt=ee(Qe,nt,Re,We),$t=ee(vt,nt,Re,We),Zt=ee(jt,nt,Re,We);k?($e=J(Fe,[nt,Gt,$t],[ze[mt[0]],-1,-1])||$e,$e=J(Fe,[nt,$t,Zt],[ze[mt[0]],-1,-1])||$e,$e=J(Fe,[nt,Zt,Gt],[ze[mt[0]],-1,-1])||$e):$e=J(null,[Gt,$t,Zt],[-1,-1,-1])||$e,xt=!0}})),$e}function ye(Fe,ze,Re,We,$e,at,gt,xt,mt,nt,Qe){var vt=!1;return T&&(B(Fe,"A")&&(vt=ce(null,[ze,Re,We,at],nt,Qe)||vt),B(Fe,"B")&&(vt=ce(null,[Re,We,$e,mt],nt,Qe)||vt),B(Fe,"C")&&(vt=ce(null,[Re,at,gt,mt],nt,Qe)||vt),B(Fe,"D")&&(vt=ce(null,[We,at,xt,mt],nt,Qe)||vt),B(Fe,"E")&&(vt=ce(null,[Re,We,at,mt],nt,Qe)||vt)),k&&(vt=ce(Fe,[Re,We,at,mt],nt,Qe)||vt),vt}function Se(Fe,ze,Re,We,$e,at,gt,xt){return[xt[0]===!0||me(Fe,oe([ze,Re,We]),[ze,Re,We],at,gt),xt[1]===!0||me(Fe,oe([We,$e,ze]),[We,$e,ze],at,gt)]}function fe(Fe,ze,Re,We,$e,at,gt,xt,mt){return xt?Se(Fe,ze,Re,$e,We,at,gt,mt):Se(Fe,Re,$e,We,ze,at,gt,mt)}function ge(Fe,ze,Re,We,$e,at,gt){var xt,mt,nt,Qe,vt=!1,jt=function(){vt=me(Fe,[xt,mt,nt],[-1,-1,-1],$e,at)||vt,vt=me(Fe,[nt,Qe,xt],[-1,-1,-1],$e,at)||vt},Gt=gt[0],$t=gt[1],Zt=gt[2];return Gt&&(xt=U(oe([j(ze,Re-0,We-0)])[0],oe([j(ze-1,Re-0,We-0)])[0],Gt),mt=U(oe([j(ze,Re-0,We-1)])[0],oe([j(ze-1,Re-0,We-1)])[0],Gt),nt=U(oe([j(ze,Re-1,We-1)])[0],oe([j(ze-1,Re-1,We-1)])[0],Gt),Qe=U(oe([j(ze,Re-1,We-0)])[0],oe([j(ze-1,Re-1,We-0)])[0],Gt),jt()),$t&&(xt=U(oe([j(ze-0,Re,We-0)])[0],oe([j(ze-0,Re-1,We-0)])[0],$t),mt=U(oe([j(ze-0,Re,We-1)])[0],oe([j(ze-0,Re-1,We-1)])[0],$t),nt=U(oe([j(ze-1,Re,We-1)])[0],oe([j(ze-1,Re-1,We-1)])[0],$t),Qe=U(oe([j(ze-1,Re,We-0)])[0],oe([j(ze-1,Re-1,We-0)])[0],$t),jt()),Zt&&(xt=U(oe([j(ze-0,Re-0,We)])[0],oe([j(ze-0,Re-0,We-1)])[0],Zt),mt=U(oe([j(ze-0,Re-1,We)])[0],oe([j(ze-0,Re-1,We-1)])[0],Zt),nt=U(oe([j(ze-1,Re-1,We)])[0],oe([j(ze-1,Re-1,We-1)])[0],Zt),Qe=U(oe([j(ze-1,Re-0,We)])[0],oe([j(ze-1,Re-0,We-1)])[0],Zt),jt()),vt}function Te(Fe,ze,Re,We,$e,at,gt,xt,mt,nt,Qe,vt){var jt=Fe;return vt?(T&&Fe==="even"&&(jt=null),ye(jt,ze,Re,We,$e,at,gt,xt,mt,nt,Qe)):(T&&Fe==="odd"&&(jt=null),ye(jt,mt,xt,gt,at,$e,We,Re,ze,nt,Qe))}function le(Fe,ze,Re,We,$e){for(var at=[],gt=0,xt=0;xt<ze.length;xt++)for(var mt=ze[xt],nt=1;nt<z;nt++)for(var Qe=1;Qe<E;Qe++)at.push(fe(Fe,j(mt,Qe-1,nt-1),j(mt,Qe-1,nt),j(mt,Qe,nt-1),j(mt,Qe,nt),Re,We,(mt+Qe+nt)%2,$e&&$e[gt]?$e[gt]:[])),gt++;return at}function ve(Fe,ze,Re,We,$e){for(var at=[],gt=0,xt=0;xt<ze.length;xt++)for(var mt=ze[xt],nt=1;nt<S;nt++)for(var Qe=1;Qe<z;Qe++)at.push(fe(Fe,j(nt-1,mt,Qe-1),j(nt,mt,Qe-1),j(nt-1,mt,Qe),j(nt,mt,Qe),Re,We,(nt+mt+Qe)%2,$e&&$e[gt]?$e[gt]:[])),gt++;return at}function Me(Fe,ze,Re,We,$e){for(var at=[],gt=0,xt=0;xt<ze.length;xt++)for(var mt=ze[xt],nt=1;nt<E;nt++)for(var Qe=1;Qe<S;Qe++)at.push(fe(Fe,j(Qe-1,nt-1,mt),j(Qe-1,nt,mt),j(Qe,nt-1,mt),j(Qe,nt,mt),Re,We,(Qe+nt+mt)%2,$e&&$e[gt]?$e[gt]:[])),gt++;return at}function we(Fe,ze,Re){for(var We=1;We<z;We++)for(var $e=1;$e<E;$e++)for(var at=1;at<S;at++)Te(Fe,j(at-1,$e-1,We-1),j(at-1,$e-1,We),j(at-1,$e,We-1),j(at-1,$e,We),j(at,$e-1,We-1),j(at,$e-1,We),j(at,$e,We-1),j(at,$e,We),ze,Re,(at+$e+We)%2)}function de(Fe,ze,Re){T=!0,we(Fe,ze,Re),T=!1}function Ie(Fe,ze,Re,We,$e,at){for(var gt=[],xt=0,mt=0;mt<ze.length;mt++)for(var nt=ze[mt],Qe=1;Qe<z;Qe++)for(var vt=1;vt<E;vt++)gt.push(ge(Fe,nt,vt,Qe,Re,We,$e[mt],at&&at[xt]&&at[xt])),xt++;return gt}function De(Fe,ze,Re,We,$e,at){for(var gt=[],xt=0,mt=0;mt<ze.length;mt++)for(var nt=ze[mt],Qe=1;Qe<S;Qe++)for(var vt=1;vt<z;vt++)gt.push(ge(Fe,Qe,nt,vt,Re,We,$e[mt],at&&at[xt]&&at[xt])),xt++;return gt}function Oe(Fe,ze,Re,We,$e,at){for(var gt=[],xt=0,mt=0;mt<ze.length;mt++)for(var nt=ze[mt],Qe=1;Qe<E;Qe++)for(var vt=1;vt<S;vt++)gt.push(ge(Fe,vt,Qe,nt,Re,We,$e[mt],at&&at[xt]&&at[xt])),xt++;return gt}function Ve(Fe,ze){for(var Re=[],We=Fe;We<ze;We++)Re.push(We);return Re}return function(){if(H(),function(){for(var xt=0;xt<S;xt++)for(var mt=0;mt<E;mt++)for(var nt=0;nt<z;nt++){var Qe=j(xt,mt,nt);N(c._x[Qe],c._y[Qe],c._z[Qe],c._value[Qe])}}(),f&&b&&(te(b),k=!0,we(null,Q,X),k=!1),x&&_){te(_);for(var Fe=c.surface.pattern,ze=c.surface.count,Re=0;Re<ze;Re++){var We=ze===1?.5:Re/(ze-1),$e=(1-We)*Q+We*X,at=Math.abs($e-V)>Math.abs($e-Z)?[V,$e]:[$e,Z];de(Fe,at[0],at[1])}}var gt=[[Math.min(Q,Z),Math.max(Q,Z)],[Math.min(V,X),Math.max(V,X)]];["x","y","z"].forEach(function(xt){for(var mt=[],nt=0;nt<gt.length;nt++){var Qe=0,vt=gt[nt][0],jt=gt[nt][1],Gt=c.slices[xt];if(Gt.show&&Gt.fill){te(Gt.fill);var $t=[],Zt=[],cr=[];if(Gt.locations.length)for(var Dt=0;Dt<Gt.locations.length;Dt++){var Ne=t(Gt.locations[Dt],xt==="x"?A:xt==="y"?I:P);Ne.distRatio===0?$t.push(Ne.id):Ne.id>0&&(Zt.push(Ne.id),xt==="x"?cr.push([Ne.distRatio,0,0]):xt==="y"?cr.push([0,Ne.distRatio,0]):cr.push([0,0,Ne.distRatio]))}else $t=Ve(1,xt==="x"?S-1:xt==="y"?E-1:z-1);Zt.length>0&&(mt[Qe]=xt==="x"?Ie(null,Zt,vt,jt,cr,mt[Qe]):xt==="y"?De(null,Zt,vt,jt,cr,mt[Qe]):Oe(null,Zt,vt,jt,cr,mt[Qe]),Qe++),$t.length>0&&(mt[Qe]=xt==="x"?le(null,$t,vt,jt,mt[Qe]):xt==="y"?ve(null,$t,vt,jt,mt[Qe]):Me(null,$t,vt,jt,mt[Qe]),Qe++)}var Ye=c.caps[xt];Ye.show&&Ye.fill&&(te(Ye.fill),mt[Qe]=xt==="x"?le(null,[0,S-1],vt,jt,mt[Qe]):xt==="y"?ve(null,[0,E-1],vt,jt,mt[Qe]):Me(null,[0,z-1],vt,jt,mt[Qe]),Qe++)}}),L===0&&H(),c._meshX=l,c._meshY=s,c._meshZ=p,c._meshIntensity=u,c._Xs=A,c._Ys=I,c._Zs=P}(),c}G.exports={findNearestOnAxis:t,generateIsoMeshes:g,createIsosurfaceTrace:function(c,a){var h=c.glplot.gl,l=d({gl:h}),s=new n(c,l,a.uid);return l._trace=s,s.update(a),c.glplot.add(l),s}}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618}],874:[function(m,G,Y){var d=m("../../lib"),v=m("../../registry"),w=m("./attributes"),y=m("../../components/colorscale/defaults");function e(t,n,o,r,g){var c=g("isomin"),a=g("isomax");a!=null&&c!=null&&c>a&&(n.isomin=null,n.isomax=null);var h=g("x"),l=g("y"),s=g("z"),p=g("value");h&&h.length&&l&&l.length&&s&&s.length&&p&&p.length?(v.getComponentMethod("calendars","handleTraceDefaults")(t,n,["x","y","z"],r),g("valuehoverformat"),["x","y","z"].forEach(function(u){g(u+"hoverformat");var i="caps."+u;g(i+".show")&&g(i+".fill");var x="slices."+u;g(x+".show")&&(g(x+".fill"),g(x+".locations"))}),g("spaceframe.show")&&g("spaceframe.fill"),g("surface.show")&&(g("surface.count"),g("surface.fill"),g("surface.pattern")),g("contour.show")&&(g("contour.color"),g("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach(function(u){g(u)}),y(t,n,r,g,{prefix:"",cLetter:"c"}),n._length=null):n.visible=!1}G.exports={supplyDefaults:function(t,n,o,r){e(t,n,o,r,function(g,c){return d.coerce(t,n,w,g,c)})},supplyIsoDefaults:e}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":871}],875:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults").supplyDefaults,calc:m("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:m("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:m("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":871,"./calc":872,"./convert":873,"./defaults":874}],876:[function(m,G,Y){var d=m("../../components/colorscale/attributes"),v=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,w=m("../../plots/template_attributes").hovertemplateAttrs,y=m("../surface/attributes"),e=m("../../plots/attributes"),t=m("../../lib/extend").extendFlat;G.exports=t({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:w({editType:"calc"}),xhoverformat:v("x"),yhoverformat:v("y"),zhoverformat:v("z"),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},d("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:y.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:t({},y.contours.x.show,{}),color:y.contours.x.color,width:y.contours.x.width,editType:"calc"},lightposition:{x:t({},y.lightposition.x,{dflt:1e5}),y:t({},y.lightposition.y,{dflt:1e5}),z:t({},y.lightposition.z,{dflt:0}),editType:"calc"},lighting:t({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},y.lighting),hoverinfo:t({},e.hoverinfo,{editType:"calc"}),showlegend:t({},e.showlegend,{dflt:!1})})},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../surface/attributes":1070}],877:[function(m,G,Y){var d=m("../../components/colorscale/calc");G.exports=function(v,w){w.intensity&&d(v,w,{vals:w.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],878:[function(m,G,Y){var d=m("../../../stackgl_modules").gl_mesh3d,v=m("../../../stackgl_modules").delaunay_triangulate,w=m("../../../stackgl_modules").alpha_shape,y=m("../../../stackgl_modules").convex_hull,e=m("../../lib/gl_format_color").parseColorScale,t=m("../../lib/str2rgbarray"),n=m("../../components/colorscale").extractOpts,o=m("../../plots/gl3d/zip3");function r(s,p,u){this.scene=s,this.uid=u,this.mesh=p,this.name="",this.color="#fff",this.data=null,this.showContour=!1}var g=r.prototype;function c(s){for(var p=[],u=s.length,i=0;i<u;i++)p[i]=t(s[i]);return p}function a(s,p,u,i){for(var x=[],f=p.length,_=0;_<f;_++)x[_]=s.d2l(p[_],0,i)*u;return x}function h(s){for(var p=[],u=s.length,i=0;i<u;i++)p[i]=Math.round(s[i]);return p}function l(s,p){for(var u=s.length,i=0;i<u;i++)if(s[i]<=-.5||s[i]>=p-.5)return!1;return!0}g.handlePick=function(s){if(s.object===this.mesh){var p=s.index=s.data.index;s.data._cellCenter?s.traceCoordinate=s.data.dataCoordinate:s.traceCoordinate=[this.data.x[p],this.data.y[p],this.data.z[p]];var u=this.data.hovertext||this.data.text;return Array.isArray(u)&&u[p]!==void 0?s.textLabel=u[p]:u&&(s.textLabel=u),!0}},g.update=function(s){var p=this.scene,u=p.fullSceneLayout;this.data=s;var i,x=s.x.length,f=o(a(u.xaxis,s.x,p.dataScale[0],s.xcalendar),a(u.yaxis,s.y,p.dataScale[1],s.ycalendar),a(u.zaxis,s.z,p.dataScale[2],s.zcalendar));if(s.i&&s.j&&s.k){if(s.i.length!==s.j.length||s.j.length!==s.k.length||!l(s.i,x)||!l(s.j,x)||!l(s.k,x))return;i=o(h(s.i),h(s.j),h(s.k))}else i=s.alphahull===0?y(f):s.alphahull>0?w(s.alphahull,f):function(k,L){for(var A=["x","y","z"].indexOf(k),I=[],P=L.length,S=0;S<P;S++)I[S]=[L[S][(A+1)%3],L[S][(A+2)%3]];return v(I)}(s.delaunayaxis,f);var _={positions:f,cells:i,lightPosition:[s.lightposition.x,s.lightposition.y,s.lightposition.z],ambient:s.lighting.ambient,diffuse:s.lighting.diffuse,specular:s.lighting.specular,roughness:s.lighting.roughness,fresnel:s.lighting.fresnel,vertexNormalsEpsilon:s.lighting.vertexnormalsepsilon,faceNormalsEpsilon:s.lighting.facenormalsepsilon,opacity:s.opacity,contourEnable:s.contour.show,contourColor:t(s.contour.color).slice(0,3),contourWidth:s.contour.width,useFacetNormals:s.flatshading};if(s.intensity){var b=n(s);this.color="#fff";var T=s.intensitymode;_[T+"Intensity"]=s.intensity,_[T+"IntensityBounds"]=[b.min,b.max],_.colormap=e(s)}else s.vertexcolor?(this.color=s.vertexcolor[0],_.vertexColors=c(s.vertexcolor)):s.facecolor?(this.color=s.facecolor[0],_.cellColors=c(s.facecolor)):(this.color=s.color,_.meshColor=t(s.color));this.mesh.update(_)},g.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},G.exports=function(s,p){var u=s.glplot.gl,i=d({gl:u}),x=new r(s,i,p.uid);return i._trace=x,x.update(p),s.glplot.add(i),x}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618}],879:[function(m,G,Y){var d=m("../../registry"),v=m("../../lib"),w=m("../../components/colorscale/defaults"),y=m("./attributes");G.exports=function(e,t,n,o){function r(c,a){return v.coerce(e,t,y,c,a)}function g(c){var a=c.map(function(h){var l=r(h);return l&&v.isArrayOrTypedArray(l)?l:null});return a.every(function(h){return h&&h.length===a[0].length})&&a}g(["x","y","z"])?(g(["i","j","k"]),(!t.i||t.j&&t.k)&&(!t.j||t.k&&t.i)&&(!t.k||t.i&&t.j)?(d.getComponentMethod("calendars","handleTraceDefaults")(e,t,["x","y","z"],o),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach(function(c){r(c)}),r("contour.show")&&(r("contour.color"),r("contour.width")),"intensity"in e?(r("intensity"),r("intensitymode"),w(e,t,o,r,{prefix:"",cLetter:"c"})):(t.showscale=!1,"facecolor"in e?r("facecolor"):"vertexcolor"in e?r("vertexcolor"):r("color",n)),r("text"),r("hovertext"),r("hovertemplate"),r("xhoverformat"),r("yhoverformat"),r("zhoverformat"),t._length=null):t.visible=!1):t.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":876}],880:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),calc:m("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:m("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:m("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":876,"./calc":877,"./convert":878,"./defaults":879}],881:[function(m,G,Y){var d=m("../../lib").extendFlat,v=m("../scatter/attributes"),w=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,y=m("../../components/drawing/attributes").dash,e=m("../../components/fx/attributes"),t=m("../../constants/delta.js"),n=t.INCREASING.COLOR,o=t.DECREASING.COLOR,r=v.line;function g(c){return{line:{color:d({},r.color,{dflt:c}),width:r.width,dash:y,editType:"style"},editType:"style"}}G.exports={xperiod:v.xperiod,xperiod0:v.xperiod0,xperiodalignment:v.xperiodalignment,xhoverformat:w("x"),yhoverformat:w("y"),x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:d({},r.width,{}),dash:d({},y,{}),editType:"style"},increasing:g(n),decreasing:g(o),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:d({},e.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":388,"../../components/fx/attributes":398,"../../constants/delta.js":485,"../../lib":515,"../../plots/cartesian/axis_format_attributes":569,"../scatter/attributes":936}],882:[function(m,G,Y){var d=m("../../lib"),v=d._,w=m("../../plots/cartesian/axes"),y=m("../../plots/cartesian/align_period"),e=m("../../constants/numerical").BADNUM;function t(o,r,g,c){return{o,h:r,l:g,c}}function n(o,r,g,c,a,h){for(var l=a.makeCalcdata(r,"open"),s=a.makeCalcdata(r,"high"),p=a.makeCalcdata(r,"low"),u=a.makeCalcdata(r,"close"),i=Array.isArray(r.text),x=Array.isArray(r.hovertext),f=!0,_=null,b=!!r.xperiodalignment,T=[],k=0;k<c.length;k++){var L=c[k],A=l[k],I=s[k],P=p[k],S=u[k];if(L!==e&&A!==e&&I!==e&&P!==e&&S!==e){S===A?_!==null&&S!==_&&(f=S>_):f=S>A,_=S;var E=h(A,I,P,S);E.pos=L,E.yc=(A+S)/2,E.i=k,E.dir=f?"increasing":"decreasing",E.x=E.pos,E.y=[P,I],b&&(E.orig_p=g[k]),i&&(E.tx=r.text[k]),x&&(E.htx=r.hovertext[k]),T.push(E)}else T.push({pos:L,empty:!0})}return r._extremes[a._id]=w.findExtremes(a,d.concat(p,s),{padded:!0}),T.length&&(T[0].t={labels:{open:v(o,"open:")+" ",high:v(o,"high:")+" ",low:v(o,"low:")+" ",close:v(o,"close:")+" "}}),T}G.exports={calc:function(o,r){var g=w.getFromId(o,r.xaxis),c=w.getFromId(o,r.yaxis),a=function(u,i,x){var f=x._minDiff;if(!f){var _,b=u._fullData,T=[];for(f=1/0,_=0;_<b.length;_++){var k=b[_];if(k.type==="ohlc"&&k.visible===!0&&k.xaxis===i._id){T.push(k);var L=i.makeCalcdata(k,"x");k._origX=L;var A=y(x,i,"x",L).vals;k._xcalc=A;var I=d.distinctVals(A).minDiff;I&&isFinite(I)&&(f=Math.min(f,I))}}for(f===1/0&&(f=1),_=0;_<T.length;_++)T[_]._minDiff=f}return f*x.tickwidth}(o,g,r),h=r._minDiff;r._minDiff=null;var l=r._origX;r._origX=null;var s=r._xcalc;r._xcalc=null;var p=n(o,r,l,s,c,t);return r._extremes[g._id]=w.findExtremes(g,s,{vpad:h/2}),p.length?(d.extendFlat(p[0].t,{wHover:h/2,tickLen:a}),p):[{t:{empty:!0}}]},calcCommon:n}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566}],883:[function(m,G,Y){var d=m("../../lib"),v=m("./ohlc_defaults"),w=m("../scatter/period_defaults"),y=m("./attributes");function e(t,n,o,r){o(r+".line.color"),o(r+".line.width",n.line.width),o(r+".line.dash",n.line.dash)}G.exports=function(t,n,o,r){function g(c,a){return d.coerce(t,n,y,c,a)}v(t,n,g,r)?(w(t,n,r,g,{x:!0}),g("xhoverformat"),g("yhoverformat"),g("line.width"),g("line.dash"),e(t,n,g,"increasing"),e(t,n,g,"decreasing"),g("text"),g("hovertext"),g("tickwidth"),r._requestRangeslider[n.xaxis]=!0):n.visible=!1}},{"../../lib":515,"../scatter/period_defaults":956,"./attributes":881,"./ohlc_defaults":886}],884:[function(m,G,Y){var d=m("../../plots/cartesian/axes"),v=m("../../lib"),w=m("../../components/fx"),y=m("../../components/color"),e=m("../../lib").fillText,t=m("../../constants/delta.js"),n={increasing:t.INCREASING.SYMBOL,decreasing:t.DECREASING.SYMBOL};function o(c,a,h,l){var s,p,u=c.cd,i=c.xa,x=u[0].trace,f=u[0].t,_=x.type,b=_==="ohlc"?"l":"min",T=_==="ohlc"?"h":"max",k=f.bPos||0,L=f.bdPos||f.tickLen,A=f.wHover,I=Math.min(1,L/Math.abs(i.r2c(i.range[1])-i.r2c(i.range[0])));function P(Z){var Q=function(X){return X.pos+k-a}(Z);return w.inbox(Q-A,Q+A,s)}function S(Z){var Q=Z[b],X=Z[T];return Q===X||w.inbox(Q-h,X-h,s)}function E(Z){return(P(Z)+S(Z))/2}s=c.maxHoverDistance-I,p=c.maxSpikeDistance-I;var z=w.getDistanceFunction(l,P,S,E);if(w.getClosest(u,z,c),c.index===!1)return null;var D=u[c.index];if(D.empty)return null;var j=x[D.dir],V=j.line.color;return y.opacity(V)&&j.line.width?c.color=V:c.color=j.fillcolor,c.x0=i.c2p(D.pos+k-L,!0),c.x1=i.c2p(D.pos+k+L,!0),c.xLabelVal=D.orig_p!==void 0?D.orig_p:D.pos,c.spikeDistance=E(D)*p/s,c.xSpike=i.c2p(D.pos,!0),c}function r(c,a,h,l){var s=c.cd,p=c.ya,u=s[0].trace,i=s[0].t,x=[],f=o(c,a,h,l);if(!f)return[];var _=s[f.index].hi||u.hoverinfo,b=_.split("+");if(!(_==="all"||b.indexOf("y")!==-1))return[];for(var T=["high","open","close","low"],k={},L=0;L<T.length;L++){var A,I=T[L],P=u[I][f.index],S=p.c2p(P,!0);P in k?(A=k[P]).yLabel+="<br>"+i.labels[I]+d.hoverLabelText(p,P,u.yhoverformat):((A=v.extendFlat({},f)).y0=A.y1=S,A.yLabelVal=P,A.yLabel=i.labels[I]+d.hoverLabelText(p,P,u.yhoverformat),A.name="",x.push(A),k[P]=A)}return x}function g(c,a,h,l){var s=c.cd,p=c.ya,u=s[0].trace,i=s[0].t,x=o(c,a,h,l);if(!x)return[];var f=s[x.index],_=x.index=f.i,b=f.dir;function T(E){return i.labels[E]+d.hoverLabelText(p,u[E][_],u.yhoverformat)}var k=f.hi||u.hoverinfo,L=k.split("+"),A=k==="all",I=A||L.indexOf("y")!==-1,P=A||L.indexOf("text")!==-1,S=I?[T("open"),T("high"),T("low"),T("close")+"  "+n[b]]:[];return P&&e(f,u,S),x.extraText=S.join("<br>"),x.y0=x.y1=p.c2p(f.yc,!0),[x]}G.exports={hoverPoints:function(c,a,h,l){return c.cd[0].trace.hoverlabel.split?r(c,a,h,l):g(c,a,h,l)},hoverSplit:r,hoverOnPoints:g}},{"../../components/color":367,"../../components/fx":407,"../../constants/delta.js":485,"../../lib":515,"../../plots/cartesian/axes":566}],885:[function(m,G,Y){G.exports={moduleType:"trace",name:"ohlc",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:m("./attributes"),supplyDefaults:m("./defaults"),calc:m("./calc").calc,plot:m("./plot"),style:m("./style"),hoverPoints:m("./hover").hoverPoints,selectPoints:m("./select")}},{"../../plots/cartesian":578,"./attributes":881,"./calc":882,"./defaults":883,"./hover":884,"./plot":887,"./select":888,"./style":889}],886:[function(m,G,Y){var d=m("../../registry"),v=m("../../lib");G.exports=function(w,y,e,t){var n=e("x"),o=e("open"),r=e("high"),g=e("low"),c=e("close");if(e("hoverlabel.split"),d.getComponentMethod("calendars","handleTraceDefaults")(w,y,["x"],t),o&&r&&g&&c){var a=Math.min(o.length,r.length,g.length,c.length);return n&&(a=Math.min(a,v.minRowLength(n))),y._length=a,a}}},{"../../lib":515,"../../registry":647}],887:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../lib");G.exports=function(w,y,e,t){var n=y.yaxis,o=y.xaxis,r=!!o.rangebreaks;v.makeTraceGroups(t,e,"trace ohlc").each(function(g){var c=d.select(this),a=g[0],h=a.t;if(a.trace.visible!==!0||h.empty)c.remove();else{var l=h.tickLen,s=c.selectAll("path").data(v.identity);s.enter().append("path"),s.exit().remove(),s.attr("d",function(p){if(p.empty)return"M0,0Z";var u=o.c2p(p.pos-l,!0),i=o.c2p(p.pos+l,!0),x=r?(u+i)/2:o.c2p(p.pos,!0);return"M"+u+","+n.c2p(p.o,!0)+"H"+x+"M"+x+","+n.c2p(p.h,!0)+"V"+n.c2p(p.l,!0)+"M"+i+","+n.c2p(p.c,!0)+"H"+x})}})}},{"../../lib":515,"@plotly/d3":58}],888:[function(m,G,Y){G.exports=function(d,v){var w,y=d.cd,e=d.xaxis,t=d.yaxis,n=[],o=y[0].t.bPos||0;if(v===!1)for(w=0;w<y.length;w++)y[w].selected=0;else for(w=0;w<y.length;w++){var r=y[w];v.contains([e.c2p(r.pos+o),t.c2p(r.yc)],null,r.i,d)?(n.push({pointNumber:r.i,x:e.c2d(r.pos),y:t.c2d(r.yc)}),r.selected=1):r.selected=0}return n}},{}],889:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../components/drawing"),w=m("../../components/color");G.exports=function(y,e,t){var n=t||d.select(y).selectAll("g.ohlclayer").selectAll("g.trace");n.style("opacity",function(o){return o[0].trace.opacity}),n.each(function(o){var r=o[0].trace;d.select(this).selectAll("path").each(function(g){if(!g.empty){var c=r[g.dir].line;d.select(this).style("fill","none").call(w.stroke,c.color).call(v.dashLine,c.dash,c.width).style("opacity",r.selectedpoints&&!g.selected?.3:1)}})})}},{"../../components/color":367,"../../components/drawing":389,"@plotly/d3":58}],890:[function(m,G,Y){var d=m("../../lib/extend").extendFlat,v=m("../../plots/attributes"),w=m("../../plots/font_attributes"),y=m("../../components/colorscale/attributes"),e=m("../../plots/template_attributes").hovertemplateAttrs,t=m("../../plots/domain").attributes,n=d({editType:"calc"},y("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});G.exports={domain:t({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:d({},v.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:e({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:w({editType:"calc"}),tickfont:w({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:n,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,legendrank:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],891:[function(m,G,Y){var d=m("../../plots/get_data").getModuleCalcData,v=m("./plot");Y.name="parcats",Y.plot=function(w,y,e,t){var n=d(w.calcdata,"parcats");if(n.length){var o=n[0];v(w,o,e,t)}},Y.clean=function(w,y,e,t){var n=t._has&&t._has("parcats"),o=y._has&&y._has("parcats");n&&!o&&t._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":602,"./plot":896}],892:[function(m,G,Y){var d=m("../../lib/gup").wrap,v=m("../../components/colorscale/helpers").hasColorscale,w=m("../../components/colorscale/calc"),y=m("../../lib/filter_unique.js"),e=m("../../components/drawing"),t=m("../../lib"),n=m("fast-isnumeric");function o(c,a,h){c.valueInds.push(a),c.count+=h}function r(c,a,h){return{categoryInds:c,color:a,rawColor:h,valueInds:[],count:0}}function g(c,a,h){c.valueInds.push(a),c.count+=h}G.exports=function(c,a){var h=t.filterVisible(a.dimensions);if(h.length===0)return[];var l,s,p,u=h.map(function($){var re;if($.categoryorder==="trace")re=null;else if($.categoryorder==="array")re=$.categoryarray;else{re=y($.values);for(var H=!0,N=0;N<re.length;N++)if(!n(re[N])){H=!1;break}re.sort(H?t.sorterAsc:void 0),$.categoryorder==="category descending"&&(re=re.reverse())}return function(U,te){te=te==null?[]:te.map(function(me){return me});var B={},K={},J=[];te.forEach(function(me,ce){B[me]=0,K[me]=ce});for(var ee=0;ee<U.length;ee++){var ne,se=U[ee];B[se]===void 0?(B[se]=1,ne=te.push(se)-1,K[se]=ne):(B[se]++,ne=K[se]),J.push(ne)}var oe=te.map(function(me){return B[me]});return{uniqueValues:te,uniqueCounts:oe,inds:J}}($.values,re)});l=t.isArrayOrTypedArray(a.counts)?a.counts:[a.counts],function($){var re;if(function(H){for(var N=new Array(H.length),U=0;U<H.length;U++){if(H[U]<0||H[U]>=H.length||N[H[U]]!==void 0)return!1;N[H[U]]=!0}return!0}($.map(function(H){return H.displayindex})))for(re=0;re<$.length;re++)$[re]._displayindex=$[re].displayindex;else for(re=0;re<$.length;re++)$[re]._displayindex=re}(h),h.forEach(function($,re){(function(H,N){H._categoryarray=N.uniqueValues,H.ticktext===null||H.ticktext===void 0?H._ticktext=[]:H._ticktext=H.ticktext.slice();for(var U=H._ticktext.length;U<N.uniqueValues.length;U++)H._ticktext.push(N.uniqueValues[U])})($,u[re])});var i,x=a.line;x?(v(a,"line")&&w(c,a,{vals:a.line.color,containerStr:"line",cLetter:"c"}),i=e.tryColorscale(x)):i=t.identity;var f,_,b,T,k,L=h[0].values.length,A={},I=u.map(function($){return $.inds});for(p=0,f=0;f<L;f++){var P=[];for(_=0;_<I.length;_++)P.push(I[_][f]);s=l[f%l.length],p+=s;var S=(b=f,T=void 0,k=void 0,t.isArrayOrTypedArray(x.color)?k=T=x.color[b%x.color.length]:T=x.color,{color:i(T),rawColor:k}),E=P+"-"+S.rawColor;A[E]===void 0&&(A[E]=r(P,S.color,S.rawColor)),g(A[E],f,s)}var z,D=h.map(function($,re){return function(H,N,U,te,B){return{dimensionInd:H,containerInd:N,displayInd:U,dimensionLabel:te,count:B,categories:[],dragX:null}}(re,$._index,$._displayindex,$.label,p)});for(f=0;f<L;f++)for(s=l[f%l.length],_=0;_<D.length;_++){var j=D[_].containerInd,V=u[_].inds[f],Z=D[_].categories;if(Z[V]===void 0){var Q=a.dimensions[j]._categoryarray[V],X=a.dimensions[j]._ticktext[V];Z[V]={dimensionInd:_,categoryInd:z=V,categoryValue:Q,displayInd:z,categoryLabel:X,valueInds:[],count:0,dragY:null}}o(Z[V],f,s)}return d(function($,re,H){var N=$.map(function(U){return U.categories.length}).reduce(function(U,te){return Math.max(U,te)});return{dimensions:$,paths:re,trace:void 0,maxCats:N,count:H}}(D,A,p))}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"../../components/drawing":389,"../../lib":515,"../../lib/filter_unique.js":506,"../../lib/gup":512,"fast-isnumeric":190}],893:[function(m,G,Y){var d=m("../../lib"),v=m("../../components/colorscale/helpers").hasColorscale,w=m("../../components/colorscale/defaults"),y=m("../../plots/domain").defaults,e=m("../../plots/array_container_defaults"),t=m("./attributes"),n=m("../parcoords/merge_length");function o(r,g){function c(i,x){return d.coerce(r,g,t.dimensions,i,x)}var a=c("values"),h=c("visible");if(a&&a.length||(h=g.visible=!1),h){c("label"),c("displayindex",g._index);var l,s=r.categoryarray,p=Array.isArray(s)&&s.length>0;p&&(l="array");var u=c("categoryorder",l);u==="array"?(c("categoryarray"),c("ticktext")):(delete r.categoryarray,delete r.ticktext),p||u!=="array"||(g.categoryorder="trace")}}G.exports=function(r,g,c,a){function h(i,x){return d.coerce(r,g,t,i,x)}var l=e(r,g,{name:"dimensions",handleItemDefaults:o}),s=function(i,x,f,_,b){b("line.shape"),b("line.hovertemplate");var T=b("line.color",_.colorway[0]);if(v(i,"line")&&d.isArrayOrTypedArray(T)){if(T.length)return b("line.colorscale"),w(i,x,_,b,{prefix:"line.",cLetter:"c"}),T.length;x.line.color=f}return 1/0}(r,g,c,a,h);y(g,a,h),Array.isArray(l)&&l.length||(g.visible=!1),n(g,l,"values",s),h("hoveron"),h("hovertemplate"),h("arrangement"),h("bundlecolors"),h("sortpaths"),h("counts");var p={family:a.font.family,size:Math.round(a.font.size),color:a.font.color};d.coerceFont(h,"labelfont",p);var u={family:a.font.family,size:Math.round(a.font.size/1.2),color:a.font.color};d.coerceFont(h,"tickfont",u)}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/domain":593,"../parcoords/merge_length":907,"./attributes":890}],894:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),calc:m("./calc"),plot:m("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:m("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":890,"./base_plot":891,"./calc":892,"./defaults":893,"./plot":896}],895:[function(m,G,Y){var d=m("@plotly/d3"),v=m("d3-interpolate").interpolateNumber,w=m("../../plot_api/plot_api"),y=m("../../components/fx"),e=m("../../lib"),t=e.strTranslate,n=m("../../components/drawing"),o=m("tinycolor2"),r=m("../../lib/svg_text_utils");function g(H,N,U,te){var B=N._context.staticPlot,K=H.map(Z.bind(0,N,U)),J=te.selectAll("g.parcatslayer").data([null]);J.enter().append("g").attr("class","parcatslayer").style("pointer-events",B?"none":"all");var ee=J.selectAll("g.trace.parcats").data(K,c),ne=ee.enter().append("g").attr("class","trace parcats");ee.attr("transform",function(Te){return t(Te.x,Te.y)}),ne.append("g").attr("class","paths");var se=ee.select("g.paths").selectAll("path.path").data(function(Te){return Te.paths},c);se.attr("fill",function(Te){return Te.model.color});var oe=se.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",function(Te){return Te.model.color}).attr("fill-opacity",0);x(oe),se.attr("d",function(Te){return Te.svgD}),oe.empty()||se.sort(h),se.exit().remove(),se.on("mouseover",l).on("mouseout",s).on("click",i),ne.append("g").attr("class","dimensions");var me=ee.select("g.dimensions").selectAll("g.dimension").data(function(Te){return Te.dimensions},c);me.enter().append("g").attr("class","dimension"),me.attr("transform",function(Te){return t(Te.x,0)}),me.exit().remove();var ce=me.selectAll("g.category").data(function(Te){return Te.categories},c),ye=ce.enter().append("g").attr("class","category");ce.attr("transform",function(Te){return t(0,Te.y)}),ye.append("rect").attr("class","catrect").attr("pointer-events","none"),ce.select("rect.catrect").attr("fill","none").attr("width",function(Te){return Te.width}).attr("height",function(Te){return Te.height}),_(ye);var Se=ce.selectAll("rect.bandrect").data(function(Te){return Te.bands},c);Se.each(function(){e.raiseToTop(this)}),Se.attr("fill",function(Te){return Te.color});var fe=Se.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",function(Te){return Te.color}).attr("fill-opacity",0);Se.attr("fill",function(Te){return Te.color}).attr("width",function(Te){return Te.width}).attr("height",function(Te){return Te.height}).attr("y",function(Te){return Te.y}).attr("cursor",function(Te){return Te.parcatsViewModel.arrangement==="fixed"?"default":Te.parcatsViewModel.arrangement==="perpendicular"?"ns-resize":"move"}),b(fe),Se.exit().remove(),ye.append("text").attr("class","catlabel").attr("pointer-events","none");var ge=N._fullLayout.paper_bgcolor;ce.select("text.catlabel").attr("text-anchor",function(Te){return a(Te)?"start":"end"}).attr("alignment-baseline","middle").style("text-shadow",r.makeTextShadow(ge)).style("fill","rgb(0, 0, 0)").attr("x",function(Te){return a(Te)?Te.width+5:-5}).attr("y",function(Te){return Te.height/2}).text(function(Te){return Te.model.categoryLabel}).each(function(Te){n.font(d.select(this),Te.parcatsViewModel.categorylabelfont),r.convertToTspans(d.select(this),N)}),ye.append("text").attr("class","dimlabel"),ce.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",function(Te){return Te.parcatsViewModel.arrangement==="fixed"?"default":"ew-resize"}).attr("x",function(Te){return Te.width/2}).attr("y",-5).text(function(Te,le){return le===0?Te.parcatsViewModel.model.dimensions[Te.model.dimensionInd].dimensionLabel:null}).each(function(Te){n.font(d.select(this),Te.parcatsViewModel.labelfont)}),ce.selectAll("rect.bandrect").on("mouseover",I).on("mouseout",P),ce.exit().remove(),me.call(d.behavior.drag().origin(function(Te){return{x:Te.x,y:0}}).on("dragstart",S).on("drag",E).on("dragend",z)),ee.each(function(Te){Te.traceSelection=d.select(this),Te.pathSelection=d.select(this).selectAll("g.paths").selectAll("path.path"),Te.dimensionSelection=d.select(this).selectAll("g.dimensions").selectAll("g.dimension")}),ee.exit().remove()}function c(H){return H.key}function a(H){var N=H.parcatsViewModel.dimensions.length,U=H.parcatsViewModel.dimensions[N-1].model.dimensionInd;return H.model.dimensionInd===U}function h(H,N){return H.model.rawColor>N.model.rawColor?1:H.model.rawColor<N.model.rawColor?-1:0}function l(H){if(!H.parcatsViewModel.dragDimension&&H.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){e.raiseToTop(this),f(d.select(this));var N=p(H),U=u(H);if(H.parcatsViewModel.graphDiv.emit("plotly_hover",{points:N,event:d.event,constraints:U}),H.parcatsViewModel.hoverinfoItems.indexOf("none")===-1){var te,B,K,J=d.mouse(this)[0],ee=H.parcatsViewModel.graphDiv,ne=H.parcatsViewModel.trace,se=ee._fullLayout,oe=se._paperdiv.node().getBoundingClientRect(),me=H.parcatsViewModel.graphDiv.getBoundingClientRect();for(K=0;K<H.leftXs.length-1;K++)if(H.leftXs[K]+H.dimWidths[K]-2<=J&&J<=H.leftXs[K+1]+2){var ce=H.parcatsViewModel.dimensions[K],ye=H.parcatsViewModel.dimensions[K+1];te=(ce.x+ce.width+ye.x)/2,B=(H.topYs[K]+H.topYs[K+1]+H.height)/2;break}var Se=H.parcatsViewModel.x+te,fe=H.parcatsViewModel.y+B,ge=o.mostReadable(H.model.color,["black","white"]),Te=H.model.count,le=Te/H.parcatsViewModel.model.count,ve={countLabel:Te,probabilityLabel:le.toFixed(3)},Me=[];H.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&Me.push(["Count:",ve.countLabel].join(" ")),H.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&Me.push(["P:",ve.probabilityLabel].join(" "));var we=Me.join("<br>"),de=d.mouse(ee)[0];y.loneHover({trace:ne,x:Se-oe.left+me.left,y:fe-oe.top+me.top,text:we,color:H.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:ge,idealAlign:de<Se?"right":"left",hovertemplate:(ne.line||{}).hovertemplate,hovertemplateLabels:ve,eventData:[{data:ne._input,fullData:ne,count:Te,probability:le}]},{container:se._hoverlayer.node(),outerContainer:se._paper.node(),gd:ee})}}}function s(H){if(!H.parcatsViewModel.dragDimension&&(x(d.select(this)),y.loneUnhover(H.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),H.parcatsViewModel.pathSelection.sort(h),H.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1)){var N=p(H),U=u(H);H.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:N,event:d.event,constraints:U})}}function p(H){for(var N=[],U=D(H.parcatsViewModel),te=0;te<H.model.valueInds.length;te++){var B=H.model.valueInds[te];N.push({curveNumber:U,pointNumber:B})}return N}function u(H){for(var N={},U=H.parcatsViewModel.model.dimensions,te=0;te<U.length;te++){var B=U[te],K=B.categories[H.model.categoryInds[te]];N[B.containerInd]=K.categoryValue}return H.model.rawColor!==void 0&&(N.color=H.model.rawColor),N}function i(H){if(H.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){var N=p(H),U=u(H);H.parcatsViewModel.graphDiv.emit("plotly_click",{points:N,event:d.event,constraints:U})}}function x(H){H.attr("fill",function(N){return N.model.color}).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function f(H){H.attr("fill-opacity",.8).attr("stroke",function(N){return o.mostReadable(N.model.color,["black","white"])}).attr("stroke-width",.3)}function _(H){H.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function b(H){H.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function T(H){var N=H.parcatsViewModel.pathSelection,U=H.categoryViewModel.model.dimensionInd,te=H.categoryViewModel.model.categoryInd;return N.filter(function(B){return B.model.categoryInds[U]===te&&B.model.color===H.color})}function k(H,N,U){var te=d.select(H).datum(),B=te.categoryViewModel.model,K=te.parcatsViewModel.graphDiv,J=d.select(H.parentNode).selectAll("rect.bandrect"),ee=[];J.each(function(se){T(se).each(function(oe){Array.prototype.push.apply(ee,p(oe))})});var ne={};ne[B.dimensionInd]=B.categoryValue,K.emit(N,{points:ee,event:U,constraints:ne})}function L(H,N,U){var te=d.select(H).datum(),B=te.categoryViewModel.model,K=te.parcatsViewModel.graphDiv,J=T(te),ee=[];J.each(function(se){Array.prototype.push.apply(ee,p(se))});var ne={};ne[B.dimensionInd]=B.categoryValue,te.rawColor!==void 0&&(ne.color=te.rawColor),K.emit(N,{points:ee,event:U,constraints:ne})}function A(H,N,U){H._fullLayout._calcInverseTransform(H);var te,B,K=H._fullLayout._invScaleX,J=H._fullLayout._invScaleY,ee=d.select(U.parentNode).select("rect.catrect"),ne=ee.node().getBoundingClientRect(),se=ee.datum(),oe=se.parcatsViewModel,me=oe.model.dimensions[se.model.dimensionInd],ce=oe.trace,ye=ne.top+ne.height/2;oe.dimensions.length>1&&me.displayInd===oe.dimensions.length-1?(te=ne.left,B="left"):(te=ne.left+ne.width,B="right");var Se=se.model.count,fe=se.model.categoryLabel,ge=Se/se.parcatsViewModel.model.count,Te={countLabel:Se,categoryLabel:fe,probabilityLabel:ge.toFixed(3)},le=[];se.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&le.push(["Count:",Te.countLabel].join(" ")),se.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&le.push(["P("+Te.categoryLabel+"):",Te.probabilityLabel].join(" "));var ve=le.join("<br>");return{trace:ce,x:K*(te-N.left),y:J*(ye-N.top),text:ve,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:B,hovertemplate:ce.hovertemplate,hovertemplateLabels:Te,eventData:[{data:ce._input,fullData:ce,count:Se,category:fe,probability:ge}]}}function I(H){if(!H.parcatsViewModel.dragDimension&&H.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1){if(d.mouse(this)[1]<-1)return;var N,U=H.parcatsViewModel.graphDiv,te=U._fullLayout,B=te._paperdiv.node().getBoundingClientRect(),K=H.parcatsViewModel.hoveron;K==="color"?(function(J){var ee=d.select(J).datum(),ne=T(ee);f(ne),ne.each(function(){e.raiseToTop(this)}),d.select(J.parentNode).selectAll("rect.bandrect").filter(function(se){return se.color===ee.color}).each(function(){e.raiseToTop(this),d.select(this).attr("stroke","black").attr("stroke-width",1.5)})}(this),L(this,"plotly_hover",d.event)):(function(J){d.select(J.parentNode).selectAll("rect.bandrect").each(function(ee){var ne=T(ee);f(ne),ne.each(function(){e.raiseToTop(this)})}),d.select(J.parentNode).select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}(this),k(this,"plotly_hover",d.event)),H.parcatsViewModel.hoverinfoItems.indexOf("none")===-1&&(K==="category"?N=A(U,B,this):K==="color"?N=function(J,ee,ne){J._fullLayout._calcInverseTransform(J);var se,oe,me=J._fullLayout._invScaleX,ce=J._fullLayout._invScaleY,ye=ne.getBoundingClientRect(),Se=d.select(ne).datum(),fe=Se.categoryViewModel,ge=fe.parcatsViewModel,Te=ge.model.dimensions[fe.model.dimensionInd],le=ge.trace,ve=ye.y+ye.height/2;ge.dimensions.length>1&&Te.displayInd===ge.dimensions.length-1?(se=ye.left,oe="left"):(se=ye.left+ye.width,oe="right");var Me=fe.model.categoryLabel,we=Se.parcatsViewModel.model.count,de=0;Se.categoryViewModel.bands.forEach(function(at){at.color===Se.color&&(de+=at.count)});var Ie=fe.model.count,De=0;ge.pathSelection.each(function(at){at.model.color===Se.color&&(De+=at.model.count)});var Oe=de/we,Ve=de/De,Fe=de/Ie,ze={countLabel:we,categoryLabel:Me,probabilityLabel:Oe.toFixed(3)},Re=[];fe.parcatsViewModel.hoverinfoItems.indexOf("count")!==-1&&Re.push(["Count:",ze.countLabel].join(" ")),fe.parcatsViewModel.hoverinfoItems.indexOf("probability")!==-1&&(Re.push("P(color \u2229 "+Me+"): "+ze.probabilityLabel),Re.push("P("+Me+" | color): "+Ve.toFixed(3)),Re.push("P(color | "+Me+"): "+Fe.toFixed(3)));var We=Re.join("<br>"),$e=o.mostReadable(Se.color,["black","white"]);return{trace:le,x:me*(se-ee.left),y:ce*(ve-ee.top),text:We,color:Se.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:$e,fontSize:10,idealAlign:oe,hovertemplate:le.hovertemplate,hovertemplateLabels:ze,eventData:[{data:le._input,fullData:le,category:Me,count:we,probability:Oe,categorycount:Ie,colorcount:De,bandcolorcount:de}]}}(U,B,this):K==="dimension"&&(N=function(J,ee,ne){var se=[];return d.select(ne.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each(function(){se.push(A(J,ee,this))}),se}(U,B,this)),N&&y.loneHover(N,{container:te._hoverlayer.node(),outerContainer:te._paper.node(),gd:U}))}}function P(H){var N=H.parcatsViewModel;!N.dragDimension&&(x(N.pathSelection),_(N.dimensionSelection.selectAll("g.category")),b(N.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),y.loneUnhover(N.graphDiv._fullLayout._hoverlayer.node()),N.pathSelection.sort(h),N.hoverinfoItems.indexOf("skip")===-1)&&(H.parcatsViewModel.hoveron==="color"?L(this,"plotly_unhover",d.event):k(this,"plotly_unhover",d.event))}function S(H){H.parcatsViewModel.arrangement!=="fixed"&&(H.dragDimensionDisplayInd=H.model.displayInd,H.initialDragDimensionDisplayInds=H.parcatsViewModel.model.dimensions.map(function(N){return N.displayInd}),H.dragHasMoved=!1,H.dragCategoryDisplayInd=null,d.select(this).selectAll("g.category").select("rect.catrect").each(function(N){var U=d.mouse(this)[0],te=d.mouse(this)[1];-2<=U&&U<=N.width+2&&-2<=te&&te<=N.height+2&&(H.dragCategoryDisplayInd=N.model.displayInd,H.initialDragCategoryDisplayInds=H.model.categories.map(function(B){return B.displayInd}),N.model.dragY=N.y,e.raiseToTop(this.parentNode),d.select(this.parentNode).selectAll("rect.bandrect").each(function(B){B.y<te&&te<=B.y+B.height&&(H.potentialClickBand=this)}))}),H.parcatsViewModel.dragDimension=H,y.loneUnhover(H.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function E(H){if(H.parcatsViewModel.arrangement!=="fixed"&&(H.dragHasMoved=!0,H.dragDimensionDisplayInd!==null)){var N=H.dragDimensionDisplayInd,U=N-1,te=N+1,B=H.parcatsViewModel.dimensions[N];if(H.dragCategoryDisplayInd!==null){var K=B.categories[H.dragCategoryDisplayInd];K.model.dragY+=d.event.dy;var J=K.model.dragY,ee=K.model.displayInd,ne=B.categories,se=ne[ee-1],oe=ne[ee+1];se!==void 0&&J<se.y+se.height/2&&(K.model.displayInd=se.model.displayInd,se.model.displayInd=ee),oe!==void 0&&J+K.height>oe.y+oe.height/2&&(K.model.displayInd=oe.model.displayInd,oe.model.displayInd=ee),H.dragCategoryDisplayInd=K.model.displayInd}if(H.dragCategoryDisplayInd===null||H.parcatsViewModel.arrangement==="freeform"){B.model.dragX=d.event.x;var me=H.parcatsViewModel.dimensions[U],ce=H.parcatsViewModel.dimensions[te];me!==void 0&&B.model.dragX<me.x+me.width&&(B.model.displayInd=me.model.displayInd,me.model.displayInd=N),ce!==void 0&&B.model.dragX+B.width>ce.x&&(B.model.displayInd=ce.model.displayInd,ce.model.displayInd=H.dragDimensionDisplayInd),H.dragDimensionDisplayInd=B.model.displayInd}$(H.parcatsViewModel),X(H.parcatsViewModel),V(H.parcatsViewModel),j(H.parcatsViewModel)}}function z(H){if(H.parcatsViewModel.arrangement!=="fixed"&&H.dragDimensionDisplayInd!==null){d.select(this).selectAll("text").attr("font-weight","normal");var N={},U=D(H.parcatsViewModel),te=H.parcatsViewModel.model.dimensions.map(function(oe){return oe.displayInd}),B=H.initialDragDimensionDisplayInds.some(function(oe,me){return oe!==te[me]});B&&te.forEach(function(oe,me){var ce=H.parcatsViewModel.model.dimensions[me].containerInd;N["dimensions["+ce+"].displayindex"]=oe});var K=!1;if(H.dragCategoryDisplayInd!==null){var J=H.model.categories.map(function(oe){return oe.displayInd});if(K=H.initialDragCategoryDisplayInds.some(function(oe,me){return oe!==J[me]})){var ee=H.model.categories.slice().sort(function(oe,me){return oe.displayInd-me.displayInd}),ne=ee.map(function(oe){return oe.categoryValue}),se=ee.map(function(oe){return oe.categoryLabel});N["dimensions["+H.model.containerInd+"].categoryarray"]=[ne],N["dimensions["+H.model.containerInd+"].ticktext"]=[se],N["dimensions["+H.model.containerInd+"].categoryorder"]="array"}}H.parcatsViewModel.hoverinfoItems.indexOf("skip")===-1&&!H.dragHasMoved&&H.potentialClickBand&&(H.parcatsViewModel.hoveron==="color"?L(H.potentialClickBand,"plotly_click",d.event.sourceEvent):k(H.potentialClickBand,"plotly_click",d.event.sourceEvent)),H.model.dragX=null,H.dragCategoryDisplayInd!==null&&(H.parcatsViewModel.dimensions[H.dragDimensionDisplayInd].categories[H.dragCategoryDisplayInd].model.dragY=null,H.dragCategoryDisplayInd=null),H.dragDimensionDisplayInd=null,H.parcatsViewModel.dragDimension=null,H.dragHasMoved=null,H.potentialClickBand=null,$(H.parcatsViewModel),X(H.parcatsViewModel),d.transition().duration(300).ease("cubic-in-out").each(function(){V(H.parcatsViewModel,!0),j(H.parcatsViewModel,!0)}).each("end",function(){(B||K)&&w.restyle(H.parcatsViewModel.graphDiv,N,[U])})}}function D(H){for(var N,U=H.graphDiv._fullData,te=0;te<U.length;te++)if(H.key===U[te].uid){N=te;break}return N}function j(H,N){var U;N===void 0&&(N=!1),H.pathSelection.data(function(te){return te.paths},c),(U=H.pathSelection,N?U.transition():U).attr("d",function(te){return te.svgD})}function V(H,N){function U(J){return N?J.transition():J}N===void 0&&(N=!1),H.dimensionSelection.data(function(J){return J.dimensions},c);var te=H.dimensionSelection.selectAll("g.category").data(function(J){return J.categories},c);U(H.dimensionSelection).attr("transform",function(J){return t(J.x,0)}),U(te).attr("transform",function(J){return t(0,J.y)}),te.select(".dimlabel").text(function(J,ee){return ee===0?J.parcatsViewModel.model.dimensions[J.model.dimensionInd].dimensionLabel:null}),te.select(".catlabel").attr("text-anchor",function(J){return a(J)?"start":"end"}).attr("x",function(J){return a(J)?J.width+5:-5}).each(function(J){var ee,ne;a(J)?(ee=J.width+5,ne="start"):(ee=-5,ne="end"),d.select(this).selectAll("tspan").attr("x",ee).attr("text-anchor",ne)});var B=te.selectAll("rect.bandrect").data(function(J){return J.bands},c),K=B.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",function(J){return J.color}).attr("fill-opacity",0);B.attr("fill",function(J){return J.color}).attr("width",function(J){return J.width}).attr("height",function(J){return J.height}).attr("y",function(J){return J.y}),b(K),B.each(function(){e.raiseToTop(this)}),B.exit().remove()}function Z(H,N,U){var te,B=U[0],K=N.margin||{l:80,r:80,t:100,b:80},J=B.trace,ee=J.domain,ne=N.width,se=N.height,oe=Math.floor(ne*(ee.x[1]-ee.x[0])),me=Math.floor(se*(ee.y[1]-ee.y[0])),ce=ee.x[0]*ne+K.l,ye=N.height-ee.y[1]*N.height+K.t,Se=J.line.shape;te=J.hoverinfo==="all"?["count","probability"]:(J.hoverinfo||"").split("+");var fe={trace:J,key:J.uid,model:B,x:ce,y:ye,width:oe,height:me,hoveron:J.hoveron,hoverinfoItems:te,arrangement:J.arrangement,bundlecolors:J.bundlecolors,sortpaths:J.sortpaths,labelfont:J.labelfont,categorylabelfont:J.tickfont,pathShape:Se,dragDimension:null,margin:K,paths:[],dimensions:[],graphDiv:H,traceSelection:null,pathSelection:null,dimensionSelection:null};return B.dimensions&&($(fe),X(fe)),fe}function Q(H,N,U,te,B){var K,J,ee=[],ne=[];for(J=0;J<U.length-1;J++)K=v(U[J]+H[J],H[J+1]),ee.push(K(B)),ne.push(K(1-B));var se="M "+H[0]+","+N[0];for(se+="l"+U[0]+",0 ",J=1;J<U.length;J++)se+="C"+ee[J-1]+","+N[J-1]+" "+ne[J-1]+","+N[J]+" "+H[J]+","+N[J],se+="l"+U[J]+",0 ";for(se+="l0,"+te+" ",se+="l -"+U[U.length-1]+",0 ",J=U.length-2;J>=0;J--)se+="C"+ne[J]+","+(N[J+1]+te)+" "+ee[J]+","+(N[J]+te)+" "+(H[J]+U[J])+","+(N[J]+te),se+="l-"+U[J]+",0 ";return se+="Z"}function X(H){var N=H.dimensions,U=H.model,te=N.map(function(Re){return Re.categories.map(function(We){return We.y})}),B=H.model.dimensions.map(function(Re){return Re.categories.map(function(We){return We.displayInd})}),K=H.model.dimensions.map(function(Re){return Re.displayInd}),J=H.dimensions.map(function(Re){return Re.model.dimensionInd}),ee=N.map(function(Re){return Re.x}),ne=N.map(function(Re){return Re.width}),se=[];for(var oe in U.paths)U.paths.hasOwnProperty(oe)&&se.push(U.paths[oe]);function me(Re){var We=Re.categoryInds.map(function($e,at){return B[at][$e]});return J.map(function($e){return We[$e]})}se.sort(function(Re,We){var $e=me(Re),at=me(We);return H.sortpaths==="backward"&&($e.reverse(),at.reverse()),$e.push(Re.valueInds[0]),at.push(We.valueInds[0]),H.bundlecolors&&($e.unshift(Re.rawColor),at.unshift(We.rawColor)),$e<at?-1:$e>at?1:0});for(var ce=new Array(se.length),ye=N[0].model.count,Se=N[0].categories.map(function(Re){return Re.height}).reduce(function(Re,We){return Re+We}),fe=0;fe<se.length;fe++){var ge,Te=se[fe];ge=ye>0?Se*(Te.count/ye):0;for(var le,ve=new Array(te.length),Me=0;Me<Te.categoryInds.length;Me++){var we=Te.categoryInds[Me],de=B[Me][we],Ie=K[Me];ve[Ie]=te[Ie][de],te[Ie][de]+=ge;var De=H.dimensions[Ie].categories[de],Oe=De.bands.length,Ve=De.bands[Oe-1];if(Ve===void 0||Te.rawColor!==Ve.rawColor){var Fe=Ve===void 0?0:Ve.y+Ve.height;De.bands.push({key:Fe,color:Te.color,rawColor:Te.rawColor,height:ge,width:De.width,count:Te.count,y:Fe,categoryViewModel:De,parcatsViewModel:H})}else{var ze=De.bands[Oe-1];ze.height+=ge,ze.count+=Te.count}}le=H.pathShape==="hspline"?Q(ee,ve,ne,ge,.5):Q(ee,ve,ne,ge,0),ce[fe]={key:Te.valueInds[0],model:Te,height:ge,leftXs:ee,topYs:ve,dimWidths:ne,svgD:le,parcatsViewModel:H}}H.paths=ce}function $(H){var N=H.model.dimensions.map(function(J){return{displayInd:J.displayInd,dimensionInd:J.dimensionInd}});N.sort(function(J,ee){return J.displayInd-ee.displayInd});var U=[];for(var te in N){var B=N[te].dimensionInd,K=H.model.dimensions[B];U.push(re(H,K))}H.dimensions=U}function re(H,N){var U,te=H.model.dimensions.length,B=N.displayInd;U=40+(te>1?(H.width-80-16)/(te-1):0)*B;var K,J,ee,ne,se,oe=[],me=H.model.maxCats,ce=N.categories.length,ye=N.count,Se=H.height-8*(me-1),fe=8*(me-ce)/2,ge=N.categories.map(function(Te){return{displayInd:Te.displayInd,categoryInd:Te.categoryInd}});for(ge.sort(function(Te,le){return Te.displayInd-le.displayInd}),se=0;se<ce;se++)ne=ge[se].categoryInd,J=N.categories[ne],K=ye>0?J.count/ye*Se:0,ee={key:J.valueInds[0],model:J,width:16,height:K,y:J.dragY!==null?J.dragY:fe,bands:[],parcatsViewModel:H},fe=fe+K+8,oe.push(ee);return{key:N.dimensionInd,x:N.dragX!==null?N.dragX:U,y:0,width:16,model:N,categories:oe,parcatsViewModel:H,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}G.exports=function(H,N,U,te){g(U,H,te,N)}},{"../../components/drawing":389,"../../components/fx":407,"../../lib":515,"../../lib/svg_text_utils":541,"../../plot_api/plot_api":552,"@plotly/d3":58,"d3-interpolate":116,tinycolor2:313}],896:[function(m,G,Y){var d=m("./parcats");G.exports=function(v,w,y,e){var t=v._fullLayout,n=t._paper,o=t._size;d(v,n,w,{width:o.w,height:o.h,margin:{t:o.t,r:o.r,b:o.b,l:o.l}},y,e)}},{"./parcats":895}],897:[function(m,G,Y){var d=m("../../components/colorscale/attributes"),v=m("../../plots/cartesian/layout_attributes"),w=m("../../plots/font_attributes"),y=m("../../plots/domain").attributes,e=m("../../lib/extend").extendFlat,t=m("../../plot_api/plot_template").templatedArray;G.exports={domain:y({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:w({editType:"plot"}),tickfont:w({editType:"plot"}),rangefont:w({editType:"plot"}),dimensions:t("dimension",{label:{valType:"string",editType:"plot"},tickvals:e({},v.tickvals,{editType:"plot"}),ticktext:e({},v.ticktext,{editType:"plot"}),tickformat:e({},v.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:e({editType:"calc"},d("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"})),unselected:{line:{color:{valType:"color",dflt:"#7f7f7f",editType:"plot"},opacity:{valType:"number",min:0,max:1,dflt:"auto",editType:"plot"},editType:"plot"},editType:"plot"}}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/layout_attributes":579,"../../plots/domain":593,"../../plots/font_attributes":594}],898:[function(m,G,Y){var d=m("./constants"),v=m("@plotly/d3"),w=m("../../lib/gup").keyFun,y=m("../../lib/gup").repeat,e=m("../../lib").sorterAsc,t=m("../../lib").strTranslate,n=d.bar.snapRatio;function o(A,I){return A*(1-n)+I*n}var r=d.bar.snapClose;function g(A,I){return A*(1-r)+I*r}function c(A,I,P,S){if(function(re,H){for(var N=0;N<H.length;N++)if(re>=H[N][0]&&re<=H[N][1])return!0;return!1}(P,S))return P;var E=A?-1:1,z=0,D=I.length-1;if(E<0){var j=z;z=D,D=j}for(var V=I[z],Z=V,Q=z;E*Q<E*D;Q+=E){var X=Q+E,$=I[X];if(E*P<E*g(V,$))return o(V,Z);if(E*P<E*$||X===D)return o($,V);Z=V,V=$}}function a(A){A.attr("x",-d.bar.captureWidth/2).attr("width",d.bar.captureWidth)}function h(A){A.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function l(A){if(!A.brush.filterSpecified)return"0,"+A.height;for(var I,P,S,E=s(A.brush.filter.getConsolidated(),A.height),z=[0],D=E.length?E[0][0]:null,j=0;j<E.length;j++)P=(I=E[j])[1]-I[0],z.push(D),z.push(P),(S=j+1)<E.length&&(D=E[S][0]-I[1]);return z.push(A.height),z}function s(A,I){return A.map(function(P){return P.map(function(S){return Math.max(0,S*I)}).sort(e)})}function p(){v.select(document.body).style("cursor",null)}function u(A){A.attr("stroke-dasharray",l)}function i(A,I){var P=v.select(A).selectAll(".highlight, .highlight-shadow");u(I?P.transition().duration(d.bar.snapDuration).each("end",I):P)}function x(A,I){var P,S=A.brush,E=NaN,z={};if(S.filterSpecified){var D=A.height,j=S.filter.getConsolidated(),V=s(j,D),Z=NaN,Q=NaN,X=NaN;for(P=0;P<=V.length;P++){var $=V[P];if($&&$[0]<=I&&I<=$[1]){Z=P;break}if(Q=P?P-1:NaN,$&&$[0]>I){X=P;break}}if(E=Z,isNaN(E)&&(E=isNaN(Q)||isNaN(X)?isNaN(Q)?X:Q:I-V[Q][1]<V[X][0]-I?Q:X),!isNaN(E)){var re=V[E],H=function(B,K){var J=d.bar.handleHeight;if(!(K>B[1]+J||K<B[0]-J))return K>=.9*B[1]+.1*B[0]?"n":K<=.9*B[0]+.1*B[1]?"s":"ns"}(re,I);H&&(z.interval=j[E],z.intervalPix=re,z.region=H)}}if(A.ordinal&&!z.region){var N=A.unitTickvals,U=A.unitToPaddedPx.invert(I);for(P=0;P<N.length;P++){var te=[.25*N[Math.max(P-1,0)]+.75*N[P],.25*N[Math.min(P+1,N.length-1)]+.75*N[P]];if(U>=te[0]&&U<=te[1]){z.clickableOrdinalRange=te;break}}}return z}function f(A,I){v.event.sourceEvent.stopPropagation();var P=I.height-v.mouse(A)[1]-2*d.verticalPadding,S=I.brush.svgBrush;S.wasDragged=!0,S._dragging=!0,S.grabbingBar?S.newExtent=[P-S.grabPoint,P+S.barLength-S.grabPoint].map(I.unitToPaddedPx.invert):S.newExtent=[S.startExtent,I.unitToPaddedPx.invert(P)].sort(e),I.brush.filterSpecified=!0,S.extent=S.stayingIntervals.concat([S.newExtent]),S.brushCallback(I),i(A.parentNode)}function _(A,I){var P=x(I,I.height-v.mouse(A)[1]-2*d.verticalPadding),S="crosshair";P.clickableOrdinalRange?S="pointer":P.region&&(S=P.region+"-resize"),v.select(document.body).style("cursor",S)}function b(A){A.on("mousemove",function(I){v.event.preventDefault(),I.parent.inBrushDrag||_(this,I)}).on("mouseleave",function(I){I.parent.inBrushDrag||p()}).call(v.behavior.drag().on("dragstart",function(I){(function(P,S){v.event.sourceEvent.stopPropagation();var E=S.height-v.mouse(P)[1]-2*d.verticalPadding,z=S.unitToPaddedPx.invert(E),D=S.brush,j=x(S,E),V=j.interval,Z=D.svgBrush;if(Z.wasDragged=!1,Z.grabbingBar=j.region==="ns",Z.grabbingBar){var Q=V.map(S.unitToPaddedPx);Z.grabPoint=E-Q[0]-d.verticalPadding,Z.barLength=Q[1]-Q[0]}Z.clickableOrdinalRange=j.clickableOrdinalRange,Z.stayingIntervals=S.multiselect&&D.filterSpecified?D.filter.getConsolidated():[],V&&(Z.stayingIntervals=Z.stayingIntervals.filter(function(X){return X[0]!==V[0]&&X[1]!==V[1]})),Z.startExtent=j.region?V[j.region==="s"?1:0]:z,S.parent.inBrushDrag=!0,Z.brushStartCallback()})(this,I)}).on("drag",function(I){f(this,I)}).on("dragend",function(I){(function(P,S){var E=S.brush,z=E.filter,D=E.svgBrush;D._dragging||(_(P,S),f(P,S),S.brush.svgBrush.wasDragged=!1),D._dragging=!1,v.event.sourceEvent.stopPropagation();var j=D.grabbingBar;if(D.grabbingBar=!1,D.grabLocation=void 0,S.parent.inBrushDrag=!1,p(),!D.wasDragged)return D.wasDragged=void 0,D.clickableOrdinalRange?E.filterSpecified&&S.multiselect?D.extent.push(D.clickableOrdinalRange):(D.extent=[D.clickableOrdinalRange],E.filterSpecified=!0):j?(D.extent=D.stayingIntervals,D.extent.length===0&&k(E)):k(E),D.brushCallback(S),i(P.parentNode),void D.brushEndCallback(E.filterSpecified?z.getConsolidated():[]);var V=function(){z.set(z.getConsolidated())};if(S.ordinal){var Z=S.unitTickvals;Z[Z.length-1]<Z[0]&&Z.reverse(),D.newExtent=[c(0,Z,D.newExtent[0],D.stayingIntervals),c(1,Z,D.newExtent[1],D.stayingIntervals)];var Q=D.newExtent[1]>D.newExtent[0];D.extent=D.stayingIntervals.concat(Q?[D.newExtent]:[]),D.extent.length||k(E),D.brushCallback(S),Q?i(P.parentNode,V):(V(),i(P.parentNode))}else V();D.brushEndCallback(E.filterSpecified?z.getConsolidated():[])})(this,I)}))}function T(A,I){return A[0]-I[0]}function k(A){A.filterSpecified=!1,A.svgBrush.extent=[[-1/0,1/0]]}function L(A){for(var I,P=A.slice(),S=[],E=P.shift();E;){for(I=E.slice();(E=P.shift())&&E[0]<=I[1];)I[1]=Math.max(I[1],E[1]);S.push(I)}return S.length===1&&S[0][0]>S[0][1]&&(S=[]),S}G.exports={makeBrush:function(A,I,P,S,E,z){var D,j=function(){var V,Z,Q=[];return{set:function(X){(Q=X.map(function($){return $.slice().sort(e)}).sort(T)).length===1&&Q[0][0]===-1/0&&Q[0][1]===1/0&&(Q=[[0,-1]]),V=L(Q),Z=Q.reduce(function($,re){return[Math.min($[0],re[0]),Math.max($[1],re[1])]},[1/0,-1/0])},get:function(){return Q.slice()},getConsolidated:function(){return V},getBounds:function(){return Z}}}();return j.set(P),{filter:j,filterSpecified:I,svgBrush:{extent:[],brushStartCallback:S,brushCallback:(D=E,function(V){var Z=V.brush,Q=function(X){return X.svgBrush.extent.map(function($){return $.slice()})}(Z).slice();Z.filter.set(Q),D()}),brushEndCallback:z}}},ensureAxisBrush:function(A,I,P){var S=A.selectAll("."+d.cn.axisBrush).data(y,w);S.enter().append("g").classed(d.cn.axisBrush,!0),function(E,z,D){var j=D._context.staticPlot,V=E.selectAll(".background").data(y);V.enter().append("rect").classed("background",!0).call(a).call(h).style("pointer-events",j?"none":"auto").attr("transform",t(0,d.verticalPadding)),V.call(b).attr("height",function(X){return X.height-d.verticalPadding});var Z=E.selectAll(".highlight-shadow").data(y);Z.enter().append("line").classed("highlight-shadow",!0).attr("x",-d.bar.width/2).attr("stroke-width",d.bar.width+d.bar.strokeWidth).attr("stroke",z).attr("opacity",d.bar.strokeOpacity).attr("stroke-linecap","butt"),Z.attr("y1",function(X){return X.height}).call(u);var Q=E.selectAll(".highlight").data(y);Q.enter().append("line").classed("highlight",!0).attr("x",-d.bar.width/2).attr("stroke-width",d.bar.width-d.bar.strokeWidth).attr("stroke",d.bar.fillColor).attr("opacity",d.bar.fillOpacity).attr("stroke-linecap","butt"),Q.attr("y1",function(X){return X.height}).call(u)}(S,I,P)},cleanRanges:function(A,I){if(Array.isArray(A[0])?(A=A.map(function(S){return S.sort(e)}),A=I.multiselect?L(A.sort(T)):[A[0]]):A=[A.sort(e)],I.tickvals){var P=I.tickvals.slice().sort(e);if(!(A=A.map(function(S){var E=[c(0,P,S[0],[]),c(1,P,S[1],[])];if(E[1]>E[0])return E}).filter(function(S){return S})).length)return}return A.length>1?A:A[0]}}},{"../../lib":515,"../../lib/gup":512,"./constants":902,"@plotly/d3":58}],899:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),calc:m("./calc"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:m("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":897,"./base_plot":900,"./calc":901,"./defaults":903}],900:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../plots/get_data").getModuleCalcData,w=m("./plot"),y=m("../../constants/xmlns_namespaces");Y.name="parcoords",Y.plot=function(e){var t=v(e.calcdata,"parcoords")[0];t.length&&w(e,t)},Y.clean=function(e,t,n,o){var r=o._has&&o._has("parcoords"),g=t._has&&t._has("parcoords");r&&!g&&(o._paperdiv.selectAll(".parcoords").remove(),o._glimages.selectAll("*").remove())},Y.toSVG=function(e){var t=e._fullLayout._glimages,n=d.select(e).selectAll(".svg-container");n.filter(function(o,r){return r===n.size()-1}).selectAll(".gl-canvas-context, .gl-canvas-focus").each(function(){var o=this.toDataURL("image/png");t.append("svg:image").attr({xmlns:y.svg,"xlink:href":o,preserveAspectRatio:"none",x:0,y:0,width:this.style.width,height:this.style.height})}),window.setTimeout(function(){d.selectAll("#filterBarPattern").attr("id","filterBarPattern")},60)}},{"../../constants/xmlns_namespaces":492,"../../plots/get_data":602,"./plot":909,"@plotly/d3":58}],901:[function(m,G,Y){var d=m("../../lib").isArrayOrTypedArray,v=m("../../components/colorscale"),w=m("../../lib/gup").wrap;G.exports=function(y,e){var t,n;return v.hasColorscale(e,"line")&&d(e.line.color)?(t=e.line.color,n=v.extractOpts(e.line).colorscale,v.calc(y,e,{vals:t,containerStr:"line",cLetter:"c"})):(t=function(o){for(var r=new Array(o),g=0;g<o;g++)r[g]=.5;return r}(e._length),n=[[0,e.line.color],[1,e.line.color]]),w({lineColor:t,cscale:n})}},{"../../components/colorscale":379,"../../lib":515,"../../lib/gup":512}],902:[function(m,G,Y){G.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],903:[function(m,G,Y){var d=m("../../lib"),v=m("../../components/colorscale/helpers").hasColorscale,w=m("../../components/colorscale/defaults"),y=m("../../plots/domain").defaults,e=m("../../plots/array_container_defaults"),t=m("../../plots/cartesian/axes"),n=m("./attributes"),o=m("./axisbrush"),r=m("./constants").maxDimensionCount,g=m("./merge_length");function c(a,h,l,s){function p(_,b){return d.coerce(a,h,n.dimensions,_,b)}var u=p("values"),i=p("visible");if(u&&u.length||(i=h.visible=!1),i){p("label"),p("tickvals"),p("ticktext"),p("tickformat");var x=p("range");h._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:x},t.setConvert(h._ax,s.layout),p("multiselect");var f=p("constraintrange");f&&(h.constraintrange=o.cleanRanges(f,h))}}G.exports=function(a,h,l,s){function p(_,b){return d.coerce(a,h,n,_,b)}var u=a.dimensions;Array.isArray(u)&&u.length>r&&(d.log("parcoords traces support up to "+r+" dimensions at the moment"),u.splice(r));var i=e(a,h,{name:"dimensions",layout:s,handleItemDefaults:c}),x=function(_,b,T,k,L){var A=L("line.color",T);if(v(_,"line")&&d.isArrayOrTypedArray(A)){if(A.length)return L("line.colorscale"),w(_,b,k,L,{prefix:"line.",cLetter:"c"}),A.length;b.line.color=T}return 1/0}(a,h,l,s,p);y(h,s,p),Array.isArray(i)&&i.length||(h.visible=!1),g(h,i,"values",x);var f={family:s.font.family,size:Math.round(s.font.size/1.2),color:s.font.color};d.coerceFont(p,"labelfont",f),d.coerceFont(p,"tickfont",f),d.coerceFont(p,"rangefont",f),p("labelangle"),p("labelside"),p("unselected.line.color"),p("unselected.line.opacity")}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515,"../../plots/array_container_defaults":561,"../../plots/cartesian/axes":566,"../../plots/domain":593,"./attributes":897,"./axisbrush":898,"./constants":902,"./merge_length":907}],904:[function(m,G,Y){var d=m("../../lib").isTypedArray;Y.convertTypedArray=function(v){return d(v)?Array.prototype.slice.call(v):v},Y.isOrdinal=function(v){return!!v.tickvals},Y.isVisible=function(v){return v.visible||!("visible"in v)}},{"../../lib":515}],905:[function(m,G,Y){var d=m("./base_index");d.plot=m("./plot"),G.exports=d},{"./base_index":899,"./plot":909}],906:[function(m,G,Y){var d=m("glslify"),v=d([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

attribute vec4 p01_04, p05_08, p09_12, p13_16,
               p17_20, p21_24, p25_28, p29_32,
               p33_36, p37_40, p41_44, p45_48,
               p49_52, p53_56, p57_60, colors;

uniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,
             loA, hiA, loB, hiB, loC, hiC, loD, hiD;

uniform vec2 resolution, viewBoxPos, viewBoxSize;
uniform float maskHeight;
uniform float drwLayer; // 0: context, 1: focus, 2: pick
uniform vec4 contextColor;
uniform sampler2D maskTexture, palette;

bool isPick    = (drwLayer > 1.5);
bool isContext = (drwLayer < 0.5);

const vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);
const vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);

float val(mat4 p, mat4 v) {
    return dot(matrixCompMult(p, v) * UNITS, UNITS);
}

float axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {
    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);
    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);
    return y1 * (1.0 - ratio) + y2 * ratio;
}

int iMod(int a, int b) {
    return a - b * (a / b);
}

bool fOutside(float p, float lo, float hi) {
    return (lo < hi) && (lo > p || p > hi);
}

bool vOutside(vec4 p, vec4 lo, vec4 hi) {
    return (
        fOutside(p[0], lo[0], hi[0]) ||
        fOutside(p[1], lo[1], hi[1]) ||
        fOutside(p[2], lo[2], hi[2]) ||
        fOutside(p[3], lo[3], hi[3])
    );
}

bool mOutside(mat4 p, mat4 lo, mat4 hi) {
    return (
        vOutside(p[0], lo[0], hi[0]) ||
        vOutside(p[1], lo[1], hi[1]) ||
        vOutside(p[2], lo[2], hi[2]) ||
        vOutside(p[3], lo[3], hi[3])
    );
}

bool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {
    return mOutside(A, loA, hiA) ||
           mOutside(B, loB, hiB) ||
           mOutside(C, loC, hiC) ||
           mOutside(D, loD, hiD);
}

bool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {
    mat4 pnts[4];
    pnts[0] = A;
    pnts[1] = B;
    pnts[2] = C;
    pnts[3] = D;

    for(int i = 0; i < 4; ++i) {
        for(int j = 0; j < 4; ++j) {
            for(int k = 0; k < 4; ++k) {
                if(0 == iMod(
                    int(255.0 * texture2D(maskTexture,
                        vec2(
                            (float(i * 2 + j / 2) + 0.5) / 8.0,
                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight
                        ))[3]
                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),
                    2
                )) return true;
            }
        }
    }
    return false;
}

vec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {
    float x = 0.5 * sign(v) + 0.5;
    float y = axisY(x, A, B, C, D);
    float z = 1.0 - abs(v);

    z += isContext ? 0.0 : 2.0 * float(
        outsideBoundingBox(A, B, C, D) ||
        outsideRasterMask(A, B, C, D)
    );

    return vec4(
        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,
        z,
        1.0
    );
}

void main() {
    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);
    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);
    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);
    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);

    float v = colors[3];

    gl_Position = position(isContext, v, A, B, C, D);

    fragColor =
        isContext ? vec4(contextColor) :
        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));
}
`]),w=d([`precision highp float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
    gl_FragColor = fragColor;
}
`]),y=m("./constants").maxDimensionCount,e=m("../../lib"),t=new Uint8Array(4),n=new Uint8Array(4),o={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function r(i,x,f,_,b){var T=i._gl;T.enable(T.SCISSOR_TEST),T.scissor(x,f,_,b),i.clear({color:[0,0,0,0],depth:1})}function g(i,x,f,_,b,T){var k=T.key;f.drawCompleted||(function(L){L.read({x:0,y:0,width:1,height:1,data:t})}(i),f.drawCompleted=!0),function L(A){var I=Math.min(_,b-A*_);A===0&&(window.cancelAnimationFrame(f.currentRafs[k]),delete f.currentRafs[k],r(i,T.scissorX,T.scissorY,T.scissorWidth,T.viewBoxSize[1])),f.clearOnly||(T.count=2*I,T.offset=2*A*_,x(T),A*_+I<b&&(f.currentRafs[k]=window.requestAnimationFrame(function(){L(A+1)})),f.drawCompleted=!1)}(0)}function c(i,x){for(var f=new Array(256),_=0;_<256;_++)f[_]=i(_/255).concat(x);return f}function a(i,x){return(i>>>8*x)%256/255}function h(i,x,f){for(var _=new Array(8*x),b=0,T=0;T<x;T++)for(var k=0;k<2;k++)for(var L=0;L<4;L++){var A=4*i+L,I=f[64*T+A];A===63&&k===0&&(I*=-1),_[b++]=I}return _}function l(i){var x="0"+i;return x.substr(x.length-2)}function s(i){return i<y?"p"+l(i+1)+"_"+l(i+4):"colors"}function p(i,x,f,_,b,T,k,L,A,I,P,S,E,z){for(var D=[[],[]],j=0;j<64;j++)D[0][j]=j===b?1:0,D[1][j]=j===T?1:0;k*=z,L*=z,A*=z,I*=z;var V=i.lines.canvasOverdrag*z,Z=i.domain,Q=i.canvasWidth*z,X=i.canvasHeight*z,$=i.pad.l*z,re=i.pad.b*z,H=i.layoutHeight*z,N=i.layoutWidth*z,U=i.deselectedLines.color,te=i.deselectedLines.opacity;return e.extendFlat({key:P,resolution:[Q,X],viewBoxPos:[k+V,L],viewBoxSize:[A,I],i0:b,i1:T,dim0A:D[0].slice(0,16),dim0B:D[0].slice(16,32),dim0C:D[0].slice(32,48),dim0D:D[0].slice(48,64),dim1A:D[1].slice(0,16),dim1B:D[1].slice(16,32),dim1C:D[1].slice(32,48),dim1D:D[1].slice(48,64),drwLayer:S,contextColor:[U[0]/255,U[1]/255,U[2]/255,te!=="auto"?U[3]*te:Math.max(1/255,Math.pow(1/i.lines.color.length,1/3))],scissorX:(_===x?0:k+V)+($-V)+N*Z.x[0],scissorWidth:(_===f?Q-k+V:A+.5)+(_===x?k+V:0),scissorY:L+re+H*Z.y[0],scissorHeight:I,viewportX:$-V+N*Z.x[0],viewportY:re+H*Z.y[0],viewportWidth:Q,viewportHeight:X},E)}function u(i){var x=Math.max(0,Math.floor(2047*i[0]),0),f=Math.min(2047,Math.ceil(2047*i[1]),2047);return[Math.min(x,f),Math.max(x,f)]}G.exports=function(i,x){var f,_,b,T,k,L=x.context,A=x.pick,I=x.regl,P=I._gl,S=P.getParameter(P.ALIASED_LINE_WIDTH_RANGE),E=Math.max(S[0],Math.min(S[1],x.viewModel.plotGlPixelRatio)),z={currentRafs:{},drawCompleted:!0,clearOnly:!1},D=function(X){for(var $={},re=0;re<=y;re+=4)$[s(re)]=X.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return $}(I),j=I.texture(o),V=[];Q(x);var Z=I({profile:!1,blend:{enable:L,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!L,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:I.prop("scissorX"),y:I.prop("scissorY"),width:I.prop("scissorWidth"),height:I.prop("scissorHeight")}},viewport:{x:I.prop("viewportX"),y:I.prop("viewportY"),width:I.prop("viewportWidth"),height:I.prop("viewportHeight")},dither:!1,vert:v,frag:w,primitive:"lines",lineWidth:E,attributes:D,uniforms:{resolution:I.prop("resolution"),viewBoxPos:I.prop("viewBoxPos"),viewBoxSize:I.prop("viewBoxSize"),dim0A:I.prop("dim0A"),dim1A:I.prop("dim1A"),dim0B:I.prop("dim0B"),dim1B:I.prop("dim1B"),dim0C:I.prop("dim0C"),dim1C:I.prop("dim1C"),dim0D:I.prop("dim0D"),dim1D:I.prop("dim1D"),loA:I.prop("loA"),hiA:I.prop("hiA"),loB:I.prop("loB"),hiB:I.prop("hiB"),loC:I.prop("loC"),hiC:I.prop("hiC"),loD:I.prop("loD"),hiD:I.prop("hiD"),palette:j,contextColor:I.prop("contextColor"),maskTexture:I.prop("maskTexture"),drwLayer:I.prop("drwLayer"),maskHeight:I.prop("maskHeight")},offset:I.prop("offset"),count:I.prop("count")});function Q(X){f=X.model,_=X.viewModel,b=_.dimensions.slice(),T=b[0]?b[0].values.length:0;var $=f.lines,re=A?$.color.map(function(N,U){return U/$.color.length}):$.color,H=function(N,U,te){for(var B,K=new Array(N*(y+4)),J=0,ee=0;ee<N;ee++){for(var ne=0;ne<y;ne++)K[J++]=ne<U.length?U[ne].paddedUnitValues[ee]:.5;K[J++]=a(ee,2),K[J++]=a(ee,1),K[J++]=a(ee,0),K[J++]=(B=te[ee],Math.max(1e-6,Math.min(.999999,B)))}return K}(T,b,re);(function(N,U,te){for(var B=0;B<=y;B+=4)N[s(B)](h(B/4,U,te))})(D,T,H),L||A||(j=I.texture(e.extendFlat({data:c(f.unitToColor,255)},o)))}return{render:function(X,$,re){var H,N,U,te=X.length,B=1/0,K=-1/0;for(H=0;H<te;H++)X[H].dim0.canvasX<B&&(B=X[H].dim0.canvasX,N=H),X[H].dim1.canvasX>K&&(K=X[H].dim1.canvasX,U=H);te===0&&r(I,0,0,f.canvasWidth,f.canvasHeight);var J=function(ge){var Te,le,ve,Me=[[],[]];for(ve=0;ve<64;ve++){var we=!ge&&ve<b.length?b[ve].brush.filter.getBounds():[-1/0,1/0];Me[0][ve]=we[0],Me[1][ve]=we[1]}var de=new Array(16384);for(Te=0;Te<16384;Te++)de[Te]=255;if(!ge)for(Te=0;Te<b.length;Te++){var Ie=Te%8,De=(Te-Ie)/8,Oe=Math.pow(2,Ie),Ve=b[Te].brush.filter.get();if(!(Ve.length<2)){var Fe=u(Ve[0])[1];for(le=1;le<Ve.length;le++){var ze=u(Ve[le]);for(ve=Fe+1;ve<ze[0];ve++)de[8*ve+De]&=~Oe;Fe=Math.max(Fe,ze[1])}}}var Re={shape:[8,2048],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:de};return k?k(Re):k=I.texture(Re),{maskTexture:k,maskHeight:2048,loA:Me[0].slice(0,16),loB:Me[0].slice(16,32),loC:Me[0].slice(32,48),loD:Me[0].slice(48,64),hiA:Me[1].slice(0,16),hiB:Me[1].slice(16,32),hiC:Me[1].slice(32,48),hiD:Me[1].slice(48,64)}}(L);for(H=0;H<te;H++){var ee=X[H],ne=ee.dim0.crossfilterDimensionIndex,se=ee.dim1.crossfilterDimensionIndex,oe=ee.canvasX,me=ee.canvasY,ce=oe+ee.panelSizeX,ye=ee.plotGlPixelRatio;if($||!V[ne]||V[ne][0]!==oe||V[ne][1]!==ce){V[ne]=[oe,ce];var Se=p(f,N,U,H,ne,se,oe,me,ee.panelSizeX,ee.panelSizeY,ee.dim0.crossfilterDimensionIndex,L?0:A?2:1,J,ye);z.clearOnly=re;var fe=$?f.lines.blockLineCount:T;g(I,Z,z,fe,T,Se)}}},readPixel:function(X,$){return I.read({x:X,y:$,width:1,height:1,data:n}),n},readPixels:function(X,$,re,H){var N=new Uint8Array(4*re*H);return I.read({x:X,y:$,width:re,height:H,data:N}),N},destroy:function(){for(var X in i.style["pointer-events"]="none",j.destroy(),k&&k.destroy(),D)D[X].destroy()},update:Q}}},{"../../lib":515,"./constants":902,glslify:227}],907:[function(m,G,Y){G.exports=function(d,v,w,y){var e,t;for(y||(y=1/0),e=0;e<v.length;e++)(t=v[e]).visible&&(y=Math.min(y,t[w].length));for(y===1/0&&(y=0),d._length=y,e=0;e<v.length;e++)(t=v[e]).visible&&(t._length=y);return y}},{}],908:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../lib"),w=v.numberFormat,y=m("color-rgba"),e=m("../../plots/cartesian/axes"),t=v.strRotate,n=v.strTranslate,o=m("../../lib/svg_text_utils"),r=m("../../components/drawing"),g=m("../../components/colorscale"),c=m("../../lib/gup"),a=c.keyFun,h=c.repeat,l=c.unwrap,s=m("./helpers"),p=m("./constants"),u=m("./axisbrush"),i=m("./lines");function x(V,Z,Q){return v.aggNums(V,null,Z,Q)}function f(V,Z){return b(x(Math.min,V,Z),x(Math.max,V,Z))}function _(V){var Z=V.range;return Z?b(Z[0],Z[1]):f(V.values,V._length)}function b(V,Z){return!isNaN(V)&&isFinite(V)||(V=0),!isNaN(Z)&&isFinite(Z)||(Z=0),V===Z&&(V===0?(V-=1,Z+=1):(V*=.9,Z*=1.1)),[V,Z]}function T(V,Z,Q,X,$){var re,H,N=_(Q);return X?d.scale.ordinal().domain(X.map((re=w(Q.tickformat),H=$,H?function(U,te){var B=H[te];return B==null?re(U):B}:re))).range(X.map(function(U){var te=(U-N[0])/(N[1]-N[0]);return V-Z+te*(2*Z-V)})):d.scale.linear().domain(N).range([V-Z,Z])}function k(V){if(V.tickvals){var Z=_(V);return d.scale.ordinal().domain(V.tickvals).range(V.tickvals.map(function(Q){return(Q-Z[0])/(Z[1]-Z[0])}))}}function L(V){var Z=V.map(function($){return $[0]}),Q=V.map(function($){var re=y($[1]);return d.rgb("rgb("+re[0]+","+re[1]+","+re[2]+")")}),X="rgb".split("").map(function($){return d.scale.linear().clamp(!0).domain(Z).range(Q.map((re=$,function(H){return H[re]})));var re});return function($){return X.map(function(re){return re($)})}}function A(V){return V.dimensions.some(function(Z){return Z.brush.filterSpecified})}function I(V,Z,Q){var X=l(Z),$=X.trace,re=s.convertTypedArray(X.lineColor),H=$.line,N={color:y($.unselected.line.color),opacity:$.unselected.line.opacity},U=g.extractOpts(H),te=U.reversescale?g.flipScale(X.cscale):X.cscale,B=$.domain,K=$.dimensions,J=V.width,ee=$.labelangle,ne=$.labelside,se=$.labelfont,oe=$.tickfont,me=$.rangefont,ce=v.extendDeepNoArrays({},H,{color:re.map(d.scale.linear().domain(_({values:re,range:[U.min,U.max],_length:$._length}))),blockLineCount:p.blockLineCount,canvasOverdrag:p.overdrag*p.canvasPixelRatio}),ye=Math.floor(J*(B.x[1]-B.x[0])),Se=Math.floor(V.height*(B.y[1]-B.y[0])),fe=V.margin||{l:80,r:80,t:100,b:80},ge=ye,Te=Se;return{key:Q,colCount:K.filter(s.isVisible).length,dimensions:K,tickDistance:p.tickDistance,unitToColor:L(te),lines:ce,deselectedLines:N,labelAngle:ee,labelSide:ne,labelFont:se,tickFont:oe,rangeFont:me,layoutWidth:J,layoutHeight:V.height,domain:B,translateX:B.x[0]*J,translateY:V.height-B.y[1]*V.height,pad:fe,canvasWidth:ge*p.canvasPixelRatio+2*ce.canvasOverdrag,canvasHeight:Te*p.canvasPixelRatio,width:ge,height:Te,canvasPixelRatio:p.canvasPixelRatio}}function P(V,Z,Q){var X=Q.width,$=Q.height,re=Q.dimensions,H=Q.canvasPixelRatio,N=function(J){return X*J/Math.max(1,Q.colCount-1)},U=p.verticalPadding/$,te=function(J,ee){return d.scale.linear().range([ee,J-ee])}($,p.verticalPadding),B={key:Q.key,xScale:N,model:Q,inBrushDrag:!1},K={};return B.dimensions=re.filter(s.isVisible).map(function(J,ee){var ne=function(de,Ie){return d.scale.linear().domain(_(de)).range([Ie,1-Ie])}(J,U),se=K[J.label];K[J.label]=(se||0)+1;var oe=J.label+(se?"__"+se:""),me=J.constraintrange,ce=me&&me.length;ce&&!Array.isArray(me[0])&&(me=[me]);var ye=ce?me.map(function(de){return de.map(ne)}):[[-1/0,1/0]],Se=J.values;Se.length>J._length&&(Se=Se.slice(0,J._length));var fe,ge=J.tickvals;function Te(de,Ie){return{val:de,text:fe[Ie]}}function le(de,Ie){return de.val-Ie.val}if(Array.isArray(ge)&&ge.length){fe=J.ticktext,Array.isArray(fe)&&fe.length?fe.length>ge.length?fe=fe.slice(0,ge.length):ge.length>fe.length&&(ge=ge.slice(0,fe.length)):fe=ge.map(w(J.tickformat));for(var ve=1;ve<ge.length;ve++)if(ge[ve]<ge[ve-1]){for(var Me=ge.map(Te).sort(le),we=0;we<ge.length;we++)ge[we]=Me[we].val,fe[we]=Me[we].text;break}}else ge=void 0;return Se=s.convertTypedArray(Se),{key:oe,label:J.label,tickFormat:J.tickformat,tickvals:ge,ticktext:fe,ordinal:s.isOrdinal(J),multiselect:J.multiselect,xIndex:ee,crossfilterDimensionIndex:ee,visibleIndex:J._index,height:$,values:Se,paddedUnitValues:Se.map(ne),unitTickvals:ge&&ge.map(ne),xScale:N,x:N(ee),canvasX:N(ee)*H,unitToPaddedPx:te,domainScale:T($,p.verticalPadding,J,ge,fe),ordinalScale:k(J),parent:B,model:Q,brush:u.makeBrush(V,ce,ye,function(){V.linePickActive(!1)},function(){var de=B;de.focusLayer&&de.focusLayer.render(de.panels,!0);var Ie=A(de);!V.contextShown()&&Ie?(de.contextLayer&&de.contextLayer.render(de.panels,!0),V.contextShown(!0)):V.contextShown()&&!Ie&&(de.contextLayer&&de.contextLayer.render(de.panels,!0,!0),V.contextShown(!1))},function(de){if(B.focusLayer.render(B.panels,!0),B.pickLayer&&B.pickLayer.render(B.panels,!0),V.linePickActive(!0),Z&&Z.filterChanged){var Ie=ne.invert,De=de.map(function(Oe){return Oe.map(Ie).sort(v.sorterAsc)}).sort(function(Oe,Ve){return Oe[0]-Ve[0]});Z.filterChanged(B.key,J._index,De)}})}}),B}function S(V){V.classed(p.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default")}function E(V,Z){var Q=Z==="top"?1:-1,X=V*Math.PI/180;return{dir:Q,dx:Math.sin(X),dy:Math.cos(X),degrees:V}}function z(V,Z,Q){for(var X=Z.panels||(Z.panels=[]),$=V.data(),re=0;re<$.length-1;re++){var H=X[re]||(X[re]={}),N=$[re],U=$[re+1];H.dim0=N,H.dim1=U,H.canvasX=N.canvasX,H.panelSizeX=U.canvasX-N.canvasX,H.panelSizeY=Z.model.canvasHeight,H.y=0,H.canvasY=0,H.plotGlPixelRatio=Q}}function D(V,Z){return e.tickText(V._ax,Z,!1).text}function j(V,Z){if(V.ordinal)return"";var Q=V.domainScale.domain(),X=Q[Z?Q.length-1:0];return D(V.model.dimensions[V.visibleIndex],X)}G.exports=function(V,Z,Q,X){var $=V._context.staticPlot,re=V._fullLayout,H=re._toppaper,N=re._glcontainer,U=V._context.plotGlPixelRatio,te=V._fullLayout.paper_bgcolor;(function(de){for(var Ie=0;Ie<de.length;Ie++)for(var De=0;De<de[Ie].length;De++)for(var Oe=de[Ie][De].trace,Ve=Oe.dimensions,Fe=0;Fe<Ve.length;Fe++){var ze=Ve[Fe].values,Re=Ve[Fe]._ax;Re&&(Re.range?Re.range=b(Re.range[0],Re.range[1]):Re.range=f(ze,Oe._length),Re.dtick||(Re.dtick=.01*(Math.abs(Re.range[1]-Re.range[0])||1)),Re.tickformat=Ve[Fe].tickformat,e.calcTicks(Re),Re.cleanRange())}})(Z);var B,K,J=(B=!0,K=!1,{linePickActive:function(de){return arguments.length?B=!!de:B},contextShown:function(de){return arguments.length?K=!!de:K}}),ee=Z.filter(function(de){return l(de).trace.visible}).map(I.bind(0,Q)).map(P.bind(0,J,X));N.each(function(de,Ie){return v.extendFlat(de,ee[Ie])});var ne=N.selectAll(".gl-canvas").each(function(de){de.viewModel=ee[0],de.viewModel.plotGlPixelRatio=U,de.viewModel.paperColor=te,de.model=de.viewModel?de.viewModel.model:null}),se=null;ne.filter(function(de){return de.pick}).style("pointer-events",$?"none":"auto").on("mousemove",function(de){if(J.linePickActive()&&de.lineLayer&&X&&X.hover){var Ie=d.event,De=this.width,Oe=this.height,Ve=d.mouse(this),Fe=Ve[0],ze=Ve[1];if(Fe<0||ze<0||Fe>=De||ze>=Oe)return;var Re=de.lineLayer.readPixel(Fe,Oe-1-ze),We=Re[3]!==0,$e=We?Re[2]+256*(Re[1]+256*Re[0]):null,at={x:Fe,y:ze,clientX:Ie.clientX,clientY:Ie.clientY,dataIndex:de.model.key,curveNumber:$e};$e!==se&&(We?X.hover(at):X.unhover&&X.unhover(at),se=$e)}}),ne.style("opacity",function(de){return de.pick?0:1}),H.style("background","rgba(255, 255, 255, 0)");var oe=H.selectAll("."+p.cn.parcoords).data(ee,a);oe.exit().remove(),oe.enter().append("g").classed(p.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),oe.attr("transform",function(de){return n(de.model.translateX,de.model.translateY)});var me=oe.selectAll("."+p.cn.parcoordsControlView).data(h,a);me.enter().append("g").classed(p.cn.parcoordsControlView,!0),me.attr("transform",function(de){return n(de.model.pad.l,de.model.pad.t)});var ce=me.selectAll("."+p.cn.yAxis).data(function(de){return de.dimensions},a);ce.enter().append("g").classed(p.cn.yAxis,!0),me.each(function(de){z(ce,de,U)}),ne.each(function(de){if(de.viewModel){!de.lineLayer||X?de.lineLayer=i(this,de):de.lineLayer.update(de),(de.key||de.key===0)&&(de.viewModel[de.key]=de.lineLayer);var Ie=!de.context||X;de.lineLayer.render(de.viewModel.panels,Ie)}}),ce.attr("transform",function(de){return n(de.xScale(de.xIndex),0)}),ce.call(d.behavior.drag().origin(function(de){return de}).on("drag",function(de){var Ie=de.parent;J.linePickActive(!1),de.x=Math.max(-p.overdrag,Math.min(de.model.width+p.overdrag,d.event.x)),de.canvasX=de.x*de.model.canvasPixelRatio,ce.sort(function(De,Oe){return De.x-Oe.x}).each(function(De,Oe){De.xIndex=Oe,De.x=de===De?De.x:De.xScale(De.xIndex),De.canvasX=De.x*De.model.canvasPixelRatio}),z(ce,Ie,U),ce.filter(function(De){return Math.abs(de.xIndex-De.xIndex)!==0}).attr("transform",function(De){return n(De.xScale(De.xIndex),0)}),d.select(this).attr("transform",n(de.x,0)),ce.each(function(De,Oe,Ve){Ve===de.parent.key&&(Ie.dimensions[Oe]=De)}),Ie.contextLayer&&Ie.contextLayer.render(Ie.panels,!1,!A(Ie)),Ie.focusLayer.render&&Ie.focusLayer.render(Ie.panels)}).on("dragend",function(de){var Ie=de.parent;de.x=de.xScale(de.xIndex),de.canvasX=de.x*de.model.canvasPixelRatio,z(ce,Ie,U),d.select(this).attr("transform",function(De){return n(De.x,0)}),Ie.contextLayer&&Ie.contextLayer.render(Ie.panels,!1,!A(Ie)),Ie.focusLayer&&Ie.focusLayer.render(Ie.panels),Ie.pickLayer&&Ie.pickLayer.render(Ie.panels,!0),J.linePickActive(!0),X&&X.axesMoved&&X.axesMoved(Ie.key,Ie.dimensions.map(function(De){return De.crossfilterDimensionIndex}))})),ce.exit().remove();var ye=ce.selectAll("."+p.cn.axisOverlays).data(h,a);ye.enter().append("g").classed(p.cn.axisOverlays,!0),ye.selectAll("."+p.cn.axis).remove();var Se=ye.selectAll("."+p.cn.axis).data(h,a);Se.enter().append("g").classed(p.cn.axis,!0),Se.each(function(de){var Ie=de.model.height/de.model.tickDistance,De=de.domainScale,Oe=De.domain();d.select(this).call(d.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(Ie,de.tickFormat).tickValues(de.ordinal?Oe:null).tickFormat(function(Ve){return s.isOrdinal(de)?Ve:D(de.model.dimensions[de.visibleIndex],Ve)}).scale(De)),r.font(Se.selectAll("text"),de.model.tickFont)}),Se.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),Se.selectAll("text").style("text-shadow",o.makeTextShadow(te)).style("cursor","default");var fe=ye.selectAll("."+p.cn.axisHeading).data(h,a);fe.enter().append("g").classed(p.cn.axisHeading,!0);var ge=fe.selectAll("."+p.cn.axisTitle).data(h,a);ge.enter().append("text").classed(p.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("pointer-events",$?"none":"auto"),ge.text(function(de){return de.label}).each(function(de){var Ie=d.select(this);r.font(Ie,de.model.labelFont),o.convertToTspans(Ie,V)}).attr("transform",function(de){var Ie=E(de.model.labelAngle,de.model.labelSide),De=p.axisTitleOffset;return(Ie.dir>0?"":n(0,2*De+de.model.height))+t(Ie.degrees)+n(-De*Ie.dx,-De*Ie.dy)}).attr("text-anchor",function(de){var Ie=E(de.model.labelAngle,de.model.labelSide);return 2*Math.abs(Ie.dx)>Math.abs(Ie.dy)?Ie.dir*Ie.dx<0?"start":"end":"middle"});var Te=ye.selectAll("."+p.cn.axisExtent).data(h,a);Te.enter().append("g").classed(p.cn.axisExtent,!0);var le=Te.selectAll("."+p.cn.axisExtentTop).data(h,a);le.enter().append("g").classed(p.cn.axisExtentTop,!0),le.attr("transform",n(0,-p.axisExtentOffset));var ve=le.selectAll("."+p.cn.axisExtentTopText).data(h,a);ve.enter().append("text").classed(p.cn.axisExtentTopText,!0).call(S),ve.text(function(de){return j(de,!0)}).each(function(de){r.font(d.select(this),de.model.rangeFont)});var Me=Te.selectAll("."+p.cn.axisExtentBottom).data(h,a);Me.enter().append("g").classed(p.cn.axisExtentBottom,!0),Me.attr("transform",function(de){return n(0,de.model.height+p.axisExtentOffset)});var we=Me.selectAll("."+p.cn.axisExtentBottomText).data(h,a);we.enter().append("text").classed(p.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(S),we.text(function(de){return j(de,!1)}).each(function(de){r.font(d.select(this),de.model.rangeFont)}),u.ensureAxisBrush(ye,te,V)}},{"../../components/colorscale":379,"../../components/drawing":389,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"../../plots/cartesian/axes":566,"./axisbrush":898,"./constants":902,"./helpers":904,"./lines":906,"@plotly/d3":58,"color-rgba":91}],909:[function(m,G,Y){var d=m("./parcoords"),v=m("../../lib/prepare_regl"),w=m("./helpers").isVisible,y={};function e(t,n,o){var r=n.indexOf(o),g=t.indexOf(r);return g===-1&&(g+=n.length),g}(G.exports=function(t,n){var o=t._fullLayout;if(v(t,[],y)){var r={},g={},c={},a={},h=o._size;n.forEach(function(l,s){var p=l[0].trace;c[s]=p.index;var u=a[s]=p._fullInput.index;r[s]=t.data[u].dimensions,g[s]=t.data[u].dimensions.slice()}),d(t,n,{width:h.w,height:h.h,margin:{t:h.t,r:h.r,b:h.b,l:h.l}},{filterChanged:function(l,s,p){var u=g[l][s],i=p.map(function(k){return k.slice()}),x="dimensions["+s+"].constraintrange",f=o._tracePreGUI[t._fullData[c[l]]._fullInput.uid];if(f[x]===void 0){var _=u.constraintrange;f[x]=_||null}var b=t._fullData[c[l]].dimensions[s];i.length?(i.length===1&&(i=i[0]),u.constraintrange=i,b.constraintrange=i.slice(),i=[i]):(delete u.constraintrange,delete b.constraintrange,i=null);var T={};T[x]=i,t.emit("plotly_restyle",[T,[a[l]]])},hover:function(l){t.emit("plotly_hover",l)},unhover:function(l){t.emit("plotly_unhover",l)},axesMoved:function(l,s){var p=function(u,i){return function(x,f){return e(u,i,x)-e(u,i,f)}}(s,g[l].filter(w));r[l].sort(p),g[l].filter(function(u){return!w(u)}).sort(function(u){return g[l].indexOf(u)}).forEach(function(u){r[l].splice(r[l].indexOf(u),1),r[l].splice(g[l].indexOf(u),0,u)}),t.emit("plotly_restyle",[{dimensions:[r[l]]},[a[l]]])}})}}).reglPrecompiled=y},{"../../lib/prepare_regl":528,"./helpers":904,"./parcoords":908}],910:[function(m,G,Y){var d=m("../../plots/attributes"),v=m("../../plots/domain").attributes,w=m("../../plots/font_attributes"),y=m("../../components/color/attributes"),e=m("../../plots/template_attributes").hovertemplateAttrs,t=m("../../plots/template_attributes").texttemplateAttrs,n=m("../../lib/extend").extendFlat,o=w({editType:"plot",arrayOk:!0,colorEditType:"plot"});G.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:y.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:n({},d.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:e({},{keys:["label","color","value","percent","text"]}),texttemplate:t({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:n({},o,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:n({},o,{}),outsidetextfont:n({},o,{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:n({},o,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:v({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:n({},o,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":366,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],911:[function(m,G,Y){var d=m("../../plots/plots");Y.name="pie",Y.plot=function(v,w,y,e){d.plotBasePlot(Y.name,v,w,y,e)},Y.clean=function(v,w,y,e){d.cleanBasePlot(Y.name,v,w,y,e)}},{"../../plots/plots":628}],912:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("tinycolor2"),w=m("../../components/color"),y={};function e(n){return function(o,r){return!!o&&!!(o=v(o)).isValid()&&(o=w.addOpacity(o,o.getAlpha()),n[r]||(n[r]=o),o)}}function t(n,o){var r,g=JSON.stringify(n),c=o[g];if(!c){for(c=n.slice(),r=0;r<n.length;r++)c.push(v(n[r]).lighten(20).toHexString());for(r=0;r<n.length;r++)c.push(v(n[r]).darken(20).toHexString());o[g]=c}return c}G.exports={calc:function(n,o){var r,g,c=[],a=n._fullLayout,h=a.hiddenlabels||[],l=o.labels,s=o.marker.colors||[],p=o.values,u=o._length,i=o._hasValues&&u;if(o.dlabel)for(l=new Array(u),r=0;r<u;r++)l[r]=String(o.label0+r*o.dlabel);var x={},f=e(a["_"+o.type+"colormap"]),_=0,b=!1;for(r=0;r<u;r++){var T,k,L;if(i){if(T=p[r],!d(T))continue;T=+T}else T=1;(k=l[r])!==void 0&&k!==""||(k=r);var A=x[k=String(k)];A===void 0?(x[k]=c.length,(L=h.indexOf(k)!==-1)||(_+=T),c.push({v:T,label:k,color:f(s[r],k),i:r,pts:[r],hidden:L})):(b=!0,(g=c[A]).v+=T,g.pts.push(r),g.hidden||(_+=T),g.color===!1&&s[r]&&(g.color=f(s[r],k)))}return c=c.filter(function(I){return I.v>=0}),(o.type==="funnelarea"?b:o.sort)&&c.sort(function(I,P){return P.v-I.v}),c[0]&&(c[0].vTotal=_),c},crossTraceCalc:function(n,o){var r=(o||{}).type;r||(r="pie");var g=n._fullLayout,c=n.calcdata,a=g[r+"colorway"],h=g["_"+r+"colormap"];g["extend"+r+"colors"]&&(a=t(a,y));for(var l=0,s=0;s<c.length;s++){var p=c[s];if(p[0].trace.type===r)for(var u=0;u<p.length;u++){var i=p[u];i.color===!1&&(h[i.label]?i.color=h[i.label]:(h[i.label]=i.color=a[l%a.length],l++))}}},makePullColorFn:e,generateExtendedColors:t}},{"../../components/color":367,"fast-isnumeric":190,tinycolor2:313}],913:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("./attributes"),y=m("../../plots/domain").defaults,e=m("../bar/defaults").handleText;function t(n,o){var r=Array.isArray(n),g=v.isArrayOrTypedArray(o),c=Math.min(r?n.length:1/0,g?o.length:1/0);if(isFinite(c)||(c=0),c&&g){for(var a,h=0;h<c;h++){var l=o[h];if(d(l)&&l>0){a=!0;break}}a||(c=0)}return{hasLabels:r,hasValues:g,len:c}}G.exports={handleLabelsAndValues:t,supplyDefaults:function(n,o,r,g){function c(f,_){return v.coerce(n,o,w,f,_)}var a=t(c("labels"),c("values")),h=a.len;if(o._hasLabels=a.hasLabels,o._hasValues=a.hasValues,!o._hasLabels&&o._hasValues&&(c("label0"),c("dlabel")),h){o._length=h,c("marker.line.width")&&c("marker.line.color"),c("marker.colors"),c("scalegroup");var l,s=c("text"),p=c("texttemplate");if(p||(l=c("textinfo",Array.isArray(s)?"text+percent":"percent")),c("hovertext"),c("hovertemplate"),p||l&&l!=="none"){var u=c("textposition");e(n,o,g,c,u,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),(Array.isArray(u)||u==="auto"||u==="outside")&&c("automargin"),(u==="inside"||u==="auto"||Array.isArray(u))&&c("insidetextorientation")}y(o,g,c);var i=c("hole");if(c("title.text")){var x=c("title.position",i?"middle center":"top center");i||x!=="middle center"||(o.title.position="top center"),v.coerceFont(c,"title.font",g.font)}c("sort"),c("direction"),c("rotation"),c("pull")}else o.visible=!1}}},{"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"./attributes":910,"fast-isnumeric":190}],914:[function(m,G,Y){var d=m("../../components/fx/helpers").appendArrayMultiPointValues;G.exports=function(v,w){var y={curveNumber:w.index,pointNumbers:v.pts,data:w._input,fullData:w,label:v.label,color:v.color,value:v.v,percent:v.percent,text:v.text,bbox:v.bbox,v:v.v};return v.pts.length===1&&(y.pointNumber=y.i=v.pts[0]),d(y,w,v.pts),w.type==="funnelarea"&&(delete y.v,delete y.i),y}},{"../../components/fx/helpers":403}],915:[function(m,G,Y){var d=m("../../lib");function v(w){return w.indexOf("e")!==-1?w.replace(/[.]?0+e/,"e"):w.indexOf(".")!==-1?w.replace(/[.]?0+$/,""):w}Y.formatPiePercent=function(w,y){var e=v((100*w).toPrecision(3));return d.numSeparate(e,y)+"%"},Y.formatPieValue=function(w,y){var e=v(w.toPrecision(10));return d.numSeparate(e,y)},Y.getFirstFilled=function(w,y){if(Array.isArray(w))for(var e=0;e<y.length;e++){var t=w[y[e]];if(t||t===0||t==="")return t}},Y.castOption=function(w,y){return Array.isArray(w)?Y.getFirstFilled(w,y):w||void 0},Y.getRotationAngle=function(w){return(w==="auto"?0:w)*Math.PI/180}},{"../../lib":515}],916:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults").supplyDefaults,supplyLayoutDefaults:m("./layout_defaults"),layoutAttributes:m("./layout_attributes"),calc:m("./calc").calc,crossTraceCalc:m("./calc").crossTraceCalc,plot:m("./plot").plot,style:m("./style"),styleOne:m("./style_one"),moduleType:"trace",name:"pie",basePlotModule:m("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":910,"./base_plot":911,"./calc":912,"./defaults":913,"./layout_attributes":917,"./layout_defaults":918,"./plot":919,"./style":920,"./style_one":921}],917:[function(m,G,Y){G.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],918:[function(m,G,Y){var d=m("../../lib"),v=m("./layout_attributes");G.exports=function(w,y){function e(t,n){return d.coerce(w,y,v,t,n)}e("hiddenlabels"),e("piecolorway",y.colorway),e("extendpiecolors")}},{"../../lib":515,"./layout_attributes":917}],919:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../plots/plots"),w=m("../../components/fx"),y=m("../../components/color"),e=m("../../components/drawing"),t=m("../../lib"),n=t.strScale,o=t.strTranslate,r=m("../../lib/svg_text_utils"),g=m("../bar/uniform_text"),c=g.recordMinTextSize,a=g.clearMinTextSize,h=m("../bar/constants").TEXTPAD,l=m("./helpers"),s=m("./event_data"),p=m("../../lib").isValidTextValue;function u(Z,Q,X){var $=X[0],re=$.cx,H=$.cy,N=$.trace,U=N.type==="funnelarea";"_hasHoverLabel"in N||(N._hasHoverLabel=!1),"_hasHoverEvent"in N||(N._hasHoverEvent=!1),Z.on("mouseover",function(te){var B=Q._fullLayout,K=Q._fullData[N.index];if(!Q._dragging&&B.hovermode!==!1){var J=K.hoverinfo;if(Array.isArray(J)&&(J=w.castHoverinfo({hoverinfo:[l.castOption(J,te.pts)],_module:N._module},B,0)),J==="all"&&(J="label+text+value+percent+name"),K.hovertemplate||J!=="none"&&J!=="skip"&&J){var ee=te.rInscribed||0,ne=re+te.pxmid[0]*(1-ee),se=H+te.pxmid[1]*(1-ee),oe=B.separators,me=[];if(J&&J.indexOf("label")!==-1&&me.push(te.label),te.text=l.castOption(K.hovertext||K.text,te.pts),J&&J.indexOf("text")!==-1){var ce=te.text;t.isValidTextValue(ce)&&me.push(ce)}te.value=te.v,te.valueLabel=l.formatPieValue(te.v,oe),J&&J.indexOf("value")!==-1&&me.push(te.valueLabel),te.percent=te.v/$.vTotal,te.percentLabel=l.formatPiePercent(te.percent,oe),J&&J.indexOf("percent")!==-1&&me.push(te.percentLabel);var ye=K.hoverlabel,Se=ye.font,fe=[];w.loneHover({trace:N,x0:ne-ee*$.r,x1:ne+ee*$.r,y:se,_x0:U?re+te.TL[0]:ne-ee*$.r,_x1:U?re+te.TR[0]:ne+ee*$.r,_y0:U?H+te.TL[1]:se-ee*$.r,_y1:U?H+te.BL[1]:se+ee*$.r,text:me.join("<br>"),name:K.hovertemplate||J.indexOf("name")!==-1?K.name:void 0,idealAlign:te.pxmid[0]<0?"left":"right",color:l.castOption(ye.bgcolor,te.pts)||te.color,borderColor:l.castOption(ye.bordercolor,te.pts),fontFamily:l.castOption(Se.family,te.pts),fontSize:l.castOption(Se.size,te.pts),fontColor:l.castOption(Se.color,te.pts),nameLength:l.castOption(ye.namelength,te.pts),textAlign:l.castOption(ye.align,te.pts),hovertemplate:l.castOption(K.hovertemplate,te.pts),hovertemplateLabels:te,eventData:[s(te,K)]},{container:B._hoverlayer.node(),outerContainer:B._paper.node(),gd:Q,inOut_bbox:fe}),te.bbox=fe[0],N._hasHoverLabel=!0}N._hasHoverEvent=!0,Q.emit("plotly_hover",{points:[s(te,K)],event:d.event})}}),Z.on("mouseout",function(te){var B=Q._fullLayout,K=Q._fullData[N.index],J=d.select(this).datum();N._hasHoverEvent&&(te.originalEvent=d.event,Q.emit("plotly_unhover",{points:[s(J,K)],event:d.event}),N._hasHoverEvent=!1),N._hasHoverLabel&&(w.loneUnhover(B._hoverlayer.node()),N._hasHoverLabel=!1)}),Z.on("click",function(te){var B=Q._fullLayout,K=Q._fullData[N.index];Q._dragging||B.hovermode===!1||(Q._hoverdata=[s(te,K)],w.click(Q,d.event))})}function i(Z,Q,X){var $=l.castOption(Z.insidetextfont.color,Q.pts);!$&&Z._input.textfont&&($=l.castOption(Z._input.textfont.color,Q.pts));var re=l.castOption(Z.insidetextfont.family,Q.pts)||l.castOption(Z.textfont.family,Q.pts)||X.family,H=l.castOption(Z.insidetextfont.size,Q.pts)||l.castOption(Z.textfont.size,Q.pts)||X.size;return{color:$||y.contrast(Q.color),family:re,size:H}}function x(Z,Q){for(var X,$,re=0;re<Z.length;re++)if(($=(X=Z[re][0]).trace).title.text){var H=$.title.text;$._meta&&(H=t.templateString(H,$._meta));var N=e.tester.append("text").attr("data-notex",1).text(H).call(e.font,$.title.font).call(r.convertToTspans,Q),U=e.bBox(N.node(),!0);X.titleBox={width:U.width,height:U.height},N.remove()}}function f(Z,Q,X){var $=X.r||Q.rpx1,re=Q.rInscribed;if(Q.startangle===Q.stopangle)return{rCenter:1-re,scale:0,rotate:0,textPosAngle:0};var H,N=Q.ring,U=N===1&&Math.abs(Q.startangle-Q.stopangle)===2*Math.PI,te=Q.halfangle,B=Q.midangle,K=X.trace.insidetextorientation,J=K==="horizontal",ee=K==="tangential",ne=K==="radial",se=K==="auto",oe=[];if(!se){var me,ce=function(le,ve){if(function(Ie,De){var Oe=Ie.startangle,Ve=Ie.stopangle;return Oe>De&&De>Ve||Oe<De&&De<Ve}(Q,le)){var Me=Math.abs(le-Q.startangle),we=Math.abs(le-Q.stopangle),de=Me<we?Me:we;(H=ve==="tan"?b(Z,$,N,de,0):_(Z,$,N,de,Math.PI/2)).textPosAngle=le,oe.push(H)}};if(J||ee){for(me=4;me>=-4;me-=2)ce(Math.PI*me,"tan");for(me=4;me>=-4;me-=2)ce(Math.PI*(me+1),"tan")}if(J||ne){for(me=4;me>=-4;me-=2)ce(Math.PI*(me+1.5),"rad");for(me=4;me>=-4;me-=2)ce(Math.PI*(me+.5),"rad")}}if(U||se||J){var ye=Math.sqrt(Z.width*Z.width+Z.height*Z.height);if((H={scale:re*$*2/ye,rCenter:1-re,rotate:0}).textPosAngle=(Q.startangle+Q.stopangle)/2,H.scale>=1)return H;oe.push(H)}(se||ne)&&((H=_(Z,$,N,te,B)).textPosAngle=(Q.startangle+Q.stopangle)/2,oe.push(H)),(se||ee)&&((H=b(Z,$,N,te,B)).textPosAngle=(Q.startangle+Q.stopangle)/2,oe.push(H));for(var Se=0,fe=0,ge=0;ge<oe.length;ge++){var Te=oe[ge].scale;if(fe<Te&&(fe=Te,Se=ge),!se&&fe>=1)break}return oe[Se]}function _(Z,Q,X,$,re){Q=Math.max(0,Q-2*h);var H=Z.width/Z.height,N=L(H,$,Q,X);return{scale:2*N/Z.height,rCenter:T(H,N/Q),rotate:k(re)}}function b(Z,Q,X,$,re){Q=Math.max(0,Q-2*h);var H=Z.height/Z.width,N=L(H,$,Q,X);return{scale:2*N/Z.width,rCenter:T(H,N/Q),rotate:k(re+Math.PI/2)}}function T(Z,Q){return Math.cos(Q)-Z*Q}function k(Z){return(180/Math.PI*Z+720)%180-90}function L(Z,Q,X,$){var re=Z+1/(2*Math.tan(Q));return X*Math.min(1/(Math.sqrt(re*re+.5)+re),$/(Math.sqrt(Z*Z+$/2)+Z))}function A(Z,Q){return Z.v!==Q.vTotal||Q.trace.hole?Math.min(1/(1+1/Math.sin(Z.halfangle)),Z.ring/2):1}function I(Z,Q){var X=Q.pxmid[0],$=Q.pxmid[1],re=Z.width/2,H=Z.height/2;return X<0&&(re*=-1),$<0&&(H*=-1),{scale:1,rCenter:1,rotate:0,x:re+Math.abs(H)*(re>0?1:-1)/2,y:H/(1+X*X/($*$)),outside:!0}}function P(Z,Q){var X,$,re,H=Z.trace,N={x:Z.cx,y:Z.cy},U={tx:0,ty:0};U.ty+=H.title.font.size,re=E(H),H.title.position.indexOf("top")!==-1?(N.y-=(1+re)*Z.r,U.ty-=Z.titleBox.height):H.title.position.indexOf("bottom")!==-1&&(N.y+=(1+re)*Z.r);var te,B,K=(te=Z.r,B=Z.trace.aspectratio,te/(B===void 0?1:B)),J=Q.w*(H.domain.x[1]-H.domain.x[0])/2;return H.title.position.indexOf("left")!==-1?(J+=K,N.x-=(1+re)*K,U.tx+=Z.titleBox.width/2):H.title.position.indexOf("center")!==-1?J*=2:H.title.position.indexOf("right")!==-1&&(J+=K,N.x+=(1+re)*K,U.tx-=Z.titleBox.width/2),X=J/Z.titleBox.width,$=S(Z,Q)/Z.titleBox.height,{x:N.x,y:N.y,scale:Math.min(X,$),tx:U.tx,ty:U.ty}}function S(Z,Q){var X=Z.trace,$=Q.h*(X.domain.y[1]-X.domain.y[0]);return Math.min(Z.titleBox.height,$/2)}function E(Z){var Q,X=Z.pull;if(!X)return 0;if(Array.isArray(X))for(X=0,Q=0;Q<Z.pull.length;Q++)Z.pull[Q]>X&&(X=Z.pull[Q]);return X}function z(Z,Q){for(var X=[],$=0;$<Z.length;$++){var re=Z[$][0],H=re.trace,N=H.domain,U=Q.w*(N.x[1]-N.x[0]),te=Q.h*(N.y[1]-N.y[0]);H.title.text&&H.title.position!=="middle center"&&(te-=S(re,Q));var B=U/2,K=te/2;H.type!=="funnelarea"||H.scalegroup||(K/=H.aspectratio),re.r=Math.min(B,K)/(1+E(H)),re.cx=Q.l+Q.w*(H.domain.x[1]+H.domain.x[0])/2,re.cy=Q.t+Q.h*(1-H.domain.y[0])-te/2,H.title.text&&H.title.position.indexOf("bottom")!==-1&&(re.cy-=S(re,Q)),H.scalegroup&&X.indexOf(H.scalegroup)===-1&&X.push(H.scalegroup)}(function(J,ee){for(var ne,se,oe,me=0;me<ee.length;me++){var ce=1/0,ye=ee[me];for(se=0;se<J.length;se++)if(ne=J[se][0],(oe=ne.trace).scalegroup===ye){var Se;if(oe.type==="pie")Se=ne.r*ne.r;else if(oe.type==="funnelarea"){var fe,ge;oe.aspectratio>1?(fe=ne.r,ge=fe/oe.aspectratio):(ge=ne.r,fe=ge*oe.aspectratio),fe*=(1+oe.baseratio)/2,Se=fe*ge}ce=Math.min(ce,Se/ne.vTotal)}for(se=0;se<J.length;se++)if(ne=J[se][0],(oe=ne.trace).scalegroup===ye){var Te=ce*ne.vTotal;oe.type==="funnelarea"&&(Te/=(1+oe.baseratio)/2,Te/=oe.aspectratio),ne.r=Math.sqrt(Te)}}})(Z,X)}function D(Z,Q){return[Z*Math.sin(Q),-Z*Math.cos(Q)]}function j(Z,Q,X){var $=Z._fullLayout,re=X.trace,H=re.texttemplate,N=re.textinfo;if(!H&&N&&N!=="none"){var U,te=N.split("+"),B=function(Se){return te.indexOf(Se)!==-1},K=B("label"),J=B("text"),ee=B("value"),ne=B("percent"),se=$.separators;if(U=K?[Q.label]:[],J){var oe=l.getFirstFilled(re.text,Q.pts);p(oe)&&U.push(oe)}ee&&U.push(l.formatPieValue(Q.v,se)),ne&&U.push(l.formatPiePercent(Q.v/X.vTotal,se)),Q.text=U.join("<br>")}if(H){var me=t.castOption(re,Q.i,"texttemplate");if(me){var ce=function(Se){return{label:Se.label,value:Se.v,valueLabel:l.formatPieValue(Se.v,$.separators),percent:Se.v/X.vTotal,percentLabel:l.formatPiePercent(Se.v/X.vTotal,$.separators),color:Se.color,text:Se.text,customdata:t.castOption(re,Se.i,"customdata")}}(Q),ye=l.getFirstFilled(re.text,Q.pts);(p(ye)||ye==="")&&(ce.text=ye),Q.text=t.texttemplateString(me,ce,Z._fullLayout._d3locale,ce,re._meta||{})}else Q.text=""}}function V(Z,Q){var X=Z.rotate*Math.PI/180,$=Math.cos(X),re=Math.sin(X),H=(Q.left+Q.right)/2,N=(Q.top+Q.bottom)/2;Z.textX=H*$-N*re,Z.textY=H*re+N*$,Z.noCenter=!0}G.exports={plot:function(Z,Q){var X=Z._context.staticPlot,$=Z._fullLayout,re=$._size;a("pie",$),x(Q,Z),z(Q,re);var H=t.makeTraceGroups($._pielayer,Q,"trace").each(function(N){var U=d.select(this),te=N[0],B=te.trace;(function(K){var J,ee,ne,se=K[0],oe=se.r,me=se.trace,ce=l.getRotationAngle(me.rotation),ye=2*Math.PI/se.vTotal,Se="px0",fe="px1";if(me.direction==="counterclockwise"){for(J=0;J<K.length&&K[J].hidden;J++);if(J===K.length)return;ce+=ye*K[J].v,ye*=-1,Se="px1",fe="px0"}for(ne=D(oe,ce),J=0;J<K.length;J++)(ee=K[J]).hidden||(ee[Se]=ne,ee.startangle=ce,ce+=ye*ee.v/2,ee.pxmid=D(oe,ce),ee.midangle=ce,ce+=ye*ee.v/2,ne=D(oe,ce),ee.stopangle=ce,ee[fe]=ne,ee.largeArc=ee.v>se.vTotal/2?1:0,ee.halfangle=Math.PI*Math.min(ee.v/se.vTotal,.5),ee.ring=1-me.hole,ee.rInscribed=A(ee,se))})(N),U.attr("stroke-linejoin","round"),U.each(function(){var K=d.select(this).selectAll("g.slice").data(N);K.enter().append("g").classed("slice",!0),K.exit().remove();var J=[[[],[]],[[],[]]],ee=!1;K.each(function(fe,ge){if(fe.hidden)d.select(this).selectAll("path,g").remove();else{fe.pointNumber=fe.i,fe.curveNumber=B.index,J[fe.pxmid[1]<0?0:1][fe.pxmid[0]<0?0:1].push(fe);var Te=te.cx,le=te.cy,ve=d.select(this),Me=ve.selectAll("path.surface").data([fe]);if(Me.enter().append("path").classed("surface",!0).style({"pointer-events":X?"none":"all"}),ve.call(u,Z,N),B.pull){var we=+l.castOption(B.pull,fe.pts)||0;we>0&&(Te+=we*fe.pxmid[0],le+=we*fe.pxmid[1])}fe.cxFinal=Te,fe.cyFinal=le;var de=B.hole;if(fe.v===te.vTotal){var Ie="M"+(Te+fe.px0[0])+","+(le+fe.px0[1])+ze(fe.px0,fe.pxmid,!0,1)+ze(fe.pxmid,fe.px0,!0,1)+"Z";de?Me.attr("d","M"+(Te+de*fe.px0[0])+","+(le+de*fe.px0[1])+ze(fe.px0,fe.pxmid,!1,de)+ze(fe.pxmid,fe.px0,!1,de)+"Z"+Ie):Me.attr("d",Ie)}else{var De=ze(fe.px0,fe.px1,!0,1);if(de){var Oe=1-de;Me.attr("d","M"+(Te+de*fe.px1[0])+","+(le+de*fe.px1[1])+ze(fe.px1,fe.px0,!1,de)+"l"+Oe*fe.px0[0]+","+Oe*fe.px0[1]+De+"Z")}else Me.attr("d","M"+Te+","+le+"l"+fe.px0[0]+","+fe.px0[1]+De+"Z")}j(Z,fe,te);var Ve=l.castOption(B.textposition,fe.pts),Fe=ve.selectAll("g.slicetext").data(fe.text&&Ve!=="none"?[0]:[]);Fe.enter().append("g").classed("slicetext",!0),Fe.exit().remove(),Fe.each(function(){var Re=t.ensureSingle(d.select(this),"text","",function(Qe){Qe.attr("data-notex",1)}),We=t.ensureUniformFontSize(Z,Ve==="outside"?function(Qe,vt,jt){var Gt=l.castOption(Qe.outsidetextfont.color,vt.pts)||l.castOption(Qe.textfont.color,vt.pts)||jt.color,$t=l.castOption(Qe.outsidetextfont.family,vt.pts)||l.castOption(Qe.textfont.family,vt.pts)||jt.family,Zt=l.castOption(Qe.outsidetextfont.size,vt.pts)||l.castOption(Qe.textfont.size,vt.pts)||jt.size;return{color:Gt,family:$t,size:Zt}}(B,fe,$.font):i(B,fe,$.font));Re.text(fe.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(e.font,We).call(r.convertToTspans,Z);var $e,at=e.bBox(Re.node());if(Ve==="outside")$e=I(at,fe);else if($e=f(at,fe,te),Ve==="auto"&&$e.scale<1){var gt=t.ensureUniformFontSize(Z,B.outsidetextfont);Re.call(e.font,gt),$e=I(at=e.bBox(Re.node()),fe)}var xt=$e.textPosAngle,mt=xt===void 0?fe.pxmid:D(te.r,xt);if($e.targetX=Te+mt[0]*$e.rCenter+($e.x||0),$e.targetY=le+mt[1]*$e.rCenter+($e.y||0),V($e,at),$e.outside){var nt=$e.targetY;fe.yLabelMin=nt-at.height/2,fe.yLabelMid=nt,fe.yLabelMax=nt+at.height/2,fe.labelExtraX=0,fe.labelExtraY=0,ee=!0}$e.fontSize=We.size,c(B.type,$e,$),N[ge].transform=$e,t.setTransormAndDisplay(Re,$e)})}function ze(Re,We,$e,at){var gt=at*(We[0]-Re[0]),xt=at*(We[1]-Re[1]);return"a"+at*te.r+","+at*te.r+" 0 "+fe.largeArc+($e?" 1 ":" 0 ")+gt+","+xt}});var ne=d.select(this).selectAll("g.titletext").data(B.title.text?[0]:[]);if(ne.enter().append("g").classed("titletext",!0),ne.exit().remove(),ne.each(function(){var fe,ge=t.ensureSingle(d.select(this),"text","",function(le){le.attr("data-notex",1)}),Te=B.title.text;B._meta&&(Te=t.templateString(Te,B._meta)),ge.text(Te).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(e.font,B.title.font).call(r.convertToTspans,Z),fe=B.title.position==="middle center"?function(le){var ve=Math.sqrt(le.titleBox.width*le.titleBox.width+le.titleBox.height*le.titleBox.height);return{x:le.cx,y:le.cy,scale:le.trace.hole*le.r*2/ve,tx:0,ty:-le.titleBox.height/2+le.trace.title.font.size}}(te):P(te,re),ge.attr("transform",o(fe.x,fe.y)+n(Math.min(1,fe.scale))+o(fe.tx,fe.ty))}),ee&&function(fe,ge){var Te,le,ve,Me,we,de,Ie,De,Oe,Ve,Fe,ze,Re;function We(xt,mt){return xt.pxmid[1]-mt.pxmid[1]}function $e(xt,mt){return mt.pxmid[1]-xt.pxmid[1]}function at(xt,mt){mt||(mt={});var nt,Qe,vt,jt,Gt=mt.labelExtraY+(le?mt.yLabelMax:mt.yLabelMin),$t=le?xt.yLabelMin:xt.yLabelMax,Zt=le?xt.yLabelMax:xt.yLabelMin,cr=xt.cyFinal+we(xt.px0[1],xt.px1[1]),Dt=Gt-$t;if(Dt*Ie>0&&(xt.labelExtraY=Dt),Array.isArray(ge.pull))for(Qe=0;Qe<Ve.length;Qe++)(vt=Ve[Qe])===xt||(l.castOption(ge.pull,xt.pts)||0)>=(l.castOption(ge.pull,vt.pts)||0)||((xt.pxmid[1]-vt.pxmid[1])*Ie>0?(Dt=vt.cyFinal+we(vt.px0[1],vt.px1[1])-$t-xt.labelExtraY)*Ie>0&&(xt.labelExtraY+=Dt):(Zt+xt.labelExtraY-cr)*Ie>0&&(nt=3*de*Math.abs(Qe-Ve.indexOf(xt)),(jt=vt.cxFinal+Me(vt.px0[0],vt.px1[0])+nt-(xt.cxFinal+xt.pxmid[0])-xt.labelExtraX)*de>0&&(xt.labelExtraX+=jt)))}for(le=0;le<2;le++)for(ve=le?We:$e,we=le?Math.max:Math.min,Ie=le?1:-1,Te=0;Te<2;Te++){for(Me=Te?Math.max:Math.min,de=Te?1:-1,(De=fe[le][Te]).sort(ve),Oe=fe[1-le][Te],Ve=Oe.concat(De),ze=[],Fe=0;Fe<De.length;Fe++)De[Fe].yLabelMid!==void 0&&ze.push(De[Fe]);for(Re=!1,Fe=0;le&&Fe<Oe.length;Fe++)if(Oe[Fe].yLabelMid!==void 0){Re=Oe[Fe];break}for(Fe=0;Fe<ze.length;Fe++){var gt=Fe&&ze[Fe-1];Re&&!Fe&&(gt=Re),at(ze[Fe],gt)}}}(J,B),function(fe,ge){fe.each(function(Te){var le=d.select(this);if(Te.labelExtraX||Te.labelExtraY){var ve=le.select("g.slicetext text");Te.transform.targetX+=Te.labelExtraX,Te.transform.targetY+=Te.labelExtraY,t.setTransormAndDisplay(ve,Te.transform);var Me=Te.cxFinal+Te.pxmid[0],we="M"+Me+","+(Te.cyFinal+Te.pxmid[1]),de=(Te.yLabelMax-Te.yLabelMin)*(Te.pxmid[0]<0?-1:1)/4;if(Te.labelExtraX){var Ie=Te.labelExtraX*Te.pxmid[1]/Te.pxmid[0],De=Te.yLabelMid+Te.labelExtraY-(Te.cyFinal+Te.pxmid[1]);Math.abs(Ie)>Math.abs(De)?we+="l"+De*Te.pxmid[0]/Te.pxmid[1]+","+De+"H"+(Me+Te.labelExtraX+de):we+="l"+Te.labelExtraX+","+Ie+"v"+(De-Ie)+"h"+de}else we+="V"+(Te.yLabelMid+Te.labelExtraY)+"h"+de;t.ensureSingle(le,"path","textline").call(y.stroke,ge.outsidetextfont.color).attr({"stroke-width":Math.min(2,ge.outsidetextfont.size/8),d:we,fill:"none"})}else le.select("path.textline").remove()})}(K,B),ee&&B.automargin){var se=e.bBox(U.node()),oe=B.domain,me=re.w*(oe.x[1]-oe.x[0]),ce=re.h*(oe.y[1]-oe.y[0]),ye=(.5*me-te.r)/re.w,Se=(.5*ce-te.r)/re.h;v.autoMargin(Z,"pie."+B.uid+".automargin",{xl:oe.x[0]-ye,xr:oe.x[1]+ye,yb:oe.y[0]-Se,yt:oe.y[1]+Se,l:Math.max(te.cx-te.r-se.left,0),r:Math.max(se.right-(te.cx+te.r),0),b:Math.max(se.bottom-(te.cy+te.r),0),t:Math.max(te.cy-te.r-se.top,0),pad:5})}})});setTimeout(function(){H.selectAll("tspan").each(function(){var N=d.select(this);N.attr("dy")&&N.attr("dy",N.attr("dy"))})},0)},formatSliceLabel:j,transformInsideText:f,determineInsideTextFont:i,positionTitleOutside:P,prerenderTitles:x,layoutAreas:z,attachFxHandlers:u,computeTransform:V}},{"../../components/color":367,"../../components/drawing":389,"../../components/fx":407,"../../lib":515,"../../lib/svg_text_utils":541,"../../plots/plots":628,"../bar/constants":659,"../bar/uniform_text":673,"./event_data":914,"./helpers":915,"@plotly/d3":58}],920:[function(m,G,Y){var d=m("@plotly/d3"),v=m("./style_one"),w=m("../bar/uniform_text").resizeText;G.exports=function(y){var e=y._fullLayout._pielayer.selectAll(".trace");w(y,e,"pie"),e.each(function(t){var n=t[0].trace,o=d.select(this);o.style({opacity:n.opacity}),o.selectAll("path.surface").each(function(r){d.select(this).call(v,r,n)})})}},{"../bar/uniform_text":673,"./style_one":921,"@plotly/d3":58}],921:[function(m,G,Y){var d=m("../../components/color"),v=m("./helpers").castOption;G.exports=function(w,y,e){var t=e.marker.line,n=v(t.color,y.pts)||d.defaultLine,o=v(t.width,y.pts)||0;w.style("stroke-width",o).call(d.fill,y.color).call(d.stroke,n)}},{"../../components/color":367,"./helpers":915}],922:[function(m,G,Y){var d=m("../scatter/attributes");G.exports={x:d.x,y:d.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:d.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":936}],923:[function(m,G,Y){var d=m("../../../stackgl_modules").gl_pointcloud2d,v=m("../../lib/str2rgbarray"),w=m("../../plots/cartesian/autorange").findExtremes,y=m("../scatter/get_trace_color");function e(n,o){this.scene=n,this.uid=o,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=d(n.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var t=e.prototype;t.handlePick=function(n){var o=this.idToIndex[n.pointId];return{trace:this,dataCoord:n.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[2*o],this.pickXYData[2*o+1]]:[this.pickXData[o],this.pickYData[o]],textLabel:Array.isArray(this.textLabels)?this.textLabels[o]:this.textLabels,color:this.color,name:this.name,pointIndex:o,hoverinfo:this.hoverinfo}},t.update=function(n){this.index=n.index,this.textLabels=n.text,this.name=n.name,this.hoverinfo=n.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(n),this.color=y(n,{})},t.updateFast=function(n){var o,r,g,c,a,h,l=this.xData=this.pickXData=n.x,s=this.yData=this.pickYData=n.y,p=this.pickXYData=n.xy,u=n.xbounds&&n.ybounds,i=n.indices,x=this.bounds;if(p){if(g=p,o=p.length>>>1,u)x[0]=n.xbounds[0],x[2]=n.xbounds[1],x[1]=n.ybounds[0],x[3]=n.ybounds[1];else for(h=0;h<o;h++)c=g[2*h],a=g[2*h+1],c<x[0]&&(x[0]=c),c>x[2]&&(x[2]=c),a<x[1]&&(x[1]=a),a>x[3]&&(x[3]=a);if(i)r=i;else for(r=new Int32Array(o),h=0;h<o;h++)r[h]=h}else for(o=l.length,g=new Float32Array(2*o),r=new Int32Array(o),h=0;h<o;h++)c=l[h],a=s[h],r[h]=h,g[2*h]=c,g[2*h+1]=a,c<x[0]&&(x[0]=c),c>x[2]&&(x[2]=c),a<x[1]&&(x[1]=a),a>x[3]&&(x[3]=a);this.idToIndex=r,this.pointcloudOptions.idToIndex=r,this.pointcloudOptions.positions=g;var f=v(n.marker.color),_=v(n.marker.border.color),b=n.opacity*n.marker.opacity;f[3]*=b,this.pointcloudOptions.color=f;var T=n.marker.blend;T===null&&(T=l.length<100||s.length<100),this.pointcloudOptions.blend=T,_[3]*=b,this.pointcloudOptions.borderColor=_;var k=n.marker.sizemin,L=Math.max(n.marker.sizemax,n.marker.sizemin);this.pointcloudOptions.sizeMin=k,this.pointcloudOptions.sizeMax=L,this.pointcloudOptions.areaRatio=n.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var A=this.scene.xaxis,I=this.scene.yaxis,P=L/2||.5;n._extremes[A._id]=w(A,[x[0],x[2]],{ppad:P}),n._extremes[I._id]=w(I,[x[1],x[3]],{ppad:P})},t.dispose=function(){this.pointcloud.dispose()},G.exports=function(n,o){var r=new e(n,o.uid);return r.update(o),r}},{"../../../stackgl_modules":1133,"../../lib/str2rgbarray":540,"../../plots/cartesian/autorange":565,"../scatter/get_trace_color":946}],924:[function(m,G,Y){var d=m("../../lib"),v=m("./attributes");G.exports=function(w,y,e){function t(n,o){return d.coerce(w,y,v,n,o)}t("x"),t("y"),t("xbounds"),t("ybounds"),w.xy&&w.xy instanceof Float32Array&&(y.xy=w.xy),w.indices&&w.indices instanceof Int32Array&&(y.indices=w.indices),t("text"),t("marker.color",e),t("marker.opacity"),t("marker.blend"),t("marker.sizemin"),t("marker.sizemax"),t("marker.border.color",e),t("marker.border.arearatio"),y._length=null}},{"../../lib":515,"./attributes":922}],925:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),calc:m("../scatter3d/calc"),plot:m("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:m("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":605,"../scatter3d/calc":965,"./attributes":922,"./convert":923,"./defaults":924}],926:[function(m,G,Y){var d=m("../../plots/font_attributes"),v=m("../../plots/attributes"),w=m("../../components/color/attributes"),y=m("../../components/fx/attributes"),e=m("../../plots/domain").attributes,t=m("../../plots/template_attributes").hovertemplateAttrs,n=m("../../components/colorscale/attributes"),o=m("../../plot_api/plot_template").templatedArray,r=m("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers,g=m("../../lib/extend").extendFlat,c=m("../../plot_api/edit_types").overrideAll;(G.exports=c({hoverinfo:g({},v.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:y.hoverlabel,domain:e({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s",description:r("value")},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:d({}),customdata:void 0,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:w.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:y.hoverlabel,hovertemplate:t({},{keys:["value","label"]})},link:{arrowlen:{valType:"number",min:0,dflt:0},label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:w.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:y.hoverlabel,hovertemplate:t({},{keys:["value","label"]}),colorscales:o("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:g(n().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested")).transforms=void 0},{"../../components/color/attributes":366,"../../components/colorscale/attributes":374,"../../components/fx/attributes":398,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plot_api/plot_template":555,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/domain":593,"../../plots/font_attributes":594,"../../plots/template_attributes":642}],927:[function(m,G,Y){var d=m("../../plot_api/edit_types").overrideAll,v=m("../../plots/get_data").getModuleCalcData,w=m("./plot"),y=m("../../components/fx/layout_attributes"),e=m("../../lib/setcursor"),t=m("../../components/dragelement"),n=m("../../components/selections").prepSelect,o=m("../../lib"),r=m("../../registry");function g(c,a){var h=c._fullData[a],l=c._fullLayout,s=l.dragmode,p=l.dragmode==="pan"?"move":"crosshair",u=h._bgRect;if(u&&s!=="pan"&&s!=="zoom"){e(u,p);var i={_id:"x",c2p:o.identity,_offset:h._sankey.translateX,_length:h._sankey.width},x={_id:"y",c2p:o.identity,_offset:h._sankey.translateY,_length:h._sankey.height},f={gd:c,element:u.node(),plotinfo:{id:a,xaxis:i,yaxis:x,fillRangeItems:o.noop},subplot:a,xaxes:[i],yaxes:[x],doneFnCompleted:function(_){var b,T=c._fullData[a],k=T.node.groups.slice(),L=[];function A(E){for(var z=T._sankey.graph.nodes,D=0;D<z.length;D++)if(z[D].pointNumber===E)return z[D]}for(var I=0;I<_.length;I++){var P=A(_[I].pointNumber);if(P)if(P.group){for(var S=0;S<P.childrenNodes.length;S++)L.push(P.childrenNodes[S].pointNumber);k[P.pointNumber-T.node._count]=!1}else L.push(P.pointNumber)}b=k.filter(Boolean).concat([L]),r.call("_guiRestyle",c,{"node.groups":[b]},a)},prepFn:function(_,b,T){n(_,b,T,f,s)}};t.init(f)}}Y.name="sankey",Y.baseLayoutAttrOverrides=d({hoverlabel:y.hoverlabel},"plot","nested"),Y.plot=function(c){var a=v(c.calcdata,"sankey")[0];w(c,a),Y.updateFx(c)},Y.clean=function(c,a,h,l){var s=l._has&&l._has("sankey"),p=a._has&&a._has("sankey");s&&!p&&(l._paperdiv.selectAll(".sankey").remove(),l._paperdiv.selectAll(".bgsankey").remove())},Y.updateFx=function(c){for(var a=0;a<c._fullData.length;a++)g(c,a)}},{"../../components/dragelement":386,"../../components/fx/layout_attributes":408,"../../components/selections":455,"../../lib":515,"../../lib/setcursor":536,"../../plot_api/edit_types":548,"../../plots/get_data":602,"../../registry":647,"./plot":932}],928:[function(m,G,Y){var d=m("strongly-connected-components"),v=m("../../lib"),w=m("../../lib/gup").wrap,y=v.isArrayOrTypedArray,e=v.isIndex,t=m("../../components/colorscale");function n(o){var r,g=o.node,c=o.link,a=[],h=y(c.color),l=y(c.customdata),s={},p={},u=c.colorscales.length;for(r=0;r<u;r++){var i=c.colorscales[r],x=t.extractScale(i,{cLetter:"c"}),f=t.makeColorScaleFunc(x);p[i.label]=f}var _=0;for(r=0;r<c.value.length;r++)c.source[r]>_&&(_=c.source[r]),c.target[r]>_&&(_=c.target[r]);var b,T=_+1;o.node._count=T;var k=o.node.groups,L={};for(r=0;r<k.length;r++){var A=k[r];for(b=0;b<A.length;b++){var I=A[b],P=T+r;L.hasOwnProperty(I)?v.warn("Node "+I+" is already part of a group."):L[I]=P}}var S={source:[],target:[]};for(r=0;r<c.value.length;r++){var E=c.value[r],z=c.source[r],D=c.target[r];if(E>0&&e(z,T)&&e(D,T)&&(!L.hasOwnProperty(z)||!L.hasOwnProperty(D)||L[z]!==L[D])){L.hasOwnProperty(D)&&(D=L[D]),L.hasOwnProperty(z)&&(z=L[z]),D=+D,s[z=+z]=s[D]=!0;var j="";c.label&&c.label[r]&&(j=c.label[r]);var V=null;j&&p.hasOwnProperty(j)&&(V=p[j]),a.push({pointNumber:r,label:j,color:h?c.color[r]:c.color,customdata:l?c.customdata[r]:c.customdata,concentrationscale:V,source:z,target:D,value:+E}),S.source.push(z),S.target.push(D)}}var Z=T+k.length,Q=y(g.color),X=y(g.customdata),$=[];for(r=0;r<Z;r++)if(s[r]){var re=g.label[r];$.push({group:r>T-1,childrenNodes:[],pointNumber:r,label:re,color:Q?g.color[r]:g.color,customdata:X?g.customdata[r]:g.customdata})}var H=!1;return function(N,U,te){for(var B=v.init2dArray(N,0),K=0;K<Math.min(U.length,te.length);K++)if(v.isIndex(U[K],N)&&v.isIndex(te[K],N)){if(U[K]===te[K])return!0;B[U[K]].push(te[K])}return d(B).components.some(function(J){return J.length>1})}(Z,S.source,S.target)&&(H=!0),{circular:H,links:a,nodes:$,groups:k,groupLookup:L}}G.exports=function(o,r){var g=n(r);return w({circular:g.circular,_nodes:g.nodes,_links:g.links,_groups:g.groups,_groupLookup:g.groupLookup})}},{"../../components/colorscale":379,"../../lib":515,"../../lib/gup":512,"strongly-connected-components":307}],929:[function(m,G,Y){G.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeLabel:"node-label"}}},{}],930:[function(m,G,Y){var d=m("../../lib"),v=m("./attributes"),w=m("../../components/color"),y=m("tinycolor2"),e=m("../../plots/domain").defaults,t=m("../../components/fx/hoverlabel_defaults"),n=m("../../plot_api/plot_template"),o=m("../../plots/array_container_defaults");function r(g,c){function a(h,l){return d.coerce(g,c,v.link.colorscales,h,l)}a("label"),a("cmin"),a("cmax"),a("colorscale")}G.exports=function(g,c,a,h){function l(L,A){return d.coerce(g,c,v,L,A)}var s=d.extendDeep(h.hoverlabel,g.hoverlabel),p=g.node,u=n.newContainer(c,"node");function i(L,A){return d.coerce(p,u,v.node,L,A)}i("label"),i("groups"),i("x"),i("y"),i("pad"),i("thickness"),i("line.color"),i("line.width"),i("hoverinfo",g.hoverinfo),t(p,u,i,s),i("hovertemplate");var x=h.colorway;i("color",u.label.map(function(L,A){return w.addOpacity(function(I){return x[I%x.length]}(A),.8)})),i("customdata");var f=g.link||{},_=n.newContainer(c,"link");function b(L,A){return d.coerce(f,_,v.link,L,A)}b("label"),b("arrowlen"),b("source"),b("target"),b("value"),b("line.color"),b("line.width"),b("hoverinfo",g.hoverinfo),t(f,_,b,s),b("hovertemplate");var T,k=y(h.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";b("color",d.repeat(k,_.value.length)),b("customdata"),o(f,_,{name:"colorscales",handleItemDefaults:r}),e(c,h,l),l("orientation"),l("valueformat"),l("valuesuffix"),u.x.length&&u.y.length&&(T="freeform"),l("arrangement",T),d.coerceFont(l,"textfont",d.extendFlat({},h.font)),c._length=null}},{"../../components/color":367,"../../components/fx/hoverlabel_defaults":405,"../../lib":515,"../../plot_api/plot_template":555,"../../plots/array_container_defaults":561,"../../plots/domain":593,"./attributes":926,tinycolor2:313}],931:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),calc:m("./calc"),plot:m("./plot"),moduleType:"trace",name:"sankey",basePlotModule:m("./base_plot"),selectPoints:m("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":926,"./base_plot":927,"./calc":928,"./defaults":930,"./plot":932,"./select.js":934}],932:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../lib"),w=v.numberFormat,y=m("./render"),e=m("../../components/fx"),t=m("../../components/color"),n=m("./constants").cn,o=v._;function r(f){return f!==""}function g(f,_){return f.filter(function(b){return b.key===_.traceId})}function c(f,_){d.select(f).select("path").style("fill-opacity",_),d.select(f).select("rect").style("fill-opacity",_)}function a(f){d.select(f).select("text.name").style("fill","black")}function h(f){return function(_){return f.node.sourceLinks.indexOf(_.link)!==-1||f.node.targetLinks.indexOf(_.link)!==-1}}function l(f){return function(_){return _.node.sourceLinks.indexOf(f.link)!==-1||_.node.targetLinks.indexOf(f.link)!==-1}}function s(f,_,b){_&&b&&g(b,_).selectAll("."+n.sankeyLink).filter(h(_)).call(u.bind(0,_,b,!1))}function p(f,_,b){_&&b&&g(b,_).selectAll("."+n.sankeyLink).filter(h(_)).call(i.bind(0,_,b,!1))}function u(f,_,b,T){var k=T.datum().link.label;T.style("fill-opacity",function(L){if(!L.link.concentrationscale)return .4}),k&&g(_,f).selectAll("."+n.sankeyLink).filter(function(L){return L.link.label===k}).style("fill-opacity",function(L){if(!L.link.concentrationscale)return .4}),b&&g(_,f).selectAll("."+n.sankeyNode).filter(l(f)).call(s)}function i(f,_,b,T){var k=T.datum().link.label;T.style("fill-opacity",function(L){return L.tinyColorAlpha}),k&&g(_,f).selectAll("."+n.sankeyLink).filter(function(L){return L.link.label===k}).style("fill-opacity",function(L){return L.tinyColorAlpha}),b&&g(_,f).selectAll(n.sankeyNode).filter(l(f)).call(p)}function x(f,_){var b=f.hoverlabel||{},T=v.nestedProperty(b,_).get();return!Array.isArray(T)&&T}G.exports=function(f,_){for(var b=f._fullLayout,T=b._paper,k=b._size,L=0;L<f._fullData.length;L++)if(f._fullData[L].visible&&f._fullData[L].type===n.sankey&&!f._fullData[L]._viewInitial){var A=f._fullData[L].node;f._fullData[L]._viewInitial={node:{groups:A.groups.slice(),x:A.x.slice(),y:A.y.slice()}}}var I=o(f,"source:")+" ",P=o(f,"target:")+" ",S=o(f,"concentration:")+" ",E=o(f,"incoming flow count:")+" ",z=o(f,"outgoing flow count:")+" ";y(f,T,_,{width:k.w,height:k.h,margin:{t:k.t,r:k.r,b:k.b,l:k.l}},{linkEvents:{hover:function(D,j,V){f._fullLayout.hovermode!==!1&&(d.select(D).call(u.bind(0,j,V,!0)),j.link.trace.link.hoverinfo!=="skip"&&(j.link.fullData=j.link.trace,f.emit("plotly_hover",{event:d.event,points:[j.link]})))},follow:function(D,j){if(f._fullLayout.hovermode!==!1){var V=j.link.trace.link;if(V.hoverinfo!=="none"&&V.hoverinfo!=="skip"){for(var Z=[],Q=0,X=0;X<j.flow.links.length;X++){var $=j.flow.links[X];if(f._fullLayout.hovermode!=="closest"||j.link.pointNumber===$.pointNumber){j.link.pointNumber===$.pointNumber&&(Q=X),$.fullData=$.trace,V=j.link.trace.link;var re=N($),H={valueLabel:w(j.valueFormat)($.value)+j.valueSuffix};Z.push({x:re[0],y:re[1],name:H.valueLabel,text:[$.label||"",I+$.source.label,P+$.target.label,$.concentrationscale?S+w("%0.2f")($.flow.labelConcentration):""].filter(r).join("<br>"),color:x(V,"bgcolor")||t.addOpacity($.color,1),borderColor:x(V,"bordercolor"),fontFamily:x(V,"font.family"),fontSize:x(V,"font.size"),fontColor:x(V,"font.color"),nameLength:x(V,"namelength"),textAlign:x(V,"align"),idealAlign:d.event.x<re[0]?"right":"left",hovertemplate:V.hovertemplate,hovertemplateLabels:H,eventData:[$]})}}e.loneHover(Z,{container:b._hoverlayer.node(),outerContainer:b._paper.node(),gd:f,anchorIndex:Q}).each(function(){j.link.concentrationscale||c(this,.65),a(this)})}}function N(U){var te,B;U.circular?(te=(U.circularPathData.leftInnerExtent+U.circularPathData.rightInnerExtent)/2,B=U.circularPathData.verticalFullExtent):(te=(U.source.x1+U.target.x0)/2,B=(U.y0+U.y1)/2);var K=[te,B];return U.trace.orientation==="v"&&K.reverse(),K[0]+=j.parent.translateX,K[1]+=j.parent.translateY,K}},unhover:function(D,j,V){f._fullLayout.hovermode!==!1&&(d.select(D).call(i.bind(0,j,V,!0)),j.link.trace.link.hoverinfo!=="skip"&&(j.link.fullData=j.link.trace,f.emit("plotly_unhover",{event:d.event,points:[j.link]})),e.loneUnhover(b._hoverlayer.node()))},select:function(D,j){var V=j.link;V.originalEvent=d.event,f._hoverdata=[V],e.click(f,{target:!0})}},nodeEvents:{hover:function(D,j,V){f._fullLayout.hovermode!==!1&&(d.select(D).call(s,j,V),j.node.trace.node.hoverinfo!=="skip"&&(j.node.fullData=j.node.trace,f.emit("plotly_hover",{event:d.event,points:[j.node]})))},follow:function(D,j){if(f._fullLayout.hovermode!==!1){var V=j.node.trace.node;if(V.hoverinfo!=="none"&&V.hoverinfo!=="skip"){var Z=d.select(D).select("."+n.nodeRect),Q=f._fullLayout._paperdiv.node().getBoundingClientRect(),X=Z.node().getBoundingClientRect(),$=X.left-2-Q.left,re=X.right+2-Q.left,H=X.top+X.height/4-Q.top,N={valueLabel:w(j.valueFormat)(j.node.value)+j.valueSuffix};j.node.fullData=j.node.trace,f._fullLayout._calcInverseTransform(f);var U=f._fullLayout._invScaleX,te=f._fullLayout._invScaleY,B=e.loneHover({x0:U*$,x1:U*re,y:te*H,name:w(j.valueFormat)(j.node.value)+j.valueSuffix,text:[j.node.label,E+j.node.targetLinks.length,z+j.node.sourceLinks.length].filter(r).join("<br>"),color:x(V,"bgcolor")||j.tinyColorHue,borderColor:x(V,"bordercolor"),fontFamily:x(V,"font.family"),fontSize:x(V,"font.size"),fontColor:x(V,"font.color"),nameLength:x(V,"namelength"),textAlign:x(V,"align"),idealAlign:"left",hovertemplate:V.hovertemplate,hovertemplateLabels:N,eventData:[j.node]},{container:b._hoverlayer.node(),outerContainer:b._paper.node(),gd:f});c(B,.85),a(B)}}},unhover:function(D,j,V){f._fullLayout.hovermode!==!1&&(d.select(D).call(p,j,V),j.node.trace.node.hoverinfo!=="skip"&&(j.node.fullData=j.node.trace,f.emit("plotly_unhover",{event:d.event,points:[j.node]})),e.loneUnhover(b._hoverlayer.node()))},select:function(D,j,V){var Z=j.node;Z.originalEvent=d.event,f._hoverdata=[Z],d.select(D).call(p,j,V),e.click(f,{target:!0})}}})}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"./constants":929,"./render":933,"@plotly/d3":58}],933:[function(m,G,Y){var d=m("d3-force"),v=m("d3-interpolate").interpolateNumber,w=m("@plotly/d3"),y=m("@plotly/d3-sankey"),e=m("@plotly/d3-sankey-circular"),t=m("./constants"),n=m("tinycolor2"),o=m("../../components/color"),r=m("../../components/drawing"),g=m("../../lib"),c=g.strTranslate,a=g.strRotate,h=m("../../lib/gup"),l=h.keyFun,s=h.repeat,p=h.unwrap,u=m("../../lib/svg_text_utils"),i=m("../../registry"),x=m("../../constants/alignment"),f=x.CAP_SHIFT,_=x.LINE_SPACING;function b(X,$,re){var H,N=p($),U=N.trace,te=U.domain,B=U.orientation==="h",K=U.node.pad,J=U.node.thickness,ee=X.width*(te.x[1]-te.x[0]),ne=X.height*(te.y[1]-te.y[0]),se=N._nodes,oe=N._links,me=N.circular;(H=me?e.sankeyCircular().circularLinkGap(0):y.sankey()).iterations(t.sankeyIterations).size(B?[ee,ne]:[ne,ee]).nodeWidth(J).nodePadding(K).nodeId(function(de){return de.pointNumber}).nodes(se).links(oe);var ce,ye,Se,fe=H();for(var ge in H.nodePadding()<K&&g.warn("node.pad was reduced to ",H.nodePadding()," to fit within the figure."),N._groupLookup){var Te,le=parseInt(N._groupLookup[ge]);for(ce=0;ce<fe.nodes.length;ce++)if(fe.nodes[ce].pointNumber===le){Te=fe.nodes[ce];break}if(Te){var ve={pointNumber:parseInt(ge),x0:Te.x0,x1:Te.x1,y0:Te.y0,y1:Te.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};fe.nodes.unshift(ve),Te.childrenNodes.unshift(ve)}}if(function(){for(ce=0;ce<fe.nodes.length;ce++){var de,Ie,De=fe.nodes[ce],Oe={};for(ye=0;ye<De.targetLinks.length;ye++)de=(Ie=De.targetLinks[ye]).source.pointNumber+":"+Ie.target.pointNumber,Oe.hasOwnProperty(de)||(Oe[de]=[]),Oe[de].push(Ie);var Ve=Object.keys(Oe);for(ye=0;ye<Ve.length;ye++){var Fe=Oe[de=Ve[ye]],ze=0,Re={};for(Se=0;Se<Fe.length;Se++)Re[(Ie=Fe[Se]).label]||(Re[Ie.label]=0),Re[Ie.label]+=Ie.value,ze+=Ie.value;for(Se=0;Se<Fe.length;Se++)(Ie=Fe[Se]).flow={value:ze,labelConcentration:Re[Ie.label]/ze,concentration:Ie.value/ze,links:Fe},Ie.concentrationscale&&(Ie.color=n(Ie.concentrationscale(Ie.flow.labelConcentration)))}var We=0;for(ye=0;ye<De.sourceLinks.length;ye++)We+=De.sourceLinks[ye].value;for(ye=0;ye<De.sourceLinks.length;ye++)(Ie=De.sourceLinks[ye]).concentrationOut=Ie.value/We;var $e=0;for(ye=0;ye<De.targetLinks.length;ye++)$e+=De.targetLinks[ye].value;for(ye=0;ye<De.targetLinks.length;ye++)(Ie=De.targetLinks[ye]).concenrationIn=Ie.value/$e}}(),U.node.x.length&&U.node.y.length){for(ce=0;ce<Math.min(U.node.x.length,U.node.y.length,fe.nodes.length);ce++)if(U.node.x[ce]&&U.node.y[ce]){var Me=[U.node.x[ce]*ee,U.node.y[ce]*ne];fe.nodes[ce].x0=Me[0]-J/2,fe.nodes[ce].x1=Me[0]+J/2;var we=fe.nodes[ce].y1-fe.nodes[ce].y0;fe.nodes[ce].y0=Me[1]-we/2,fe.nodes[ce].y1=Me[1]+we/2}U.arrangement==="snap"&&function(de){de.forEach(function(Ie){var De,Oe,Ve,Fe=0,ze=Ie.length;for(Ie.sort(function(Re,We){return Re.y0-We.y0}),Ve=0;Ve<ze;++Ve)(De=Ie[Ve]).y0>=Fe||(Oe=Fe-De.y0)>1e-6&&(De.y0+=Oe,De.y1+=Oe),Fe=De.y1+K})}(function(de){var Ie,De,Oe=de.map(function(We,$e){return{x0:We.x0,index:$e}}).sort(function(We,$e){return We.x0-$e.x0}),Ve=[],Fe=-1,ze=-1/0;for(ce=0;ce<Oe.length;ce++){var Re=de[Oe[ce].index];Re.x0>ze+J&&(Fe+=1,Ie=Re.x0),ze=Re.x0,Ve[Fe]||(Ve[Fe]=[]),Ve[Fe].push(Re),De=Ie-Re.x0,Re.x0+=De,Re.x1+=De}return Ve}(se=fe.nodes)),H.update(fe)}return{circular:me,key:re,trace:U,guid:g.randstr(),horizontal:B,width:ee,height:ne,nodePad:U.node.pad,nodeLineColor:U.node.line.color,nodeLineWidth:U.node.line.width,linkLineColor:U.link.line.color,linkLineWidth:U.link.line.width,linkArrowLength:U.link.arrowlen,valueFormat:U.valueformat,valueSuffix:U.valuesuffix,textFont:U.textfont,translateX:te.x[0]*X.width+X.margin.l,translateY:X.height-te.y[1]*X.height+X.margin.t,dragParallel:B?ne:ee,dragPerpendicular:B?ee:ne,arrangement:U.arrangement,sankey:H,graph:fe,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function T(X,$,re){var H=n($.color),N=$.source.label+"|"+$.target.label+"__"+re;return $.trace=X.trace,$.curveNumber=X.trace.index,{circular:X.circular,key:N,traceId:X.key,pointNumber:$.pointNumber,link:$,tinyColorHue:o.tinyRGB(H),tinyColorAlpha:H.getAlpha(),linkPath:k,linkLineColor:X.linkLineColor,linkLineWidth:X.linkLineWidth,linkArrowLength:X.linkArrowLength,valueFormat:X.valueFormat,valueSuffix:X.valueSuffix,sankey:X.sankey,parent:X,interactionState:X.interactionState,flow:$.flow}}function k(){return function(X){var $=X.linkArrowLength;if(X.link.circular)return function(ye,Se){var fe=ye.width/2,ge=ye.circularPathData;return ye.circularLinkType==="top"?"M "+(ge.targetX-Se)+" "+(ge.targetY+fe)+" L"+(ge.rightInnerExtent-Se)+" "+(ge.targetY+fe)+"A"+(ge.rightLargeArcRadius+fe)+" "+(ge.rightSmallArcRadius+fe)+" 0 0 1 "+(ge.rightFullExtent-fe-Se)+" "+(ge.targetY-ge.rightSmallArcRadius)+"L"+(ge.rightFullExtent-fe-Se)+" "+ge.verticalRightInnerExtent+"A"+(ge.rightLargeArcRadius+fe)+" "+(ge.rightLargeArcRadius+fe)+" 0 0 1 "+(ge.rightInnerExtent-Se)+" "+(ge.verticalFullExtent-fe)+"L"+ge.leftInnerExtent+" "+(ge.verticalFullExtent-fe)+"A"+(ge.leftLargeArcRadius+fe)+" "+(ge.leftLargeArcRadius+fe)+" 0 0 1 "+(ge.leftFullExtent+fe)+" "+ge.verticalLeftInnerExtent+"L"+(ge.leftFullExtent+fe)+" "+(ge.sourceY-ge.leftSmallArcRadius)+"A"+(ge.leftLargeArcRadius+fe)+" "+(ge.leftSmallArcRadius+fe)+" 0 0 1 "+ge.leftInnerExtent+" "+(ge.sourceY+fe)+"L"+ge.sourceX+" "+(ge.sourceY+fe)+"L"+ge.sourceX+" "+(ge.sourceY-fe)+"L"+ge.leftInnerExtent+" "+(ge.sourceY-fe)+"A"+(ge.leftLargeArcRadius-fe)+" "+(ge.leftSmallArcRadius-fe)+" 0 0 0 "+(ge.leftFullExtent-fe)+" "+(ge.sourceY-ge.leftSmallArcRadius)+"L"+(ge.leftFullExtent-fe)+" "+ge.verticalLeftInnerExtent+"A"+(ge.leftLargeArcRadius-fe)+" "+(ge.leftLargeArcRadius-fe)+" 0 0 0 "+ge.leftInnerExtent+" "+(ge.verticalFullExtent+fe)+"L"+(ge.rightInnerExtent-Se)+" "+(ge.verticalFullExtent+fe)+"A"+(ge.rightLargeArcRadius-fe)+" "+(ge.rightLargeArcRadius-fe)+" 0 0 0 "+(ge.rightFullExtent+fe-Se)+" "+ge.verticalRightInnerExtent+"L"+(ge.rightFullExtent+fe-Se)+" "+(ge.targetY-ge.rightSmallArcRadius)+"A"+(ge.rightLargeArcRadius-fe)+" "+(ge.rightSmallArcRadius-fe)+" 0 0 0 "+(ge.rightInnerExtent-Se)+" "+(ge.targetY-fe)+"L"+(ge.targetX-Se)+" "+(ge.targetY-fe)+(Se>0?"L"+ge.targetX+" "+ge.targetY:"")+"Z":"M "+(ge.targetX-Se)+" "+(ge.targetY-fe)+" L"+(ge.rightInnerExtent-Se)+" "+(ge.targetY-fe)+"A"+(ge.rightLargeArcRadius+fe)+" "+(ge.rightSmallArcRadius+fe)+" 0 0 0 "+(ge.rightFullExtent-fe-Se)+" "+(ge.targetY+ge.rightSmallArcRadius)+"L"+(ge.rightFullExtent-fe-Se)+" "+ge.verticalRightInnerExtent+"A"+(ge.rightLargeArcRadius+fe)+" "+(ge.rightLargeArcRadius+fe)+" 0 0 0 "+(ge.rightInnerExtent-Se)+" "+(ge.verticalFullExtent+fe)+"L"+ge.leftInnerExtent+" "+(ge.verticalFullExtent+fe)+"A"+(ge.leftLargeArcRadius+fe)+" "+(ge.leftLargeArcRadius+fe)+" 0 0 0 "+(ge.leftFullExtent+fe)+" "+ge.verticalLeftInnerExtent+"L"+(ge.leftFullExtent+fe)+" "+(ge.sourceY+ge.leftSmallArcRadius)+"A"+(ge.leftLargeArcRadius+fe)+" "+(ge.leftSmallArcRadius+fe)+" 0 0 0 "+ge.leftInnerExtent+" "+(ge.sourceY-fe)+"L"+ge.sourceX+" "+(ge.sourceY-fe)+"L"+ge.sourceX+" "+(ge.sourceY+fe)+"L"+ge.leftInnerExtent+" "+(ge.sourceY+fe)+"A"+(ge.leftLargeArcRadius-fe)+" "+(ge.leftSmallArcRadius-fe)+" 0 0 1 "+(ge.leftFullExtent-fe)+" "+(ge.sourceY+ge.leftSmallArcRadius)+"L"+(ge.leftFullExtent-fe)+" "+ge.verticalLeftInnerExtent+"A"+(ge.leftLargeArcRadius-fe)+" "+(ge.leftLargeArcRadius-fe)+" 0 0 1 "+ge.leftInnerExtent+" "+(ge.verticalFullExtent-fe)+"L"+(ge.rightInnerExtent-Se)+" "+(ge.verticalFullExtent-fe)+"A"+(ge.rightLargeArcRadius-fe)+" "+(ge.rightLargeArcRadius-fe)+" 0 0 1 "+(ge.rightFullExtent+fe-Se)+" "+ge.verticalRightInnerExtent+"L"+(ge.rightFullExtent+fe-Se)+" "+(ge.targetY+ge.rightSmallArcRadius)+"A"+(ge.rightLargeArcRadius-fe)+" "+(ge.rightSmallArcRadius-fe)+" 0 0 1 "+(ge.rightInnerExtent-Se)+" "+(ge.targetY+fe)+"L"+(ge.targetX-Se)+" "+(ge.targetY+fe)+(Se>0?"L"+ge.targetX+" "+ge.targetY:"")+"Z"}(X.link,$);var re=Math.abs((X.link.target.x0-X.link.source.x1)/2);$>re&&($=re);var H=X.link.source.x1,N=X.link.target.x0-$,U=v(H,N),te=U(.5),B=U(.5),K=X.link.y0-X.link.width/2,J=X.link.y0+X.link.width/2,ee=X.link.y1-X.link.width/2,ne=X.link.y1+X.link.width/2,se="M"+H+","+K,oe="C"+te+","+K+" "+B+","+ee+" "+N+","+ee,me="C"+B+","+ne+" "+te+","+J+" "+H+","+J,ce=$>0?"L"+(N+$)+","+(ee+X.link.width/2):"";return se+oe+(ce+="L"+N+","+ne)+me+"Z"}}function L(X,$){var re=n($.color),H=t.nodePadAcross,N=X.nodePad/2;$.dx=$.x1-$.x0,$.dy=$.y1-$.y0;var U=$.dx,te=Math.max(.5,$.dy),B="node_"+$.pointNumber;return $.group&&(B=g.randstr()),$.trace=X.trace,$.curveNumber=X.trace.index,{index:$.pointNumber,key:B,partOfGroup:$.partOfGroup||!1,group:$.group,traceId:X.key,trace:X.trace,node:$,nodePad:X.nodePad,nodeLineColor:X.nodeLineColor,nodeLineWidth:X.nodeLineWidth,textFont:X.textFont,size:X.horizontal?X.height:X.width,visibleWidth:Math.ceil(U),visibleHeight:te,zoneX:-H,zoneY:-N,zoneWidth:U+2*H,zoneHeight:te+2*N,labelY:X.horizontal?$.dy/2+1:$.dx/2+1,left:$.originalLayer===1,sizeAcross:X.width,forceLayouts:X.forceLayouts,horizontal:X.horizontal,darkBackground:re.getBrightness()<=128,tinyColorHue:o.tinyRGB(re),tinyColorAlpha:re.getAlpha(),valueFormat:X.valueFormat,valueSuffix:X.valueSuffix,sankey:X.sankey,graph:X.graph,arrangement:X.arrangement,uniqueNodeLabelPathId:[X.guid,X.key,B].join("_"),interactionState:X.interactionState,figure:X}}function A(X){X.attr("transform",function($){return c($.node.x0.toFixed(3),$.node.y0.toFixed(3))})}function I(X){X.call(A)}function P(X,$){X.call(I),$.attr("d",k())}function S(X){X.attr("width",function($){return $.node.x1-$.node.x0}).attr("height",function($){return $.visibleHeight})}function E(X){return X.link.width>1||X.linkLineWidth>0}function z(X){return c(X.translateX,X.translateY)+(X.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function D(X,$,re){X.on(".basic",null).on("mouseover.basic",function(H){H.interactionState.dragInProgress||H.partOfGroup||(re.hover(this,H,$),H.interactionState.hovered=[this,H])}).on("mousemove.basic",function(H){H.interactionState.dragInProgress||H.partOfGroup||(re.follow(this,H),H.interactionState.hovered=[this,H])}).on("mouseout.basic",function(H){H.interactionState.dragInProgress||H.partOfGroup||(re.unhover(this,H,$),H.interactionState.hovered=!1)}).on("click.basic",function(H){H.interactionState.hovered&&(re.unhover(this,H,$),H.interactionState.hovered=!1),H.interactionState.dragInProgress||H.partOfGroup||re.select(this,H,$)})}function j(X,$,re,H){var N=w.behavior.drag().origin(function(U){return{x:U.node.x0+U.visibleWidth/2,y:U.node.y0+U.visibleHeight/2}}).on("dragstart",function(U){if(U.arrangement!=="fixed"&&(g.ensureSingle(H._fullLayout._infolayer,"g","dragcover",function(B){H._fullLayout._dragCover=B}),g.raiseToTop(this),U.interactionState.dragInProgress=U.node,Z(U.node),U.interactionState.hovered&&(re.nodeEvents.unhover.apply(0,U.interactionState.hovered),U.interactionState.hovered=!1),U.arrangement==="snap")){var te=U.traceId+"|"+U.key;U.forceLayouts[te]?U.forceLayouts[te].alpha(1):function(B,K,J,ee){(function(se){for(var oe=0;oe<se.length;oe++)se[oe].y=(se[oe].y0+se[oe].y1)/2,se[oe].x=(se[oe].x0+se[oe].x1)/2})(J.graph.nodes);var ne=J.graph.nodes.filter(function(se){return se.originalX===J.node.originalX}).filter(function(se){return!se.partOfGroup});J.forceLayouts[K]=d.forceSimulation(ne).alphaDecay(0).force("collide",d.forceCollide().radius(function(se){return se.dy/2+J.nodePad/2}).strength(1).iterations(t.forceIterations)).force("constrain",function(se,oe,me,ce){return function(){for(var ye=0,Se=0;Se<me.length;Se++){var fe=me[Se];fe===ce.interactionState.dragInProgress?(fe.x=fe.lastDraggedX,fe.y=fe.lastDraggedY):(fe.vx=(fe.originalX-fe.x)/t.forceTicksPerFrame,fe.y=Math.min(ce.size-fe.dy/2,Math.max(fe.dy/2,fe.y))),ye=Math.max(ye,Math.abs(fe.vx),Math.abs(fe.vy))}!ce.interactionState.dragInProgress&&ye<.1&&ce.forceLayouts[oe].alpha()>0&&ce.forceLayouts[oe].alpha(0)}}(0,K,ne,J)).stop()}(0,te,U),function(B,K,J,ee,ne){window.requestAnimationFrame(function se(){var oe;for(oe=0;oe<t.forceTicksPerFrame;oe++)J.forceLayouts[ee].tick();if(function(ce){for(var ye=0;ye<ce.length;ye++)ce[ye].y0=ce[ye].y-ce[ye].dy/2,ce[ye].y1=ce[ye].y0+ce[ye].dy,ce[ye].x0=ce[ye].x-ce[ye].dx/2,ce[ye].x1=ce[ye].x0+ce[ye].dx}(J.graph.nodes),J.sankey.update(J.graph),P(B.filter(Q(J)),K),J.forceLayouts[ee].alpha()>0)window.requestAnimationFrame(se);else{var me=J.node.originalX;J.node.x0=me-J.visibleWidth/2,J.node.x1=me+J.visibleWidth/2,V(J,ne)}})}(X,$,U,te,H)}}).on("drag",function(U){if(U.arrangement!=="fixed"){var te=w.event.x,B=w.event.y;U.arrangement==="snap"?(U.node.x0=te-U.visibleWidth/2,U.node.x1=te+U.visibleWidth/2,U.node.y0=B-U.visibleHeight/2,U.node.y1=B+U.visibleHeight/2):(U.arrangement==="freeform"&&(U.node.x0=te-U.visibleWidth/2,U.node.x1=te+U.visibleWidth/2),B=Math.max(0,Math.min(U.size-U.visibleHeight/2,B)),U.node.y0=B-U.visibleHeight/2,U.node.y1=B+U.visibleHeight/2),Z(U.node),U.arrangement!=="snap"&&(U.sankey.update(U.graph),P(X.filter(Q(U)),$))}}).on("dragend",function(U){if(U.arrangement!=="fixed"){U.interactionState.dragInProgress=!1;for(var te=0;te<U.node.childrenNodes.length;te++)U.node.childrenNodes[te].x=U.node.x,U.node.childrenNodes[te].y=U.node.y;U.arrangement!=="snap"&&V(U,H)}});X.on(".drag",null).call(N)}function V(X,$){for(var re=[],H=[],N=0;N<X.graph.nodes.length;N++){var U=(X.graph.nodes[N].x0+X.graph.nodes[N].x1)/2,te=(X.graph.nodes[N].y0+X.graph.nodes[N].y1)/2;re.push(U/X.figure.width),H.push(te/X.figure.height)}i.call("_guiRestyle",$,{"node.x":[re],"node.y":[H]},X.trace.index).then(function(){$._fullLayout._dragCover&&$._fullLayout._dragCover.remove()})}function Z(X){X.lastDraggedX=X.x0+X.dx/2,X.lastDraggedY=X.y0+X.dy/2}function Q(X){return function($){return $.node.originalX===X.node.originalX}}G.exports=function(X,$,re,H,N){var U=X._context.staticPlot,te=!1;g.ensureSingle(X._fullLayout._infolayer,"g","first-render",function(){te=!0});var B=X._fullLayout._dragCover,K=re.filter(function(ye){return p(ye).trace.visible}).map(b.bind(null,H)),J=$.selectAll("."+t.cn.sankey).data(K,l);J.exit().remove(),J.enter().append("g").classed(t.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events",U?"none":"auto").attr("transform",z),J.each(function(ye,Se){X._fullData[Se]._sankey=ye;var fe="bgsankey-"+ye.trace.uid+"-"+Se;g.ensureSingle(X._fullLayout._draggers,"rect",fe),X._fullData[Se]._bgRect=w.select("."+fe),X._fullData[Se]._bgRect.style("pointer-events",U?"none":"all").attr("width",ye.width).attr("height",ye.height).attr("x",ye.translateX).attr("y",ye.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})}),J.transition().ease(t.ease).duration(t.duration).attr("transform",z);var ee=J.selectAll("."+t.cn.sankeyLinks).data(s,l);ee.enter().append("g").classed(t.cn.sankeyLinks,!0).style("fill","none");var ne=ee.selectAll("."+t.cn.sankeyLink).data(function(ye){return ye.graph.links.filter(function(Se){return Se.value}).map(T.bind(null,ye))},l);ne.enter().append("path").classed(t.cn.sankeyLink,!0).call(D,J,N.linkEvents),ne.style("stroke",function(ye){return E(ye)?o.tinyRGB(n(ye.linkLineColor)):ye.tinyColorHue}).style("stroke-opacity",function(ye){return E(ye)?o.opacity(ye.linkLineColor):ye.tinyColorAlpha}).style("fill",function(ye){return ye.tinyColorHue}).style("fill-opacity",function(ye){return ye.tinyColorAlpha}).style("stroke-width",function(ye){return E(ye)?ye.linkLineWidth:1}).attr("d",k()),ne.style("opacity",function(){return X._context.staticPlot||te||B?1:0}).transition().ease(t.ease).duration(t.duration).style("opacity",1),ne.exit().transition().ease(t.ease).duration(t.duration).style("opacity",0).remove();var se=J.selectAll("."+t.cn.sankeyNodeSet).data(s,l);se.enter().append("g").classed(t.cn.sankeyNodeSet,!0),se.style("cursor",function(ye){switch(ye.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}});var oe=se.selectAll("."+t.cn.sankeyNode).data(function(ye){var Se=ye.graph.nodes;return function(fe){var ge,Te=[];for(ge=0;ge<fe.length;ge++)fe[ge].originalX=(fe[ge].x0+fe[ge].x1)/2,fe[ge].originalY=(fe[ge].y0+fe[ge].y1)/2,Te.indexOf(fe[ge].originalX)===-1&&Te.push(fe[ge].originalX);for(Te.sort(function(le,ve){return le-ve}),ge=0;ge<fe.length;ge++)fe[ge].originalLayerIndex=Te.indexOf(fe[ge].originalX),fe[ge].originalLayer=fe[ge].originalLayerIndex/(Te.length-1)}(Se),Se.map(L.bind(null,ye))},l);oe.enter().append("g").classed(t.cn.sankeyNode,!0).call(A).style("opacity",function(ye){return!X._context.staticPlot&&!te||ye.partOfGroup?0:1}),oe.call(D,J,N.nodeEvents).call(j,ne,N,X),oe.transition().ease(t.ease).duration(t.duration).call(A).style("opacity",function(ye){return ye.partOfGroup?0:1}),oe.exit().transition().ease(t.ease).duration(t.duration).style("opacity",0).remove();var me=oe.selectAll("."+t.cn.nodeRect).data(s);me.enter().append("rect").classed(t.cn.nodeRect,!0).call(S),me.style("stroke-width",function(ye){return ye.nodeLineWidth}).style("stroke",function(ye){return o.tinyRGB(n(ye.nodeLineColor))}).style("stroke-opacity",function(ye){return o.opacity(ye.nodeLineColor)}).style("fill",function(ye){return ye.tinyColorHue}).style("fill-opacity",function(ye){return ye.tinyColorAlpha}),me.transition().ease(t.ease).duration(t.duration).call(S);var ce=oe.selectAll("."+t.cn.nodeLabel).data(s);ce.enter().append("text").classed(t.cn.nodeLabel,!0).style("cursor","default"),ce.attr("data-notex",1).text(function(ye){return ye.node.label}).each(function(ye){var Se=w.select(this);r.font(Se,ye.textFont),u.convertToTspans(Se,X)}).style("text-shadow",u.makeTextShadow(X._fullLayout.paper_bgcolor)).attr("text-anchor",function(ye){return ye.horizontal&&ye.left?"end":"start"}).attr("transform",function(ye){var Se=w.select(this),fe=u.lineCount(Se),ge=ye.textFont.size*((fe-1)*_-f),Te=ye.nodeLineWidth/2+3,le=((ye.horizontal?ye.visibleHeight:ye.visibleWidth)-ge)/2;ye.horizontal&&(ye.left?Te=-Te:Te+=ye.visibleWidth);var ve=ye.horizontal?"":"scale(-1,1)"+a(90);return c(ye.horizontal?Te:le,ye.horizontal?le:Te)+ve}),ce.transition().ease(t.ease).duration(t.duration)}},{"../../components/color":367,"../../components/drawing":389,"../../constants/alignment":483,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"../../registry":647,"./constants":929,"@plotly/d3":58,"@plotly/d3-sankey":57,"@plotly/d3-sankey-circular":56,"d3-force":111,"d3-interpolate":116,tinycolor2:313}],934:[function(m,G,Y){G.exports=function(d,v){for(var w=[],y=d.cd[0].trace,e=y._sankey.graph.nodes,t=0;t<e.length;t++){var n=e[t];if(!n.partOfGroup){var o=[(n.x0+n.x1)/2,(n.y0+n.y1)/2];y.orientation==="v"&&o.reverse(),v&&v.contains(o,!1,t,d)&&w.push({pointNumber:n.pointNumber})}}return w}},{}],935:[function(m,G,Y){var d=m("../../lib");G.exports=function(v,w){for(var y=0;y<v.length;y++)v[y].i=y;d.mergeArray(w.text,v,"tx"),d.mergeArray(w.texttemplate,v,"txt"),d.mergeArray(w.hovertext,v,"htx"),d.mergeArray(w.customdata,v,"data"),d.mergeArray(w.textposition,v,"tp"),w.textfont&&(d.mergeArrayCastPositive(w.textfont.size,v,"ts"),d.mergeArray(w.textfont.color,v,"tc"),d.mergeArray(w.textfont.family,v,"tf"));var e=w.marker;if(e){d.mergeArrayCastPositive(e.size,v,"ms"),d.mergeArrayCastPositive(e.opacity,v,"mo"),d.mergeArray(e.symbol,v,"mx"),d.mergeArray(e.angle,v,"ma"),d.mergeArray(e.standoff,v,"mf"),d.mergeArray(e.color,v,"mc");var t=e.line;e.line&&(d.mergeArray(t.color,v,"mlc"),d.mergeArrayCastPositive(t.width,v,"mlw"));var n=e.gradient;n&&n.type!=="none"&&(d.mergeArray(n.type,v,"mgt"),d.mergeArray(n.color,v,"mgc"))}}},{"../../lib":515}],936:[function(m,G,Y){var d=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,v=m("../../plots/template_attributes").texttemplateAttrs,w=m("../../plots/template_attributes").hovertemplateAttrs,y=m("../../components/colorscale/attributes"),e=m("../../plots/font_attributes"),t=m("../../components/drawing/attributes").dash,n=m("../../components/drawing/attributes").pattern,o=m("../../components/drawing"),r=m("./constants"),g=m("../../lib/extend").extendFlat;G.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},xperiod:{valType:"any",dflt:0,editType:"calc"},yperiod:{valType:"any",dflt:0,editType:"calc"},xperiod0:{valType:"any",editType:"calc"},yperiod0:{valType:"any",editType:"calc"},xperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},yperiodalignment:{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"},xhoverformat:d("x"),yhoverformat:d("y"),stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:v({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:w({},{keys:r.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:g({},t,{editType:"style"}),backoff:{valType:"number",min:0,dflt:"auto",arrayOk:!0,editType:"plot"},simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},fillpattern:n,marker:g({symbol:{valType:"enumerated",values:o.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},angle:{valType:"angle",dflt:0,arrayOk:!0,editType:"plot",anim:!1},angleref:{valType:"enumerated",values:["previous","up"],dflt:"up",editType:"plot",anim:!1},standoff:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"plot",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:g({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},y("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},y("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:e({editType:"calc",colorEditType:"style",arrayOk:!0})}},{"../../components/colorscale/attributes":374,"../../components/drawing":389,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../../plots/font_attributes":594,"../../plots/template_attributes":642,"./constants":940}],937:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("../../plots/cartesian/axes"),y=m("../../plots/cartesian/align_period"),e=m("../../constants/numerical").BADNUM,t=m("./subtypes"),n=m("./colorscale_calc"),o=m("./arrays_to_calcdata"),r=m("./calc_selection");function g(s,p,u,i,x,f,_){var b=p._length,T=s._fullLayout,k=u._id,L=i._id,A=T._firstScatter[h(p)]===p.uid,I=(l(p,T,u,i)||{}).orientation,P=p.fill;u._minDtick=0,i._minDtick=0;var S={padded:!0},E={padded:!0};_&&(S.ppad=E.ppad=_);var z=b<2||x[0]!==x[b-1]||f[0]!==f[b-1];z&&(P==="tozerox"||P==="tonextx"&&(A||I==="h"))?S.tozero=!0:(p.error_y||{}).visible||P!=="tonexty"&&P!=="tozeroy"&&(t.hasMarkers(p)||t.hasText(p))||(S.padded=!1,S.ppad=0),z&&(P==="tozeroy"||P==="tonexty"&&(A||I==="v"))?E.tozero=!0:P!=="tonextx"&&P!=="tozerox"||(E.padded=!1),k&&(p._extremes[k]=w.findExtremes(u,x,S)),L&&(p._extremes[L]=w.findExtremes(i,f,E))}function c(s,p){if(t.hasMarkers(s)){var u,i=s.marker,x=1.6*(s.marker.sizeref||1);if(u=s.marker.sizemode==="area"?function(k){return Math.max(Math.sqrt((k||0)/x),3)}:function(k){return Math.max((k||0)/x,3)},v.isArrayOrTypedArray(i.size)){var f={type:"linear"};w.setConvert(f);for(var _=f.makeCalcdata(s.marker,"size"),b=new Array(p),T=0;T<p;T++)b[T]=u(_[T]);return b}return u(i.size)}}function a(s,p){var u=h(p),i=s._firstScatter;i[u]||(i[u]=p.uid)}function h(s){var p=s.stackgroup;return s.xaxis+s.yaxis+s.type+(p?"-"+p:"")}function l(s,p,u,i){var x=s.stackgroup;if(x){var f=p._scatterStackOpts[u._id+i._id][x],_=f.orientation==="v"?i:u;return _.type==="linear"||_.type==="log"?f:void 0}}G.exports={calc:function(s,p){var u,i,x,f,_,b,T=s._fullLayout,k=p._xA=w.getFromId(s,p.xaxis||"x","x"),L=p._yA=w.getFromId(s,p.yaxis||"y","y"),A=k.makeCalcdata(p,"x"),I=L.makeCalcdata(p,"y"),P=y(p,k,"x",A),S=y(p,L,"y",I),E=P.vals,z=S.vals,D=p._length,j=new Array(D),V=p.ids,Z=l(p,T,k,L),Q=!1;a(T,p);var X,$="x",re="y";Z?(v.pushUnique(Z.traceIndices,p._expandedIndex),(u=Z.orientation==="v")?(re="s",X="x"):($="s",X="y"),_=Z.stackgaps==="interpolate"):g(s,p,k,L,E,z,c(p,D));var H=!!p.xperiodalignment,N=!!p.yperiodalignment;for(i=0;i<D;i++){var U=j[i]={},te=d(E[i]),B=d(z[i]);te&&B?(U[$]=E[i],U[re]=z[i],H&&(U.orig_x=A[i],U.xEnd=P.ends[i],U.xStart=P.starts[i]),N&&(U.orig_y=I[i],U.yEnd=S.ends[i],U.yStart=S.starts[i])):Z&&(u?te:B)?(U[X]=u?E[i]:z[i],U.gap=!0,_?(U.s=e,Q=!0):U.s=0):U[$]=U[re]=e,V&&(U.id=String(V[i]))}if(o(j,p),n(s,p),r(j,p),Z){for(i=0;i<j.length;)j[i][X]===e?j.splice(i,1):i++;if(v.sort(j,function(ne,se){return ne[X]-se[X]||ne.i-se.i}),Q){for(i=0;i<j.length-1&&j[i].gap;)i++;for((b=j[i].s)||(b=j[i].s=0),x=0;x<i;x++)j[x].s=b;for(f=j.length-1;f>i&&j[f].gap;)f--;for(b=j[f].s,x=j.length-1;x>f;x--)j[x].s=b;for(;i<f;)if(j[++i].gap){for(x=i+1;j[x].gap;)x++;for(var K=j[i-1][X],J=j[i-1].s,ee=(j[x].s-J)/(j[x][X]-K);i<x;)j[i].s=J+(j[i][X]-K)*ee,i++}}}return j},calcMarkerSize:c,calcAxisExpansion:g,setFirstScatter:a,getStackOpts:l}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"./arrays_to_calcdata":935,"./calc_selection":938,"./colorscale_calc":939,"./subtypes":961,"fast-isnumeric":190}],938:[function(m,G,Y){var d=m("../../lib");G.exports=function(v,w){d.isArrayOrTypedArray(w.selectedpoints)&&d.tagSelected(v,w)}},{"../../lib":515}],939:[function(m,G,Y){var d=m("../../components/colorscale/helpers").hasColorscale,v=m("../../components/colorscale/calc"),w=m("./subtypes");G.exports=function(y,e){w.hasLines(e)&&d(e,"line")&&v(y,e,{vals:e.line.color,containerStr:"line",cLetter:"c"}),w.hasMarkers(e)&&(d(e,"marker")&&v(y,e,{vals:e.marker.color,containerStr:"marker",cLetter:"c"}),d(e,"marker.line")&&v(y,e,{vals:e.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":375,"../../components/colorscale/helpers":378,"./subtypes":961}],940:[function(m,G,Y){G.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],941:[function(m,G,Y){var d=m("./calc");function v(w,y,e,t,n,o,r){n[t]=!0;var g={i:null,gap:!0,s:0};if(g[r]=e,w.splice(y,0,g),y&&e===w[y-1][r]){var c=w[y-1];g.s=c.s,g.i=c.i,g.gap=c.gap}else o&&(g.s=function(a,h,l,s){var p=a[h-1],u=a[h+1];return u?p?p.s+(u.s-p.s)*(l-p[s])/(u[s]-p[s]):u.s:p.s}(w,y,e,r));y||(w[0].t=w[1].t,w[0].trace=w[1].trace,delete w[1].t,delete w[1].trace)}G.exports=function(w,y){var e=y.xaxis,t=y.yaxis,n=e._id+t._id,o=w._fullLayout._scatterStackOpts[n];if(o){var r,g,c,a,h,l,s,p,u,i,x,f,_,b,T,k=w.calcdata;for(var L in o){var A=(i=o[L]).traceIndices;if(A.length){for(x=i.stackgaps==="interpolate",f=i.groupnorm,i.orientation==="v"?(_="x",b="y"):(_="y",b="x"),T=new Array(A.length),r=0;r<T.length;r++)T[r]=!1;l=k[A[0]];var I=new Array(l.length);for(r=0;r<l.length;r++)I[r]=l[r][_];for(r=1;r<A.length;r++){for(h=k[A[r]],g=c=0;g<h.length;g++){for(s=h[g][_];s>I[c]&&c<I.length;c++)v(h,g,I[c],r,T,x,_),g++;if(s!==I[c]){for(a=0;a<r;a++)v(k[A[a]],c,s,a,T,x,_);I.splice(c,0,s)}c++}for(;c<I.length;c++)v(h,g,I[c],r,T,x,_),g++}var P=I.length;for(g=0;g<l.length;g++){for(p=l[g][b]=l[g].s,r=1;r<A.length;r++)(h=k[A[r]])[0].trace._rawLength=h[0].trace._length,h[0].trace._length=P,p+=h[g].s,h[g][b]=p;if(f)for(u=(f==="fraction"?p:p/100)||1,r=0;r<A.length;r++){var S=k[A[r]][g];S[b]/=u,S.sNorm=S.s/u}}for(r=0;r<A.length;r++){var E=(h=k[A[r]])[0].trace,z=d.calcMarkerSize(E,E._rawLength),D=Array.isArray(z);if(z&&T[r]||D){var j=z;for(z=new Array(P),g=0;g<P;g++)z[g]=h[g].gap?0:D?j[h[g].i]:j}var V=new Array(P),Z=new Array(P);for(g=0;g<P;g++)V[g]=h[g].x,Z[g]=h[g].y;d.calcAxisExpansion(w,E,e,t,V,Z,z),h[0].t.orientation=i.orientation}}}}}},{"./calc":937}],942:[function(m,G,Y){G.exports=function(d){for(var v=0;v<d.length;v++){var w=d[v];if(w.type==="scatter"){var y=w.fill;if(y!=="none"&&y!=="toself"&&(w.opacity=void 0,y==="tonexty"||y==="tonextx"))for(var e=v-1;e>=0;e--){var t=d[e];if(t.type==="scatter"&&t.xaxis===w.xaxis&&t.yaxis===w.yaxis){t.opacity=void 0;break}}}}}},{}],943:[function(m,G,Y){var d=m("../../lib"),v=m("../../registry"),w=m("./attributes"),y=m("./constants"),e=m("./subtypes"),t=m("./xy_defaults"),n=m("./period_defaults"),o=m("./stack_defaults"),r=m("./marker_defaults"),g=m("./line_defaults"),c=m("./line_shape_defaults"),a=m("./text_defaults"),h=m("./fillcolor_defaults"),l=m("../../lib").coercePattern;G.exports=function(s,p,u,i){function x(I,P){return d.coerce(s,p,w,I,P)}var f=t(s,p,i,x);if(f||(p.visible=!1),p.visible){n(s,p,i,x),x("xhoverformat"),x("yhoverformat");var _=o(s,p,i,x),b=!_&&f<y.PTS_LINESONLY?"lines+markers":"lines";x("text"),x("hovertext"),x("mode",b),e.hasLines(p)&&(g(s,p,u,i,x,{backoff:!0}),c(s,p,x),x("connectgaps"),x("line.simplify")),e.hasMarkers(p)&&r(s,p,u,i,x,{gradient:!0}),e.hasText(p)&&(x("texttemplate"),a(s,p,i,x));var T=[];(e.hasMarkers(p)||e.hasText(p))&&(x("cliponaxis"),x("marker.maxdisplayed"),T.push("points")),x("fill",_?_.fillDflt:"none"),p.fill!=="none"&&(h(s,p,u,x),e.hasLines(p)||c(s,p,x),l(x,"fillpattern",p.fillcolor,!1));var k=(p.line||{}).color,L=(p.marker||{}).color;p.fill!=="tonext"&&p.fill!=="toself"||T.push("fills"),x("hoveron",T.join("+")||"points"),p.hoveron!=="fills"&&x("hovertemplate");var A=v.getComponentMethod("errorbars","supplyDefaults");A(s,p,k||L||u,{axis:"y"}),A(s,p,k||L||u,{axis:"x",inherit:"y"}),d.coerceSelectionMarkerOpacity(p,x)}}},{"../../lib":515,"../../registry":647,"./attributes":936,"./constants":940,"./fillcolor_defaults":944,"./line_defaults":949,"./line_shape_defaults":951,"./marker_defaults":955,"./period_defaults":956,"./stack_defaults":959,"./subtypes":961,"./text_defaults":962,"./xy_defaults":963}],944:[function(m,G,Y){var d=m("../../components/color"),v=m("../../lib").isArrayOrTypedArray;G.exports=function(w,y,e,t){var n=!1;if(y.marker){var o=y.marker.color,r=(y.marker.line||{}).color;o&&!v(o)?n=o:r&&!v(r)&&(n=r)}t("fillcolor",d.addOpacity((y.line||{}).color||n||e,.5))}},{"../../components/color":367,"../../lib":515}],945:[function(m,G,Y){var d=m("../../plots/cartesian/axes");G.exports=function(v,w,y){var e={},t={_fullLayout:y},n=d.getFromTrace(t,w,"x"),o=d.getFromTrace(t,w,"y");return e.xLabel=d.tickText(n,n.c2l(v.x),!0).text,e.yLabel=d.tickText(o,o.c2l(v.y),!0).text,e}},{"../../plots/cartesian/axes":566}],946:[function(m,G,Y){var d=m("../../components/color"),v=m("./subtypes");G.exports=function(w,y){var e,t;if(w.mode==="lines")return(e=w.line.color)&&d.opacity(e)?e:w.fillcolor;if(w.mode==="none")return w.fill?w.fillcolor:"";var n=y.mcc||(w.marker||{}).color,o=y.mlcc||((w.marker||{}).line||{}).color;return(t=n&&d.opacity(n)?n:o&&d.opacity(o)&&(y.mlw||((w.marker||{}).line||{}).width)?o:"")?d.opacity(t)<.3?d.addOpacity(t,.3):t:(e=(w.line||{}).color)&&d.opacity(e)&&v.hasLines(w)&&w.line.width?e:w.fillcolor}},{"../../components/color":367,"./subtypes":961}],947:[function(m,G,Y){var d=m("../../lib"),v=m("../../components/fx"),w=m("../../registry"),y=m("./get_trace_color"),e=m("../../components/color"),t=d.fillText;G.exports=function(n,o,r,g){var c=n.cd,a=c[0].trace,h=n.xa,l=n.ya,s=h.c2p(o),p=l.c2p(r),u=[s,p],i=a.hoveron||"",x=a.mode.indexOf("markers")!==-1?3:.5,f=!!a.xperiodalignment,_=!!a.yperiodalignment;if(i.indexOf("points")!==-1){var b=function(oe){var me=Math.max(x,oe.mrc||0),ce=h.c2p(oe.x)-s,ye=l.c2p(oe.y)-p;return Math.max(Math.sqrt(ce*ce+ye*ye)-me,1-x/me)},T=v.getDistanceFunction(g,function(oe){if(f){var me=h.c2p(oe.xStart),ce=h.c2p(oe.xEnd);return s>=Math.min(me,ce)&&s<=Math.max(me,ce)?0:1/0}var ye=Math.max(3,oe.mrc||0),Se=1-1/ye,fe=Math.abs(h.c2p(oe.x)-s);return fe<ye?Se*fe/ye:fe-ye+Se},function(oe){if(_){var me=l.c2p(oe.yStart),ce=l.c2p(oe.yEnd);return p>=Math.min(me,ce)&&p<=Math.max(me,ce)?0:1/0}var ye=Math.max(3,oe.mrc||0),Se=1-1/ye,fe=Math.abs(l.c2p(oe.y)-p);return fe<ye?Se*fe/ye:fe-ye+Se},b);if(v.getClosest(c,T,n),n.index!==!1){var k=c[n.index],L=h.c2p(k.x,!0),A=l.c2p(k.y,!0),I=k.mrc||1;n.index=k.i;var P=c[0].t.orientation,S=P&&(k.sNorm||k.s),E=P==="h"?S:k.orig_x!==void 0?k.orig_x:k.x,z=P==="v"?S:k.orig_y!==void 0?k.orig_y:k.y;return d.extendFlat(n,{color:y(a,k),x0:L-I,x1:L+I,xLabelVal:E,y0:A-I,y1:A+I,yLabelVal:z,spikeDistance:b(k),hovertemplate:a.hovertemplate}),t(k,a,n),w.getComponentMethod("errorbars","hoverInfo")(k,a,n),[n]}}if(i.indexOf("fills")!==-1&&a._polygons){var D,j,V,Z,Q,X,$,re,H,N=a._polygons,U=[],te=!1,B=1/0,K=-1/0,J=1/0,ee=-1/0;for(D=0;D<N.length;D++)(V=N[D]).contains(u)&&(te=!te,U.push(V),J=Math.min(J,V.ymin),ee=Math.max(ee,V.ymax));if(te){var ne=((J=Math.max(J,0))+(ee=Math.min(ee,l._length)))/2;for(D=0;D<U.length;D++)for(Z=U[D].pts,j=1;j<Z.length;j++)(re=Z[j-1][1])>ne!=(H=Z[j][1])>=ne&&(X=Z[j-1][0],$=Z[j][0],H-re&&(Q=X+($-X)*(ne-re)/(H-re),B=Math.min(B,Q),K=Math.max(K,Q)));B=Math.max(B,0),K=Math.min(K,h._length);var se=e.defaultLine;return e.opacity(a.fillcolor)?se=a.fillcolor:e.opacity((a.line||{}).color)&&(se=a.line.color),d.extendFlat(n,{distance:n.maxHoverDistance,x0:B,x1:K,y0:ne,y1:ne,color:se,hovertemplate:!1}),delete n.index,a.text&&!Array.isArray(a.text)?n.text=String(a.text):n.text=a.name,[n]}}}},{"../../components/color":367,"../../components/fx":407,"../../lib":515,"../../registry":647,"./get_trace_color":946}],948:[function(m,G,Y){var d=m("./subtypes");G.exports={hasLines:d.hasLines,hasMarkers:d.hasMarkers,hasText:d.hasText,isBubble:d.isBubble,attributes:m("./attributes"),supplyDefaults:m("./defaults"),crossTraceDefaults:m("./cross_trace_defaults"),calc:m("./calc").calc,crossTraceCalc:m("./cross_trace_calc"),arraysToCalcdata:m("./arrays_to_calcdata"),plot:m("./plot"),colorbar:m("./marker_colorbar"),formatLabels:m("./format_labels"),style:m("./style").style,styleOnSelect:m("./style").styleOnSelect,hoverPoints:m("./hover"),selectPoints:m("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"./arrays_to_calcdata":935,"./attributes":936,"./calc":937,"./cross_trace_calc":941,"./cross_trace_defaults":942,"./defaults":943,"./format_labels":945,"./hover":947,"./marker_colorbar":954,"./plot":957,"./select":958,"./style":960,"./subtypes":961}],949:[function(m,G,Y){var d=m("../../lib").isArrayOrTypedArray,v=m("../../components/colorscale/helpers").hasColorscale,w=m("../../components/colorscale/defaults");G.exports=function(y,e,t,n,o,r){r||(r={});var g=(y.marker||{}).color;o("line.color",t),v(y,"line")?w(y,e,n,o,{prefix:"line.",cLetter:"c"}):o("line.color",!d(g)&&g||t),o("line.width"),r.noDash||o("line.dash"),r.backoff&&o("line.backoff")}},{"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"../../lib":515}],950:[function(m,G,Y){var d=m("../../components/drawing"),v=m("../../constants/numerical"),w=v.BADNUM,y=v.LOG_CLIP,e=y+.5,t=y-.5,n=m("../../lib"),o=n.segmentsIntersect,r=n.constrain,g=m("./constants");G.exports=function(c,a){var h,l,s,p,u,i,x,f,_,b,T,k,L,A,I,P,S,E,z=a.trace||{},D=a.xaxis,j=a.yaxis,V=D.type==="log",Z=j.type==="log",Q=D._length,X=j._length,$=a.backoff,re=z.marker,H=a.connectGaps,N=a.baseTolerance,U=a.shape,te=U==="linear",B=z.fill&&z.fill!=="none",K=[],J=g.minTolerance,ee=c.length,ne=new Array(ee),se=0;function oe(Dt){var Ne=c[Dt];if(!Ne)return!1;var Ye=a.linearized?D.l2p(Ne.x):D.c2p(Ne.x),pe=a.linearized?j.l2p(Ne.y):j.c2p(Ne.y);if(Ye===w){if(V&&(Ye=D.c2p(Ne.x,!0)),Ye===w)return!1;Z&&pe===w&&(Ye*=Math.abs(D._m*X*(D._m>0?e:t)/(j._m*Q*(j._m>0?e:t)))),Ye*=1e3}if(pe===w){if(Z&&(pe=j.c2p(Ne.y,!0)),pe===w)return!1;pe*=1e3}return[Ye,pe]}function me(Dt,Ne,Ye,pe){var _e=Ye-Dt,Be=pe-Ne,He=.5-Dt,Je=.5-Ne,Ze=_e*_e+Be*Be,ct=_e*He+Be*Je;if(ct>0&&ct<Ze){var lt=He*Be-Je*_e;if(lt*lt<Ze)return!0}}function ce(Dt,Ne){var Ye=Dt[0]/Q,pe=Dt[1]/X,_e=Math.max(0,-Ye,Ye-1,-pe,pe-1);return _e&&S!==void 0&&me(Ye,pe,S,E)&&(_e=0),_e&&Ne&&me(Ye,pe,Ne[0]/Q,Ne[1]/X)&&(_e=0),(1+g.toleranceGrowth*_e)*N}function ye(Dt,Ne){var Ye=Dt[0]-Ne[0],pe=Dt[1]-Ne[1];return Math.sqrt(Ye*Ye+pe*pe)}var Se,fe,ge,Te,le,ve,Me,we=g.maxScreensAway,de=-Q*we,Ie=Q*(1+we),De=-X*we,Oe=X*(1+we),Ve=[[de,De,Ie,De],[Ie,De,Ie,Oe],[Ie,Oe,de,Oe],[de,Oe,de,De]];function Fe(Dt){if(Dt[0]<de||Dt[0]>Ie||Dt[1]<De||Dt[1]>Oe)return[r(Dt[0],de,Ie),r(Dt[1],De,Oe)]}function ze(Dt,Ne){return Dt[0]===Ne[0]&&(Dt[0]===de||Dt[0]===Ie)||Dt[1]===Ne[1]&&(Dt[1]===De||Dt[1]===Oe)||void 0}function Re(Dt,Ne,Ye){return function(pe,_e){var Be=Fe(pe),He=Fe(_e),Je=[];if(Be&&He&&ze(Be,He))return Je;Be&&Je.push(Be),He&&Je.push(He);var Ze=2*n.constrain((pe[Dt]+_e[Dt])/2,Ne,Ye)-((Be||pe)[Dt]+(He||_e)[Dt]);return Ze&&((Be&&He?Ze>0==Be[Dt]>He[Dt]?Be:He:Be||He)[Dt]+=Ze),Je}}function We(Dt){var Ne=Dt[0],Ye=Dt[1],pe=Ne===ne[se-1][0],_e=Ye===ne[se-1][1];if(!pe||!_e)if(se>1){var Be=Ne===ne[se-2][0],He=Ye===ne[se-2][1];pe&&(Ne===de||Ne===Ie)&&Be?He?se--:ne[se-1]=Dt:_e&&(Ye===De||Ye===Oe)&&He?Be?se--:ne[se-1]=Dt:ne[se++]=Dt}else ne[se++]=Dt}function $e(Dt){ne[se-1][0]!==Dt[0]&&ne[se-1][1]!==Dt[1]&&We([ge,Te]),We(Dt),le=null,ge=Te=0}U==="linear"||U==="spline"?Me=function(Dt,Ne){for(var Ye=[],pe=0,_e=0;_e<4;_e++){var Be=Ve[_e],He=o(Dt[0],Dt[1],Ne[0],Ne[1],Be[0],Be[1],Be[2],Be[3]);He&&(!pe||Math.abs(He.x-Ye[0][0])>1||Math.abs(He.y-Ye[0][1])>1)&&(He=[He.x,He.y],pe&&ye(He,Dt)<ye(Ye[0],Dt)?Ye.unshift(He):Ye.push(He),pe++)}return Ye}:U==="hv"||U==="vh"?Me=function(Dt,Ne){var Ye=[],pe=Fe(Dt),_e=Fe(Ne);return pe&&_e&&ze(pe,_e)||(pe&&Ye.push(pe),_e&&Ye.push(_e)),Ye}:U==="hvh"?Me=Re(0,de,Ie):U==="vhv"&&(Me=Re(1,De,Oe));var at=n.isArrayOrTypedArray(re);function gt(Dt){if(Dt&&$&&(Dt.i=h,Dt.d=c,Dt.trace=z,Dt.marker=at?re[Dt.i]:re,Dt.backoff=$),S=Dt[0]/Q,E=Dt[1]/X,Se=Dt[0]<de?de:Dt[0]>Ie?Ie:0,fe=Dt[1]<De?De:Dt[1]>Oe?Oe:0,Se||fe){if(se)if(le){var Ne=Me(le,Dt);Ne.length>1&&($e(Ne[0]),ne[se++]=Ne[1])}else ve=Me(ne[se-1],Dt)[0],ne[se++]=ve;else ne[se++]=[Se||Dt[0],fe||Dt[1]];var Ye=ne[se-1];Se&&fe&&(Ye[0]!==Se||Ye[1]!==fe)?(le&&(ge!==Se&&Te!==fe?We(ge&&Te?(pe=le,Be=(_e=Dt)[0]-pe[0],He=(_e[1]-pe[1])/Be,(pe[1]*_e[0]-_e[1]*pe[0])/Be>0?[He>0?de:Ie,Oe]:[He>0?Ie:de,De]):[ge||Se,Te||fe]):ge&&Te&&We([ge,Te])),We([Se,fe])):ge-Se&&Te-fe&&We([Se||ge,fe||Te]),le=Dt,ge=Se,Te=fe}else le&&$e(Me(le,Dt)[0]),ne[se++]=Dt;var pe,_e,Be,He}for(h=0;h<ee;h++)if(l=oe(h)){for(se=0,le=null,gt(l),h++;h<ee;h++){if(!(p=oe(h))){if(H)continue;break}if(te&&a.simplify){var xt=oe(h+1);if(b=ye(p,l),B&&(se===0||se===ee-1)||!(b<ce(p,xt)*J)){for(f=[(p[0]-l[0])/b,(p[1]-l[1])/b],u=l,T=b,k=A=I=0,x=!1,s=p,h++;h<c.length;h++){if(i=xt,xt=oe(h+1),!i){if(H)continue;break}if(P=(_=[i[0]-l[0],i[1]-l[1]])[0]*f[1]-_[1]*f[0],A=Math.min(A,P),(I=Math.max(I,P))-A>ce(i,xt))break;s=i,(L=_[0]*f[0]+_[1]*f[1])>T?(T=L,p=i,x=!1):L<k&&(k=L,u=i,x=!0)}if(x?(gt(p),s!==u&&gt(u)):(u!==l&&gt(u),s!==p&&gt(p)),gt(s),h>=c.length||!i)break;gt(i),l=i}}else gt(p)}le&&We([ge||le[0],Te||le[1]]),K.push(ne.slice(0,se))}var mt=U.slice(U.length-1);if($&&mt!=="h"&&mt!=="v"){for(var nt=!1,Qe=-1,vt=[],jt=0;jt<K.length;jt++)for(var Gt=0;Gt<K[jt].length-1;Gt++){var $t=K[jt][Gt],Zt=K[jt][Gt+1],cr=d.applyBackoff(Zt,$t);cr[0]===Zt[0]&&cr[1]===Zt[1]||(nt=!0),vt[Qe+1]||(vt[++Qe]=[$t,[cr[0],cr[1]]])}return nt?vt:K}return K}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"./constants":940}],951:[function(m,G,Y){G.exports=function(d,v,w){w("line.shape")==="spline"&&w("line.smoothing")}},{}],952:[function(m,G,Y){var d={tonextx:1,tonexty:1,tonext:1};G.exports=function(v,w,y){var e,t,n,o,r,g={},c=!1,a=-1,h=0,l=-1;for(t=0;t<y.length;t++)(n=(e=y[t][0].trace).stackgroup||"")?n in g?r=g[n]:(r=g[n]=h,h++):e.fill in d&&l>=0?r=l:(r=l=h,h++),r<a&&(c=!0),e._groupIndex=a=r;var s=y.slice();c&&s.sort(function(u,i){var x=u[0].trace,f=i[0].trace;return x._groupIndex-f._groupIndex||x.index-f.index});var p={};for(t=0;t<s.length;t++)n=(e=s[t][0].trace).stackgroup||"",e.visible===!0?(e._nexttrace=null,e.fill in d&&(o=p[n],e._prevtrace=o||null,o&&(o._nexttrace=e)),e._ownfill=e.fill&&(e.fill.substr(0,6)==="tozero"||e.fill==="toself"||e.fill.substr(0,2)==="to"&&!e._prevtrace),p[n]=e):e._prevtrace=e._nexttrace=e._ownfill=null;return s}},{}],953:[function(m,G,Y){var d=m("fast-isnumeric");G.exports=function(v,w){w||(w=2);var y=v.marker,e=y.sizeref||1,t=y.sizemin||0,n=y.sizemode==="area"?function(o){return Math.sqrt(o/e)}:function(o){return o/e};return function(o){var r=n(o/w);return d(r)&&r>0?Math.max(r,t):0}}},{"fast-isnumeric":190}],954:[function(m,G,Y){G.exports={container:"marker",min:"cmin",max:"cmax"}},{}],955:[function(m,G,Y){var d=m("../../components/color"),v=m("../../components/colorscale/helpers").hasColorscale,w=m("../../components/colorscale/defaults"),y=m("./subtypes");G.exports=function(e,t,n,o,r,g){var c=y.isBubble(e),a=(e.line||{}).color;g=g||{},a&&(n=a),r("marker.symbol"),r("marker.opacity",c?.7:1),r("marker.size"),g.noAngle||(r("marker.angle"),g.noAngleRef||r("marker.angleref"),g.noStandOff||r("marker.standoff")),r("marker.color",n),v(e,"marker")&&w(e,t,o,r,{prefix:"marker.",cLetter:"c"}),g.noSelect||(r("selected.marker.color"),r("unselected.marker.color"),r("selected.marker.size"),r("unselected.marker.size")),g.noLine||(r("marker.line.color",a&&!Array.isArray(a)&&t.marker.color!==a?a:c?d.background:d.defaultLine),v(e,"marker.line")&&w(e,t,o,r,{prefix:"marker.line.",cLetter:"c"}),r("marker.line.width",c?1:0)),c&&(r("marker.sizeref"),r("marker.sizemin"),r("marker.sizemode")),g.gradient&&r("marker.gradient.type")!=="none"&&r("marker.gradient.color")}},{"../../components/color":367,"../../components/colorscale/defaults":377,"../../components/colorscale/helpers":378,"./subtypes":961}],956:[function(m,G,Y){var d=m("../../lib").dateTick0,v=m("../../constants/numerical").ONEWEEK;function w(y,e){return d(e,y%v==0?1:0)}G.exports=function(y,e,t,n,o){if(o||(o={x:!0,y:!0}),o.x){var r=n("xperiod");r&&(n("xperiod0",w(r,e.xcalendar)),n("xperiodalignment"))}if(o.y){var g=n("yperiod");g&&(n("yperiod0",w(g,e.ycalendar)),n("yperiodalignment"))}}},{"../../constants/numerical":491,"../../lib":515}],957:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../registry"),w=m("../../lib"),y=w.ensureSingle,e=w.identity,t=m("../../components/drawing"),n=m("./subtypes"),o=m("./line_points"),r=m("./link_traces"),g=m("../../lib/polygon").tester;function c(a,h,l,s,p,u,i){var x;(function(ve,Me,we,de,Ie){var De=we.xaxis,Oe=we.yaxis,Ve=d.extent(w.simpleMap(De.range,De.r2c)),Fe=d.extent(w.simpleMap(Oe.range,Oe.r2c)),ze=de[0].trace;if(!!n.hasMarkers(ze)){var Re=ze.marker.maxdisplayed;if(Re!==0){var We=de.filter(function(xt){return xt.x>=Ve[0]&&xt.x<=Ve[1]&&xt.y>=Fe[0]&&xt.y<=Fe[1]}),$e=Math.ceil(We.length/Re),at=0;Ie.forEach(function(xt,mt){var nt=xt[0].trace;n.hasMarkers(nt)&&nt.marker.maxdisplayed>0&&mt<Me&&at++});var gt=Math.round(at*$e/3+Math.floor(at/3)*$e/7.1);de.forEach(function(xt){delete xt.vis}),We.forEach(function(xt,mt){Math.round((mt+gt)%$e)===0&&(xt.vis=!0)})}}})(0,h,l,s,p);var f=!!i&&i.duration>0;function _(ve){return f?ve.transition():ve}var b=l.xaxis,T=l.yaxis,k=s[0].trace,L=k.line,A=d.select(u),I=y(A,"g","errorbars"),P=y(A,"g","lines"),S=y(A,"g","points"),E=y(A,"g","text");if(v.getComponentMethod("errorbars","plot")(a,I,l,i),k.visible===!0){var z,D;_(A).style("opacity",k.opacity);var j=k.fill.charAt(k.fill.length-1);j!=="x"&&j!=="y"&&(j=""),s[0][l.isRangePlot?"nodeRangePlot3":"node3"]=A;var V,Z,Q="",X=[],$=k._prevtrace;$&&(Q=$._prevRevpath||"",D=$._nextFill,X=$._polygons);var re,H,N,U,te,B,K,J="",ee="",ne=[],se=w.noop;if(z=k._ownFill,n.hasLines(k)||k.fill!=="none"){for(D&&D.datum(s),["hv","vh","hvh","vhv"].indexOf(L.shape)!==-1?(re=t.steps(L.shape),H=t.steps(L.shape.split("").reverse().join(""))):re=H=L.shape==="spline"?function(ve){var Me=ve[ve.length-1];return ve.length>1&&ve[0][0]===Me[0]&&ve[0][1]===Me[1]?t.smoothclosed(ve.slice(1),L.smoothing):t.smoothopen(ve,L.smoothing)}:function(ve){return"M"+ve.join("L")},N=function(ve){return H(ve.reverse())},ne=o(s,{xaxis:b,yaxis:T,trace:k,connectGaps:k.connectgaps,baseTolerance:Math.max(L.width||1,3)/4,shape:L.shape,backoff:L.backoff,simplify:L.simplify,fill:k.fill}),K=k._polygons=new Array(ne.length),x=0;x<ne.length;x++)k._polygons[x]=g(ne[x]);ne.length&&(U=ne[0][0],B=(te=ne[ne.length-1])[te.length-1]),se=function(ve){return function(Me){if(V=re(Me),Z=N(Me),J?j?(J+="L"+V.substr(1),ee=Z+"L"+ee.substr(1)):(J+="Z"+V,ee=Z+"Z"+ee):(J=V,ee=Z),n.hasLines(k)&&Me.length>1){var we=d.select(this);if(we.datum(s),ve)_(we.style("opacity",0).attr("d",V).call(t.lineGroupStyle)).style("opacity",1);else{var de=_(we);de.attr("d",V),t.singleLineStyle(s,de)}}}}}var oe=P.selectAll(".js-line").data(ne);_(oe.exit()).style("opacity",0).remove(),oe.each(se(!1)),oe.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(t.lineGroupStyle).each(se(!0)),t.setClipUrl(oe,l.layerClipId,a),ne.length?(z?(z.datum(s),U&&B&&(j?(j==="y"?U[1]=B[1]=T.c2p(0,!0):j==="x"&&(U[0]=B[0]=b.c2p(0,!0)),_(z).attr("d","M"+B+"L"+U+"L"+J.substr(1)).call(t.singleFillStyle,a)):_(z).attr("d",J+"Z").call(t.singleFillStyle,a))):D&&(k.fill.substr(0,6)==="tonext"&&J&&Q?(k.fill==="tonext"?_(D).attr("d",J+"Z"+Q+"Z").call(t.singleFillStyle,a):_(D).attr("d",J+"L"+Q.substr(1)+"Z").call(t.singleFillStyle,a),k._polygons=k._polygons.concat(X)):(ce(D),k._polygons=null)),k._prevRevpath=ee,k._prevPolygons=K):(z?ce(z):D&&ce(D),k._polygons=k._prevRevpath=k._prevPolygons=null),S.datum(s),E.datum(s),function(ve,Me,we){var de,Ie=we[0].trace,De=n.hasMarkers(Ie),Oe=n.hasText(Ie),Ve=Te(Ie),Fe=le,ze=le;if(De||Oe){var Re=e,We=Ie.stackgroup,$e=We&&a._fullLayout._scatterStackOpts[b._id+T._id][We].stackgaps==="infer zero";Ie.marker.maxdisplayed||Ie._needsCull?Re=$e?Se:ye:We&&!$e&&(Re=fe),De&&(Fe=Re),Oe&&(ze=Re)}var at,gt=(de=ve.selectAll("path.point").data(Fe,Ve)).enter().append("path").classed("point",!0);f&&gt.call(t.pointStyle,Ie,a).call(t.translatePoints,b,T).style("opacity",0).transition().style("opacity",1),de.order(),De&&(at=t.makePointStyleFns(Ie)),de.each(function(xt){var mt=d.select(this),nt=_(mt);t.translatePoint(xt,nt,b,T)?(t.singlePointStyle(xt,nt,Ie,at,a),l.layerClipId&&t.hideOutsideRangePoint(xt,nt,b,T,Ie.xcalendar,Ie.ycalendar),Ie.customdata&&mt.classed("plotly-customdata",xt.data!==null&&xt.data!==void 0)):nt.remove()}),f?de.exit().transition().style("opacity",0).remove():de.exit().remove(),(de=Me.selectAll("g").data(ze,Ve)).enter().append("g").classed("textpoint",!0).append("text"),de.order(),de.each(function(xt){var mt=d.select(this),nt=_(mt.select("text"));t.translatePoint(xt,nt,b,T)?l.layerClipId&&t.hideOutsideRangePoint(xt,mt,b,T,Ie.xcalendar,Ie.ycalendar):mt.remove()}),de.selectAll("text").call(t.textPointStyle,Ie,a).each(function(xt){var mt=b.c2p(xt.x),nt=T.c2p(xt.y);d.select(this).selectAll("tspan.line").each(function(){_(d.select(this)).attr({x:mt,y:nt})})}),de.exit().remove()}(S,E,s);var me=k.cliponaxis===!1?null:l.layerClipId;t.setClipUrl(S,me,a),t.setClipUrl(E,me,a)}function ce(ve){_(ve).attr("d","M0,0Z")}function ye(ve){return ve.filter(function(Me){return!Me.gap&&Me.vis})}function Se(ve){return ve.filter(function(Me){return Me.vis})}function fe(ve){return ve.filter(function(Me){return!Me.gap})}function ge(ve){return ve.id}function Te(ve){if(ve.ids)return ge}function le(){return!1}}G.exports=function(a,h,l,s,p,u){var i,x,f=!p,_=!!p&&p.duration>0,b=r(a,h,l);(i=s.selectAll("g.trace").data(b,function(T){return T[0].trace.uid})).enter().append("g").attr("class",function(T){return"trace scatter trace"+T[0].trace.uid}).style("stroke-miterlimit",2),i.order(),function(T,k,L){k.each(function(A){var I=y(d.select(this),"g","fills");t.setClipUrl(I,L.layerClipId,T);var P=A[0].trace,S=[];P._ownfill&&S.push("_ownFill"),P._nexttrace&&S.push("_nextFill");var E=I.selectAll("g").data(S,e);E.enter().append("g"),E.exit().each(function(z){P[z]=null}).remove(),E.order().each(function(z){P[z]=y(d.select(this),"path","js-fill")})})}(a,i,h),_?(u&&(x=u()),d.transition().duration(p.duration).ease(p.easing).each("end",function(){x&&x()}).each("interrupt",function(){x&&x()}).each(function(){s.selectAll("g.trace").each(function(T,k){c(a,k,h,T,b,this,p)})})):i.each(function(T,k){c(a,k,h,T,b,this,p)}),f&&i.exit().remove(),s.selectAll("path:not([d])").remove()}},{"../../components/drawing":389,"../../lib":515,"../../lib/polygon":527,"../../registry":647,"./line_points":950,"./link_traces":952,"./subtypes":961,"@plotly/d3":58}],958:[function(m,G,Y){var d=m("./subtypes");G.exports=function(v,w){var y,e,t,n,o=v.cd,r=v.xaxis,g=v.yaxis,c=[],a=o[0].trace;if(!d.hasMarkers(a)&&!d.hasText(a))return[];if(w===!1)for(y=0;y<o.length;y++)o[y].selected=0;else for(y=0;y<o.length;y++)e=o[y],t=r.c2p(e.x),n=g.c2p(e.y),e.i!==null&&w.contains([t,n],!1,y,v)?(c.push({pointNumber:e.i,x:r.c2d(e.x),y:g.c2d(e.y)}),e.selected=1):e.selected=0;return c}},{"./subtypes":961}],959:[function(m,G,Y){var d=["orientation","groupnorm","stackgaps"];G.exports=function(v,w,y,e){var t=y._scatterStackOpts,n=e("stackgroup");if(n){var o=w.xaxis+w.yaxis,r=t[o];r||(r=t[o]={});var g=r[n],c=!1;g?g.traces.push(w):(g=r[n]={traceIndices:[],traces:[w]},c=!0);for(var a={orientation:w.x&&!w.y?"h":"v"},h=0;h<d.length;h++){var l=d[h],s=l+"Found";if(!g[s]){var p=v[l]!==void 0,u=l==="orientation";if((p||c)&&(g[l]=e(l,a[l]),u&&(g.fillDflt=g[l]==="h"?"tonextx":"tonexty"),p&&(g[s]=!0,!c&&(delete g.traces[0][l],u))))for(var i=0;i<g.traces.length-1;i++){var x=g.traces[i];x._input.fill!==x.fill&&(x.fill=g.fillDflt)}}}return g}}},{}],960:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../components/drawing"),w=m("../../registry");function y(t,n,o){v.pointStyle(t.selectAll("path.point"),n,o)}function e(t,n,o){v.textPointStyle(t.selectAll("text"),n,o)}G.exports={style:function(t){var n=d.select(t).selectAll("g.trace.scatter");n.style("opacity",function(o){return o[0].trace.opacity}),n.selectAll("g.points").each(function(o){y(d.select(this),o.trace||o[0].trace,t)}),n.selectAll("g.text").each(function(o){e(d.select(this),o.trace||o[0].trace,t)}),n.selectAll("g.trace path.js-line").call(v.lineGroupStyle),n.selectAll("g.trace path.js-fill").call(v.fillGroupStyle,t),w.getComponentMethod("errorbars","style")(n)},stylePoints:y,styleText:e,styleOnSelect:function(t,n,o){var r=n[0].trace;r.selectedpoints?(v.selectedPointStyle(o.selectAll("path.point"),r),v.selectedTextStyle(o.selectAll("text"),r)):(y(o,r,t),e(o,r,t))}}},{"../../components/drawing":389,"../../registry":647,"@plotly/d3":58}],961:[function(m,G,Y){var d=m("../../lib");G.exports={hasLines:function(v){return v.visible&&v.mode&&v.mode.indexOf("lines")!==-1},hasMarkers:function(v){return v.visible&&(v.mode&&v.mode.indexOf("markers")!==-1||v.type==="splom")},hasText:function(v){return v.visible&&v.mode&&v.mode.indexOf("text")!==-1},isBubble:function(v){return d.isPlainObject(v.marker)&&d.isArrayOrTypedArray(v.marker.size)}}},{"../../lib":515}],962:[function(m,G,Y){var d=m("../../lib");G.exports=function(v,w,y,e,t){t=t||{},e("textposition"),d.coerceFont(e,"textfont",y.font),t.noSelect||(e("selected.textfont.color"),e("unselected.textfont.color"))}},{"../../lib":515}],963:[function(m,G,Y){var d=m("../../lib"),v=m("../../registry");G.exports=function(w,y,e,t){var n,o=t("x"),r=t("y");if(v.getComponentMethod("calendars","handleTraceDefaults")(w,y,["x","y"],e),o){var g=d.minRowLength(o);r?n=Math.min(g,d.minRowLength(r)):(n=g,t("y0"),t("dy"))}else{if(!r)return 0;n=d.minRowLength(r),t("x0"),t("dx")}return y._length=n,n}},{"../../lib":515,"../../registry":647}],964:[function(m,G,Y){var d=m("../scatter/attributes"),v=m("../../components/colorscale/attributes"),w=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,y=m("../../plots/template_attributes").hovertemplateAttrs,e=m("../../plots/template_attributes").texttemplateAttrs,t=m("../../plots/attributes"),n=m("../../constants/gl3d_dashes"),o=m("../../constants/gl3d_markers"),r=m("../../lib/extend").extendFlat,g=m("../../plot_api/edit_types").overrideAll,c=m("../../lib/sort_object_keys"),a=d.line,h=d.marker,l=h.line,s=r({width:a.width,dash:{valType:"enumerated",values:c(n),dflt:"solid"}},v("line")),p=G.exports=g({x:d.x,y:d.y,z:{valType:"data_array"},text:r({},d.text,{}),texttemplate:e({},{}),hovertext:r({},d.hovertext,{}),hovertemplate:y(),xhoverformat:w("x"),yhoverformat:w("y"),zhoverformat:w("z"),mode:r({},d.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},y:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}},z:{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}},connectgaps:d.connectgaps,line:s,marker:r({symbol:{valType:"enumerated",values:c(o),dflt:"circle",arrayOk:!0},size:r({},h.size,{dflt:8}),sizeref:h.sizeref,sizemin:h.sizemin,sizemode:h.sizemode,opacity:r({},h.opacity,{arrayOk:!1}),colorbar:h.colorbar,line:r({width:r({},l.width,{arrayOk:!1})},v("marker.line"))},v("marker")),textposition:r({},d.textposition,{dflt:"top center"}),textfont:{color:d.textfont.color,size:d.textfont.size,family:r({},d.textfont.family,{arrayOk:!1})},opacity:t.opacity,hoverinfo:r({},t.hoverinfo)},"calc","nested");p.x.editType=p.y.editType=p.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":374,"../../constants/gl3d_dashes":488,"../../constants/gl3d_markers":489,"../../lib/extend":505,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../scatter/attributes":936}],965:[function(m,G,Y){var d=m("../scatter/arrays_to_calcdata"),v=m("../scatter/colorscale_calc");G.exports=function(w,y){var e=[{x:!1,y:!1,trace:y,t:{}}];return d(e,y),v(w,y),e}},{"../scatter/arrays_to_calcdata":935,"../scatter/colorscale_calc":939}],966:[function(m,G,Y){var d=m("../../registry");function v(w,y,e,t){if(!y||!y.visible)return null;for(var n=d.getComponentMethod("errorbars","makeComputeError")(y),o=new Array(w.length),r=0;r<w.length;r++){var g=n(+w[r],r);if(t.type==="log"){var c=t.c2l(w[r]),a=w[r]-g[0],h=w[r]+g[1];if(o[r]=[(t.c2l(a,!0)-c)*e,(t.c2l(h,!0)-c)*e],a>0){var l=t.c2l(a);t._lowerLogErrorBound||(t._lowerLogErrorBound=l),t._lowerErrorBound=Math.min(t._lowerLogErrorBound,l)}}else o[r]=[-g[0]*e,g[1]*e]}return o}G.exports=function(w,y,e){var t=[v(w.x,w.error_x,y[0],e.xaxis),v(w.y,w.error_y,y[1],e.yaxis),v(w.z,w.error_z,y[2],e.zaxis)],n=function(h){for(var l=0;l<h.length;l++)if(h[l])return h[l].length;return 0}(t);if(n===0)return null;for(var o=new Array(n),r=0;r<n;r++){for(var g=[[0,0,0],[0,0,0]],c=0;c<3;c++)if(t[c])for(var a=0;a<2;a++)g[a][c]=t[c][r][a];o[r]=g}return o}},{"../../registry":647}],967:[function(m,G,Y){var d=m("../../../stackgl_modules").gl_line3d,v=m("../../../stackgl_modules").gl_scatter3d,w=m("../../../stackgl_modules").gl_error3d,y=m("../../../stackgl_modules").gl_mesh3d,e=m("../../../stackgl_modules").delaunay_triangulate,t=m("../../lib"),n=m("../../lib/str2rgbarray"),o=m("../../lib/gl_format_color").formatColor,r=m("../scatter/make_bubble_size_func"),g=m("../../constants/gl3d_dashes"),c=m("../../constants/gl3d_markers"),a=m("../../plots/cartesian/axes"),h=m("../../components/fx/helpers").appendArrayPointValue,l=m("./calc_errors");function s(L,A){this.scene=L,this.uid=A,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}var p=s.prototype;function u(L){return L==null?0:L.indexOf("left")>-1?-1:L.indexOf("right")>-1?1:0}function i(L){return L==null?0:L.indexOf("top")>-1?-1:L.indexOf("bottom")>-1?1:0}function x(L,A){return A(4*L)}function f(L){return c[L]}function _(L,A,I,P,S){var E=null;if(t.isArrayOrTypedArray(L)){E=[];for(var z=0;z<A;z++)L[z]===void 0?E[z]=P:E[z]=I(L[z],S)}else E=I(L,t.identity);return E}function b(L,A){var I,P,S,E,z,D,j=[],V=L.fullSceneLayout,Z=L.dataScale,Q=V.xaxis,X=V.yaxis,$=V.zaxis,re=A.marker,H=A.line,N=A.x||[],U=A.y||[],te=A.z||[],B=N.length,K=A.xcalendar,J=A.ycalendar,ee=A.zcalendar;for(z=0;z<B;z++)I=Q.d2l(N[z],0,K)*Z[0],P=X.d2l(U[z],0,J)*Z[1],S=$.d2l(te[z],0,ee)*Z[2],j[z]=[I,P,S];if(Array.isArray(A.text))D=A.text;else if(A.text!==void 0)for(D=new Array(B),z=0;z<B;z++)D[z]=A.text;function ne(de,Ie){var De=V[de];return a.tickText(De,De.d2l(Ie),!0).text}var se=A.texttemplate;if(se){var oe=L.fullLayout._d3locale,me=Array.isArray(se),ce=me?Math.min(se.length,B):B,ye=me?function(de){return se[de]}:function(){return se};for(D=new Array(ce),z=0;z<ce;z++){var Se={x:N[z],y:U[z],z:te[z]},fe={xLabel:ne("xaxis",N[z]),yLabel:ne("yaxis",U[z]),zLabel:ne("zaxis",te[z])},ge={};h(ge,A,z);var Te=A._meta||{};D[z]=t.texttemplateString(ye(z),fe,oe,ge,Se,Te)}}if(E={position:j,mode:A.mode,text:D},"line"in A&&(E.lineColor=o(H,1,B),E.lineWidth=H.width,E.lineDashes=H.dash),"marker"in A){var le=r(A);E.scatterColor=o(re,1,B),E.scatterSize=_(re.size,B,x,20,le),E.scatterMarker=_(re.symbol,B,f,"\u25CF"),E.scatterLineWidth=re.line.width,E.scatterLineColor=o(re.line,1,B),E.scatterAngle=0}"textposition"in A&&(E.textOffset=function(de){var Ie=[0,0];if(Array.isArray(de))for(var De=0;De<de.length;De++)Ie[De]=[0,0],de[De]&&(Ie[De][0]=u(de[De]),Ie[De][1]=i(de[De]));else Ie[0]=u(de),Ie[1]=i(de);return Ie}(A.textposition),E.textColor=o(A.textfont,1,B),E.textSize=_(A.textfont.size,B,t.identity,12),E.textFont=A.textfont.family,E.textAngle=0);var ve=["x","y","z"];for(E.project=[!1,!1,!1],E.projectScale=[1,1,1],E.projectOpacity=[1,1,1],z=0;z<3;++z){var Me=A.projection[ve[z]];(E.project[z]=Me.show)&&(E.projectOpacity[z]=Me.opacity,E.projectScale[z]=Me.scale)}E.errorBounds=l(A,Z,V);var we=function(de){for(var Ie=[0,0,0],De=[[0,0,0],[0,0,0],[0,0,0]],Oe=[1,1,1],Ve=0;Ve<3;Ve++){var Fe=de[Ve];Fe&&Fe.copy_zstyle!==!1&&de[2].visible!==!1&&(Fe=de[2]),Fe&&Fe.visible&&(Ie[Ve]=Fe.width/2,De[Ve]=n(Fe.color),Oe[Ve]=Fe.thickness)}return{capSize:Ie,color:De,lineWidth:Oe}}([A.error_x,A.error_y,A.error_z]);return E.errorColor=we.color,E.errorLineWidth=we.lineWidth,E.errorCapSize=we.capSize,E.delaunayAxis=A.surfaceaxis,E.delaunayColor=n(A.surfacecolor),E}function T(L){if(t.isArrayOrTypedArray(L)){var A=L[0];return t.isArrayOrTypedArray(A)&&(L=A),"rgb("+L.slice(0,3).map(function(I){return Math.round(255*I)})+")"}return null}function k(L){return t.isArrayOrTypedArray(L)?L.length===4&&typeof L[0]=="number"?T(L):L.map(T):null}p.handlePick=function(L){if(L.object&&(L.object===this.linePlot||L.object===this.delaunayMesh||L.object===this.textMarkers||L.object===this.scatterPlot)){var A=L.index=L.data.index;return L.object.highlight&&L.object.highlight(null),this.scatterPlot&&(L.object=this.scatterPlot,this.scatterPlot.highlight(L.data)),L.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[A]||this.textLabels[A]===0)&&(L.textLabel=this.textLabels[A]):L.textLabel=this.textLabels),L.traceCoordinate=[this.data.x[A],this.data.y[A],this.data.z[A]],!0}},p.update=function(L){var A,I,P,S,E=this.scene.glplot.gl,z=g.solid;this.data=L;var D=b(this.scene,L);"mode"in D&&(this.mode=D.mode),"lineDashes"in D&&D.lineDashes in g&&(z=g[D.lineDashes]),this.color=k(D.scatterColor)||k(D.lineColor),this.dataPoints=D.position,A={gl:this.scene.glplot.gl,position:D.position,color:D.lineColor,lineWidth:D.lineWidth||1,dashes:z[0],dashScale:z[1],opacity:L.opacity,connectGaps:L.connectgaps},this.mode.indexOf("lines")!==-1?this.linePlot?this.linePlot.update(A):(this.linePlot=d(A),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);var j=L.opacity;if(L.marker&&L.marker.opacity&&(j*=L.marker.opacity),I={gl:this.scene.glplot.gl,position:D.position,color:D.scatterColor,size:D.scatterSize,glyph:D.scatterMarker,opacity:j,orthographic:!0,lineWidth:D.scatterLineWidth,lineColor:D.scatterLineColor,project:D.project,projectScale:D.projectScale,projectOpacity:D.projectOpacity},this.mode.indexOf("markers")!==-1?this.scatterPlot?this.scatterPlot.update(I):(this.scatterPlot=v(I),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null),S={gl:this.scene.glplot.gl,position:D.position,glyph:D.text,color:D.textColor,size:D.textSize,angle:D.textAngle,alignment:D.textOffset,font:D.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:L.opacity},this.textLabels=L.hovertext||L.text,this.mode.indexOf("text")!==-1?this.textMarkers?this.textMarkers.update(S):(this.textMarkers=v(S),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null),P={gl:this.scene.glplot.gl,position:D.position,color:D.errorColor,error:D.errorBounds,lineWidth:D.errorLineWidth,capSize:D.errorCapSize,opacity:L.opacity},this.errorBars?D.errorBounds?this.errorBars.update(P):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):D.errorBounds&&(this.errorBars=w(P),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),D.delaunayAxis>=0){var V=function(Z,Q,X){var $,re=(X+1)%3,H=(X+2)%3,N=[],U=[];for($=0;$<Z.length;++$){var te=Z[$];!isNaN(te[re])&&isFinite(te[re])&&!isNaN(te[H])&&isFinite(te[H])&&(N.push([te[re],te[H]]),U.push($))}var B=e(N);for($=0;$<B.length;++$)for(var K=B[$],J=0;J<K.length;++J)K[J]=U[K[J]];return{positions:Z,cells:B,meshColor:Q}}(D.position,D.delaunayColor,D.delaunayAxis);V.opacity=L.opacity,this.delaunayMesh?this.delaunayMesh.update(V):(V.gl=E,this.delaunayMesh=y(V),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},p.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())},G.exports=function(L,A){var I=new s(L,A.uid);return I.update(A),I}},{"../../../stackgl_modules":1133,"../../components/fx/helpers":403,"../../constants/gl3d_dashes":488,"../../constants/gl3d_markers":489,"../../lib":515,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/cartesian/axes":566,"../scatter/make_bubble_size_func":953,"./calc_errors":966}],968:[function(m,G,Y){var d=m("../../registry"),v=m("../../lib"),w=m("../scatter/subtypes"),y=m("../scatter/marker_defaults"),e=m("../scatter/line_defaults"),t=m("../scatter/text_defaults"),n=m("./attributes");G.exports=function(o,r,g,c){function a(x,f){return v.coerce(o,r,n,x,f)}if(function(x,f,_,b){var T=0,k=_("x"),L=_("y"),A=_("z");return d.getComponentMethod("calendars","handleTraceDefaults")(x,f,["x","y","z"],b),k&&L&&A&&(T=Math.min(k.length,L.length,A.length),f._length=f._xlength=f._ylength=f._zlength=T),T}(o,r,a,c)){a("text"),a("hovertext"),a("hovertemplate"),a("xhoverformat"),a("yhoverformat"),a("zhoverformat"),a("mode"),w.hasLines(r)&&(a("connectgaps"),e(o,r,g,c,a)),w.hasMarkers(r)&&y(o,r,g,c,a,{noSelect:!0,noAngle:!0}),w.hasText(r)&&(a("texttemplate"),t(o,r,c,a,{noSelect:!0}));var h=(r.line||{}).color,l=(r.marker||{}).color;a("surfaceaxis")>=0&&a("surfacecolor",h||l);for(var s=["x","y","z"],p=0;p<3;++p){var u="projection."+s[p];a(u+".show")&&(a(u+".opacity"),a(u+".scale"))}var i=d.getComponentMethod("errorbars","supplyDefaults");i(o,r,h||l||g,{axis:"z"}),i(o,r,h||l||g,{axis:"y",inherit:"z"}),i(o,r,h||l||g,{axis:"x",inherit:"z"})}else r.visible=!1}},{"../../lib":515,"../../registry":647,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":964}],969:[function(m,G,Y){G.exports={plot:m("./convert"),attributes:m("./attributes"),markerSymbols:m("../../constants/gl3d_markers"),supplyDefaults:m("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:m("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:m("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":489,"../../plots/gl3d":607,"./attributes":964,"./calc":965,"./convert":967,"./defaults":968}],970:[function(m,G,Y){var d=m("../scatter/attributes"),v=m("../../plots/attributes"),w=m("../../plots/template_attributes").hovertemplateAttrs,y=m("../../plots/template_attributes").texttemplateAttrs,e=m("../../components/colorscale/attributes"),t=m("../../lib/extend").extendFlat,n=d.marker,o=d.line,r=n.line;G.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:t({},d.mode,{dflt:"markers"}),text:t({},d.text,{}),texttemplate:y({editType:"plot"},{keys:["a","b","text"]}),hovertext:t({},d.hovertext,{}),line:{color:o.color,width:o.width,dash:o.dash,backoff:o.backoff,shape:t({},o.shape,{values:["linear","spline"]}),smoothing:o.smoothing,editType:"calc"},connectgaps:d.connectgaps,fill:t({},d.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:d.fillcolor,marker:t({symbol:n.symbol,opacity:n.opacity,maxdisplayed:n.maxdisplayed,angle:n.angle,angleref:n.angleref,standoff:n.standoff,size:n.size,sizeref:n.sizeref,sizemin:n.sizemin,sizemode:n.sizemode,line:t({width:r.width,editType:"calc"},e("marker.line")),gradient:n.gradient,editType:"calc"},e("marker")),textfont:d.textfont,textposition:d.textposition,selected:d.selected,unselected:d.unselected,hoverinfo:t({},v.hoverinfo,{flags:["a","b","text","name"]}),hoveron:d.hoveron,hovertemplate:w()}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],971:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../scatter/colorscale_calc"),w=m("../scatter/arrays_to_calcdata"),y=m("../scatter/calc_selection"),e=m("../scatter/calc").calcMarkerSize,t=m("../carpet/lookup_carpetid");G.exports=function(n,o){var r=o._carpetTrace=t(n,o);if(r&&r.visible&&r.visible!=="legendonly"){var g;o.xaxis=r.xaxis,o.yaxis=r.yaxis;var c,a,h=o._length,l=new Array(h),s=!1;for(g=0;g<h;g++)if(c=o.a[g],a=o.b[g],d(c)&&d(a)){var p=r.ab2xy(+c,+a,!0),u=r.isVisible(+c,+a);u||(s=!0),l[g]={x:p[0],y:p[1],a:c,b:a,vis:u}}else l[g]={x:!1,y:!1};return o._needsCull=s,l[0].carpet=r,l[0].trace=o,e(o,h),v(n,o),w(l,o),y(l,o),l}}},{"../carpet/lookup_carpetid":717,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],972:[function(m,G,Y){var d=m("../../lib"),v=m("../scatter/constants"),w=m("../scatter/subtypes"),y=m("../scatter/marker_defaults"),e=m("../scatter/line_defaults"),t=m("../scatter/line_shape_defaults"),n=m("../scatter/text_defaults"),o=m("../scatter/fillcolor_defaults"),r=m("./attributes");G.exports=function(g,c,a,h){function l(x,f){return d.coerce(g,c,r,x,f)}l("carpet"),c.xaxis="x",c.yaxis="y";var s=l("a"),p=l("b"),u=Math.min(s.length,p.length);if(u){c._length=u,l("text"),l("texttemplate"),l("hovertext"),l("mode",u<v.PTS_LINESONLY?"lines+markers":"lines"),w.hasLines(c)&&(e(g,c,a,h,l,{backoff:!0}),t(g,c,l),l("connectgaps")),w.hasMarkers(c)&&y(g,c,a,h,l,{gradient:!0}),w.hasText(c)&&n(g,c,h,l);var i=[];(w.hasMarkers(c)||w.hasText(c))&&(l("marker.maxdisplayed"),i.push("points")),l("fill"),c.fill!=="none"&&(o(g,c,a,l),w.hasLines(c)||t(g,c,l)),c.fill!=="tonext"&&c.fill!=="toself"||i.push("fills"),l("hoveron",i.join("+")||"points")!=="fills"&&l("hovertemplate"),d.coerceSelectionMarkerOpacity(c,l)}else c.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":970}],973:[function(m,G,Y){G.exports=function(d,v,w,y,e){var t=y[e];return d.a=t.a,d.b=t.b,d.y=t.y,d}},{}],974:[function(m,G,Y){G.exports=function(d,v){var w={},y=v._carpet,e=y.ab2ij([d.a,d.b]),t=Math.floor(e[0]),n=e[0]-t,o=Math.floor(e[1]),r=e[1]-o,g=y.evalxy([],t,o,n,r);return w.yLabel=g[1].toFixed(3),w}},{}],975:[function(m,G,Y){var d=m("../scatter/hover"),v=m("../../lib").fillText;G.exports=function(w,y,e,t){var n=d(w,y,e,t);if(n&&n[0].index!==!1){var o=n[0];if(o.index===void 0){var r=1-o.y0/w.ya._length,g=w.xa._length,c=g*r/2,a=g-c;return o.x0=Math.max(Math.min(o.x0,a),c),o.x1=Math.max(Math.min(o.x1,a),c),n}var h=o.cd[o.index];o.a=h.a,o.b=h.b,o.xLabelVal=void 0,o.yLabelVal=void 0;var l=o.trace,s=l._carpet,p=l._module.formatLabels(h,l);o.yLabel=p.yLabel,delete o.text;var u=[];if(!l.hovertemplate){var i=(h.hi||l.hoverinfo).split("+");i.indexOf("all")!==-1&&(i=["a","b","text"]),i.indexOf("a")!==-1&&x(s.aaxis,h.a),i.indexOf("b")!==-1&&x(s.baxis,h.b),u.push("y: "+o.yLabel),i.indexOf("text")!==-1&&v(h,l,u),o.extraText=u.join("<br>")}return n}function x(f,_){var b;b=f.labelprefix&&f.labelprefix.length>0?f.labelprefix.replace(/ = $/,""):f._hovertitle,u.push(b+": "+_.toFixed(3)+f.labelsuffix)}}},{"../../lib":515,"../scatter/hover":947}],976:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../scatter/marker_colorbar"),formatLabels:m("./format_labels"),calc:m("./calc"),plot:m("./plot"),style:m("../scatter/style").style,styleOnSelect:m("../scatter/style").styleOnSelect,hoverPoints:m("./hover"),selectPoints:m("../scatter/select"),eventData:m("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:m("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":970,"./calc":971,"./defaults":972,"./event_data":973,"./format_labels":974,"./hover":975,"./plot":977}],977:[function(m,G,Y){var d=m("../scatter/plot"),v=m("../../plots/cartesian/axes"),w=m("../../components/drawing");G.exports=function(y,e,t,n){var o,r,g,c=t[0][0].carpet,a=v.getFromId(y,c.xaxis||"x"),h=v.getFromId(y,c.yaxis||"y"),l={xaxis:a,yaxis:h,plot:e.plot};for(o=0;o<t.length;o++)(r=t[o][0].trace)._xA=a,r._yA=h;for(d(y,l,t,n),o=0;o<t.length;o++)r=t[o][0].trace,g=n.selectAll("g.trace"+r.uid+" .js-line"),w.setClipUrl(g,t[o][0].carpet._clipPathId,y)}},{"../../components/drawing":389,"../../plots/cartesian/axes":566,"../scatter/plot":957}],978:[function(m,G,Y){var d=m("../../plots/template_attributes").hovertemplateAttrs,v=m("../../plots/template_attributes").texttemplateAttrs,w=m("../scatter/attributes"),y=m("../../plots/attributes"),e=m("../../components/colorscale/attributes"),t=m("../../components/drawing/attributes").dash,n=m("../../lib/extend").extendFlat,o=m("../../plot_api/edit_types").overrideAll,r=w.marker,g=w.line,c=r.line;G.exports=o({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:n({},w.mode,{dflt:"markers"}),text:n({},w.text,{}),texttemplate:v({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:n({},w.hovertext,{}),textfont:w.textfont,textposition:w.textposition,line:{color:g.color,width:g.width,dash:t},connectgaps:w.connectgaps,marker:n({symbol:r.symbol,opacity:r.opacity,angle:r.angle,angleref:n({},r.angleref,{values:["previous","up","north"]}),standoff:r.standoff,size:r.size,sizeref:r.sizeref,sizemin:r.sizemin,sizemode:r.sizemode,colorbar:r.colorbar,line:n({width:c.width},e("marker.line")),gradient:r.gradient},e("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:w.fillcolor,selected:w.selected,unselected:w.unselected,hoverinfo:n({},y.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:d()},"calc","nested")},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],979:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../constants/numerical").BADNUM,w=m("../scatter/colorscale_calc"),y=m("../scatter/arrays_to_calcdata"),e=m("../scatter/calc_selection"),t=m("../../lib")._;function n(o){return o&&typeof o=="string"}G.exports=function(o,r){var g,c=Array.isArray(r.locations),a=c?r.locations.length:r._length,h=new Array(a);g=r.geojson?function(x){return n(x)||d(x)}:n;for(var l=0;l<a;l++){var s=h[l]={};if(c){var p=r.locations[l];s.loc=g(p)?p:null}else{var u=r.lon[l],i=r.lat[l];d(u)&&d(i)?s.lonlat=[+u,+i]:s.lonlat=[v,v]}}return y(h,r),w(o,r),e(h,r),a&&(h[0].t={labels:{lat:t(o,"lat:")+" ",lon:t(o,"lon:")+" "}}),h}},{"../../constants/numerical":491,"../../lib":515,"../scatter/arrays_to_calcdata":935,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],980:[function(m,G,Y){var d=m("../../lib"),v=m("../scatter/subtypes"),w=m("../scatter/marker_defaults"),y=m("../scatter/line_defaults"),e=m("../scatter/text_defaults"),t=m("../scatter/fillcolor_defaults"),n=m("./attributes");G.exports=function(o,r,g,c){function a(x,f){return d.coerce(o,r,n,x,f)}var h,l=a("locations");if(l&&l.length){var s,p=a("geojson");(typeof p=="string"&&p!==""||d.isPlainObject(p))&&(s="geojson-id"),a("locationmode",s)==="geojson-id"&&a("featureidkey"),h=l.length}else{var u=a("lon")||[],i=a("lat")||[];h=Math.min(u.length,i.length)}h?(r._length=h,a("text"),a("hovertext"),a("hovertemplate"),a("mode"),v.hasLines(r)&&(y(o,r,g,c,a),a("connectgaps")),v.hasMarkers(r)&&w(o,r,g,c,a,{gradient:!0}),v.hasText(r)&&(a("texttemplate"),e(o,r,c,a)),a("fill"),r.fill!=="none"&&t(o,r,g,a),d.coerceSelectionMarkerOpacity(r,a)):r.visible=!1}},{"../../lib":515,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":978}],981:[function(m,G,Y){G.exports=function(d,v,w,y,e){d.lon=v.lon,d.lat=v.lat,d.location=v.loc?v.loc:null;var t=y[e];return t.fIn&&t.fIn.properties&&(d.properties=t.fIn.properties),d}},{}],982:[function(m,G,Y){var d=m("../../plots/cartesian/axes");G.exports=function(v,w,y){var e={},t=y[w.geo]._subplot.mockAxis,n=v.lonlat;return e.lonLabel=d.tickText(t,t.c2l(n[0]),!0).text,e.latLabel=d.tickText(t,t.c2l(n[1]),!0).text,e}},{"../../plots/cartesian/axes":566}],983:[function(m,G,Y){var d=m("../../components/fx"),v=m("../../constants/numerical").BADNUM,w=m("../scatter/get_trace_color"),y=m("../../lib").fillText,e=m("./attributes");G.exports=function(t,n,o){var r=t.cd,g=r[0].trace,c=t.xa,a=t.ya,h=t.subplot,l=h.projection.isLonLatOverEdges,s=h.project;if(d.getClosest(r,function(b){var T=b.lonlat;if(T[0]===v||l(T))return 1/0;var k=s(T),L=s([n,o]),A=Math.abs(k[0]-L[0]),I=Math.abs(k[1]-L[1]),P=Math.max(3,b.mrc||0);return Math.max(Math.sqrt(A*A+I*I)-P,1-3/P)},t),t.index!==!1){var p=r[t.index],u=p.lonlat,i=[c.c2p(u),a.c2p(u)],x=p.mrc||1;t.x0=i[0]-x,t.x1=i[0]+x,t.y0=i[1]-x,t.y1=i[1]+x,t.loc=p.loc,t.lon=u[0],t.lat=u[1];var f={};f[g.geo]={_subplot:h};var _=g._module.formatLabels(p,g,f);return t.lonLabel=_.lonLabel,t.latLabel=_.latLabel,t.color=w(g,p),t.extraText=function(b,T,k,L){if(b.hovertemplate)return;var A=T.hi||b.hoverinfo,I=A==="all"?e.hoverinfo.flags:A.split("+"),P=I.indexOf("location")!==-1&&Array.isArray(b.locations),S=I.indexOf("lon")!==-1,E=I.indexOf("lat")!==-1,z=I.indexOf("text")!==-1,D=[];function j(V){return V+"\xB0"}return P?D.push(T.loc):S&&E?D.push("("+j(k.latLabel)+", "+j(k.lonLabel)+")"):S?D.push(L.lon+j(k.lonLabel)):E&&D.push(L.lat+j(k.latLabel)),z&&y(T,b,D),D.join("<br>")}(g,p,t,r[0].t.labels),t.hovertemplate=g.hovertemplate,[t]}}},{"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../scatter/get_trace_color":946,"./attributes":978}],984:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../scatter/marker_colorbar"),formatLabels:m("./format_labels"),calc:m("./calc"),calcGeoJSON:m("./plot").calcGeoJSON,plot:m("./plot").plot,style:m("./style"),styleOnSelect:m("../scatter/style").styleOnSelect,hoverPoints:m("./hover"),eventData:m("./event_data"),selectPoints:m("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:m("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":598,"../scatter/marker_colorbar":954,"../scatter/style":960,"./attributes":978,"./calc":979,"./defaults":980,"./event_data":981,"./format_labels":982,"./hover":983,"./plot":985,"./select":986,"./style":987}],985:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../lib/topojson_utils").getTopojsonFeatures,y=m("../../lib/geojson_utils"),e=m("../../lib/geo_location_utils"),t=m("../../plots/cartesian/autorange").findExtremes,n=m("../../constants/numerical").BADNUM,o=m("../scatter/calc").calcMarkerSize,r=m("../scatter/subtypes"),g=m("./style");G.exports={calcGeoJSON:function(c,a){var h,l,s=c[0].trace,p=a[s.geo],u=p._subplot,i=s._length;if(Array.isArray(s.locations)){var x=s.locationmode,f=x==="geojson-id"?e.extractTraceFeature(c):w(s,u.topojson);for(h=0;h<i;h++){l=c[h];var _=x==="geojson-id"?l.fOut:e.locationToFeature(x,l.loc,f);l.lonlat=_?_.properties.ct:[n,n]}}var b,T,k={padded:!0};if(p.fitbounds==="geojson"&&s.locationmode==="geojson-id"){var L=e.computeBbox(e.getTraceGeojson(s));b=[L[0],L[2]],T=[L[1],L[3]]}else{for(b=new Array(i),T=new Array(i),h=0;h<i;h++)l=c[h],b[h]=l.lonlat[0],T[h]=l.lonlat[1];k.ppad=o(s,i)}s._extremes.lon=t(p.lonaxis._ax,b,k),s._extremes.lat=t(p.lataxis._ax,T,k)},plot:function(c,a,h){var l=a.layers.frontplot.select(".scatterlayer"),s=v.makeTraceGroups(l,h,"trace scattergeo");function p(u,i){u.lonlat[0]===n&&d.select(i).remove()}s.selectAll("*").remove(),s.each(function(u){var i=d.select(this),x=u[0].trace;if(r.hasLines(x)||x.fill!=="none"){var f=y.calcTraceToLineCoords(u),_=x.fill!=="none"?y.makePolygon(f):y.makeLine(f);i.selectAll("path.js-line").data([{geojson:_,trace:x}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}r.hasMarkers(x)&&i.selectAll("path.point").data(v.identity).enter().append("path").classed("point",!0).each(function(b){p(b,this)}),r.hasText(x)&&i.selectAll("g").data(v.identity).enter().append("g").append("text").each(function(b){p(b,this)}),g(c,u)})}}},{"../../constants/numerical":491,"../../lib":515,"../../lib/geo_location_utils":508,"../../lib/geojson_utils":509,"../../lib/topojson_utils":544,"../../plots/cartesian/autorange":565,"../scatter/calc":937,"../scatter/subtypes":961,"./style":987,"@plotly/d3":58}],986:[function(m,G,Y){var d=m("../scatter/subtypes"),v=m("../../constants/numerical").BADNUM;G.exports=function(w,y){var e,t,n,o,r,g=w.cd,c=w.xaxis,a=w.yaxis,h=[],l=g[0].trace;if(!d.hasMarkers(l)&&!d.hasText(l))return[];if(y===!1)for(r=0;r<g.length;r++)g[r].selected=0;else for(r=0;r<g.length;r++)(t=(e=g[r]).lonlat)[0]!==v&&(n=c.c2p(t),o=a.c2p(t),y.contains([n,o],null,r,w)?(h.push({pointNumber:r,lon:t[0],lat:t[1]}),e.selected=1):e.selected=0);return h}},{"../../constants/numerical":491,"../scatter/subtypes":961}],987:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../components/drawing"),w=m("../../components/color"),y=m("../scatter/style"),e=y.stylePoints,t=y.styleText;G.exports=function(n,o){o&&function(r,g){var c=g[0].trace,a=g[0].node3;a.style("opacity",g[0].trace.opacity),e(a,c,r),t(a,c,r),a.selectAll("path.js-line").style("fill","none").each(function(h){var l=d.select(this),s=h.trace,p=s.line||{};l.call(w.stroke,p.color).call(v.dashLine,p.dash||"",p.width||0),s.fill!=="none"&&l.call(w.fill,s.fillcolor)})}(n,o)}},{"../../components/color":367,"../../components/drawing":389,"../scatter/style":960,"@plotly/d3":58}],988:[function(m,G,Y){var d=m("../../plots/attributes"),v=m("../scatter/attributes"),w=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,y=m("../../components/colorscale/attributes"),e=m("../../lib/sort_object_keys"),t=m("../../lib/extend").extendFlat,n=m("../../plot_api/edit_types").overrideAll,o=m("./constants").DASHES,r=v.line,g=v.marker,c=g.line,a=G.exports=n({x:v.x,x0:v.x0,dx:v.dx,y:v.y,y0:v.y0,dy:v.dy,xperiod:v.xperiod,yperiod:v.yperiod,xperiod0:v.xperiod0,yperiod0:v.yperiod0,xperiodalignment:v.xperiodalignment,yperiodalignment:v.yperiodalignment,xhoverformat:w("x"),yhoverformat:w("y"),text:v.text,hovertext:v.hovertext,textposition:v.textposition,textfont:v.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:r.color,width:r.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:e(o),dflt:"solid"}},marker:t({},y("marker"),{symbol:g.symbol,angle:g.angle,size:g.size,sizeref:g.sizeref,sizemin:g.sizemin,sizemode:g.sizemode,opacity:g.opacity,colorbar:g.colorbar,line:t({},y("marker.line"),{width:c.width})}),connectgaps:v.connectgaps,fill:t({},v.fill,{dflt:"none"}),fillcolor:v.fillcolor,selected:{marker:v.selected.marker,textfont:v.selected.textfont},unselected:{marker:v.unselected.marker,textfont:v.unselected.textfont},opacity:d.opacity},"calc","nested");a.x.editType=a.y.editType=a.x0.editType=a.y0.editType="calc+clearAxisTypes",a.hovertemplate=v.hovertemplate,a.texttemplate=v.texttemplate},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../lib/sort_object_keys":538,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../scatter/attributes":936,"./constants":991}],989:[function(m,G,Y){var d=m("./hover");G.exports={moduleType:"trace",name:"scattergl",basePlotModule:m("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:m("./attributes"),supplyDefaults:m("./defaults"),crossTraceDefaults:m("../scatter/cross_trace_defaults"),colorbar:m("../scatter/marker_colorbar"),formatLabels:m("./format_labels"),calc:m("./calc"),hoverPoints:d.hoverPoints,selectPoints:m("./select"),meta:{}}},{"../../plots/cartesian":578,"../scatter/cross_trace_defaults":942,"../scatter/marker_colorbar":954,"./attributes":988,"./calc":990,"./defaults":993,"./format_labels":995,"./hover":997,"./select":1001}],990:[function(m,G,Y){var d=m("@plotly/point-cluster"),v=m("../../lib"),w=m("../../plots/cartesian/axis_ids"),y=m("../../plots/cartesian/autorange").findExtremes,e=m("../../plots/cartesian/align_period"),t=m("../scatter/calc"),n=t.calcMarkerSize,o=t.calcAxisExpansion,r=t.setFirstScatter,g=m("../scatter/colorscale_calc"),c=m("./convert"),a=m("./scene_update"),h=m("../../constants/numerical").BADNUM,l=m("./constants").TOO_MANY_POINTS;function s(p,u,i){var x=p._extremes[u._id],f=y(u,i._bnds,{padded:!0});x.min=x.min.concat(f.min),x.max=x.max.concat(f.max)}G.exports=function(p,u){var i,x=p._fullLayout,f=u._xA=w.getFromId(p,u.xaxis,"x"),_=u._yA=w.getFromId(p,u.yaxis,"y"),b=x._plots[u.xaxis+u.yaxis],T=u._length,k=T>=l,L=2*T,A={},I=f.makeCalcdata(u,"x"),P=_.makeCalcdata(u,"y"),S=e(u,f,"x",I),E=e(u,_,"y",P),z=S.vals,D=E.vals;u._x=z,u._y=D,u.xperiodalignment&&(u._origX=I,u._xStarts=S.starts,u._xEnds=S.ends),u.yperiodalignment&&(u._origY=P,u._yStarts=E.starts,u._yEnds=E.ends);var j=new Array(L),V=new Array(T);for(i=0;i<T;i++)j[2*i]=z[i]===h?NaN:z[i],j[2*i+1]=D[i]===h?NaN:D[i],V[i]=i;if(f.type==="log")for(i=0;i<L;i+=2)j[i]=f.c2l(j[i]);if(_.type==="log")for(i=1;i<L;i+=2)j[i]=_.c2l(j[i]);k&&f.type!=="log"&&_.type!=="log"?A.tree=d(j):A.ids=V,g(p,u);var Z,Q=function($,re,H,N,U,te){var B=c.style($,H);if(B.marker&&(B.marker.positions=N),B.line&&N.length>1&&v.extendFlat(B.line,c.linePositions($,H,N)),B.errorX||B.errorY){var K=c.errorBarPositions($,H,N,U,te);B.errorX&&v.extendFlat(B.errorX,K.x),B.errorY&&v.extendFlat(B.errorY,K.y)}return B.text&&(v.extendFlat(B.text,{positions:N},c.textPosition($,H,B.text,B.marker)),v.extendFlat(B.textSel,{positions:N},c.textPosition($,H,B.text,B.markerSel)),v.extendFlat(B.textUnsel,{positions:N},c.textPosition($,H,B.text,B.markerUnsel))),B}(p,0,u,j,z,D),X=a(p,b);return r(x,u),k?Q.marker&&(Z=Q.marker.sizeAvg||Math.max(Q.marker.size,3)):Z=n(u,T),o(p,u,f,_,z,D,Z),Q.errorX&&s(u,f,Q.errorX),Q.errorY&&s(u,_,Q.errorY),Q.fill&&!X.fill2d&&(X.fill2d=!0),Q.marker&&!X.scatter2d&&(X.scatter2d=!0),Q.line&&!X.line2d&&(X.line2d=!0),!Q.errorX&&!Q.errorY||X.error2d||(X.error2d=!0),Q.text&&!X.glText&&(X.glText=!0),Q.marker&&(Q.marker.snap=T),X.lineOptions.push(Q.line),X.errorXOptions.push(Q.errorX),X.errorYOptions.push(Q.errorY),X.fillOptions.push(Q.fill),X.markerOptions.push(Q.marker),X.markerSelectedOptions.push(Q.markerSel),X.markerUnselectedOptions.push(Q.markerUnsel),X.textOptions.push(Q.text),X.textSelectedOptions.push(Q.textSel),X.textUnselectedOptions.push(Q.textUnsel),X.selectBatch.push([]),X.unselectBatch.push([]),A._scene=X,A.index=X.count,A.x=z,A.y=D,A.positions=j,X.count++,[{x:!1,y:!1,t:A,trace:u}]}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/autorange":565,"../../plots/cartesian/axis_ids":570,"../scatter/calc":937,"../scatter/colorscale_calc":939,"./constants":991,"./convert":992,"./scene_update":1e3,"@plotly/point-cluster":59}],991:[function(m,G,Y){G.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:20,SYMBOL_STROKE:1,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],992:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("svg-path-sdf"),w=m("color-normalize"),y=m("../../registry"),e=m("../../lib"),t=m("../../components/drawing"),n=m("../../plots/cartesian/axis_ids"),o=m("../../lib/gl_format_color").formatColor,r=m("../scatter/subtypes"),g=m("../scatter/make_bubble_size_func"),c=m("./helpers"),a=m("./constants"),h=m("../../constants/interactions").DESELECTDIM,l={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},s=m("../../components/fx/helpers").appendArrayPointValue;function p(I,P){var S,E=I._fullLayout,z=P._length,D=P.textfont,j=P.textposition,V=Array.isArray(j)?j:[j],Z=D.color,Q=D.size,X=D.family,$={},re=I._context.plotGlPixelRatio,H=P.texttemplate;if(H){$.text=[];var N=E._d3locale,U=Array.isArray(H),te=U?Math.min(H.length,z):z,B=U?function(me){return H[me]}:function(){return H};for(S=0;S<te;S++){var K={i:S},J=P._module.formatLabels(K,P,E),ee={};s(ee,P,S);var ne=P._meta||{};$.text.push(e.texttemplateString(B(S),J,N,ee,K,ne))}}else Array.isArray(P.text)&&P.text.length<z?$.text=P.text.slice():$.text=P.text;if(Array.isArray($.text))for(S=$.text.length;S<z;S++)$.text[S]="";for($.opacity=P.opacity,$.font={},$.align=[],$.baseline=[],S=0;S<V.length;S++){var se=V[S].split(/\s+/);switch(se[1]){case"left":$.align.push("right");break;case"right":$.align.push("left");break;default:$.align.push(se[1])}switch(se[0]){case"top":$.baseline.push("bottom");break;case"bottom":$.baseline.push("top");break;default:$.baseline.push(se[0])}}if(Array.isArray(Z))for($.color=new Array(z),S=0;S<z;S++)$.color[S]=Z[S];else $.color=Z;if(e.isArrayOrTypedArray(Q)||Array.isArray(X))for($.font=new Array(z),S=0;S<z;S++){var oe=$.font[S]={};oe.size=(e.isTypedArray(Q)?Q[S]:Array.isArray(Q)?d(Q[S])?Q[S]:0:Q)*re,oe.family=Array.isArray(X)?X[S]:X}else $.font={size:Q*re,family:X};return $}function u(I,P){var S,E,z=P._length,D=P.marker,j={},V=e.isArrayOrTypedArray(D.symbol),Z=e.isArrayOrTypedArray(D.angle),Q=e.isArrayOrTypedArray(D.color),X=e.isArrayOrTypedArray(D.line.color),$=e.isArrayOrTypedArray(D.opacity),re=e.isArrayOrTypedArray(D.size),H=e.isArrayOrTypedArray(D.line.width);if(V||(E=c.isOpenSymbol(D.symbol)),V||Q||X||$||Z){j.symbols=new Array(z),j.angles=new Array(z),j.colors=new Array(z),j.borderColors=new Array(z);var N=D.symbol,U=D.angle,te=o(D,D.opacity,z),B=o(D.line,D.opacity,z);if(!Array.isArray(B[0])){var K=B;for(B=Array(z),S=0;S<z;S++)B[S]=K}if(!Array.isArray(te[0])){var J=te;for(te=Array(z),S=0;S<z;S++)te[S]=J}if(!Array.isArray(N)){var ee=N;for(N=Array(z),S=0;S<z;S++)N[S]=ee}if(!Array.isArray(U)){var ne=U;for(U=Array(z),S=0;S<z;S++)U[S]=ne}for(j.symbols=N,j.angles=U,j.colors=te,j.borderColors=B,S=0;S<z;S++)V&&(E=c.isOpenSymbol(D.symbol[S])),E&&(B[S]=te[S].slice(),te[S]=te[S].slice(),te[S][3]=0);for(j.opacity=P.opacity,j.markers=new Array(z),S=0;S<z;S++)j.markers[S]=A({mx:j.symbols[S],ma:j.angles[S]},P)}else E?(j.color=w(D.color,"uint8"),j.color[3]=0,j.borderColor=w(D.color,"uint8")):(j.color=w(D.color,"uint8"),j.borderColor=w(D.line.color,"uint8")),j.opacity=P.opacity*D.opacity,j.marker=A({mx:D.symbol,ma:D.angle},P);var se,oe=g(P,1);if(re||H){var me,ce=j.sizes=new Array(z),ye=j.borderSizes=new Array(z),Se=0;if(re){for(S=0;S<z;S++)ce[S]=oe(D.size[S]),Se+=ce[S];me=Se/z}else for(se=oe(D.size),S=0;S<z;S++)ce[S]=se;if(H)for(S=0;S<z;S++)ye[S]=D.line.width[S];else for(se=D.line.width,S=0;S<z;S++)ye[S]=se;j.sizeAvg=me}else j.size=oe(D&&D.size||10),j.borderSizes=oe(D.line.width);return j}function i(I,P,S){var E=P.marker,z={};return S&&(S.marker&&S.marker.symbol?z=u(0,e.extendFlat({},E,S.marker)):S.marker&&(S.marker.size&&(z.size=S.marker.size),S.marker.color&&(z.colors=S.marker.color),S.marker.opacity!==void 0&&(z.opacity=S.marker.opacity))),z}function x(I,P,S){var E={};if(!S)return E;if(S.textfont){var z={opacity:1,text:P.text,texttemplate:P.texttemplate,textposition:P.textposition,textfont:e.extendFlat({},P.textfont)};S.textfont&&e.extendFlat(z.textfont,S.textfont),E=p(I,z)}return E}function f(I,P,S){var E={capSize:2*P.width*S,lineWidth:P.thickness*S,color:P.color};return P.copy_ystyle&&(E=I.error_y),E}var _=a.SYMBOL_SDF_SIZE,b=a.SYMBOL_SIZE,T=a.SYMBOL_STROKE,k={},L=t.symbolFuncs[0](.05*b);function A(I,P){var S,E,z=I.mx;if(z==="circle")return null;var D=t.symbolNumber(z),j=t.symbolFuncs[D%100],V=!!t.symbolNoDot[D%100],Z=!!t.symbolNoFill[D%100],Q=c.isDotSymbol(z);if(I.ma&&(z+="_"+I.ma),k[z])return k[z];var X=t.getMarkerAngle(I,P);return S=Q&&!V?j(1.1*b,X)+L:j(b,X),E=v(S,{w:_,h:_,viewBox:[-b,-b,b,b],stroke:Z?T:-T}),k[z]=E,E||null}G.exports={style:function(I,P){var S,E={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0},z=I._context.plotGlPixelRatio;if(P.visible!==!0)return E;if(r.hasText(P)&&(E.text=p(I,P),E.textSel=x(I,P,P.selected),E.textUnsel=x(I,P,P.unselected)),r.hasMarkers(P)&&(E.marker=u(I,P),E.markerSel=i(I,P,P.selected),E.markerUnsel=i(I,P,P.unselected),!P.unselected&&e.isArrayOrTypedArray(P.marker.opacity))){var D=P.marker.opacity;for(E.markerUnsel.opacity=new Array(D.length),S=0;S<D.length;S++)E.markerUnsel.opacity[S]=h*D[S]}if(r.hasLines(P)){E.line={overlay:!0,thickness:P.line.width*z,color:P.line.color,opacity:P.opacity};var j=(a.DASHES[P.line.dash]||[1]).slice();for(S=0;S<j.length;++S)j[S]*=P.line.width*z;E.line.dashes=j}return P.error_x&&P.error_x.visible&&(E.errorX=f(P,P.error_x,z)),P.error_y&&P.error_y.visible&&(E.errorY=f(P,P.error_y,z)),P.fill&&P.fill!=="none"&&(E.fill={closed:!0,fill:P.fillcolor,thickness:0}),E},markerStyle:u,markerSelection:i,linePositions:function(I,P,S){var E,z,D=S.length,j=D/2;if(r.hasLines(P)&&j)if(P.line.shape==="hv"){for(E=[],z=0;z<j-1;z++)isNaN(S[2*z])||isNaN(S[2*z+1])?E.push(NaN,NaN,NaN,NaN):(E.push(S[2*z],S[2*z+1]),isNaN(S[2*z+2])||isNaN(S[2*z+3])?E.push(NaN,NaN):E.push(S[2*z+2],S[2*z+1]));E.push(S[D-2],S[D-1])}else if(P.line.shape==="hvh"){for(E=[],z=0;z<j-1;z++)if(isNaN(S[2*z])||isNaN(S[2*z+1])||isNaN(S[2*z+2])||isNaN(S[2*z+3]))isNaN(S[2*z])||isNaN(S[2*z+1])?E.push(NaN,NaN):E.push(S[2*z],S[2*z+1]),E.push(NaN,NaN);else{var V=(S[2*z]+S[2*z+2])/2;E.push(S[2*z],S[2*z+1],V,S[2*z+1],V,S[2*z+3])}E.push(S[D-2],S[D-1])}else if(P.line.shape==="vhv"){for(E=[],z=0;z<j-1;z++)if(isNaN(S[2*z])||isNaN(S[2*z+1])||isNaN(S[2*z+2])||isNaN(S[2*z+3]))isNaN(S[2*z])||isNaN(S[2*z+1])?E.push(NaN,NaN):E.push(S[2*z],S[2*z+1]),E.push(NaN,NaN);else{var Z=(S[2*z+1]+S[2*z+3])/2;E.push(S[2*z],S[2*z+1],S[2*z],Z,S[2*z+2],Z)}E.push(S[D-2],S[D-1])}else if(P.line.shape==="vh"){for(E=[],z=0;z<j-1;z++)isNaN(S[2*z])||isNaN(S[2*z+1])?E.push(NaN,NaN,NaN,NaN):(E.push(S[2*z],S[2*z+1]),isNaN(S[2*z+2])||isNaN(S[2*z+3])?E.push(NaN,NaN):E.push(S[2*z],S[2*z+3]));E.push(S[D-2],S[D-1])}else E=S;var Q=!1;for(z=0;z<E.length;z++)if(isNaN(E[z])){Q=!0;break}var X=Q||E.length>a.TOO_MANY_POINTS||r.hasMarkers(P)?"rect":"round";if(Q&&P.connectgaps){var $=E[0],re=E[1];for(z=0;z<E.length;z+=2)isNaN(E[z])||isNaN(E[z+1])?(E[z]=$,E[z+1]=re):($=E[z],re=E[z+1])}return{join:X,positions:E}},errorBarPositions:function(I,P,S,E,z){var D=y.getComponentMethod("errorbars","makeComputeError"),j=n.getFromId(I,P.xaxis,"x"),V=n.getFromId(I,P.yaxis,"y"),Z=S.length/2,Q={};function X($,re){var H=re._id.charAt(0),N=P["error_"+H];if(N&&N.visible&&(re.type==="linear"||re.type==="log")){for(var U=D(N),te={x:0,y:1}[H],B={x:[0,1,2,3],y:[2,3,0,1]}[H],K=new Float64Array(4*Z),J=1/0,ee=-1/0,ne=0,se=0;ne<Z;ne++,se+=4){var oe=$[ne];if(d(oe)){var me=S[2*ne+te],ce=U(oe,ne),ye=ce[0],Se=ce[1];if(d(ye)&&d(Se)){var fe=oe-ye,ge=oe+Se;K[se+B[0]]=me-re.c2l(fe),K[se+B[1]]=re.c2l(ge)-me,K[se+B[2]]=0,K[se+B[3]]=0,J=Math.min(J,oe-ye),ee=Math.max(ee,oe+Se)}}}Q[H]={positions:S,errors:K,_bnds:[J,ee]}}}return X(E,j),X(z,V),Q},textPosition:function(I,P,S,E){var z,D=P._length,j={};if(r.hasMarkers(P)){var V=S.font,Z=S.align,Q=S.baseline;for(j.offset=new Array(D),z=0;z<D;z++){var X=E.sizes?E.sizes[z]:E.size,$=Array.isArray(V)?V[z].size:V.size,re=Array.isArray(Z)?Z.length>1?Z[z]:Z[0]:Z,H=Array.isArray(Q)?Q.length>1?Q[z]:Q[0]:Q,N=l[re],U=l[H],te=X?X/.8+1:0,B=-U*te-.5*U;j.offset[z]=[N*te/$,B/$]}}return j}}},{"../../components/drawing":389,"../../components/fx/helpers":403,"../../constants/interactions":490,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/cartesian/axis_ids":570,"../../registry":647,"../scatter/make_bubble_size_func":953,"../scatter/subtypes":961,"./constants":991,"./helpers":996,"color-normalize":89,"fast-isnumeric":190,"svg-path-sdf":311}],993:[function(m,G,Y){var d=m("../../lib"),v=m("../../registry"),w=m("./helpers"),y=m("./attributes"),e=m("../scatter/constants"),t=m("../scatter/subtypes"),n=m("../scatter/xy_defaults"),o=m("../scatter/period_defaults"),r=m("../scatter/marker_defaults"),g=m("../scatter/line_defaults"),c=m("../scatter/fillcolor_defaults"),a=m("../scatter/text_defaults");G.exports=function(h,l,s,p){function u(L,A){return d.coerce(h,l,y,L,A)}var i=!!h.marker&&w.isOpenSymbol(h.marker.symbol),x=t.isBubble(h),f=n(h,l,p,u);if(f){o(h,l,p,u),u("xhoverformat"),u("yhoverformat");var _=f<e.PTS_LINESONLY?"lines+markers":"lines";u("text"),u("hovertext"),u("hovertemplate"),u("mode",_),t.hasLines(l)&&(u("connectgaps"),g(h,l,s,p,u),u("line.shape")),t.hasMarkers(l)&&(r(h,l,s,p,u,{noAngleRef:!0,noStandOff:!0}),u("marker.line.width",i||x?1:0)),t.hasText(l)&&(u("texttemplate"),a(h,l,p,u));var b=(l.line||{}).color,T=(l.marker||{}).color;u("fill"),l.fill!=="none"&&c(h,l,s,u);var k=v.getComponentMethod("errorbars","supplyDefaults");k(h,l,b||T||s,{axis:"y"}),k(h,l,b||T||s,{axis:"x",inherit:"y"}),d.coerceSelectionMarkerOpacity(l,u)}else l.visible=!1}},{"../../lib":515,"../../registry":647,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/period_defaults":956,"../scatter/subtypes":961,"../scatter/text_defaults":962,"../scatter/xy_defaults":963,"./attributes":988,"./helpers":996}],994:[function(m,G,Y){var d=m("../../lib"),v=m("../../components/color"),w=m("../../constants/interactions").DESELECTDIM;G.exports={styleTextSelection:function(y){var e,t,n=y[0],o=n.trace,r=n.t,g=r._scene,c=r.index,a=g.selectBatch[c],h=g.unselectBatch[c],l=g.textOptions[c],s=g.textSelectedOptions[c]||{},p=g.textUnselectedOptions[c]||{},u=d.extendFlat({},l);if(a.length||h.length){var i=s.color,x=p.color,f=l.color,_=Array.isArray(f);for(u.color=new Array(o._length),e=0;e<a.length;e++)t=a[e],u.color[t]=i||(_?f[t]:f);for(e=0;e<h.length;e++){t=h[e];var b=_?f[t]:f;u.color[t]=x||(i?b:v.addOpacity(b,w))}}g.glText[c].update(u)}}},{"../../components/color":367,"../../constants/interactions":490,"../../lib":515}],995:[function(m,G,Y){var d=m("../scatter/format_labels");G.exports=function(v,w,y){var e=v.i;return"x"in v||(v.x=w._x[e]),"y"in v||(v.y=w._y[e]),d(v,w,y)}},{"../scatter/format_labels":945}],996:[function(m,G,Y){var d=m("./constants");Y.isOpenSymbol=function(v){return typeof v=="string"?d.OPEN_RE.test(v):v%200>100},Y.isDotSymbol=function(v){return typeof v=="string"?d.DOT_RE.test(v):v>200}},{"./constants":991}],997:[function(m,G,Y){var d=m("../../registry"),v=m("../../lib"),w=m("../scatter/get_trace_color");function y(e,t,n,o){var r=e.xa,g=e.ya,c=e.distance,a=e.dxy,h=e.index,l={pointNumber:h,x:t[h],y:n[h]};l.tx=Array.isArray(o.text)?o.text[h]:o.text,l.htx=Array.isArray(o.hovertext)?o.hovertext[h]:o.hovertext,l.data=Array.isArray(o.customdata)?o.customdata[h]:o.customdata,l.tp=Array.isArray(o.textposition)?o.textposition[h]:o.textposition;var s=o.textfont;s&&(l.ts=v.isArrayOrTypedArray(s.size)?s.size[h]:s.size,l.tc=Array.isArray(s.color)?s.color[h]:s.color,l.tf=Array.isArray(s.family)?s.family[h]:s.family);var p=o.marker;p&&(l.ms=v.isArrayOrTypedArray(p.size)?p.size[h]:p.size,l.mo=v.isArrayOrTypedArray(p.opacity)?p.opacity[h]:p.opacity,l.mx=v.isArrayOrTypedArray(p.symbol)?p.symbol[h]:p.symbol,l.ma=v.isArrayOrTypedArray(p.angle)?p.angle[h]:p.angle,l.mc=v.isArrayOrTypedArray(p.color)?p.color[h]:p.color);var u=p&&p.line;u&&(l.mlc=Array.isArray(u.color)?u.color[h]:u.color,l.mlw=v.isArrayOrTypedArray(u.width)?u.width[h]:u.width);var i=p&&p.gradient;i&&i.type!=="none"&&(l.mgt=Array.isArray(i.type)?i.type[h]:i.type,l.mgc=Array.isArray(i.color)?i.color[h]:i.color);var x=r.c2p(l.x,!0),f=g.c2p(l.y,!0),_=l.mrc||1,b=o.hoverlabel;b&&(l.hbg=Array.isArray(b.bgcolor)?b.bgcolor[h]:b.bgcolor,l.hbc=Array.isArray(b.bordercolor)?b.bordercolor[h]:b.bordercolor,l.hts=v.isArrayOrTypedArray(b.font.size)?b.font.size[h]:b.font.size,l.htc=Array.isArray(b.font.color)?b.font.color[h]:b.font.color,l.htf=Array.isArray(b.font.family)?b.font.family[h]:b.font.family,l.hnl=v.isArrayOrTypedArray(b.namelength)?b.namelength[h]:b.namelength);var T=o.hoverinfo;T&&(l.hi=Array.isArray(T)?T[h]:T);var k=o.hovertemplate;k&&(l.ht=Array.isArray(k)?k[h]:k);var L={};L[e.index]=l;var A=o._origX,I=o._origY,P=v.extendFlat({},e,{color:w(o,l),x0:x-_,x1:x+_,xLabelVal:A?A[h]:l.x,y0:f-_,y1:f+_,yLabelVal:I?I[h]:l.y,cd:L,distance:c,spikeDistance:a,hovertemplate:l.ht});return l.htx?P.text=l.htx:l.tx?P.text=l.tx:o.text&&(P.text=o.text),v.fillText(l,o,P),d.getComponentMethod("errorbars","hoverInfo")(l,o,P),P}G.exports={hoverPoints:function(e,t,n,o){var r,g,c,a,h,l,s,p,u,i,x=e.cd,f=x[0].t,_=x[0].trace,b=e.xa,T=e.ya,k=f.x,L=f.y,A=b.c2p(t),I=T.c2p(n),P=e.distance;if(f.tree){var S=b.p2c(A-P),E=b.p2c(A+P),z=T.p2c(I-P),D=T.p2c(I+P);r=o==="x"?f.tree.range(Math.min(S,E),Math.min(T._rl[0],T._rl[1]),Math.max(S,E),Math.max(T._rl[0],T._rl[1])):f.tree.range(Math.min(S,E),Math.min(z,D),Math.max(S,E),Math.max(z,D))}else r=f.ids;var j=P;if(o==="x"){var V=!!_.xperiodalignment,Z=!!_.yperiodalignment;for(l=0;l<r.length;l++){if(a=k[g=r[l]],s=Math.abs(b.c2p(a)-A),V){var Q=b.c2p(_._xStarts[g]),X=b.c2p(_._xEnds[g]);s=A>=Math.min(Q,X)&&A<=Math.max(Q,X)?0:1/0}if(s<j){if(j=s,h=L[g],p=T.c2p(h)-I,Z){var $=T.c2p(_._yStarts[g]),re=T.c2p(_._yEnds[g]);p=I>=Math.min($,re)&&I<=Math.max($,re)?0:1/0}i=Math.sqrt(s*s+p*p),c=r[l]}}}else for(l=r.length-1;l>-1;l--)a=k[g=r[l]],h=L[g],s=b.c2p(a)-A,p=T.c2p(h)-I,(u=Math.sqrt(s*s+p*p))<j&&(j=i=u,c=g);return e.index=c,e.distance=j,e.dxy=i,c===void 0?[e]:[y(e,k,L,_)]},calcHover:y}},{"../../lib":515,"../../registry":647,"../scatter/get_trace_color":946}],998:[function(m,G,Y){arguments[4][905][0].apply(Y,arguments)},{"./base_index":989,"./plot":999,dup:905}],999:[function(m,G,Y){var d=m("regl-scatter2d"),v=m("regl-line2d"),w=m("regl-error2d"),y=m("gl-text"),e=m("../../lib"),t=m("../../components/dragelement/helpers").selectMode,n=m("../../lib/prepare_regl"),o=m("../scatter/subtypes"),r=m("../scatter/link_traces"),g=m("./edit_style").styleTextSelection,c={};function a(h,l,s,p){var u=h._size,i=h.width*p,x=h.height*p,f=u.l*p,_=u.b*p,b=u.r*p,T=u.t*p,k=u.w*p,L=u.h*p;return[f+l.domain[0]*k,_+s.domain[0]*L,i-b-(1-l.domain[1])*k,x-T-(1-s.domain[1])*L]}(G.exports=function(h,l,s){if(s.length){var p,u,i=h._fullLayout,x=l._scene,f=l.xaxis,_=l.yaxis;if(x)if(n(h,["ANGLE_instanced_arrays","OES_element_index_uint"],c)){var b=x.count,T=i._glcanvas.data()[0].regl;if(r(h,l,s),x.dirty){if(x.error2d===!0&&(x.error2d=w(T)),x.line2d===!0&&(x.line2d=v(T)),x.scatter2d===!0&&(x.scatter2d=d(T)),x.fill2d===!0&&(x.fill2d=v(T)),x.glText===!0)for(x.glText=new Array(b),p=0;p<b;p++)x.glText[p]=new y(T);if(x.glText){if(b>x.glText.length){var k=b-x.glText.length;for(p=0;p<k;p++)x.glText.push(new y(T))}else if(b<x.glText.length){var L=x.glText.length-b;x.glText.splice(b,L).forEach(function(K){K.destroy()})}for(p=0;p<b;p++)x.glText[p].update(x.textOptions[p])}if(x.line2d&&(x.line2d.update(x.lineOptions),x.lineOptions=x.lineOptions.map(function(K){if(K&&K.positions){for(var J=K.positions,ee=0;ee<J.length&&(isNaN(J[ee])||isNaN(J[ee+1]));)ee+=2;for(var ne=J.length-2;ne>ee&&(isNaN(J[ne])||isNaN(J[ne+1]));)ne-=2;K.positions=J.slice(ee,ne+2)}return K}),x.line2d.update(x.lineOptions)),x.error2d){var A=(x.errorXOptions||[]).concat(x.errorYOptions||[]);x.error2d.update(A)}x.scatter2d&&x.scatter2d.update(x.markerOptions),x.fillOrder=e.repeat(null,b),x.fill2d&&(x.fillOptions=x.fillOptions.map(function(K,J){var ee=s[J];if(K&&ee&&ee[0]&&ee[0].trace){var ne,se,oe=ee[0],me=oe.trace,ce=oe.t,ye=x.lineOptions[J],Se=[];me._ownfill&&Se.push(J),me._nexttrace&&Se.push(J+1),Se.length&&(x.fillOrder[J]=Se);var fe,ge,Te=[],le=ye&&ye.positions||ce.positions;if(me.fill==="tozeroy"){for(fe=0;fe<le.length&&isNaN(le[fe+1]);)fe+=2;for(ge=le.length-2;ge>fe&&isNaN(le[ge+1]);)ge-=2;le[fe+1]!==0&&(Te=[le[fe],0]),Te=Te.concat(le.slice(fe,ge+2)),le[ge+1]!==0&&(Te=Te.concat([le[ge],0]))}else if(me.fill==="tozerox"){for(fe=0;fe<le.length&&isNaN(le[fe]);)fe+=2;for(ge=le.length-2;ge>fe&&isNaN(le[ge]);)ge-=2;le[fe]!==0&&(Te=[0,le[fe+1]]),Te=Te.concat(le.slice(fe,ge+2)),le[ge]!==0&&(Te=Te.concat([0,le[ge+1]]))}else if(me.fill==="toself"||me.fill==="tonext"){for(Te=[],ne=0,K.splitNull=!0,se=0;se<le.length;se+=2)(isNaN(le[se])||isNaN(le[se+1]))&&((Te=Te.concat(le.slice(ne,se))).push(le[ne],le[ne+1]),Te.push(null,null),ne=se+2);Te=Te.concat(le.slice(ne)),ne&&Te.push(le[ne],le[ne+1])}else{var ve=me._nexttrace;if(ve){var Me=x.lineOptions[J+1];if(Me){var we=Me.positions;if(me.fill==="tonexty"){for(Te=le.slice(),J=Math.floor(we.length/2);J--;){var de=we[2*J],Ie=we[2*J+1];isNaN(de)||isNaN(Ie)||Te.push(de,Ie)}K.fill=ve.fillcolor}}}}if(me._prevtrace&&me._prevtrace.fill==="tonext"){var De=x.lineOptions[J-1].positions,Oe=Te.length/2,Ve=[ne=Oe];for(se=0;se<De.length;se+=2)(isNaN(De[se])||isNaN(De[se+1]))&&(Ve.push(se/2+Oe+1),ne=se+2);Te=Te.concat(De),K.hole=Ve}return K.fillmode=me.fill,K.opacity=me.opacity,K.positions=Te,K}}),x.fill2d.update(x.fillOptions))}var I=i.dragmode,P=t(I),S=i.clickmode.indexOf("select")>-1;for(p=0;p<b;p++){var E=s[p][0],z=E.trace,D=E.t,j=D.index,V=z._length,Z=D.x,Q=D.y;if(z.selectedpoints||P||S){if(P||(P=!0),z.selectedpoints){var X=x.selectBatch[j]=e.selIndices2selPoints(z),$={};for(u=0;u<X.length;u++)$[X[u]]=1;var re=[];for(u=0;u<V;u++)$[u]||re.push(u);x.unselectBatch[j]=re}var H=D.xpx=new Array(V),N=D.ypx=new Array(V);for(u=0;u<V;u++)H[u]=f.c2p(Z[u]),N[u]=_.c2p(Q[u])}else D.xpx=D.ypx=null}if(P){if(x.select2d||(x.select2d=d(i._glcanvas.data()[1].regl)),x.scatter2d){var U=new Array(b);for(p=0;p<b;p++)U[p]=x.selectBatch[p].length||x.unselectBatch[p].length?x.markerUnselectedOptions[p]:{};x.scatter2d.update(U)}x.select2d&&(x.select2d.update(x.markerOptions),x.select2d.update(x.markerSelectedOptions)),x.glText&&s.forEach(function(K){var J=((K||[])[0]||{}).trace||{};o.hasText(J)&&g(K)})}else x.scatter2d&&x.scatter2d.update(x.markerOptions);var te={viewport:a(i,f,_,h._context.plotGlPixelRatio),range:[(f._rl||f.range)[0],(_._rl||_.range)[0],(f._rl||f.range)[1],(_._rl||_.range)[1]]},B=e.repeat(te,x.count);x.fill2d&&x.fill2d.update(B),x.line2d&&x.line2d.update(B),x.error2d&&x.error2d.update(B.concat(B)),x.scatter2d&&x.scatter2d.update(B),x.select2d&&x.select2d.update(B),x.glText&&x.glText.forEach(function(K){K.update(te)})}else x.init()}}).reglPrecompiled=c},{"../../components/dragelement/helpers":385,"../../lib":515,"../../lib/prepare_regl":528,"../scatter/link_traces":952,"../scatter/subtypes":961,"./edit_style":994,"gl-text":225,"regl-error2d":280,"regl-line2d":281,"regl-scatter2d":282}],1e3:[function(m,G,Y){var d=m("../../lib");G.exports=function(v,w){var y=w._scene,e={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},t={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return w._scene||((y=w._scene={}).init=function(){d.extendFlat(y,t,e)},y.init(),y.update=function(n){var o=d.repeat(n,y.count);if(y.fill2d&&y.fill2d.update(o),y.scatter2d&&y.scatter2d.update(o),y.line2d&&y.line2d.update(o),y.error2d&&y.error2d.update(o.concat(o)),y.select2d&&y.select2d.update(o),y.glText)for(var r=0;r<y.count;r++)y.glText[r].update(n)},y.draw=function(){for(var n=y.count,o=y.fill2d,r=y.error2d,g=y.line2d,c=y.scatter2d,a=y.glText,h=y.select2d,l=y.selectBatch,s=y.unselectBatch,p=0;p<n;p++){if(o&&y.fillOrder[p]&&o.draw(y.fillOrder[p]),g&&y.lineOptions[p]&&g.draw(p),r&&(y.errorXOptions[p]&&r.draw(p),y.errorYOptions[p]&&r.draw(p+n)),c&&y.markerOptions[p])if(s[p].length){var u=d.repeat([],y.count);u[p]=s[p],c.draw(u)}else l[p].length||c.draw(p);a[p]&&y.textOptions[p]&&a[p].render()}h&&h.draw(l),y.dirty=!1},y.destroy=function(){y.fill2d&&y.fill2d.destroy&&y.fill2d.destroy(),y.scatter2d&&y.scatter2d.destroy&&y.scatter2d.destroy(),y.error2d&&y.error2d.destroy&&y.error2d.destroy(),y.line2d&&y.line2d.destroy&&y.line2d.destroy(),y.select2d&&y.select2d.destroy&&y.select2d.destroy(),y.glText&&y.glText.forEach(function(n){n.destroy&&n.destroy()}),y.lineOptions=null,y.fillOptions=null,y.markerOptions=null,y.markerSelectedOptions=null,y.markerUnselectedOptions=null,y.errorXOptions=null,y.errorYOptions=null,y.textOptions=null,y.textSelectedOptions=null,y.textUnselectedOptions=null,y.selectBatch=null,y.unselectBatch=null,w._scene=null}),y.dirty||d.extendFlat(y,e),y}},{"../../lib":515}],1001:[function(m,G,Y){var d=m("../scatter/subtypes"),v=m("./edit_style").styleTextSelection;G.exports=function(w,y){var e=w.cd,t=w.xaxis,n=w.yaxis,o=[],r=e[0].trace,g=e[0].t,c=r._length,a=g.x,h=g.y,l=g._scene,s=g.index;if(!l)return o;var p=d.hasText(r),u=d.hasMarkers(r),i=!u&&!p;if(r.visible!==!0||i)return o;var x=[],f=[];if(y!==!1&&!y.degenerate)for(var _=0;_<c;_++)y.contains([g.xpx[_],g.ypx[_]],!1,_,w)?(x.push(_),o.push({pointNumber:_,x:t.c2d(a[_]),y:n.c2d(h[_])})):f.push(_);if(u){var b=l.scatter2d;if(x.length||f.length){if(!l.selectBatch[s].length&&!l.unselectBatch[s].length){var T=new Array(l.count);T[s]=l.markerUnselectedOptions[s],b.update.apply(b,T)}}else{var k=new Array(l.count);k[s]=l.markerOptions[s],b.update.apply(b,k)}}return l.selectBatch[s]=x,l.unselectBatch[s]=f,p&&v(e),o}},{"../scatter/subtypes":961,"./edit_style":994}],1002:[function(m,G,Y){var d=m("../../plots/template_attributes").hovertemplateAttrs,v=m("../../plots/template_attributes").texttemplateAttrs,w=m("../scattergeo/attributes"),y=m("../scatter/attributes"),e=m("../../plots/mapbox/layout_attributes"),t=m("../../plots/attributes"),n=m("../../components/colorscale/attributes"),o=m("../../lib/extend").extendFlat,r=m("../../plot_api/edit_types").overrideAll,g=m("../../plots/mapbox/layout_attributes"),c=w.line,a=w.marker;G.exports=r({lon:w.lon,lat:w.lat,cluster:{enabled:{valType:"boolean"},maxzoom:o({},g.layers.maxzoom,{}),step:{valType:"number",arrayOk:!0,dflt:-1,min:-1},size:{valType:"number",arrayOk:!0,dflt:20,min:0},color:{valType:"color",arrayOk:!0},opacity:o({},a.opacity,{dflt:1})},mode:o({},y.mode,{dflt:"markers"}),text:o({},y.text,{}),texttemplate:v({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:o({},y.hovertext,{}),line:{color:c.color,width:c.width},connectgaps:y.connectgaps,marker:o({symbol:{valType:"string",dflt:"circle",arrayOk:!0},angle:{valType:"number",dflt:"auto",arrayOk:!0},allowoverlap:{valType:"boolean",dflt:!1},opacity:a.opacity,size:a.size,sizeref:a.sizeref,sizemin:a.sizemin,sizemode:a.sizemode},n("marker")),fill:w.fill,fillcolor:y.fillcolor,textfont:e.layers.symbol.textfont,textposition:e.layers.symbol.textposition,below:{valType:"string"},selected:{marker:y.selected.marker},unselected:{marker:y.unselected.marker},hoverinfo:o({},t.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:d()},"calc","nested")},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/mapbox/layout_attributes":624,"../../plots/template_attributes":642,"../scatter/attributes":936,"../scattergeo/attributes":978}],1003:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../lib"),w=m("../../constants/numerical").BADNUM,y=m("../../lib/geojson_utils"),e=m("../../components/colorscale"),t=m("../../components/drawing"),n=m("../scatter/make_bubble_size_func"),o=m("../scatter/subtypes"),r=m("../../plots/mapbox/convert_text_opts"),g=m("../../components/fx/helpers").appendArrayPointValue,c=m("../../lib/svg_text_utils").NEWLINES,a=m("../../lib/svg_text_utils").BR_TAG_ALL;function h(i){return{type:i,geojson:y.makeBlank(),layout:{visibility:"none"},filter:null,paint:{}}}function l(i,x){return v.isArrayOrTypedArray(i)?x?function(f){return d(i[f])?+i[f]:0}:function(f){return i[f]}:i?function(){return i}:s}function s(){return""}function p(i){return i[0]===w}function u(i,x){var f;if(v.isArrayOrTypedArray(i)&&v.isArrayOrTypedArray(x)){f=["step",["get","point_count"],i[0]];for(var _=1;_<i.length;_++)f.push(x[_-1],i[_])}else f=i;return f}G.exports=function(i,x){var f,_=x[0].trace,b=_.visible===!0&&_._length!==0,T=_.fill!=="none",k=o.hasLines(_),L=o.hasMarkers(_),A=o.hasText(_),I=L&&_.marker.symbol==="circle",P=L&&_.marker.symbol!=="circle",S=_.cluster&&_.cluster.enabled,E=h("fill"),z=h("line"),D=h("circle"),j=h("symbol"),V={fill:E,line:z,circle:D,symbol:j};if(!b)return V;if((T||k)&&(f=y.calcTraceToLineCoords(x)),T&&(E.geojson=y.makePolygon(f),E.layout.visibility="visible",v.extendFlat(E.paint,{"fill-color":_.fillcolor})),k&&(z.geojson=y.makeLine(f),z.layout.visibility="visible",v.extendFlat(z.paint,{"line-width":_.line.width,"line-color":_.line.color,"line-opacity":_.opacity})),I){var Z=function($){var re,H,N,U,te=$[0].trace,B=te.marker,K=te.selectedpoints,J=v.isArrayOrTypedArray(B.color),ee=v.isArrayOrTypedArray(B.size),ne=v.isArrayOrTypedArray(B.opacity);function se(Te){return te.opacity*Te}J&&(H=e.hasColorscale(te,"marker")?e.makeColorScaleFuncFromTrace(B):v.identity),ee&&(N=n(te)),ne&&(U=function(Te){return se(d(Te)?+v.constrain(Te,0,1):0)});var oe,me=[];for(re=0;re<$.length;re++){var ce=$[re],ye=ce.lonlat;if(!p(ye)){var Se={};H&&(Se.mcc=ce.mcc=H(ce.mc)),N&&(Se.mrc=ce.mrc=N(ce.ms)),U&&(Se.mo=U(ce.mo)),K&&(Se.selected=ce.selected||0),me.push({type:"Feature",id:re+1,geometry:{type:"Point",coordinates:ye},properties:Se})}}if(K)for(oe=t.makeSelectedPointStyleFns(te),re=0;re<me.length;re++){var fe=me[re].properties;oe.selectedOpacityFn&&(fe.mo=se(oe.selectedOpacityFn(fe))),oe.selectedColorFn&&(fe.mcc=oe.selectedColorFn(fe)),oe.selectedSizeFn&&(fe.mrc=oe.selectedSizeFn(fe))}return{geojson:{type:"FeatureCollection",features:me},mcc:J||oe&&oe.selectedColorFn?{type:"identity",property:"mcc"}:B.color,mrc:ee||oe&&oe.selectedSizeFn?{type:"identity",property:"mrc"}:(ge=B.size,ge/2),mo:ne||oe&&oe.selectedOpacityFn?{type:"identity",property:"mo"}:se(B.opacity)};var ge}(x);D.geojson=Z.geojson,D.layout.visibility="visible",S&&(D.filter=["!",["has","point_count"]],V.cluster={type:"circle",filter:["has","point_count"],layout:{visibility:"visible"},paint:{"circle-color":u(_.cluster.color,_.cluster.step),"circle-radius":u(_.cluster.size,_.cluster.step),"circle-opacity":u(_.cluster.opacity,_.cluster.step)}},V.clusterCount={type:"symbol",filter:["has","point_count"],paint:{},layout:{"text-field":"{point_count_abbreviated}","text-font":["Open Sans Regular","Arial Unicode MS Regular"],"text-size":12}}),v.extendFlat(D.paint,{"circle-color":Z.mcc,"circle-radius":Z.mrc,"circle-opacity":Z.mo})}if(I&&S&&(D.filter=["!",["has","point_count"]]),(P||A)&&(j.geojson=function($,re){for(var H=re._fullLayout,N=$[0].trace,U=N.marker||{},te=U.symbol,B=U.angle,K=te!=="circle"?l(te):s,J=B!=="auto"?l(B,!0):s,ee=o.hasText(N)?l(N.text):s,ne=[],se=0;se<$.length;se++){var oe=$[se];if(!p(oe.lonlat)){var me,ce=N.texttemplate;if(ce){var ye=Array.isArray(ce)?ce[se]||"":ce,Se=N._module.formatLabels(oe,N,H),fe={};g(fe,N,oe.i);var ge=N._meta||{};me=v.texttemplateString(ye,Se,H._d3locale,fe,oe,ge)}else me=ee(se);me&&(me=me.replace(c,"").replace(a,`
`)),ne.push({type:"Feature",geometry:{type:"Point",coordinates:oe.lonlat},properties:{symbol:K(se),angle:J(se),text:me}})}}return{type:"FeatureCollection",features:ne}}(x,i),v.extendFlat(j.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),P&&(v.extendFlat(j.layout,{"icon-size":_.marker.size/10}),"angle"in _.marker&&_.marker.angle!=="auto"&&v.extendFlat(j.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"}),j.layout["icon-allow-overlap"]=_.marker.allowoverlap,v.extendFlat(j.paint,{"icon-opacity":_.opacity*_.marker.opacity,"icon-color":_.marker.color})),A)){var Q=(_.marker||{}).size,X=r(_.textposition,Q);v.extendFlat(j.layout,{"text-size":_.textfont.size,"text-anchor":X.anchor,"text-offset":X.offset}),v.extendFlat(j.paint,{"text-color":_.textfont.color,"text-opacity":_.opacity})}return V}},{"../../components/colorscale":379,"../../components/drawing":389,"../../components/fx/helpers":403,"../../constants/numerical":491,"../../lib":515,"../../lib/geojson_utils":509,"../../lib/svg_text_utils":541,"../../plots/mapbox/convert_text_opts":621,"../scatter/make_bubble_size_func":953,"../scatter/subtypes":961,"fast-isnumeric":190}],1004:[function(m,G,Y){var d=m("../../lib"),v=m("../scatter/subtypes"),w=m("../scatter/marker_defaults"),y=m("../scatter/line_defaults"),e=m("../scatter/text_defaults"),t=m("../scatter/fillcolor_defaults"),n=m("./attributes");G.exports=function(o,r,g,c){function a(f,_){return d.coerce(o,r,n,f,_)}function h(f,_){return d.coerce2(o,r,n,f,_)}if(function(f,_,b){var T=b("lon")||[],k=b("lat")||[],L=Math.min(T.length,k.length);return _._length=L,L}(0,r,a)){if(a("text"),a("texttemplate"),a("hovertext"),a("hovertemplate"),a("mode"),a("below"),v.hasLines(r)&&(y(o,r,g,c,a,{noDash:!0}),a("connectgaps")),v.hasMarkers(r)){w(o,r,g,c,a,{noLine:!0,noAngle:!0}),a("marker.allowoverlap"),a("marker.angle");var l=r.marker;l.symbol!=="circle"&&(d.isArrayOrTypedArray(l.size)&&(l.size=l.size[0]),d.isArrayOrTypedArray(l.color)&&(l.color=l.color[0]))}var s=h("cluster.maxzoom"),p=h("cluster.step"),u=h("cluster.color",r.marker&&r.marker.color||g),i=h("cluster.size"),x=h("cluster.opacity");a("cluster.enabled",s!==!1||p!==!1||u!==!1||i!==!1||x!==!1),v.hasText(r)&&e(o,r,c,a,{noSelect:!0}),a("fill"),r.fill!=="none"&&t(o,r,g,a),d.coerceSelectionMarkerOpacity(r,a)}else r.visible=!1}},{"../../lib":515,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1002}],1005:[function(m,G,Y){G.exports=function(d,v){return d.lon=v.lon,d.lat=v.lat,d}},{}],1006:[function(m,G,Y){var d=m("../../plots/cartesian/axes");G.exports=function(v,w,y){var e={},t=y[w.subplot]._subplot.mockAxis,n=v.lonlat;return e.lonLabel=d.tickText(t,t.c2l(n[0]),!0).text,e.latLabel=d.tickText(t,t.c2l(n[1]),!0).text,e}},{"../../plots/cartesian/axes":566}],1007:[function(m,G,Y){var d=m("../../components/fx"),v=m("../../lib"),w=m("../scatter/get_trace_color"),y=v.fillText,e=m("../../constants/numerical").BADNUM,t=m("../../plots/mapbox/constants").traceLayerPrefix;function n(o,r,g){if(!o.hovertemplate){var c=(r.hi||o.hoverinfo).split("+"),a=c.indexOf("all")!==-1,h=c.indexOf("lon")!==-1,l=c.indexOf("lat")!==-1,s=r.lonlat,p=[];return a||h&&l?p.push("("+u(s[1])+", "+u(s[0])+")"):h?p.push(g.lon+u(s[0])):l&&p.push(g.lat+u(s[1])),(a||c.indexOf("text")!==-1)&&y(r,o,p),p.join("<br>")}function u(i){return i+"\xB0"}}G.exports={hoverPoints:function(o,r,g){var c=o.cd,a=c[0].trace,h=o.xa,l=o.ya,s=o.subplot,p=[],u=t+a.uid+"-circle",i=a.cluster&&a.cluster.enabled;if(i){var x=s.map.queryRenderedFeatures(null,{layers:[u]});p=x.map(function(E){return E.id})}var f=360*(r>=0?Math.floor((r+180)/360):Math.ceil((r-180)/360)),_=r-f;if(d.getClosest(c,function(E){var z=E.lonlat;if(z[0]===e||i&&p.indexOf(E.i+1)===-1)return 1/0;var D=v.modHalf(z[0],360),j=z[1],V=s.project([D,j]),Z=V.x-h.c2p([_,j]),Q=V.y-l.c2p([D,g]),X=Math.max(3,E.mrc||0);return Math.max(Math.sqrt(Z*Z+Q*Q)-X,1-3/X)},o),o.index!==!1){var b=c[o.index],T=b.lonlat,k=[v.modHalf(T[0],360)+f,T[1]],L=h.c2p(k),A=l.c2p(k),I=b.mrc||1;o.x0=L-I,o.x1=L+I,o.y0=A-I,o.y1=A+I;var P={};P[a.subplot]={_subplot:s};var S=a._module.formatLabels(b,a,P);return o.lonLabel=S.lonLabel,o.latLabel=S.latLabel,o.color=w(a,b),o.extraText=n(a,b,c[0].t.labels),o.hovertemplate=a.hovertemplate,[o]}},getExtraText:n}},{"../../components/fx":407,"../../constants/numerical":491,"../../lib":515,"../../plots/mapbox/constants":620,"../scatter/get_trace_color":946}],1008:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../scatter/marker_colorbar"),formatLabels:m("./format_labels"),calc:m("../scattergeo/calc"),plot:m("./plot"),hoverPoints:m("./hover").hoverPoints,eventData:m("./event_data"),selectPoints:m("./select"),styleOnSelect:function(d,v){v&&v[0].trace._glTrace.update(v)},moduleType:"trace",name:"scattermapbox",basePlotModule:m("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":622,"../scatter/marker_colorbar":954,"../scattergeo/calc":979,"./attributes":1002,"./defaults":1004,"./event_data":1005,"./format_labels":1006,"./hover":1007,"./plot":1009,"./select":1010}],1009:[function(m,G,Y){var d=m("../../lib"),v=m("./convert"),w=m("../../plots/mapbox/constants").traceLayerPrefix,y={cluster:["cluster","clusterCount","circle"],nonCluster:["fill","line","circle","symbol"]};function e(n,o,r){this.type="scattermapbox",this.subplot=n,this.uid=o,this.clusterEnabled=r,this.sourceIds={fill:"source-"+o+"-fill",line:"source-"+o+"-line",circle:"source-"+o+"-circle",symbol:"source-"+o+"-symbol",cluster:"source-"+o+"-circle",clusterCount:"source-"+o+"-circle"},this.layerIds={fill:w+o+"-fill",line:w+o+"-line",circle:w+o+"-circle",symbol:w+o+"-symbol",cluster:w+o+"-cluster",clusterCount:w+o+"-cluster-count"},this.below=null}var t=e.prototype;t.addSource=function(n,o,r){var g={type:"geojson",data:o.geojson};r&&r.enabled&&d.extendFlat(g,{cluster:!0,clusterMaxZoom:r.maxzoom}),this.subplot.map.addSource(this.sourceIds[n],g)},t.setSourceData=function(n,o){this.subplot.map.getSource(this.sourceIds[n]).setData(o.geojson)},t.addLayer=function(n,o,r){var g={type:o.type,id:this.layerIds[n],source:this.sourceIds[n],layout:o.layout,paint:o.paint};o.filter&&(g.filter=o.filter),this.subplot.addLayer(g,r)},t.update=function(n){var o,r,g,c=n[0].trace,a=this.subplot,h=a.map,l=v(a.gd,n),s=a.belowLookup["trace-"+this.uid],p=!(!c.cluster||!c.cluster.enabled),u=!!this.clusterEnabled;if(s!==this.below){var i=y.nonCluster;for(o=i.length-1;o>=0;o--)r=i[o],h.removeLayer(this.layerIds[r]);for(o=0;o<i.length;o++)g=l[r=i[o]],this.addLayer(r,g,s);this.below=s}else if(p&&!u){for(o=y.nonCluster.length-1;o>=0;o--)r=y.nonCluster[o],h.removeLayer(this.layerIds[r]),h.removeSource(this.sourceIds[r]);for(this.addSource("circle",l.circle,c.cluster),o=0;o<y.cluster.length;o++)g=l[r=y.cluster[o]],this.addLayer(r,g,s);this.clusterEnabled=p}else if(!p&&u){for(o=0;o<y.cluster.length;o++)r=y.cluster[o],h.removeLayer(this.layerIds[r]);for(h.removeSource(this.sourceIds.circle),o=0;o<y.nonCluster.length;o++)g=l[r=y.nonCluster[o]],this.addSource(r,g,c.cluster),this.addLayer(r,g,s);this.clusterEnabled=p}n[0].trace._glTrace=this},t.dispose=function(){for(var n=this.subplot.map,o=this.clusterEnabled?y.cluster:y.nonCluster,r=o.length-1;r>=0;r--){var g=o[r];n.removeLayer(this.layerIds[g]),n.removeSource(this.sourceIds[g])}},G.exports=function(n,o){var r,g,c,a=o[0].trace,h=a.cluster&&a.cluster.enabled,l=new e(n,a.uid,h),s=v(n.gd,o),p=l.below=n.belowLookup["trace-"+a.uid];if(h)for(l.addSource("circle",s.circle,a.cluster),r=0;r<y.cluster.length;r++)c=s[g=y.cluster[r]],l.addLayer(g,c,p);else for(r=0;r<y.nonCluster.length;r++)c=s[g=y.nonCluster[r]],l.addSource(g,c,a.cluster),l.addLayer(g,c,p);return o[0].trace._glTrace=l,l}},{"../../lib":515,"../../plots/mapbox/constants":620,"./convert":1003}],1010:[function(m,G,Y){var d=m("../../lib"),v=m("../scatter/subtypes"),w=m("../../constants/numerical").BADNUM;G.exports=function(y,e){var t,n=y.cd,o=y.xaxis,r=y.yaxis,g=[],c=n[0].trace;if(!v.hasMarkers(c))return[];if(e===!1)for(t=0;t<n.length;t++)n[t].selected=0;else for(t=0;t<n.length;t++){var a=n[t],h=a.lonlat;if(h[0]!==w){var l=[d.modHalf(h[0],360),h[1]],s=[o.c2p(l),r.c2p(l)];e.contains(s,null,t,y)?(g.push({pointNumber:t,lon:h[0],lat:h[1]}),a.selected=1):a.selected=0}}return g}},{"../../constants/numerical":491,"../../lib":515,"../scatter/subtypes":961}],1011:[function(m,G,Y){var d=m("../../plots/template_attributes").hovertemplateAttrs,v=m("../../plots/template_attributes").texttemplateAttrs,w=m("../../lib/extend").extendFlat,y=m("../scatter/attributes"),e=m("../../plots/attributes"),t=y.line;G.exports={mode:y.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:y.text,texttemplate:v({editType:"plot"},{keys:["r","theta","text"]}),hovertext:y.hovertext,line:{color:t.color,width:t.width,dash:t.dash,backoff:t.backoff,shape:w({},t.shape,{values:["linear","spline"]}),smoothing:t.smoothing,editType:"calc"},connectgaps:y.connectgaps,marker:y.marker,cliponaxis:w({},y.cliponaxis,{dflt:!1}),textposition:y.textposition,textfont:y.textfont,fill:w({},y.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:y.fillcolor,hoverinfo:w({},e.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:y.hoveron,hovertemplate:d(),selected:y.selected,unselected:y.unselected}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1012:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../constants/numerical").BADNUM,w=m("../../plots/cartesian/axes"),y=m("../scatter/colorscale_calc"),e=m("../scatter/arrays_to_calcdata"),t=m("../scatter/calc_selection"),n=m("../scatter/calc").calcMarkerSize;G.exports=function(o,r){for(var g=o._fullLayout,c=r.subplot,a=g[c].radialaxis,h=g[c].angularaxis,l=a.makeCalcdata(r,"r"),s=h.makeCalcdata(r,"theta"),p=r._length,u=new Array(p),i=0;i<p;i++){var x=l[i],f=s[i],_=u[i]={};d(x)&&d(f)?(_.r=x,_.theta=f):_.r=v}var b=n(r,p);return r._extremes.x=w.findExtremes(a,l,{ppad:b}),y(o,r),e(u,r),t(u,r),u}},{"../../constants/numerical":491,"../../plots/cartesian/axes":566,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1013:[function(m,G,Y){var d=m("../../lib"),v=m("../scatter/subtypes"),w=m("../scatter/marker_defaults"),y=m("../scatter/line_defaults"),e=m("../scatter/line_shape_defaults"),t=m("../scatter/text_defaults"),n=m("../scatter/fillcolor_defaults"),o=m("../scatter/constants").PTS_LINESONLY,r=m("./attributes");function g(c,a,h,l){var s,p=l("r"),u=l("theta");if(p)u?s=Math.min(p.length,u.length):(s=p.length,l("theta0"),l("dtheta"));else{if(!u)return 0;s=a.theta.length,l("r0"),l("dr")}return a._length=s,s}G.exports={handleRThetaDefaults:g,supplyDefaults:function(c,a,h,l){function s(i,x){return d.coerce(c,a,r,i,x)}var p=g(c,a,l,s);if(p){s("thetaunit"),s("mode",p<o?"lines+markers":"lines"),s("text"),s("hovertext"),a.hoveron!=="fills"&&s("hovertemplate"),v.hasLines(a)&&(y(c,a,h,l,s,{backoff:!0}),e(c,a,s),s("connectgaps")),v.hasMarkers(a)&&w(c,a,h,l,s,{gradient:!0}),v.hasText(a)&&(s("texttemplate"),t(c,a,l,s));var u=[];(v.hasMarkers(a)||v.hasText(a))&&(s("cliponaxis"),s("marker.maxdisplayed"),u.push("points")),s("fill"),a.fill!=="none"&&(n(c,a,h,s),v.hasLines(a)||e(c,a,s)),a.fill!=="tonext"&&a.fill!=="toself"||u.push("fills"),s("hoveron",u.join("+")||"points"),d.coerceSelectionMarkerOpacity(a,s)}else a.visible=!1}}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1011}],1014:[function(m,G,Y){var d=m("../../lib"),v=m("../../plots/cartesian/axes");G.exports=function(w,y,e){var t,n,o={},r=e[y.subplot]._subplot;r?(t=r.radialAxis,n=r.angularAxis):(t=(r=e[y.subplot]).radialaxis,n=r.angularaxis);var g=t.c2l(w.r);o.rLabel=v.tickText(t,g,!0).text;var c=n.thetaunit==="degrees"?d.rad2deg(w.theta):w.theta;return o.thetaLabel=v.tickText(n,c,!0).text,o}},{"../../lib":515,"../../plots/cartesian/axes":566}],1015:[function(m,G,Y){var d=m("../scatter/hover");function v(w,y,e,t){var n=e.radialAxis,o=e.angularAxis;n._hovertitle="r",o._hovertitle="\u03B8";var r={};r[y.subplot]={_subplot:e};var g=y._module.formatLabels(w,y,r);t.rLabel=g.rLabel,t.thetaLabel=g.thetaLabel;var c=w.hi||y.hoverinfo,a=[];function h(s,p){a.push(s._hovertitle+": "+p)}if(!y.hovertemplate){var l=c.split("+");l.indexOf("all")!==-1&&(l=["r","theta","text"]),l.indexOf("r")!==-1&&h(n,t.rLabel),l.indexOf("theta")!==-1&&h(o,t.thetaLabel),l.indexOf("text")!==-1&&t.text&&(a.push(t.text),delete t.text),t.extraText=a.join("<br>")}}G.exports={hoverPoints:function(w,y,e,t){var n=d(w,y,e,t);if(n&&n[0].index!==!1){var o=n[0];if(o.index===void 0)return n;var r=w.subplot,g=o.cd[o.index],c=o.trace;if(r.isPtInside(g))return o.xLabelVal=void 0,o.yLabelVal=void 0,v(g,c,r,o),o.hovertemplate=c.hovertemplate,n}},makeHoverPointText:v}},{"../scatter/hover":947}],1016:[function(m,G,Y){G.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:m("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:m("./attributes"),supplyDefaults:m("./defaults").supplyDefaults,colorbar:m("../scatter/marker_colorbar"),formatLabels:m("./format_labels"),calc:m("./calc"),plot:m("./plot"),style:m("../scatter/style").style,styleOnSelect:m("../scatter/style").styleOnSelect,hoverPoints:m("./hover").hoverPoints,selectPoints:m("../scatter/select"),meta:{}}},{"../../plots/polar":631,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1011,"./calc":1012,"./defaults":1013,"./format_labels":1014,"./hover":1015,"./plot":1017}],1017:[function(m,G,Y){var d=m("../scatter/plot"),v=m("../../constants/numerical").BADNUM;G.exports=function(w,y,e){for(var t=y.layers.frontplot.select("g.scatterlayer"),n=y.xaxis,o=y.yaxis,r={xaxis:n,yaxis:o,plot:y.framework,layerClipId:y._hasClipOnAxisFalse?y.clipIds.forTraces:null},g=y.radialAxis,c=y.angularAxis,a=0;a<e.length;a++)for(var h=e[a],l=0;l<h.length;l++){l===0&&(h[0].trace._xA=n,h[0].trace._yA=o);var s=h[l],p=s.r;if(p===v)s.x=s.y=v;else{var u=g.c2g(p),i=c.c2g(s.theta);s.x=u*Math.cos(i),s.y=u*Math.sin(i)}}d(w,r,e,t)}},{"../../constants/numerical":491,"../scatter/plot":957}],1018:[function(m,G,Y){var d=m("../scatterpolar/attributes"),v=m("../scattergl/attributes"),w=m("../../plots/template_attributes").texttemplateAttrs;G.exports={mode:d.mode,r:d.r,theta:d.theta,r0:d.r0,dr:d.dr,theta0:d.theta0,dtheta:d.dtheta,thetaunit:d.thetaunit,text:d.text,texttemplate:w({editType:"plot"},{keys:["r","theta","text"]}),hovertext:d.hovertext,hovertemplate:d.hovertemplate,line:v.line,connectgaps:v.connectgaps,marker:v.marker,fill:v.fill,fillcolor:v.fillcolor,textposition:v.textposition,textfont:v.textfont,hoverinfo:d.hoverinfo,selected:d.selected,unselected:d.unselected}},{"../../plots/template_attributes":642,"../scattergl/attributes":988,"../scatterpolar/attributes":1011}],1019:[function(m,G,Y){G.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:m("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../scatter/marker_colorbar"),formatLabels:m("./format_labels"),calc:m("./calc"),hoverPoints:m("./hover").hoverPoints,selectPoints:m("../scattergl/select"),meta:{}}},{"../../plots/polar":631,"../scatter/marker_colorbar":954,"../scattergl/select":1001,"./attributes":1018,"./calc":1020,"./defaults":1021,"./format_labels":1022,"./hover":1023}],1020:[function(m,G,Y){var d=m("../scatter/colorscale_calc"),v=m("../scatter/calc").calcMarkerSize,w=m("../scattergl/convert"),y=m("../../plots/cartesian/axes"),e=m("../scattergl/constants").TOO_MANY_POINTS;G.exports=function(t,n){var o=t._fullLayout,r=n.subplot,g=o[r].radialaxis,c=o[r].angularaxis,a=n._r=g.makeCalcdata(n,"r"),h=n._theta=c.makeCalcdata(n,"theta"),l=n._length,s={};l<a.length&&(a=a.slice(0,l)),l<h.length&&(h=h.slice(0,l)),s.r=a,s.theta=h,d(t,n);var p,u=s.opts=w.style(t,n);return l<e?p=v(n,l):u.marker&&(p=2*(u.marker.sizeAvg||Math.max(u.marker.size,3))),n._extremes.x=y.findExtremes(g,a,{ppad:p}),[{x:!1,y:!1,t:s,trace:n}]}},{"../../plots/cartesian/axes":566,"../scatter/calc":937,"../scatter/colorscale_calc":939,"../scattergl/constants":991,"../scattergl/convert":992}],1021:[function(m,G,Y){var d=m("../../lib"),v=m("../scatter/subtypes"),w=m("../scatterpolar/defaults").handleRThetaDefaults,y=m("../scatter/marker_defaults"),e=m("../scatter/line_defaults"),t=m("../scatter/text_defaults"),n=m("../scatter/fillcolor_defaults"),o=m("../scatter/constants").PTS_LINESONLY,r=m("./attributes");G.exports=function(g,c,a,h){function l(p,u){return d.coerce(g,c,r,p,u)}var s=w(g,c,h,l);s?(l("thetaunit"),l("mode",s<o?"lines+markers":"lines"),l("text"),l("hovertext"),c.hoveron!=="fills"&&l("hovertemplate"),v.hasLines(c)&&(e(g,c,a,h,l),l("connectgaps")),v.hasMarkers(c)&&y(g,c,a,h,l,{noAngleRef:!0,noStandOff:!0}),v.hasText(c)&&(l("texttemplate"),t(g,c,h,l)),l("fill"),c.fill!=="none"&&n(g,c,a,l),d.coerceSelectionMarkerOpacity(c,l)):c.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"../scatterpolar/defaults":1013,"./attributes":1018}],1022:[function(m,G,Y){var d=m("../scatterpolar/format_labels");G.exports=function(v,w,y){var e=v.i;return"r"in v||(v.r=w._r[e]),"theta"in v||(v.theta=w._theta[e]),d(v,w,y)}},{"../scatterpolar/format_labels":1014}],1023:[function(m,G,Y){var d=m("../scattergl/hover"),v=m("../scatterpolar/hover").makeHoverPointText;G.exports={hoverPoints:function(w,y,e,t){var n=w.cd[0].t,o=n.r,r=n.theta,g=d.hoverPoints(w,y,e,t);if(g&&g[0].index!==!1){var c=g[0];if(c.index===void 0)return g;var a=w.subplot,h=c.cd[c.index],l=c.trace;if(h.r=o[c.index],h.theta=r[c.index],a.isPtInside(h))return c.xLabelVal=void 0,c.yLabelVal=void 0,v(h,l,a,c),g}}}},{"../scattergl/hover":997,"../scatterpolar/hover":1015}],1024:[function(m,G,Y){arguments[4][905][0].apply(Y,arguments)},{"./base_index":1019,"./plot":1025,dup:905}],1025:[function(m,G,Y){var d=m("@plotly/point-cluster"),v=m("fast-isnumeric"),w=m("../scattergl/plot"),y=m("../scattergl/scene_update"),e=m("../scattergl/convert"),t=m("../../lib"),n=m("../scattergl/constants").TOO_MANY_POINTS;G.exports=function(o,r,g){if(g.length){var c=r.radialAxis,a=r.angularAxis,h=y(o,r);return g.forEach(function(l){if(l&&l[0]&&l[0].trace){var s,p=l[0],u=p.trace,i=p.t,x=u._length,f=i.r,_=i.theta,b=i.opts,T=f.slice(),k=_.slice();for(s=0;s<f.length;s++)r.isPtInside({r:f[s],theta:_[s]})||(T[s]=NaN,k[s]=NaN);var L=new Array(2*x),A=Array(x),I=Array(x);for(s=0;s<x;s++){var P,S,E=T[s];if(v(E)){var z=c.c2g(E),D=a.c2g(k[s],u.thetaunit);P=z*Math.cos(D),S=z*Math.sin(D)}else P=S=NaN;A[s]=L[2*s]=P,I[s]=L[2*s+1]=S}i.tree=d(L),b.marker&&x>=n&&(b.marker.cluster=i.tree),b.marker&&(b.markerSel.positions=b.markerUnsel.positions=b.marker.positions=L),b.line&&L.length>1&&t.extendFlat(b.line,e.linePositions(o,u,L)),b.text&&(t.extendFlat(b.text,{positions:L},e.textPosition(o,u,b.text,b.marker)),t.extendFlat(b.textSel,{positions:L},e.textPosition(o,u,b.text,b.markerSel)),t.extendFlat(b.textUnsel,{positions:L},e.textPosition(o,u,b.text,b.markerUnsel))),b.fill&&!h.fill2d&&(h.fill2d=!0),b.marker&&!h.scatter2d&&(h.scatter2d=!0),b.line&&!h.line2d&&(h.line2d=!0),b.text&&!h.glText&&(h.glText=!0),h.lineOptions.push(b.line),h.fillOptions.push(b.fill),h.markerOptions.push(b.marker),h.markerSelectedOptions.push(b.markerSel),h.markerUnselectedOptions.push(b.markerUnsel),h.textOptions.push(b.text),h.textSelectedOptions.push(b.textSel),h.textUnselectedOptions.push(b.textUnsel),h.selectBatch.push([]),h.unselectBatch.push([]),i.x=A,i.y=I,i.rawx=A,i.rawy=I,i.r=f,i.theta=_,i.positions=L,i._scene=h,i.index=h.count,h.count++}}),w(o,r,g)}},G.exports.reglPrecompiled={}},{"../../lib":515,"../scattergl/constants":991,"../scattergl/convert":992,"../scattergl/plot":999,"../scattergl/scene_update":1e3,"@plotly/point-cluster":59,"fast-isnumeric":190}],1026:[function(m,G,Y){var d=m("../../plots/template_attributes").hovertemplateAttrs,v=m("../../plots/template_attributes").texttemplateAttrs,w=m("../../lib/extend").extendFlat,y=m("../scatter/attributes"),e=m("../../plots/attributes"),t=y.line;G.exports={mode:y.mode,real:{valType:"data_array",editType:"calc+clearAxisTypes"},imag:{valType:"data_array",editType:"calc+clearAxisTypes"},text:y.text,texttemplate:v({editType:"plot"},{keys:["real","imag","text"]}),hovertext:y.hovertext,line:{color:t.color,width:t.width,dash:t.dash,backoff:t.backoff,shape:w({},t.shape,{values:["linear","spline"]}),smoothing:t.smoothing,editType:"calc"},connectgaps:y.connectgaps,marker:y.marker,cliponaxis:w({},y.cliponaxis,{dflt:!1}),textposition:y.textposition,textfont:y.textfont,fill:w({},y.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:y.fillcolor,hoverinfo:w({},e.hoverinfo,{flags:["real","imag","text","name"]}),hoveron:y.hoveron,hovertemplate:d(),selected:y.selected,unselected:y.unselected}},{"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1027:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../../constants/numerical").BADNUM,w=m("../scatter/colorscale_calc"),y=m("../scatter/arrays_to_calcdata"),e=m("../scatter/calc_selection"),t=m("../scatter/calc").calcMarkerSize;G.exports=function(n,o){for(var r=n._fullLayout,g=o.subplot,c=r[g].realaxis,a=r[g].imaginaryaxis,h=c.makeCalcdata(o,"real"),l=a.makeCalcdata(o,"imag"),s=o._length,p=new Array(s),u=0;u<s;u++){var i=h[u],x=l[u],f=p[u]={};d(i)&&d(x)?(f.real=i,f.imag=x):f.real=v}return t(o,s),w(n,o),y(p,o),e(p,o),p}},{"../../constants/numerical":491,"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1028:[function(m,G,Y){var d=m("../../lib"),v=m("../scatter/subtypes"),w=m("../scatter/marker_defaults"),y=m("../scatter/line_defaults"),e=m("../scatter/line_shape_defaults"),t=m("../scatter/text_defaults"),n=m("../scatter/fillcolor_defaults"),o=m("../scatter/constants").PTS_LINESONLY,r=m("./attributes");G.exports=function(g,c,a,h){function l(u,i){return d.coerce(g,c,r,u,i)}var s=function(u,i,x,f){var _,b=f("real"),T=f("imag");return b&&T&&(_=Math.min(b.length,T.length)),i._length=_,_}(0,c,0,l);if(s){l("mode",s<o?"lines+markers":"lines"),l("text"),l("hovertext"),c.hoveron!=="fills"&&l("hovertemplate"),v.hasLines(c)&&(y(g,c,a,h,l,{backoff:!0}),e(g,c,l),l("connectgaps")),v.hasMarkers(c)&&w(g,c,a,h,l,{gradient:!0}),v.hasText(c)&&(l("texttemplate"),t(g,c,h,l));var p=[];(v.hasMarkers(c)||v.hasText(c))&&(l("cliponaxis"),l("marker.maxdisplayed"),p.push("points")),l("fill"),c.fill!=="none"&&(n(g,c,a,l),v.hasLines(c)||e(g,c,l)),c.fill!=="tonext"&&c.fill!=="toself"||p.push("fills"),l("hoveron",p.join("+")||"points"),d.coerceSelectionMarkerOpacity(c,l)}else c.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1026}],1029:[function(m,G,Y){var d=m("../../plots/cartesian/axes");G.exports=function(v,w,y){var e={},t=y[w.subplot]._subplot;return e.realLabel=d.tickText(t.radialAxis,v.real,!0).text,e.imagLabel=d.tickText(t.angularAxis,v.imag,!0).text,e}},{"../../plots/cartesian/axes":566}],1030:[function(m,G,Y){var d=m("../scatter/hover");function v(w,y,e,t){var n=e.radialAxis,o=e.angularAxis;n._hovertitle="real",o._hovertitle="imag";var r={};r[y.subplot]={_subplot:e};var g=y._module.formatLabels(w,y,r);t.realLabel=g.realLabel,t.imagLabel=g.imagLabel;var c=w.hi||y.hoverinfo,a=[];function h(s,p){a.push(s._hovertitle+": "+p)}if(!y.hovertemplate){var l=c.split("+");l.indexOf("all")!==-1&&(l=["real","imag","text"]),l.indexOf("real")!==-1&&h(n,t.realLabel),l.indexOf("imag")!==-1&&h(o,t.imagLabel),l.indexOf("text")!==-1&&t.text&&(a.push(t.text),delete t.text),t.extraText=a.join("<br>")}}G.exports={hoverPoints:function(w,y,e,t){var n=d(w,y,e,t);if(n&&n[0].index!==!1){var o=n[0];if(o.index===void 0)return n;var r=w.subplot,g=o.cd[o.index],c=o.trace;if(r.isPtInside(g))return o.xLabelVal=void 0,o.yLabelVal=void 0,v(g,c,r,o),o.hovertemplate=c.hovertemplate,n}},makeHoverPointText:v}},{"../scatter/hover":947}],1031:[function(m,G,Y){G.exports={moduleType:"trace",name:"scattersmith",basePlotModule:m("../../plots/smith"),categories:["smith","symbols","showLegend","scatter-like"],attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../scatter/marker_colorbar"),formatLabels:m("./format_labels"),calc:m("./calc"),plot:m("./plot"),style:m("../scatter/style").style,styleOnSelect:m("../scatter/style").styleOnSelect,hoverPoints:m("./hover").hoverPoints,selectPoints:m("../scatter/select"),meta:{}}},{"../../plots/smith":638,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1026,"./calc":1027,"./defaults":1028,"./format_labels":1029,"./hover":1030,"./plot":1032}],1032:[function(m,G,Y){var d=m("../scatter/plot"),v=m("../../constants/numerical").BADNUM,w=m("../../plots/smith/helpers").smith;G.exports=function(y,e,t){for(var n=e.layers.frontplot.select("g.scatterlayer"),o=e.xaxis,r=e.yaxis,g={xaxis:o,yaxis:r,plot:e.framework,layerClipId:e._hasClipOnAxisFalse?e.clipIds.forTraces:null},c=0;c<t.length;c++)for(var a=t[c],h=0;h<a.length;h++){h===0&&(a[0].trace._xA=o,a[0].trace._yA=r);var l=a[h],s=l.real;if(s===v)l.x=l.y=v;else{var p=w([s,l.imag]);l.x=p[0],l.y=p[1]}}d(y,g,t,n)}},{"../../constants/numerical":491,"../../plots/smith/helpers":637,"../scatter/plot":957}],1033:[function(m,G,Y){var d=m("../../plots/template_attributes").hovertemplateAttrs,v=m("../../plots/template_attributes").texttemplateAttrs,w=m("../scatter/attributes"),y=m("../../plots/attributes"),e=m("../../components/colorscale/attributes"),t=m("../../components/drawing/attributes").dash,n=m("../../lib/extend").extendFlat,o=w.marker,r=w.line,g=o.line;G.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:n({},w.mode,{dflt:"markers"}),text:n({},w.text,{}),texttemplate:v({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:n({},w.hovertext,{}),line:{color:r.color,width:r.width,dash:t,backoff:r.backoff,shape:n({},r.shape,{values:["linear","spline"]}),smoothing:r.smoothing,editType:"calc"},connectgaps:w.connectgaps,cliponaxis:w.cliponaxis,fill:n({},w.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:w.fillcolor,marker:n({symbol:o.symbol,opacity:o.opacity,angle:o.angle,angleref:o.angleref,standoff:o.standoff,maxdisplayed:o.maxdisplayed,size:o.size,sizeref:o.sizeref,sizemin:o.sizemin,sizemode:o.sizemode,line:n({width:g.width,editType:"calc"},e("marker.line")),gradient:o.gradient,editType:"calc"},e("marker")),textfont:w.textfont,textposition:w.textposition,selected:w.selected,unselected:w.unselected,hoverinfo:n({},y.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:w.hoveron,hovertemplate:d()}},{"../../components/colorscale/attributes":374,"../../components/drawing/attributes":388,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/template_attributes":642,"../scatter/attributes":936}],1034:[function(m,G,Y){var d=m("fast-isnumeric"),v=m("../scatter/colorscale_calc"),w=m("../scatter/arrays_to_calcdata"),y=m("../scatter/calc_selection"),e=m("../scatter/calc").calcMarkerSize,t=["a","b","c"],n={a:["b","c"],b:["a","c"],c:["a","b"]};G.exports=function(o,r){var g,c,a,h,l,s,p=o._fullLayout[r.subplot].sum,u=r.sum||p,i={a:r.a,b:r.b,c:r.c};for(g=0;g<t.length;g++)if(!i[a=t[g]]){for(l=i[n[a][0]],s=i[n[a][1]],h=new Array(l.length),c=0;c<l.length;c++)h[c]=u-l[c]-s[c];i[a]=h}var x,f,_,b,T,k,L=r._length,A=new Array(L);for(g=0;g<L;g++)x=i.a[g],f=i.b[g],_=i.c[g],d(x)&&d(f)&&d(_)?((b=p/((x=+x)+(f=+f)+(_=+_)))!==1&&(x*=b,f*=b,_*=b),k=x,T=_-f,A[g]={x:T,y:k,a:x,b:f,c:_}):A[g]={x:!1,y:!1};return e(r,L),v(o,r),w(A,r),y(A,r),A}},{"../scatter/arrays_to_calcdata":935,"../scatter/calc":937,"../scatter/calc_selection":938,"../scatter/colorscale_calc":939,"fast-isnumeric":190}],1035:[function(m,G,Y){var d=m("../../lib"),v=m("../scatter/constants"),w=m("../scatter/subtypes"),y=m("../scatter/marker_defaults"),e=m("../scatter/line_defaults"),t=m("../scatter/line_shape_defaults"),n=m("../scatter/text_defaults"),o=m("../scatter/fillcolor_defaults"),r=m("./attributes");G.exports=function(g,c,a,h){function l(f,_){return d.coerce(g,c,r,f,_)}var s,p=l("a"),u=l("b"),i=l("c");if(p?(s=p.length,u?(s=Math.min(s,u.length),i&&(s=Math.min(s,i.length))):s=i?Math.min(s,i.length):0):u&&i&&(s=Math.min(u.length,i.length)),s){c._length=s,l("sum"),l("text"),l("hovertext"),c.hoveron!=="fills"&&l("hovertemplate"),l("mode",s<v.PTS_LINESONLY?"lines+markers":"lines"),w.hasLines(c)&&(e(g,c,a,h,l,{backoff:!0}),t(g,c,l),l("connectgaps")),w.hasMarkers(c)&&y(g,c,a,h,l,{gradient:!0}),w.hasText(c)&&(l("texttemplate"),n(g,c,h,l));var x=[];(w.hasMarkers(c)||w.hasText(c))&&(l("cliponaxis"),l("marker.maxdisplayed"),x.push("points")),l("fill"),c.fill!=="none"&&(o(g,c,a,l),w.hasLines(c)||t(g,c,l)),c.fill!=="tonext"&&c.fill!=="toself"||x.push("fills"),l("hoveron",x.join("+")||"points"),d.coerceSelectionMarkerOpacity(c,l)}else c.visible=!1}},{"../../lib":515,"../scatter/constants":940,"../scatter/fillcolor_defaults":944,"../scatter/line_defaults":949,"../scatter/line_shape_defaults":951,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scatter/text_defaults":962,"./attributes":1033}],1036:[function(m,G,Y){G.exports=function(d,v,w,y,e){if(v.xa&&(d.xaxis=v.xa),v.ya&&(d.yaxis=v.ya),y[e]){var t=y[e];d.a=t.a,d.b=t.b,d.c=t.c}else d.a=v.a,d.b=v.b,d.c=v.c;return d}},{}],1037:[function(m,G,Y){var d=m("../../plots/cartesian/axes");G.exports=function(v,w,y){var e={},t=y[w.subplot]._subplot;return e.aLabel=d.tickText(t.aaxis,v.a,!0).text,e.bLabel=d.tickText(t.baxis,v.b,!0).text,e.cLabel=d.tickText(t.caxis,v.c,!0).text,e}},{"../../plots/cartesian/axes":566}],1038:[function(m,G,Y){var d=m("../scatter/hover");G.exports=function(v,w,y,e){var t=d(v,w,y,e);if(t&&t[0].index!==!1){var n=t[0];if(n.index===void 0){var o=1-n.y0/v.ya._length,r=v.xa._length,g=r*o/2,c=r-g;return n.x0=Math.max(Math.min(n.x0,c),g),n.x1=Math.max(Math.min(n.x1,c),g),t}var a=n.cd[n.index],h=n.trace,l=n.subplot;n.a=a.a,n.b=a.b,n.c=a.c,n.xLabelVal=void 0,n.yLabelVal=void 0;var s={};s[h.subplot]={_subplot:l};var p=h._module.formatLabels(a,h,s);n.aLabel=p.aLabel,n.bLabel=p.bLabel,n.cLabel=p.cLabel;var u=a.hi||h.hoverinfo,i=[];if(!h.hovertemplate){var x=u.split("+");x.indexOf("all")!==-1&&(x=["a","b","c"]),x.indexOf("a")!==-1&&f(l.aaxis,n.aLabel),x.indexOf("b")!==-1&&f(l.baxis,n.bLabel),x.indexOf("c")!==-1&&f(l.caxis,n.cLabel)}return n.extraText=i.join("<br>"),n.hovertemplate=h.hovertemplate,t}function f(_,b){i.push(_._hovertitle+": "+b)}}},{"../scatter/hover":947}],1039:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../scatter/marker_colorbar"),formatLabels:m("./format_labels"),calc:m("./calc"),plot:m("./plot"),style:m("../scatter/style").style,styleOnSelect:m("../scatter/style").styleOnSelect,hoverPoints:m("./hover"),selectPoints:m("../scatter/select"),eventData:m("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:m("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":643,"../scatter/marker_colorbar":954,"../scatter/select":958,"../scatter/style":960,"./attributes":1033,"./calc":1034,"./defaults":1035,"./event_data":1036,"./format_labels":1037,"./hover":1038,"./plot":1040}],1040:[function(m,G,Y){var d=m("../scatter/plot");G.exports=function(v,w,y){var e=w.plotContainer;e.select(".scatterlayer").selectAll("*").remove();for(var t=w.xaxis,n=w.yaxis,o={xaxis:t,yaxis:n,plot:e,layerClipId:w._hasClipOnAxisFalse?w.clipIdRelative:null},r=w.layers.frontplot.select("g.scatterlayer"),g=0;g<y.length;g++){var c=y[g];c.length&&(c[0].trace._xA=t,c[0].trace._yA=n)}d(v,o,y,r)}},{"../scatter/plot":957}],1041:[function(m,G,Y){var d=m("../scatter/attributes"),v=m("../../components/colorscale/attributes"),w=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,y=m("../../plots/template_attributes").hovertemplateAttrs,e=m("../scattergl/attributes"),t=m("../../plots/cartesian/constants").idRegex,n=m("../../plot_api/plot_template").templatedArray,o=m("../../lib/extend").extendFlat,r=d.marker,g=r.line,c=o(v("marker.line",{editTypeOverride:"calc"}),{width:o({},g.width,{editType:"calc"}),editType:"calc"}),a=o(v("marker"),{symbol:r.symbol,angle:r.angle,size:o({},r.size,{editType:"markerSize"}),sizeref:r.sizeref,sizemin:r.sizemin,sizemode:r.sizemode,opacity:r.opacity,colorbar:r.colorbar,line:c,editType:"calc"});function h(l){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:t[l],editType:"plot"}}}a.color.editType=a.cmin.editType=a.cmax.editType="style",G.exports={dimensions:n("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:o({},e.text,{}),hovertext:o({},e.hovertext,{}),hovertemplate:y(),xhoverformat:w("x"),yhoverformat:w("y"),marker:a,xaxes:h("x"),yaxes:h("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:e.selected.marker,editType:"calc"},unselected:{marker:e.unselected.marker,editType:"calc"},opacity:e.opacity}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/plot_template":555,"../../plots/cartesian/axis_format_attributes":569,"../../plots/cartesian/constants":573,"../../plots/template_attributes":642,"../scatter/attributes":936,"../scattergl/attributes":988}],1042:[function(m,G,Y){var d=m("../../registry"),v=m("../../components/grid");G.exports={moduleType:"trace",name:"splom",categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:m("../scatter/marker_colorbar"),calc:m("./calc"),plot:m("./plot"),hoverPoints:m("./hover").hoverPoints,selectPoints:m("./select"),editStyle:m("./edit_style"),meta:{}},d.register(v)},{"../../components/grid":411,"../../registry":647,"../scatter/marker_colorbar":954,"./attributes":1041,"./calc":1044,"./defaults":1045,"./edit_style":1046,"./hover":1048,"./plot":1050,"./select":1052}],1043:[function(m,G,Y){var d=m("regl-line2d"),v=m("../../registry"),w=m("../../lib/prepare_regl"),y=m("../../plots/get_data").getModuleCalcData,e=m("../../plots/cartesian"),t=m("../../plots/cartesian/axis_ids").getFromId,n=m("../../plots/cartesian/axes").shouldShowZeroLine,o={};function r(c,a,h){for(var l=h.matrixOptions.data.length,s=a._visibleDims,p=h.viewOpts.ranges=new Array(l),u=0;u<s.length;u++){var i=s[u],x=p[u]=new Array(4),f=t(c,a._diag[i][0]);f&&(x[0]=f.r2l(f.range[0]),x[2]=f.r2l(f.range[1]));var _=t(c,a._diag[i][1]);_&&(x[1]=_.r2l(_.range[0]),x[3]=_.r2l(_.range[1]))}h.selectBatch.length||h.unselectBatch.length?h.matrix.update({ranges:p},{ranges:p}):h.matrix.update({ranges:p})}function g(c){var a=c._fullLayout,h=a._glcanvas.data()[0].regl,l=a._splomGrid;l||(l=a._splomGrid=d(h)),l.update(function(s){var p,u=s._context.plotGlPixelRatio,i=s._fullLayout,x=i._size,f=[0,0,i.width*u,i.height*u],_={};function b(X,$,re,H,N,U){re*=u,H*=u,N*=u,U*=u;var te=$[X+"color"],B=$[X+"width"],K=String(te+B);K in _?_[K].data.push(NaN,NaN,re,H,N,U):_[K]={data:[re,H,N,U],join:"rect",thickness:B*u,color:te,viewport:f,range:f,overlay:!1}}for(p in i._splomSubplots){var T,k,L=i._plots[p],A=L.xaxis,I=L.yaxis,P=A._gridVals,S=I._gridVals,E=A._offset,z=A._length,D=I._length,j=x.b+I.domain[0]*x.h,V=-I._m,Z=-V*I.r2l(I.range[0],I.calendar);if(A.showgrid)for(p=0;p<P.length;p++)T=E+A.l2p(P[p].x),b("grid",A,T,j,T,j+D);if(I.showgrid)for(p=0;p<S.length;p++)k=j+Z+V*S[p].x,b("grid",I,E,k,E+z,k);n(s,A,I)&&(T=E+A.l2p(0),b("zeroline",A,T,j,T,j+D)),n(s,I,A)&&b("zeroline",I,E,k=j+Z+0,E+z,k)}var Q=[];for(p in _)Q.push(_[p]);return Q}(c))}G.exports={name:"splom",attr:e.attr,attrRegex:e.attrRegex,layoutAttributes:e.layoutAttributes,supplyLayoutDefaults:e.supplyLayoutDefaults,drawFramework:e.drawFramework,plot:function(c){var a=c._fullLayout,h=v.getModule("splom"),l=y(c.calcdata,h)[0];w(c,["ANGLE_instanced_arrays","OES_element_index_uint"],o)&&(a._hasOnlyLargeSploms&&g(c),h.plot(c,{},l))},drag:function(c){var a=c.calcdata,h=c._fullLayout;h._hasOnlyLargeSploms&&g(c);for(var l=0;l<a.length;l++){var s=a[l][0].trace,p=h._splomScenes[s.uid];s.type==="splom"&&p&&p.matrix&&r(c,s,p)}},updateGrid:g,clean:function(c,a,h,l){var s,p={};if(l._splomScenes){for(s=0;s<c.length;s++){var u=c[s];u.type==="splom"&&(p[u.uid]=1)}for(s=0;s<h.length;s++){var i=h[s];if(!p[i.uid]){var x=l._splomScenes[i.uid];x&&x.destroy&&x.destroy(),l._splomScenes[i.uid]=null,delete l._splomScenes[i.uid]}}}Object.keys(l._splomScenes||{}).length===0&&delete l._splomScenes,l._splomGrid&&!a._hasOnlyLargeSploms&&l._hasOnlyLargeSploms&&(l._splomGrid.destroy(),l._splomGrid=null,delete l._splomGrid),e.clean(c,a,h,l)},updateFx:e.updateFx,toSVG:e.toSVG,reglPrecompiled:o}},{"../../lib/prepare_regl":528,"../../plots/cartesian":578,"../../plots/cartesian/axes":566,"../../plots/cartesian/axis_ids":570,"../../plots/get_data":602,"../../registry":647,"regl-line2d":281}],1044:[function(m,G,Y){var d=m("../../lib"),v=m("../../plots/cartesian/axis_ids"),w=m("../scatter/calc").calcMarkerSize,y=m("../scatter/calc").calcAxisExpansion,e=m("../scatter/colorscale_calc"),t=m("../scattergl/convert").markerSelection,n=m("../scattergl/convert").markerStyle,o=m("./scene_update"),r=m("../../constants/numerical").BADNUM,g=m("../scattergl/constants").TOO_MANY_POINTS;G.exports=function(c,a){var h,l,s,p,u,i,x=a.dimensions,f=a._length,_={},b=_.cdata=[],T=_.data=[],k=a._visibleDims=[];function L(I,P){for(var S=I.makeCalcdata({v:P.values,vcalendar:a.calendar},"v"),E=0;E<S.length;E++)S[E]=S[E]===r?NaN:S[E];b.push(S),T.push(I.type==="log"?d.simpleMap(S,I.c2l):S)}for(h=0;h<x.length;h++)if((s=x[h]).visible){if(p=v.getFromId(c,a._diag[h][0]),u=v.getFromId(c,a._diag[h][1]),p&&u&&p.type!==u.type){d.log("Skipping splom dimension "+h+" with conflicting axis types");continue}p?(L(p,s),u&&u.type==="category"&&(u._categories=p._categories.slice())):L(u,s),k.push(h)}for(e(c,a),d.extendFlat(_,n(c,a)),i=b.length*f>g?_.sizeAvg||Math.max(_.size,3):w(a,f),l=0;l<k.length;l++)s=x[h=k[l]],p=v.getFromId(c,a._diag[h][0])||{},u=v.getFromId(c,a._diag[h][1])||{},y(c,a,p,u,b[l],b[l],i);var A=o(c,a);return A.matrix||(A.matrix=!0),A.matrixOptions=_,A.selectedOptions=t(c,a,a.selected),A.unselectedOptions=t(c,a,a.unselected),[{x:!1,y:!1,t:{},trace:a}]}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axis_ids":570,"../scatter/calc":937,"../scatter/colorscale_calc":939,"../scattergl/constants":991,"../scattergl/convert":992,"./scene_update":1051}],1045:[function(m,G,Y){var d=m("../../lib"),v=m("../../plots/array_container_defaults"),w=m("./attributes"),y=m("../scatter/subtypes"),e=m("../scatter/marker_defaults"),t=m("../parcoords/merge_length"),n=m("../scattergl/helpers").isOpenSymbol;function o(r,g){function c(h,l){return d.coerce(r,g,w.dimensions,h,l)}c("label");var a=c("values");a&&a.length?c("visible"):g.visible=!1,c("axis.type"),c("axis.matches")}G.exports=function(r,g,c,a){function h(f,_){return d.coerce(r,g,w,f,_)}var l=v(r,g,{name:"dimensions",handleItemDefaults:o}),s=h("diagonal.visible"),p=h("showupperhalf"),u=h("showlowerhalf");if(t(g,l,"values")&&(s||p||u)){h("text"),h("hovertext"),h("hovertemplate"),h("xhoverformat"),h("yhoverformat"),e(r,g,c,a,h,{noAngleRef:!0,noStandOff:!0});var i=n(g.marker.symbol),x=y.isBubble(g);h("marker.line.width",i||x?1:0),function(f,_,b,T){var k,L,A=_.dimensions,I=A.length,P=_.showupperhalf,S=_.showlowerhalf,E=_.diagonal.visible,z=new Array(I),D=new Array(I);for(k=0;k<I;k++){var j=k?k+1:"";z[k]="x"+j,D[k]="y"+j}var V=T("xaxes",z),Z=T("yaxes",D),Q=_._diag=new Array(I);_._xaxes={},_._yaxes={};var X=[],$=[];function re(ne,se,oe,me){if(ne){var ce=ne.charAt(0),ye=b._splomAxes[ce];if(_["_"+ce+"axes"][ne]=1,me.push(ne),!(ne in ye)){var Se=ye[ne]={};oe&&(Se.label=oe.label||"",oe.visible&&oe.axis&&(oe.axis.type&&(Se.type=oe.axis.type),oe.axis.matches&&(Se.matches=se)))}}}var H=!E&&!S,N=!E&&!P;for(_._axesDim={},k=0;k<I;k++){var U=A[k],te=k===0,B=k===I-1,K=te&&H||B&&N?void 0:V[k],J=te&&N||B&&H?void 0:Z[k];re(K,J,U,X),re(J,K,U,$),Q[k]=[K,J],_._axesDim[K]=k,_._axesDim[J]=k}for(k=0;k<X.length;k++)for(L=0;L<$.length;L++){var ee=X[k]+$[L];k>L&&P||k<L&&S?b._splomSubplots[ee]=1:k!==L||!E&&S&&P||(b._splomSubplots[ee]=1)}(!S||!E&&P&&S)&&(b._splomGridDflt.xside="bottom",b._splomGridDflt.yside="left")}(0,g,a,h),d.coerceSelectionMarkerOpacity(g,h)}else g.visible=!1}},{"../../lib":515,"../../plots/array_container_defaults":561,"../parcoords/merge_length":907,"../scatter/marker_defaults":955,"../scatter/subtypes":961,"../scattergl/helpers":996,"./attributes":1041}],1046:[function(m,G,Y){var d=m("../../lib"),v=m("../scatter/colorscale_calc"),w=m("../scattergl/convert").markerStyle;G.exports=function(y,e){var t=e.trace,n=y._fullLayout._splomScenes[t.uid];if(n){v(y,t),d.extendFlat(n.matrixOptions,w(y,t));var o=d.extendFlat({},n.matrixOptions,n.viewOpts);n.matrix.update(o,null)}}},{"../../lib":515,"../scatter/colorscale_calc":939,"../scattergl/convert":992}],1047:[function(m,G,Y){Y.getDimIndex=function(d,v){for(var w=v._id,y={x:0,y:1}[w.charAt(0)],e=d._visibleDims,t=0;t<e.length;t++){var n=e[t];if(d._diag[n][y]===w)return t}return!1}},{}],1048:[function(m,G,Y){var d=m("./helpers"),v=m("../scattergl/hover").calcHover;G.exports={hoverPoints:function(w,y,e){var t=w.cd[0].trace,n=w.scene.matrixOptions.cdata,o=w.xa,r=w.ya,g=o.c2p(y),c=r.c2p(e),a=w.distance,h=d.getDimIndex(t,o),l=d.getDimIndex(t,r);if(h===!1||l===!1)return[w];for(var s,p,u=n[h],i=n[l],x=a,f=0;f<u.length;f++){var _=u[f],b=i[f],T=o.c2p(_)-g,k=r.c2p(b)-c,L=Math.sqrt(T*T+k*k);L<x&&(x=p=L,s=f)}return w.index=s,w.distance=x,w.dxy=p,s===void 0?[w]:[v(w,u,i,t)]}}},{"../scattergl/hover":997,"./helpers":1047}],1049:[function(m,G,Y){var d=m("./base_index");d.basePlotModule=m("./base_plot"),G.exports=d},{"./base_index":1042,"./base_plot":1043}],1050:[function(m,G,Y){var d=m("regl-splom"),v=m("../../lib"),w=m("../../plots/cartesian/axis_ids"),y=m("../../components/dragelement/helpers").selectMode;function e(t,n){var o,r,g,c,a,h=t._fullLayout,l=h._size,s=n.trace,p=n.t,u=h._splomScenes[s.uid],i=u.matrixOptions,x=i.cdata,f=h._glcanvas.data()[0].regl,_=h.dragmode;if(x.length!==0){i.lower=s.showupperhalf,i.upper=s.showlowerhalf,i.diagonal=s.diagonal.visible;var b=s._visibleDims,T=x.length,k=u.viewOpts={};for(k.ranges=new Array(T),k.domains=new Array(T),a=0;a<b.length;a++){g=b[a];var L=k.ranges[a]=new Array(4),A=k.domains[a]=new Array(4);(o=w.getFromId(t,s._diag[g][0]))&&(L[0]=o._rl[0],L[2]=o._rl[1],A[0]=o.domain[0],A[2]=o.domain[1]),(r=w.getFromId(t,s._diag[g][1]))&&(L[1]=r._rl[0],L[3]=r._rl[1],A[1]=r.domain[0],A[3]=r.domain[1])}var I=t._context.plotGlPixelRatio,P=l.l*I,S=l.b*I,E=l.w*I,z=l.h*I;k.viewport=[P,S,E+P,z+S],u.matrix===!0&&(u.matrix=d(f));var D=h.clickmode.indexOf("select")>-1,j=!0;if(y(_)||!!s.selectedpoints||D){var V=s._length;if(s.selectedpoints){u.selectBatch=s.selectedpoints;var Z=s.selectedpoints,Q={};for(g=0;g<Z.length;g++)Q[Z[g]]=!0;var X=[];for(g=0;g<V;g++)Q[g]||X.push(g);u.unselectBatch=X}var $=p.xpx=new Array(T),re=p.ypx=new Array(T);for(a=0;a<b.length;a++){if(g=b[a],o=w.getFromId(t,s._diag[g][0]))for($[a]=new Array(V),c=0;c<V;c++)$[a][c]=o.c2p(x[a][c]);if(r=w.getFromId(t,s._diag[g][1]))for(re[a]=new Array(V),c=0;c<V;c++)re[a][c]=r.c2p(x[a][c])}if(u.selectBatch.length||u.unselectBatch.length){var H=v.extendFlat({},i,u.unselectedOptions,k),N=v.extendFlat({},i,u.selectedOptions,k);u.matrix.update(H,N),j=!1}}else p.xpx=p.ypx=null;if(j){var U=v.extendFlat({},i,k);u.matrix.update(U,null)}}}G.exports=function(t,n,o){if(o.length)for(var r=0;r<o.length;r++)e(t,o[r][0])}},{"../../components/dragelement/helpers":385,"../../lib":515,"../../plots/cartesian/axis_ids":570,"regl-splom":283}],1051:[function(m,G,Y){var d=m("../../lib");G.exports=function(v,w){var y=v._fullLayout,e=w.uid,t=y._splomScenes;t||(t=y._splomScenes={});var n={dirty:!0,selectBatch:[],unselectBatch:[]},o=t[w.uid];return o||((o=t[e]=d.extendFlat({},n,{matrix:!1,selectBatch:[],unselectBatch:[]})).draw=function(){o.matrix&&o.matrix.draw&&(o.selectBatch.length||o.unselectBatch.length?o.matrix.draw(o.unselectBatch,o.selectBatch):o.matrix.draw()),o.dirty=!1},o.destroy=function(){o.matrix&&o.matrix.destroy&&o.matrix.destroy(),o.matrixOptions=null,o.selectBatch=null,o.unselectBatch=null,o=null}),o.dirty||d.extendFlat(o,n),o}},{"../../lib":515}],1052:[function(m,G,Y){var d=m("../../lib"),v=d.pushUnique,w=m("../scatter/subtypes"),y=m("./helpers");G.exports=function(e,t){var n=e.cd,o=n[0].trace,r=n[0].t,g=e.scene,c=g.matrixOptions.cdata,a=e.xaxis,h=e.yaxis,l=[];if(!g)return l;var s=!w.hasMarkers(o)&&!w.hasText(o);if(o.visible!==!0||s)return l;var p=y.getDimIndex(o,a),u=y.getDimIndex(o,h);if(p===!1||u===!1)return l;var i=r.xpx[p],x=r.ypx[u],f=c[p],_=c[u],b=(e.scene.selectBatch||[]).slice(),T=[];if(t!==!1&&!t.degenerate)for(var k=0;k<f.length;k++)t.contains([i[k],x[k]],null,k,e)?(l.push({pointNumber:k,x:f[k],y:_[k]}),v(b,k)):b.indexOf(k)!==-1?v(b,k):T.push(k);var L=g.matrixOptions;return b.length||T.length?g.selectBatch.length||g.unselectBatch.length||g.matrix.update(g.unselectedOptions,d.extendFlat({},L,g.selectedOptions,g.viewOpts)):g.matrix.update(L,null),g.selectBatch=b,g.unselectBatch=T,l}},{"../../lib":515,"../scatter/subtypes":961,"./helpers":1047}],1053:[function(m,G,Y){var d=m("../../components/colorscale/attributes"),v=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,w=m("../../plots/template_attributes").hovertemplateAttrs,y=m("../mesh3d/attributes"),e=m("../../plots/attributes"),t=m("../../lib/extend").extendFlat,n={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:w({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),uhoverformat:v("u",1),vhoverformat:v("v",1),whoverformat:v("w",1),xhoverformat:v("x"),yhoverformat:v("y"),zhoverformat:v("z"),showlegend:t({},e.showlegend,{dflt:!1})};t(n,d("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach(function(o){n[o]=y[o]}),n.hoverinfo=t({},e.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),n.transforms=void 0,G.exports=n},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../mesh3d/attributes":876}],1054:[function(m,G,Y){var d=m("../../lib"),v=m("../../components/colorscale/calc");function w(t){var n,o,r,g,c,a,h,l,s,p,u,i,x=t._x,f=t._y,_=t._z,b=t._len,T=-1/0,k=1/0,L=-1/0,A=1/0,I=-1/0,P=1/0,S="";for(b&&(h=x[0],s=f[0],u=_[0]),b>1&&(l=x[b-1],p=f[b-1],i=_[b-1]),n=0;n<b;n++)T=Math.max(T,x[n]),k=Math.min(k,x[n]),L=Math.max(L,f[n]),A=Math.min(A,f[n]),I=Math.max(I,_[n]),P=Math.min(P,_[n]),g||x[n]===h||(g=!0,S+="x"),c||f[n]===s||(c=!0,S+="y"),a||_[n]===u||(a=!0,S+="z");g||(S+="x"),c||(S+="y"),a||(S+="z");var E=y(t._x),z=y(t._y),D=y(t._z);S=(S=(S=S.replace("x",(h>l?"-":"+")+"x")).replace("y",(s>p?"-":"+")+"y")).replace("z",(u>i?"-":"+")+"z");var j=function(){b=0,E=[],z=[],D=[]};(!b||b<E.length*z.length*D.length)&&j();var V=function(ce){return ce==="x"?x:ce==="y"?f:_},Z=function(ce){return ce==="x"?E:ce==="y"?z:D},Q=function(ce){return ce[b-1]<ce[0]?-1:1},X=V(S[1]),$=V(S[3]),re=V(S[5]),H=Z(S[1]).length,N=Z(S[3]).length,U=Z(S[5]).length,te=!1,B=function(ce,ye,Se){return H*(N*ce+ye)+Se},K=Q(V(S[1])),J=Q(V(S[3])),ee=Q(V(S[5]));for(n=0;n<U-1;n++){for(o=0;o<N-1;o++){for(r=0;r<H-1;r++){var ne=B(n,o,r),se=B(n,o,r+1),oe=B(n,o+1,r),me=B(n+1,o,r);if(X[ne]*K<X[se]*K&&$[ne]*J<$[oe]*J&&re[ne]*ee<re[me]*ee||(te=!0),te)break}if(te)break}if(te)break}return te&&(d.warn("Encountered arbitrary coordinates! Unable to input data grid."),j()),{xMin:k,yMin:A,zMin:P,xMax:T,yMax:L,zMax:I,Xs:E,Ys:z,Zs:D,len:b,fill:S}}function y(t){return d.distinctVals(t).vals}function e(t,n){if(n===void 0&&(n=t.length),d.isTypedArray(t))return t.subarray(0,n);for(var o=[],r=0;r<n;r++)o[r]=+t[r];return o}G.exports={calc:function(t,n){n._len=Math.min(n.u.length,n.v.length,n.w.length,n.x.length,n.y.length,n.z.length),n._u=e(n.u,n._len),n._v=e(n.v,n._len),n._w=e(n.w,n._len),n._x=e(n.x,n._len),n._y=e(n.y,n._len),n._z=e(n.z,n._len);var o=w(n);n._gridFill=o.fill,n._Xs=o.Xs,n._Ys=o.Ys,n._Zs=o.Zs,n._len=o.len;var r,g,c,a=0;n.starts&&(r=e(n.starts.x||[]),g=e(n.starts.y||[]),c=e(n.starts.z||[]),a=Math.min(r.length,g.length,c.length)),n._startsX=r||[],n._startsY=g||[],n._startsZ=c||[];var h,l=0,s=1/0;for(h=0;h<n._len;h++){var p=n._u[h],u=n._v[h],i=n._w[h],x=Math.sqrt(p*p+u*u+i*i);l=Math.max(l,x),s=Math.min(s,x)}for(v(t,n,{vals:[s,l],containerStr:"",cLetter:"c"}),h=0;h<a;h++){var f=r[h];o.xMax=Math.max(o.xMax,f),o.xMin=Math.min(o.xMin,f);var _=g[h];o.yMax=Math.max(o.yMax,_),o.yMin=Math.min(o.yMin,_);var b=c[h];o.zMax=Math.max(o.zMax,b),o.zMin=Math.min(o.zMin,b)}n._slen=a,n._normMax=l,n._xbnds=[o.xMin,o.xMax],n._ybnds=[o.yMin,o.yMax],n._zbnds=[o.zMin,o.zMax]},filter:e,processGrid:w}},{"../../components/colorscale/calc":375,"../../lib":515}],1055:[function(m,G,Y){var d=m("../../../stackgl_modules").gl_streamtube3d,v=d.createTubeMesh,w=m("../../lib"),y=m("../../lib/gl_format_color").parseColorScale,e=m("../../components/colorscale").extractOpts,t=m("../../plots/gl3d/zip3"),n={xaxis:0,yaxis:1,zaxis:2};function o(h,l){this.scene=h,this.uid=l,this.mesh=null,this.data=null}var r=o.prototype;function g(h){var l=h.length;return l>2?h.slice(1,l-1):l===2?[(h[0]+h[1])/2]:h}function c(h){var l=h.length;return l===1?[.5,.5]:[h[1]-h[0],h[l-1]-h[l-2]]}function a(h,l){var s=h.fullSceneLayout,p=h.dataScale,u=l._len,i={};function x(H,N){var U=s[N],te=p[n[N]];return w.simpleMap(H,function(B){return U.d2l(B)*te})}if(i.vectors=t(x(l._u,"xaxis"),x(l._v,"yaxis"),x(l._w,"zaxis"),u),!u)return{positions:[],cells:[]};var f=x(l._Xs,"xaxis"),_=x(l._Ys,"yaxis"),b=x(l._Zs,"zaxis");if(i.meshgrid=[f,_,b],i.gridFill=l._gridFill,l._slen)i.startingPositions=t(x(l._startsX,"xaxis"),x(l._startsY,"yaxis"),x(l._startsZ,"zaxis"));else{for(var T=_[0],k=g(f),L=g(b),A=new Array(k.length*L.length),I=0,P=0;P<k.length;P++)for(var S=0;S<L.length;S++)A[I++]=[k[P],T,L[S]];i.startingPositions=A}i.colormap=y(l),i.tubeSize=l.sizeref,i.maxLength=l.maxdisplayed;var E=x(l._xbnds,"xaxis"),z=x(l._ybnds,"yaxis"),D=x(l._zbnds,"zaxis"),j=c(f),V=c(_),Z=c(b),Q=[[E[0]-j[0],z[0]-V[0],D[0]-Z[0]],[E[1]+j[1],z[1]+V[1],D[1]+Z[1]]],X=d(i,Q),$=e(l);X.vertexIntensityBounds=[$.min/l._normMax,$.max/l._normMax];var re=l.lightposition;return X.lightPosition=[re.x,re.y,re.z],X.ambient=l.lighting.ambient,X.diffuse=l.lighting.diffuse,X.specular=l.lighting.specular,X.roughness=l.lighting.roughness,X.fresnel=l.lighting.fresnel,X.opacity=l.opacity,l._pad=X.tubeScale*l.sizeref*2,X}r.handlePick=function(h){var l=this.scene.fullSceneLayout,s=this.scene.dataScale;function p(x,f){var _=l[f],b=s[n[f]];return _.l2c(x)/b}if(h.object===this.mesh){var u=h.data.position,i=h.data.velocity;return h.traceCoordinate=[p(u[0],"xaxis"),p(u[1],"yaxis"),p(u[2],"zaxis"),p(i[0],"xaxis"),p(i[1],"yaxis"),p(i[2],"zaxis"),h.data.intensity*this.data._normMax,h.data.divergence],h.textLabel=this.data.hovertext||this.data.text,!0}},r.update=function(h){this.data=h;var l=a(this.scene,h);this.mesh.update(l)},r.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},G.exports=function(h,l){var s=h.glplot.gl,p=a(h,l),u=v(s,p),i=new o(h,l.uid);return i.mesh=u,i.data=l,u._trace=i,h.glplot.add(u),i}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../plots/gl3d/zip3":618}],1056:[function(m,G,Y){var d=m("../../lib"),v=m("../../components/colorscale/defaults"),w=m("./attributes");G.exports=function(y,e,t,n){function o(s,p){return d.coerce(y,e,w,s,p)}var r=o("u"),g=o("v"),c=o("w"),a=o("x"),h=o("y"),l=o("z");r&&r.length&&g&&g.length&&c&&c.length&&a&&a.length&&h&&h.length&&l&&l.length?(o("starts.x"),o("starts.y"),o("starts.z"),o("maxdisplayed"),o("sizeref"),o("lighting.ambient"),o("lighting.diffuse"),o("lighting.specular"),o("lighting.roughness"),o("lighting.fresnel"),o("lightposition.x"),o("lightposition.y"),o("lightposition.z"),v(y,e,n,o,{prefix:"",cLetter:"c"}),o("text"),o("hovertext"),o("hovertemplate"),o("uhoverformat"),o("vhoverformat"),o("whoverformat"),o("xhoverformat"),o("yhoverformat"),o("zhoverformat"),e._length=null):e.visible=!1}},{"../../components/colorscale/defaults":377,"../../lib":515,"./attributes":1053}],1057:[function(m,G,Y){G.exports={moduleType:"trace",name:"streamtube",basePlotModule:m("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:m("./attributes"),supplyDefaults:m("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:m("./calc").calc,plot:m("./convert"),eventData:function(d,v){return d.tubex=d.x,d.tubey=d.y,d.tubez=d.z,d.tubeu=v.traceCoordinate[3],d.tubev=v.traceCoordinate[4],d.tubew=v.traceCoordinate[5],d.norm=v.traceCoordinate[6],d.divergence=v.traceCoordinate[7],delete d.x,delete d.y,delete d.z,d},meta:{}}},{"../../plots/gl3d":607,"./attributes":1053,"./calc":1054,"./convert":1055,"./defaults":1056}],1058:[function(m,G,Y){var d=m("../../plots/attributes"),v=m("../../plots/template_attributes").hovertemplateAttrs,w=m("../../plots/template_attributes").texttemplateAttrs,y=m("../../components/colorscale/attributes"),e=m("../../plots/domain").attributes,t=m("../pie/attributes"),n=m("./constants"),o=m("../../lib/extend").extendFlat;G.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:o({colors:{valType:"data_array",editType:"calc"},line:{color:o({},t.marker.line.color,{dflt:null}),width:o({},t.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},y("marker",{colorAttr:"colors",anim:!1})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:t.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:w({editType:"plot"},{keys:n.eventDataKeys.concat(["label","value"])}),hovertext:t.hovertext,hoverinfo:o({},d.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:v({},{keys:n.eventDataKeys}),textfont:t.textfont,insidetextorientation:t.insidetextorientation,insidetextfont:t.insidetextfont,outsidetextfont:o({},t.outsidetextfont,{}),rotation:{valType:"angle",dflt:0,editType:"plot"},sort:t.sort,root:{color:{valType:"color",editType:"calc",dflt:"rgba(0,0,0,0)"},editType:"calc"},domain:e({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"./constants":1061}],1059:[function(m,G,Y){var d=m("../../plots/plots");Y.name="sunburst",Y.plot=function(v,w,y,e){d.plotBasePlot(Y.name,v,w,y,e)},Y.clean=function(v,w,y,e){d.cleanBasePlot(Y.name,v,w,y,e)}},{"../../plots/plots":628}],1060:[function(m,G,Y){var d=m("d3-hierarchy"),v=m("fast-isnumeric"),w=m("../../lib"),y=m("../../components/colorscale").makeColorScaleFuncFromTrace,e=m("../pie/calc").makePullColorFn,t=m("../pie/calc").generateExtendedColors,n=m("../../components/colorscale").calc,o=m("../../constants/numerical").ALMOST_EQUAL,r={},g={},c={};Y.calc=function(a,h){var l,s,p,u,i,x,f=a._fullLayout,_=h.ids,b=w.isArrayOrTypedArray(_),T=h.labels,k=h.parents,L=h.values,A=w.isArrayOrTypedArray(L),I=[],P={},S={},E=function(J){return J||typeof J=="number"},z=function(J){return!A||v(L[J])&&L[J]>=0};b?(l=Math.min(_.length,k.length),s=function(J){return E(_[J])&&z(J)},p=function(J){return String(_[J])}):(l=Math.min(T.length,k.length),s=function(J){return E(T[J])&&z(J)},p=function(J){return String(T[J])}),A&&(l=Math.min(l,L.length));for(var D=0;D<l;D++)if(s(D)){var j=p(D),V=E(k[D])?String(k[D]):"",Z={i:D,id:j,pid:V,label:E(T[D])?String(T[D]):""};A&&(Z.v=+L[D]),I.push(Z),i=j,P[u=V]?P[u].push(i):P[u]=[i],S[i]=1}if(P[""]){if(P[""].length>1){for(var Q=w.randstr(),X=0;X<I.length;X++)I[X].pid===""&&(I[X].pid=Q);I.unshift({hasMultipleRoots:!0,id:Q,pid:"",label:""})}}else{var $,re=[];for($ in P)S[$]||re.push($);if(re.length!==1)return w.warn(["Multiple implied roots, cannot build",h.type,"hierarchy of",h.name+".","These roots include:",re.join(", ")].join(" "));$=re[0],I.unshift({hasImpliedRoot:!0,id:$,pid:"",label:$})}try{x=d.stratify().id(function(J){return J.id}).parentId(function(J){return J.pid})(I)}catch(J){return w.warn(["Failed to build",h.type,"hierarchy of",h.name+".","Error:",J.message].join(" "))}var H=d.hierarchy(x),N=!1;if(A)switch(h.branchvalues){case"remainder":H.sum(function(J){return J.data.v});break;case"total":H.each(function(J){var ee=J.data.data,ne=ee.v;if(J.children){var se=J.children.reduce(function(oe,me){return oe+me.data.data.v},0);if((ee.hasImpliedRoot||ee.hasMultipleRoots)&&(ne=se),ne<se*o)return N=!0,w.warn(["Total value for node",J.data.data.id,"of",h.name,"is smaller than the sum of its children.",`
parent value =`,ne,`
children sum =`,se].join(" "))}J.value=ne})}else(function J(ee,ne,se){var oe=0,me=ee.children;if(me){for(var ce=me.length,ye=0;ye<ce;ye++)oe+=J(me[ye],ne,se);se.branches&&oe++}else se.leaves&&oe++;return ee.value=ee.data.data.value=oe,ne._values||(ne._values=[]),ne._values[ee.data.data.i]=oe,oe})(H,h,{branches:h.count.indexOf("branches")!==-1,leaves:h.count.indexOf("leaves")!==-1});if(!N){var U,te;h.sort&&H.sort(function(J,ee){return ee.value-J.value});var B=h.marker.colors||[],K=!!B.length;return h._hasColorscale?(K||(B=A?h.values:h._values),n(a,h,{vals:B,containerStr:"marker",cLetter:"c"}),te=y(h.marker)):U=e(f["_"+h.type+"colormap"]),H.each(function(J){var ee=J.data.data;ee.color=h._hasColorscale?te(B[ee.i]):U(B[ee.i],ee.id)}),I[0].hierarchy=H,I}},Y._runCrossTraceCalc=function(a,h){var l=h._fullLayout,s=h.calcdata,p=l[a+"colorway"],u=l["_"+a+"colormap"];l["extend"+a+"colors"]&&(p=t(p,a==="icicle"?c:a==="treemap"?g:r));var i,x=0;function f(T){var k=T.data.data,L=k.id;k.color===!1&&(u[L]?k.color=u[L]:T.parent?T.parent.parent?k.color=T.parent.data.data.color:(u[L]=k.color=p[x%p.length],x++):k.color=i)}for(var _=0;_<s.length;_++){var b=s[_][0];b.trace.type===a&&b.hierarchy&&(i=b.trace.root.color,b.hierarchy.each(f))}},Y.crossTraceCalc=function(a){return Y._runCrossTraceCalc("sunburst",a)}},{"../../components/colorscale":379,"../../constants/numerical":491,"../../lib":515,"../pie/calc":912,"d3-hierarchy":115,"fast-isnumeric":190}],1061:[function(m,G,Y){G.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1062:[function(m,G,Y){var d=m("../../lib"),v=m("./attributes"),w=m("../../plots/domain").defaults,y=m("../bar/defaults").handleText,e=m("../../components/colorscale"),t=e.hasColorscale,n=e.handleDefaults;G.exports=function(o,r,g,c){function a(i,x){return d.coerce(o,r,v,i,x)}var h=a("labels"),l=a("parents");if(h&&h.length&&l&&l.length){var s=a("values");s&&s.length?a("branchvalues"):a("count"),a("level"),a("maxdepth"),a("marker.line.width")&&a("marker.line.color",c.paper_bgcolor),a("marker.colors");var p=r._hasColorscale=t(o,"marker","colors")||(o.marker||{}).coloraxis;p&&n(o,r,c,a,{prefix:"marker.",cLetter:"c"}),a("leaf.opacity",p?1:.7);var u=a("text");a("texttemplate"),r.texttemplate||a("textinfo",Array.isArray(u)?"text+label":"label"),a("hovertext"),a("hovertemplate"),y(o,r,c,a,"auto",{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),a("insidetextorientation"),a("sort"),a("rotation"),a("root.color"),w(r,c,a),r._length=null}else r.visible=!1}},{"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/defaults":661,"./attributes":1058}],1063:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../registry"),w=m("../../components/fx/helpers").appendArrayPointValue,y=m("../../components/fx"),e=m("../../lib"),t=m("../../lib/events"),n=m("./helpers"),o=m("../pie/helpers").formatPieValue;function r(g,c,a){for(var h=g.data.data,l={curveNumber:c.index,pointNumber:h.i,data:c._input,fullData:c},s=0;s<a.length;s++){var p=a[s];p in g&&(l[p]=g[p])}return"parentString"in g&&!n.isHierarchyRoot(g)&&(l.parent=g.parentString),w(l,c,h.i),l}G.exports=function(g,c,a,h,l){var s=h[0],p=s.trace,u=s.hierarchy,i=p.type==="sunburst",x=p.type==="treemap"||p.type==="icicle";"_hasHoverLabel"in p||(p._hasHoverLabel=!1),"_hasHoverEvent"in p||(p._hasHoverEvent=!1),g.on("mouseover",function(f){var _=a._fullLayout;if(!a._dragging&&_.hovermode!==!1){var b,T=a._fullData[p.index],k=f.data.data,L=k.i,A=n.isHierarchyRoot(f),I=n.getParent(u,f),P=n.getValue(f),S=function(K){return e.castOption(T,L,K)},E=S("hovertemplate"),z=y.castHoverinfo(T,_,L),D=_.separators;if(E||z&&z!=="none"&&z!=="skip"){var j,V;i&&(j=s.cx+f.pxmid[0]*(1-f.rInscribed),V=s.cy+f.pxmid[1]*(1-f.rInscribed)),x&&(j=f._hoverX,V=f._hoverY);var Z,Q={},X=[],$=[],re=function(K){return X.indexOf(K)!==-1};z&&(X=z==="all"?T._module.attributes.hoverinfo.flags:z.split("+")),Q.label=k.label,re("label")&&Q.label&&$.push(Q.label),k.hasOwnProperty("v")&&(Q.value=k.v,Q.valueLabel=o(Q.value,D),re("value")&&$.push(Q.valueLabel)),Q.currentPath=f.currentPath=n.getPath(f.data),re("current path")&&!A&&$.push(Q.currentPath);var H=[],N=function(){H.indexOf(Z)===-1&&($.push(Z),H.push(Z))};Q.percentParent=f.percentParent=P/n.getValue(I),Q.parent=f.parentString=n.getPtLabel(I),re("percent parent")&&(Z=n.formatPercent(Q.percentParent,D)+" of "+Q.parent,N()),Q.percentEntry=f.percentEntry=P/n.getValue(c),Q.entry=f.entry=n.getPtLabel(c),!re("percent entry")||A||f.onPathbar||(Z=n.formatPercent(Q.percentEntry,D)+" of "+Q.entry,N()),Q.percentRoot=f.percentRoot=P/n.getValue(u),Q.root=f.root=n.getPtLabel(u),re("percent root")&&!A&&(Z=n.formatPercent(Q.percentRoot,D)+" of "+Q.root,N()),Q.text=S("hovertext")||S("text"),re("text")&&(Z=Q.text,e.isValidTextValue(Z)&&$.push(Z)),b=[r(f,T,l.eventDataKeys)];var U={trace:T,y:V,_x0:f._x0,_x1:f._x1,_y0:f._y0,_y1:f._y1,text:$.join("<br>"),name:E||re("name")?T.name:void 0,color:S("hoverlabel.bgcolor")||k.color,borderColor:S("hoverlabel.bordercolor"),fontFamily:S("hoverlabel.font.family"),fontSize:S("hoverlabel.font.size"),fontColor:S("hoverlabel.font.color"),nameLength:S("hoverlabel.namelength"),textAlign:S("hoverlabel.align"),hovertemplate:E,hovertemplateLabels:Q,eventData:b};i&&(U.x0=j-f.rInscribed*f.rpx1,U.x1=j+f.rInscribed*f.rpx1,U.idealAlign=f.pxmid[0]<0?"left":"right"),x&&(U.x=j,U.idealAlign=j<0?"left":"right");var te=[];y.loneHover(U,{container:_._hoverlayer.node(),outerContainer:_._paper.node(),gd:a,inOut_bbox:te}),b[0].bbox=te[0],p._hasHoverLabel=!0}if(x){var B=g.select("path.surface");l.styleOne(B,f,T,{hovered:!0})}p._hasHoverEvent=!0,a.emit("plotly_hover",{points:b||[r(f,T,l.eventDataKeys)],event:d.event})}}),g.on("mouseout",function(f){var _=a._fullLayout,b=a._fullData[p.index],T=d.select(this).datum();if(p._hasHoverEvent&&(f.originalEvent=d.event,a.emit("plotly_unhover",{points:[r(T,b,l.eventDataKeys)],event:d.event}),p._hasHoverEvent=!1),p._hasHoverLabel&&(y.loneUnhover(_._hoverlayer.node()),p._hasHoverLabel=!1),x){var k=g.select("path.surface");l.styleOne(k,T,b,{hovered:!1})}}),g.on("click",function(f){var _=a._fullLayout,b=a._fullData[p.index],T=i&&(n.isHierarchyRoot(f)||n.isLeaf(f)),k=n.getPtId(f),L=n.isEntry(f)?n.findEntryWithChild(u,k):n.findEntryWithLevel(u,k),A=n.getPtId(L),I={points:[r(f,b,l.eventDataKeys)],event:d.event};T||(I.nextLevel=A);var P=t.triggerHandler(a,"plotly_"+p.type+"click",I);if(P!==!1&&_.hovermode&&(a._hoverdata=[r(f,b,l.eventDataKeys)],y.click(a,d.event)),!T&&P!==!1&&!a._dragging&&!a._transitioning){v.call("_storeDirectGUIEdit",b,_._tracePreGUI[b.uid],{level:b.level});var S={data:[{level:A}],traces:[p.index]},E={frame:{redraw:!1,duration:l.transitionTime},transition:{duration:l.transitionTime,easing:l.transitionEasing},mode:"immediate",fromcurrent:!0};y.loneUnhover(_._hoverlayer.node()),v.call("animate",a,S,E)}})}},{"../../components/fx":407,"../../components/fx/helpers":403,"../../lib":515,"../../lib/events":504,"../../registry":647,"../pie/helpers":915,"./helpers":1064,"@plotly/d3":58}],1064:[function(m,G,Y){var d=m("../../lib"),v=m("../../components/color"),w=m("../../lib/setcursor"),y=m("../pie/helpers");function e(t){return t.data.data.pid}Y.findEntryWithLevel=function(t,n){var o;return n&&t.eachAfter(function(r){if(Y.getPtId(r)===n)return o=r.copy()}),o||t},Y.findEntryWithChild=function(t,n){var o;return t.eachAfter(function(r){for(var g=r.children||[],c=0;c<g.length;c++){var a=g[c];if(Y.getPtId(a)===n)return o=r.copy()}}),o||t},Y.isEntry=function(t){return!t.parent},Y.isLeaf=function(t){return!t.children},Y.getPtId=function(t){return t.data.data.id},Y.getPtLabel=function(t){return t.data.data.label},Y.getValue=function(t){return t.value},Y.isHierarchyRoot=function(t){return e(t)===""},Y.setSliceCursor=function(t,n,o){var r=o.isTransitioning;if(!r){var g=t.datum();r=o.hideOnRoot&&Y.isHierarchyRoot(g)||o.hideOnLeaves&&Y.isLeaf(g)}w(t,r?null:"pointer")},Y.getInsideTextFontKey=function(t,n,o,r,g){var c=(g||{}).onPathbar?"pathbar.textfont":"insidetextfont",a=o.data.data.i;return d.castOption(n,a,c+"."+t)||d.castOption(n,a,"textfont."+t)||r.size},Y.getOutsideTextFontKey=function(t,n,o,r){var g=o.data.data.i;return d.castOption(n,g,"outsidetextfont."+t)||d.castOption(n,g,"textfont."+t)||r.size},Y.isOutsideText=function(t,n){return!t._hasColorscale&&Y.isHierarchyRoot(n)},Y.determineTextFont=function(t,n,o,r){return Y.isOutsideText(t,n)?function(g,c,a){return{color:Y.getOutsideTextFontKey("color",g,c,a),family:Y.getOutsideTextFontKey("family",g,c,a),size:Y.getOutsideTextFontKey("size",g,c,a)}}(t,n,o):function(g,c,a,h){var l=(h||{}).onPathbar,s=c.data.data,p=s.i,u=d.castOption(g,p,(l?"pathbar.textfont":"insidetextfont")+".color");return!u&&g._input.textfont&&(u=d.castOption(g._input,p,"textfont.color")),{color:u||v.contrast(s.color),family:Y.getInsideTextFontKey("family",g,c,a,h),size:Y.getInsideTextFontKey("size",g,c,a,h)}}(t,n,o,r)},Y.hasTransition=function(t){return!!(t&&t.duration>0)},Y.getMaxDepth=function(t){return t.maxdepth>=0?t.maxdepth:1/0},Y.isHeader=function(t,n){return!(Y.isLeaf(t)||t.depth===n._maxDepth-1)},Y.getParent=function(t,n){return Y.findEntryWithLevel(t,e(n))},Y.listPath=function(t,n){var o=t.parent;if(!o)return[];var r=n?[o.data[n]]:[o];return Y.listPath(o,n).concat(r)},Y.getPath=function(t){return Y.listPath(t,"label").join("/")+"/"},Y.formatValue=y.formatPieValue,Y.formatPercent=function(t,n){var o=d.formatPercent(t,0);return o==="0%"&&(o=y.formatPiePercent(t,n)),o}},{"../../components/color":367,"../../lib":515,"../../lib/setcursor":536,"../pie/helpers":915}],1065:[function(m,G,Y){G.exports={moduleType:"trace",name:"sunburst",basePlotModule:m("./base_plot"),categories:[],animatable:!0,attributes:m("./attributes"),layoutAttributes:m("./layout_attributes"),supplyDefaults:m("./defaults"),supplyLayoutDefaults:m("./layout_defaults"),calc:m("./calc").calc,crossTraceCalc:m("./calc").crossTraceCalc,plot:m("./plot").plot,style:m("./style").style,colorbar:m("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":1058,"./base_plot":1059,"./calc":1060,"./defaults":1062,"./layout_attributes":1066,"./layout_defaults":1067,"./plot":1068,"./style":1069}],1066:[function(m,G,Y){G.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1067:[function(m,G,Y){var d=m("../../lib"),v=m("./layout_attributes");G.exports=function(w,y){function e(t,n){return d.coerce(w,y,v,t,n)}e("sunburstcolorway",y.colorway),e("extendsunburstcolors")}},{"../../lib":515,"./layout_attributes":1066}],1068:[function(m,G,Y){var d=m("@plotly/d3"),v=m("d3-hierarchy"),w=m("d3-interpolate").interpolate,y=m("../../components/drawing"),e=m("../../lib"),t=m("../../lib/svg_text_utils"),n=m("../bar/uniform_text"),o=n.recordMinTextSize,r=n.clearMinTextSize,g=m("../pie/plot"),c=m("../pie/helpers").getRotationAngle,a=g.computeTransform,h=g.transformInsideText,l=m("./style").styleOne,s=m("../bar/style").resizeText,p=m("./fx"),u=m("./constants"),i=m("./helpers");function x(_,b,T,k){var L=_._context.staticPlot,A=_._fullLayout,I=!A.uniformtext.mode&&i.hasTransition(k),P=d.select(T).selectAll("g.slice"),S=b[0],E=S.trace,z=S.hierarchy,D=i.findEntryWithLevel(z,E.level),j=i.getMaxDepth(E),V=A._size,Z=E.domain,Q=V.w*(Z.x[1]-Z.x[0]),X=V.h*(Z.y[1]-Z.y[0]),$=.5*Math.min(Q,X),re=S.cx=V.l+V.w*(Z.x[1]+Z.x[0])/2,H=S.cy=V.t+V.h*(1-Z.y[0])-X/2;if(!D)return P.remove();var N=null,U={};I&&P.each(function(le){U[i.getPtId(le)]={rpx0:le.rpx0,rpx1:le.rpx1,x0:le.x0,x1:le.x1,transform:le.transform},!N&&i.isEntry(le)&&(N=le)});var te=function(le){return v.partition().size([2*Math.PI,le.height+1])(le)}(D).descendants(),B=D.height+1,K=0,J=j;S.hasMultipleRoots&&i.isHierarchyRoot(D)&&(te=te.slice(1),B-=1,K=1,J+=1),te=te.filter(function(le){return le.y1<=J});var ee=c(E.rotation);ee&&te.forEach(function(le){le.x0+=ee,le.x1+=ee});var ne=Math.min(B,j),se=function(le){return(le-K)/ne*$},oe=function(le,ve){return[le*Math.cos(ve),-le*Math.sin(ve)]},me=function(le){return e.pathAnnulus(le.rpx0,le.rpx1,le.x0,le.x1,re,H)},ce=function(le){return re+f(le)[0]*(le.transform.rCenter||0)+(le.transform.x||0)},ye=function(le){return H+f(le)[1]*(le.transform.rCenter||0)+(le.transform.y||0)};(P=P.data(te,i.getPtId)).enter().append("g").classed("slice",!0),I?P.exit().transition().each(function(){var le=d.select(this);le.select("path.surface").transition().attrTween("d",function(ve){var Me=function(we){var de,Ie=i.getPtId(we),De=U[Ie],Oe=U[i.getPtId(D)];if(Oe){var Ve=(we.x1>Oe.x1?2*Math.PI:0)+ee;de=we.rpx1<Oe.rpx1?{x0:we.x0,x1:we.x1,rpx0:0,rpx1:0}:{x0:Ve,x1:Ve,rpx0:we.rpx0,rpx1:we.rpx1}}else{var Fe,ze=i.getPtId(we.parent);P.each(function(gt){if(i.getPtId(gt)===ze)return Fe=gt});var Re,We=Fe.children;We.forEach(function(gt,xt){if(i.getPtId(gt)===Ie)return Re=xt});var $e=We.length,at=w(Fe.x0,Fe.x1);de={rpx0:$,rpx1:$,x0:at(Re/$e),x1:at((Re+1)/$e)}}return w(De,de)}(ve);return function(we){return me(Me(we))}}),le.select("g.slicetext").attr("opacity",0)}).remove():P.exit().remove(),P.order();var Se=null;if(I&&N){var fe=i.getPtId(N);P.each(function(le){Se===null&&i.getPtId(le)===fe&&(Se=le.x1)})}var ge=P;function Te(le){var ve=le.parent,Me=U[i.getPtId(ve)],we={};if(Me){var de=ve.children,Ie=de.indexOf(le),De=de.length,Oe=w(Me.x0,Me.x1);we.x0=Oe(Ie/De),we.x1=Oe(Ie/De)}else we.x0=we.x1=0;return we}I&&(ge=ge.transition().each("end",function(){var le=d.select(this);i.setSliceCursor(le,_,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:!1})})),ge.each(function(le){var ve=d.select(this),Me=e.ensureSingle(ve,"path","surface",function(Ve){Ve.style("pointer-events",L?"none":"all")});le.rpx0=se(le.y0),le.rpx1=se(le.y1),le.xmid=(le.x0+le.x1)/2,le.pxmid=oe(le.rpx1,le.xmid),le.midangle=-(le.xmid-Math.PI/2),le.startangle=-(le.x0-Math.PI/2),le.stopangle=-(le.x1-Math.PI/2),le.halfangle=.5*Math.min(e.angleDelta(le.x0,le.x1)||Math.PI,Math.PI),le.ring=1-le.rpx0/le.rpx1,le.rInscribed=function(Ve){return Ve.rpx0===0&&e.isFullCircle([Ve.x0,Ve.x1])?1:Math.max(0,Math.min(1/(1+1/Math.sin(Ve.halfangle)),Ve.ring/2))}(le),I?Me.transition().attrTween("d",function(Ve){var Fe=function(ze){var Re,We=U[i.getPtId(ze)],$e={x0:ze.x0,x1:ze.x1,rpx0:ze.rpx0,rpx1:ze.rpx1};if(We)Re=We;else if(N)if(ze.parent)if(Se){var at=(ze.x1>Se?2*Math.PI:0)+ee;Re={x0:at,x1:at}}else Re={rpx0:$,rpx1:$},e.extendFlat(Re,Te(ze));else Re={rpx0:0,rpx1:0};else Re={x0:ee,x1:ee};return w(Re,$e)}(Ve);return function(ze){return me(Fe(ze))}}):Me.attr("d",me),ve.call(p,D,_,b,{eventDataKeys:u.eventDataKeys,transitionTime:u.CLICK_TRANSITION_TIME,transitionEasing:u.CLICK_TRANSITION_EASING}).call(i.setSliceCursor,_,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:_._transitioning}),Me.call(l,le,E);var we=e.ensureSingle(ve,"g","slicetext"),de=e.ensureSingle(we,"text","",function(Ve){Ve.attr("data-notex",1)}),Ie=e.ensureUniformFontSize(_,i.determineTextFont(E,le,A.font));de.text(Y.formatSliceLabel(le,D,E,b,A)).classed("slicetext",!0).attr("text-anchor","middle").call(y.font,Ie).call(t.convertToTspans,_);var De=y.bBox(de.node());le.transform=h(De,le,S),le.transform.targetX=ce(le),le.transform.targetY=ye(le);var Oe=function(Ve,Fe){var ze=Ve.transform;return a(ze,Fe),ze.fontSize=Ie.size,o(E.type,ze,A),e.getTextTransform(ze)};I?de.transition().attrTween("transform",function(Ve){var Fe=function(ze){var Re,We=U[i.getPtId(ze)],$e=ze.transform;if(We)Re=We;else if(Re={rpx1:ze.rpx1,transform:{textPosAngle:$e.textPosAngle,scale:0,rotate:$e.rotate,rCenter:$e.rCenter,x:$e.x,y:$e.y}},N)if(ze.parent)if(Se){var at=ze.x1>Se?2*Math.PI:0;Re.x0=Re.x1=at}else e.extendFlat(Re,Te(ze));else Re.x0=Re.x1=ee;else Re.x0=Re.x1=ee;var gt=w(Re.transform.textPosAngle,ze.transform.textPosAngle),xt=w(Re.rpx1,ze.rpx1),mt=w(Re.x0,ze.x0),nt=w(Re.x1,ze.x1),Qe=w(Re.transform.scale,$e.scale),vt=w(Re.transform.rotate,$e.rotate),jt=$e.rCenter===0?3:Re.transform.rCenter===0?1/3:1,Gt=w(Re.transform.rCenter,$e.rCenter);return function($t){var Zt=xt($t),cr=mt($t),Dt=nt($t),Ne=function(pe){return Gt(Math.pow(pe,jt))}($t),Ye={pxmid:oe(Zt,(cr+Dt)/2),rpx1:Zt,transform:{textPosAngle:gt($t),rCenter:Ne,x:$e.x,y:$e.y}};return o(E.type,$e,A),{transform:{targetX:ce(Ye),targetY:ye(Ye),scale:Qe($t),rotate:vt($t),rCenter:Ne}}}}(Ve);return function(ze){return Oe(Fe(ze),De)}}):de.attr("transform",Oe(le,De))})}function f(_){return b=_.rpx1,T=_.transform.textPosAngle,[b*Math.sin(T),-b*Math.cos(T)];var b,T}Y.plot=function(_,b,T,k){var L,A,I=_._fullLayout,P=I._sunburstlayer,S=!T,E=!I.uniformtext.mode&&i.hasTransition(T);r("sunburst",I),(L=P.selectAll("g.trace.sunburst").data(b,function(z){return z[0].trace.uid})).enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),L.order(),E?(k&&(A=k()),d.transition().duration(T.duration).ease(T.easing).each("end",function(){A&&A()}).each("interrupt",function(){A&&A()}).each(function(){P.selectAll("g.trace").each(function(z){x(_,z,this,T)})})):(L.each(function(z){x(_,z,this,T)}),I.uniformtext.mode&&s(_,I._sunburstlayer.selectAll(".trace"),"sunburst")),S&&L.exit().remove()},Y.formatSliceLabel=function(_,b,T,k,L){var A=T.texttemplate,I=T.textinfo;if(!(A||I&&I!=="none"))return"";var P=L.separators,S=k[0],E=_.data.data,z=S.hierarchy,D=i.isHierarchyRoot(_),j=i.getParent(z,_),V=i.getValue(_);if(!A){var Z,Q=I.split("+"),X=function(J){return Q.indexOf(J)!==-1},$=[];if(X("label")&&E.label&&$.push(E.label),E.hasOwnProperty("v")&&X("value")&&$.push(i.formatValue(E.v,P)),!D){X("current path")&&$.push(i.getPath(_.data));var re=0;X("percent parent")&&re++,X("percent entry")&&re++,X("percent root")&&re++;var H=re>1;if(re){var N,U=function(J){Z=i.formatPercent(N,P),H&&(Z+=" of "+J),$.push(Z)};X("percent parent")&&!D&&(N=V/i.getValue(j),U("parent")),X("percent entry")&&(N=V/i.getValue(b),U("entry")),X("percent root")&&(N=V/i.getValue(z),U("root"))}}return X("text")&&(Z=e.castOption(T,E.i,"text"),e.isValidTextValue(Z)&&$.push(Z)),$.join("<br>")}var te=e.castOption(T,E.i,"texttemplate");if(!te)return"";var B={};E.label&&(B.label=E.label),E.hasOwnProperty("v")&&(B.value=E.v,B.valueLabel=i.formatValue(E.v,P)),B.currentPath=i.getPath(_.data),D||(B.percentParent=V/i.getValue(j),B.percentParentLabel=i.formatPercent(B.percentParent,P),B.parent=i.getPtLabel(j)),B.percentEntry=V/i.getValue(b),B.percentEntryLabel=i.formatPercent(B.percentEntry,P),B.entry=i.getPtLabel(b),B.percentRoot=V/i.getValue(z),B.percentRootLabel=i.formatPercent(B.percentRoot,P),B.root=i.getPtLabel(z),E.hasOwnProperty("color")&&(B.color=E.color);var K=e.castOption(T,E.i,"text");return(e.isValidTextValue(K)||K==="")&&(B.text=K),B.customdata=e.castOption(T,E.i,"customdata"),e.texttemplateString(te,B,L._d3locale,B,T._meta||{})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../bar/style":671,"../bar/uniform_text":673,"../pie/helpers":915,"../pie/plot":919,"./constants":1061,"./fx":1063,"./helpers":1064,"./style":1069,"@plotly/d3":58,"d3-hierarchy":115,"d3-interpolate":116}],1069:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../components/color"),w=m("../../lib"),y=m("../bar/uniform_text").resizeText;function e(t,n,o){var r=n.data.data,g=!n.children,c=r.i,a=w.castOption(o,c,"marker.line.color")||v.defaultLine,h=w.castOption(o,c,"marker.line.width")||0;t.style("stroke-width",h).call(v.fill,r.color).call(v.stroke,a).style("opacity",g?o.leaf.opacity:null)}G.exports={style:function(t){var n=t._fullLayout._sunburstlayer.selectAll(".trace");y(t,n,"sunburst"),n.each(function(o){var r=d.select(this),g=o[0].trace;r.style("opacity",g.opacity),r.selectAll("path.surface").each(function(c){d.select(this).call(e,c,g)})})},styleOne:e}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"@plotly/d3":58}],1070:[function(m,G,Y){var d=m("../../components/color"),v=m("../../components/colorscale/attributes"),w=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,y=m("../../plots/template_attributes").hovertemplateAttrs,e=m("../../plots/attributes"),t=m("../../lib/extend").extendFlat,n=m("../../plot_api/edit_types").overrideAll;function o(g){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:{valType:"boolean",dflt:!1},y:{valType:"boolean",dflt:!1},z:{valType:"boolean",dflt:!1}},color:{valType:"color",dflt:d.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:d.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var r=G.exports=n(t({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:y(),xhoverformat:w("x"),yhoverformat:w("y"),zhoverformat:w("z"),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},v("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:o(),y:o(),z:o()},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:t({},v.zauto,{}),zmin:t({},v.zmin,{}),zmax:t({},v.zmax,{})},hoverinfo:t({},e.hoverinfo),showlegend:t({},e.showlegend,{dflt:!1})}),"calc","nested");r.x.editType=r.y.editType=r.z.editType="calc+clearAxisTypes",r.transforms=void 0},{"../../components/color":367,"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642}],1071:[function(m,G,Y){var d=m("../../components/colorscale/calc");G.exports=function(v,w){w.surfacecolor?d(v,w,{vals:w.surfacecolor,containerStr:"",cLetter:"c"}):d(v,w,{vals:w.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":375}],1072:[function(m,G,Y){var d=m("../../../stackgl_modules").gl_surface3d,v=m("../../../stackgl_modules").ndarray,w=m("../../../stackgl_modules").ndarray_linear_interpolate.d2,y=m("../heatmap/interp2d"),e=m("../heatmap/find_empties"),t=m("../../lib").isArrayOrTypedArray,n=m("../../lib/gl_format_color").parseColorScale,o=m("../../lib/str2rgbarray"),r=m("../../components/colorscale").extractOpts;function g(T,k,L){this.scene=T,this.uid=L,this.surface=k,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}var c=g.prototype;c.getXat=function(T,k,L,A){var I=t(this.data.x)?t(this.data.x[0])?this.data.x[k][T]:this.data.x[T]:T;return L===void 0?I:A.d2l(I,0,L)},c.getYat=function(T,k,L,A){var I=t(this.data.y)?t(this.data.y[0])?this.data.y[k][T]:this.data.y[k]:k;return L===void 0?I:A.d2l(I,0,L)},c.getZat=function(T,k,L,A){var I=this.data.z[k][T];return I===null&&this.data.connectgaps&&this.data._interpolatedZ&&(I=this.data._interpolatedZ[k][T]),L===void 0?I:A.d2l(I,0,L)},c.handlePick=function(T){if(T.object===this.surface){var k=(T.data.index[0]-1)/this.dataScaleX-1,L=(T.data.index[1]-1)/this.dataScaleY-1,A=Math.max(Math.min(Math.round(k),this.data.z[0].length-1),0),I=Math.max(Math.min(Math.round(L),this.data._ylength-1),0);T.index=[A,I],T.traceCoordinate=[this.getXat(A,I),this.getYat(A,I),this.getZat(A,I)],T.dataCoordinate=[this.getXat(A,I,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(A,I,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(A,I,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var P=0;P<3;P++){var S=T.dataCoordinate[P];S!=null&&(T.dataCoordinate[P]*=this.scene.dataScale[P])}var E=this.data.hovertext||this.data.text;return Array.isArray(E)&&E[I]&&E[I][A]!==void 0?T.textLabel=E[I][A]:T.textLabel=E||"",T.data.dataCoordinate=T.dataCoordinate.slice(),this.surface.highlight(T.data),this.scene.glplot.spikes.position=T.dataCoordinate,!0}};var a=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function h(T,k){if(T<k)return 0;for(var L=0;Math.floor(T%k)===0;)T/=k,L++;return L}function l(T){for(var k=[],L=0;L<a.length;L++){var A=a[L];k.push(h(T,A))}return k}function s(T){for(var k=l(T),L=T,A=0;A<a.length;A++)if(k[A]>0){L=a[A];break}return L}function p(T,k){if(!(T<1||k<1)){for(var L=l(T),A=l(k),I=1,P=0;P<a.length;P++)I*=Math.pow(a[P],Math.max(L[P],A[P]));return I}}c.calcXnums=function(T){var k,L=[];for(k=1;k<T;k++){var A=this.getXat(k-1,0),I=this.getXat(k,0);L[k-1]=I!==A&&A!=null&&I!=null?Math.abs(I-A):0}var P=0;for(k=1;k<T;k++)P+=L[k-1];for(k=1;k<T;k++)L[k-1]===0?L[k-1]=1:L[k-1]=Math.round(P/L[k-1]);return L},c.calcYnums=function(T){var k,L=[];for(k=1;k<T;k++){var A=this.getYat(0,k-1),I=this.getYat(0,k);L[k-1]=I!==A&&A!=null&&I!=null?Math.abs(I-A):0}var P=0;for(k=1;k<T;k++)P+=L[k-1];for(k=1;k<T;k++)L[k-1]===0?L[k-1]=1:L[k-1]=Math.round(P/L[k-1]);return L};var u=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],i=u[9],x=u[13];function f(T,k,L){var A=L[8]+L[2]*k[0]+L[5]*k[1];return T[0]=(L[6]+L[0]*k[0]+L[3]*k[1])/A,T[1]=(L[7]+L[1]*k[0]+L[4]*k[1])/A,T}function _(T,k,L){return function(A,I,P,S){for(var E=[0,0],z=A.shape[0],D=A.shape[1],j=0;j<z;j++)for(var V=0;V<D;V++)P(E,[j,V],S),A.set(j,V,w(I,E[0],E[1]))}(T,k,f,L),T}function b(T,k){for(var L=!1,A=0;A<T.length;A++)if(k===T[A]){L=!0;break}L===!1&&T.push(k)}c.estimateScale=function(T,k){for(var L=1+function(I){if(I.length!==0){for(var P=1,S=0;S<I.length;S++)P=p(P,I[S]);return P}}(k===0?this.calcXnums(T):this.calcYnums(T));L<i;)L*=2;for(;L>x;)L--,L/=s(L),++L<i&&(L=x);var A=Math.round(L/T);return A>1?A:1},c.refineCoords=function(T){for(var k=this.dataScaleX,L=this.dataScaleY,A=T[0].shape[0],I=T[0].shape[1],P=0|Math.floor(T[0].shape[0]*k+1),S=0|Math.floor(T[0].shape[1]*L+1),E=1+A+1,z=1+I+1,D=v(new Float32Array(E*z),[E,z]),j=[1/k,0,0,0,1/L,0,0,0,1],V=0;V<T.length;++V){this.surface.padField(D,T[V]);var Z=v(new Float32Array(P*S),[P,S]);_(Z,D,j),T[V]=Z}},c.setContourLevels=function(){var T,k,L,A=[[],[],[]],I=[!1,!1,!1],P=!1;for(T=0;T<3;++T)if(this.showContour[T]&&(P=!0,this.contourSize[T]>0&&this.contourStart[T]!==null&&this.contourEnd[T]!==null&&this.contourEnd[T]>this.contourStart[T]))for(I[T]=!0,k=this.contourStart[T];k<this.contourEnd[T];k+=this.contourSize[T])L=k*this.scene.dataScale[T],b(A[T],L);if(P){var S=[[],[],[]];for(T=0;T<3;++T)this.showContour[T]&&(S[T]=I[T]?A[T]:this.scene.contourLevels[T]);this.surface.update({levels:S})}},c.update=function(T){var k,L,A,I,P=this.scene,S=P.fullSceneLayout,E=this.surface,z=n(T),D=P.dataScale,j=T.z[0].length,V=T._ylength,Z=P.contourLevels;this.data=T;var Q=[];for(k=0;k<3;k++)for(Q[k]=[],L=0;L<j;L++)Q[k][L]=[];for(L=0;L<j;L++)for(A=0;A<V;A++)Q[0][L][A]=this.getXat(L,A,T.xcalendar,S.xaxis),Q[1][L][A]=this.getYat(L,A,T.ycalendar,S.yaxis),Q[2][L][A]=this.getZat(L,A,T.zcalendar,S.zaxis);if(T.connectgaps)for(T._emptypoints=e(Q[2]),y(Q[2],T._emptypoints),T._interpolatedZ=[],L=0;L<j;L++)for(T._interpolatedZ[L]=[],A=0;A<V;A++)T._interpolatedZ[L][A]=Q[2][L][A];for(k=0;k<3;k++)for(L=0;L<j;L++)for(A=0;A<V;A++)(I=Q[k][L][A])==null?Q[k][L][A]=NaN:I=Q[k][L][A]*=D[k];for(k=0;k<3;k++)for(L=0;L<j;L++)for(A=0;A<V;A++)(I=Q[k][L][A])!=null&&(this.minValues[k]>I&&(this.minValues[k]=I),this.maxValues[k]<I&&(this.maxValues[k]=I));for(k=0;k<3;k++)this.objectOffset[k]=.5*(this.minValues[k]+this.maxValues[k]);for(k=0;k<3;k++)for(L=0;L<j;L++)for(A=0;A<V;A++)(I=Q[k][L][A])!=null&&(Q[k][L][A]-=this.objectOffset[k]);var X=[v(new Float32Array(j*V),[j,V]),v(new Float32Array(j*V),[j,V]),v(new Float32Array(j*V),[j,V])];for(k=0;k<3;k++)for(L=0;L<j;L++)for(A=0;A<V;A++)X[k].set(L,A,Q[k][L][A]);Q=[];var $={colormap:z,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!T.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:T.opacityscale,opacity:T.opacity},re=r(T);if($.intensityBounds=[re.min,re.max],T.surfacecolor){var H=v(new Float32Array(j*V),[j,V]);for(L=0;L<j;L++)for(A=0;A<V;A++)H.set(L,A,T.surfacecolor[A][L]);X.push(H)}else $.intensityBounds[0]*=D[2],$.intensityBounds[1]*=D[2];(x<X[0].shape[0]||x<X[0].shape[1])&&(this.refineData=!1),this.refineData===!0&&(this.dataScaleX=this.estimateScale(X[0].shape[0],0),this.dataScaleY=this.estimateScale(X[0].shape[1],1),this.dataScaleX===1&&this.dataScaleY===1||this.refineCoords(X)),T.surfacecolor&&($.intensity=X.pop());var N=[!0,!0,!0],U=["x","y","z"];for(k=0;k<3;++k){var te=T.contours[U[k]];N[k]=te.highlight,$.showContour[k]=te.show||te.highlight,$.showContour[k]&&($.contourProject[k]=[te.project.x,te.project.y,te.project.z],te.show?(this.showContour[k]=!0,$.levels[k]=Z[k],E.highlightColor[k]=$.contourColor[k]=o(te.color),te.usecolormap?E.highlightTint[k]=$.contourTint[k]=0:E.highlightTint[k]=$.contourTint[k]=1,$.contourWidth[k]=te.width,this.contourStart[k]=te.start,this.contourEnd[k]=te.end,this.contourSize[k]=te.size):(this.showContour[k]=!1,this.contourStart[k]=null,this.contourEnd[k]=null,this.contourSize[k]=0),te.highlight&&($.dynamicColor[k]=o(te.highlightcolor),$.dynamicWidth[k]=te.highlightwidth))}(function(B){var K=B[0].rgb,J=B[B.length-1].rgb;return K[0]===J[0]&&K[1]===J[1]&&K[2]===J[2]&&K[3]===J[3]})(z)&&($.vertexColor=!0),$.objectOffset=this.objectOffset,$.coords=X,E.update($),E.visible=T.visible,E.enableDynamic=N,E.enableHighlight=N,E.snapToData=!0,"lighting"in T&&(E.ambientLight=T.lighting.ambient,E.diffuseLight=T.lighting.diffuse,E.specularLight=T.lighting.specular,E.roughness=T.lighting.roughness,E.fresnel=T.lighting.fresnel),"lightposition"in T&&(E.lightPosition=[T.lightposition.x,T.lightposition.y,T.lightposition.z])},c.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()},G.exports=function(T,k){var L=T.glplot.gl,A=d({gl:L}),I=new g(T,A,k.uid);return A._trace=I,I.update(k),T.glplot.add(A),I}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib":515,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../heatmap/find_empties":807,"../heatmap/interp2d":810}],1073:[function(m,G,Y){var d=m("../../registry"),v=m("../../lib"),w=m("../../components/colorscale/defaults"),y=m("./attributes");function e(n,o,r,g){var c=g("opacityscale");c==="max"?o.opacityscale=[[0,.1],[1,1]]:c==="min"?o.opacityscale=[[0,1],[1,.1]]:c==="extremes"?o.opacityscale=function(a,h){for(var l=[],s=0;s<32;s++){var p=s/31,u=h+(1-h)*(1-Math.pow(Math.sin(a*p*Math.PI),2));l.push([p,Math.max(0,Math.min(1,u))])}return l}(1,.1):function(a){var h=0;if(!Array.isArray(a)||a.length<2||!a[0]||!a[a.length-1]||+a[0][0]!=0||+a[a.length-1][0]!=1)return!1;for(var l=0;l<a.length;l++){var s=a[l];if(s.length!==2||+s[0]<h)return!1;h=+s[0]}return!0}(c)||(o.opacityscale=void 0)}function t(n,o,r){o in n&&!(r in n)&&(n[r]=n[o])}G.exports={supplyDefaults:function(n,o,r,g){var c,a;function h(b,T){return v.coerce(n,o,y,b,T)}var l=h("x"),s=h("y"),p=h("z");if(!p||!p.length||l&&l.length<1||s&&s.length<1)o.visible=!1;else{o._xlength=Array.isArray(l)&&v.isArrayOrTypedArray(l[0])?p.length:p[0].length,o._ylength=p.length,d.getComponentMethod("calendars","handleTraceDefaults")(n,o,["x","y","z"],g),h("text"),h("hovertext"),h("hovertemplate"),h("xhoverformat"),h("yhoverformat"),h("zhoverformat"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach(function(b){h(b)});var u=h("surfacecolor"),i=["x","y","z"];for(c=0;c<3;++c){var x="contours."+i[c],f=h(x+".show"),_=h(x+".highlight");if(f||_)for(a=0;a<3;++a)h(x+".project."+i[a]);f&&(h(x+".color"),h(x+".width"),h(x+".usecolormap")),_&&(h(x+".highlightcolor"),h(x+".highlightwidth")),h(x+".start"),h(x+".end"),h(x+".size")}u||(t(n,"zmin","cmin"),t(n,"zmax","cmax"),t(n,"zauto","cauto")),w(n,o,g,h,{prefix:"",cLetter:"c"}),e(n,o,g,h),o._length=null}},opacityscaleDefaults:e}},{"../../components/colorscale/defaults":377,"../../lib":515,"../../registry":647,"./attributes":1070}],1074:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:m("./calc"),plot:m("./convert"),moduleType:"trace",name:"surface",basePlotModule:m("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":607,"./attributes":1070,"./calc":1071,"./convert":1072,"./defaults":1073}],1075:[function(m,G,Y){var d=m("../../components/annotations/attributes"),v=m("../../lib/extend").extendFlat,w=m("../../plot_api/edit_types").overrideAll,y=m("../../plots/font_attributes"),e=m("../../plots/domain").attributes,t=m("../../plots/cartesian/axis_format_attributes").descriptionOnlyNumbers;(G.exports=w({domain:e({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:t("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:v({},d.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:v({},y({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[],description:t("cell value")},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:v({},d.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:v({},y({arrayOk:!0}))}},"calc","from-root")).transforms=void 0},{"../../components/annotations/attributes":350,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/cartesian/axis_format_attributes":569,"../../plots/domain":593,"../../plots/font_attributes":594}],1076:[function(m,G,Y){var d=m("../../plots/get_data").getModuleCalcData,v=m("./plot");Y.name="table",Y.plot=function(w){var y=d(w.calcdata,"table")[0];y.length&&v(w,y)},Y.clean=function(w,y,e,t){var n=t._has&&t._has("table"),o=y._has&&y._has("table");n&&!o&&t._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":602,"./plot":1083}],1077:[function(m,G,Y){var d=m("../../lib/gup").wrap;G.exports=function(){return d({})}},{"../../lib/gup":512}],1078:[function(m,G,Y){G.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1079:[function(m,G,Y){var d=m("./constants"),v=m("../../lib/extend").extendFlat,w=m("fast-isnumeric");function y(c){if(Array.isArray(c)){for(var a=0,h=0;h<c.length;h++)a=Math.max(a,y(c[h]));return a}return c}function e(c,a){return c+a}function t(c){var a,h=c.slice(),l=1/0,s=0;for(a=0;a<h.length;a++)Array.isArray(h[a])||(h[a]=[h[a]]),l=Math.min(l,h[a].length),s=Math.max(s,h[a].length);if(l!==s)for(a=0;a<h.length;a++){var p=s-h[a].length;p&&(h[a]=h[a].concat(n(p)))}return h}function n(c){for(var a=new Array(c),h=0;h<c;h++)a[h]="";return a}function o(c){return c.calcdata.columns.reduce(function(a,h){return h.xIndex<c.xIndex?a+h.columnWidth:a},0)}function r(c,a){return Object.keys(c).map(function(h){return v({},c[h],{auxiliaryBlocks:a})})}function g(c,a){for(var h,l={},s=0,p=0,u={firstRowIndex:null,lastRowIndex:null,rows:[]},i=0,x=0,f=0;f<c.length;f++)h=c[f],u.rows.push({rowIndex:f,rowHeight:h}),((p+=h)>=a||f===c.length-1)&&(l[s]=u,u.key=x++,u.firstRowIndex=i,u.lastRowIndex=f,u={firstRowIndex:null,lastRowIndex:null,rows:[]},s+=p,i=f+1,p=0);return l}G.exports=function(c,a){var h=t(a.cells.values),l=function(D){return D.slice(a.header.values.length,D.length)},s=t(a.header.values);s.length&&!s[0].length&&(s[0]=[""],s=t(s));var p=s.concat(l(h).map(function(){return n((s[0]||[""]).length)})),u=a.domain,i=Math.floor(c._fullLayout._size.w*(u.x[1]-u.x[0])),x=Math.floor(c._fullLayout._size.h*(u.y[1]-u.y[0])),f=a.header.values.length?p[0].map(function(){return a.header.height}):[d.emptyHeaderHeight],_=h.length?h[0].map(function(){return a.cells.height}):[],b=f.reduce(e,0),T=g(_,x-b+d.uplift),k=r(g(f,b),[]),L=r(T,k),A={},I=a._fullInput.columnorder.concat(l(h.map(function(D,j){return j}))),P=p.map(function(D,j){var V=Array.isArray(a.columnwidth)?a.columnwidth[Math.min(j,a.columnwidth.length-1)]:a.columnwidth;return w(V)?Number(V):1}),S=P.reduce(e,0);P=P.map(function(D){return D/S*i});var E=Math.max(y(a.header.line.width),y(a.cells.line.width)),z={key:a.uid+c._context.staticPlot,translateX:u.x[0]*c._fullLayout._size.w,translateY:c._fullLayout._size.h*(1-u.y[1]),size:c._fullLayout._size,width:i,maxLineWidth:E,height:x,columnOrder:I,groupHeight:x,rowBlocks:L,headerRowBlocks:k,scrollY:0,cells:v({},a.cells,{values:h}),headerCells:v({},a.header,{values:p}),gdColumns:p.map(function(D){return D[0]}),gdColumnsOriginalOrder:p.map(function(D){return D[0]}),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:p.map(function(D,j){var V=A[D];return A[D]=(V||0)+1,{key:D+"__"+A[D],label:D,specIndex:j,xIndex:I[j],xScale:o,x:void 0,calcdata:void 0,columnWidth:P[j]}})};return z.columns.forEach(function(D){D.calcdata=z,D.x=o(D)}),z}},{"../../lib/extend":505,"./constants":1078,"fast-isnumeric":190}],1080:[function(m,G,Y){var d=m("../../lib/extend").extendFlat;Y.splitToPanels=function(v){var w=[0,0],y=d({},v,{key:"header",type:"header",page:0,prevPages:w,currentRepaint:[null,null],dragHandle:!0,values:v.calcdata.headerCells.values[v.specIndex],rowBlocks:v.calcdata.headerRowBlocks,calcdata:d({},v.calcdata,{cells:v.calcdata.headerCells})});return[d({},v,{key:"cells1",type:"cells",page:0,prevPages:w,currentRepaint:[null,null],dragHandle:!1,values:v.calcdata.cells.values[v.specIndex],rowBlocks:v.calcdata.rowBlocks}),d({},v,{key:"cells2",type:"cells",page:1,prevPages:w,currentRepaint:[null,null],dragHandle:!1,values:v.calcdata.cells.values[v.specIndex],rowBlocks:v.calcdata.rowBlocks}),y]},Y.splitToCells=function(v){var w=function(y){var e=y.rowBlocks[y.page],t=e?e.rows[0].rowIndex:0,n=e?t+e.rows.length:0;return[t,n]}(v);return(v.values||[]).slice(w[0],w[1]).map(function(y,e){return{keyWithinBlock:e+(typeof y=="string"&&y.match(/[<$&> ]/)?"_keybuster_"+Math.random():""),key:w[0]+e,column:v,calcdata:v.calcdata,page:v.page,rowBlocks:v.rowBlocks,value:y}})}},{"../../lib/extend":505}],1081:[function(m,G,Y){var d=m("../../lib"),v=m("./attributes"),w=m("../../plots/domain").defaults;G.exports=function(y,e,t,n){function o(r,g){return d.coerce(y,e,v,r,g)}w(e,n,o),o("columnwidth"),o("header.values"),o("header.format"),o("header.align"),o("header.prefix"),o("header.suffix"),o("header.height"),o("header.line.width"),o("header.line.color"),o("header.fill.color"),d.coerceFont(o,"header.font",d.extendFlat({},n.font)),function(r,g){for(var c=r.columnorder||[],a=r.header.values.length,h=c.slice(0,a),l=h.slice().sort(function(u,i){return u-i}),s=h.map(function(u){return l.indexOf(u)}),p=s.length;p<a;p++)s.push(p);g("columnorder",s)}(e,o),o("cells.values"),o("cells.format"),o("cells.align"),o("cells.prefix"),o("cells.suffix"),o("cells.height"),o("cells.line.width"),o("cells.line.color"),o("cells.fill.color"),d.coerceFont(o,"cells.font",d.extendFlat({},n.font)),e._length=null}},{"../../lib":515,"../../plots/domain":593,"./attributes":1075}],1082:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),calc:m("./calc"),plot:m("./plot"),moduleType:"trace",name:"table",basePlotModule:m("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1075,"./base_plot":1076,"./calc":1077,"./defaults":1081,"./plot":1083}],1083:[function(m,G,Y){var d=m("./constants"),v=m("@plotly/d3"),w=m("../../lib").numberFormat,y=m("../../lib/gup"),e=m("../../components/drawing"),t=m("../../lib/svg_text_utils"),n=m("../../lib").raiseToTop,o=m("../../lib").strTranslate,r=m("../../lib").cancelTransition,g=m("./data_preparation_helper"),c=m("./data_split_helpers"),a=m("../../components/color");function h(X){return Math.ceil(X.calcdata.maxLineWidth/2)}function l(X,$){return"clip"+X._fullLayout._uid+"_scrollAreaBottomClip_"+$.key}function s(X,$){return"clip"+X._fullLayout._uid+"_columnBoundaryClippath_"+$.calcdata.key+"_"+$.specIndex}function p(X){return[].concat.apply([],X.map(function($){return $})).map(function($){return $.__data__})}function u(X,$,re){var H=X.selectAll("."+d.cn.scrollbarKit).data(y.repeat,y.keyFun);H.enter().append("g").classed(d.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),H.each(function(K){var J=K.scrollbarState;J.totalHeight=function(ee){var ne=ee.rowBlocks;return j(ne,ne.length-1)+(ne.length?V(ne[ne.length-1],1/0):1)}(K),J.scrollableAreaHeight=K.groupHeight-L(K),J.currentlyVisibleHeight=Math.min(J.totalHeight,J.scrollableAreaHeight),J.ratio=J.currentlyVisibleHeight/J.totalHeight,J.barLength=Math.max(J.ratio*J.currentlyVisibleHeight,d.goldenRatio*d.scrollbarWidth),J.barWiggleRoom=J.currentlyVisibleHeight-J.barLength,J.wiggleRoom=Math.max(0,J.totalHeight-J.scrollableAreaHeight),J.topY=J.barWiggleRoom===0?0:K.scrollY/J.wiggleRoom*J.barWiggleRoom,J.bottomY=J.topY+J.barLength,J.dragMultiplier=J.wiggleRoom/J.barWiggleRoom}).attr("transform",function(K){var J=K.width+d.scrollbarWidth/2+d.scrollbarOffset;return o(J,L(K))});var N=H.selectAll("."+d.cn.scrollbar).data(y.repeat,y.keyFun);N.enter().append("g").classed(d.cn.scrollbar,!0);var U=N.selectAll("."+d.cn.scrollbarSlider).data(y.repeat,y.keyFun);U.enter().append("g").classed(d.cn.scrollbarSlider,!0),U.attr("transform",function(K){return o(0,K.scrollbarState.topY||0)});var te=U.selectAll("."+d.cn.scrollbarGlyph).data(y.repeat,y.keyFun);te.enter().append("line").classed(d.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",d.scrollbarWidth).attr("stroke-linecap","round").attr("y1",d.scrollbarWidth/2),te.attr("y2",function(K){return K.scrollbarState.barLength-d.scrollbarWidth/2}).attr("stroke-opacity",function(K){return K.columnDragInProgress||!K.scrollbarState.barWiggleRoom||re?0:.4}),te.transition().delay(0).duration(0),te.transition().delay(d.scrollbarHideDelay).duration(d.scrollbarHideDuration).attr("stroke-opacity",0);var B=N.selectAll("."+d.cn.scrollbarCaptureZone).data(y.repeat,y.keyFun);B.enter().append("line").classed(d.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",d.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",function(K){var J=v.event.y,ee=this.getBoundingClientRect(),ne=K.scrollbarState,se=J-ee.top,oe=v.scale.linear().domain([0,ne.scrollableAreaHeight]).range([0,ne.totalHeight]).clamp(!0);ne.topY<=se&&se<=ne.bottomY||I($,X,null,oe(se-ne.barLength/2))(K)}).call(v.behavior.drag().origin(function(K){return v.event.stopPropagation(),K.scrollbarState.scrollbarScrollInProgress=!0,K}).on("drag",I($,X)).on("dragend",function(){})),B.attr("y2",function(K){return K.scrollbarState.scrollableAreaHeight}),$._context.staticPlot&&(te.remove(),B.remove())}function i(X,$,re,H){var N=function(te){var B=te.selectAll("."+d.cn.columnCell).data(c.splitToCells,function(K){return K.keyWithinBlock});return B.enter().append("g").classed(d.cn.columnCell,!0),B.exit().remove(),B}(function(te){var B=te.selectAll("."+d.cn.columnCells).data(y.repeat,y.keyFun);return B.enter().append("g").classed(d.cn.columnCells,!0),B.exit().remove(),B}(re));(function(te){te.each(function(B,K){var J=B.calcdata.cells.font,ee=B.column.specIndex,ne={size:_(J.size,ee,K),color:_(J.color,ee,K),family:_(J.family,ee,K)};B.rowNumber=B.key,B.align=_(B.calcdata.cells.align,ee,K),B.cellBorderWidth=_(B.calcdata.cells.line.width,ee,K),B.font=ne})})(N),function(te){te.attr("width",function(B){return B.column.columnWidth}).attr("stroke-width",function(B){return B.cellBorderWidth}).each(function(B){var K=v.select(this);a.stroke(K,_(B.calcdata.cells.line.color,B.column.specIndex,B.rowNumber)),a.fill(K,_(B.calcdata.cells.fill.color,B.column.specIndex,B.rowNumber))})}(function(te){var B=te.selectAll("."+d.cn.cellRect).data(y.repeat,function(K){return K.keyWithinBlock});return B.enter().append("rect").classed(d.cn.cellRect,!0),B}(N));var U=function(te){var B=te.selectAll("."+d.cn.cellText).data(y.repeat,function(K){return K.keyWithinBlock});return B.enter().append("text").classed(d.cn.cellText,!0).style("cursor",function(){return"auto"}).on("mousedown",function(){v.event.stopPropagation()}),B}(function(te){var B=te.selectAll("."+d.cn.cellTextHolder).data(y.repeat,function(K){return K.keyWithinBlock});return B.enter().append("g").classed(d.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),B}(N));(function(te){te.each(function(B){e.font(v.select(this),B.font)})})(U),x(U,$,H,X),D(N)}function x(X,$,re,H){X.text(function(N){var U=N.column.specIndex,te=N.rowNumber,B=N.value,K=typeof B=="string",J=K&&B.match(/<br>/i),ee=!K||J;N.mayHaveMarkup=K&&B.match(/[<&>]/);var ne,se=typeof(ne=B)=="string"&&ne.match(d.latexCheck);N.latex=se;var oe,me,ce=se?"":_(N.calcdata.cells.prefix,U,te)||"",ye=se?"":_(N.calcdata.cells.suffix,U,te)||"",Se=se?null:_(N.calcdata.cells.format,U,te)||null,fe=ce+(Se?w(Se)(N.value):N.value)+ye;if(N.wrappingNeeded=!N.wrapped&&!ee&&!se&&(oe=f(fe)),N.cellHeightMayIncrease=J||se||N.mayHaveMarkup||(oe===void 0?f(fe):oe),N.needsConvertToTspans=N.mayHaveMarkup||N.wrappingNeeded||N.latex,N.wrappingNeeded){var ge=(d.wrapSplitCharacter===" "?fe.replace(/<a href=/gi,"<a_href="):fe).split(d.wrapSplitCharacter),Te=d.wrapSplitCharacter===" "?ge.map(function(le){return le.replace(/<a_href=/gi,"<a href=")}):ge;N.fragments=Te.map(function(le){return{text:le,width:null}}),N.fragments.push({fragment:d.wrapSpacer,width:null}),me=Te.join(d.lineBreaker)+d.lineBreaker+d.wrapSpacer}else delete N.fragments,me=fe;return me}).attr("dy",function(N){return N.needsConvertToTspans?0:"0.75em"}).each(function(N){var U=v.select(this),te=N.wrappingNeeded?S:E;N.needsConvertToTspans?t.convertToTspans(U,H,te(re,this,$,H,N)):v.select(this.parentNode).attr("transform",function(B){return o(z(B),d.cellPad)}).attr("text-anchor",function(B){return{left:"start",center:"middle",right:"end"}[B.align]})})}function f(X){return X.indexOf(d.wrapSplitCharacter)!==-1}function _(X,$,re){if(Array.isArray(X)){var H=X[Math.min($,X.length-1)];return Array.isArray(H)?H[Math.min(re,H.length-1)]:H}return X}function b(X,$,re){X.transition().ease(d.releaseTransitionEase).duration(d.releaseTransitionDuration).attr("transform",o($.x,re))}function T(X){return X.type==="cells"}function k(X){return X.type==="header"}function L(X){return(X.rowBlocks.length?X.rowBlocks[0].auxiliaryBlocks:[]).reduce(function($,re){return $+V(re,1/0)},0)}function A(X,$,re){var H=p($)[0];if(H!==void 0){var N=H.rowBlocks,U=H.calcdata,te=j(N,N.length),B=H.calcdata.groupHeight-L(H),K=U.scrollY=Math.max(0,Math.min(te-B,U.scrollY)),J=function(ee,ne,se){for(var oe=[],me=0,ce=0;ce<ee.length;ce++){for(var ye=ee[ce],Se=ye.rows,fe=0,ge=0;ge<Se.length;ge++)fe+=Se[ge].rowHeight;ye.allRowsHeight=fe,ne<me+fe&&ne+se>me&&oe.push(ce),me+=fe}return oe}(N,K,B);J.length===1&&(J[0]===N.length-1?J.unshift(J[0]-1):J.push(J[0]+1)),J[0]%2&&J.reverse(),$.each(function(ee,ne){ee.page=J[ne],ee.scrollY=K}),$.attr("transform",function(ee){var ne=j(ee.rowBlocks,ee.page)-ee.scrollY;return o(0,ne)}),X&&(P(X,re,$,J,H.prevPages,H,0),P(X,re,$,J,H.prevPages,H,1),u(re,X))}}function I(X,$,re,H){return function(N){var U=N.calcdata?N.calcdata:N,te=$.filter(function(ee){return U.key===ee.key}),B=re||U.scrollbarState.dragMultiplier,K=U.scrollY;U.scrollY=H===void 0?U.scrollY+B*v.event.dy:H;var J=te.selectAll("."+d.cn.yColumn).selectAll("."+d.cn.columnBlock).filter(T);return A(X,J,te),U.scrollY===K}}function P(X,$,re,H,N,U,te){H[te]!==N[te]&&(clearTimeout(U.currentRepaint[te]),U.currentRepaint[te]=setTimeout(function(){var B=re.filter(function(K,J){return J===te&&H[J]!==N[J]});i(X,$,B,re),N[te]=H[te]}))}function S(X,$,re,H){return function(){var N=v.select($.parentNode);N.each(function(U){var te=U.fragments;N.selectAll("tspan.line").each(function(me,ce){te[ce].width=this.getComputedTextLength()});var B,K,J=te[te.length-1].width,ee=te.slice(0,-1),ne=[],se=0,oe=U.column.columnWidth-2*d.cellPad;for(U.value="";ee.length;)se+(K=(B=ee.shift()).width+J)>oe&&(U.value+=ne.join(d.wrapSpacer)+d.lineBreaker,ne=[],se=0),ne.push(B.text),se+=K;se&&(U.value+=ne.join(d.wrapSpacer)),U.wrapped=!0}),N.selectAll("tspan.line").remove(),x(N.select("."+d.cn.cellText),re,X,H),v.select($.parentNode.parentNode).call(D)}}function E(X,$,re,H,N){return function(){if(!N.settledY){var U=v.select($.parentNode),te=Q(N),B=N.key-te.firstRowIndex,K=te.rows[B].rowHeight,J=N.cellHeightMayIncrease?$.parentNode.getBoundingClientRect().height+2*d.cellPad:K,ee=Math.max(J,K);ee-te.rows[B].rowHeight&&(te.rows[B].rowHeight=ee,X.selectAll("."+d.cn.columnCell).call(D),A(null,X.filter(T),0),u(re,H,!0)),U.attr("transform",function(){var ne=this.parentNode.getBoundingClientRect(),se=v.select(this.parentNode).select("."+d.cn.cellRect).node().getBoundingClientRect(),oe=this.transform.baseVal.consolidate(),me=se.top-ne.top+(oe?oe.matrix.f:d.cellPad);return o(z(N,v.select(this.parentNode).select("."+d.cn.cellTextHolder).node().getBoundingClientRect().width),me)}),N.settledY=!0}}}function z(X,$){switch(X.align){case"left":return d.cellPad;case"right":return X.column.columnWidth-($||0)-d.cellPad;case"center":return(X.column.columnWidth-($||0))/2;default:return d.cellPad}}function D(X){X.attr("transform",function($){var re=$.rowBlocks[0].auxiliaryBlocks.reduce(function(N,U){return N+V(U,1/0)},0),H=V(Q($),$.key);return o(0,H+re)}).selectAll("."+d.cn.cellRect).attr("height",function($){return(re=Q($),H=$.key,re.rows[H-re.firstRowIndex]).rowHeight;var re,H})}function j(X,$){for(var re=0,H=$-1;H>=0;H--)re+=Z(X[H]);return re}function V(X,$){for(var re=0,H=0;H<X.rows.length&&X.rows[H].rowIndex<$;H++)re+=X.rows[H].rowHeight;return re}function Z(X){var $=X.allRowsHeight;if($!==void 0)return $;for(var re=0,H=0;H<X.rows.length;H++)re+=X.rows[H].rowHeight;return X.allRowsHeight=re,re}function Q(X){return X.rowBlocks[X.page]}G.exports=function(X,$){var re=!X._context.staticPlot,H=X._fullLayout._paper.selectAll("."+d.cn.table).data($.map(function(ye){var Se=y.unwrap(ye).trace;return g(X,Se)}),y.keyFun);H.exit().remove(),H.enter().append("g").classed(d.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),H.attr("width",function(ye){return ye.width+ye.size.l+ye.size.r}).attr("height",function(ye){return ye.height+ye.size.t+ye.size.b}).attr("transform",function(ye){return o(ye.translateX,ye.translateY)});var N=H.selectAll("."+d.cn.tableControlView).data(y.repeat,y.keyFun),U=N.enter().append("g").classed(d.cn.tableControlView,!0).style("box-sizing","content-box");if(re){var te="onwheel"in document?"wheel":"mousewheel";U.on("mousemove",function(ye){N.filter(function(Se){return ye===Se}).call(u,X)}).on(te,function(ye){if(!ye.scrollbarState.wheeling){ye.scrollbarState.wheeling=!0;var Se=ye.scrollY+v.event.deltaY;I(X,N,null,Se)(ye)||(v.event.stopPropagation(),v.event.preventDefault()),ye.scrollbarState.wheeling=!1}}).call(u,X,!0)}N.attr("transform",function(ye){return o(ye.size.l,ye.size.t)});var B=N.selectAll("."+d.cn.scrollBackground).data(y.repeat,y.keyFun);B.enter().append("rect").classed(d.cn.scrollBackground,!0).attr("fill","none"),B.attr("width",function(ye){return ye.width}).attr("height",function(ye){return ye.height}),N.each(function(ye){e.setClipUrl(v.select(this),l(X,ye),X)});var K=N.selectAll("."+d.cn.yColumn).data(function(ye){return ye.columns},y.keyFun);K.enter().append("g").classed(d.cn.yColumn,!0),K.exit().remove(),K.attr("transform",function(ye){return o(ye.x,0)}),re&&K.call(v.behavior.drag().origin(function(ye){return b(v.select(this),ye,-d.uplift),n(this),ye.calcdata.columnDragInProgress=!0,u(N.filter(function(Se){return ye.calcdata.key===Se.key}),X),ye}).on("drag",function(ye){var Se=v.select(this),fe=function(ge){return(ye===ge?v.event.x:ge.x)+ge.columnWidth/2};ye.x=Math.max(-d.overdrag,Math.min(ye.calcdata.width+d.overdrag-ye.columnWidth,v.event.x)),p(K).filter(function(ge){return ge.calcdata.key===ye.calcdata.key}).sort(function(ge,Te){return fe(ge)-fe(Te)}).forEach(function(ge,Te){ge.xIndex=Te,ge.x=ye===ge?ge.x:ge.xScale(ge)}),K.filter(function(ge){return ye!==ge}).transition().ease(d.transitionEase).duration(d.transitionDuration).attr("transform",function(ge){return o(ge.x,0)}),Se.call(r).attr("transform",o(ye.x,-d.uplift))}).on("dragend",function(ye){var Se=v.select(this),fe=ye.calcdata;ye.x=ye.xScale(ye),ye.calcdata.columnDragInProgress=!1,b(Se,ye,0),function(ge,Te,le){var ve=Te.gdColumnsOriginalOrder;Te.gdColumns.sort(function(Me,we){return le[ve.indexOf(Me)]-le[ve.indexOf(we)]}),Te.columnorder=le,ge.emit("plotly_restyle")}(X,fe,fe.columns.map(function(ge){return ge.xIndex}))})),K.each(function(ye){e.setClipUrl(v.select(this),s(X,ye),X)});var J=K.selectAll("."+d.cn.columnBlock).data(c.splitToPanels,y.keyFun);J.enter().append("g").classed(d.cn.columnBlock,!0).attr("id",function(ye){return ye.key}),J.style("cursor",function(ye){return ye.dragHandle?"ew-resize":ye.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"});var ee=J.filter(k),ne=J.filter(T);re&&ne.call(v.behavior.drag().origin(function(ye){return v.event.stopPropagation(),ye}).on("drag",I(X,N,-1)).on("dragend",function(){})),i(X,N,ee,J),i(X,N,ne,J);var se=N.selectAll("."+d.cn.scrollAreaClip).data(y.repeat,y.keyFun);se.enter().append("clipPath").classed(d.cn.scrollAreaClip,!0).attr("id",function(ye){return l(X,ye)});var oe=se.selectAll("."+d.cn.scrollAreaClipRect).data(y.repeat,y.keyFun);oe.enter().append("rect").classed(d.cn.scrollAreaClipRect,!0).attr("x",-d.overdrag).attr("y",-d.uplift).attr("fill","none"),oe.attr("width",function(ye){return ye.width+2*d.overdrag}).attr("height",function(ye){return ye.height+d.uplift}),K.selectAll("."+d.cn.columnBoundary).data(y.repeat,y.keyFun).enter().append("g").classed(d.cn.columnBoundary,!0);var me=K.selectAll("."+d.cn.columnBoundaryClippath).data(y.repeat,y.keyFun);me.enter().append("clipPath").classed(d.cn.columnBoundaryClippath,!0),me.attr("id",function(ye){return s(X,ye)});var ce=me.selectAll("."+d.cn.columnBoundaryRect).data(y.repeat,y.keyFun);ce.enter().append("rect").classed(d.cn.columnBoundaryRect,!0).attr("fill","none"),ce.attr("width",function(ye){return ye.columnWidth+2*h(ye)}).attr("height",function(ye){return ye.calcdata.height+2*h(ye)+d.uplift}).attr("x",function(ye){return-h(ye)}).attr("y",function(ye){return-h(ye)}),A(null,ne,N)}},{"../../components/color":367,"../../components/drawing":389,"../../lib":515,"../../lib/gup":512,"../../lib/svg_text_utils":541,"./constants":1078,"./data_preparation_helper":1079,"./data_split_helpers":1080,"@plotly/d3":58}],1084:[function(m,G,Y){var d=m("../../plots/template_attributes").hovertemplateAttrs,v=m("../../plots/template_attributes").texttemplateAttrs,w=m("../../components/colorscale/attributes"),y=m("../../plots/domain").attributes,e=m("../pie/attributes"),t=m("../sunburst/attributes"),n=m("./constants"),o=m("../../lib/extend").extendFlat;G.exports={labels:t.labels,parents:t.parents,values:t.values,branchvalues:t.branchvalues,count:t.count,level:t.level,maxdepth:t.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:o({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:t.marker.colors,depthfade:{valType:"enumerated",values:[!0,!1,"reversed"],editType:"style"},line:t.marker.line,editType:"calc"},w("marker",{colorAttr:"colors",anim:!1})),pathbar:{visible:{valType:"boolean",dflt:!0,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:o({},e.textfont,{}),editType:"calc"},text:e.text,textinfo:t.textinfo,texttemplate:v({editType:"plot"},{keys:n.eventDataKeys.concat(["label","value"])}),hovertext:e.hovertext,hoverinfo:t.hoverinfo,hovertemplate:d({},{keys:n.eventDataKeys}),textfont:e.textfont,insidetextfont:e.insidetextfont,outsidetextfont:o({},e.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},sort:e.sort,root:t.root,domain:y({name:"treemap",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plots/domain":593,"../../plots/template_attributes":642,"../pie/attributes":910,"../sunburst/attributes":1058,"./constants":1087}],1085:[function(m,G,Y){var d=m("../../plots/plots");Y.name="treemap",Y.plot=function(v,w,y,e){d.plotBasePlot(Y.name,v,w,y,e)},Y.clean=function(v,w,y,e){d.cleanBasePlot(Y.name,v,w,y,e)}},{"../../plots/plots":628}],1086:[function(m,G,Y){var d=m("../sunburst/calc");Y.calc=function(v,w){return d.calc(v,w)},Y.crossTraceCalc=function(v){return d._runCrossTraceCalc("treemap",v)}},{"../sunburst/calc":1060}],1087:[function(m,G,Y){G.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1088:[function(m,G,Y){var d=m("../../lib"),v=m("./attributes"),w=m("../../components/color"),y=m("../../plots/domain").defaults,e=m("../bar/defaults").handleText,t=m("../bar/constants").TEXTPAD,n=m("../../components/colorscale"),o=n.hasColorscale,r=n.handleDefaults;G.exports=function(g,c,a,h){function l(T,k){return d.coerce(g,c,v,T,k)}var s=l("labels"),p=l("parents");if(s&&s.length&&p&&p.length){var u=l("values");u&&u.length?l("branchvalues"):l("count"),l("level"),l("maxdepth"),l("tiling.packing")==="squarify"&&l("tiling.squarifyratio"),l("tiling.flip"),l("tiling.pad");var i=l("text");l("texttemplate"),c.texttemplate||l("textinfo",Array.isArray(i)?"text+label":"label"),l("hovertext"),l("hovertemplate");var x=l("pathbar.visible");e(g,c,h,l,"auto",{hasPathbar:x,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),l("textposition");var f=c.textposition.indexOf("bottom")!==-1;l("marker.line.width")&&l("marker.line.color",h.paper_bgcolor);var _=l("marker.colors");(c._hasColorscale=o(g,"marker","colors")||(g.marker||{}).coloraxis)?r(g,c,h,l,{prefix:"marker.",cLetter:"c"}):l("marker.depthfade",!(_||[]).length);var b=2*c.textfont.size;l("marker.pad.t",f?b/4:b),l("marker.pad.l",b/4),l("marker.pad.r",b/4),l("marker.pad.b",f?b:b/4),c._hovered={marker:{line:{width:2,color:w.contrast(h.paper_bgcolor)}}},x&&(l("pathbar.thickness",c.pathbar.textfont.size+2*t),l("pathbar.side"),l("pathbar.edgeshape")),l("sort"),l("root.color"),y(c,h,l),c._length=null}else c.visible=!1}},{"../../components/color":367,"../../components/colorscale":379,"../../lib":515,"../../plots/domain":593,"../bar/constants":659,"../bar/defaults":661,"./attributes":1084}],1089:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../sunburst/helpers"),w=m("../bar/uniform_text").clearMinTextSize,y=m("../bar/style").resizeText,e=m("./plot_one");G.exports=function(t,n,o,r,g){var c,a,h=g.type,l=g.drawDescendants,s=t._fullLayout,p=s["_"+h+"layer"],u=!o;w(h,s),(c=p.selectAll("g.trace."+h).data(n,function(i){return i[0].trace.uid})).enter().append("g").classed("trace",!0).classed(h,!0),c.order(),!s.uniformtext.mode&&v.hasTransition(o)?(r&&(a=r()),d.transition().duration(o.duration).ease(o.easing).each("end",function(){a&&a()}).each("interrupt",function(){a&&a()}).each(function(){p.selectAll("g.trace").each(function(i){e(t,i,this,o,l)})})):(c.each(function(i){e(t,i,this,o,l)}),s.uniformtext.mode&&y(t,p.selectAll(".trace"),h)),u&&c.exit().remove()}},{"../bar/style":671,"../bar/uniform_text":673,"../sunburst/helpers":1064,"./plot_one":1098,"@plotly/d3":58}],1090:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../components/drawing"),y=m("../../lib/svg_text_utils"),e=m("./partition"),t=m("./style").styleOne,n=m("./constants"),o=m("../sunburst/helpers"),r=m("../sunburst/fx");G.exports=function(g,c,a,h,l){var s=l.barDifY,p=l.width,u=l.height,i=l.viewX,x=l.viewY,f=l.pathSlice,_=l.toMoveInsideSlice,b=l.strTransform,T=l.hasTransition,k=l.handleSlicesExit,L=l.makeUpdateSliceInterpolator,A=l.makeUpdateTextInterpolator,I={},P=g._context.staticPlot,S=g._fullLayout,E=c[0],z=E.trace,D=E.hierarchy,j=p/z._entryDepth,V=o.listPath(a.data,"id"),Z=e(D.copy(),[p,u],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();(Z=Z.filter(function(X){var $=V.indexOf(X.data.id);return $!==-1&&(X.x0=j*$,X.x1=j*($+1),X.y0=s,X.y1=s+u,X.onPathbar=!0,!0)})).reverse(),(h=h.data(Z,o.getPtId)).enter().append("g").classed("pathbar",!0),k(h,!0,I,[p,u],f),h.order();var Q=h;T&&(Q=Q.transition().each("end",function(){var X=d.select(this);o.setSliceCursor(X,g,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:!1})})),Q.each(function(X){X._x0=i(X.x0),X._x1=i(X.x1),X._y0=x(X.y0),X._y1=x(X.y1),X._hoverX=i(X.x1-Math.min(p,u)/2),X._hoverY=x(X.y1-u/2);var $=d.select(this),re=v.ensureSingle($,"path","surface",function(te){te.style("pointer-events",P?"none":"all")});T?re.transition().attrTween("d",function(te){var B=L(te,!0,I,[p,u]);return function(K){return f(B(K))}}):re.attr("d",f),$.call(r,a,g,c,{styleOne:t,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(o.setSliceCursor,g,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:g._transitioning}),re.call(t,X,z,{hovered:!1}),X._text=(o.getPtLabel(X)||"").split("<br>").join(" ")||"";var H=v.ensureSingle($,"g","slicetext"),N=v.ensureSingle(H,"text","",function(te){te.attr("data-notex",1)}),U=v.ensureUniformFontSize(g,o.determineTextFont(z,X,S.font,{onPathbar:!0}));N.text(X._text||" ").classed("slicetext",!0).attr("text-anchor","start").call(w.font,U).call(y.convertToTspans,g),X.textBB=w.bBox(N.node()),X.transform=_(X,{fontSize:U.size,onPathbar:!0}),X.transform.fontSize=U.size,T?N.transition().attrTween("transform",function(te){var B=A(te,!0,I,[p,u]);return function(K){return b(B(K))}}):N.attr("transform",b(X))})}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"./constants":1087,"./partition":1096,"./style":1099,"@plotly/d3":58}],1091:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../components/drawing"),y=m("../../lib/svg_text_utils"),e=m("./partition"),t=m("./style").styleOne,n=m("./constants"),o=m("../sunburst/helpers"),r=m("../sunburst/fx"),g=m("../sunburst/plot").formatSliceLabel;G.exports=function(c,a,h,l,s){var p=s.width,u=s.height,i=s.viewX,x=s.viewY,f=s.pathSlice,_=s.toMoveInsideSlice,b=s.strTransform,T=s.hasTransition,k=s.handleSlicesExit,L=s.makeUpdateSliceInterpolator,A=s.makeUpdateTextInterpolator,I=s.prevEntry,P=c._context.staticPlot,S=c._fullLayout,E=a[0].trace,z=E.textposition.indexOf("left")!==-1,D=E.textposition.indexOf("right")!==-1,j=E.textposition.indexOf("bottom")!==-1,V=!j&&!E.marker.pad.t||j&&!E.marker.pad.b,Z=e(h,[p,u],{packing:E.tiling.packing,squarifyratio:E.tiling.squarifyratio,flipX:E.tiling.flip.indexOf("x")>-1,flipY:E.tiling.flip.indexOf("y")>-1,pad:{inner:E.tiling.pad,top:E.marker.pad.t,left:E.marker.pad.l,right:E.marker.pad.r,bottom:E.marker.pad.b}}).descendants(),Q=1/0,X=-1/0;Z.forEach(function(U){var te=U.depth;te>=E._maxDepth?(U.x0=U.x1=(U.x0+U.x1)/2,U.y0=U.y1=(U.y0+U.y1)/2):(Q=Math.min(Q,te),X=Math.max(X,te))}),l=l.data(Z,o.getPtId),E._maxVisibleLayers=isFinite(X)?X-Q+1:0,l.enter().append("g").classed("slice",!0),k(l,!1,{},[p,u],f),l.order();var $=null;if(T&&I){var re=o.getPtId(I);l.each(function(U){$===null&&o.getPtId(U)===re&&($={x0:U.x0,x1:U.x1,y0:U.y0,y1:U.y1})})}var H=function(){return $||{x0:0,x1:p,y0:0,y1:u}},N=l;return T&&(N=N.transition().each("end",function(){var U=d.select(this);o.setSliceCursor(U,c,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})})),N.each(function(U){var te=o.isHeader(U,E);U._x0=i(U.x0),U._x1=i(U.x1),U._y0=x(U.y0),U._y1=x(U.y1),U._hoverX=i(U.x1-E.marker.pad.r),U._hoverY=x(j?U.y1-E.marker.pad.b/2:U.y0+E.marker.pad.t/2);var B=d.select(this),K=v.ensureSingle(B,"path","surface",function(se){se.style("pointer-events",P?"none":"all")});T?K.transition().attrTween("d",function(se){var oe=L(se,!1,H(),[p,u]);return function(me){return f(oe(me))}}):K.attr("d",f),B.call(r,h,c,a,{styleOne:t,eventDataKeys:n.eventDataKeys,transitionTime:n.CLICK_TRANSITION_TIME,transitionEasing:n.CLICK_TRANSITION_EASING}).call(o.setSliceCursor,c,{isTransitioning:c._transitioning}),K.call(t,U,E,{hovered:!1}),U.x0===U.x1||U.y0===U.y1?U._text="":U._text=te?V?"":o.getPtLabel(U)||"":g(U,h,E,a,S)||"";var J=v.ensureSingle(B,"g","slicetext"),ee=v.ensureSingle(J,"text","",function(se){se.attr("data-notex",1)}),ne=v.ensureUniformFontSize(c,o.determineTextFont(E,U,S.font));ee.text(U._text||" ").classed("slicetext",!0).attr("text-anchor",D?"end":z||te?"start":"middle").call(w.font,ne).call(y.convertToTspans,c),U.textBB=w.bBox(ee.node()),U.transform=_(U,{fontSize:ne.size,isHeader:te}),U.transform.fontSize=ne.size,T?ee.transition().attrTween("transform",function(se){var oe=A(se,!1,H(),[p,u]);return function(me){return b(oe(me))}}):ee.attr("transform",b(U))}),$}},{"../../components/drawing":389,"../../lib":515,"../../lib/svg_text_utils":541,"../sunburst/fx":1063,"../sunburst/helpers":1064,"../sunburst/plot":1068,"./constants":1087,"./partition":1096,"./style":1099,"@plotly/d3":58}],1092:[function(m,G,Y){G.exports=function d(v,w,y){var e;y.swapXY&&(e=v.x0,v.x0=v.y0,v.y0=e,e=v.x1,v.x1=v.y1,v.y1=e),y.flipX&&(e=v.x0,v.x0=w[0]-v.x1,v.x1=w[0]-e),y.flipY&&(e=v.y0,v.y0=w[1]-v.y1,v.y1=w[1]-e);var t=v.children;if(t)for(var n=0;n<t.length;n++)d(t[n],w,y)}},{}],1093:[function(m,G,Y){G.exports={moduleType:"trace",name:"treemap",basePlotModule:m("./base_plot"),categories:[],animatable:!0,attributes:m("./attributes"),layoutAttributes:m("./layout_attributes"),supplyDefaults:m("./defaults"),supplyLayoutDefaults:m("./layout_defaults"),calc:m("./calc").calc,crossTraceCalc:m("./calc").crossTraceCalc,plot:m("./plot"),style:m("./style").style,colorbar:m("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":954,"./attributes":1084,"./base_plot":1085,"./calc":1086,"./defaults":1088,"./layout_attributes":1094,"./layout_defaults":1095,"./plot":1097,"./style":1099}],1094:[function(m,G,Y){G.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1095:[function(m,G,Y){var d=m("../../lib"),v=m("./layout_attributes");G.exports=function(w,y){function e(t,n){return d.coerce(w,y,v,t,n)}e("treemapcolorway",y.colorway),e("extendtreemapcolors")}},{"../../lib":515,"./layout_attributes":1094}],1096:[function(m,G,Y){var d=m("d3-hierarchy"),v=m("./flip_tree");G.exports=function(w,y,e){var t,n=e.flipX,o=e.flipY,r=e.packing==="dice-slice",g=e.pad[o?"bottom":"top"],c=e.pad[n?"right":"left"],a=e.pad[n?"left":"right"],h=e.pad[o?"top":"bottom"];r&&(t=c,c=g,g=t,t=a,a=h,h=t);var l=d.treemap().tile(function(s,p){switch(s){case"squarify":return d.treemapSquarify.ratio(p);case"binary":return d.treemapBinary;case"dice":return d.treemapDice;case"slice":return d.treemapSlice;default:return d.treemapSliceDice}}(e.packing,e.squarifyratio)).paddingInner(e.pad.inner).paddingLeft(c).paddingRight(a).paddingTop(g).paddingBottom(h).size(r?[y[1],y[0]]:y)(w);return(r||n||o)&&v(l,y,{swapXY:r,flipX:n,flipY:o}),l}},{"./flip_tree":1092,"d3-hierarchy":115}],1097:[function(m,G,Y){var d=m("./draw"),v=m("./draw_descendants");G.exports=function(w,y,e,t){return d(w,y,e,t,{type:"treemap",drawDescendants:v})}},{"./draw":1089,"./draw_descendants":1091}],1098:[function(m,G,Y){var d=m("@plotly/d3"),v=m("d3-interpolate").interpolate,w=m("../sunburst/helpers"),y=m("../../lib"),e=m("../bar/constants").TEXTPAD,t=m("../bar/plot").toMoveInsideBar,n=m("../bar/uniform_text").recordMinTextSize,o=m("./constants"),r=m("./draw_ancestors");function g(c){return w.isHierarchyRoot(c)?"":w.getPtId(c)}G.exports=function(c,a,h,l,s){var p=c._fullLayout,u=a[0],i=u.trace,x=i.type==="icicle",f=u.hierarchy,_=w.findEntryWithLevel(f,i.level),b=d.select(h),T=b.selectAll("g.pathbar"),k=b.selectAll("g.slice");if(!_)return T.remove(),void k.remove();var L=w.isHierarchyRoot(_),A=!p.uniformtext.mode&&w.hasTransition(l),I=w.getMaxDepth(i),P=p._size,S=i.domain,E=P.w*(S.x[1]-S.x[0]),z=P.h*(S.y[1]-S.y[0]),D=E,j=i.pathbar.thickness,V=i.marker.line.width+o.gapWithPathbar,Z=i.pathbar.visible?i.pathbar.side.indexOf("bottom")>-1?z+V:-(j+V):0,Q={x0:D,x1:D,y0:Z,y1:Z+j},X=function(de,Ie,De){var Oe=i.tiling.pad,Ve=function(We){return We-Oe<=Ie.x0},Fe=function(We){return We+Oe>=Ie.x1},ze=function(We){return We-Oe<=Ie.y0},Re=function(We){return We+Oe>=Ie.y1};return de.x0===Ie.x0&&de.x1===Ie.x1&&de.y0===Ie.y0&&de.y1===Ie.y1?{x0:de.x0,x1:de.x1,y0:de.y0,y1:de.y1}:{x0:Ve(de.x0-Oe)?0:Fe(de.x0-Oe)?De[0]:de.x0,x1:Ve(de.x1+Oe)?0:Fe(de.x1+Oe)?De[0]:de.x1,y0:ze(de.y0-Oe)?0:Re(de.y0-Oe)?De[1]:de.y0,y1:ze(de.y1+Oe)?0:Re(de.y1+Oe)?De[1]:de.y1}},$=null,re={},H={},N=null,U=function(de,Ie){return Ie?re[g(de)]:H[g(de)]},te=function(de,Ie,De,Oe){if(Ie)return re[g(f)]||Q;var Ve=H[i.level]||De;return function(Fe){return Fe.data.depth-_.data.depth<I}(de)?X(de,Ve,Oe):{}};u.hasMultipleRoots&&L&&I++,i._maxDepth=I,i._backgroundColor=p.paper_bgcolor,i._entryDepth=_.data.depth,i._atRootLevel=L;var B=-E/2+P.l+P.w*(S.x[1]+S.x[0])/2,K=-z/2+P.t+P.h*(1-(S.y[1]+S.y[0])/2),J=function(de){return B+de},ee=function(de){return K+de},ne=ee(0),se=J(0),oe=function(de){return se+de},me=function(de){return ne+de};function ce(de,Ie){return de+","+Ie}var ye=oe(0),Se=function(de){de.x=Math.max(ye,de.x)},fe=i.pathbar.edgeshape,ge=function(de,Ie){var De=de.x0,Oe=de.x1,Ve=de.y0,Fe=de.y1,ze=de.textBB,Re=function(vt){return i.textposition.indexOf(vt)!==-1},We=Re("bottom"),$e=Re("top")||Ie.isHeader&&!We?"start":We?"end":"middle",at=Re("right"),gt=Re("left")||Ie.onPathbar?-1:at?1:0,xt=i[x?"tiling":"marker"].pad;if(Ie.isHeader){if((De+=(x?xt:xt.l)-e)>=(Oe-=(x?xt:xt.r)-e)){var mt=(De+Oe)/2;De=mt,Oe=mt}var nt;We?Ve<(nt=Fe-(x?xt:xt.b))&&nt<Fe&&(Ve=nt):Ve<(nt=Ve+(x?xt:xt.t))&&nt<Fe&&(Fe=nt)}var Qe=t(De,Oe,Ve,Fe,ze,{isHorizontal:!1,constrained:!0,angle:0,anchor:$e,leftToRight:gt});return Qe.fontSize=Ie.fontSize,Qe.targetX=J(Qe.targetX),Qe.targetY=ee(Qe.targetY),isNaN(Qe.targetX)||isNaN(Qe.targetY)?{}:(De!==Oe&&Ve!==Fe&&n(i.type,Qe,p),{scale:Qe.scale,rotate:Qe.rotate,textX:Qe.textX,textY:Qe.textY,anchorX:Qe.anchorX,anchorY:Qe.anchorY,targetX:Qe.targetX,targetY:Qe.targetY})},Te=function(de,Ie){for(var De,Oe=0,Ve=de;!De&&Oe<I;)Oe++,(Ve=Ve.parent)?De=U(Ve,Ie):Oe=I;return De||{}},le=function(de,Ie,De,Oe,Ve){var Fe,ze=U(de,Ie);if(ze)Fe=ze;else if(Ie)Fe=Q;else if($)if(de.parent){var Re=N||De;Re&&!Ie?Fe=X(de,Re,Oe):(Fe={},y.extendFlat(Fe,Te(de,Ie)))}else Fe=y.extendFlat({},de),x&&(Ve.orientation==="h"?Ve.flipX?Fe.x0=de.x1:Fe.x1=0:Ve.flipY?Fe.y0=de.y1:Fe.y1=0);else Fe={};return v(Fe,{x0:de.x0,x1:de.x1,y0:de.y0,y1:de.y1})},ve=function(de,Ie,De,Oe){var Ve=U(de,Ie),Fe={},ze=te(de,Ie,De,Oe);y.extendFlat(Fe,{transform:ge({x0:ze.x0,x1:ze.x1,y0:ze.y0,y1:ze.y1,textBB:de.textBB,_text:de._text},{isHeader:w.isHeader(de,i)})}),Ve?Fe=Ve:de.parent&&y.extendFlat(Fe,Te(de,Ie));var Re=de.transform;return de.x0!==de.x1&&de.y0!==de.y1&&n(i.type,Re,p),v(Fe,{transform:{scale:Re.scale,rotate:Re.rotate,textX:Re.textX,textY:Re.textY,anchorX:Re.anchorX,anchorY:Re.anchorY,targetX:Re.targetX,targetY:Re.targetY}})},Me=function(de,Ie,De,Oe,Ve){var Fe=Oe[0],ze=Oe[1];A?de.exit().transition().each(function(){var Re=d.select(this);Re.select("path.surface").transition().attrTween("d",function(We){var $e=function(at,gt,xt,mt){var nt,Qe=U(at,gt);if(gt)nt=Q;else{var vt=U(_,gt);nt=vt?X(at,vt,mt):{}}return v(Qe,nt)}(We,Ie,0,[Fe,ze]);return function(at){return Ve($e(at))}}),Re.select("g.slicetext").attr("opacity",0)}).remove():de.exit().remove()},we=function(de){var Ie=de.transform;return de.x0!==de.x1&&de.y0!==de.y1&&n(i.type,Ie,p),y.getTextTransform({textX:Ie.textX,textY:Ie.textY,anchorX:Ie.anchorX,anchorY:Ie.anchorY,targetX:Ie.targetX,targetY:Ie.targetY,scale:Ie.scale,rotate:Ie.rotate})};A&&(T.each(function(de){re[g(de)]={x0:de.x0,x1:de.x1,y0:de.y0,y1:de.y1},de.transform&&(re[g(de)].transform={textX:de.transform.textX,textY:de.transform.textY,anchorX:de.transform.anchorX,anchorY:de.transform.anchorY,targetX:de.transform.targetX,targetY:de.transform.targetY,scale:de.transform.scale,rotate:de.transform.rotate})}),k.each(function(de){H[g(de)]={x0:de.x0,x1:de.x1,y0:de.y0,y1:de.y1},de.transform&&(H[g(de)].transform={textX:de.transform.textX,textY:de.transform.textY,anchorX:de.transform.anchorX,anchorY:de.transform.anchorY,targetX:de.transform.targetX,targetY:de.transform.targetY,scale:de.transform.scale,rotate:de.transform.rotate}),!$&&w.isEntry(de)&&($=de)})),N=s(c,a,_,k,{width:E,height:z,viewX:J,viewY:ee,pathSlice:function(de){var Ie=J(de.x0),De=J(de.x1),Oe=ee(de.y0),Ve=ee(de.y1),Fe=De-Ie,ze=Ve-Oe;return!Fe||!ze?"":"M"+ce(Ie,Oe+0)+"L"+ce(De-0,Oe)+"L"+ce(De,Ve-0)+"L"+ce(Ie+0,Ve)+"Z"},toMoveInsideSlice:ge,prevEntry:$,makeUpdateSliceInterpolator:le,makeUpdateTextInterpolator:ve,handleSlicesExit:Me,hasTransition:A,strTransform:we}),i.pathbar.visible?r(c,a,_,T,{barDifY:Z,width:D,height:j,viewX:oe,viewY:me,pathSlice:function(de){var Ie=oe(Math.max(Math.min(de.x0,de.x0),0)),De=oe(Math.min(Math.max(de.x1,de.x1),D)),Oe=me(de.y0),Ve=me(de.y1),Fe=j/2,ze={},Re={};ze.x=Ie,Re.x=De,ze.y=Re.y=(Oe+Ve)/2;var We={x:Ie,y:Oe},$e={x:De,y:Oe},at={x:De,y:Ve},gt={x:Ie,y:Ve};return fe===">"?(We.x-=Fe,$e.x-=Fe,at.x-=Fe,gt.x-=Fe):fe==="/"?(at.x-=Fe,gt.x-=Fe,ze.x-=Fe/2,Re.x-=Fe/2):fe==="\\"?(We.x-=Fe,$e.x-=Fe,ze.x-=Fe/2,Re.x-=Fe/2):fe==="<"&&(ze.x-=Fe,Re.x-=Fe),Se(We),Se(gt),Se(ze),Se($e),Se(at),Se(Re),"M"+ce(We.x,We.y)+"L"+ce($e.x,$e.y)+"L"+ce(Re.x,Re.y)+"L"+ce(at.x,at.y)+"L"+ce(gt.x,gt.y)+"L"+ce(ze.x,ze.y)+"Z"},toMoveInsideSlice:ge,makeUpdateSliceInterpolator:le,makeUpdateTextInterpolator:ve,handleSlicesExit:Me,hasTransition:A,strTransform:we}):T.remove()}},{"../../lib":515,"../bar/constants":659,"../bar/plot":668,"../bar/uniform_text":673,"../sunburst/helpers":1064,"./constants":1087,"./draw_ancestors":1090,"@plotly/d3":58,"d3-interpolate":116}],1099:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../components/color"),w=m("../../lib"),y=m("../sunburst/helpers"),e=m("../bar/uniform_text").resizeText;function t(n,o,r,g){var c,a,h=(g||{}).hovered,l=o.data.data,s=l.i,p=l.color,u=y.isHierarchyRoot(o),i=1;if(h)c=r._hovered.marker.line.color,a=r._hovered.marker.line.width;else if(u&&p===r.root.color)i=100,c="rgba(0,0,0,0)",a=0;else if(c=w.castOption(r,s,"marker.line.color")||v.defaultLine,a=w.castOption(r,s,"marker.line.width")||0,!r._hasColorscale&&!o.onPathbar){var x=r.marker.depthfade;if(x){var f,_=v.combine(v.addOpacity(r._backgroundColor,.75),p);if(x===!0){var b=y.getMaxDepth(r);f=isFinite(b)?y.isLeaf(o)?0:r._maxVisibleLayers-(o.data.depth-r._entryDepth):o.data.height+1}else f=o.data.depth-r._entryDepth,r._atRootLevel||f++;if(f>0)for(var T=0;T<f;T++){var k=.5*T/f;p=v.combine(v.addOpacity(_,k),p)}}}n.style("stroke-width",a).call(v.fill,p).call(v.stroke,c).style("opacity",i)}G.exports={style:function(n){var o=n._fullLayout._treemaplayer.selectAll(".trace");e(n,o,"treemap"),o.each(function(r){var g=d.select(this),c=r[0].trace;g.style("opacity",c.opacity),g.selectAll("path.surface").each(function(a){d.select(this).call(t,a,c,{hovered:!1})})})},styleOne:t}},{"../../components/color":367,"../../lib":515,"../bar/uniform_text":673,"../sunburst/helpers":1064,"@plotly/d3":58}],1100:[function(m,G,Y){var d=m("../box/attributes"),v=m("../../lib/extend").extendFlat,w=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat;G.exports={y:d.y,x:d.x,x0:d.x0,y0:d.y0,xhoverformat:w("x"),yhoverformat:w("y"),name:v({},d.name,{}),orientation:v({},d.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:d.fillcolor,points:v({},d.boxpoints,{}),jitter:v({},d.jitter,{}),pointpos:v({},d.pointpos,{}),width:v({},d.width,{}),marker:d.marker,text:d.text,hovertext:d.hovertext,hovertemplate:d.hovertemplate,quartilemethod:d.quartilemethod,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:d.offsetgroup,alignmentgroup:d.alignmentgroup,selected:d.selected,unselected:d.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":505,"../../plots/cartesian/axis_format_attributes":569,"../box/attributes":682}],1101:[function(m,G,Y){var d=m("../../lib"),v=m("../../plots/cartesian/axes"),w=m("../box/calc"),y=m("./helpers"),e=m("../../constants/numerical").BADNUM;function t(o,r,g){var c=r.max-r.min;if(!c)return o.bandwidth?o.bandwidth:0;if(o.bandwidth)return Math.max(o.bandwidth,c/1e4);var a=g.length,h=d.stdev(g,a-1,r.mean);return Math.max(function(l,s,p){return 1.059*Math.min(s,p/1.349)*Math.pow(l,-.2)}(a,h,r.q3-r.q1),c/100)}function n(o,r,g,c){var a,h=o.spanmode,l=o.span||[],s=[r.min,r.max],p=[r.min-2*c,r.max+2*c];function u(x){var f=l[x],_=g.type==="multicategory"?g.r2c(f):g.d2c(f,0,o[r.valLetter+"calendar"]);return _===e?p[x]:_}var i={type:"linear",range:a=h==="soft"?p:h==="hard"?s:[u(0),u(1)]};return v.setConvert(i),i.cleanRange(),a}G.exports=function(o,r){var g=w(o,r);if(g[0].t.empty)return g;for(var c=o._fullLayout,a=v.getFromId(o,r[r.orientation==="h"?"xaxis":"yaxis"]),h=1/0,l=-1/0,s=0,p=0,u=0;u<g.length;u++){var i=g[u],x=i.pts.map(y.extractVal),f=i.bandwidth=t(r,i,x),_=i.span=n(r,i,a,f);if(i.min===i.max&&f===0)_=i.span=[i.min,i.max],i.density=[{v:1,t:_[0]}],i.bandwidth=f,s=Math.max(s,1);else{var b=_[1]-_[0],T=Math.ceil(b/(f/3)),k=b/T;if(!isFinite(k)||!isFinite(T))return d.error("Something went wrong with computing the violin span"),g[0].t.empty=!0,g;var L=y.makeKDE(i,r,x);i.density=new Array(T);for(var A=0,I=_[0];I<_[1]+k/2;A++,I+=k){var P=L(I);i.density[A]={v:P,t:I},s=Math.max(s,P)}}p=Math.max(p,x.length),h=Math.min(h,_[0]),l=Math.max(l,_[1])}var S=v.findExtremes(a,[h,l],{padded:!0});if(r._extremes[a._id]=S,r.width)g[0].t.maxKDE=s;else{var E=c._violinScaleGroupStats,z=r.scalegroup,D=E[z];D?(D.maxKDE=Math.max(D.maxKDE,s),D.maxCount=Math.max(D.maxCount,p)):E[z]={maxKDE:s,maxCount:p}}return g[0].t.labels.kde=d._(o,"kde:"),g}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/axes":566,"../box/calc":683,"./helpers":1104}],1102:[function(m,G,Y){var d=m("../box/cross_trace_calc").setPositionOffset,v=["v","h"];G.exports=function(w,y){for(var e=w.calcdata,t=y.xaxis,n=y.yaxis,o=0;o<v.length;o++){for(var r=v[o],g=r==="h"?n:t,c=[],a=0;a<e.length;a++){var h=e[a],l=h[0].t,s=h[0].trace;s.visible!==!0||s.type!=="violin"||l.empty||s.orientation!==r||s.xaxis!==t._id||s.yaxis!==n._id||c.push(a)}d("violin",w,c,g)}}},{"../box/cross_trace_calc":684}],1103:[function(m,G,Y){var d=m("../../lib"),v=m("../../components/color"),w=m("../box/defaults"),y=m("./attributes");G.exports=function(e,t,n,o){function r(b,T){return d.coerce(e,t,y,b,T)}function g(b,T){return d.coerce2(e,t,y,b,T)}if(w.handleSampleDefaults(e,t,r,o),t.visible!==!1){r("bandwidth"),r("side"),r("width")||(r("scalegroup",t.name),r("scalemode"));var c,a=r("span");Array.isArray(a)&&(c="manual"),r("spanmode",c);var h=r("line.color",(e.marker||{}).color||n),l=r("line.width"),s=r("fillcolor",v.addOpacity(t.line.color,.5));w.handlePointsDefaults(e,t,r,{prefix:""});var p=g("box.width"),u=g("box.fillcolor",s),i=g("box.line.color",h),x=g("box.line.width",l);r("box.visible",Boolean(p||u||i||x))||(t.box={visible:!1});var f=g("meanline.color",h),_=g("meanline.width",l);r("meanline.visible",Boolean(f||_))||(t.meanline={visible:!1}),r("quartilemethod")}}},{"../../components/color":367,"../../lib":515,"../box/defaults":685,"./attributes":1100}],1104:[function(m,G,Y){var d=m("../../lib"),v=function(w){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*w*w)};Y.makeKDE=function(w,y,e){var t=e.length,n=v,o=w.bandwidth,r=1/(t*o);return function(g){for(var c=0,a=0;a<t;a++)c+=n((g-e[a])/o);return r*c}},Y.getPositionOnKdePath=function(w,y,e){var t,n;y.orientation==="h"?(t="y",n="x"):(t="x",n="y");var o=d.findPointOnPath(w.path,e,n,{pathLength:w.pathLength}),r=w.posCenterPx,g=o[t];return[g,y.side==="both"?2*r-g:r]},Y.getKdeValue=function(w,y,e){var t=w.pts.map(Y.extractVal);return Y.makeKDE(w,y,t)(e)/w.posDensityScale},Y.extractVal=function(w){return w.v}},{"../../lib":515}],1105:[function(m,G,Y){var d=m("../../components/color"),v=m("../../lib"),w=m("../../plots/cartesian/axes"),y=m("../box/hover"),e=m("./helpers");G.exports=function(t,n,o,r,g){g||(g={});var c,a,h=g.hoverLayer,l=t.cd,s=l[0].trace,p=s.hoveron,u=p.indexOf("violins")!==-1,i=p.indexOf("kde")!==-1,x=[];if(u||i){var f=y.hoverOnBoxes(t,n,o,r);if(i&&f.length>0){var _,b,T,k,L,A=t.xa,I=t.ya;s.orientation==="h"?(L=n,_="y",T=I,b="x",k=A):(L=o,_="x",T=A,b="y",k=I);var P=l[t.index];if(L>=P.span[0]&&L<=P.span[1]){var S=v.extendFlat({},t),E=k.c2p(L,!0),z=e.getKdeValue(P,s,L),D=e.getPositionOnKdePath(P,s,E),j=T._offset,V=T._length;S[_+"0"]=D[0],S[_+"1"]=D[1],S[b+"0"]=S[b+"1"]=E,S[b+"Label"]=b+": "+w.hoverLabelText(k,L,s[b+"hoverformat"])+", "+l[0].t.labels.kde+" "+z.toFixed(3);for(var Z=0,Q=0;Q<f.length;Q++)if(f[Q].attr==="med"){Z=Q;break}S.spikeDistance=f[Z].spikeDistance;var X=_+"Spike";S[X]=f[Z][X],f[Z].spikeDistance=void 0,f[Z][X]=void 0,S.hovertemplate=!1,x.push(S),(a={})[_+"1"]=v.constrain(j+D[0],j,j+V),a[_+"2"]=v.constrain(j+D[1],j,j+V),a[b+"1"]=a[b+"2"]=k._offset+E}}u&&(x=x.concat(f))}p.indexOf("points")!==-1&&(c=y.hoverOnPoints(t,n,o));var $=h.selectAll(".violinline-"+s.uid).data(a?[0]:[]);return $.enter().append("line").classed("violinline-"+s.uid,!0).attr("stroke-width",1.5),$.exit().remove(),$.attr(a).call(d.stroke,t.color),r==="closest"?c?[c]:x:(c&&x.push(c),x)}},{"../../components/color":367,"../../lib":515,"../../plots/cartesian/axes":566,"../box/hover":687,"./helpers":1104}],1106:[function(m,G,Y){G.exports={attributes:m("./attributes"),layoutAttributes:m("./layout_attributes"),supplyDefaults:m("./defaults"),crossTraceDefaults:m("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:m("./layout_defaults"),calc:m("./calc"),crossTraceCalc:m("./cross_trace_calc"),plot:m("./plot"),style:m("./style"),styleOnSelect:m("../scatter/style").styleOnSelect,hoverPoints:m("./hover"),selectPoints:m("../box/select"),moduleType:"trace",name:"violin",basePlotModule:m("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../box/defaults":685,"../box/select":692,"../scatter/style":960,"./attributes":1100,"./calc":1101,"./cross_trace_calc":1102,"./defaults":1103,"./hover":1105,"./layout_attributes":1107,"./layout_defaults":1108,"./plot":1109,"./style":1110}],1107:[function(m,G,Y){var d=m("../box/layout_attributes"),v=m("../../lib").extendFlat;G.exports={violinmode:v({},d.boxmode,{}),violingap:v({},d.boxgap,{}),violingroupgap:v({},d.boxgroupgap,{})}},{"../../lib":515,"../box/layout_attributes":689}],1108:[function(m,G,Y){var d=m("../../lib"),v=m("./layout_attributes"),w=m("../box/layout_defaults");G.exports=function(y,e,t){w._supply(y,e,t,function(n,o){return d.coerce(y,e,v,n,o)},"violin")}},{"../../lib":515,"../box/layout_defaults":690,"./layout_attributes":1107}],1109:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../components/drawing"),y=m("../box/plot"),e=m("../scatter/line_points"),t=m("./helpers");G.exports=function(n,o,r,g){var c=n._fullLayout,a=o.xaxis,h=o.yaxis;function l(s,p){var u=e(s,{xaxis:a,yaxis:h,trace:p,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0,linearized:!0});return w.smoothopen(u[0],1)}v.makeTraceGroups(g,r,"trace violins").each(function(s){var p=d.select(this),u=s[0],i=u.t,x=u.trace;if(x.visible!==!0||i.empty)p.remove();else{var f=i.bPos,_=i.bdPos,b=o[i.valLetter+"axis"],T=o[i.posLetter+"axis"],k=x.side==="both",L=k||x.side==="positive",A=k||x.side==="negative",I=p.selectAll("path.violin").data(v.identity);I.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),I.exit().remove(),I.each(function(Z){var Q,X,$,re,H,N,U,te,B=d.select(this),K=Z.density,J=K.length,ee=T.c2l(Z.pos+f,!0),ne=T.l2p(ee);if(x.width)Q=i.maxKDE/_;else{var se=c._violinScaleGroupStats[x.scalegroup];Q=x.scalemode==="count"?se.maxKDE/_*(se.maxCount/Z.pts.length):se.maxKDE/_}if(L){for(U=new Array(J),H=0;H<J;H++)(te=U[H]={})[i.posLetter]=ee+K[H].v/Q,te[i.valLetter]=b.c2l(K[H].t,!0);X=l(U,x)}if(A){for(U=new Array(J),N=0,H=J-1;N<J;N++,H--)(te=U[N]={})[i.posLetter]=ee-K[H].v/Q,te[i.valLetter]=b.c2l(K[H].t,!0);$=l(U,x)}if(k)re=X+"L"+$.substr(1)+"Z";else{var oe=[ne,b.c2p(K[0].t)],me=[ne,b.c2p(K[J-1].t)];x.orientation==="h"&&(oe.reverse(),me.reverse()),re=L?"M"+oe+"L"+X.substr(1)+"L"+me:"M"+me+"L"+$.substr(1)+"L"+oe}B.attr("d",re),Z.posCenterPx=ne,Z.posDensityScale=Q*_,Z.path=B.node(),Z.pathLength=Z.path.getTotalLength()/(k?2:1)});var P,S,E,z=x.box,D=z.width,j=(z.line||{}).width;k?(P=_*D,S=0):L?(P=[0,_*D/2],S=j*{x:1,y:-1}[i.posLetter]):(P=[_*D/2,0],S=j*{x:-1,y:1}[i.posLetter]),y.plotBoxAndWhiskers(p,{pos:T,val:b},x,{bPos:f,bdPos:P,bPosPxOffset:S}),y.plotBoxMean(p,{pos:T,val:b},x,{bPos:f,bdPos:P,bPosPxOffset:S}),!x.box.visible&&x.meanline.visible&&(E=v.identity);var V=p.selectAll("path.meanline").data(E||[]);V.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),V.exit().remove(),V.each(function(Z){var Q=b.c2p(Z.mean,!0),X=t.getPositionOnKdePath(Z,x,Q);d.select(this).attr("d",x.orientation==="h"?"M"+Q+","+X[0]+"V"+X[1]:"M"+X[0]+","+Q+"H"+X[1])}),y.plotPoints(p,{x:a,y:h},x,i)}})}},{"../../components/drawing":389,"../../lib":515,"../box/plot":691,"../scatter/line_points":950,"./helpers":1104,"@plotly/d3":58}],1110:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../components/color"),w=m("../scatter/style").stylePoints;G.exports=function(y){var e=d.select(y).selectAll("g.trace.violins");e.style("opacity",function(t){return t[0].trace.opacity}),e.each(function(t){var n=t[0].trace,o=d.select(this),r=n.box||{},g=r.line||{},c=n.meanline||{},a=c.width;o.selectAll("path.violin").style("stroke-width",n.line.width+"px").call(v.stroke,n.line.color).call(v.fill,n.fillcolor),o.selectAll("path.box").style("stroke-width",g.width+"px").call(v.stroke,g.color).call(v.fill,r.fillcolor);var h={"stroke-width":a+"px","stroke-dasharray":2*a+"px,"+a+"px"};o.selectAll("path.mean").style(h).call(v.stroke,c.color),o.selectAll("path.meanline").style(h).call(v.stroke,c.color),w(o,n,y)})}},{"../../components/color":367,"../scatter/style":960,"@plotly/d3":58}],1111:[function(m,G,Y){var d=m("../../components/colorscale/attributes"),v=m("../isosurface/attributes"),w=m("../surface/attributes"),y=m("../../plots/attributes"),e=m("../../lib/extend").extendFlat,t=m("../../plot_api/edit_types").overrideAll,n=G.exports=t(e({x:v.x,y:v.y,z:v.z,value:v.value,isomin:v.isomin,isomax:v.isomax,surface:v.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:v.slices,caps:v.caps,text:v.text,hovertext:v.hovertext,xhoverformat:v.xhoverformat,yhoverformat:v.yhoverformat,zhoverformat:v.zhoverformat,valuehoverformat:v.valuehoverformat,hovertemplate:v.hovertemplate},d("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:v.colorbar,opacity:v.opacity,opacityscale:w.opacityscale,lightposition:v.lightposition,lighting:v.lighting,flatshading:v.flatshading,contour:v.contour,hoverinfo:e({},y.hoverinfo),showlegend:e({},y.showlegend,{dflt:!1})}),"calc","nested");n.x.editType=n.y.editType=n.z.editType=n.value.editType="calc+clearAxisTypes",n.transforms=void 0},{"../../components/colorscale/attributes":374,"../../lib/extend":505,"../../plot_api/edit_types":548,"../../plots/attributes":562,"../isosurface/attributes":871,"../surface/attributes":1070}],1112:[function(m,G,Y){var d=m("../../../stackgl_modules").gl_mesh3d,v=m("../../lib/gl_format_color").parseColorScale,w=m("../../lib/str2rgbarray"),y=m("../../components/colorscale").extractOpts,e=m("../../plots/gl3d/zip3"),t=m("../isosurface/convert").findNearestOnAxis,n=m("../isosurface/convert").generateIsoMeshes;function o(g,c,a){this.scene=g,this.uid=a,this.mesh=c,this.name="",this.data=null,this.showContour=!1}var r=o.prototype;r.handlePick=function(g){if(g.object===this.mesh){var c=g.data.index,a=this.data._meshX[c],h=this.data._meshY[c],l=this.data._meshZ[c],s=this.data._Ys.length,p=this.data._Zs.length,u=t(a,this.data._Xs).id,i=t(h,this.data._Ys).id,x=t(l,this.data._Zs).id,f=g.index=x+p*i+p*s*u;g.traceCoordinate=[this.data._meshX[f],this.data._meshY[f],this.data._meshZ[f],this.data._value[f]];var _=this.data.hovertext||this.data.text;return Array.isArray(_)&&_[f]!==void 0?g.textLabel=_[f]:_&&(g.textLabel=_),!0}},r.update=function(g){var c=this.scene,a=c.fullSceneLayout;function h(p,u,i,x){return u.map(function(f){return p.d2l(f,0,x)*i})}this.data=n(g);var l={positions:e(h(a.xaxis,g._meshX,c.dataScale[0],g.xcalendar),h(a.yaxis,g._meshY,c.dataScale[1],g.ycalendar),h(a.zaxis,g._meshZ,c.dataScale[2],g.zcalendar)),cells:e(g._meshI,g._meshJ,g._meshK),lightPosition:[g.lightposition.x,g.lightposition.y,g.lightposition.z],ambient:g.lighting.ambient,diffuse:g.lighting.diffuse,specular:g.lighting.specular,roughness:g.lighting.roughness,fresnel:g.lighting.fresnel,vertexNormalsEpsilon:g.lighting.vertexnormalsepsilon,faceNormalsEpsilon:g.lighting.facenormalsepsilon,opacity:g.opacity,opacityscale:g.opacityscale,contourEnable:g.contour.show,contourColor:w(g.contour.color).slice(0,3),contourWidth:g.contour.width,useFacetNormals:g.flatshading},s=y(g);l.vertexIntensity=g._meshIntensity,l.vertexIntensityBounds=[s.min,s.max],l.colormap=v(g),this.mesh.update(l)},r.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},G.exports=function(g,c){var a=g.glplot.gl,h=d({gl:a}),l=new o(g,h,c.uid);return h._trace=l,l.update(c),g.glplot.add(h),l}},{"../../../stackgl_modules":1133,"../../components/colorscale":379,"../../lib/gl_format_color":511,"../../lib/str2rgbarray":540,"../../plots/gl3d/zip3":618,"../isosurface/convert":873}],1113:[function(m,G,Y){var d=m("../../lib"),v=m("./attributes"),w=m("../isosurface/defaults").supplyIsoDefaults,y=m("../surface/defaults").opacityscaleDefaults;G.exports=function(e,t,n,o){function r(g,c){return d.coerce(e,t,v,g,c)}w(e,t,n,o,r),y(e,t,o,r)}},{"../../lib":515,"../isosurface/defaults":874,"../surface/defaults":1073,"./attributes":1111}],1114:[function(m,G,Y){G.exports={attributes:m("./attributes"),supplyDefaults:m("./defaults"),calc:m("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:m("./convert"),moduleType:"trace",name:"volume",basePlotModule:m("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":607,"../isosurface/calc":872,"./attributes":1111,"./convert":1112,"./defaults":1113}],1115:[function(m,G,Y){var d=m("../bar/attributes"),v=m("../scatter/attributes").line,w=m("../../plots/attributes"),y=m("../../plots/cartesian/axis_format_attributes").axisHoverFormat,e=m("../../plots/template_attributes").hovertemplateAttrs,t=m("../../plots/template_attributes").texttemplateAttrs,n=m("./constants"),o=m("../../lib/extend").extendFlat,r=m("../../components/color");function g(c){return{marker:{color:o({},d.marker.color,{arrayOk:!1,editType:"style"}),line:{color:o({},d.marker.line.color,{arrayOk:!1,editType:"style"}),width:o({},d.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}G.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:d.x,x0:d.x0,dx:d.dx,y:d.y,y0:d.y0,dy:d.dy,xperiod:d.xperiod,yperiod:d.yperiod,xperiod0:d.xperiod0,yperiod0:d.yperiod0,xperiodalignment:d.xperiodalignment,yperiodalignment:d.yperiodalignment,xhoverformat:y("x"),yhoverformat:y("y"),hovertext:d.hovertext,hovertemplate:e({},{keys:n.eventDataKeys}),hoverinfo:o({},w.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:t({editType:"plot"},{keys:n.eventDataKeys.concat(["label"])}),text:d.text,textposition:d.textposition,insidetextanchor:d.insidetextanchor,textangle:d.textangle,textfont:d.textfont,insidetextfont:d.insidetextfont,outsidetextfont:d.outsidetextfont,constraintext:d.constraintext,cliponaxis:d.cliponaxis,orientation:d.orientation,offset:d.offset,width:d.width,increasing:g(),decreasing:g(),totals:g(),connector:{line:{color:o({},v.color,{dflt:r.defaultLine}),width:o({},v.width,{editType:"plot"}),dash:v.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:d.offsetgroup,alignmentgroup:d.alignmentgroup}},{"../../components/color":367,"../../lib/extend":505,"../../plots/attributes":562,"../../plots/cartesian/axis_format_attributes":569,"../../plots/template_attributes":642,"../bar/attributes":657,"../scatter/attributes":936,"./constants":1117}],1116:[function(m,G,Y){var d=m("../../plots/cartesian/axes"),v=m("../../plots/cartesian/align_period"),w=m("../../lib").mergeArray,y=m("../scatter/calc_selection"),e=m("../../constants/numerical").BADNUM;function t(o){return o==="a"||o==="absolute"}function n(o){return o==="t"||o==="total"}G.exports=function(o,r){var g,c,a,h,l,s,p=d.getFromId(o,r.xaxis||"x"),u=d.getFromId(o,r.yaxis||"y");r.orientation==="h"?(g=p.makeCalcdata(r,"x"),a=u.makeCalcdata(r,"y"),h=v(r,u,"y",a),l=!!r.yperiodalignment,s="y"):(g=u.makeCalcdata(r,"y"),a=p.makeCalcdata(r,"x"),h=v(r,p,"x",a),l=!!r.xperiodalignment,s="x"),c=h.vals;for(var i,x=Math.min(c.length,g.length),f=new Array(x),_=0,b=!1,T=0;T<x;T++){var k=g[T]||0,L=!1;(g[T]!==e||n(r.measure[T])||t(r.measure[T]))&&T+1<x&&(g[T+1]!==e||n(r.measure[T+1])||t(r.measure[T+1]))&&(L=!0);var A=f[T]={i:T,p:c[T],s:k,rawS:k,cNext:L};t(r.measure[T])?(_=A.s,A.isSum=!0,A.dir="totals",A.s=_):n(r.measure[T])?(A.isSum=!0,A.dir="totals",A.s=_):(A.isSum=!1,A.dir=A.rawS<0?"decreasing":"increasing",i=A.s,A.s=_+i,_+=i),A.dir==="totals"&&(b=!0),l&&(f[T].orig_p=a[T],f[T][s+"End"]=h.ends[T],f[T][s+"Start"]=h.starts[T]),r.ids&&(A.id=String(r.ids[T])),A.v=(r.base||0)+_}return f.length&&(f[0].hasTotals=b),w(r.text,f,"tx"),w(r.hovertext,f,"htx"),y(f,r),f}},{"../../constants/numerical":491,"../../lib":515,"../../plots/cartesian/align_period":563,"../../plots/cartesian/axes":566,"../scatter/calc_selection":938}],1117:[function(m,G,Y){G.exports={eventDataKeys:["initial","delta","final"]}},{}],1118:[function(m,G,Y){var d=m("../bar/cross_trace_calc").setGroupPositions;G.exports=function(v,w){var y,e,t=v._fullLayout,n=v._fullData,o=v.calcdata,r=w.xaxis,g=w.yaxis,c=[],a=[],h=[];for(e=0;e<n.length;e++){var l=n[e];l.visible===!0&&l.xaxis===r._id&&l.yaxis===g._id&&l.type==="waterfall"&&(y=o[e],l.orientation==="h"?h.push(y):a.push(y),c.push(y))}var s={mode:t.waterfallmode,norm:t.waterfallnorm,gap:t.waterfallgap,groupgap:t.waterfallgroupgap};for(d(v,r,g,a,s),d(v,g,r,h,s),e=0;e<c.length;e++){y=c[e];for(var p=0;p<y.length;p++){var u=y[p];u.isSum===!1&&(u.s0+=p===0?0:y[p-1].s),p+1<y.length&&(y[p].nextP0=y[p+1].p0,y[p].nextS0=y[p+1].s0)}}}},{"../bar/cross_trace_calc":660}],1119:[function(m,G,Y){var d=m("../../lib"),v=m("../bar/defaults").handleGroupingDefaults,w=m("../bar/defaults").handleText,y=m("../scatter/xy_defaults"),e=m("../scatter/period_defaults"),t=m("./attributes"),n=m("../../components/color"),o=m("../../constants/delta.js"),r=o.INCREASING.COLOR,g=o.DECREASING.COLOR;function c(a,h,l){a(h+".marker.color",l),a(h+".marker.line.color",n.defaultLine),a(h+".marker.line.width")}G.exports={supplyDefaults:function(a,h,l,s){function p(i,x){return d.coerce(a,h,t,i,x)}if(y(a,h,s,p)){e(a,h,s,p),p("xhoverformat"),p("yhoverformat"),p("measure"),p("orientation",h.x&&!h.y?"h":"v"),p("base"),p("offset"),p("width"),p("text"),p("hovertext"),p("hovertemplate");var u=p("textposition");w(a,h,s,p,u,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),h.textposition!=="none"&&(p("texttemplate"),h.texttemplate||p("textinfo")),c(p,"increasing",r),c(p,"decreasing",g),c(p,"totals","#4499FF"),p("connector.visible")&&(p("connector.mode"),p("connector.line.width")&&(p("connector.line.color"),p("connector.line.dash")))}else h.visible=!1},crossTraceDefaults:function(a,h){var l,s;function p(i){return d.coerce(s._input,s,t,i)}if(h.waterfallmode==="group")for(var u=0;u<a.length;u++)l=(s=a[u])._input,v(l,s,h,p)}}},{"../../components/color":367,"../../constants/delta.js":485,"../../lib":515,"../bar/defaults":661,"../scatter/period_defaults":956,"../scatter/xy_defaults":963,"./attributes":1115}],1120:[function(m,G,Y){G.exports=function(d,v){return d.x="xVal"in v?v.xVal:v.x,d.y="yVal"in v?v.yVal:v.y,"initial"in v&&(d.initial=v.initial),"delta"in v&&(d.delta=v.delta),"final"in v&&(d.final=v.final),v.xa&&(d.xaxis=v.xa),v.ya&&(d.yaxis=v.ya),d}},{}],1121:[function(m,G,Y){var d=m("../../plots/cartesian/axes").hoverLabelText,v=m("../../components/color").opacity,w=m("../bar/hover").hoverOnBars,y=m("../../constants/delta.js"),e=y.INCREASING.SYMBOL,t=y.DECREASING.SYMBOL;G.exports=function(n,o,r,g,c){var a=w(n,o,r,g,c);if(a){var h=a.cd,l=h[0].trace,s=l.orientation==="h",p=s?"x":"y",u=s?n.xa:n.ya,i=h[a.index],x=i.isSum?i.b+i.s:i.rawS;if(!i.isSum){a.initial=i.b+i.s-x,a.delta=x,a.final=a.initial+a.delta;var f=A(Math.abs(a.delta));a.deltaLabel=x<0?"("+f+")":f,a.finalLabel=A(a.final),a.initialLabel=A(a.initial)}var _=i.hi||l.hoverinfo,b=[];if(_&&_!=="none"&&_!=="skip"){var T=_==="all",k=_.split("+"),L=function(I){return T||k.indexOf(I)!==-1};i.isSum||(!L("final")||L(s?"x":"y")||b.push(a.finalLabel),L("delta")&&(x<0?b.push(a.deltaLabel+" "+t):b.push(a.deltaLabel+" "+e)),L("initial")&&b.push("Initial: "+a.initialLabel))}return b.length&&(a.extraText=b.join("<br>")),a.color=function(I,P){var S=I[P.dir].marker,E=S.color,z=S.line.color,D=S.line.width;if(v(E))return E;if(v(z)&&D)return z}(l,i),[a]}function A(I){return d(u,I,l[p+"hoverformat"])}}},{"../../components/color":367,"../../constants/delta.js":485,"../../plots/cartesian/axes":566,"../bar/hover":664}],1122:[function(m,G,Y){G.exports={attributes:m("./attributes"),layoutAttributes:m("./layout_attributes"),supplyDefaults:m("./defaults").supplyDefaults,crossTraceDefaults:m("./defaults").crossTraceDefaults,supplyLayoutDefaults:m("./layout_defaults"),calc:m("./calc"),crossTraceCalc:m("./cross_trace_calc"),plot:m("./plot"),style:m("./style").style,hoverPoints:m("./hover"),eventData:m("./event_data"),selectPoints:m("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:m("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":578,"../bar/select":669,"./attributes":1115,"./calc":1116,"./cross_trace_calc":1118,"./defaults":1119,"./event_data":1120,"./hover":1121,"./layout_attributes":1123,"./layout_defaults":1124,"./plot":1125,"./style":1126}],1123:[function(m,G,Y){G.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1124:[function(m,G,Y){var d=m("../../lib"),v=m("./layout_attributes");G.exports=function(w,y,e){var t=!1;function n(g,c){return d.coerce(w,y,v,g,c)}for(var o=0;o<e.length;o++){var r=e[o];if(r.visible&&r.type==="waterfall"){t=!0;break}}t&&(n("waterfallmode"),n("waterfallgap",.2),n("waterfallgroupgap"))}},{"../../lib":515,"./layout_attributes":1123}],1125:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../lib"),w=m("../../components/drawing"),y=m("../../constants/numerical").BADNUM,e=m("../bar/plot"),t=m("../bar/uniform_text").clearMinTextSize;G.exports=function(n,o,r,g){var c=n._fullLayout;t("waterfall",c),e.plot(n,o,r,g,{mode:c.waterfallmode,norm:c.waterfallmode,gap:c.waterfallgap,groupgap:c.waterfallgroupgap}),function(a,h,l,s){var p=h.xaxis,u=h.yaxis;v.makeTraceGroups(s,l,"trace bars").each(function(i){var x=d.select(this),f=i[0].trace,_=v.ensureSingle(x,"g","lines");if(f.connector&&f.connector.visible){var b=f.orientation==="h",T=f.connector.mode,k=_.selectAll("g.line").data(v.identity);k.enter().append("g").classed("line",!0),k.exit().remove();var L=k.size();k.each(function(A,I){if(I===L-1||A.cNext){var P=function(D,j,V,Z){var Q=[],X=[],$=Z?j:V,re=Z?V:j;return Q[0]=$.c2p(D.s0,!0),X[0]=re.c2p(D.p0,!0),Q[1]=$.c2p(D.s1,!0),X[1]=re.c2p(D.p1,!0),Q[2]=$.c2p(D.nextS0,!0),X[2]=re.c2p(D.nextP0,!0),Z?[Q,X]:[X,Q]}(A,p,u,b),S=P[0],E=P[1],z="";S[0]!==y&&E[0]!==y&&S[1]!==y&&E[1]!==y&&(T==="spanning"&&!A.isSum&&I>0&&(z+=b?"M"+S[0]+","+E[1]+"V"+E[0]:"M"+S[1]+","+E[0]+"H"+S[0]),T!=="between"&&(A.isSum||I<L-1)&&(z+=b?"M"+S[1]+","+E[0]+"V"+E[1]:"M"+S[0]+","+E[1]+"H"+S[1]),S[2]!==y&&E[2]!==y&&(z+=b?"M"+S[1]+","+E[1]+"V"+E[2]:"M"+S[1]+","+E[1]+"H"+S[2])),z===""&&(z="M0,0Z"),v.ensureSingle(d.select(this),"path").attr("d",z).call(w.setClipUrl,h.layerClipId,a)}})}else _.remove()})}(n,o,r,g)}},{"../../components/drawing":389,"../../constants/numerical":491,"../../lib":515,"../bar/plot":668,"../bar/uniform_text":673,"@plotly/d3":58}],1126:[function(m,G,Y){var d=m("@plotly/d3"),v=m("../../components/drawing"),w=m("../../components/color"),y=m("../../constants/interactions").DESELECTDIM,e=m("../bar/style"),t=m("../bar/uniform_text").resizeText,n=e.styleTextPoints;G.exports={style:function(o,r,g){var c=g||d.select(o).selectAll("g.waterfalllayer").selectAll("g.trace");t(o,c,"waterfall"),c.style("opacity",function(a){return a[0].trace.opacity}),c.each(function(a){var h=d.select(this),l=a[0].trace;h.selectAll(".point > path").each(function(s){if(!s.isBlank){var p=l[s.dir].marker;d.select(this).call(w.fill,p.color).call(w.stroke,p.line.color).call(v.dashLine,p.line.dash,p.line.width).style("opacity",l.selectedpoints&&!s.selected?y:1)}}),n(h,l,o),h.selectAll(".lines").each(function(){var s=l.connector.line;v.lineGroupStyle(d.select(this).selectAll("path"),s.width,s.color,s.dash)})})}}},{"../../components/color":367,"../../components/drawing":389,"../../constants/interactions":490,"../bar/style":671,"../bar/uniform_text":673,"@plotly/d3":58}],1127:[function(m,G,Y){var d=m("../plots/cartesian/axes"),v=m("../lib"),w=m("../plot_api/plot_schema"),y=m("./helpers").pointsAccessorFunction,e=m("../constants/numerical").BADNUM;Y.moduleType="transform",Y.name="aggregate";var t=Y.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},n=t.aggregations;function o(a,h,l,s){if(s.enabled){for(var p=s.target,u=v.nestedProperty(h,p),i=u.get(),x=function(b,T){var k=b.func,L=T.d2c,A=T.c2d;switch(k){case"count":return r;case"first":return g;case"last":return c;case"sum":return function(I,P){for(var S=0,E=0;E<P.length;E++){var z=L(I[P[E]]);z!==e&&(S+=z)}return A(S)};case"avg":return function(I,P){for(var S=0,E=0,z=0;z<P.length;z++){var D=L(I[P[z]]);D!==e&&(S+=D,E++)}return E?A(S/E):e};case"min":return function(I,P){for(var S=1/0,E=0;E<P.length;E++){var z=L(I[P[E]]);z!==e&&(S=Math.min(S,z))}return S===1/0?e:A(S)};case"max":return function(I,P){for(var S=-1/0,E=0;E<P.length;E++){var z=L(I[P[E]]);z!==e&&(S=Math.max(S,z))}return S===-1/0?e:A(S)};case"range":return function(I,P){for(var S=1/0,E=-1/0,z=0;z<P.length;z++){var D=L(I[P[z]]);D!==e&&(S=Math.min(S,D),E=Math.max(E,D))}return E===-1/0||S===1/0?e:A(E-S)};case"change":return function(I,P){var S=L(I[P[0]]),E=L(I[P[P.length-1]]);return S===e||E===e?e:A(E-S)};case"median":return function(I,P){for(var S=[],E=0;E<P.length;E++){var z=L(I[P[E]]);z!==e&&S.push(z)}if(!S.length)return e;S.sort(v.sorterAsc);var D=(S.length-1)/2;return A((S[Math.floor(D)]+S[Math.ceil(D)])/2)};case"mode":return function(I,P){for(var S={},E=0,z=e,D=0;D<P.length;D++){var j=L(I[P[D]]);if(j!==e){var V=S[j]=(S[j]||0)+1;V>E&&(E=V,z=j)}}return E?A(z):e};case"rms":return function(I,P){for(var S=0,E=0,z=0;z<P.length;z++){var D=L(I[P[z]]);D!==e&&(S+=D*D,E++)}return E?A(Math.sqrt(S/E)):e};case"stddev":return function(I,P){var S,E=0,z=0,D=1,j=e;for(S=0;S<P.length&&j===e;S++)j=L(I[P[S]]);if(j===e)return e;for(;S<P.length;S++){var V=L(I[P[S]]);if(V!==e){var Z=V-j;E+=Z,z+=Z*Z,D++}}var Q=b.funcmode==="sample"?D-1:D;return Q?Math.sqrt((z-E*E/D)/Q):0}}}(s,d.getDataConversions(a,h,p,i)),f=new Array(l.length),_=0;_<l.length;_++)f[_]=x(i,l[_]);u.set(f),s.func==="count"&&v.pushUnique(h._arrayAttrs,p)}}function r(a,h){return h.length}function g(a,h){return a[h[0]]}function c(a,h){return a[h[h.length-1]]}Y.supplyDefaults=function(a,h){var l,s={};function p(A,I){return v.coerce(a,s,t,A,I)}if(!p("enabled"))return s;var u=w.findArrayAttributes(h),i={};for(l=0;l<u.length;l++)i[u[l]]=1;var x=p("groups");if(!Array.isArray(x)){if(!i[x])return s.enabled=!1,s;i[x]=0}var f,_=a.aggregations||[],b=s.aggregations=new Array(_.length);function T(A,I){return v.coerce(_[l],f,n,A,I)}for(l=0;l<_.length;l++){f={_index:l};var k=T("target"),L=T("func");T("enabled")&&k&&(i[k]||L==="count"&&i[k]===void 0)?(L==="stddev"&&T("funcmode"),i[k]=0,b[l]=f):b[l]={enabled:!1,_index:l}}for(l=0;l<u.length;l++)i[u[l]]&&b.push({target:u[l],func:n.func.dflt,enabled:!0,_index:-1});return s},Y.calcTransform=function(a,h,l){if(l.enabled){var s=l.groups,p=v.getTargetArray(h,{target:s});if(p){var u,i,x,f,_={},b={},T=[],k=y(h.transforms,l),L=p.length;for(h._length&&(L=Math.min(L,h._length)),u=0;u<L;u++)(x=_[i=p[u]])===void 0?(_[i]=T.length,f=[u],T.push(f),b[_[i]]=k(u)):(T[x].push(u),b[_[i]]=(b[_[i]]||[]).concat(k(u)));l._indexToPoints=b;var A=l.aggregations;for(u=0;u<A.length;u++)o(a,h,T,A[u]);typeof s=="string"&&o(a,h,T,{target:s,func:"first",enabled:!0}),h._length=T.length}}}},{"../constants/numerical":491,"../lib":515,"../plot_api/plot_schema":554,"../plots/cartesian/axes":566,"./helpers":1130}],1128:[function(m,G,Y){var d=m("../lib"),v=m("../registry"),w=m("../plots/cartesian/axes"),y=m("./helpers").pointsAccessorFunction,e=m("../constants/filter_ops"),t=e.COMPARISON_OPS,n=e.INTERVAL_OPS,o=e.SET_OPS;Y.moduleType="transform",Y.name="filter",Y.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(t).concat(n).concat(o),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},Y.supplyDefaults=function(r){var g={};function c(l,s){return d.coerce(r,g,Y.attributes,l,s)}if(c("enabled")){var a=c("target");if(d.isArrayOrTypedArray(a)&&a.length===0)return g.enabled=!1,g;c("preservegaps"),c("operation"),c("value");var h=v.getComponentMethod("calendars","handleDefaults");h(r,g,"valuecalendar",null),h(r,g,"targetcalendar",null)}return g},Y.calcTransform=function(r,g,c){if(c.enabled){var a=d.getTargetArray(g,c);if(a){var h=c.target,l=a.length;g._length&&(l=Math.min(l,g._length));var s=c.targetcalendar,p=g._arrayAttrs,u=c.preservegaps;if(typeof h=="string"){var i=d.nestedProperty(g,h+"calendar").get();i&&(s=i)}var x,f,_=function(P,S,E){var z=P.operation,D=P.value,j=Array.isArray(D);function V($){return $.indexOf(z)!==-1}var Z,Q=function($){return S($,0,P.valuecalendar)},X=function($){return S($,0,E)};switch(V(t)?Z=Q(j?D[0]:D):V(n)?Z=j?[Q(D[0]),Q(D[1])]:[Q(D),Q(D)]:V(o)&&(Z=j?D.map(Q):[Q(D)]),z){case"=":return function($){return X($)===Z};case"!=":return function($){return X($)!==Z};case"<":return function($){return X($)<Z};case"<=":return function($){return X($)<=Z};case">":return function($){return X($)>Z};case">=":return function($){return X($)>=Z};case"[]":return function($){var re=X($);return re>=Z[0]&&re<=Z[1]};case"()":return function($){var re=X($);return re>Z[0]&&re<Z[1]};case"[)":return function($){var re=X($);return re>=Z[0]&&re<Z[1]};case"(]":return function($){var re=X($);return re>Z[0]&&re<=Z[1]};case"][":return function($){var re=X($);return re<=Z[0]||re>=Z[1]};case")(":return function($){var re=X($);return re<Z[0]||re>Z[1]};case"](":return function($){var re=X($);return re<=Z[0]||re>Z[1]};case")[":return function($){var re=X($);return re<Z[0]||re>=Z[1]};case"{}":return function($){return Z.indexOf(X($))!==-1};case"}{":return function($){return Z.indexOf(X($))===-1}}}(c,w.getDataToCoordFunc(r,g,h,a),s),b={},T={},k=0;u?(x=function(P){b[P.astr]=d.extendDeep([],P.get()),P.set(new Array(l))},f=function(P,S){var E=b[P.astr][S];P.get()[S]=E}):(x=function(P){b[P.astr]=d.extendDeep([],P.get()),P.set([])},f=function(P,S){var E=b[P.astr][S];P.get().push(E)}),I(x);for(var L=y(g.transforms,c),A=0;A<l;A++)_(a[A])?(I(f,A),T[k++]=L(A)):u&&k++;c._indexToPoints=T,g._length=k}}function I(P,S){for(var E=0;E<p.length;E++)P(d.nestedProperty(g,p[E]),S)}}},{"../constants/filter_ops":487,"../lib":515,"../plots/cartesian/axes":566,"../registry":647,"./helpers":1130}],1129:[function(m,G,Y){var d=m("../lib"),v=m("../plot_api/plot_schema"),w=m("../plots/plots"),y=m("./helpers").pointsAccessorFunction;function e(t,n){var o,r,g,c,a,h,l,s,p,u,i=n.transform,x=n.transformIndex,f=t.transforms[x].groups,_=y(t.transforms,i);if(!d.isArrayOrTypedArray(f)||f.length===0)return[t];var b=d.filterUnique(f),T=new Array(b.length),k=f.length,L=v.findArrayAttributes(t),A=i.styles||[],I={};for(o=0;o<A.length;o++)I[A[o].target]=A[o].value;i.styles&&(u=d.keyedContainer(i,"styles","target","value.name"));var P={},S={};for(o=0;o<b.length;o++){P[h=b[o]]=o,S[h]=0,(l=T[o]=d.extendDeepNoArrays({},t))._group=h,l.transforms[x]._indexToPoints={};var E=null;for(u&&(E=u.get(h)),l.name=E||E===""?E:d.templateString(i.nameformat,{trace:t.name,group:h}),s=l.transforms,l.transforms=[],r=0;r<s.length;r++)l.transforms[r]=d.extendDeepNoArrays({},s[r]);for(r=0;r<L.length;r++)d.nestedProperty(l,L[r]).set([])}for(g=0;g<L.length;g++){for(c=L[g],r=0,p=[];r<b.length;r++)p[r]=d.nestedProperty(T[r],c).get();for(a=d.nestedProperty(t,c).get(),r=0;r<k;r++)p[P[f[r]]].push(a[r])}for(r=0;r<k;r++)(l=T[P[f[r]]]).transforms[x]._indexToPoints[S[f[r]]]=_(r),S[f[r]]++;for(o=0;o<b.length;o++)h=b[o],l=T[o],w.clearExpandedTraceDefaultColors(l),l=d.extendDeepNoArrays(l,I[h]||{});return T}Y.moduleType="transform",Y.name="groupby",Y.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},Y.supplyDefaults=function(t,n,o){var r,g={};function c(p,u){return d.coerce(t,g,Y.attributes,p,u)}if(!c("enabled"))return g;c("groups"),c("nameformat",o._dataLength>1?"%{group} (%{trace})":"%{group}");var a=t.styles,h=g.styles=[];if(a)for(r=0;r<a.length;r++){var l=h[r]={};d.coerce(a[r],h[r],Y.attributes.styles,"target");var s=d.coerce(a[r],h[r],Y.attributes.styles,"value");d.isPlainObject(s)?l.value=d.extendDeep({},s):s&&delete l.value}return g},Y.transform=function(t,n){var o,r,g,c=[];for(r=0;r<t.length;r++)for(o=e(t[r],n),g=0;g<o.length;g++)c.push(o[g]);return c}},{"../lib":515,"../plot_api/plot_schema":554,"../plots/plots":628,"./helpers":1130}],1130:[function(m,G,Y){Y.pointsAccessorFunction=function(d,v){for(var w,y,e=0;e<d.length&&(w=d[e])!==v;e++)w._indexToPoints&&w.enabled!==!1&&(y=w._indexToPoints);return y?function(t){return y[t]}:function(t){return[t]}}},{}],1131:[function(m,G,Y){var d=m("../lib"),v=m("../plots/cartesian/axes"),w=m("./helpers").pointsAccessorFunction,y=m("../constants/numerical").BADNUM;Y.moduleType="transform",Y.name="sort",Y.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},Y.supplyDefaults=function(e){var t={};function n(o,r){return d.coerce(e,t,Y.attributes,o,r)}return n("enabled")&&(n("target"),n("order")),t},Y.calcTransform=function(e,t,n){if(n.enabled){var o=d.getTargetArray(t,n);if(o){var r=n.target,g=o.length;t._length&&(g=Math.min(g,t._length));var c,a,h=t._arrayAttrs,l=function(f,_,b,T){var k,L=new Array(T),A=new Array(T);for(k=0;k<T;k++)L[k]={v:_[k],i:k};for(L.sort(function(I,P){switch(I.order){case"ascending":return function(S,E){var z=P(S.v),D=P(E.v);return z===y?1:D===y?-1:z-D};case"descending":return function(S,E){var z=P(S.v),D=P(E.v);return z===y?1:D===y?-1:D-z}}}(f,b)),k=0;k<T;k++)A[k]=L[k].i;return A}(n,o,v.getDataToCoordFunc(e,t,r,o),g),s=w(t.transforms,n),p={};for(c=0;c<h.length;c++){var u=d.nestedProperty(t,h[c]),i=u.get(),x=new Array(g);for(a=0;a<g;a++)x[a]=i[l[a]];u.set(x)}for(a=0;a<g;a++)p[a]=s(l[a]);n._indexToPoints=p,t._length=g}}}},{"../constants/numerical":491,"../lib":515,"../plots/cartesian/axes":566,"./helpers":1130}],1132:[function(m,G,Y){Y.version="2.16.1"},{}],1133:[function(m,G,Y){(function(d){(function(){(function(v){typeof Y=="object"&&G!==void 0?G.exports=v():(typeof window<"u"?window:d!==void 0?d:typeof self<"u"?self:this).stackgl=v()})(function(){return function v(w,y,e){function t(r,g){if(!y[r]){if(!w[r]){var c=typeof m=="function"&&m;if(!g&&c)return c(r,!0);if(n)return n(r,!0);var a=new Error("Cannot find module '"+r+"'");throw a.code="MODULE_NOT_FOUND",a}var h=y[r]={exports:{}};w[r][0].call(h.exports,function(l){return t(w[r][1][l]||l)},h,h.exports,v,w,y,e)}return y[r].exports}for(var n=typeof m=="function"&&m,o=0;o<e.length;o++)t(e[o]);return t}({1:[function(v,w,y){y.byteLength=function(h){var l=c(h),s=l[0],p=l[1];return 3*(s+p)/4-p},y.toByteArray=function(h){var l,s,p=c(h),u=p[0],i=p[1],x=new n(function(b,T,k){return 3*(T+k)/4-k}(0,u,i)),f=0,_=i>0?u-4:u;for(s=0;s<_;s+=4)l=t[h.charCodeAt(s)]<<18|t[h.charCodeAt(s+1)]<<12|t[h.charCodeAt(s+2)]<<6|t[h.charCodeAt(s+3)],x[f++]=l>>16&255,x[f++]=l>>8&255,x[f++]=255&l;return i===2&&(l=t[h.charCodeAt(s)]<<2|t[h.charCodeAt(s+1)]>>4,x[f++]=255&l),i===1&&(l=t[h.charCodeAt(s)]<<10|t[h.charCodeAt(s+1)]<<4|t[h.charCodeAt(s+2)]>>2,x[f++]=l>>8&255,x[f++]=255&l),x},y.fromByteArray=function(h){for(var l,s=h.length,p=s%3,u=[],i=0,x=s-p;i<x;i+=16383)u.push(a(h,i,i+16383>x?x:i+16383));return p===1?(l=h[s-1],u.push(e[l>>2]+e[l<<4&63]+"==")):p===2&&(l=(h[s-2]<<8)+h[s-1],u.push(e[l>>10]+e[l>>4&63]+e[l<<2&63]+"=")),u.join("")};for(var e=[],t=[],n=typeof Uint8Array<"u"?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0,g=o.length;r<g;++r)e[r]=o[r],t[o.charCodeAt(r)]=r;function c(h){var l=h.length;if(l%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var s=h.indexOf("=");return s===-1&&(s=l),[s,s===l?0:4-s%4]}function a(h,l,s){for(var p,u,i=[],x=l;x<s;x+=3)p=(h[x]<<16&16711680)+(h[x+1]<<8&65280)+(255&h[x+2]),i.push(e[(u=p)>>18&63]+e[u>>12&63]+e[u>>6&63]+e[63&u]);return i.join("")}t["-".charCodeAt(0)]=62,t["_".charCodeAt(0)]=63},{}],2:[function(v,w,y){},{}],3:[function(v,w,y){(function(e){(function(){var t=v("base64-js"),n=v("ieee754");y.Buffer=r,y.SlowBuffer=function(B){return+B!=B&&(B=0),r.alloc(+B)},y.INSPECT_MAX_BYTES=50;function o(B){if(B>2147483647)throw new RangeError('The value "'+B+'" is invalid for option "size"');var K=new Uint8Array(B);return K.__proto__=r.prototype,K}function r(B,K,J){if(typeof B=="number"){if(typeof K=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return a(B)}return g(B,K,J)}function g(B,K,J){if(typeof B=="string")return function(se,oe){if(typeof oe=="string"&&oe!==""||(oe="utf8"),!r.isEncoding(oe))throw new TypeError("Unknown encoding: "+oe);var me=0|s(se,oe),ce=o(me),ye=ce.write(se,oe);return ye!==me&&(ce=ce.slice(0,ye)),ce}(B,K);if(ArrayBuffer.isView(B))return h(B);if(B==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B);if(U(B,ArrayBuffer)||B&&U(B.buffer,ArrayBuffer))return function(se,oe,me){if(oe<0||se.byteLength<oe)throw new RangeError('"offset" is outside of buffer bounds');if(se.byteLength<oe+(me||0))throw new RangeError('"length" is outside of buffer bounds');var ce;return ce=oe===void 0&&me===void 0?new Uint8Array(se):me===void 0?new Uint8Array(se,oe):new Uint8Array(se,oe,me),ce.__proto__=r.prototype,ce}(B,K,J);if(typeof B=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ee=B.valueOf&&B.valueOf();if(ee!=null&&ee!==B)return r.from(ee,K,J);var ne=function(se){if(r.isBuffer(se)){var oe=0|l(se.length),me=o(oe);return me.length===0||se.copy(me,0,0,oe),me}if(se.length!==void 0)return typeof se.length!="number"||te(se.length)?o(0):h(se);if(se.type==="Buffer"&&Array.isArray(se.data))return h(se.data)}(B);if(ne)return ne;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof B[Symbol.toPrimitive]=="function")return r.from(B[Symbol.toPrimitive]("string"),K,J);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B)}function c(B){if(typeof B!="number")throw new TypeError('"size" argument must be of type number');if(B<0)throw new RangeError('The value "'+B+'" is invalid for option "size"')}function a(B){return c(B),o(B<0?0:0|l(B))}function h(B){for(var K=B.length<0?0:0|l(B.length),J=o(K),ee=0;ee<K;ee+=1)J[ee]=255&B[ee];return J}function l(B){if(B>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|B}function s(B,K){if(r.isBuffer(B))return B.length;if(ArrayBuffer.isView(B)||U(B,ArrayBuffer))return B.byteLength;if(typeof B!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof B);var J=B.length,ee=arguments.length>2&&arguments[2]===!0;if(!ee&&J===0)return 0;for(var ne=!1;;)switch(K){case"ascii":case"latin1":case"binary":return J;case"utf8":case"utf-8":return re(B).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*J;case"hex":return J>>>1;case"base64":return H(B).length;default:if(ne)return ee?-1:re(B).length;K=(""+K).toLowerCase(),ne=!0}}function p(B,K,J){var ee=!1;if((K===void 0||K<0)&&(K=0),K>this.length||((J===void 0||J>this.length)&&(J=this.length),J<=0)||(J>>>=0)<=(K>>>=0))return"";for(B||(B="utf8");;)switch(B){case"hex":return E(this,K,J);case"utf8":case"utf-8":return I(this,K,J);case"ascii":return P(this,K,J);case"latin1":case"binary":return S(this,K,J);case"base64":return A(this,K,J);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,K,J);default:if(ee)throw new TypeError("Unknown encoding: "+B);B=(B+"").toLowerCase(),ee=!0}}function u(B,K,J){var ee=B[K];B[K]=B[J],B[J]=ee}function i(B,K,J,ee,ne){if(B.length===0)return-1;if(typeof J=="string"?(ee=J,J=0):J>2147483647?J=2147483647:J<-2147483648&&(J=-2147483648),te(J=+J)&&(J=ne?0:B.length-1),J<0&&(J=B.length+J),J>=B.length){if(ne)return-1;J=B.length-1}else if(J<0){if(!ne)return-1;J=0}if(typeof K=="string"&&(K=r.from(K,ee)),r.isBuffer(K))return K.length===0?-1:x(B,K,J,ee,ne);if(typeof K=="number")return K&=255,typeof Uint8Array.prototype.indexOf=="function"?ne?Uint8Array.prototype.indexOf.call(B,K,J):Uint8Array.prototype.lastIndexOf.call(B,K,J):x(B,[K],J,ee,ne);throw new TypeError("val must be string, number or Buffer")}function x(B,K,J,ee,ne){var se,oe=1,me=B.length,ce=K.length;if(ee!==void 0&&((ee=String(ee).toLowerCase())==="ucs2"||ee==="ucs-2"||ee==="utf16le"||ee==="utf-16le")){if(B.length<2||K.length<2)return-1;oe=2,me/=2,ce/=2,J/=2}function ye(Te,le){return oe===1?Te[le]:Te.readUInt16BE(le*oe)}if(ne){var Se=-1;for(se=J;se<me;se++)if(ye(B,se)===ye(K,Se===-1?0:se-Se)){if(Se===-1&&(Se=se),se-Se+1===ce)return Se*oe}else Se!==-1&&(se-=se-Se),Se=-1}else for(J+ce>me&&(J=me-ce),se=J;se>=0;se--){for(var fe=!0,ge=0;ge<ce;ge++)if(ye(B,se+ge)!==ye(K,ge)){fe=!1;break}if(fe)return se}return-1}function f(B,K,J,ee){J=Number(J)||0;var ne=B.length-J;ee?(ee=Number(ee))>ne&&(ee=ne):ee=ne;var se=K.length;ee>se/2&&(ee=se/2);for(var oe=0;oe<ee;++oe){var me=parseInt(K.substr(2*oe,2),16);if(te(me))return oe;B[J+oe]=me}return oe}function _(B,K,J,ee){return N(re(K,B.length-J),B,J,ee)}function b(B,K,J,ee){return N(function(ne){for(var se=[],oe=0;oe<ne.length;++oe)se.push(255&ne.charCodeAt(oe));return se}(K),B,J,ee)}function T(B,K,J,ee){return b(B,K,J,ee)}function k(B,K,J,ee){return N(H(K),B,J,ee)}function L(B,K,J,ee){return N(function(ne,se){for(var oe,me,ce,ye=[],Se=0;Se<ne.length&&!((se-=2)<0);++Se)oe=ne.charCodeAt(Se),me=oe>>8,ce=oe%256,ye.push(ce),ye.push(me);return ye}(K,B.length-J),B,J,ee)}function A(B,K,J){return K===0&&J===B.length?t.fromByteArray(B):t.fromByteArray(B.slice(K,J))}function I(B,K,J){J=Math.min(B.length,J);for(var ee=[],ne=K;ne<J;){var se,oe,me,ce,ye=B[ne],Se=null,fe=ye>239?4:ye>223?3:ye>191?2:1;if(ne+fe<=J)switch(fe){case 1:ye<128&&(Se=ye);break;case 2:(192&(se=B[ne+1]))==128&&(ce=(31&ye)<<6|63&se)>127&&(Se=ce);break;case 3:se=B[ne+1],oe=B[ne+2],(192&se)==128&&(192&oe)==128&&(ce=(15&ye)<<12|(63&se)<<6|63&oe)>2047&&(ce<55296||ce>57343)&&(Se=ce);break;case 4:se=B[ne+1],oe=B[ne+2],me=B[ne+3],(192&se)==128&&(192&oe)==128&&(192&me)==128&&(ce=(15&ye)<<18|(63&se)<<12|(63&oe)<<6|63&me)>65535&&ce<1114112&&(Se=ce)}Se===null?(Se=65533,fe=1):Se>65535&&(Se-=65536,ee.push(Se>>>10&1023|55296),Se=56320|1023&Se),ee.push(Se),ne+=fe}return function(ge){var Te=ge.length;if(Te<=4096)return String.fromCharCode.apply(String,ge);for(var le="",ve=0;ve<Te;)le+=String.fromCharCode.apply(String,ge.slice(ve,ve+=4096));return le}(ee)}y.kMaxLength=2147483647,r.TYPED_ARRAY_SUPPORT=function(){try{var B=new Uint8Array(1);return B.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},B.foo()===42}catch{return!1}}(),r.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(r.prototype,"parent",{enumerable:!0,get:function(){if(r.isBuffer(this))return this.buffer}}),Object.defineProperty(r.prototype,"offset",{enumerable:!0,get:function(){if(r.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&r[Symbol.species]===r&&Object.defineProperty(r,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),r.poolSize=8192,r.from=function(B,K,J){return g(B,K,J)},r.prototype.__proto__=Uint8Array.prototype,r.__proto__=Uint8Array,r.alloc=function(B,K,J){return function(ee,ne,se){return c(ee),ee<=0?o(ee):ne!==void 0?typeof se=="string"?o(ee).fill(ne,se):o(ee).fill(ne):o(ee)}(B,K,J)},r.allocUnsafe=function(B){return a(B)},r.allocUnsafeSlow=function(B){return a(B)},r.isBuffer=function(B){return B!=null&&B._isBuffer===!0&&B!==r.prototype},r.compare=function(B,K){if(U(B,Uint8Array)&&(B=r.from(B,B.offset,B.byteLength)),U(K,Uint8Array)&&(K=r.from(K,K.offset,K.byteLength)),!r.isBuffer(B)||!r.isBuffer(K))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(B===K)return 0;for(var J=B.length,ee=K.length,ne=0,se=Math.min(J,ee);ne<se;++ne)if(B[ne]!==K[ne]){J=B[ne],ee=K[ne];break}return J<ee?-1:ee<J?1:0},r.isEncoding=function(B){switch(String(B).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(B,K){if(!Array.isArray(B))throw new TypeError('"list" argument must be an Array of Buffers');if(B.length===0)return r.alloc(0);var J;if(K===void 0)for(K=0,J=0;J<B.length;++J)K+=B[J].length;var ee=r.allocUnsafe(K),ne=0;for(J=0;J<B.length;++J){var se=B[J];if(U(se,Uint8Array)&&(se=r.from(se)),!r.isBuffer(se))throw new TypeError('"list" argument must be an Array of Buffers');se.copy(ee,ne),ne+=se.length}return ee},r.byteLength=s,r.prototype._isBuffer=!0,r.prototype.swap16=function(){var B=this.length;if(B%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var K=0;K<B;K+=2)u(this,K,K+1);return this},r.prototype.swap32=function(){var B=this.length;if(B%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var K=0;K<B;K+=4)u(this,K,K+3),u(this,K+1,K+2);return this},r.prototype.swap64=function(){var B=this.length;if(B%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var K=0;K<B;K+=8)u(this,K,K+7),u(this,K+1,K+6),u(this,K+2,K+5),u(this,K+3,K+4);return this},r.prototype.toString=function(){var B=this.length;return B===0?"":arguments.length===0?I(this,0,B):p.apply(this,arguments)},r.prototype.toLocaleString=r.prototype.toString,r.prototype.equals=function(B){if(!r.isBuffer(B))throw new TypeError("Argument must be a Buffer");return this===B||r.compare(this,B)===0},r.prototype.inspect=function(){var B="",K=y.INSPECT_MAX_BYTES;return B=this.toString("hex",0,K).replace(/(.{2})/g,"$1 ").trim(),this.length>K&&(B+=" ... "),"<Buffer "+B+">"},r.prototype.compare=function(B,K,J,ee,ne){if(U(B,Uint8Array)&&(B=r.from(B,B.offset,B.byteLength)),!r.isBuffer(B))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof B);if(K===void 0&&(K=0),J===void 0&&(J=B?B.length:0),ee===void 0&&(ee=0),ne===void 0&&(ne=this.length),K<0||J>B.length||ee<0||ne>this.length)throw new RangeError("out of range index");if(ee>=ne&&K>=J)return 0;if(ee>=ne)return-1;if(K>=J)return 1;if(this===B)return 0;for(var se=(ne>>>=0)-(ee>>>=0),oe=(J>>>=0)-(K>>>=0),me=Math.min(se,oe),ce=this.slice(ee,ne),ye=B.slice(K,J),Se=0;Se<me;++Se)if(ce[Se]!==ye[Se]){se=ce[Se],oe=ye[Se];break}return se<oe?-1:oe<se?1:0},r.prototype.includes=function(B,K,J){return this.indexOf(B,K,J)!==-1},r.prototype.indexOf=function(B,K,J){return i(this,B,K,J,!0)},r.prototype.lastIndexOf=function(B,K,J){return i(this,B,K,J,!1)},r.prototype.write=function(B,K,J,ee){if(K===void 0)ee="utf8",J=this.length,K=0;else if(J===void 0&&typeof K=="string")ee=K,J=this.length,K=0;else{if(!isFinite(K))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");K>>>=0,isFinite(J)?(J>>>=0,ee===void 0&&(ee="utf8")):(ee=J,J=void 0)}var ne=this.length-K;if((J===void 0||J>ne)&&(J=ne),B.length>0&&(J<0||K<0)||K>this.length)throw new RangeError("Attempt to write outside buffer bounds");ee||(ee="utf8");for(var se=!1;;)switch(ee){case"hex":return f(this,B,K,J);case"utf8":case"utf-8":return _(this,B,K,J);case"ascii":return b(this,B,K,J);case"latin1":case"binary":return T(this,B,K,J);case"base64":return k(this,B,K,J);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,B,K,J);default:if(se)throw new TypeError("Unknown encoding: "+ee);ee=(""+ee).toLowerCase(),se=!0}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function P(B,K,J){var ee="";J=Math.min(B.length,J);for(var ne=K;ne<J;++ne)ee+=String.fromCharCode(127&B[ne]);return ee}function S(B,K,J){var ee="";J=Math.min(B.length,J);for(var ne=K;ne<J;++ne)ee+=String.fromCharCode(B[ne]);return ee}function E(B,K,J){var ee=B.length;(!K||K<0)&&(K=0),(!J||J<0||J>ee)&&(J=ee);for(var ne="",se=K;se<J;++se)ne+=$(B[se]);return ne}function z(B,K,J){for(var ee=B.slice(K,J),ne="",se=0;se<ee.length;se+=2)ne+=String.fromCharCode(ee[se]+256*ee[se+1]);return ne}function D(B,K,J){if(B%1!=0||B<0)throw new RangeError("offset is not uint");if(B+K>J)throw new RangeError("Trying to access beyond buffer length")}function j(B,K,J,ee,ne,se){if(!r.isBuffer(B))throw new TypeError('"buffer" argument must be a Buffer instance');if(K>ne||K<se)throw new RangeError('"value" argument is out of bounds');if(J+ee>B.length)throw new RangeError("Index out of range")}function V(B,K,J,ee,ne,se){if(J+ee>B.length)throw new RangeError("Index out of range");if(J<0)throw new RangeError("Index out of range")}function Z(B,K,J,ee,ne){return K=+K,J>>>=0,ne||V(B,0,J,4),n.write(B,K,J,ee,23,4),J+4}function Q(B,K,J,ee,ne){return K=+K,J>>>=0,ne||V(B,0,J,8),n.write(B,K,J,ee,52,8),J+8}r.prototype.slice=function(B,K){var J=this.length;(B=~~B)<0?(B+=J)<0&&(B=0):B>J&&(B=J),(K=K===void 0?J:~~K)<0?(K+=J)<0&&(K=0):K>J&&(K=J),K<B&&(K=B);var ee=this.subarray(B,K);return ee.__proto__=r.prototype,ee},r.prototype.readUIntLE=function(B,K,J){B>>>=0,K>>>=0,J||D(B,K,this.length);for(var ee=this[B],ne=1,se=0;++se<K&&(ne*=256);)ee+=this[B+se]*ne;return ee},r.prototype.readUIntBE=function(B,K,J){B>>>=0,K>>>=0,J||D(B,K,this.length);for(var ee=this[B+--K],ne=1;K>0&&(ne*=256);)ee+=this[B+--K]*ne;return ee},r.prototype.readUInt8=function(B,K){return B>>>=0,K||D(B,1,this.length),this[B]},r.prototype.readUInt16LE=function(B,K){return B>>>=0,K||D(B,2,this.length),this[B]|this[B+1]<<8},r.prototype.readUInt16BE=function(B,K){return B>>>=0,K||D(B,2,this.length),this[B]<<8|this[B+1]},r.prototype.readUInt32LE=function(B,K){return B>>>=0,K||D(B,4,this.length),(this[B]|this[B+1]<<8|this[B+2]<<16)+16777216*this[B+3]},r.prototype.readUInt32BE=function(B,K){return B>>>=0,K||D(B,4,this.length),16777216*this[B]+(this[B+1]<<16|this[B+2]<<8|this[B+3])},r.prototype.readIntLE=function(B,K,J){B>>>=0,K>>>=0,J||D(B,K,this.length);for(var ee=this[B],ne=1,se=0;++se<K&&(ne*=256);)ee+=this[B+se]*ne;return ee>=(ne*=128)&&(ee-=Math.pow(2,8*K)),ee},r.prototype.readIntBE=function(B,K,J){B>>>=0,K>>>=0,J||D(B,K,this.length);for(var ee=K,ne=1,se=this[B+--ee];ee>0&&(ne*=256);)se+=this[B+--ee]*ne;return se>=(ne*=128)&&(se-=Math.pow(2,8*K)),se},r.prototype.readInt8=function(B,K){return B>>>=0,K||D(B,1,this.length),128&this[B]?-1*(255-this[B]+1):this[B]},r.prototype.readInt16LE=function(B,K){B>>>=0,K||D(B,2,this.length);var J=this[B]|this[B+1]<<8;return 32768&J?4294901760|J:J},r.prototype.readInt16BE=function(B,K){B>>>=0,K||D(B,2,this.length);var J=this[B+1]|this[B]<<8;return 32768&J?4294901760|J:J},r.prototype.readInt32LE=function(B,K){return B>>>=0,K||D(B,4,this.length),this[B]|this[B+1]<<8|this[B+2]<<16|this[B+3]<<24},r.prototype.readInt32BE=function(B,K){return B>>>=0,K||D(B,4,this.length),this[B]<<24|this[B+1]<<16|this[B+2]<<8|this[B+3]},r.prototype.readFloatLE=function(B,K){return B>>>=0,K||D(B,4,this.length),n.read(this,B,!0,23,4)},r.prototype.readFloatBE=function(B,K){return B>>>=0,K||D(B,4,this.length),n.read(this,B,!1,23,4)},r.prototype.readDoubleLE=function(B,K){return B>>>=0,K||D(B,8,this.length),n.read(this,B,!0,52,8)},r.prototype.readDoubleBE=function(B,K){return B>>>=0,K||D(B,8,this.length),n.read(this,B,!1,52,8)},r.prototype.writeUIntLE=function(B,K,J,ee){B=+B,K>>>=0,J>>>=0,ee||j(this,B,K,J,Math.pow(2,8*J)-1,0);var ne=1,se=0;for(this[K]=255&B;++se<J&&(ne*=256);)this[K+se]=B/ne&255;return K+J},r.prototype.writeUIntBE=function(B,K,J,ee){B=+B,K>>>=0,J>>>=0,ee||j(this,B,K,J,Math.pow(2,8*J)-1,0);var ne=J-1,se=1;for(this[K+ne]=255&B;--ne>=0&&(se*=256);)this[K+ne]=B/se&255;return K+J},r.prototype.writeUInt8=function(B,K,J){return B=+B,K>>>=0,J||j(this,B,K,1,255,0),this[K]=255&B,K+1},r.prototype.writeUInt16LE=function(B,K,J){return B=+B,K>>>=0,J||j(this,B,K,2,65535,0),this[K]=255&B,this[K+1]=B>>>8,K+2},r.prototype.writeUInt16BE=function(B,K,J){return B=+B,K>>>=0,J||j(this,B,K,2,65535,0),this[K]=B>>>8,this[K+1]=255&B,K+2},r.prototype.writeUInt32LE=function(B,K,J){return B=+B,K>>>=0,J||j(this,B,K,4,4294967295,0),this[K+3]=B>>>24,this[K+2]=B>>>16,this[K+1]=B>>>8,this[K]=255&B,K+4},r.prototype.writeUInt32BE=function(B,K,J){return B=+B,K>>>=0,J||j(this,B,K,4,4294967295,0),this[K]=B>>>24,this[K+1]=B>>>16,this[K+2]=B>>>8,this[K+3]=255&B,K+4},r.prototype.writeIntLE=function(B,K,J,ee){if(B=+B,K>>>=0,!ee){var ne=Math.pow(2,8*J-1);j(this,B,K,J,ne-1,-ne)}var se=0,oe=1,me=0;for(this[K]=255&B;++se<J&&(oe*=256);)B<0&&me===0&&this[K+se-1]!==0&&(me=1),this[K+se]=(B/oe>>0)-me&255;return K+J},r.prototype.writeIntBE=function(B,K,J,ee){if(B=+B,K>>>=0,!ee){var ne=Math.pow(2,8*J-1);j(this,B,K,J,ne-1,-ne)}var se=J-1,oe=1,me=0;for(this[K+se]=255&B;--se>=0&&(oe*=256);)B<0&&me===0&&this[K+se+1]!==0&&(me=1),this[K+se]=(B/oe>>0)-me&255;return K+J},r.prototype.writeInt8=function(B,K,J){return B=+B,K>>>=0,J||j(this,B,K,1,127,-128),B<0&&(B=255+B+1),this[K]=255&B,K+1},r.prototype.writeInt16LE=function(B,K,J){return B=+B,K>>>=0,J||j(this,B,K,2,32767,-32768),this[K]=255&B,this[K+1]=B>>>8,K+2},r.prototype.writeInt16BE=function(B,K,J){return B=+B,K>>>=0,J||j(this,B,K,2,32767,-32768),this[K]=B>>>8,this[K+1]=255&B,K+2},r.prototype.writeInt32LE=function(B,K,J){return B=+B,K>>>=0,J||j(this,B,K,4,2147483647,-2147483648),this[K]=255&B,this[K+1]=B>>>8,this[K+2]=B>>>16,this[K+3]=B>>>24,K+4},r.prototype.writeInt32BE=function(B,K,J){return B=+B,K>>>=0,J||j(this,B,K,4,2147483647,-2147483648),B<0&&(B=4294967295+B+1),this[K]=B>>>24,this[K+1]=B>>>16,this[K+2]=B>>>8,this[K+3]=255&B,K+4},r.prototype.writeFloatLE=function(B,K,J){return Z(this,B,K,!0,J)},r.prototype.writeFloatBE=function(B,K,J){return Z(this,B,K,!1,J)},r.prototype.writeDoubleLE=function(B,K,J){return Q(this,B,K,!0,J)},r.prototype.writeDoubleBE=function(B,K,J){return Q(this,B,K,!1,J)},r.prototype.copy=function(B,K,J,ee){if(!r.isBuffer(B))throw new TypeError("argument should be a Buffer");if(J||(J=0),ee||ee===0||(ee=this.length),K>=B.length&&(K=B.length),K||(K=0),ee>0&&ee<J&&(ee=J),ee===J||B.length===0||this.length===0)return 0;if(K<0)throw new RangeError("targetStart out of bounds");if(J<0||J>=this.length)throw new RangeError("Index out of range");if(ee<0)throw new RangeError("sourceEnd out of bounds");ee>this.length&&(ee=this.length),B.length-K<ee-J&&(ee=B.length-K+J);var ne=ee-J;if(this===B&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(K,J,ee);else if(this===B&&J<K&&K<ee)for(var se=ne-1;se>=0;--se)B[se+K]=this[se+J];else Uint8Array.prototype.set.call(B,this.subarray(J,ee),K);return ne},r.prototype.fill=function(B,K,J,ee){if(typeof B=="string"){if(typeof K=="string"?(ee=K,K=0,J=this.length):typeof J=="string"&&(ee=J,J=this.length),ee!==void 0&&typeof ee!="string")throw new TypeError("encoding must be a string");if(typeof ee=="string"&&!r.isEncoding(ee))throw new TypeError("Unknown encoding: "+ee);if(B.length===1){var ne=B.charCodeAt(0);(ee==="utf8"&&ne<128||ee==="latin1")&&(B=ne)}}else typeof B=="number"&&(B&=255);if(K<0||this.length<K||this.length<J)throw new RangeError("Out of range index");if(J<=K)return this;var se;if(K>>>=0,J=J===void 0?this.length:J>>>0,B||(B=0),typeof B=="number")for(se=K;se<J;++se)this[se]=B;else{var oe=r.isBuffer(B)?B:r.from(B,ee),me=oe.length;if(me===0)throw new TypeError('The value "'+B+'" is invalid for argument "value"');for(se=0;se<J-K;++se)this[se+K]=oe[se%me]}return this};var X=/[^+/0-9A-Za-z-_]/g;function $(B){return B<16?"0"+B.toString(16):B.toString(16)}function re(B,K){var J;K=K||1/0;for(var ee=B.length,ne=null,se=[],oe=0;oe<ee;++oe){if((J=B.charCodeAt(oe))>55295&&J<57344){if(!ne){if(J>56319){(K-=3)>-1&&se.push(239,191,189);continue}if(oe+1===ee){(K-=3)>-1&&se.push(239,191,189);continue}ne=J;continue}if(J<56320){(K-=3)>-1&&se.push(239,191,189),ne=J;continue}J=65536+(ne-55296<<10|J-56320)}else ne&&(K-=3)>-1&&se.push(239,191,189);if(ne=null,J<128){if((K-=1)<0)break;se.push(J)}else if(J<2048){if((K-=2)<0)break;se.push(J>>6|192,63&J|128)}else if(J<65536){if((K-=3)<0)break;se.push(J>>12|224,J>>6&63|128,63&J|128)}else{if(!(J<1114112))throw new Error("Invalid code point");if((K-=4)<0)break;se.push(J>>18|240,J>>12&63|128,J>>6&63|128,63&J|128)}}return se}function H(B){return t.toByteArray(function(K){if((K=(K=K.split("=")[0]).trim().replace(X,"")).length<2)return"";for(;K.length%4!=0;)K+="=";return K}(B))}function N(B,K,J,ee){for(var ne=0;ne<ee&&!(ne+J>=K.length||ne>=B.length);++ne)K[ne+J]=B[ne];return ne}function U(B,K){return B instanceof K||B!=null&&B.constructor!=null&&B.constructor.name!=null&&B.constructor.name===K.name}function te(B){return B!=B}}).call(this)}).call(this,v("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:4}],4:[function(v,w,y){y.read=function(e,t,n,o,r){var g,c,a=8*r-o-1,h=(1<<a)-1,l=h>>1,s=-7,p=n?r-1:0,u=n?-1:1,i=e[t+p];for(p+=u,g=i&(1<<-s)-1,i>>=-s,s+=a;s>0;g=256*g+e[t+p],p+=u,s-=8);for(c=g&(1<<-s)-1,g>>=-s,s+=o;s>0;c=256*c+e[t+p],p+=u,s-=8);if(g===0)g=1-l;else{if(g===h)return c?NaN:1/0*(i?-1:1);c+=Math.pow(2,o),g-=l}return(i?-1:1)*c*Math.pow(2,g-o)},y.write=function(e,t,n,o,r,g){var c,a,h,l=8*g-r-1,s=(1<<l)-1,p=s>>1,u=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,i=o?0:g-1,x=o?1:-1,f=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,c=s):(c=Math.floor(Math.log(t)/Math.LN2),t*(h=Math.pow(2,-c))<1&&(c--,h*=2),(t+=c+p>=1?u/h:u*Math.pow(2,1-p))*h>=2&&(c++,h/=2),c+p>=s?(a=0,c=s):c+p>=1?(a=(t*h-1)*Math.pow(2,r),c+=p):(a=t*Math.pow(2,p-1)*Math.pow(2,r),c=0));r>=8;e[n+i]=255&a,i+=x,a/=256,r-=8);for(c=c<<r|a,l+=r;l>0;e[n+i]=255&c,i+=x,c/=256,l-=8);e[n+i-x]|=128*f}},{}],5:[function(v,w,y){var e,t,n=w.exports={};function o(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function g(x){if(e===setTimeout)return setTimeout(x,0);if((e===o||!e)&&setTimeout)return e=setTimeout,setTimeout(x,0);try{return e(x,0)}catch{try{return e.call(null,x,0)}catch{return e.call(this,x,0)}}}(function(){try{e=typeof setTimeout=="function"?setTimeout:o}catch{e=o}try{t=typeof clearTimeout=="function"?clearTimeout:r}catch{t=r}})();var c,a=[],h=!1,l=-1;function s(){h&&c&&(h=!1,c.length?a=c.concat(a):l=-1,a.length&&p())}function p(){if(!h){var x=g(s);h=!0;for(var f=a.length;f;){for(c=a,a=[];++l<f;)c&&c[l].run();l=-1,f=a.length}c=null,h=!1,function(_){if(t===clearTimeout)return clearTimeout(_);if((t===r||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(_);try{t(_)}catch{try{return t.call(null,_)}catch{return t.call(this,_)}}}(x)}}function u(x,f){this.fun=x,this.array=f}function i(){}n.nextTick=function(x){var f=new Array(arguments.length-1);if(arguments.length>1)for(var _=1;_<arguments.length;_++)f[_-1]=arguments[_];a.push(new u(x,f)),a.length!==1||h||g(p)},u.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=i,n.addListener=i,n.once=i,n.off=i,n.removeListener=i,n.removeAllListeners=i,n.emit=i,n.prependListener=i,n.prependOnceListener=i,n.listeners=function(x){return[]},n.binding=function(x){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(x){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],6:[function(v,w,y){w.exports={alpha_shape:v("alpha-shape"),convex_hull:v("convex-hull"),delaunay_triangulate:v("delaunay-triangulate"),gl_cone3d:v("gl-cone3d"),gl_error3d:v("gl-error3d"),gl_heatmap2d:v("gl-heatmap2d"),gl_line3d:v("gl-line3d"),gl_mesh3d:v("gl-mesh3d"),gl_plot2d:v("gl-plot2d"),gl_plot3d:v("gl-plot3d"),gl_pointcloud2d:v("gl-pointcloud2d"),gl_scatter3d:v("gl-scatter3d"),gl_select_box:v("gl-select-box"),gl_spikes2d:v("gl-spikes2d"),gl_streamtube3d:v("gl-streamtube3d"),gl_surface3d:v("gl-surface3d"),ndarray:v("ndarray"),ndarray_linear_interpolate:v("ndarray-linear-interpolate")}},{"alpha-shape":12,"convex-hull":58,"delaunay-triangulate":63,"gl-cone3d":79,"gl-error3d":84,"gl-heatmap2d":88,"gl-line3d":91,"gl-mesh3d":112,"gl-plot2d":118,"gl-plot3d":121,"gl-pointcloud2d":123,"gl-scatter3d":128,"gl-select-box":130,"gl-spikes2d":139,"gl-streamtube3d":143,"gl-surface3d":145,ndarray:259,"ndarray-linear-interpolate":253}],7:[function(v,w,y){w.exports=function(g){var c=(g=g||{}).eye||[0,0,1],a=g.center||[0,0,0],h=g.up||[0,1,0],l=g.distanceLimits||[0,1/0],s=g.mode||"turntable",p=e(),u=t(),i=n();return p.setDistanceLimits(l[0],l[1]),p.lookAt(0,c,a,h),u.setDistanceLimits(l[0],l[1]),u.lookAt(0,c,a,h),i.setDistanceLimits(l[0],l[1]),i.lookAt(0,c,a,h),new o({turntable:p,orbit:u,matrix:i},s)};var e=v("turntable-camera-controller"),t=v("orbit-camera-controller"),n=v("matrix-camera-controller");function o(g,c){this._controllerNames=Object.keys(g),this._controllerList=this._controllerNames.map(function(a){return g[a]}),this._mode=c,this._active=g[c],this._active||(this._mode="turntable",this._active=g.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var r=o.prototype;r.flush=function(g){for(var c=this._controllerList,a=0;a<c.length;++a)c[a].flush(g)},r.idle=function(g){for(var c=this._controllerList,a=0;a<c.length;++a)c[a].idle(g)},r.lookAt=function(g,c,a,h){for(var l=this._controllerList,s=0;s<l.length;++s)l[s].lookAt(g,c,a,h)},r.rotate=function(g,c,a,h){for(var l=this._controllerList,s=0;s<l.length;++s)l[s].rotate(g,c,a,h)},r.pan=function(g,c,a,h){for(var l=this._controllerList,s=0;s<l.length;++s)l[s].pan(g,c,a,h)},r.translate=function(g,c,a,h){for(var l=this._controllerList,s=0;s<l.length;++s)l[s].translate(g,c,a,h)},r.setMatrix=function(g,c){for(var a=this._controllerList,h=0;h<a.length;++h)a[h].setMatrix(g,c)},r.setDistanceLimits=function(g,c){for(var a=this._controllerList,h=0;h<a.length;++h)a[h].setDistanceLimits(g,c)},r.setDistance=function(g,c){for(var a=this._controllerList,h=0;h<a.length;++h)a[h].setDistance(g,c)},r.recalcMatrix=function(g){this._active.recalcMatrix(g)},r.getDistance=function(g){return this._active.getDistance(g)},r.getDistanceLimits=function(g){return this._active.getDistanceLimits(g)},r.lastT=function(){return this._active.lastT()},r.setMode=function(g){if(g!==this._mode){var c=this._controllerNames.indexOf(g);if(!(c<0)){var a=this._active,h=this._controllerList[c],l=Math.max(a.lastT(),h.lastT());a.recalcMatrix(l),h.setMatrix(l,a.computedMatrix),this._active=h,this._mode=g,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},r.getMode=function(){return this._mode}},{"matrix-camera-controller":245,"orbit-camera-controller":263,"turntable-camera-controller":305}],8:[function(v,w,y){var e=typeof WeakMap>"u"?v("weak-map"):WeakMap,t=v("gl-buffer"),n=v("gl-vao"),o=new e;w.exports=function(r){var g=o.get(r),c=g&&(g._triangleBuffer.handle||g._triangleBuffer.buffer);if(!c||!r.isBuffer(c)){var a=t(r,new Float32Array([-1,-1,-1,4,4,-1]));(g=n(r,[{buffer:a,type:r.FLOAT,size:2}]))._triangleBuffer=a,o.set(r,g)}g.bind(),r.drawArrays(r.TRIANGLES,0,3),g.unbind()}},{"gl-buffer":78,"gl-vao":150,"weak-map":313}],9:[function(v,w,y){var e=v("pad-left");w.exports=function(t,n,o){n=typeof n=="number"?n:1,o=o||": ";var r=t.split(/\r?\n/),g=String(r.length+n-1).length;return r.map(function(c,a){var h=a+n,l=String(h).length;return e(h,g-l)+o+c}).join(`
`)}},{"pad-left":264}],10:[function(v,w,y){w.exports=function(n){var o=n.length;if(o===0)return[];if(o===1)return[0];for(var r=n[0].length,g=[n[0]],c=[0],a=1;a<o;++a)if(g.push(n[a]),t(g,r)){if(c.push(a),c.length===r+1)return c}else g.pop();return c};var e=v("robust-orientation");function t(n,o){for(var r=new Array(o+1),g=0;g<n.length;++g)r[g]=n[g];for(g=0;g<=n.length;++g){for(var c=n.length;c<=o;++c){for(var a=new Array(o),h=0;h<o;++h)a[h]=Math.pow(c+1-g,h);r[c]=a}if(e.apply(void 0,r))return!0}return!1}},{"robust-orientation":284}],11:[function(v,w,y){w.exports=function(n,o){return e(o).filter(function(r){for(var g=new Array(r.length),c=0;c<r.length;++c)g[c]=o[r[c]];return t(g)*n<1})};var e=v("delaunay-triangulate"),t=v("circumradius")},{circumradius:49,"delaunay-triangulate":63}],12:[function(v,w,y){w.exports=function(n,o){return t(e(n,o))};var e=v("alpha-complex"),t=v("simplicial-complex-boundary")},{"alpha-complex":11,"simplicial-complex-boundary":290}],13:[function(v,w,y){w.exports=function(e){return atob(e)}},{}],14:[function(v,w,y){w.exports=function(n,o){for(var r=o.length,g=new Array(r+1),c=0;c<r;++c){for(var a=new Array(r+1),h=0;h<=r;++h)a[h]=n[h][c];g[c]=a}for(g[r]=new Array(r+1),c=0;c<=r;++c)g[r][c]=1;var l=new Array(r+1);for(c=0;c<r;++c)l[c]=o[c];l[r]=1;var s=e(g,l),p=t(s[r+1]);p===0&&(p=1);var u=new Array(r+1);for(c=0;c<=r;++c)u[c]=t(s[c])/p;return u};var e=v("robust-linear-solve");function t(n){for(var o=0,r=0;r<n.length;++r)o+=n[r];return o}},{"robust-linear-solve":283}],15:[function(v,w,y){var e=v("./lib/rationalize");w.exports=function(t,n){return e(t[0].mul(n[1]).add(n[0].mul(t[1])),t[1].mul(n[1]))}},{"./lib/rationalize":25}],16:[function(v,w,y){w.exports=function(e,t){return e[0].mul(t[1]).cmp(t[0].mul(e[1]))}},{}],17:[function(v,w,y){var e=v("./lib/rationalize");w.exports=function(t,n){return e(t[0].mul(n[1]),t[1].mul(n[0]))}},{"./lib/rationalize":25}],18:[function(v,w,y){var e=v("./is-rat"),t=v("./lib/is-bn"),n=v("./lib/num-to-bn"),o=v("./lib/str-to-bn"),r=v("./lib/rationalize"),g=v("./div");w.exports=function c(a,h){if(e(a))return h?g(a,c(h)):[a[0].clone(),a[1].clone()];var l,s,p=0;if(t(a))l=a.clone();else if(typeof a=="string")l=o(a);else{if(a===0)return[n(0),n(1)];if(a===Math.floor(a))l=n(a);else{for(;a!==Math.floor(a);)a*=Math.pow(2,256),p-=256;l=n(a)}}if(e(h))l.mul(h[1]),s=h[0].clone();else if(t(h))s=h.clone();else if(typeof h=="string")s=o(h);else if(h)if(h===Math.floor(h))s=n(h);else{for(;h!==Math.floor(h);)h*=Math.pow(2,256),p+=256;s=n(h)}else s=n(1);return p>0?l=l.ushln(p):p<0&&(s=s.ushln(-p)),r(l,s)}},{"./div":17,"./is-rat":19,"./lib/is-bn":23,"./lib/num-to-bn":24,"./lib/rationalize":25,"./lib/str-to-bn":26}],19:[function(v,w,y){var e=v("./lib/is-bn");w.exports=function(t){return Array.isArray(t)&&t.length===2&&e(t[0])&&e(t[1])}},{"./lib/is-bn":23}],20:[function(v,w,y){var e=v("bn.js");w.exports=function(t){return t.cmp(new e(0))}},{"bn.js":33}],21:[function(v,w,y){var e=v("./bn-sign");w.exports=function(t){var n=t.length,o=t.words,r=0;if(n===1)r=o[0];else if(n===2)r=o[0]+67108864*o[1];else for(var g=0;g<n;g++){var c=o[g];r+=c*Math.pow(67108864,g)}return e(t)*r}},{"./bn-sign":20}],22:[function(v,w,y){var e=v("double-bits"),t=v("bit-twiddle").countTrailingZeros;w.exports=function(n){var o=t(e.lo(n));if(o<32)return o;var r=t(e.hi(n));return r>20?52:r+32}},{"bit-twiddle":32,"double-bits":64}],23:[function(v,w,y){v("bn.js"),w.exports=function(e){return e&&typeof e=="object"&&Boolean(e.words)}},{"bn.js":33}],24:[function(v,w,y){var e=v("bn.js"),t=v("double-bits");w.exports=function(n){var o=t.exponent(n);return o<52?new e(n):new e(n*Math.pow(2,52-o)).ushln(o-52)}},{"bn.js":33,"double-bits":64}],25:[function(v,w,y){var e=v("./num-to-bn"),t=v("./bn-sign");w.exports=function(n,o){var r=t(n),g=t(o);if(r===0)return[e(0),e(1)];if(g===0)return[e(0),e(0)];g<0&&(n=n.neg(),o=o.neg());var c=n.gcd(o);return c.cmpn(1)?[n.div(c),o.div(c)]:[n,o]}},{"./bn-sign":20,"./num-to-bn":24}],26:[function(v,w,y){var e=v("bn.js");w.exports=function(t){return new e(t)}},{"bn.js":33}],27:[function(v,w,y){var e=v("./lib/rationalize");w.exports=function(t,n){return e(t[0].mul(n[0]),t[1].mul(n[1]))}},{"./lib/rationalize":25}],28:[function(v,w,y){var e=v("./lib/bn-sign");w.exports=function(t){return e(t[0])*e(t[1])}},{"./lib/bn-sign":20}],29:[function(v,w,y){var e=v("./lib/rationalize");w.exports=function(t,n){return e(t[0].mul(n[1]).sub(t[1].mul(n[0])),t[1].mul(n[1]))}},{"./lib/rationalize":25}],30:[function(v,w,y){var e=v("./lib/bn-to-num"),t=v("./lib/ctz");w.exports=function(n){var o=n[0],r=n[1];if(o.cmpn(0)===0)return 0;var g=o.abs().divmod(r.abs()),c=g.div,a=e(c),h=g.mod,l=o.negative!==r.negative?-1:1;if(h.cmpn(0)===0)return l*a;if(a){var s=t(a)+4,p=e(h.ushln(s).divRound(r));return l*(a+p*Math.pow(2,-s))}var u=r.bitLength()-h.bitLength()+53;return p=e(h.ushln(u).divRound(r)),u<1023?l*p*Math.pow(2,-u):(p*=Math.pow(2,-1023),l*p*Math.pow(2,1023-u))}},{"./lib/bn-to-num":21,"./lib/ctz":22}],31:[function(v,w,y){function e(c,a,h,l,s){for(var p=s+1;l<=s;){var u=l+s>>>1,i=c[u];(h!==void 0?h(i,a):i-a)>=0?(p=u,s=u-1):l=u+1}return p}function t(c,a,h,l,s){for(var p=s+1;l<=s;){var u=l+s>>>1,i=c[u];(h!==void 0?h(i,a):i-a)>0?(p=u,s=u-1):l=u+1}return p}function n(c,a,h,l,s){for(var p=l-1;l<=s;){var u=l+s>>>1,i=c[u];(h!==void 0?h(i,a):i-a)<0?(p=u,l=u+1):s=u-1}return p}function o(c,a,h,l,s){for(var p=l-1;l<=s;){var u=l+s>>>1,i=c[u];(h!==void 0?h(i,a):i-a)<=0?(p=u,l=u+1):s=u-1}return p}function r(c,a,h,l,s){for(;l<=s;){var p=l+s>>>1,u=c[p],i=h!==void 0?h(u,a):u-a;if(i===0)return p;i<=0?l=p+1:s=p-1}return-1}function g(c,a,h,l,s,p){return typeof h=="function"?p(c,a,h,l===void 0?0:0|l,s===void 0?c.length-1:0|s):p(c,a,void 0,h===void 0?0:0|h,l===void 0?c.length-1:0|l)}w.exports={ge:function(c,a,h,l,s){return g(c,a,h,l,s,e)},gt:function(c,a,h,l,s){return g(c,a,h,l,s,t)},lt:function(c,a,h,l,s){return g(c,a,h,l,s,n)},le:function(c,a,h,l,s){return g(c,a,h,l,s,o)},eq:function(c,a,h,l,s){return g(c,a,h,l,s,r)}}},{}],32:[function(v,w,y){function e(n){var o=32;return(n&=-n)&&o--,65535&n&&(o-=16),16711935&n&&(o-=8),252645135&n&&(o-=4),858993459&n&&(o-=2),1431655765&n&&(o-=1),o}y.INT_BITS=32,y.INT_MAX=2147483647,y.INT_MIN=-1<<31,y.sign=function(n){return(n>0)-(n<0)},y.abs=function(n){var o=n>>31;return(n^o)-o},y.min=function(n,o){return o^(n^o)&-(n<o)},y.max=function(n,o){return n^(n^o)&-(n<o)},y.isPow2=function(n){return!(n&n-1||!n)},y.log2=function(n){var o,r;return o=(n>65535)<<4,o|=r=((n>>>=o)>255)<<3,o|=r=((n>>>=r)>15)<<2,(o|=r=((n>>>=r)>3)<<1)|(n>>>=r)>>1},y.log10=function(n){return n>=1e9?9:n>=1e8?8:n>=1e7?7:n>=1e6?6:n>=1e5?5:n>=1e4?4:n>=1e3?3:n>=100?2:n>=10?1:0},y.popCount=function(n){return 16843009*((n=(858993459&(n-=n>>>1&1431655765))+(n>>>2&858993459))+(n>>>4)&252645135)>>>24},y.countTrailingZeros=e,y.nextPow2=function(n){return n+=n===0,--n,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,(n|=n>>>16)+1},y.prevPow2=function(n){return n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,(n|=n>>>16)-(n>>>1)},y.parity=function(n){return n^=n>>>16,n^=n>>>8,n^=n>>>4,27030>>>(n&=15)&1};var t=new Array(256);(function(n){for(var o=0;o<256;++o){var r=o,g=o,c=7;for(r>>>=1;r;r>>>=1)g<<=1,g|=1&r,--c;n[o]=g<<c&255}})(t),y.reverse=function(n){return t[255&n]<<24|t[n>>>8&255]<<16|t[n>>>16&255]<<8|t[n>>>24&255]},y.interleave2=function(n,o){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n&=65535)|n<<8))|n<<4))|n<<2))|n<<1))|(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o&=65535)|o<<8))|o<<4))|o<<2))|o<<1))<<1},y.deinterleave2=function(n,o){return(n=65535&((n=16711935&((n=252645135&((n=858993459&((n=n>>>o&1431655765)|n>>>1))|n>>>2))|n>>>4))|n>>>16))<<16>>16},y.interleave3=function(n,o,r){return n=1227133513&((n=3272356035&((n=251719695&((n=4278190335&((n&=1023)|n<<16))|n<<8))|n<<4))|n<<2),(n|=(o=1227133513&((o=3272356035&((o=251719695&((o=4278190335&((o&=1023)|o<<16))|o<<8))|o<<4))|o<<2))<<1)|(r=1227133513&((r=3272356035&((r=251719695&((r=4278190335&((r&=1023)|r<<16))|r<<8))|r<<4))|r<<2))<<2},y.deinterleave3=function(n,o){return(n=1023&((n=4278190335&((n=251719695&((n=3272356035&((n=n>>>o&1227133513)|n>>>2))|n>>>4))|n>>>8))|n>>>16))<<22>>22},y.nextCombination=function(n){var o=n|n-1;return o+1|(~o&-~o)-1>>>e(n)+1}},{}],33:[function(v,w,y){(function(e,t){function n(S,E){if(!S)throw new Error(E||"Assertion failed")}function o(S,E){S.super_=E;var z=function(){};z.prototype=E.prototype,S.prototype=new z,S.prototype.constructor=S}function r(S,E,z){if(r.isBN(S))return S;this.negative=0,this.words=null,this.length=0,this.red=null,S!==null&&(E!=="le"&&E!=="be"||(z=E,E=10),this._init(S||0,E||10,z||"be"))}var g;typeof e=="object"?e.exports=r:t.BN=r,r.BN=r,r.wordSize=26;try{g=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:v("buffer").Buffer}catch{}function c(S,E){var z=S.charCodeAt(E);return z>=65&&z<=70?z-55:z>=97&&z<=102?z-87:z-48&15}function a(S,E,z){var D=c(S,z);return z-1>=E&&(D|=c(S,z-1)<<4),D}function h(S,E,z,D){for(var j=0,V=Math.min(S.length,z),Z=E;Z<V;Z++){var Q=S.charCodeAt(Z)-48;j*=D,j+=Q>=49?Q-49+10:Q>=17?Q-17+10:Q}return j}r.isBN=function(S){return S instanceof r||S!==null&&typeof S=="object"&&S.constructor.wordSize===r.wordSize&&Array.isArray(S.words)},r.max=function(S,E){return S.cmp(E)>0?S:E},r.min=function(S,E){return S.cmp(E)<0?S:E},r.prototype._init=function(S,E,z){if(typeof S=="number")return this._initNumber(S,E,z);if(typeof S=="object")return this._initArray(S,E,z);E==="hex"&&(E=16),n(E===(0|E)&&E>=2&&E<=36);var D=0;(S=S.toString().replace(/\s+/g,""))[0]==="-"&&(D++,this.negative=1),D<S.length&&(E===16?this._parseHex(S,D,z):(this._parseBase(S,E,D),z==="le"&&this._initArray(this.toArray(),E,z)))},r.prototype._initNumber=function(S,E,z){S<0&&(this.negative=1,S=-S),S<67108864?(this.words=[67108863&S],this.length=1):S<4503599627370496?(this.words=[67108863&S,S/67108864&67108863],this.length=2):(n(S<9007199254740992),this.words=[67108863&S,S/67108864&67108863,1],this.length=3),z==="le"&&this._initArray(this.toArray(),E,z)},r.prototype._initArray=function(S,E,z){if(n(typeof S.length=="number"),S.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(S.length/3),this.words=new Array(this.length);for(var D=0;D<this.length;D++)this.words[D]=0;var j,V,Z=0;if(z==="be")for(D=S.length-1,j=0;D>=0;D-=3)V=S[D]|S[D-1]<<8|S[D-2]<<16,this.words[j]|=V<<Z&67108863,this.words[j+1]=V>>>26-Z&67108863,(Z+=24)>=26&&(Z-=26,j++);else if(z==="le")for(D=0,j=0;D<S.length;D+=3)V=S[D]|S[D+1]<<8|S[D+2]<<16,this.words[j]|=V<<Z&67108863,this.words[j+1]=V>>>26-Z&67108863,(Z+=24)>=26&&(Z-=26,j++);return this.strip()},r.prototype._parseHex=function(S,E,z){this.length=Math.ceil((S.length-E)/6),this.words=new Array(this.length);for(var D=0;D<this.length;D++)this.words[D]=0;var j,V=0,Z=0;if(z==="be")for(D=S.length-1;D>=E;D-=2)j=a(S,E,D)<<V,this.words[Z]|=67108863&j,V>=18?(V-=18,Z+=1,this.words[Z]|=j>>>26):V+=8;else for(D=(S.length-E)%2==0?E+1:E;D<S.length;D+=2)j=a(S,E,D)<<V,this.words[Z]|=67108863&j,V>=18?(V-=18,Z+=1,this.words[Z]|=j>>>26):V+=8;this.strip()},r.prototype._parseBase=function(S,E,z){this.words=[0],this.length=1;for(var D=0,j=1;j<=67108863;j*=E)D++;D--,j=j/E|0;for(var V=S.length-z,Z=V%D,Q=Math.min(V,V-Z)+z,X=0,$=z;$<Q;$+=D)X=h(S,$,$+D,E),this.imuln(j),this.words[0]+X<67108864?this.words[0]+=X:this._iaddn(X);if(Z!==0){var re=1;for(X=h(S,$,S.length,E),$=0;$<Z;$++)re*=E;this.imuln(re),this.words[0]+X<67108864?this.words[0]+=X:this._iaddn(X)}this.strip()},r.prototype.copy=function(S){S.words=new Array(this.length);for(var E=0;E<this.length;E++)S.words[E]=this.words[E];S.length=this.length,S.negative=this.negative,S.red=this.red},r.prototype.clone=function(){var S=new r(null);return this.copy(S),S},r.prototype._expand=function(S){for(;this.length<S;)this.words[this.length++]=0;return this},r.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},r.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},r.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var l=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],s=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function u(S,E,z){z.negative=E.negative^S.negative;var D=S.length+E.length|0;z.length=D,D=D-1|0;var j=0|S.words[0],V=0|E.words[0],Z=j*V,Q=67108863&Z,X=Z/67108864|0;z.words[0]=Q;for(var $=1;$<D;$++){for(var re=X>>>26,H=67108863&X,N=Math.min($,E.length-1),U=Math.max(0,$-S.length+1);U<=N;U++){var te=$-U|0;re+=(Z=(j=0|S.words[te])*(V=0|E.words[U])+H)/67108864|0,H=67108863&Z}z.words[$]=0|H,X=0|re}return X!==0?z.words[$]=0|X:z.length--,z.strip()}r.prototype.toString=function(S,E){var z;if(E=0|E||1,(S=S||10)===16||S==="hex"){z="";for(var D=0,j=0,V=0;V<this.length;V++){var Z=this.words[V],Q=(16777215&(Z<<D|j)).toString(16);z=(j=Z>>>24-D&16777215)!==0||V!==this.length-1?l[6-Q.length]+Q+z:Q+z,(D+=2)>=26&&(D-=26,V--)}for(j!==0&&(z=j.toString(16)+z);z.length%E!=0;)z="0"+z;return this.negative!==0&&(z="-"+z),z}if(S===(0|S)&&S>=2&&S<=36){var X=s[S],$=p[S];z="";var re=this.clone();for(re.negative=0;!re.isZero();){var H=re.modn($).toString(S);z=(re=re.idivn($)).isZero()?H+z:l[X-H.length]+H+z}for(this.isZero()&&(z="0"+z);z.length%E!=0;)z="0"+z;return this.negative!==0&&(z="-"+z),z}n(!1,"Base should be between 2 and 36")},r.prototype.toNumber=function(){var S=this.words[0];return this.length===2?S+=67108864*this.words[1]:this.length===3&&this.words[2]===1?S+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-S:S},r.prototype.toJSON=function(){return this.toString(16)},r.prototype.toBuffer=function(S,E){return n(g!==void 0),this.toArrayLike(g,S,E)},r.prototype.toArray=function(S,E){return this.toArrayLike(Array,S,E)},r.prototype.toArrayLike=function(S,E,z){var D=this.byteLength(),j=z||Math.max(1,D);n(D<=j,"byte array longer than desired length"),n(j>0,"Requested array length <= 0"),this.strip();var V,Z,Q=E==="le",X=new S(j),$=this.clone();if(Q){for(Z=0;!$.isZero();Z++)V=$.andln(255),$.iushrn(8),X[Z]=V;for(;Z<j;Z++)X[Z]=0}else{for(Z=0;Z<j-D;Z++)X[Z]=0;for(Z=0;!$.isZero();Z++)V=$.andln(255),$.iushrn(8),X[j-Z-1]=V}return X},Math.clz32?r.prototype._countBits=function(S){return 32-Math.clz32(S)}:r.prototype._countBits=function(S){var E=S,z=0;return E>=4096&&(z+=13,E>>>=13),E>=64&&(z+=7,E>>>=7),E>=8&&(z+=4,E>>>=4),E>=2&&(z+=2,E>>>=2),z+E},r.prototype._zeroBits=function(S){if(S===0)return 26;var E=S,z=0;return(8191&E)==0&&(z+=13,E>>>=13),(127&E)==0&&(z+=7,E>>>=7),(15&E)==0&&(z+=4,E>>>=4),(3&E)==0&&(z+=2,E>>>=2),(1&E)==0&&z++,z},r.prototype.bitLength=function(){var S=this.words[this.length-1],E=this._countBits(S);return 26*(this.length-1)+E},r.prototype.zeroBits=function(){if(this.isZero())return 0;for(var S=0,E=0;E<this.length;E++){var z=this._zeroBits(this.words[E]);if(S+=z,z!==26)break}return S},r.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},r.prototype.toTwos=function(S){return this.negative!==0?this.abs().inotn(S).iaddn(1):this.clone()},r.prototype.fromTwos=function(S){return this.testn(S-1)?this.notn(S).iaddn(1).ineg():this.clone()},r.prototype.isNeg=function(){return this.negative!==0},r.prototype.neg=function(){return this.clone().ineg()},r.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},r.prototype.iuor=function(S){for(;this.length<S.length;)this.words[this.length++]=0;for(var E=0;E<S.length;E++)this.words[E]=this.words[E]|S.words[E];return this.strip()},r.prototype.ior=function(S){return n((this.negative|S.negative)==0),this.iuor(S)},r.prototype.or=function(S){return this.length>S.length?this.clone().ior(S):S.clone().ior(this)},r.prototype.uor=function(S){return this.length>S.length?this.clone().iuor(S):S.clone().iuor(this)},r.prototype.iuand=function(S){var E;E=this.length>S.length?S:this;for(var z=0;z<E.length;z++)this.words[z]=this.words[z]&S.words[z];return this.length=E.length,this.strip()},r.prototype.iand=function(S){return n((this.negative|S.negative)==0),this.iuand(S)},r.prototype.and=function(S){return this.length>S.length?this.clone().iand(S):S.clone().iand(this)},r.prototype.uand=function(S){return this.length>S.length?this.clone().iuand(S):S.clone().iuand(this)},r.prototype.iuxor=function(S){var E,z;this.length>S.length?(E=this,z=S):(E=S,z=this);for(var D=0;D<z.length;D++)this.words[D]=E.words[D]^z.words[D];if(this!==E)for(;D<E.length;D++)this.words[D]=E.words[D];return this.length=E.length,this.strip()},r.prototype.ixor=function(S){return n((this.negative|S.negative)==0),this.iuxor(S)},r.prototype.xor=function(S){return this.length>S.length?this.clone().ixor(S):S.clone().ixor(this)},r.prototype.uxor=function(S){return this.length>S.length?this.clone().iuxor(S):S.clone().iuxor(this)},r.prototype.inotn=function(S){n(typeof S=="number"&&S>=0);var E=0|Math.ceil(S/26),z=S%26;this._expand(E),z>0&&E--;for(var D=0;D<E;D++)this.words[D]=67108863&~this.words[D];return z>0&&(this.words[D]=~this.words[D]&67108863>>26-z),this.strip()},r.prototype.notn=function(S){return this.clone().inotn(S)},r.prototype.setn=function(S,E){n(typeof S=="number"&&S>=0);var z=S/26|0,D=S%26;return this._expand(z+1),this.words[z]=E?this.words[z]|1<<D:this.words[z]&~(1<<D),this.strip()},r.prototype.iadd=function(S){var E,z,D;if(this.negative!==0&&S.negative===0)return this.negative=0,E=this.isub(S),this.negative^=1,this._normSign();if(this.negative===0&&S.negative!==0)return S.negative=0,E=this.isub(S),S.negative=1,E._normSign();this.length>S.length?(z=this,D=S):(z=S,D=this);for(var j=0,V=0;V<D.length;V++)E=(0|z.words[V])+(0|D.words[V])+j,this.words[V]=67108863&E,j=E>>>26;for(;j!==0&&V<z.length;V++)E=(0|z.words[V])+j,this.words[V]=67108863&E,j=E>>>26;if(this.length=z.length,j!==0)this.words[this.length]=j,this.length++;else if(z!==this)for(;V<z.length;V++)this.words[V]=z.words[V];return this},r.prototype.add=function(S){var E;return S.negative!==0&&this.negative===0?(S.negative=0,E=this.sub(S),S.negative^=1,E):S.negative===0&&this.negative!==0?(this.negative=0,E=S.sub(this),this.negative=1,E):this.length>S.length?this.clone().iadd(S):S.clone().iadd(this)},r.prototype.isub=function(S){if(S.negative!==0){S.negative=0;var E=this.iadd(S);return S.negative=1,E._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(S),this.negative=1,this._normSign();var z,D,j=this.cmp(S);if(j===0)return this.negative=0,this.length=1,this.words[0]=0,this;j>0?(z=this,D=S):(z=S,D=this);for(var V=0,Z=0;Z<D.length;Z++)V=(E=(0|z.words[Z])-(0|D.words[Z])+V)>>26,this.words[Z]=67108863&E;for(;V!==0&&Z<z.length;Z++)V=(E=(0|z.words[Z])+V)>>26,this.words[Z]=67108863&E;if(V===0&&Z<z.length&&z!==this)for(;Z<z.length;Z++)this.words[Z]=z.words[Z];return this.length=Math.max(this.length,Z),z!==this&&(this.negative=1),this.strip()},r.prototype.sub=function(S){return this.clone().isub(S)};var i=function(S,E,z){var D,j,V,Z=S.words,Q=E.words,X=z.words,$=0,re=0|Z[0],H=8191&re,N=re>>>13,U=0|Z[1],te=8191&U,B=U>>>13,K=0|Z[2],J=8191&K,ee=K>>>13,ne=0|Z[3],se=8191&ne,oe=ne>>>13,me=0|Z[4],ce=8191&me,ye=me>>>13,Se=0|Z[5],fe=8191&Se,ge=Se>>>13,Te=0|Z[6],le=8191&Te,ve=Te>>>13,Me=0|Z[7],we=8191&Me,de=Me>>>13,Ie=0|Z[8],De=8191&Ie,Oe=Ie>>>13,Ve=0|Z[9],Fe=8191&Ve,ze=Ve>>>13,Re=0|Q[0],We=8191&Re,$e=Re>>>13,at=0|Q[1],gt=8191&at,xt=at>>>13,mt=0|Q[2],nt=8191&mt,Qe=mt>>>13,vt=0|Q[3],jt=8191&vt,Gt=vt>>>13,$t=0|Q[4],Zt=8191&$t,cr=$t>>>13,Dt=0|Q[5],Ne=8191&Dt,Ye=Dt>>>13,pe=0|Q[6],_e=8191&pe,Be=pe>>>13,He=0|Q[7],Je=8191&He,Ze=He>>>13,ct=0|Q[8],lt=8191&ct,At=ct>>>13,Ot=0|Q[9],it=8191&Ot,ht=Ot>>>13;z.negative=S.negative^E.negative,z.length=19;var Ut=($+(D=Math.imul(H,We))|0)+((8191&(j=(j=Math.imul(H,$e))+Math.imul(N,We)|0))<<13)|0;$=((V=Math.imul(N,$e))+(j>>>13)|0)+(Ut>>>26)|0,Ut&=67108863,D=Math.imul(te,We),j=(j=Math.imul(te,$e))+Math.imul(B,We)|0,V=Math.imul(B,$e);var Mt=($+(D=D+Math.imul(H,gt)|0)|0)+((8191&(j=(j=j+Math.imul(H,xt)|0)+Math.imul(N,gt)|0))<<13)|0;$=((V=V+Math.imul(N,xt)|0)+(j>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,D=Math.imul(J,We),j=(j=Math.imul(J,$e))+Math.imul(ee,We)|0,V=Math.imul(ee,$e),D=D+Math.imul(te,gt)|0,j=(j=j+Math.imul(te,xt)|0)+Math.imul(B,gt)|0,V=V+Math.imul(B,xt)|0;var It=($+(D=D+Math.imul(H,nt)|0)|0)+((8191&(j=(j=j+Math.imul(H,Qe)|0)+Math.imul(N,nt)|0))<<13)|0;$=((V=V+Math.imul(N,Qe)|0)+(j>>>13)|0)+(It>>>26)|0,It&=67108863,D=Math.imul(se,We),j=(j=Math.imul(se,$e))+Math.imul(oe,We)|0,V=Math.imul(oe,$e),D=D+Math.imul(J,gt)|0,j=(j=j+Math.imul(J,xt)|0)+Math.imul(ee,gt)|0,V=V+Math.imul(ee,xt)|0,D=D+Math.imul(te,nt)|0,j=(j=j+Math.imul(te,Qe)|0)+Math.imul(B,nt)|0,V=V+Math.imul(B,Qe)|0;var Le=($+(D=D+Math.imul(H,jt)|0)|0)+((8191&(j=(j=j+Math.imul(H,Gt)|0)+Math.imul(N,jt)|0))<<13)|0;$=((V=V+Math.imul(N,Gt)|0)+(j>>>13)|0)+(Le>>>26)|0,Le&=67108863,D=Math.imul(ce,We),j=(j=Math.imul(ce,$e))+Math.imul(ye,We)|0,V=Math.imul(ye,$e),D=D+Math.imul(se,gt)|0,j=(j=j+Math.imul(se,xt)|0)+Math.imul(oe,gt)|0,V=V+Math.imul(oe,xt)|0,D=D+Math.imul(J,nt)|0,j=(j=j+Math.imul(J,Qe)|0)+Math.imul(ee,nt)|0,V=V+Math.imul(ee,Qe)|0,D=D+Math.imul(te,jt)|0,j=(j=j+Math.imul(te,Gt)|0)+Math.imul(B,jt)|0,V=V+Math.imul(B,Gt)|0;var Xe=($+(D=D+Math.imul(H,Zt)|0)|0)+((8191&(j=(j=j+Math.imul(H,cr)|0)+Math.imul(N,Zt)|0))<<13)|0;$=((V=V+Math.imul(N,cr)|0)+(j>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,D=Math.imul(fe,We),j=(j=Math.imul(fe,$e))+Math.imul(ge,We)|0,V=Math.imul(ge,$e),D=D+Math.imul(ce,gt)|0,j=(j=j+Math.imul(ce,xt)|0)+Math.imul(ye,gt)|0,V=V+Math.imul(ye,xt)|0,D=D+Math.imul(se,nt)|0,j=(j=j+Math.imul(se,Qe)|0)+Math.imul(oe,nt)|0,V=V+Math.imul(oe,Qe)|0,D=D+Math.imul(J,jt)|0,j=(j=j+Math.imul(J,Gt)|0)+Math.imul(ee,jt)|0,V=V+Math.imul(ee,Gt)|0,D=D+Math.imul(te,Zt)|0,j=(j=j+Math.imul(te,cr)|0)+Math.imul(B,Zt)|0,V=V+Math.imul(B,cr)|0;var ot=($+(D=D+Math.imul(H,Ne)|0)|0)+((8191&(j=(j=j+Math.imul(H,Ye)|0)+Math.imul(N,Ne)|0))<<13)|0;$=((V=V+Math.imul(N,Ye)|0)+(j>>>13)|0)+(ot>>>26)|0,ot&=67108863,D=Math.imul(le,We),j=(j=Math.imul(le,$e))+Math.imul(ve,We)|0,V=Math.imul(ve,$e),D=D+Math.imul(fe,gt)|0,j=(j=j+Math.imul(fe,xt)|0)+Math.imul(ge,gt)|0,V=V+Math.imul(ge,xt)|0,D=D+Math.imul(ce,nt)|0,j=(j=j+Math.imul(ce,Qe)|0)+Math.imul(ye,nt)|0,V=V+Math.imul(ye,Qe)|0,D=D+Math.imul(se,jt)|0,j=(j=j+Math.imul(se,Gt)|0)+Math.imul(oe,jt)|0,V=V+Math.imul(oe,Gt)|0,D=D+Math.imul(J,Zt)|0,j=(j=j+Math.imul(J,cr)|0)+Math.imul(ee,Zt)|0,V=V+Math.imul(ee,cr)|0,D=D+Math.imul(te,Ne)|0,j=(j=j+Math.imul(te,Ye)|0)+Math.imul(B,Ne)|0,V=V+Math.imul(B,Ye)|0;var pt=($+(D=D+Math.imul(H,_e)|0)|0)+((8191&(j=(j=j+Math.imul(H,Be)|0)+Math.imul(N,_e)|0))<<13)|0;$=((V=V+Math.imul(N,Be)|0)+(j>>>13)|0)+(pt>>>26)|0,pt&=67108863,D=Math.imul(we,We),j=(j=Math.imul(we,$e))+Math.imul(de,We)|0,V=Math.imul(de,$e),D=D+Math.imul(le,gt)|0,j=(j=j+Math.imul(le,xt)|0)+Math.imul(ve,gt)|0,V=V+Math.imul(ve,xt)|0,D=D+Math.imul(fe,nt)|0,j=(j=j+Math.imul(fe,Qe)|0)+Math.imul(ge,nt)|0,V=V+Math.imul(ge,Qe)|0,D=D+Math.imul(ce,jt)|0,j=(j=j+Math.imul(ce,Gt)|0)+Math.imul(ye,jt)|0,V=V+Math.imul(ye,Gt)|0,D=D+Math.imul(se,Zt)|0,j=(j=j+Math.imul(se,cr)|0)+Math.imul(oe,Zt)|0,V=V+Math.imul(oe,cr)|0,D=D+Math.imul(J,Ne)|0,j=(j=j+Math.imul(J,Ye)|0)+Math.imul(ee,Ne)|0,V=V+Math.imul(ee,Ye)|0,D=D+Math.imul(te,_e)|0,j=(j=j+Math.imul(te,Be)|0)+Math.imul(B,_e)|0,V=V+Math.imul(B,Be)|0;var St=($+(D=D+Math.imul(H,Je)|0)|0)+((8191&(j=(j=j+Math.imul(H,Ze)|0)+Math.imul(N,Je)|0))<<13)|0;$=((V=V+Math.imul(N,Ze)|0)+(j>>>13)|0)+(St>>>26)|0,St&=67108863,D=Math.imul(De,We),j=(j=Math.imul(De,$e))+Math.imul(Oe,We)|0,V=Math.imul(Oe,$e),D=D+Math.imul(we,gt)|0,j=(j=j+Math.imul(we,xt)|0)+Math.imul(de,gt)|0,V=V+Math.imul(de,xt)|0,D=D+Math.imul(le,nt)|0,j=(j=j+Math.imul(le,Qe)|0)+Math.imul(ve,nt)|0,V=V+Math.imul(ve,Qe)|0,D=D+Math.imul(fe,jt)|0,j=(j=j+Math.imul(fe,Gt)|0)+Math.imul(ge,jt)|0,V=V+Math.imul(ge,Gt)|0,D=D+Math.imul(ce,Zt)|0,j=(j=j+Math.imul(ce,cr)|0)+Math.imul(ye,Zt)|0,V=V+Math.imul(ye,cr)|0,D=D+Math.imul(se,Ne)|0,j=(j=j+Math.imul(se,Ye)|0)+Math.imul(oe,Ne)|0,V=V+Math.imul(oe,Ye)|0,D=D+Math.imul(J,_e)|0,j=(j=j+Math.imul(J,Be)|0)+Math.imul(ee,_e)|0,V=V+Math.imul(ee,Be)|0,D=D+Math.imul(te,Je)|0,j=(j=j+Math.imul(te,Ze)|0)+Math.imul(B,Je)|0,V=V+Math.imul(B,Ze)|0;var Vt=($+(D=D+Math.imul(H,lt)|0)|0)+((8191&(j=(j=j+Math.imul(H,At)|0)+Math.imul(N,lt)|0))<<13)|0;$=((V=V+Math.imul(N,At)|0)+(j>>>13)|0)+(Vt>>>26)|0,Vt&=67108863,D=Math.imul(Fe,We),j=(j=Math.imul(Fe,$e))+Math.imul(ze,We)|0,V=Math.imul(ze,$e),D=D+Math.imul(De,gt)|0,j=(j=j+Math.imul(De,xt)|0)+Math.imul(Oe,gt)|0,V=V+Math.imul(Oe,xt)|0,D=D+Math.imul(we,nt)|0,j=(j=j+Math.imul(we,Qe)|0)+Math.imul(de,nt)|0,V=V+Math.imul(de,Qe)|0,D=D+Math.imul(le,jt)|0,j=(j=j+Math.imul(le,Gt)|0)+Math.imul(ve,jt)|0,V=V+Math.imul(ve,Gt)|0,D=D+Math.imul(fe,Zt)|0,j=(j=j+Math.imul(fe,cr)|0)+Math.imul(ge,Zt)|0,V=V+Math.imul(ge,cr)|0,D=D+Math.imul(ce,Ne)|0,j=(j=j+Math.imul(ce,Ye)|0)+Math.imul(ye,Ne)|0,V=V+Math.imul(ye,Ye)|0,D=D+Math.imul(se,_e)|0,j=(j=j+Math.imul(se,Be)|0)+Math.imul(oe,_e)|0,V=V+Math.imul(oe,Be)|0,D=D+Math.imul(J,Je)|0,j=(j=j+Math.imul(J,Ze)|0)+Math.imul(ee,Je)|0,V=V+Math.imul(ee,Ze)|0,D=D+Math.imul(te,lt)|0,j=(j=j+Math.imul(te,At)|0)+Math.imul(B,lt)|0,V=V+Math.imul(B,At)|0;var Jt=($+(D=D+Math.imul(H,it)|0)|0)+((8191&(j=(j=j+Math.imul(H,ht)|0)+Math.imul(N,it)|0))<<13)|0;$=((V=V+Math.imul(N,ht)|0)+(j>>>13)|0)+(Jt>>>26)|0,Jt&=67108863,D=Math.imul(Fe,gt),j=(j=Math.imul(Fe,xt))+Math.imul(ze,gt)|0,V=Math.imul(ze,xt),D=D+Math.imul(De,nt)|0,j=(j=j+Math.imul(De,Qe)|0)+Math.imul(Oe,nt)|0,V=V+Math.imul(Oe,Qe)|0,D=D+Math.imul(we,jt)|0,j=(j=j+Math.imul(we,Gt)|0)+Math.imul(de,jt)|0,V=V+Math.imul(de,Gt)|0,D=D+Math.imul(le,Zt)|0,j=(j=j+Math.imul(le,cr)|0)+Math.imul(ve,Zt)|0,V=V+Math.imul(ve,cr)|0,D=D+Math.imul(fe,Ne)|0,j=(j=j+Math.imul(fe,Ye)|0)+Math.imul(ge,Ne)|0,V=V+Math.imul(ge,Ye)|0,D=D+Math.imul(ce,_e)|0,j=(j=j+Math.imul(ce,Be)|0)+Math.imul(ye,_e)|0,V=V+Math.imul(ye,Be)|0,D=D+Math.imul(se,Je)|0,j=(j=j+Math.imul(se,Ze)|0)+Math.imul(oe,Je)|0,V=V+Math.imul(oe,Ze)|0,D=D+Math.imul(J,lt)|0,j=(j=j+Math.imul(J,At)|0)+Math.imul(ee,lt)|0,V=V+Math.imul(ee,At)|0;var qt=($+(D=D+Math.imul(te,it)|0)|0)+((8191&(j=(j=j+Math.imul(te,ht)|0)+Math.imul(B,it)|0))<<13)|0;$=((V=V+Math.imul(B,ht)|0)+(j>>>13)|0)+(qt>>>26)|0,qt&=67108863,D=Math.imul(Fe,nt),j=(j=Math.imul(Fe,Qe))+Math.imul(ze,nt)|0,V=Math.imul(ze,Qe),D=D+Math.imul(De,jt)|0,j=(j=j+Math.imul(De,Gt)|0)+Math.imul(Oe,jt)|0,V=V+Math.imul(Oe,Gt)|0,D=D+Math.imul(we,Zt)|0,j=(j=j+Math.imul(we,cr)|0)+Math.imul(de,Zt)|0,V=V+Math.imul(de,cr)|0,D=D+Math.imul(le,Ne)|0,j=(j=j+Math.imul(le,Ye)|0)+Math.imul(ve,Ne)|0,V=V+Math.imul(ve,Ye)|0,D=D+Math.imul(fe,_e)|0,j=(j=j+Math.imul(fe,Be)|0)+Math.imul(ge,_e)|0,V=V+Math.imul(ge,Be)|0,D=D+Math.imul(ce,Je)|0,j=(j=j+Math.imul(ce,Ze)|0)+Math.imul(ye,Je)|0,V=V+Math.imul(ye,Ze)|0,D=D+Math.imul(se,lt)|0,j=(j=j+Math.imul(se,At)|0)+Math.imul(oe,lt)|0,V=V+Math.imul(oe,At)|0;var gr=($+(D=D+Math.imul(J,it)|0)|0)+((8191&(j=(j=j+Math.imul(J,ht)|0)+Math.imul(ee,it)|0))<<13)|0;$=((V=V+Math.imul(ee,ht)|0)+(j>>>13)|0)+(gr>>>26)|0,gr&=67108863,D=Math.imul(Fe,jt),j=(j=Math.imul(Fe,Gt))+Math.imul(ze,jt)|0,V=Math.imul(ze,Gt),D=D+Math.imul(De,Zt)|0,j=(j=j+Math.imul(De,cr)|0)+Math.imul(Oe,Zt)|0,V=V+Math.imul(Oe,cr)|0,D=D+Math.imul(we,Ne)|0,j=(j=j+Math.imul(we,Ye)|0)+Math.imul(de,Ne)|0,V=V+Math.imul(de,Ye)|0,D=D+Math.imul(le,_e)|0,j=(j=j+Math.imul(le,Be)|0)+Math.imul(ve,_e)|0,V=V+Math.imul(ve,Be)|0,D=D+Math.imul(fe,Je)|0,j=(j=j+Math.imul(fe,Ze)|0)+Math.imul(ge,Je)|0,V=V+Math.imul(ge,Ze)|0,D=D+Math.imul(ce,lt)|0,j=(j=j+Math.imul(ce,At)|0)+Math.imul(ye,lt)|0,V=V+Math.imul(ye,At)|0;var Cr=($+(D=D+Math.imul(se,it)|0)|0)+((8191&(j=(j=j+Math.imul(se,ht)|0)+Math.imul(oe,it)|0))<<13)|0;$=((V=V+Math.imul(oe,ht)|0)+(j>>>13)|0)+(Cr>>>26)|0,Cr&=67108863,D=Math.imul(Fe,Zt),j=(j=Math.imul(Fe,cr))+Math.imul(ze,Zt)|0,V=Math.imul(ze,cr),D=D+Math.imul(De,Ne)|0,j=(j=j+Math.imul(De,Ye)|0)+Math.imul(Oe,Ne)|0,V=V+Math.imul(Oe,Ye)|0,D=D+Math.imul(we,_e)|0,j=(j=j+Math.imul(we,Be)|0)+Math.imul(de,_e)|0,V=V+Math.imul(de,Be)|0,D=D+Math.imul(le,Je)|0,j=(j=j+Math.imul(le,Ze)|0)+Math.imul(ve,Je)|0,V=V+Math.imul(ve,Ze)|0,D=D+Math.imul(fe,lt)|0,j=(j=j+Math.imul(fe,At)|0)+Math.imul(ge,lt)|0,V=V+Math.imul(ge,At)|0;var mr=($+(D=D+Math.imul(ce,it)|0)|0)+((8191&(j=(j=j+Math.imul(ce,ht)|0)+Math.imul(ye,it)|0))<<13)|0;$=((V=V+Math.imul(ye,ht)|0)+(j>>>13)|0)+(mr>>>26)|0,mr&=67108863,D=Math.imul(Fe,Ne),j=(j=Math.imul(Fe,Ye))+Math.imul(ze,Ne)|0,V=Math.imul(ze,Ye),D=D+Math.imul(De,_e)|0,j=(j=j+Math.imul(De,Be)|0)+Math.imul(Oe,_e)|0,V=V+Math.imul(Oe,Be)|0,D=D+Math.imul(we,Je)|0,j=(j=j+Math.imul(we,Ze)|0)+Math.imul(de,Je)|0,V=V+Math.imul(de,Ze)|0,D=D+Math.imul(le,lt)|0,j=(j=j+Math.imul(le,At)|0)+Math.imul(ve,lt)|0,V=V+Math.imul(ve,At)|0;var tr=($+(D=D+Math.imul(fe,it)|0)|0)+((8191&(j=(j=j+Math.imul(fe,ht)|0)+Math.imul(ge,it)|0))<<13)|0;$=((V=V+Math.imul(ge,ht)|0)+(j>>>13)|0)+(tr>>>26)|0,tr&=67108863,D=Math.imul(Fe,_e),j=(j=Math.imul(Fe,Be))+Math.imul(ze,_e)|0,V=Math.imul(ze,Be),D=D+Math.imul(De,Je)|0,j=(j=j+Math.imul(De,Ze)|0)+Math.imul(Oe,Je)|0,V=V+Math.imul(Oe,Ze)|0,D=D+Math.imul(we,lt)|0,j=(j=j+Math.imul(we,At)|0)+Math.imul(de,lt)|0,V=V+Math.imul(de,At)|0;var nr=($+(D=D+Math.imul(le,it)|0)|0)+((8191&(j=(j=j+Math.imul(le,ht)|0)+Math.imul(ve,it)|0))<<13)|0;$=((V=V+Math.imul(ve,ht)|0)+(j>>>13)|0)+(nr>>>26)|0,nr&=67108863,D=Math.imul(Fe,Je),j=(j=Math.imul(Fe,Ze))+Math.imul(ze,Je)|0,V=Math.imul(ze,Ze),D=D+Math.imul(De,lt)|0,j=(j=j+Math.imul(De,At)|0)+Math.imul(Oe,lt)|0,V=V+Math.imul(Oe,At)|0;var Qt=($+(D=D+Math.imul(we,it)|0)|0)+((8191&(j=(j=j+Math.imul(we,ht)|0)+Math.imul(de,it)|0))<<13)|0;$=((V=V+Math.imul(de,ht)|0)+(j>>>13)|0)+(Qt>>>26)|0,Qt&=67108863,D=Math.imul(Fe,lt),j=(j=Math.imul(Fe,At))+Math.imul(ze,lt)|0,V=Math.imul(ze,At);var dr=($+(D=D+Math.imul(De,it)|0)|0)+((8191&(j=(j=j+Math.imul(De,ht)|0)+Math.imul(Oe,it)|0))<<13)|0;$=((V=V+Math.imul(Oe,ht)|0)+(j>>>13)|0)+(dr>>>26)|0,dr&=67108863;var _r=($+(D=Math.imul(Fe,it))|0)+((8191&(j=(j=Math.imul(Fe,ht))+Math.imul(ze,it)|0))<<13)|0;return $=((V=Math.imul(ze,ht))+(j>>>13)|0)+(_r>>>26)|0,_r&=67108863,X[0]=Ut,X[1]=Mt,X[2]=It,X[3]=Le,X[4]=Xe,X[5]=ot,X[6]=pt,X[7]=St,X[8]=Vt,X[9]=Jt,X[10]=qt,X[11]=gr,X[12]=Cr,X[13]=mr,X[14]=tr,X[15]=nr,X[16]=Qt,X[17]=dr,X[18]=_r,$!==0&&(X[19]=$,z.length++),z};function x(S,E,z){return new f().mulp(S,E,z)}function f(S,E){this.x=S,this.y=E}Math.imul||(i=u),r.prototype.mulTo=function(S,E){var z=this.length+S.length;return this.length===10&&S.length===10?i(this,S,E):z<63?u(this,S,E):z<1024?function(D,j,V){V.negative=j.negative^D.negative,V.length=D.length+j.length;for(var Z=0,Q=0,X=0;X<V.length-1;X++){var $=Q;Q=0;for(var re=67108863&Z,H=Math.min(X,j.length-1),N=Math.max(0,X-D.length+1);N<=H;N++){var U=X-N,te=(0|D.words[U])*(0|j.words[N]),B=67108863&te;re=67108863&(B=B+re|0),Q+=($=($=$+(te/67108864|0)|0)+(B>>>26)|0)>>>26,$&=67108863}V.words[X]=re,Z=$,$=Q}return Z!==0?V.words[X]=Z:V.length--,V.strip()}(this,S,E):x(this,S,E)},f.prototype.makeRBT=function(S){for(var E=new Array(S),z=r.prototype._countBits(S)-1,D=0;D<S;D++)E[D]=this.revBin(D,z,S);return E},f.prototype.revBin=function(S,E,z){if(S===0||S===z-1)return S;for(var D=0,j=0;j<E;j++)D|=(1&S)<<E-j-1,S>>=1;return D},f.prototype.permute=function(S,E,z,D,j,V){for(var Z=0;Z<V;Z++)D[Z]=E[S[Z]],j[Z]=z[S[Z]]},f.prototype.transform=function(S,E,z,D,j,V){this.permute(V,S,E,z,D,j);for(var Z=1;Z<j;Z<<=1)for(var Q=Z<<1,X=Math.cos(2*Math.PI/Q),$=Math.sin(2*Math.PI/Q),re=0;re<j;re+=Q)for(var H=X,N=$,U=0;U<Z;U++){var te=z[re+U],B=D[re+U],K=z[re+U+Z],J=D[re+U+Z],ee=H*K-N*J;J=H*J+N*K,K=ee,z[re+U]=te+K,D[re+U]=B+J,z[re+U+Z]=te-K,D[re+U+Z]=B-J,U!==Q&&(ee=X*H-$*N,N=X*N+$*H,H=ee)}},f.prototype.guessLen13b=function(S,E){var z=1|Math.max(E,S),D=1&z,j=0;for(z=z/2|0;z;z>>>=1)j++;return 1<<j+1+D},f.prototype.conjugate=function(S,E,z){if(!(z<=1))for(var D=0;D<z/2;D++){var j=S[D];S[D]=S[z-D-1],S[z-D-1]=j,j=E[D],E[D]=-E[z-D-1],E[z-D-1]=-j}},f.prototype.normalize13b=function(S,E){for(var z=0,D=0;D<E/2;D++){var j=8192*Math.round(S[2*D+1]/E)+Math.round(S[2*D]/E)+z;S[D]=67108863&j,z=j<67108864?0:j/67108864|0}return S},f.prototype.convert13b=function(S,E,z,D){for(var j=0,V=0;V<E;V++)j+=0|S[V],z[2*V]=8191&j,j>>>=13,z[2*V+1]=8191&j,j>>>=13;for(V=2*E;V<D;++V)z[V]=0;n(j===0),n((-8192&j)==0)},f.prototype.stub=function(S){for(var E=new Array(S),z=0;z<S;z++)E[z]=0;return E},f.prototype.mulp=function(S,E,z){var D=2*this.guessLen13b(S.length,E.length),j=this.makeRBT(D),V=this.stub(D),Z=new Array(D),Q=new Array(D),X=new Array(D),$=new Array(D),re=new Array(D),H=new Array(D),N=z.words;N.length=D,this.convert13b(S.words,S.length,Z,D),this.convert13b(E.words,E.length,$,D),this.transform(Z,V,Q,X,D,j),this.transform($,V,re,H,D,j);for(var U=0;U<D;U++){var te=Q[U]*re[U]-X[U]*H[U];X[U]=Q[U]*H[U]+X[U]*re[U],Q[U]=te}return this.conjugate(Q,X,D),this.transform(Q,X,N,V,D,j),this.conjugate(N,V,D),this.normalize13b(N,D),z.negative=S.negative^E.negative,z.length=S.length+E.length,z.strip()},r.prototype.mul=function(S){var E=new r(null);return E.words=new Array(this.length+S.length),this.mulTo(S,E)},r.prototype.mulf=function(S){var E=new r(null);return E.words=new Array(this.length+S.length),x(this,S,E)},r.prototype.imul=function(S){return this.clone().mulTo(S,this)},r.prototype.imuln=function(S){n(typeof S=="number"),n(S<67108864);for(var E=0,z=0;z<this.length;z++){var D=(0|this.words[z])*S,j=(67108863&D)+(67108863&E);E>>=26,E+=D/67108864|0,E+=j>>>26,this.words[z]=67108863&j}return E!==0&&(this.words[z]=E,this.length++),this},r.prototype.muln=function(S){return this.clone().imuln(S)},r.prototype.sqr=function(){return this.mul(this)},r.prototype.isqr=function(){return this.imul(this.clone())},r.prototype.pow=function(S){var E=function(V){for(var Z=new Array(V.bitLength()),Q=0;Q<Z.length;Q++){var X=Q/26|0,$=Q%26;Z[Q]=(V.words[X]&1<<$)>>>$}return Z}(S);if(E.length===0)return new r(1);for(var z=this,D=0;D<E.length&&E[D]===0;D++,z=z.sqr());if(++D<E.length)for(var j=z.sqr();D<E.length;D++,j=j.sqr())E[D]!==0&&(z=z.mul(j));return z},r.prototype.iushln=function(S){n(typeof S=="number"&&S>=0);var E,z=S%26,D=(S-z)/26,j=67108863>>>26-z<<26-z;if(z!==0){var V=0;for(E=0;E<this.length;E++){var Z=this.words[E]&j,Q=(0|this.words[E])-Z<<z;this.words[E]=Q|V,V=Z>>>26-z}V&&(this.words[E]=V,this.length++)}if(D!==0){for(E=this.length-1;E>=0;E--)this.words[E+D]=this.words[E];for(E=0;E<D;E++)this.words[E]=0;this.length+=D}return this.strip()},r.prototype.ishln=function(S){return n(this.negative===0),this.iushln(S)},r.prototype.iushrn=function(S,E,z){var D;n(typeof S=="number"&&S>=0),D=E?(E-E%26)/26:0;var j=S%26,V=Math.min((S-j)/26,this.length),Z=67108863^67108863>>>j<<j,Q=z;if(D-=V,D=Math.max(0,D),Q){for(var X=0;X<V;X++)Q.words[X]=this.words[X];Q.length=V}if(V!==0)if(this.length>V)for(this.length-=V,X=0;X<this.length;X++)this.words[X]=this.words[X+V];else this.words[0]=0,this.length=1;var $=0;for(X=this.length-1;X>=0&&($!==0||X>=D);X--){var re=0|this.words[X];this.words[X]=$<<26-j|re>>>j,$=re&Z}return Q&&$!==0&&(Q.words[Q.length++]=$),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},r.prototype.ishrn=function(S,E,z){return n(this.negative===0),this.iushrn(S,E,z)},r.prototype.shln=function(S){return this.clone().ishln(S)},r.prototype.ushln=function(S){return this.clone().iushln(S)},r.prototype.shrn=function(S){return this.clone().ishrn(S)},r.prototype.ushrn=function(S){return this.clone().iushrn(S)},r.prototype.testn=function(S){n(typeof S=="number"&&S>=0);var E=S%26,z=(S-E)/26,D=1<<E;return!(this.length<=z)&&!!(this.words[z]&D)},r.prototype.imaskn=function(S){n(typeof S=="number"&&S>=0);var E=S%26,z=(S-E)/26;if(n(this.negative===0,"imaskn works only with positive numbers"),this.length<=z)return this;if(E!==0&&z++,this.length=Math.min(z,this.length),E!==0){var D=67108863^67108863>>>E<<E;this.words[this.length-1]&=D}return this.strip()},r.prototype.maskn=function(S){return this.clone().imaskn(S)},r.prototype.iaddn=function(S){return n(typeof S=="number"),n(S<67108864),S<0?this.isubn(-S):this.negative!==0?this.length===1&&(0|this.words[0])<S?(this.words[0]=S-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(S),this.negative=1,this):this._iaddn(S)},r.prototype._iaddn=function(S){this.words[0]+=S;for(var E=0;E<this.length&&this.words[E]>=67108864;E++)this.words[E]-=67108864,E===this.length-1?this.words[E+1]=1:this.words[E+1]++;return this.length=Math.max(this.length,E+1),this},r.prototype.isubn=function(S){if(n(typeof S=="number"),n(S<67108864),S<0)return this.iaddn(-S);if(this.negative!==0)return this.negative=0,this.iaddn(S),this.negative=1,this;if(this.words[0]-=S,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var E=0;E<this.length&&this.words[E]<0;E++)this.words[E]+=67108864,this.words[E+1]-=1;return this.strip()},r.prototype.addn=function(S){return this.clone().iaddn(S)},r.prototype.subn=function(S){return this.clone().isubn(S)},r.prototype.iabs=function(){return this.negative=0,this},r.prototype.abs=function(){return this.clone().iabs()},r.prototype._ishlnsubmul=function(S,E,z){var D,j,V=S.length+z;this._expand(V);var Z=0;for(D=0;D<S.length;D++){j=(0|this.words[D+z])+Z;var Q=(0|S.words[D])*E;Z=((j-=67108863&Q)>>26)-(Q/67108864|0),this.words[D+z]=67108863&j}for(;D<this.length-z;D++)Z=(j=(0|this.words[D+z])+Z)>>26,this.words[D+z]=67108863&j;if(Z===0)return this.strip();for(n(Z===-1),Z=0,D=0;D<this.length;D++)Z=(j=-(0|this.words[D])+Z)>>26,this.words[D]=67108863&j;return this.negative=1,this.strip()},r.prototype._wordDiv=function(S,E){var z=(this.length,S.length),D=this.clone(),j=S,V=0|j.words[j.length-1];(z=26-this._countBits(V))!==0&&(j=j.ushln(z),D.iushln(z),V=0|j.words[j.length-1]);var Z,Q=D.length-j.length;if(E!=="mod"){(Z=new r(null)).length=Q+1,Z.words=new Array(Z.length);for(var X=0;X<Z.length;X++)Z.words[X]=0}var $=D.clone()._ishlnsubmul(j,1,Q);$.negative===0&&(D=$,Z&&(Z.words[Q]=1));for(var re=Q-1;re>=0;re--){var H=67108864*(0|D.words[j.length+re])+(0|D.words[j.length+re-1]);for(H=Math.min(H/V|0,67108863),D._ishlnsubmul(j,H,re);D.negative!==0;)H--,D.negative=0,D._ishlnsubmul(j,1,re),D.isZero()||(D.negative^=1);Z&&(Z.words[re]=H)}return Z&&Z.strip(),D.strip(),E!=="div"&&z!==0&&D.iushrn(z),{div:Z||null,mod:D}},r.prototype.divmod=function(S,E,z){return n(!S.isZero()),this.isZero()?{div:new r(0),mod:new r(0)}:this.negative!==0&&S.negative===0?(V=this.neg().divmod(S,E),E!=="mod"&&(D=V.div.neg()),E!=="div"&&(j=V.mod.neg(),z&&j.negative!==0&&j.iadd(S)),{div:D,mod:j}):this.negative===0&&S.negative!==0?(V=this.divmod(S.neg(),E),E!=="mod"&&(D=V.div.neg()),{div:D,mod:V.mod}):(this.negative&S.negative)!=0?(V=this.neg().divmod(S.neg(),E),E!=="div"&&(j=V.mod.neg(),z&&j.negative!==0&&j.isub(S)),{div:V.div,mod:j}):S.length>this.length||this.cmp(S)<0?{div:new r(0),mod:this}:S.length===1?E==="div"?{div:this.divn(S.words[0]),mod:null}:E==="mod"?{div:null,mod:new r(this.modn(S.words[0]))}:{div:this.divn(S.words[0]),mod:new r(this.modn(S.words[0]))}:this._wordDiv(S,E);var D,j,V},r.prototype.div=function(S){return this.divmod(S,"div",!1).div},r.prototype.mod=function(S){return this.divmod(S,"mod",!1).mod},r.prototype.umod=function(S){return this.divmod(S,"mod",!0).mod},r.prototype.divRound=function(S){var E=this.divmod(S);if(E.mod.isZero())return E.div;var z=E.div.negative!==0?E.mod.isub(S):E.mod,D=S.ushrn(1),j=S.andln(1),V=z.cmp(D);return V<0||j===1&&V===0?E.div:E.div.negative!==0?E.div.isubn(1):E.div.iaddn(1)},r.prototype.modn=function(S){n(S<=67108863);for(var E=(1<<26)%S,z=0,D=this.length-1;D>=0;D--)z=(E*z+(0|this.words[D]))%S;return z},r.prototype.idivn=function(S){n(S<=67108863);for(var E=0,z=this.length-1;z>=0;z--){var D=(0|this.words[z])+67108864*E;this.words[z]=D/S|0,E=D%S}return this.strip()},r.prototype.divn=function(S){return this.clone().idivn(S)},r.prototype.egcd=function(S){n(S.negative===0),n(!S.isZero());var E=this,z=S.clone();E=E.negative!==0?E.umod(S):E.clone();for(var D=new r(1),j=new r(0),V=new r(0),Z=new r(1),Q=0;E.isEven()&&z.isEven();)E.iushrn(1),z.iushrn(1),++Q;for(var X=z.clone(),$=E.clone();!E.isZero();){for(var re=0,H=1;(E.words[0]&H)==0&&re<26;++re,H<<=1);if(re>0)for(E.iushrn(re);re-- >0;)(D.isOdd()||j.isOdd())&&(D.iadd(X),j.isub($)),D.iushrn(1),j.iushrn(1);for(var N=0,U=1;(z.words[0]&U)==0&&N<26;++N,U<<=1);if(N>0)for(z.iushrn(N);N-- >0;)(V.isOdd()||Z.isOdd())&&(V.iadd(X),Z.isub($)),V.iushrn(1),Z.iushrn(1);E.cmp(z)>=0?(E.isub(z),D.isub(V),j.isub(Z)):(z.isub(E),V.isub(D),Z.isub(j))}return{a:V,b:Z,gcd:z.iushln(Q)}},r.prototype._invmp=function(S){n(S.negative===0),n(!S.isZero());var E=this,z=S.clone();E=E.negative!==0?E.umod(S):E.clone();for(var D,j=new r(1),V=new r(0),Z=z.clone();E.cmpn(1)>0&&z.cmpn(1)>0;){for(var Q=0,X=1;(E.words[0]&X)==0&&Q<26;++Q,X<<=1);if(Q>0)for(E.iushrn(Q);Q-- >0;)j.isOdd()&&j.iadd(Z),j.iushrn(1);for(var $=0,re=1;(z.words[0]&re)==0&&$<26;++$,re<<=1);if($>0)for(z.iushrn($);$-- >0;)V.isOdd()&&V.iadd(Z),V.iushrn(1);E.cmp(z)>=0?(E.isub(z),j.isub(V)):(z.isub(E),V.isub(j))}return(D=E.cmpn(1)===0?j:V).cmpn(0)<0&&D.iadd(S),D},r.prototype.gcd=function(S){if(this.isZero())return S.abs();if(S.isZero())return this.abs();var E=this.clone(),z=S.clone();E.negative=0,z.negative=0;for(var D=0;E.isEven()&&z.isEven();D++)E.iushrn(1),z.iushrn(1);for(;;){for(;E.isEven();)E.iushrn(1);for(;z.isEven();)z.iushrn(1);var j=E.cmp(z);if(j<0){var V=E;E=z,z=V}else if(j===0||z.cmpn(1)===0)break;E.isub(z)}return z.iushln(D)},r.prototype.invm=function(S){return this.egcd(S).a.umod(S)},r.prototype.isEven=function(){return(1&this.words[0])==0},r.prototype.isOdd=function(){return(1&this.words[0])==1},r.prototype.andln=function(S){return this.words[0]&S},r.prototype.bincn=function(S){n(typeof S=="number");var E=S%26,z=(S-E)/26,D=1<<E;if(this.length<=z)return this._expand(z+1),this.words[z]|=D,this;for(var j=D,V=z;j!==0&&V<this.length;V++){var Z=0|this.words[V];j=(Z+=j)>>>26,Z&=67108863,this.words[V]=Z}return j!==0&&(this.words[V]=j,this.length++),this},r.prototype.isZero=function(){return this.length===1&&this.words[0]===0},r.prototype.cmpn=function(S){var E,z=S<0;if(this.negative!==0&&!z)return-1;if(this.negative===0&&z)return 1;if(this.strip(),this.length>1)E=1;else{z&&(S=-S),n(S<=67108863,"Number is too big");var D=0|this.words[0];E=D===S?0:D<S?-1:1}return this.negative!==0?0|-E:E},r.prototype.cmp=function(S){if(this.negative!==0&&S.negative===0)return-1;if(this.negative===0&&S.negative!==0)return 1;var E=this.ucmp(S);return this.negative!==0?0|-E:E},r.prototype.ucmp=function(S){if(this.length>S.length)return 1;if(this.length<S.length)return-1;for(var E=0,z=this.length-1;z>=0;z--){var D=0|this.words[z],j=0|S.words[z];if(D!==j){D<j?E=-1:D>j&&(E=1);break}}return E},r.prototype.gtn=function(S){return this.cmpn(S)===1},r.prototype.gt=function(S){return this.cmp(S)===1},r.prototype.gten=function(S){return this.cmpn(S)>=0},r.prototype.gte=function(S){return this.cmp(S)>=0},r.prototype.ltn=function(S){return this.cmpn(S)===-1},r.prototype.lt=function(S){return this.cmp(S)===-1},r.prototype.lten=function(S){return this.cmpn(S)<=0},r.prototype.lte=function(S){return this.cmp(S)<=0},r.prototype.eqn=function(S){return this.cmpn(S)===0},r.prototype.eq=function(S){return this.cmp(S)===0},r.red=function(S){return new I(S)},r.prototype.toRed=function(S){return n(!this.red,"Already a number in reduction context"),n(this.negative===0,"red works only with positives"),S.convertTo(this)._forceRed(S)},r.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},r.prototype._forceRed=function(S){return this.red=S,this},r.prototype.forceRed=function(S){return n(!this.red,"Already a number in reduction context"),this._forceRed(S)},r.prototype.redAdd=function(S){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,S)},r.prototype.redIAdd=function(S){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,S)},r.prototype.redSub=function(S){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,S)},r.prototype.redISub=function(S){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,S)},r.prototype.redShl=function(S){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,S)},r.prototype.redMul=function(S){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,S),this.red.mul(this,S)},r.prototype.redIMul=function(S){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,S),this.red.imul(this,S)},r.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},r.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},r.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},r.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},r.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},r.prototype.redPow=function(S){return n(this.red&&!S.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,S)};var _={k256:null,p224:null,p192:null,p25519:null};function b(S,E){this.name=S,this.p=new r(E,16),this.n=this.p.bitLength(),this.k=new r(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function T(){b.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function k(){b.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function L(){b.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function A(){b.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function I(S){if(typeof S=="string"){var E=r._prime(S);this.m=E.p,this.prime=E}else n(S.gtn(1),"modulus must be greater than 1"),this.m=S,this.prime=null}function P(S){I.call(this,S),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new r(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}b.prototype._tmp=function(){var S=new r(null);return S.words=new Array(Math.ceil(this.n/13)),S},b.prototype.ireduce=function(S){var E,z=S;do this.split(z,this.tmp),E=(z=(z=this.imulK(z)).iadd(this.tmp)).bitLength();while(E>this.n);var D=E<this.n?-1:z.ucmp(this.p);return D===0?(z.words[0]=0,z.length=1):D>0?z.isub(this.p):z.strip!==void 0?z.strip():z._strip(),z},b.prototype.split=function(S,E){S.iushrn(this.n,0,E)},b.prototype.imulK=function(S){return S.imul(this.k)},o(T,b),T.prototype.split=function(S,E){for(var z=Math.min(S.length,9),D=0;D<z;D++)E.words[D]=S.words[D];if(E.length=z,S.length<=9)return S.words[0]=0,void(S.length=1);var j=S.words[9];for(E.words[E.length++]=4194303&j,D=10;D<S.length;D++){var V=0|S.words[D];S.words[D-10]=(4194303&V)<<4|j>>>22,j=V}j>>>=22,S.words[D-10]=j,j===0&&S.length>10?S.length-=10:S.length-=9},T.prototype.imulK=function(S){S.words[S.length]=0,S.words[S.length+1]=0,S.length+=2;for(var E=0,z=0;z<S.length;z++){var D=0|S.words[z];E+=977*D,S.words[z]=67108863&E,E=64*D+(E/67108864|0)}return S.words[S.length-1]===0&&(S.length--,S.words[S.length-1]===0&&S.length--),S},o(k,b),o(L,b),o(A,b),A.prototype.imulK=function(S){for(var E=0,z=0;z<S.length;z++){var D=19*(0|S.words[z])+E,j=67108863&D;D>>>=26,S.words[z]=j,E=D}return E!==0&&(S.words[S.length++]=E),S},r._prime=function(S){if(_[S])return _[S];var E;if(S==="k256")E=new T;else if(S==="p224")E=new k;else if(S==="p192")E=new L;else{if(S!=="p25519")throw new Error("Unknown prime "+S);E=new A}return _[S]=E,E},I.prototype._verify1=function(S){n(S.negative===0,"red works only with positives"),n(S.red,"red works only with red numbers")},I.prototype._verify2=function(S,E){n((S.negative|E.negative)==0,"red works only with positives"),n(S.red&&S.red===E.red,"red works only with red numbers")},I.prototype.imod=function(S){return this.prime?this.prime.ireduce(S)._forceRed(this):S.umod(this.m)._forceRed(this)},I.prototype.neg=function(S){return S.isZero()?S.clone():this.m.sub(S)._forceRed(this)},I.prototype.add=function(S,E){this._verify2(S,E);var z=S.add(E);return z.cmp(this.m)>=0&&z.isub(this.m),z._forceRed(this)},I.prototype.iadd=function(S,E){this._verify2(S,E);var z=S.iadd(E);return z.cmp(this.m)>=0&&z.isub(this.m),z},I.prototype.sub=function(S,E){this._verify2(S,E);var z=S.sub(E);return z.cmpn(0)<0&&z.iadd(this.m),z._forceRed(this)},I.prototype.isub=function(S,E){this._verify2(S,E);var z=S.isub(E);return z.cmpn(0)<0&&z.iadd(this.m),z},I.prototype.shl=function(S,E){return this._verify1(S),this.imod(S.ushln(E))},I.prototype.imul=function(S,E){return this._verify2(S,E),this.imod(S.imul(E))},I.prototype.mul=function(S,E){return this._verify2(S,E),this.imod(S.mul(E))},I.prototype.isqr=function(S){return this.imul(S,S.clone())},I.prototype.sqr=function(S){return this.mul(S,S)},I.prototype.sqrt=function(S){if(S.isZero())return S.clone();var E=this.m.andln(3);if(n(E%2==1),E===3){var z=this.m.add(new r(1)).iushrn(2);return this.pow(S,z)}for(var D=this.m.subn(1),j=0;!D.isZero()&&D.andln(1)===0;)j++,D.iushrn(1);n(!D.isZero());var V=new r(1).toRed(this),Z=V.redNeg(),Q=this.m.subn(1).iushrn(1),X=this.m.bitLength();for(X=new r(2*X*X).toRed(this);this.pow(X,Q).cmp(Z)!==0;)X.redIAdd(Z);for(var $=this.pow(X,D),re=this.pow(S,D.addn(1).iushrn(1)),H=this.pow(S,D),N=j;H.cmp(V)!==0;){for(var U=H,te=0;U.cmp(V)!==0;te++)U=U.redSqr();n(te<N);var B=this.pow($,new r(1).iushln(N-te-1));re=re.redMul(B),$=B.redSqr(),H=H.redMul($),N=te}return re},I.prototype.invm=function(S){var E=S._invmp(this.m);return E.negative!==0?(E.negative=0,this.imod(E).redNeg()):this.imod(E)},I.prototype.pow=function(S,E){if(E.isZero())return new r(1).toRed(this);if(E.cmpn(1)===0)return S.clone();var z=new Array(16);z[0]=new r(1).toRed(this),z[1]=S;for(var D=2;D<z.length;D++)z[D]=this.mul(z[D-1],S);var j=z[0],V=0,Z=0,Q=E.bitLength()%26;for(Q===0&&(Q=26),D=E.length-1;D>=0;D--){for(var X=E.words[D],$=Q-1;$>=0;$--){var re=X>>$&1;j!==z[0]&&(j=this.sqr(j)),re!==0||V!==0?(V<<=1,V|=re,(++Z===4||D===0&&$===0)&&(j=this.mul(j,z[V]),Z=0,V=0)):Z=0}Q=26}return j},I.prototype.convertTo=function(S){var E=S.umod(this.m);return E===S?E.clone():E},I.prototype.convertFrom=function(S){var E=S.clone();return E.red=null,E},r.mont=function(S){return new P(S)},o(P,I),P.prototype.convertTo=function(S){return this.imod(S.ushln(this.shift))},P.prototype.convertFrom=function(S){var E=this.imod(S.mul(this.rinv));return E.red=null,E},P.prototype.imul=function(S,E){if(S.isZero()||E.isZero())return S.words[0]=0,S.length=1,S;var z=S.imul(E),D=z.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),j=z.isub(D).iushrn(this.shift),V=j;return j.cmp(this.m)>=0?V=j.isub(this.m):j.cmpn(0)<0&&(V=j.iadd(this.m)),V._forceRed(this)},P.prototype.mul=function(S,E){if(S.isZero()||E.isZero())return new r(0)._forceRed(this);var z=S.mul(E),D=z.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),j=z.isub(D).iushrn(this.shift),V=j;return j.cmp(this.m)>=0?V=j.isub(this.m):j.cmpn(0)<0&&(V=j.iadd(this.m)),V._forceRed(this)},P.prototype.invm=function(S){return this.imod(S._invmp(this.m).mul(this.r2))._forceRed(this)}})(w===void 0||w,this)},{buffer:2}],34:[function(v,w,y){w.exports=function(e){var t,n,o,r=e.length,g=0;for(t=0;t<r;++t)g+=e[t].length;var c=new Array(g),a=0;for(t=0;t<r;++t){var h=e[t],l=h.length;for(n=0;n<l;++n){var s=c[a++]=new Array(l-1),p=0;for(o=0;o<l;++o)o!==n&&(s[p++]=h[o]);if(1&n){var u=s[1];s[1]=s[0],s[0]=u}}}return c}},{}],35:[function(v,w,y){w.exports=function(s,p,u){switch(arguments.length){case 1:return h(s);case 2:return typeof p=="function"?c(s,s,p,!0):l(s,p);case 3:return c(s,p,u,!1);default:throw new Error("box-intersect: Invalid arguments")}};var e,t=v("typedarray-pool"),n=v("./lib/sweep"),o=v("./lib/intersect");function r(s,p){for(var u=0;u<s;++u)if(!(p[u]<=p[u+s]))return!0;return!1}function g(s,p,u,i){for(var x=0,f=0,_=0,b=s.length;_<b;++_){var T=s[_];if(!r(p,T)){for(var k=0;k<2*p;++k)u[x++]=T[k];i[f++]=_}}return f}function c(s,p,u,i){var x=s.length,f=p.length;if(!(x<=0||f<=0)){var _=s[0].length>>>1;if(!(_<=0)){var b,T=t.mallocDouble(2*_*x),k=t.mallocInt32(x);if((x=g(s,_,T,k))>0){if(_===1&&i)n.init(x),b=n.sweepComplete(_,u,0,x,T,k,0,x,T,k);else{var L=t.mallocDouble(2*_*f),A=t.mallocInt32(f);(f=g(p,_,L,A))>0&&(n.init(x+f),b=_===1?n.sweepBipartite(_,u,0,x,T,k,0,f,L,A):o(_,u,i,x,T,k,f,L,A),t.free(L),t.free(A))}t.free(T),t.free(k)}return b}}}function a(s,p){e.push([s,p])}function h(s){return e=[],c(s,s,a,!0),e}function l(s,p){return e=[],c(s,p,a,!1),e}},{"./lib/intersect":37,"./lib/sweep":41,"typedarray-pool":308}],36:[function(v,w,y){function e(t){return t?function(n,o,r,g,c,a,h,l,s,p,u){return c-g>s-l?function(i,x,f,_,b,T,k,L,A,I,P){for(var S=2*i,E=_,z=S*_;E<b;++E,z+=S){var D=T[x+z],j=T[x+z+i],V=k[E];e:for(var Z=L,Q=S*L;Z<A;++Z,Q+=S){var X=I[x+Q],$=I[x+Q+i],re=P[Z];if(!($<D||j<X)){for(var H=x+1;H<i;++H){var N=T[H+z],U=T[H+i+z],te=I[H+Q],B=I[H+i+Q];if(U<te||B<N)continue e}var K=f(V,re);if(K!==void 0)return K}}}}(n,o,r,g,c,a,h,l,s,p,u):function(i,x,f,_,b,T,k,L,A,I,P){for(var S=2*i,E=L,z=S*L;E<A;++E,z+=S){var D=I[x+z],j=I[x+z+i],V=P[E];e:for(var Z=_,Q=S*_;Z<b;++Z,Q+=S){var X=T[x+Q],$=T[x+Q+i],re=k[Z];if(!(j<X||$<D)){for(var H=x+1;H<i;++H){var N=T[H+Q],U=T[H+i+Q],te=I[H+z],B=I[H+i+z];if(U<te||B<N)continue e}var K=f(re,V);if(K!==void 0)return K}}}}(n,o,r,g,c,a,h,l,s,p,u)}:function(n,o,r,g,c,a,h,l,s,p,u,i){return a-c>p-s?g?function(x,f,_,b,T,k,L,A,I,P,S){for(var E=2*x,z=b,D=E*b;z<T;++z,D+=E){var j=k[f+D],V=k[f+D+x],Z=L[z];e:for(var Q=A,X=E*A;Q<I;++Q,X+=E){var $=P[f+X],re=S[Q];if(!($<=j||V<$)){for(var H=f+1;H<x;++H){var N=k[H+D],U=k[H+x+D],te=P[H+X],B=P[H+x+X];if(U<te||B<N)continue e}var K=_(re,Z);if(K!==void 0)return K}}}}(n,o,r,c,a,h,l,s,p,u,i):function(x,f,_,b,T,k,L,A,I,P,S){for(var E=2*x,z=b,D=E*b;z<T;++z,D+=E){var j=k[f+D],V=k[f+D+x],Z=L[z];e:for(var Q=A,X=E*A;Q<I;++Q,X+=E){var $=P[f+X],re=S[Q];if(!($<j||V<$)){for(var H=f+1;H<x;++H){var N=k[H+D],U=k[H+x+D],te=P[H+X],B=P[H+x+X];if(U<te||B<N)continue e}var K=_(Z,re);if(K!==void 0)return K}}}}(n,o,r,c,a,h,l,s,p,u,i):g?function(x,f,_,b,T,k,L,A,I,P,S){for(var E=2*x,z=A,D=E*A;z<I;++z,D+=E){var j=P[f+D],V=S[z];e:for(var Z=b,Q=E*b;Z<T;++Z,Q+=E){var X=k[f+Q],$=k[f+Q+x],re=L[Z];if(!(j<=X||$<j)){for(var H=f+1;H<x;++H){var N=k[H+Q],U=k[H+x+Q],te=P[H+D],B=P[H+x+D];if(U<te||B<N)continue e}var K=_(V,re);if(K!==void 0)return K}}}}(n,o,r,c,a,h,l,s,p,u,i):function(x,f,_,b,T,k,L,A,I,P,S){for(var E=2*x,z=A,D=E*A;z<I;++z,D+=E){var j=P[f+D],V=S[z];e:for(var Z=b,Q=E*b;Z<T;++Z,Q+=E){var X=k[f+Q],$=k[f+Q+x],re=L[Z];if(!(j<X||$<j)){for(var H=f+1;H<x;++H){var N=k[H+Q],U=k[H+x+Q],te=P[H+D],B=P[H+x+D];if(U<te||B<N)continue e}var K=_(re,V);if(K!==void 0)return K}}}}(n,o,r,c,a,h,l,s,p,u,i)}}y.partial=e(!1),y.full=e(!0)},{}],37:[function(v,w,y){w.exports=function(k,L,A,I,P,S,E,z,D){(function(Me,we){var de=8*t.log2(we+1)*(Me+1)|0,Ie=t.nextPow2(6*de);x.length<Ie&&(e.free(x),x=e.mallocInt32(Ie));var De=t.nextPow2(2*de);f.length<De&&(e.free(f),f=e.mallocDouble(De))})(k,I+E);var j,V=0,Z=2*k;for(_(V++,0,0,I,0,E,A?16:0,-1/0,1/0),A||_(V++,0,0,E,0,I,1,-1/0,1/0);V>0;){var Q=6*(V-=1),X=x[Q],$=x[Q+1],re=x[Q+2],H=x[Q+3],N=x[Q+4],U=x[Q+5],te=2*V,B=f[te],K=f[te+1],J=1&U,ee=!!(16&U),ne=P,se=S,oe=z,me=D;if(J&&(ne=z,se=D,oe=P,me=S),!(2&U&&(re=s(k,X,$,re,ne,se,K),$>=re)||4&U&&($=p(k,X,$,re,ne,se,B))>=re)){var ce=re-$,ye=N-H;if(ee){if(k*ce*(ce+ye)<1<<22){if((j=g.scanComplete(k,X,L,$,re,ne,se,H,N,oe,me))!==void 0)return j;continue}}else{if(k*Math.min(ce,ye)<128){if((j=o(k,X,L,J,$,re,ne,se,H,N,oe,me))!==void 0)return j;continue}if(k*ce*ye<1<<22){if((j=g.scanBipartite(k,X,L,J,$,re,ne,se,H,N,oe,me))!==void 0)return j;continue}}var Se=h(k,X,$,re,ne,se,B,K);if($<Se)if(k*(Se-$)<128){if((j=r(k,X+1,L,$,Se,ne,se,H,N,oe,me))!==void 0)return j}else if(X===k-2){if((j=J?g.sweepBipartite(k,L,H,N,oe,me,$,Se,ne,se):g.sweepBipartite(k,L,$,Se,ne,se,H,N,oe,me))!==void 0)return j}else _(V++,X+1,$,Se,H,N,J,-1/0,1/0),_(V++,X+1,H,N,$,Se,1^J,-1/0,1/0);if(Se<re){var fe=c(k,X,H,N,oe,me),ge=oe[Z*fe+X],Te=l(k,X,fe,N,oe,me,ge);if(Te<N&&_(V++,X,Se,re,Te,N,(4|J)+(ee?16:0),ge,K),H<fe&&_(V++,X,Se,re,H,fe,(2|J)+(ee?16:0),B,ge),fe+1===Te){if((j=ee?T(k,X,L,Se,re,ne,se,fe,oe,me[fe]):b(k,X,L,J,Se,re,ne,se,fe,oe,me[fe]))!==void 0)return j}else if(fe<Te){var le;if(ee){if(le=u(k,X,Se,re,ne,se,ge),Se<le){var ve=l(k,X,Se,le,ne,se,ge);if(X===k-2){if(Se<ve&&(j=g.sweepComplete(k,L,Se,ve,ne,se,fe,Te,oe,me))!==void 0||ve<le&&(j=g.sweepBipartite(k,L,ve,le,ne,se,fe,Te,oe,me))!==void 0)return j}else Se<ve&&_(V++,X+1,Se,ve,fe,Te,16,-1/0,1/0),ve<le&&(_(V++,X+1,ve,le,fe,Te,0,-1/0,1/0),_(V++,X+1,fe,Te,ve,le,1,-1/0,1/0))}}else le=J?i(k,X,Se,re,ne,se,ge):u(k,X,Se,re,ne,se,ge),Se<le&&(X===k-2?j=J?g.sweepBipartite(k,L,fe,Te,oe,me,Se,le,ne,se):g.sweepBipartite(k,L,Se,le,ne,se,fe,Te,oe,me):(_(V++,X+1,Se,le,fe,Te,J,-1/0,1/0),_(V++,X+1,fe,Te,Se,le,1^J,-1/0,1/0)))}}}}};var e=v("typedarray-pool"),t=v("bit-twiddle"),n=v("./brute"),o=n.partial,r=n.full,g=v("./sweep"),c=v("./median"),a=v("./partition"),h=a("!(lo>=p0)&&!(p1>=hi)"),l=a("lo===p0"),s=a("lo<p0"),p=a("hi<=p0"),u=a("lo<=p0&&p0<=hi"),i=a("lo<p0&&p0<=hi"),x=e.mallocInt32(1024),f=e.mallocDouble(1024);function _(k,L,A,I,P,S,E,z,D){var j=6*k;x[j]=L,x[j+1]=A,x[j+2]=I,x[j+3]=P,x[j+4]=S,x[j+5]=E;var V=2*k;f[V]=z,f[V+1]=D}function b(k,L,A,I,P,S,E,z,D,j,V){var Z=2*k,Q=D*Z,X=j[Q+L];e:for(var $=P,re=P*Z;$<S;++$,re+=Z){var H=E[re+L],N=E[re+L+k];if(!(X<H||N<X)&&(!I||X!==H)){for(var U,te=z[$],B=L+1;B<k;++B){H=E[re+B],N=E[re+B+k];var K=j[Q+B],J=j[Q+B+k];if(N<K||J<H)continue e}if((U=I?A(V,te):A(te,V))!==void 0)return U}}}function T(k,L,A,I,P,S,E,z,D,j){var V=2*k,Z=z*V,Q=D[Z+L];e:for(var X=I,$=I*V;X<P;++X,$+=V){var re=E[X];if(re!==j){var H=S[$+L],N=S[$+L+k];if(!(Q<H||N<Q)){for(var U=L+1;U<k;++U){H=S[$+U],N=S[$+U+k];var te=D[Z+U],B=D[Z+U+k];if(N<te||B<H)continue e}var K=A(re,j);if(K!==void 0)return K}}}}},{"./brute":36,"./median":38,"./partition":39,"./sweep":41,"bit-twiddle":32,"typedarray-pool":308}],38:[function(v,w,y){w.exports=function(n,o,r,g,c,a){if(g<=r+1)return r;for(var h=r,l=g,s=g+r>>>1,p=2*n,u=s,i=c[p*s+o];h<l;){if(l-h<8){t(n,o,h,l,c,a),i=c[p*s+o];break}var x=l-h,f=Math.random()*x+h|0,_=c[p*f+o],b=Math.random()*x+h|0,T=c[p*b+o],k=Math.random()*x+h|0,L=c[p*k+o];_<=T?L>=T?(u=b,i=T):_>=L?(u=f,i=_):(u=k,i=L):T>=L?(u=b,i=T):L>=_?(u=f,i=_):(u=k,i=L);for(var A=p*(l-1),I=p*u,P=0;P<p;++P,++A,++I){var S=c[A];c[A]=c[I],c[I]=S}var E=a[l-1];for(a[l-1]=a[u],a[u]=E,u=e(n,o,h,l-1,c,a,i),A=p*(l-1),I=p*u,P=0;P<p;++P,++A,++I)S=c[A],c[A]=c[I],c[I]=S;if(E=a[l-1],a[l-1]=a[u],a[u]=E,s<u){for(l=u-1;h<l&&c[p*(l-1)+o]===i;)l-=1;l+=1}else{if(!(u<s))break;for(h=u+1;h<l&&c[p*h+o]===i;)h+=1}}return e(n,o,r,s,c,a,c[p*s+o])};var e=v("./partition")("lo<p0");function t(n,o,r,g,c,a){for(var h=2*n,l=h*(r+1)+o,s=r+1;s<g;++s,l+=h)for(var p=c[l],u=s,i=h*(s-1);u>r&&c[i+o]>p;--u,i-=h){for(var x=i,f=i+h,_=0;_<h;++_,++x,++f){var b=c[x];c[x]=c[f],c[f]=b}var T=a[u];a[u]=a[u-1],a[u-1]=T}}},{"./partition":39}],39:[function(v,w,y){w.exports=function(t){return e[t]};var e={"lo===p0":function(t,n,o,r,g,c,a){for(var h=2*t,l=h*o,s=l,p=o,u=n,i=o;r>i;++i,l+=h)if(g[l+u]===a)if(p===i)p+=1,s+=h;else{for(var x=0;h>x;++x){var f=g[l+x];g[l+x]=g[s],g[s++]=f}var _=c[i];c[i]=c[p],c[p++]=_}return p},"lo<p0":function(t,n,o,r,g,c,a){for(var h=2*t,l=h*o,s=l,p=o,u=n,i=o;r>i;++i,l+=h)if(g[l+u]<a)if(p===i)p+=1,s+=h;else{for(var x=0;h>x;++x){var f=g[l+x];g[l+x]=g[s],g[s++]=f}var _=c[i];c[i]=c[p],c[p++]=_}return p},"lo<=p0":function(t,n,o,r,g,c,a){for(var h=2*t,l=h*o,s=l,p=o,u=t+n,i=o;r>i;++i,l+=h)if(g[l+u]<=a)if(p===i)p+=1,s+=h;else{for(var x=0;h>x;++x){var f=g[l+x];g[l+x]=g[s],g[s++]=f}var _=c[i];c[i]=c[p],c[p++]=_}return p},"hi<=p0":function(t,n,o,r,g,c,a){for(var h=2*t,l=h*o,s=l,p=o,u=t+n,i=o;r>i;++i,l+=h)if(g[l+u]<=a)if(p===i)p+=1,s+=h;else{for(var x=0;h>x;++x){var f=g[l+x];g[l+x]=g[s],g[s++]=f}var _=c[i];c[i]=c[p],c[p++]=_}return p},"lo<p0&&p0<=hi":function(t,n,o,r,g,c,a){for(var h=2*t,l=h*o,s=l,p=o,u=n,i=t+n,x=o;r>x;++x,l+=h){var f=g[l+u],_=g[l+i];if(f<a&&a<=_)if(p===x)p+=1,s+=h;else{for(var b=0;h>b;++b){var T=g[l+b];g[l+b]=g[s],g[s++]=T}var k=c[x];c[x]=c[p],c[p++]=k}}return p},"lo<=p0&&p0<=hi":function(t,n,o,r,g,c,a){for(var h=2*t,l=h*o,s=l,p=o,u=n,i=t+n,x=o;r>x;++x,l+=h){var f=g[l+u],_=g[l+i];if(f<=a&&a<=_)if(p===x)p+=1,s+=h;else{for(var b=0;h>b;++b){var T=g[l+b];g[l+b]=g[s],g[s++]=T}var k=c[x];c[x]=c[p],c[p++]=k}}return p},"!(lo>=p0)&&!(p1>=hi)":function(t,n,o,r,g,c,a,h){for(var l=2*t,s=l*o,p=s,u=o,i=n,x=t+n,f=o;r>f;++f,s+=l){var _=g[s+i],b=g[s+x];if(!(_>=a||h>=b))if(u===f)u+=1,p+=l;else{for(var T=0;l>T;++T){var k=g[s+T];g[s+T]=g[p],g[p++]=k}var L=c[f];c[f]=c[u],c[u++]=L}}return u}}},{}],40:[function(v,w,y){w.exports=function(a,h){h<=128?e(0,h-1,a):function l(s,p,u){var i=(p-s+1)/6|0,x=s+i,f=p-i,_=s+p>>1,b=_-i,T=_+i,k=x,L=b,A=_,I=T,P=f,S=s+1,E=p-1,z=0;g(k,L,u)&&(z=k,k=L,L=z),g(I,P,u)&&(z=I,I=P,P=z),g(k,A,u)&&(z=k,k=A,A=z),g(L,A,u)&&(z=L,L=A,A=z),g(k,I,u)&&(z=k,k=I,I=z),g(A,I,u)&&(z=A,A=I,I=z),g(L,P,u)&&(z=L,L=P,P=z),g(L,A,u)&&(z=L,L=A,A=z),g(I,P,u)&&(z=I,I=P,P=z);for(var D=u[2*L],j=u[2*L+1],V=u[2*I],Z=u[2*I+1],Q=2*k,X=2*A,$=2*P,re=2*x,H=2*_,N=2*f,U=0;U<2;++U){var te=u[Q+U],B=u[X+U],K=u[$+U];u[re+U]=te,u[H+U]=B,u[N+U]=K}n(b,s,u),n(T,p,u);for(var J=S;J<=E;++J)if(c(J,D,j,u))J!==S&&t(J,S,u),++S;else if(!c(J,V,Z,u))for(;;){if(c(E,V,Z,u)){c(E,D,j,u)?(o(J,S,E,u),++S,--E):(t(J,E,u),--E);break}if(--E<J)break}r(s,S-1,D,j,u),r(p,E+1,V,Z,u),S-2-s<=32?e(s,S-2,u):l(s,S-2,u),p-(E+2)<=32?e(E+2,p,u):l(E+2,p,u),E-S<=32?e(S,E,u):l(S,E,u)}(0,h-1,a)};function e(a,h,l){for(var s=2*(a+1),p=a+1;p<=h;++p){for(var u=l[s++],i=l[s++],x=p,f=s-2;x-- >a;){var _=l[f-2],b=l[f-1];if(_<u||_===u&&b<i)break;l[f]=_,l[f+1]=b,f-=2}l[f]=u,l[f+1]=i}}function t(a,h,l){h*=2;var s=l[a*=2],p=l[a+1];l[a]=l[h],l[a+1]=l[h+1],l[h]=s,l[h+1]=p}function n(a,h,l){h*=2,l[a*=2]=l[h],l[a+1]=l[h+1]}function o(a,h,l,s){h*=2,l*=2;var p=s[a*=2],u=s[a+1];s[a]=s[h],s[a+1]=s[h+1],s[h]=s[l],s[h+1]=s[l+1],s[l]=p,s[l+1]=u}function r(a,h,l,s,p){h*=2,p[a*=2]=p[h],p[h]=l,p[a+1]=p[h+1],p[h+1]=s}function g(a,h,l){h*=2;var s=l[a*=2],p=l[h];return!(s<p)&&(s!==p||l[a+1]>l[h+1])}function c(a,h,l,s){var p=s[a*=2];return p<h||p===h&&s[a+1]<l}},{}],41:[function(v,w,y){w.exports={init:function(u){var i=t.nextPow2(u);o.length<i&&(e.free(o),o=e.mallocInt32(i)),r.length<i&&(e.free(r),r=e.mallocInt32(i)),g.length<i&&(e.free(g),g=e.mallocInt32(i)),c.length<i&&(e.free(c),c=e.mallocInt32(i)),a.length<i&&(e.free(a),a=e.mallocInt32(i)),h.length<i&&(e.free(h),h=e.mallocInt32(i));var x=8*i;l.length<x&&(e.free(l),l=e.mallocDouble(x))},sweepBipartite:function(u,i,x,f,_,b,T,k,L,A){for(var I=0,P=2*u,S=u-1,E=P-1,z=x;z<f;++z){var D=b[z],j=P*z;l[I++]=_[j+S],l[I++]=-(D+1),l[I++]=_[j+E],l[I++]=D}for(z=T;z<k;++z){D=A[z]+(1<<28);var V=P*z;l[I++]=L[V+S],l[I++]=-D,l[I++]=L[V+E],l[I++]=D}var Z=I>>>1;n(l,Z);var Q=0,X=0;for(z=0;z<Z;++z){var $=0|l[2*z+1];if($>=1<<28)s(g,c,X--,$=$-(1<<28)|0);else if($>=0)s(o,r,Q--,$);else if($<=-(1<<28)){$=-$-(1<<28)|0;for(var re=0;re<Q;++re)if((H=i(o[re],$))!==void 0)return H;p(g,c,X++,$)}else{for($=-$-1|0,re=0;re<X;++re){var H;if((H=i($,g[re]))!==void 0)return H}p(o,r,Q++,$)}}},sweepComplete:function(u,i,x,f,_,b,T,k,L,A){for(var I=0,P=2*u,S=u-1,E=P-1,z=x;z<f;++z){var D=b[z]+1<<1,j=P*z;l[I++]=_[j+S],l[I++]=-D,l[I++]=_[j+E],l[I++]=D}for(z=T;z<k;++z){D=A[z]+1<<1;var V=P*z;l[I++]=L[V+S],l[I++]=1|-D,l[I++]=L[V+E],l[I++]=1|D}var Z=I>>>1;n(l,Z);var Q=0,X=0,$=0;for(z=0;z<Z;++z){var re=0|l[2*z+1],H=1&re;if(z<Z-1&&re>>1==l[2*z+3]>>1&&(H=2,z+=1),re<0){for(var N=-(re>>1)-1,U=0;U<$;++U)if((te=i(a[U],N))!==void 0)return te;if(H!==0){for(U=0;U<Q;++U)if((te=i(o[U],N))!==void 0)return te}if(H!==1)for(U=0;U<X;++U){var te;if((te=i(g[U],N))!==void 0)return te}H===0?p(o,r,Q++,N):H===1?p(g,c,X++,N):H===2&&p(a,h,$++,N)}else N=(re>>1)-1,H===0?s(o,r,Q--,N):H===1?s(g,c,X--,N):H===2&&s(a,h,$--,N)}},scanBipartite:function(u,i,x,f,_,b,T,k,L,A,I,P){var S=0,E=2*u,z=i,D=i+u,j=1,V=1;f?V=1<<28:j=1<<28;for(var Z=_;Z<b;++Z){var Q=Z+j,X=E*Z;l[S++]=T[X+z],l[S++]=-Q,l[S++]=T[X+D],l[S++]=Q}for(Z=L;Z<A;++Z){Q=Z+V;var $=E*Z;l[S++]=I[$+z],l[S++]=-Q}var re=S>>>1;n(l,re);var H=0;for(Z=0;Z<re;++Z){var N=0|l[2*Z+1];if(N<0){var U=!1;if((Q=-N)>=1<<28?(U=!f,Q-=1<<28):(U=!!f,Q-=1),U)p(o,r,H++,Q);else{var te=P[Q],B=E*Q,K=I[B+i+1],J=I[B+i+1+u];e:for(var ee=0;ee<H;++ee){var ne=o[ee],se=E*ne;if(!(J<T[se+i+1]||T[se+i+1+u]<K)){for(var oe=i+2;oe<u;++oe)if(I[B+oe+u]<T[se+oe]||T[se+oe+u]<I[B+oe])continue e;var me,ce=k[ne];if((me=f?x(te,ce):x(ce,te))!==void 0)return me}}}}else s(o,r,H--,N-j)}},scanComplete:function(u,i,x,f,_,b,T,k,L,A,I){for(var P=0,S=2*u,E=i,z=i+u,D=f;D<_;++D){var j=D+268435456,V=S*D;l[P++]=b[V+E],l[P++]=-j,l[P++]=b[V+z],l[P++]=j}for(D=k;D<L;++D){j=D+1;var Z=S*D;l[P++]=A[Z+E],l[P++]=-j}var Q=P>>>1;n(l,Q);var X=0;for(D=0;D<Q;++D){var $=0|l[2*D+1];if($<0)if((j=-$)>=1<<28)o[X++]=j-(1<<28);else{var re=I[j-=1],H=S*j,N=A[H+i+1],U=A[H+i+1+u];e:for(var te=0;te<X;++te){var B=o[te],K=T[B];if(K===re)break;var J=S*B;if(!(U<b[J+i+1]||b[J+i+1+u]<N)){for(var ee=i+2;ee<u;++ee)if(A[H+ee+u]<b[J+ee]||b[J+ee+u]<A[H+ee])continue e;var ne=x(K,re);if(ne!==void 0)return ne}}}else{for(j=$-(1<<28),te=X-1;te>=0;--te)if(o[te]===j){for(ee=te+1;ee<X;++ee)o[ee-1]=o[ee];break}--X}}}};var e=v("typedarray-pool"),t=v("bit-twiddle"),n=v("./sort"),o=e.mallocInt32(1024),r=e.mallocInt32(1024),g=e.mallocInt32(1024),c=e.mallocInt32(1024),a=e.mallocInt32(1024),h=e.mallocInt32(1024),l=e.mallocDouble(8192);function s(u,i,x,f){var _=i[f],b=u[x-1];u[_]=b,i[b]=_}function p(u,i,x,f){u[x]=f,i[f]=x}},{"./sort":40,"bit-twiddle":32,"typedarray-pool":308}],42:[function(v,w,y){var e=v("./lib/monotone"),t=v("./lib/triangulation"),n=v("./lib/delaunay"),o=v("./lib/filter");function r(a){return[Math.min(a[0],a[1]),Math.max(a[0],a[1])]}function g(a,h){return a[0]-h[0]||a[1]-h[1]}function c(a,h,l){return h in a?a[h]:l}w.exports=function(a,h,l){Array.isArray(h)?(l=l||{},h=h||[]):(l=h||{},h=[]);var s=!!c(l,"delaunay",!0),p=!!c(l,"interior",!0),u=!!c(l,"exterior",!0),i=!!c(l,"infinity",!1);if(!p&&!u||a.length===0)return[];var x=e(a,h);if(s||p!==u||i){for(var f=t(a.length,function(T){return T.map(r).sort(g)}(h)),_=0;_<x.length;++_){var b=x[_];f.addTriangle(b[0],b[1],b[2])}return s&&n(a,f),u?p?i?o(f,0,i):f.cells():o(f,1,i):o(f,-1)}return x}},{"./lib/delaunay":43,"./lib/filter":44,"./lib/monotone":45,"./lib/triangulation":46}],43:[function(v,w,y){var e=v("robust-in-sphere")[4];v("binary-search-bounds");function t(n,o,r,g,c,a){var h=o.opposite(g,c);if(!(h<0)){if(c<g){var l=g;g=c,c=l,l=a,a=h,h=l}o.isConstraint(g,c)||e(n[g],n[c],n[a],n[h])<0&&r.push(g,c)}}w.exports=function(n,o){for(var r=[],g=n.length,c=o.stars,a=0;a<g;++a)for(var h=c[a],l=1;l<h.length;l+=2)if(!((i=h[l])<a)&&!o.isConstraint(a,i)){for(var s=h[l-1],p=-1,u=1;u<h.length;u+=2)if(h[u-1]===i){p=h[u];break}p<0||e(n[a],n[i],n[s],n[p])<0&&r.push(a,i)}for(;r.length>0;){for(var i=r.pop(),x=(a=r.pop(),s=-1,p=-1,h=c[a],1);x<h.length;x+=2){var f=h[x-1],_=h[x];f===i?p=_:_===i&&(s=f)}s<0||p<0||e(n[a],n[i],n[s],n[p])>=0||(o.flip(a,i),t(n,o,r,s,a,p),t(n,o,r,a,p,s),t(n,o,r,p,i,s),t(n,o,r,i,s,p))}}},{"binary-search-bounds":31,"robust-in-sphere":282}],44:[function(v,w,y){var e,t=v("binary-search-bounds");function n(r,g,c,a,h,l,s){this.cells=r,this.neighbor=g,this.flags=a,this.constraint=c,this.active=h,this.next=l,this.boundary=s}function o(r,g){return r[0]-g[0]||r[1]-g[1]||r[2]-g[2]}w.exports=function(r,g,c){var a=function(L,A){for(var I=L.cells(),P=I.length,S=0;S<P;++S){var E=(H=I[S])[0],z=H[1],D=H[2];z<D?z<E&&(H[0]=z,H[1]=D,H[2]=E):D<E&&(H[0]=D,H[1]=E,H[2]=z)}I.sort(o);var j=new Array(P);for(S=0;S<j.length;++S)j[S]=0;var V=[],Z=[],Q=new Array(3*P),X=new Array(3*P),$=null;A&&($=[]);var re=new n(I,Q,X,j,V,Z,$);for(S=0;S<P;++S)for(var H=I[S],N=0;N<3;++N){E=H[N],z=H[(N+1)%3];var U=Q[3*S+N]=re.locate(z,E,L.opposite(z,E)),te=X[3*S+N]=L.isConstraint(E,z);U<0&&(te?Z.push(S):(V.push(S),j[S]=1),A&&$.push([z,E,-1]))}return re}(r,c);if(g===0)return c?a.cells.concat(a.boundary):a.cells;for(var h=1,l=a.active,s=a.next,p=a.flags,u=a.cells,i=a.constraint,x=a.neighbor;l.length>0||s.length>0;){for(;l.length>0;){var f=l.pop();if(p[f]!==-h){p[f]=h,u[f];for(var _=0;_<3;++_){var b=x[3*f+_];b>=0&&p[b]===0&&(i[3*f+_]?s.push(b):(l.push(b),p[b]=h))}}}var T=s;s=l,l=T,s.length=0,h=-h}var k=function(L,A,I){for(var P=0,S=0;S<L.length;++S)A[S]===I&&(L[P++]=L[S]);return L.length=P,L}(u,p,g);return c?k.concat(a.boundary):k},n.prototype.locate=(e=[0,0,0],function(r,g,c){var a=r,h=g,l=c;return g<c?g<r&&(a=g,h=c,l=r):c<r&&(a=c,h=r,l=g),a<0?-1:(e[0]=a,e[1]=h,e[2]=l,t.eq(this.cells,e,o))})},{"binary-search-bounds":31}],45:[function(v,w,y){var e=v("binary-search-bounds"),t=v("robust-orientation")[3];function n(s,p,u,i,x){this.a=s,this.b=p,this.idx=u,this.lowerIds=i,this.upperIds=x}function o(s,p,u,i){this.a=s,this.b=p,this.type=u,this.idx=i}function r(s,p){var u=s.a[0]-p.a[0]||s.a[1]-p.a[1]||s.type-p.type;return u||(s.type!==0&&(u=t(s.a,s.b,p.b))?u:s.idx-p.idx)}function g(s,p){return t(s.a,s.b,p)}function c(s,p,u,i,x){for(var f=e.lt(p,i,g),_=e.gt(p,i,g),b=f;b<_;++b){for(var T=p[b],k=T.lowerIds,L=k.length;L>1&&t(u[k[L-2]],u[k[L-1]],i)>0;)s.push([k[L-1],k[L-2],x]),L-=1;k.length=L,k.push(x);var A=T.upperIds;for(L=A.length;L>1&&t(u[A[L-2]],u[A[L-1]],i)<0;)s.push([A[L-2],A[L-1],x]),L-=1;A.length=L,A.push(x)}}function a(s,p){var u;return(u=s.a[0]<p.a[0]?t(s.a,s.b,p.a):t(p.b,p.a,s.a))?u:(u=p.b[0]<s.b[0]?t(s.a,s.b,p.b):t(p.b,p.a,s.b))||s.idx-p.idx}function h(s,p,u){var i=e.le(s,u,a),x=s[i],f=x.upperIds,_=f[f.length-1];x.upperIds=[_],s.splice(i+1,0,new n(u.a,u.b,u.idx,[_],f))}function l(s,p,u){var i=u.a;u.a=u.b,u.b=i;var x=e.eq(s,u,a),f=s[x];s[x-1].upperIds=f.upperIds,s.splice(x,1)}w.exports=function(s,p){for(var u=s.length,i=p.length,x=[],f=0;f<u;++f)x.push(new o(s[f],null,0,f));for(f=0;f<i;++f){var _=p[f],b=s[_[0]],T=s[_[1]];b[0]<T[0]?x.push(new o(b,T,2,f),new o(T,b,1,f)):b[0]>T[0]&&x.push(new o(T,b,2,f),new o(b,T,1,f))}x.sort(r);for(var k=x[0].a[0]-(1+Math.abs(x[0].a[0]))*Math.pow(2,-52),L=[new n([k,1],[k,0],-1,[],[])],A=[],I=(f=0,x.length);f<I;++f){var P=x[f],S=P.type;S===0?c(A,L,s,P.a,P.idx):S===2?h(L,s,P):l(L,s,P)}return A}},{"binary-search-bounds":31,"robust-orientation":284}],46:[function(v,w,y){var e=v("binary-search-bounds");function t(r,g){this.stars=r,this.edges=g}w.exports=function(r,g){for(var c=new Array(r),a=0;a<r;++a)c[a]=[];return new t(c,g)};var n=t.prototype;function o(r,g,c){for(var a=1,h=r.length;a<h;a+=2)if(r[a-1]===g&&r[a]===c)return r[a-1]=r[h-2],r[a]=r[h-1],void(r.length=h-2)}n.isConstraint=function(){var r=[0,0];function g(c,a){return c[0]-a[0]||c[1]-a[1]}return function(c,a){return r[0]=Math.min(c,a),r[1]=Math.max(c,a),e.eq(this.edges,r,g)>=0}}(),n.removeTriangle=function(r,g,c){var a=this.stars;o(a[r],g,c),o(a[g],c,r),o(a[c],r,g)},n.addTriangle=function(r,g,c){var a=this.stars;a[r].push(g,c),a[g].push(c,r),a[c].push(r,g)},n.opposite=function(r,g){for(var c=this.stars[g],a=1,h=c.length;a<h;a+=2)if(c[a]===r)return c[a-1];return-1},n.flip=function(r,g){var c=this.opposite(r,g),a=this.opposite(g,r);this.removeTriangle(r,g,c),this.removeTriangle(g,r,a),this.addTriangle(r,a,c),this.addTriangle(g,c,a)},n.edges=function(){for(var r=this.stars,g=[],c=0,a=r.length;c<a;++c)for(var h=r[c],l=0,s=h.length;l<s;l+=2)g.push([h[l],h[l+1]]);return g},n.cells=function(){for(var r=this.stars,g=[],c=0,a=r.length;c<a;++c)for(var h=r[c],l=0,s=h.length;l<s;l+=2){var p=h[l],u=h[l+1];c<Math.min(p,u)&&g.push([c,p,u])}return g}},{"binary-search-bounds":31}],47:[function(v,w,y){w.exports=function(e){for(var t=1,n=1;n<e.length;++n)for(var o=0;o<n;++o)if(e[n]<e[o])t=-t;else if(e[o]===e[n])return 0;return t}},{}],48:[function(v,w,y){var e=v("dup"),t=v("robust-linear-solve");function n(g,c){for(var a=0,h=g.length,l=0;l<h;++l)a+=g[l]*c[l];return a}function o(g){var c=g.length;if(c===0)return[];g[0].length;var a=e([g.length+1,g.length+1],1),h=e([g.length+1],1);a[c][c]=0;for(var l=0;l<c;++l){for(var s=0;s<=l;++s)a[s][l]=a[l][s]=2*n(g[l],g[s]);h[l]=n(g[l],g[l])}var p=t(a,h),u=0,i=p[c+1];for(l=0;l<i.length;++l)u+=i[l];var x=new Array(c);for(l=0;l<c;++l){i=p[l];var f=0;for(s=0;s<i.length;++s)f+=i[s];x[l]=f/u}return x}function r(g){if(g.length===0)return[];for(var c=g[0].length,a=e([c]),h=o(g),l=0;l<g.length;++l)for(var s=0;s<c;++s)a[s]+=g[l][s]*h[l];return a}r.barycenetric=o,w.exports=r},{dup:65,"robust-linear-solve":283}],49:[function(v,w,y){w.exports=function(t){for(var n=e(t),o=0,r=0;r<t.length;++r)for(var g=t[r],c=0;c<n.length;++c)o+=Math.pow(g[c]-n[c],2);return Math.sqrt(o/t.length)};var e=v("circumcenter")},{circumcenter:48}],50:[function(v,w,y){w.exports=function(_,b,T){var k;if(T){k=b;for(var L=new Array(b.length),A=0;A<b.length;++A){var I=b[A];L[A]=[I[0],I[1],T[A]]}b=L}for(var P=function(S,E,z){var D=p(S,[],s(S));return x(E,D,z),!!D}(_,b,!!T);f(_,b,!!T);)P=!0;if(T&&P)for(k.length=0,T.length=0,A=0;A<b.length;++A)I=b[A],k.push([I[0],I[1]]),T.push(I[2]);return P};var e=v("union-find"),t=v("box-intersect"),n=v("robust-segment-intersect"),o=v("big-rat"),r=v("big-rat/cmp"),g=v("big-rat/to-float"),c=v("rat-vec"),a=v("nextafter"),h=v("./lib/rat-seg-intersect");function l(_){var b=g(_);return[a(b,-1/0),a(b,1/0)]}function s(_){for(var b=new Array(_.length),T=0;T<_.length;++T){var k=_[T];b[T]=[a(k[0],-1/0),a(k[1],-1/0),a(k[0],1/0),a(k[1],1/0)]}return b}function p(_,b,T){for(var k=b.length,L=new e(k),A=[],I=0;I<b.length;++I){var P=b[I],S=l(P[0]),E=l(P[1]);A.push([a(S[0],-1/0),a(E[0],-1/0),a(S[1],1/0),a(E[1],1/0)])}t(A,function(Z,Q){L.link(Z,Q)});var z=!0,D=new Array(k);for(I=0;I<k;++I)(V=L.find(I))!==I&&(z=!1,_[V]=[Math.min(_[I][0],_[V][0]),Math.min(_[I][1],_[V][1])]);if(z)return null;var j=0;for(I=0;I<k;++I){var V;(V=L.find(I))===I?(D[I]=j,_[j++]=_[I]):D[I]=-1}for(_.length=j,I=0;I<k;++I)D[I]<0&&(D[I]=D[L.find(I)]);return D}function u(_,b){return _[0]-b[0]||_[1]-b[1]}function i(_,b){var T=_[0]-b[0]||_[1]-b[1];return T||(_[2]<b[2]?-1:_[2]>b[2]?1:0)}function x(_,b,T){if(_.length!==0){if(b)for(var k=0;k<_.length;++k){var L=b[(I=_[k])[0]],A=b[I[1]];I[0]=Math.min(L,A),I[1]=Math.max(L,A)}else for(k=0;k<_.length;++k){var I;L=(I=_[k])[0],A=I[1],I[0]=Math.min(L,A),I[1]=Math.max(L,A)}T?_.sort(i):_.sort(u);var P=1;for(k=1;k<_.length;++k){var S=_[k-1],E=_[k];(E[0]!==S[0]||E[1]!==S[1]||T&&E[2]!==S[2])&&(_[P++]=E)}_.length=P}}function f(_,b,T){var k=function(S,E){for(var z=new Array(E.length),D=0;D<E.length;++D){var j=E[D],V=S[j[0]],Z=S[j[1]];z[D]=[a(Math.min(V[0],Z[0]),-1/0),a(Math.min(V[1],Z[1]),-1/0),a(Math.max(V[0],Z[0]),1/0),a(Math.max(V[1],Z[1]),1/0)]}return z}(_,b),L=function(S,E,z){var D=[];return t(z,function(j,V){var Z=E[j],Q=E[V];if(Z[0]!==Q[0]&&Z[0]!==Q[1]&&Z[1]!==Q[0]&&Z[1]!==Q[1]){var X=S[Z[0]],$=S[Z[1]],re=S[Q[0]],H=S[Q[1]];n(X,$,re,H)&&D.push([j,V])}}),D}(_,b,k),A=s(_),I=function(S,E,z,D){var j=[];return t(z,D,function(V,Z){var Q=E[V];if(Q[0]!==Z&&Q[1]!==Z){var X=S[Z],$=S[Q[0]],re=S[Q[1]];n($,re,X,X)&&j.push([V,Z])}}),j}(_,b,k,A),P=p(_,function(S,E,z,D,j){var V,Z,Q=S.map(function(ye){return[o(ye[0]),o(ye[1])]});for(V=0;V<z.length;++V){var X=z[V];Z=X[0];var $=X[1],re=E[Z],H=E[$],N=h(c(S[re[0]]),c(S[re[1]]),c(S[H[0]]),c(S[H[1]]));if(N){var U=S.length;S.push([g(N[0]),g(N[1])]),Q.push(N),D.push([Z,U],[$,U])}}for(D.sort(function(ye,Se){if(ye[0]!==Se[0])return ye[0]-Se[0];var fe=Q[ye[1]],ge=Q[Se[1]];return r(fe[0],ge[0])||r(fe[1],ge[1])}),V=D.length-1;V>=0;--V){var te=E[Z=(me=D[V])[0]],B=te[0],K=te[1],J=S[B],ee=S[K];if((J[0]-ee[0]||J[1]-ee[1])<0){var ne=B;B=K,K=ne}te[0]=B;var se,oe=te[1]=me[1];for(j&&(se=te[2]);V>0&&D[V-1][0]===Z;){var me,ce=(me=D[--V])[1];j?E.push([oe,ce,se]):E.push([oe,ce]),oe=ce}j?E.push([oe,K,se]):E.push([oe,K])}return Q}(_,b,L,I,T));return x(b,P,T),!!P||L.length>0||I.length>0}},{"./lib/rat-seg-intersect":51,"big-rat":18,"big-rat/cmp":16,"big-rat/to-float":30,"box-intersect":35,nextafter:260,"rat-vec":273,"robust-segment-intersect":287,"union-find":309}],51:[function(v,w,y){w.exports=function(h,l,s,p){var u=r(l,h),i=r(p,s),x=a(u,i);if(o(x)===0)return null;var f=r(h,s),_=a(i,f),b=t(_,x),T=c(u,b);return g(h,T)};var e=v("big-rat/mul"),t=v("big-rat/div"),n=v("big-rat/sub"),o=v("big-rat/sign"),r=v("rat-vec/sub"),g=v("rat-vec/add"),c=v("rat-vec/muls");function a(h,l){return n(e(h[0],l[1]),e(h[1],l[0]))}},{"big-rat/div":17,"big-rat/mul":27,"big-rat/sign":28,"big-rat/sub":29,"rat-vec/add":272,"rat-vec/muls":274,"rat-vec/sub":275}],52:[function(v,w,y){w.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],53:[function(v,w,y){var e=v("./colorScale"),t=v("lerp");function n(g){return[g[0]/255,g[1]/255,g[2]/255,g[3]]}function o(g){for(var c,a="#",h=0;h<3;++h)a+=("00"+(c=(c=g[h]).toString(16))).substr(c.length);return a}function r(g){return"rgba("+g.join(",")+")"}w.exports=function(g){var c,a,h,l,s,p,u,i,x,f;if(g||(g={}),i=(g.nshades||72)-1,u=g.format||"hex",(p=g.colormap)||(p="jet"),typeof p=="string"){if(p=p.toLowerCase(),!e[p])throw Error(p+" not a supported colorscale");s=e[p]}else{if(!Array.isArray(p))throw Error("unsupported colormap option",p);s=p.slice()}if(s.length>i+1)throw new Error(p+" map requires nshades to be at least size "+s.length);x=Array.isArray(g.alpha)?g.alpha.length!==2?[1,1]:g.alpha.slice():typeof g.alpha=="number"?[g.alpha,g.alpha]:[1,1],c=s.map(function(L){return Math.round(L.index*i)}),x[0]=Math.min(Math.max(x[0],0),1),x[1]=Math.min(Math.max(x[1],0),1);var _=s.map(function(L,A){var I=s[A].index,P=s[A].rgb.slice();return P.length===4&&P[3]>=0&&P[3]<=1||(P[3]=x[0]+(x[1]-x[0])*I),P}),b=[];for(f=0;f<c.length-1;++f){l=c[f+1]-c[f],a=_[f],h=_[f+1];for(var T=0;T<l;T++){var k=T/l;b.push([Math.round(t(a[0],h[0],k)),Math.round(t(a[1],h[1],k)),Math.round(t(a[2],h[2],k)),t(a[3],h[3],k)])}}return b.push(s[s.length-1].rgb.concat(x[1])),u==="hex"?b=b.map(o):u==="rgbaString"?b=b.map(r):u==="float"&&(b=b.map(n)),b}},{"./colorScale":52,lerp:240}],54:[function(v,w,y){w.exports=function(c,a,h,l){var s=e(a,h,l);if(s===0){var p=t(e(c,a,h)),u=t(e(c,a,l));if(p===u){if(p===0){var i=g(c,a,h),x=g(c,a,l);return i===x?0:i?1:-1}return 0}return u===0?p>0||g(c,a,l)?-1:1:p===0?u>0||g(c,a,h)?1:-1:t(u-p)}var f=e(c,a,h);return f>0?s>0&&e(c,a,l)>0?1:-1:f<0?s>0||e(c,a,l)>0?1:-1:e(c,a,l)>0||g(c,a,h)?1:-1};var e=v("robust-orientation"),t=v("signum"),n=v("two-sum"),o=v("robust-product"),r=v("robust-sum");function g(c,a,h){var l=n(c[0],-a[0]),s=n(c[1],-a[1]),p=n(h[0],-a[0]),u=n(h[1],-a[1]),i=r(o(l,p),o(s,u));return i[i.length-1]>=0}},{"robust-orientation":284,"robust-product":285,"robust-sum":289,signum:55,"two-sum":307}],55:[function(v,w,y){w.exports=function(e){return e<0?-1:e>0?1:0}},{}],56:[function(v,w,y){w.exports=function(n,o){var r=n.length,g=n.length-o.length;if(g)return g;switch(r){case 0:return 0;case 1:return n[0]-o[0];case 2:return n[0]+n[1]-o[0]-o[1]||e(n[0],n[1])-e(o[0],o[1]);case 3:var c=n[0]+n[1],a=o[0]+o[1];if(g=c+n[2]-(a+o[2]))return g;var h=e(n[0],n[1]),l=e(o[0],o[1]);return e(h,n[2])-e(l,o[2])||e(h+n[2],c)-e(l+o[2],a);case 4:var s=n[0],p=n[1],u=n[2],i=n[3],x=o[0],f=o[1],_=o[2],b=o[3];return s+p+u+i-(x+f+_+b)||e(s,p,u,i)-e(x,f,_,b,x)||e(s+p,s+u,s+i,p+u,p+i,u+i)-e(x+f,x+_,x+b,f+_,f+b,_+b)||e(s+p+u,s+p+i,s+u+i,p+u+i)-e(x+f+_,x+f+b,x+_+b,f+_+b);default:for(var T=n.slice().sort(t),k=o.slice().sort(t),L=0;L<r;++L)if(g=T[L]-k[L])return g;return 0}};var e=Math.min;function t(n,o){return n-o}},{}],57:[function(v,w,y){var e=v("compare-cell"),t=v("cell-orientation");w.exports=function(n,o){return e(n,o)||t(n)-t(o)}},{"cell-orientation":47,"compare-cell":56}],58:[function(v,w,y){var e=v("./lib/ch1d"),t=v("./lib/ch2d"),n=v("./lib/chnd");w.exports=function(o){var r=o.length;if(r===0)return[];if(r===1)return[[0]];var g=o[0].length;return g===0?[]:g===1?e(o):g===2?t(o):n(o,g)}},{"./lib/ch1d":59,"./lib/ch2d":60,"./lib/chnd":61}],59:[function(v,w,y){w.exports=function(e){for(var t=0,n=0,o=1;o<e.length;++o)e[o][0]<e[t][0]&&(t=o),e[o][0]>e[n][0]&&(n=o);return t<n?[[t],[n]]:t>n?[[n],[t]]:[[t]]}},{}],60:[function(v,w,y){w.exports=function(t){var n=e(t),o=n.length;if(o<=2)return[];for(var r=new Array(o),g=n[o-1],c=0;c<o;++c){var a=n[c];r[c]=[g,a],g=a}return r};var e=v("monotone-convex-hull-2d")},{"monotone-convex-hull-2d":246}],61:[function(v,w,y){w.exports=function(n,o){try{return e(n,!0)}catch{var r=t(n);if(r.length<=o)return[];var g=function(a,h){for(var l=a.length,s=new Array(l),p=0;p<h.length;++p)s[p]=a[h[p]];var u=h.length;for(p=0;p<l;++p)h.indexOf(p)<0&&(s[u++]=a[p]);return s}(n,r);return function(a,h){for(var l=a.length,s=h.length,p=0;p<l;++p)for(var u=a[p],i=0;i<u.length;++i){var x=u[i];if(x<s)u[i]=h[x];else{x-=s;for(var f=0;f<s;++f)x>=h[f]&&(x+=1);u[i]=x}}return a}(e(g,!0),r)}};var e=v("incremental-convex-hull"),t=v("affine-hull")},{"affine-hull":10,"incremental-convex-hull":233}],62:[function(v,w,y){w.exports=function(e,t,n,o,r,g){var c=r-1,a=r*r,h=c*c,l=(1+2*r)*h,s=r*h,p=a*(3-2*r),u=a*c;if(e.length){g||(g=new Array(e.length));for(var i=e.length-1;i>=0;--i)g[i]=l*e[i]+s*t[i]+p*n[i]+u*o[i];return g}return l*e+s*t+p*n+u*o},w.exports.derivative=function(e,t,n,o,r,g){var c=6*r*r-6*r,a=3*r*r-4*r+1,h=-6*r*r+6*r,l=3*r*r-2*r;if(e.length){g||(g=new Array(e.length));for(var s=e.length-1;s>=0;--s)g[s]=c*e[s]+a*t[s]+h*n[s]+l*o[s];return g}return c*e+a*t+h*n[s]+l*o}},{}],63:[function(v,w,y){var e=v("incremental-convex-hull"),t=v("uniq");function n(r,g){this.point=r,this.index=g}function o(r,g){for(var c=r.point,a=g.point,h=c.length,l=0;l<h;++l){var s=a[l]-c[l];if(s)return s}return 0}w.exports=function(r,g){var c=r.length;if(c===0)return[];var a=r[0].length;if(a<1)return[];if(a===1)return function(I,P,S){if(I===1)return S?[[-1,0]]:[];var E=P.map(function(Z,Q){return[Z[0],Q]});E.sort(function(Z,Q){return Z[0]-Q[0]});for(var z=new Array(I-1),D=1;D<I;++D){var j=E[D-1],V=E[D];z[D-1]=[j[1],V[1]]}return S&&z.push([-1,z[0][1]],[z[I-1][1],-1]),z}(c,r,g);for(var h=new Array(c),l=1,s=0;s<c;++s){for(var p=r[s],u=new Array(a+1),i=0,x=0;x<a;++x){var f=p[x];u[x]=f,i+=f*f}u[a]=i,h[s]=new n(u,s),l=Math.max(i,l)}t(h,o),c=h.length;var _=new Array(c+a+1),b=new Array(c+a+1),T=(a+1)*(a+1)*l,k=new Array(a+1);for(s=0;s<=a;++s)k[s]=0;for(k[a]=T,_[0]=k.slice(),b[0]=-1,s=0;s<=a;++s)(u=k.slice())[s]=1,_[s+1]=u,b[s+1]=-1;for(s=0;s<c;++s){var L=h[s];_[s+a+1]=L.point,b[s+a+1]=L.index}var A=e(_,!1);if(A=g?A.filter(function(I){for(var P=0,S=0;S<=a;++S){var E=b[I[S]];if(E<0&&++P>=2)return!1;I[S]=E}return!0}):A.filter(function(I){for(var P=0;P<=a;++P){var S=b[I[P]];if(S<0)return!1;I[P]=S}return!0}),1&a)for(s=0;s<A.length;++s)u=(L=A[s])[0],L[0]=L[1],L[1]=u;return A}},{"incremental-convex-hull":233,uniq:310}],64:[function(v,w,y){(function(e){(function(){var t=!1;if(typeof Float64Array<"u"){var n=new Float64Array(1),o=new Uint32Array(n.buffer);n[0]=1,t=!0,o[1]===1072693248?(w.exports=function(g){return n[0]=g,[o[0],o[1]]},w.exports.pack=function(g,c){return o[0]=g,o[1]=c,n[0]},w.exports.lo=function(g){return n[0]=g,o[0]},w.exports.hi=function(g){return n[0]=g,o[1]}):o[0]===1072693248?(w.exports=function(g){return n[0]=g,[o[1],o[0]]},w.exports.pack=function(g,c){return o[1]=g,o[0]=c,n[0]},w.exports.lo=function(g){return n[0]=g,o[1]},w.exports.hi=function(g){return n[0]=g,o[0]}):t=!1}if(!t){var r=new e(8);w.exports=function(g){return r.writeDoubleLE(g,0,!0),[r.readUInt32LE(0,!0),r.readUInt32LE(4,!0)]},w.exports.pack=function(g,c){return r.writeUInt32LE(g,0,!0),r.writeUInt32LE(c,4,!0),r.readDoubleLE(0,!0)},w.exports.lo=function(g){return r.writeDoubleLE(g,0,!0),r.readUInt32LE(0,!0)},w.exports.hi=function(g){return r.writeDoubleLE(g,0,!0),r.readUInt32LE(4,!0)}}w.exports.sign=function(g){return w.exports.hi(g)>>>31},w.exports.exponent=function(g){return(w.exports.hi(g)<<1>>>21)-1023},w.exports.fraction=function(g){var c=w.exports.lo(g),a=w.exports.hi(g),h=1048575&a;return 2146435072&a&&(h+=1<<20),[c,h]},w.exports.denormalized=function(g){return!(2146435072&w.exports.hi(g))}}).call(this)}).call(this,v("buffer").Buffer)},{buffer:3}],65:[function(v,w,y){w.exports=function(e,t){switch(t===void 0&&(t=0),typeof e){case"number":if(e>0)return function(n,o){var r,g;for(r=new Array(n),g=0;g<n;++g)r[g]=o;return r}(0|e,t);break;case"object":if(typeof e.length=="number")return function n(o,r,g){var c=0|o[g];if(c<=0)return[];var a,h=new Array(c);if(g===o.length-1)for(a=0;a<c;++a)h[a]=r;else for(a=0;a<c;++a)h[a]=n(o,r,g+1);return h}(e,t,0)}return[]}},{}],66:[function(v,w,y){w.exports=function(t,n){var o=t.length;if(typeof n!="number"){n=0;for(var r=0;r<o;++r){var g=t[r];n=Math.max(n,g[0],g[1])}n=1+(0|n)}n|=0;var c=new Array(n);for(r=0;r<n;++r)c[r]=[];for(r=0;r<o;++r)g=t[r],c[g[0]].push(g[1]),c[g[1]].push(g[0]);for(var a=0;a<n;++a)e(c[a],function(h,l){return h-l});return c};var e=v("uniq")},{uniq:310}],67:[function(v,w,y){w.exports=function(e,t,n){var o=t||0,r=n||1;return[[e[12]+e[0],e[13]+e[1],e[14]+e[2],e[15]+e[3]],[e[12]-e[0],e[13]-e[1],e[14]-e[2],e[15]-e[3]],[e[12]+e[4],e[13]+e[5],e[14]+e[6],e[15]+e[7]],[e[12]-e[4],e[13]-e[5],e[14]-e[6],e[15]-e[7]],[o*e[12]+e[8],o*e[13]+e[9],o*e[14]+e[10],o*e[15]+e[11]],[r*e[12]-e[8],r*e[13]-e[9],r*e[14]-e[10],r*e[15]-e[11]]]}},{}],68:[function(v,w,y){w.exports=function(c,a,h){switch(arguments.length){case 0:return new o([0],[0],0);case 1:return typeof c=="number"?new o(l=g(c),l,0):new o(c,g(c.length),0);case 2:if(typeof a=="number"){var l=g(c.length);return new o(c,l,+a)}h=0;case 3:if(c.length!==a.length)throw new Error("state and velocity lengths must match");return new o(c,a,h)}};var e=v("cubic-hermite"),t=v("binary-search-bounds");function n(c,a,h){return Math.min(a,Math.max(c,h))}function o(c,a,h){this.dimension=c.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var l=0;l<this.dimension;++l)this.bounds[0][l]=-1/0,this.bounds[1][l]=1/0;this._state=c.slice().reverse(),this._velocity=a.slice().reverse(),this._time=[h],this._scratch=[c.slice(),c.slice(),c.slice(),c.slice(),c.slice()]}var r=o.prototype;function g(c){for(var a=new Array(c),h=0;h<c;++h)a[h]=0;return a}r.flush=function(c){var a=t.gt(this._time,c)-1;a<=0||(this._time.splice(0,a),this._state.splice(0,a*this.dimension),this._velocity.splice(0,a*this.dimension))},r.curve=function(c){var a=this._time,h=a.length,l=t.le(a,c),s=this._scratch[0],p=this._state,u=this._velocity,i=this.dimension,x=this.bounds;if(l<0)for(var f=i-1,_=0;_<i;++_,--f)s[_]=p[f];else if(l>=h-1){f=p.length-1;var b=c-a[h-1];for(_=0;_<i;++_,--f)s[_]=p[f]+b*u[f]}else{f=i*(l+1)-1;var T=a[l],k=a[l+1]-T||1,L=this._scratch[1],A=this._scratch[2],I=this._scratch[3],P=this._scratch[4],S=!0;for(_=0;_<i;++_,--f)L[_]=p[f],I[_]=u[f]*k,A[_]=p[f+i],P[_]=u[f+i]*k,S=S&&L[_]===A[_]&&I[_]===P[_]&&I[_]===0;if(S)for(_=0;_<i;++_)s[_]=L[_];else e(L,I,A,P,(c-T)/k,s)}var E=x[0],z=x[1];for(_=0;_<i;++_)s[_]=n(E[_],z[_],s[_]);return s},r.dcurve=function(c){var a=this._time,h=a.length,l=t.le(a,c),s=this._scratch[0],p=this._state,u=this._velocity,i=this.dimension;if(l>=h-1)for(var x=p.length-1,f=(a[h-1],0);f<i;++f,--x)s[f]=u[x];else{x=i*(l+1)-1;var _=a[l],b=a[l+1]-_||1,T=this._scratch[1],k=this._scratch[2],L=this._scratch[3],A=this._scratch[4],I=!0;for(f=0;f<i;++f,--x)T[f]=p[x],L[f]=u[x]*b,k[f]=p[x+i],A[f]=u[x+i]*b,I=I&&T[f]===k[f]&&L[f]===A[f]&&L[f]===0;if(I)for(f=0;f<i;++f)s[f]=0;else for(e.derivative(T,L,k,A,(c-_)/b,s),f=0;f<i;++f)s[f]/=b}return s},r.lastT=function(){var c=this._time;return c[c.length-1]},r.stable=function(){for(var c=this._velocity,a=c.length,h=this.dimension-1;h>=0;--h)if(c[--a])return!1;return!0},r.jump=function(c){var a=this.lastT(),h=this.dimension;if(!(c<a||arguments.length!==h+1)){var l=this._state,s=this._velocity,p=l.length-this.dimension,u=this.bounds,i=u[0],x=u[1];this._time.push(a,c);for(var f=0;f<2;++f)for(var _=0;_<h;++_)l.push(l[p++]),s.push(0);for(this._time.push(c),_=h;_>0;--_)l.push(n(i[_-1],x[_-1],arguments[_])),s.push(0)}},r.push=function(c){var a=this.lastT(),h=this.dimension;if(!(c<a||arguments.length!==h+1)){var l=this._state,s=this._velocity,p=l.length-this.dimension,u=c-a,i=this.bounds,x=i[0],f=i[1],_=u>1e-6?1/u:0;this._time.push(c);for(var b=h;b>0;--b){var T=n(x[b-1],f[b-1],arguments[b]);l.push(T),s.push((T-l[p++])*_)}}},r.set=function(c){var a=this.dimension;if(!(c<this.lastT()||arguments.length!==a+1)){var h=this._state,l=this._velocity,s=this.bounds,p=s[0],u=s[1];this._time.push(c);for(var i=a;i>0;--i)h.push(n(p[i-1],u[i-1],arguments[i])),l.push(0)}},r.move=function(c){var a=this.lastT(),h=this.dimension;if(!(c<=a||arguments.length!==h+1)){var l=this._state,s=this._velocity,p=l.length-this.dimension,u=this.bounds,i=u[0],x=u[1],f=c-a,_=f>1e-6?1/f:0;this._time.push(c);for(var b=h;b>0;--b){var T=arguments[b];l.push(n(i[b-1],x[b-1],l[p++]+T)),s.push(T*_)}}},r.idle=function(c){var a=this.lastT();if(!(c<a)){var h=this.dimension,l=this._state,s=this._velocity,p=l.length-h,u=this.bounds,i=u[0],x=u[1],f=c-a;this._time.push(c);for(var _=h-1;_>=0;--_)l.push(n(i[_],x[_],l[p]+f*s[p])),s.push(0),p+=1}}},{"binary-search-bounds":31,"cubic-hermite":62}],69:[function(v,w,y){w.exports=function(i){return new r(i||u,null)};function e(i,x,f,_,b,T){this._color=i,this.key=x,this.value=f,this.left=_,this.right=b,this._count=T}function t(i){return new e(i._color,i.key,i.value,i.left,i.right,i._count)}function n(i,x){return new e(i,x.key,x.value,x.left,x.right,x._count)}function o(i){i._count=1+(i.left?i.left._count:0)+(i.right?i.right._count:0)}function r(i,x){this._compare=i,this.root=x}var g=r.prototype;function c(i,x){var f;return x.left&&(f=c(i,x.left))?f:(f=i(x.key,x.value))||(x.right?c(i,x.right):void 0)}function a(i,x,f,_){if(x(i,_.key)<=0){var b;if(_.left&&(b=a(i,x,f,_.left))||(b=f(_.key,_.value)))return b}if(_.right)return a(i,x,f,_.right)}function h(i,x,f,_,b){var T,k=f(i,b.key),L=f(x,b.key);if(k<=0&&(b.left&&(T=h(i,x,f,_,b.left))||L>0&&(T=_(b.key,b.value))))return T;if(L>0&&b.right)return h(i,x,f,_,b.right)}function l(i,x){this.tree=i,this._stack=x}Object.defineProperty(g,"keys",{get:function(){var i=[];return this.forEach(function(x,f){i.push(x)}),i}}),Object.defineProperty(g,"values",{get:function(){var i=[];return this.forEach(function(x,f){i.push(f)}),i}}),Object.defineProperty(g,"length",{get:function(){return this.root?this.root._count:0}}),g.insert=function(i,x){for(var f=this._compare,_=this.root,b=[],T=[];_;){var k=f(i,_.key);b.push(_),T.push(k),_=k<=0?_.left:_.right}b.push(new e(0,i,x,null,null,1));for(var L=b.length-2;L>=0;--L)_=b[L],T[L]<=0?b[L]=new e(_._color,_.key,_.value,b[L+1],_.right,_._count+1):b[L]=new e(_._color,_.key,_.value,_.left,b[L+1],_._count+1);for(L=b.length-1;L>1;--L){var A=b[L-1];if(_=b[L],A._color===1||_._color===1)break;var I=b[L-2];if(I.left===A)if(A.left===_){if(!(P=I.right)||P._color!==0){I._color=0,I.left=A.right,A._color=1,A.right=I,b[L-2]=A,b[L-1]=_,o(I),o(A),L>=3&&((S=b[L-3]).left===I?S.left=A:S.right=A);break}A._color=1,I.right=n(1,P),I._color=0,L-=1}else{if(!(P=I.right)||P._color!==0){A.right=_.left,I._color=0,I.left=_.right,_._color=1,_.left=A,_.right=I,b[L-2]=_,b[L-1]=A,o(I),o(A),o(_),L>=3&&((S=b[L-3]).left===I?S.left=_:S.right=_);break}A._color=1,I.right=n(1,P),I._color=0,L-=1}else if(A.right===_){if(!(P=I.left)||P._color!==0){I._color=0,I.right=A.left,A._color=1,A.left=I,b[L-2]=A,b[L-1]=_,o(I),o(A),L>=3&&((S=b[L-3]).right===I?S.right=A:S.left=A);break}A._color=1,I.left=n(1,P),I._color=0,L-=1}else{var P;if(!(P=I.left)||P._color!==0){var S;A.left=_.right,I._color=0,I.right=_.left,_._color=1,_.right=A,_.left=I,b[L-2]=_,b[L-1]=A,o(I),o(A),o(_),L>=3&&((S=b[L-3]).right===I?S.right=_:S.left=_);break}A._color=1,I.left=n(1,P),I._color=0,L-=1}}return b[0]._color=1,new r(f,b[0])},g.forEach=function(i,x,f){if(this.root)switch(arguments.length){case 1:return c(i,this.root);case 2:return a(x,this._compare,i,this.root);case 3:return this._compare(x,f)>=0?void 0:h(x,f,this._compare,i,this.root)}},Object.defineProperty(g,"begin",{get:function(){for(var i=[],x=this.root;x;)i.push(x),x=x.left;return new l(this,i)}}),Object.defineProperty(g,"end",{get:function(){for(var i=[],x=this.root;x;)i.push(x),x=x.right;return new l(this,i)}}),g.at=function(i){if(i<0)return new l(this,[]);for(var x=this.root,f=[];;){if(f.push(x),x.left){if(i<x.left._count){x=x.left;continue}i-=x.left._count}if(!i)return new l(this,f);if(i-=1,!x.right||i>=x.right._count)break;x=x.right}return new l(this,[])},g.ge=function(i){for(var x=this._compare,f=this.root,_=[],b=0;f;){var T=x(i,f.key);_.push(f),T<=0&&(b=_.length),f=T<=0?f.left:f.right}return _.length=b,new l(this,_)},g.gt=function(i){for(var x=this._compare,f=this.root,_=[],b=0;f;){var T=x(i,f.key);_.push(f),T<0&&(b=_.length),f=T<0?f.left:f.right}return _.length=b,new l(this,_)},g.lt=function(i){for(var x=this._compare,f=this.root,_=[],b=0;f;){var T=x(i,f.key);_.push(f),T>0&&(b=_.length),f=T<=0?f.left:f.right}return _.length=b,new l(this,_)},g.le=function(i){for(var x=this._compare,f=this.root,_=[],b=0;f;){var T=x(i,f.key);_.push(f),T>=0&&(b=_.length),f=T<0?f.left:f.right}return _.length=b,new l(this,_)},g.find=function(i){for(var x=this._compare,f=this.root,_=[];f;){var b=x(i,f.key);if(_.push(f),b===0)return new l(this,_);f=b<=0?f.left:f.right}return new l(this,[])},g.remove=function(i){var x=this.find(i);return x?x.remove():this},g.get=function(i){for(var x=this._compare,f=this.root;f;){var _=x(i,f.key);if(_===0)return f.value;f=_<=0?f.left:f.right}};var s=l.prototype;function p(i,x){i.key=x.key,i.value=x.value,i.left=x.left,i.right=x.right,i._color=x._color,i._count=x._count}function u(i,x){return i<x?-1:i>x?1:0}Object.defineProperty(s,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(s,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),s.clone=function(){return new l(this.tree,this._stack.slice())},s.remove=function(){var i=this._stack;if(i.length===0)return this.tree;var x=new Array(i.length),f=i[i.length-1];x[x.length-1]=new e(f._color,f.key,f.value,f.left,f.right,f._count);for(var _=i.length-2;_>=0;--_)(f=i[_]).left===i[_+1]?x[_]=new e(f._color,f.key,f.value,x[_+1],f.right,f._count):x[_]=new e(f._color,f.key,f.value,f.left,x[_+1],f._count);if((f=x[x.length-1]).left&&f.right){var b=x.length;for(f=f.left;f.right;)x.push(f),f=f.right;var T=x[b-1];for(x.push(new e(f._color,T.key,T.value,f.left,f.right,f._count)),x[b-1].key=f.key,x[b-1].value=f.value,_=x.length-2;_>=b;--_)f=x[_],x[_]=new e(f._color,f.key,f.value,f.left,x[_+1],f._count);x[b-1].left=x[b]}if((f=x[x.length-1])._color===0){var k=x[x.length-2];for(k.left===f?k.left=null:k.right===f&&(k.right=null),x.pop(),_=0;_<x.length;++_)x[_]._count--;return new r(this.tree._compare,x[0])}if(f.left||f.right){for(f.left?p(f,f.left):f.right&&p(f,f.right),f._color=1,_=0;_<x.length-1;++_)x[_]._count--;return new r(this.tree._compare,x[0])}if(x.length===1)return new r(this.tree._compare,null);for(_=0;_<x.length;++_)x[_]._count--;var L=x[x.length-2];return function(A){for(var I,P,S,E,z=A.length-1;z>=0;--z){if(I=A[z],z===0)return void(I._color=1);if((P=A[z-1]).left===I){if((S=P.right).right&&S.right._color===0)return E=(S=P.right=t(S)).right=t(S.right),P.right=S.left,S.left=P,S.right=E,S._color=P._color,I._color=1,P._color=1,E._color=1,o(P),o(S),z>1&&((D=A[z-2]).left===P?D.left=S:D.right=S),void(A[z-1]=S);if(S.left&&S.left._color===0)return E=(S=P.right=t(S)).left=t(S.left),P.right=E.left,S.left=E.right,E.left=P,E.right=S,E._color=P._color,P._color=1,S._color=1,I._color=1,o(P),o(S),o(E),z>1&&((D=A[z-2]).left===P?D.left=E:D.right=E),void(A[z-1]=E);if(S._color===1){if(P._color===0)return P._color=1,void(P.right=n(0,S));P.right=n(0,S);continue}S=t(S),P.right=S.left,S.left=P,S._color=P._color,P._color=0,o(P),o(S),z>1&&((D=A[z-2]).left===P?D.left=S:D.right=S),A[z-1]=S,A[z]=P,z+1<A.length?A[z+1]=I:A.push(I),z+=2}else{if((S=P.left).left&&S.left._color===0)return E=(S=P.left=t(S)).left=t(S.left),P.left=S.right,S.right=P,S.left=E,S._color=P._color,I._color=1,P._color=1,E._color=1,o(P),o(S),z>1&&((D=A[z-2]).right===P?D.right=S:D.left=S),void(A[z-1]=S);if(S.right&&S.right._color===0)return E=(S=P.left=t(S)).right=t(S.right),P.left=E.right,S.right=E.left,E.right=P,E.left=S,E._color=P._color,P._color=1,S._color=1,I._color=1,o(P),o(S),o(E),z>1&&((D=A[z-2]).right===P?D.right=E:D.left=E),void(A[z-1]=E);if(S._color===1){if(P._color===0)return P._color=1,void(P.left=n(0,S));P.left=n(0,S);continue}var D;S=t(S),P.left=S.right,S.right=P,S._color=P._color,P._color=0,o(P),o(S),z>1&&((D=A[z-2]).right===P?D.right=S:D.left=S),A[z-1]=S,A[z]=P,z+1<A.length?A[z+1]=I:A.push(I),z+=2}}}(x),L.left===f?L.left=null:L.right=null,new r(this.tree._compare,x[0])},Object.defineProperty(s,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(s,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(s,"index",{get:function(){var i=0,x=this._stack;if(x.length===0){var f=this.tree.root;return f?f._count:0}x[x.length-1].left&&(i=x[x.length-1].left._count);for(var _=x.length-2;_>=0;--_)x[_+1]===x[_].right&&(++i,x[_].left&&(i+=x[_].left._count));return i},enumerable:!0}),s.next=function(){var i=this._stack;if(i.length!==0){var x=i[i.length-1];if(x.right)for(x=x.right;x;)i.push(x),x=x.left;else for(i.pop();i.length>0&&i[i.length-1].right===x;)x=i[i.length-1],i.pop()}},Object.defineProperty(s,"hasNext",{get:function(){var i=this._stack;if(i.length===0)return!1;if(i[i.length-1].right)return!0;for(var x=i.length-1;x>0;--x)if(i[x-1].left===i[x])return!0;return!1}}),s.update=function(i){var x=this._stack;if(x.length===0)throw new Error("Can't update empty node!");var f=new Array(x.length),_=x[x.length-1];f[f.length-1]=new e(_._color,_.key,i,_.left,_.right,_._count);for(var b=x.length-2;b>=0;--b)(_=x[b]).left===x[b+1]?f[b]=new e(_._color,_.key,_.value,f[b+1],_.right,_._count):f[b]=new e(_._color,_.key,_.value,_.left,f[b+1],_._count);return new r(this.tree._compare,f[0])},s.prev=function(){var i=this._stack;if(i.length!==0){var x=i[i.length-1];if(x.left)for(x=x.left;x;)i.push(x),x=x.right;else for(i.pop();i.length>0&&i[i.length-1].left===x;)x=i[i.length-1],i.pop()}},Object.defineProperty(s,"hasPrev",{get:function(){var i=this._stack;if(i.length===0)return!1;if(i[i.length-1].left)return!0;for(var x=i.length-1;x>0;--x)if(i[x-1].right===i[x])return!0;return!1}})},{}],70:[function(v,w,y){w.exports=function(b,T){var k=new a(b);return k.update(T),k};var e=v("./lib/text.js"),t=v("./lib/lines.js"),n=v("./lib/background.js"),o=v("./lib/cube.js"),r=v("./lib/ticks.js"),g=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function c(b,T){return b[0]=T[0],b[1]=T[1],b[2]=T[2],b}function a(b){this.gl=b,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=n(b)}var h=a.prototype;function l(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}h.update=function(b){function T(Z,Q,X){if(X in b){var $,re=b[X],H=this[X];(Z?Array.isArray(re)&&Array.isArray(re[0]):Array.isArray(re))?this[X]=$=[Q(re[0]),Q(re[1]),Q(re[2])]:this[X]=$=[Q(re),Q(re),Q(re)];for(var N=0;N<3;++N)if($[N]!==H[N])return!0}return!1}b=b||{};var k,L=T.bind(this,!1,Number),A=T.bind(this,!1,Boolean),I=T.bind(this,!1,String),P=T.bind(this,!0,function(Z){if(Array.isArray(Z)){if(Z.length===3)return[+Z[0],+Z[1],+Z[2],1];if(Z.length===4)return[+Z[0],+Z[1],+Z[2],+Z[3]]}return[0,0,0,1]}),S=!1,E=!1;if("bounds"in b)for(var z=b.bounds,D=0;D<2;++D)for(var j=0;j<3;++j)z[D][j]!==this.bounds[D][j]&&(E=!0),this.bounds[D][j]=z[D][j];if("ticks"in b)for(k=b.ticks,S=!0,this.autoTicks=!1,D=0;D<3;++D)this.tickSpacing[D]=0;else L("tickSpacing")&&(this.autoTicks=!0,E=!0);if(this._firstInit&&("ticks"in b||"tickSpacing"in b||(this.autoTicks=!0),E=!0,S=!0,this._firstInit=!1),E&&this.autoTicks&&(k=r.create(this.bounds,this.tickSpacing),S=!0),S){for(D=0;D<3;++D)k[D].sort(function(Z,Q){return Z.x-Q.x});r.equal(k,this.ticks)?S=!1:this.ticks=k}A("tickEnable"),I("tickFont")&&(S=!0),L("tickSize"),L("tickAngle"),L("tickPad"),P("tickColor");var V=I("labels");I("labelFont")&&(V=!0),A("labelEnable"),L("labelSize"),L("labelPad"),P("labelColor"),A("lineEnable"),A("lineMirror"),L("lineWidth"),P("lineColor"),A("lineTickEnable"),A("lineTickMirror"),L("lineTickLength"),L("lineTickWidth"),P("lineTickColor"),A("gridEnable"),L("gridWidth"),P("gridColor"),A("zeroEnable"),P("zeroLineColor"),L("zeroLineWidth"),A("backgroundEnable"),P("backgroundColor"),this._text?this._text&&(V||S)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=e(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&S&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=t(this.gl,this.bounds,this.ticks))};var s=[new l,new l,new l];function p(b,T,k,L,A){for(var I=b.primalOffset,P=b.primalMinor,S=b.mirrorOffset,E=b.mirrorMinor,z=L[T],D=0;D<3;++D)if(T!==D){var j=I,V=S,Z=P,Q=E;z&1<<D&&(j=S,V=I,Z=E,Q=P),j[D]=k[0][D],V[D]=k[1][D],A[D]>0?(Z[D]=-1,Q[D]=0):(Z[D]=0,Q[D]=1)}}var u=[0,0,0],i={model:g,view:g,projection:g,_ortho:!1};h.isOpaque=function(){return!0},h.isTransparent=function(){return!1},h.drawTransparent=function(b){};var x=[0,0,0],f=[0,0,0],_=[0,0,0];h.draw=function(b){b=b||i;for(var T=this.gl,k=b.model||g,L=b.view||g,A=b.projection||g,I=this.bounds,P=b._ortho||!1,S=o(k,L,A,I,P),E=S.cubeEdges,z=S.axis,D=L[12],j=L[13],V=L[14],Z=L[15],Q=(P?2:1)*this.pixelRatio*(A[3]*D+A[7]*j+A[11]*V+A[15]*Z)/T.drawingBufferHeight,X=0;X<3;++X)this.lastCubeProps.cubeEdges[X]=E[X],this.lastCubeProps.axis[X]=z[X];var $=s;for(X=0;X<3;++X)p(s[X],X,this.bounds,E,z);T=this.gl;var re,H=u;for(X=0;X<3;++X)this.backgroundEnable[X]?H[X]=z[X]:H[X]=0;for(this._background.draw(k,L,A,I,H,this.backgroundColor),this._lines.bind(k,L,A,this),X=0;X<3;++X){var N=[0,0,0];z[X]>0?N[X]=I[1][X]:N[X]=I[0][X];for(var U=0;U<2;++U){var te=(X+1+U)%3,B=(X+1+(1^U))%3;this.gridEnable[te]&&this._lines.drawGrid(te,B,this.bounds,N,this.gridColor[te],this.gridWidth[te]*this.pixelRatio)}for(U=0;U<2;++U)te=(X+1+U)%3,B=(X+1+(1^U))%3,this.zeroEnable[B]&&Math.min(I[0][B],I[1][B])<=0&&Math.max(I[0][B],I[1][B])>=0&&this._lines.drawZero(te,B,this.bounds,N,this.zeroLineColor[B],this.zeroLineWidth[B]*this.pixelRatio)}for(X=0;X<3;++X){this.lineEnable[X]&&this._lines.drawAxisLine(X,this.bounds,$[X].primalOffset,this.lineColor[X],this.lineWidth[X]*this.pixelRatio),this.lineMirror[X]&&this._lines.drawAxisLine(X,this.bounds,$[X].mirrorOffset,this.lineColor[X],this.lineWidth[X]*this.pixelRatio);var K=c(x,$[X].primalMinor),J=c(f,$[X].mirrorMinor),ee=this.lineTickLength;for(U=0;U<3;++U){var ne=Q/k[5*U];K[U]*=ee[U]*ne,J[U]*=ee[U]*ne}this.lineTickEnable[X]&&this._lines.drawAxisTicks(X,$[X].primalOffset,K,this.lineTickColor[X],this.lineTickWidth[X]*this.pixelRatio),this.lineTickMirror[X]&&this._lines.drawAxisTicks(X,$[X].mirrorOffset,J,this.lineTickColor[X],this.lineTickWidth[X]*this.pixelRatio)}this._lines.unbind(),this._text.bind(k,L,A,this.pixelRatio);var se,oe;function me(Te){(oe=[0,0,0])[Te]=1}function ce(Te,le,ve){var Me=(Te+1)%3,we=(Te+2)%3,de=le[Me],Ie=le[we],De=ve[Me],Oe=ve[we];de>0&&Oe>0||de>0&&Oe<0||de<0&&Oe>0||de<0&&Oe<0?me(Me):(Ie>0&&De>0||Ie>0&&De<0||Ie<0&&De>0||Ie<0&&De<0)&&me(we)}for(X=0;X<3;++X){var ye=$[X].primalMinor,Se=$[X].mirrorMinor,fe=c(_,$[X].primalOffset);for(U=0;U<3;++U)this.lineTickEnable[X]&&(fe[U]+=Q*ye[U]*Math.max(this.lineTickLength[U],0)/k[5*U]);var ge=[0,0,0];if(ge[X]=1,this.tickEnable[X]){for(this.tickAngle[X]===-3600?(this.tickAngle[X]=0,this.tickAlign[X]="auto"):this.tickAlign[X]=-1,se=1,(re=[this.tickAlign[X],.5,se])[0]==="auto"?re[0]=0:re[0]=parseInt(""+re[0]),oe=[0,0,0],ce(X,ye,Se),U=0;U<3;++U)fe[U]+=Q*ye[U]*this.tickPad[U]/k[5*U];this._text.drawTicks(X,this.tickSize[X],this.tickAngle[X],fe,this.tickColor[X],ge,oe,re)}if(this.labelEnable[X]){for(se=0,oe=[0,0,0],this.labels[X].length>4&&(me(X),se=1),(re=[this.labelAlign[X],.5,se])[0]==="auto"?re[0]=0:re[0]=parseInt(""+re[0]),U=0;U<3;++U)fe[U]+=Q*ye[U]*this.labelPad[U]/k[5*U];fe[X]+=.5*(I[0][X]+I[1][X]),this._text.drawLabel(X,this.labelSize[X],this.labelAngle[X],fe,this.labelColor[X],[0,0,0],oe,re)}}this._text.unbind()},h.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null}},{"./lib/background.js":71,"./lib/cube.js":72,"./lib/lines.js":73,"./lib/text.js":75,"./lib/ticks.js":76}],71:[function(v,w,y){w.exports=function(g){for(var c=[],a=[],h=0,l=0;l<3;++l)for(var s=(l+1)%3,p=(l+2)%3,u=[0,0,0],i=[0,0,0],x=-1;x<=1;x+=2){a.push(h,h+2,h+1,h+1,h+2,h+3),u[l]=x,i[l]=x;for(var f=-1;f<=1;f+=2){u[s]=f;for(var _=-1;_<=1;_+=2)u[p]=_,c.push(u[0],u[1],u[2],i[0],i[1],i[2]),h+=1}var b=s;s=p,p=b}var T=e(g,new Float32Array(c)),k=e(g,new Uint16Array(a),g.ELEMENT_ARRAY_BUFFER),L=t(g,[{buffer:T,type:g.FLOAT,size:3,offset:0,stride:24},{buffer:T,type:g.FLOAT,size:3,offset:12,stride:24}],k),A=n(g);return A.attributes.position.location=0,A.attributes.normal.location=1,new o(g,T,L,A)};var e=v("gl-buffer"),t=v("gl-vao"),n=v("./shaders").bg;function o(g,c,a,h){this.gl=g,this.buffer=c,this.vao=a,this.shader=h}var r=o.prototype;r.draw=function(g,c,a,h,l,s){for(var p=!1,u=0;u<3;++u)p=p||l[u];if(p){var i=this.gl;i.enable(i.POLYGON_OFFSET_FILL),i.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:g,view:c,projection:a,bounds:h,enable:l,colors:s},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),i.disable(i.POLYGON_OFFSET_FILL)}},r.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],72:[function(v,w,y){w.exports=function(f,_,b,T,k){t(r,_,f),t(r,b,r);for(var L=0,A=0;A<2;++A){a[2]=T[A][2];for(var I=0;I<2;++I){a[1]=T[I][1];for(var P=0;P<2;++P)a[0]=T[P][0],l(g[L],a,r),L+=1}}var S=-1;for(A=0;A<8;++A){for(var E=g[A][3],z=0;z<3;++z)c[A][z]=g[A][z]/E;k&&(c[A][2]*=-1),E<0&&(S<0||c[A][2]<c[S][2])&&(S=A)}if(S<0){S=0;for(var D=0;D<3;++D){for(var j=(D+2)%3,V=(D+1)%3,Z=-1,Q=-1,X=0;X<2;++X){var $=(H=X<<D)+(X<<j)+(1-X<<V),re=H+(1-X<<j)+(X<<V);o(c[H],c[$],c[re],h)<0||(X?Z=1:Q=1)}if(Z<0||Q<0)Q>Z&&(S|=1<<D);else{for(X=0;X<2;++X){$=(H=X<<D)+(X<<j)+(1-X<<V),re=H+(1-X<<j)+(X<<V);var H,N=p([g[H],g[$],g[re],g[H+(1<<j)+(1<<V)]]);X?Z=N:Q=N}Q>Z&&(S|=1<<D)}}}var U=7^S,te=-1;for(A=0;A<8;++A)A!==S&&A!==U&&(te<0||c[te][1]>c[A][1])&&(te=A);var B=-1;for(A=0;A<3;++A)(J=te^1<<A)!==S&&J!==U&&(B<0&&(B=J),(V=c[J])[0]<c[B][0]&&(B=J));var K=-1;for(A=0;A<3;++A){var J;(J=te^1<<A)!==S&&J!==U&&J!==B&&(K<0&&(K=J),(V=c[J])[0]>c[K][0]&&(K=J))}var ee=u;ee[0]=ee[1]=ee[2]=0,ee[e.log2(B^te)]=te&B,ee[e.log2(te^K)]=te&K;var ne=7^K;ne===S||ne===U?(ne=7^B,ee[e.log2(K^ne)]=ne&K):ee[e.log2(B^ne)]=ne&B;var se=i,oe=S;for(D=0;D<3;++D)se[D]=oe&1<<D?-1:1;return x};var e=v("bit-twiddle"),t=v("gl-mat4/multiply"),n=v("split-polygon"),o=v("robust-orientation"),r=new Array(16),g=new Array(8),c=new Array(8),a=new Array(3),h=[0,0,0];function l(f,_,b){for(var T=0;T<4;++T){f[T]=b[12+T];for(var k=0;k<3;++k)f[T]+=_[k]*b[4*k+T]}}(function(){for(var f=0;f<8;++f)g[f]=[1,1,1,1],c[f]=[1,1,1]})();var s=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function p(f){for(var _=0;_<s.length;++_)if((f=n.positive(f,s[_])).length<3)return 0;var b=f[0],T=b[0]/b[3],k=b[1]/b[3],L=0;for(_=1;_+1<f.length;++_){var A=f[_],I=f[_+1],P=A[0]/A[3]-T,S=A[1]/A[3]-k,E=I[0]/I[3]-T,z=I[1]/I[3]-k;L+=Math.abs(P*z-S*E)}return L}var u=[1,1,1],i=[0,0,0],x={cubeEdges:u,axis:i}},{"bit-twiddle":32,"gl-mat4/multiply":100,"robust-orientation":284,"split-polygon":300}],73:[function(v,w,y){w.exports=function(u,i,x){var f=[],_=[0,0,0],b=[0,0,0],T=[0,0,0],k=[0,0,0];f.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var L=0;L<3;++L){for(var A=f.length/3|0,I=0;I<x[L].length;++I){var P=+x[L][I].x;f.push(P,0,1,P,1,1,P,0,-1,P,0,-1,P,1,1,P,1,-1)}var S=f.length/3|0;_[L]=A,b[L]=S-A,A=f.length/3|0;for(var E=0;E<x[L].length;++E)P=+x[L][E].x,f.push(P,0,1,P,1,1,P,0,-1,P,0,-1,P,1,1,P,1,-1);S=f.length/3|0,T[L]=A,k[L]=S-A}var z=e(u,new Float32Array(f)),D=t(u,[{buffer:z,type:u.FLOAT,size:3,stride:0,offset:0}]),j=n(u);return j.attributes.position.location=0,new s(u,z,D,j,b,_,k,T)};var e=v("gl-buffer"),t=v("gl-vao"),n=v("./shaders").line,o=[0,0,0],r=[0,0,0],g=[0,0,0],c=[0,0,0],a=[1,1];function h(u){return u[0]=u[1]=u[2]=0,u}function l(u,i){return u[0]=i[0],u[1]=i[1],u[2]=i[2],u}function s(u,i,x,f,_,b,T,k){this.gl=u,this.vertBuffer=i,this.vao=x,this.shader=f,this.tickCount=_,this.tickOffset=b,this.gridCount=T,this.gridOffset=k}var p=s.prototype;p.bind=function(u,i,x){this.shader.bind(),this.shader.uniforms.model=u,this.shader.uniforms.view=i,this.shader.uniforms.projection=x,a[0]=this.gl.drawingBufferWidth,a[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=a,this.vao.bind()},p.unbind=function(){this.vao.unbind()},p.drawAxisLine=function(u,i,x,f,_){var b=h(r);this.shader.uniforms.majorAxis=r,b[u]=i[1][u]-i[0][u],this.shader.uniforms.minorAxis=b;var T,k=l(c,x);k[u]+=i[0][u],this.shader.uniforms.offset=k,this.shader.uniforms.lineWidth=_,this.shader.uniforms.color=f,(T=h(g))[(u+2)%3]=1,this.shader.uniforms.screenAxis=T,this.vao.draw(this.gl.TRIANGLES,6),(T=h(g))[(u+1)%3]=1,this.shader.uniforms.screenAxis=T,this.vao.draw(this.gl.TRIANGLES,6)},p.drawAxisTicks=function(u,i,x,f,_){if(this.tickCount[u]){var b=h(o);b[u]=1,this.shader.uniforms.majorAxis=b,this.shader.uniforms.offset=i,this.shader.uniforms.minorAxis=x,this.shader.uniforms.color=f,this.shader.uniforms.lineWidth=_;var T=h(g);T[u]=1,this.shader.uniforms.screenAxis=T,this.vao.draw(this.gl.TRIANGLES,this.tickCount[u],this.tickOffset[u])}},p.drawGrid=function(u,i,x,f,_,b){if(this.gridCount[u]){var T=h(r);T[i]=x[1][i]-x[0][i],this.shader.uniforms.minorAxis=T;var k=l(c,f);k[i]+=x[0][i],this.shader.uniforms.offset=k;var L=h(o);L[u]=1,this.shader.uniforms.majorAxis=L;var A=h(g);A[u]=1,this.shader.uniforms.screenAxis=A,this.shader.uniforms.lineWidth=b,this.shader.uniforms.color=_,this.vao.draw(this.gl.TRIANGLES,this.gridCount[u],this.gridOffset[u])}},p.drawZero=function(u,i,x,f,_,b){var T=h(r);this.shader.uniforms.majorAxis=T,T[u]=x[1][u]-x[0][u],this.shader.uniforms.minorAxis=T;var k=l(c,f);k[u]+=x[0][u],this.shader.uniforms.offset=k;var L=h(g);L[i]=1,this.shader.uniforms.screenAxis=L,this.shader.uniforms.lineWidth=b,this.shader.uniforms.color=_,this.vao.draw(this.gl.TRIANGLES,6)},p.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()}},{"./shaders":74,"gl-buffer":78,"gl-vao":150}],74:[function(v,w,y){var e=v("glslify"),t=v("gl-shader"),n=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, majorAxis, minorAxis, screenAxis;
uniform float lineWidth;
uniform vec2 screenShape;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

void main() {
  vec3 major = position.x * majorAxis;
  vec3 minor = position.y * minorAxis;

  vec3 vPosition = major + minor + offset;
  vec3 pPosition = project(vPosition);
  vec3 offset = project(vPosition + screenAxis * position.z);

  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;

  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);
}
`]),o=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);y.line=function(h){return t(h,n,o,null,[{name:"position",type:"vec3"}])};var r=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;
uniform vec3 offset, axis, alignDir, alignOpt;
uniform float scale, angle, pixelScale;
uniform vec2 resolution;

vec3 project(vec3 p) {
  vec4 pp = projection * view * model * vec4(p, 1.0);
  return pp.xyz / max(pp.w, 0.0001);
}

float computeViewAngle(vec3 a, vec3 b) {
  vec3 A = project(a);
  vec3 B = project(b);

  return atan(
    (B.y - A.y) * resolution.y,
    (B.x - A.x) * resolution.x
  );
}

const float PI = 3.141592;
const float TWO_PI = 2.0 * PI;
const float HALF_PI = 0.5 * PI;
const float ONE_AND_HALF_PI = 1.5 * PI;

int option = int(floor(alignOpt.x + 0.001));
float hv_ratio =       alignOpt.y;
bool enableAlign =    (alignOpt.z != 0.0);

float mod_angle(float a) {
  return mod(a, PI);
}

float positive_angle(float a) {
  return mod_angle((a < 0.0) ?
    a + TWO_PI :
    a
  );
}

float look_upwards(float a) {
  float b = positive_angle(a);
  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?
    b - PI :
    b;
}

float look_horizontal_or_vertical(float a, float ratio) {
  // ratio controls the ratio between being horizontal to (vertical + horizontal)
  // if ratio is set to 0.5 then it is 50%, 50%.
  // when using a higher ratio e.g. 0.75 the result would
  // likely be more horizontal than vertical.

  float b = positive_angle(a);

  return
    (b < (      ratio) * HALF_PI) ? 0.0 :
    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :
    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :
    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :
                                    0.0;
}

float roundTo(float a, float b) {
  return float(b * floor((a + 0.5 * b) / b));
}

float look_round_n_directions(float a, int n) {
  float b = positive_angle(a);
  float div = TWO_PI / float(n);
  float c = roundTo(b, div);
  return look_upwards(c);
}

float applyAlignOption(float rawAngle, float delta) {
  return
    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions
    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical
    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis
    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards
    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal
                    rawAngle;                // otherwise return back raw input angle
}

bool isAxisTitle = (axis.x == 0.0) &&
                   (axis.y == 0.0) &&
                   (axis.z == 0.0);

void main() {
  //Compute world offset
  float axisDistance = position.z;
  vec3 dataPosition = axisDistance * axis + offset;

  float beta = angle; // i.e. user defined attributes for each tick

  float axisAngle;
  float clipAngle;
  float flip;

  if (enableAlign) {
    axisAngle = (isAxisTitle) ? HALF_PI :
                      computeViewAngle(dataPosition, dataPosition + axis);
    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);

    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;
    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;

    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),
                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;

    beta += applyAlignOption(clipAngle, flip * PI);
  }

  //Compute plane offset
  vec2 planeCoord = position.xy * pixelScale;

  mat2 planeXform = scale * mat2(
     cos(beta), sin(beta),
    -sin(beta), cos(beta)
  );

  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;

  //Compute clip position
  vec3 clipPosition = project(dataPosition);

  //Apply text offset in clip coordinates
  clipPosition += vec3(viewOffset, 0.0);

  //Done
  gl_Position = vec4(clipPosition, 1.0);
}`]),g=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 color;
void main() {
  gl_FragColor = color;
}`]);y.text=function(h){return t(h,r,g,null,[{name:"position",type:"vec3"}])};var c=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec3 normal;

uniform mat4 model, view, projection;
uniform vec3 enable;
uniform vec3 bounds[2];

varying vec3 colorChannel;

void main() {

  vec3 signAxis = sign(bounds[1] - bounds[0]);

  vec3 realNormal = signAxis * normal;

  if(dot(realNormal, enable) > 0.0) {
    vec3 minRange = min(bounds[0], bounds[1]);
    vec3 maxRange = max(bounds[0], bounds[1]);
    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));
    gl_Position = projection * view * model * vec4(nPosition, 1.0);
  } else {
    gl_Position = vec4(0,0,0,0);
  }

  colorChannel = abs(realNormal);
}`]),a=e([`precision highp float;
#define GLSLIFY 1

uniform vec4 colors[3];

varying vec3 colorChannel;

void main() {
  gl_FragColor = colorChannel.x * colors[0] +
                 colorChannel.y * colors[1] +
                 colorChannel.z * colors[2];
}`]);y.bg=function(h){return t(h,c,a,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":132,glslify:231}],75:[function(v,w,y){(function(e){(function(){w.exports=function(s,p,u,i,x,f){var _=t(s),b=n(s,[{buffer:_,size:3}]),T=r(s);T.attributes.position.location=0;var k=new a(s,T,_,b);return k.update(p,u,i,x,f),k};var t=v("gl-buffer"),n=v("gl-vao"),o=v("vectorize-text"),r=v("./shaders").text,g=window||e.global||{},c=g.__TEXT_CACHE||{};g.__TEXT_CACHE={};function a(s,p,u,i){this.gl=s,this.shader=p,this.buffer=u,this.vao=i,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}var h=a.prototype,l=[0,0];h.bind=function(s,p,u,i){this.vao.bind(),this.shader.bind();var x=this.shader.uniforms;x.model=s,x.view=p,x.projection=u,x.pixelScale=i,l[0]=this.gl.drawingBufferWidth,l[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=l},h.unbind=function(){this.vao.unbind()},h.update=function(s,p,u,i,x){var f=[];function _(S,E,z,D,j,V){var Z=c[z];Z||(Z=c[z]={});var Q=Z[E];Q||(Q=Z[E]=function(K,J){try{return o(K,J)}catch(ee){return console.warn('error vectorizing text:"'+K+'" error:',ee),{cells:[],positions:[]}}}(E,{triangles:!0,font:z,textAlign:"center",textBaseline:"middle",lineSpacing:j,styletags:V}));for(var X=(D||12)/12,$=Q.positions,re=Q.cells,H=0,N=re.length;H<N;++H)for(var U=re[H],te=2;te>=0;--te){var B=$[U[te]];f.push(X*B[0],-X*B[1],S)}}for(var b=[0,0,0],T=[0,0,0],k=[0,0,0],L=[0,0,0],A={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},I=0;I<3;++I){k[I]=f.length/3|0,_(.5*(s[0][I]+s[1][I]),p[I],u[I],12,1.25,A),L[I]=(f.length/3|0)-k[I],b[I]=f.length/3|0;for(var P=0;P<i[I].length;++P)i[I][P].text&&_(i[I][P].x,i[I][P].text,i[I][P].font||x,i[I][P].fontSize||12,1.25,A);T[I]=(f.length/3|0)-b[I]}this.buffer.update(f),this.tickOffset=b,this.tickCount=T,this.labelOffset=k,this.labelCount=L},h.drawTicks=function(s,p,u,i,x,f,_,b){this.tickCount[s]&&(this.shader.uniforms.axis=f,this.shader.uniforms.color=x,this.shader.uniforms.angle=u,this.shader.uniforms.scale=p,this.shader.uniforms.offset=i,this.shader.uniforms.alignDir=_,this.shader.uniforms.alignOpt=b,this.vao.draw(this.gl.TRIANGLES,this.tickCount[s],this.tickOffset[s]))},h.drawLabel=function(s,p,u,i,x,f,_,b){this.labelCount[s]&&(this.shader.uniforms.axis=f,this.shader.uniforms.color=x,this.shader.uniforms.angle=u,this.shader.uniforms.scale=p,this.shader.uniforms.offset=i,this.shader.uniforms.alignDir=_,this.shader.uniforms.alignOpt=b,this.vao.draw(this.gl.TRIANGLES,this.labelCount[s],this.labelOffset[s]))},h.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()}}).call(this)}).call(this,v("_process"))},{"./shaders":74,_process:5,"gl-buffer":78,"gl-vao":150,"vectorize-text":311}],76:[function(v,w,y){function e(t,n){var o=t+"",r=o.indexOf("."),g=0;r>=0&&(g=o.length-r-1);var c=Math.pow(10,g),a=Math.round(t*n*c),h=a+"";if(h.indexOf("e")>=0)return h;var l=a/c,s=a%c;a<0?(l=0|-Math.ceil(l),s=0|-s):(l=0|Math.floor(l),s|=0);var p=""+l;if(a<0&&(p="-"+p),g){for(var u=""+s;u.length<g;)u="0"+u;return p+"."+u}return p}y.create=function(t,n){for(var o=[],r=0;r<3;++r){for(var g=[],c=(t[0][r],t[1][r],0);c*n[r]<=t[1][r];++c)g.push({x:c*n[r],text:e(n[r],c)});for(c=-1;c*n[r]>=t[0][r];--c)g.push({x:c*n[r],text:e(n[r],c)});o.push(g)}return o},y.equal=function(t,n){for(var o=0;o<3;++o){if(t[o].length!==n[o].length)return!1;for(var r=0;r<t[o].length;++r){var g=t[o][r],c=n[o][r];if(g.x!==c.x||g.text!==c.text||g.font!==c.font||g.fontColor!==c.fontColor||g.fontSize!==c.fontSize||g.dx!==c.dx||g.dy!==c.dy)return!1}}return!0}},{}],77:[function(v,w,y){w.exports=function(x,f,_,b,T){var k=f.model||c,L=f.view||c,A=f.projection||c,I=f._ortho||!1,P=x.bounds,S=(T=T||n(k,L,A,P,I)).axis;o(a,L,k),o(a,A,a);for(var E=u,z=0;z<3;++z)E[z].lo=1/0,E[z].hi=-1/0,E[z].pixelsPerDataUnit=1/0;var D=e(r(a,a));r(a,a);for(var j=0;j<3;++j){var V=(j+1)%3,Z=(j+2)%3,Q=i;e:for(z=0;z<2;++z){var X=[];if(S[j]<0!=!!z){Q[j]=P[z][j];for(var $=0;$<2;++$){Q[V]=P[$^z][V];for(var re=0;re<2;++re)Q[Z]=P[re^$^z][Z],X.push(Q.slice())}var H=I?5:4;for($=H;$===H;++$){if(X.length===0)continue e;X=t.positive(X,D[$])}for($=0;$<X.length;++$){Z=X[$];var N=p(i,a,Z,_,b);for(re=0;re<3;++re)E[re].lo=Math.min(E[re].lo,Z[re]),E[re].hi=Math.max(E[re].hi,Z[re]),re!==j&&(E[re].pixelsPerDataUnit=Math.min(E[re].pixelsPerDataUnit,Math.abs(N[re])))}}}}return E};var e=v("extract-frustum-planes"),t=v("split-polygon"),n=v("./lib/cube.js"),o=v("gl-mat4/multiply"),r=v("gl-mat4/transpose"),g=v("gl-vec4/transformMat4"),c=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),a=new Float32Array(16);function h(x,f,_){this.lo=x,this.hi=f,this.pixelsPerDataUnit=_}var l=[0,0,0,1],s=[0,0,0,1];function p(x,f,_,b,T){for(var k=0;k<3;++k){for(var L=l,A=s,I=0;I<3;++I)A[I]=L[I]=_[I];A[3]=L[3]=1,A[k]+=1,g(A,A,f),A[3]<0&&(x[k]=1/0),L[k]-=1,g(L,L,f),L[3]<0&&(x[k]=1/0);var P=(L[0]/L[3]-A[0]/A[3])*b,S=(L[1]/L[3]-A[1]/A[3])*T;x[k]=.25*Math.sqrt(P*P+S*S)}return x}var u=[new h(1/0,-1/0,1/0),new h(1/0,-1/0,1/0),new h(1/0,-1/0,1/0)],i=[0,0,0]},{"./lib/cube.js":72,"extract-frustum-planes":67,"gl-mat4/multiply":100,"gl-mat4/transpose":109,"gl-vec4/transformMat4":221,"split-polygon":300}],78:[function(v,w,y){var e=v("typedarray-pool"),t=v("ndarray-ops"),n=v("ndarray"),o=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function r(h,l,s,p,u){this.gl=h,this.type=l,this.handle=s,this.length=p,this.usage=u}var g=r.prototype;function c(h,l,s,p,u,i){var x=u.length*u.BYTES_PER_ELEMENT;if(i<0)return h.bufferData(l,u,p),x;if(x+i>s)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return h.bufferSubData(l,i,u),s}function a(h,l){for(var s=e.malloc(h.length,l),p=h.length,u=0;u<p;++u)s[u]=h[u];return s}g.bind=function(){this.gl.bindBuffer(this.type,this.handle)},g.unbind=function(){this.gl.bindBuffer(this.type,null)},g.dispose=function(){this.gl.deleteBuffer(this.handle)},g.update=function(h,l){if(typeof l!="number"&&(l=-1),this.bind(),typeof h=="object"&&h.shape!==void 0){var s=h.dtype;if(o.indexOf(s)<0&&(s="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER&&(s=gl.getExtension("OES_element_index_uint")&&s!=="uint16"?"uint32":"uint16"),s===h.dtype&&function(x,f){for(var _=1,b=f.length-1;b>=0;--b){if(f[b]!==_)return!1;_*=x[b]}return!0}(h.shape,h.stride))h.offset===0&&h.data.length===h.shape[0]?this.length=c(this.gl,this.type,this.length,this.usage,h.data,l):this.length=c(this.gl,this.type,this.length,this.usage,h.data.subarray(h.offset,h.shape[0]),l);else{var p=e.malloc(h.size,s),u=n(p,h.shape);t.assign(u,h),this.length=c(this.gl,this.type,this.length,this.usage,l<0?p:p.subarray(0,h.size),l),e.free(p)}}else if(Array.isArray(h)){var i;i=this.type===this.gl.ELEMENT_ARRAY_BUFFER?a(h,"uint16"):a(h,"float32"),this.length=c(this.gl,this.type,this.length,this.usage,l<0?i:i.subarray(0,h.length),l),e.free(i)}else if(typeof h=="object"&&typeof h.length=="number")this.length=c(this.gl,this.type,this.length,this.usage,h,l);else{if(typeof h!="number"&&h!==void 0)throw new Error("gl-buffer: Invalid data type");if(l>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");(h|=0)<=0&&(h=1),this.gl.bufferData(this.type,0|h,this.usage),this.length=h}},w.exports=function(h,l,s,p){if(s=s||h.ARRAY_BUFFER,p=p||h.DYNAMIC_DRAW,s!==h.ARRAY_BUFFER&&s!==h.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(p!==h.DYNAMIC_DRAW&&p!==h.STATIC_DRAW&&p!==h.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var u=h.createBuffer(),i=new r(h,s,u,0,p);return i.update(l),i}},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],79:[function(v,w,y){var e=v("gl-vec3");w.exports=function(n,o){var r=n.positions,g=n.vectors,c={positions:[],vertexIntensity:[],vertexIntensityBounds:n.vertexIntensityBounds,vectors:[],cells:[],coneOffset:n.coneOffset,colormap:n.colormap};if(n.positions.length===0)return o&&(o[0]=[0,0,0],o[1]=[0,0,0]),c;for(var a=0,h=1/0,l=-1/0,s=1/0,p=-1/0,u=1/0,i=-1/0,x=null,f=null,_=[],b=1/0,T=!1,k=0;k<r.length;k++){var L=r[k];h=Math.min(L[0],h),l=Math.max(L[0],l),s=Math.min(L[1],s),p=Math.max(L[1],p),u=Math.min(L[2],u),i=Math.max(L[2],i);var A=g[k];if(e.length(A)>a&&(a=e.length(A)),k){var I=2*e.distance(x,L)/(e.length(f)+e.length(A));I?(b=Math.min(b,I),T=!1):T=!0}T||(x=L,f=A),_.push(A)}var P=[h,s,u],S=[l,p,i];o&&(o[0]=P,o[1]=S),a===0&&(a=1);var E=1/a;isFinite(b)||(b=1),c.vectorScale=b;var z=n.coneSize||.5;n.absoluteConeSize&&(z=n.absoluteConeSize*E),c.coneScale=z,k=0;for(var D=0;k<r.length;k++)for(var j=(L=r[k])[0],V=L[1],Z=L[2],Q=_[k],X=e.length(Q)*E,$=0;$<8;$++){c.positions.push([j,V,Z,D++]),c.positions.push([j,V,Z,D++]),c.positions.push([j,V,Z,D++]),c.positions.push([j,V,Z,D++]),c.positions.push([j,V,Z,D++]),c.positions.push([j,V,Z,D++]),c.vectors.push(Q),c.vectors.push(Q),c.vectors.push(Q),c.vectors.push(Q),c.vectors.push(Q),c.vectors.push(Q),c.vertexIntensity.push(X,X,X),c.vertexIntensity.push(X,X,X);var re=c.positions.length;c.cells.push([re-6,re-5,re-4],[re-3,re-2,re-1])}return c};var t=v("./lib/shaders");w.exports.createMesh=v("./create_mesh"),w.exports.createConeMesh=function(n,o){return w.exports.createMesh(n,o,{shaders:t,traceType:"cone"})}},{"./create_mesh":80,"./lib/shaders":81,"gl-vec3":169}],80:[function(v,w,y){var e=v("gl-shader"),t=v("gl-buffer"),n=v("gl-vao"),o=v("gl-texture2d"),r=v("gl-mat4/multiply"),g=v("gl-mat4/invert"),c=v("ndarray"),a=v("colormap"),h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function l(i,x,f,_,b,T,k,L,A,I,P){this.gl=i,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=x,this.dirty=!0,this.triShader=f,this.pickShader=_,this.trianglePositions=b,this.triangleVectors=T,this.triangleColors=L,this.triangleUVs=A,this.triangleIds=k,this.triangleVAO=I,this.triangleCount=0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.traceType=P,this.tubeScale=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=.25,this._model=h,this._view=h,this._projection=h,this._resolution=[1,1]}var s=l.prototype;function p(i,x){var f=e(i,x.meshShader.vertex,x.meshShader.fragment,null,x.meshShader.attributes);return f.attributes.position.location=0,f.attributes.color.location=2,f.attributes.uv.location=3,f.attributes.vector.location=4,f}function u(i,x){var f=e(i,x.pickShader.vertex,x.pickShader.fragment,null,x.pickShader.attributes);return f.attributes.position.location=0,f.attributes.id.location=1,f.attributes.vector.location=4,f}s.isOpaque=function(){return this.opacity>=1},s.isTransparent=function(){return this.opacity<1},s.pickSlots=1,s.setPickBase=function(i){this.pickId=i},s.update=function(i){i=i||{};var x=this.gl;this.dirty=!0,"lightPosition"in i&&(this.lightPosition=i.lightPosition),"opacity"in i&&(this.opacity=i.opacity),"ambient"in i&&(this.ambientLight=i.ambient),"diffuse"in i&&(this.diffuseLight=i.diffuse),"specular"in i&&(this.specularLight=i.specular),"roughness"in i&&(this.roughness=i.roughness),"fresnel"in i&&(this.fresnel=i.fresnel),i.tubeScale!==void 0&&(this.tubeScale=i.tubeScale),i.vectorScale!==void 0&&(this.vectorScale=i.vectorScale),i.coneScale!==void 0&&(this.coneScale=i.coneScale),i.coneOffset!==void 0&&(this.coneOffset=i.coneOffset),i.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=x.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=x.LINEAR,this.texture.setPixels(function(te){for(var B=a({colormap:te,nshades:256,format:"rgba"}),K=new Uint8Array(1024),J=0;J<256;++J){for(var ee=B[J],ne=0;ne<3;++ne)K[4*J+ne]=ee[ne];K[4*J+3]=255*ee[3]}return c(K,[256,256,4],[4,0,1])}(i.colormap)),this.texture.generateMipmap());var f=i.cells,_=i.positions,b=i.vectors;if(_&&f&&b){var T=[],k=[],L=[],A=[],I=[];this.cells=f,this.positions=_,this.vectors=b;var P=i.meshColor||[1,1,1,1],S=i.vertexIntensity,E=1/0,z=-1/0;if(S)if(i.vertexIntensityBounds)E=+i.vertexIntensityBounds[0],z=+i.vertexIntensityBounds[1];else for(var D=0;D<S.length;++D){var j=S[D];E=Math.min(E,j),z=Math.max(z,j)}else for(D=0;D<_.length;++D)j=_[D][2],E=Math.min(E,j),z=Math.max(z,j);for(this.intensity=S||function(te){for(var B=te.length,K=new Array(B),J=0;J<B;++J)K[J]=te[J][2];return K}(_),this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],D=0;D<_.length;++D)for(var V=_[D],Z=0;Z<3;++Z)!isNaN(V[Z])&&isFinite(V[Z])&&(this.bounds[0][Z]=Math.min(this.bounds[0][Z],V[Z]),this.bounds[1][Z]=Math.max(this.bounds[1][Z],V[Z]));var Q=0;e:for(D=0;D<f.length;++D){var X=f[D];switch(X.length){case 3:for(Z=0;Z<3;++Z){V=_[re=X[Z]];for(var $=0;$<3;++$)if(isNaN(V[$])||!isFinite(V[$]))continue e}for(Z=0;Z<3;++Z){var re;V=_[re=X[2-Z]],T.push(V[0],V[1],V[2],V[3]);var H=b[re];k.push(H[0],H[1],H[2],H[3]||0);var N,U=P;U.length===3?L.push(U[0],U[1],U[2],1):L.push(U[0],U[1],U[2],U[3]),N=S?[(S[re]-E)/(z-E),0]:[(V[2]-E)/(z-E),0],A.push(N[0],N[1]),I.push(D)}Q+=1}}this.triangleCount=Q,this.trianglePositions.update(T),this.triangleVectors.update(k),this.triangleColors.update(L),this.triangleUVs.update(A),this.triangleIds.update(new Uint32Array(I))}},s.drawTransparent=s.draw=function(i){i=i||{};for(var x=this.gl,f=i.model||h,_=i.view||h,b=i.projection||h,T=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],k=0;k<3;++k)T[0][k]=Math.max(T[0][k],this.clipBounds[0][k]),T[1][k]=Math.min(T[1][k],this.clipBounds[1][k]);var L={model:f,view:_,projection:b,inverseModel:h.slice(),clipBounds:T,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};L.inverseModel=g(L.inverseModel,L.model),x.disable(x.CULL_FACE),this.texture.bind(0);var A=new Array(16);for(r(A,L.view,L.model),r(A,L.projection,A),g(A,A),k=0;k<3;++k)L.eyePosition[k]=A[12+k]/A[15];var I=A[15];for(k=0;k<3;++k)I+=this.lightPosition[k]*A[4*k+3];for(k=0;k<3;++k){for(var P=A[12+k],S=0;S<3;++S)P+=A[4*S+k]*this.lightPosition[S];L.lightPosition[k]=P/I}if(this.triangleCount>0){var E=this.triShader;E.bind(),E.uniforms=L,this.triangleVAO.bind(),x.drawArrays(x.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}},s.drawPick=function(i){i=i||{};for(var x=this.gl,f=i.model||h,_=i.view||h,b=i.projection||h,T=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],k=0;k<3;++k)T[0][k]=Math.max(T[0][k],this.clipBounds[0][k]),T[1][k]=Math.min(T[1][k],this.clipBounds[1][k]);this._model=[].slice.call(f),this._view=[].slice.call(_),this._projection=[].slice.call(b),this._resolution=[x.drawingBufferWidth,x.drawingBufferHeight];var L={model:f,view:_,projection:b,clipBounds:T,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},A=this.pickShader;A.bind(),A.uniforms=L,this.triangleCount>0&&(this.triangleVAO.bind(),x.drawArrays(x.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind())},s.pick=function(i){if(!i||i.id!==this.pickId)return null;var x=i.value[0]+256*i.value[1]+65536*i.value[2],f=this.cells[x],_=this.positions[f[1]].slice(0,3),b={position:_,dataCoordinate:_,index:Math.floor(f[1]/48)};return this.traceType==="cone"?b.index=Math.floor(f[1]/48):this.traceType==="streamtube"&&(b.intensity=this.intensity[f[1]],b.velocity=this.vectors[f[1]].slice(0,3),b.divergence=this.vectors[f[1]][3],b.index=x),b},s.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleIds.dispose()},w.exports=function(i,x,f){var _=f.shaders;arguments.length===1&&(i=(x=i).gl);var b=p(i,_),T=u(i,_),k=o(i,c(new Uint8Array([255,255,255,255]),[1,1,4]));k.generateMipmap(),k.minFilter=i.LINEAR_MIPMAP_LINEAR,k.magFilter=i.LINEAR;var L=t(i),A=t(i),I=t(i),P=t(i),S=t(i),E=n(i,[{buffer:L,type:i.FLOAT,size:4},{buffer:S,type:i.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:I,type:i.FLOAT,size:4},{buffer:P,type:i.FLOAT,size:2},{buffer:A,type:i.FLOAT,size:4}]),z=new l(i,k,b,T,L,A,S,I,P,E,f.traceType||"cone");return z.update(x),z}},{colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259}],81:[function(v,w,y){var e=v("glslify"),t=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec3 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, coneScale, coneOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * conePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(conePosition, 1.0);
  vec4 t_position  = view * conePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = conePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),n=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),o=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the cone vertex and normal at the given index.
//
// The returned vertex is for a cone with its top at origin and height of 1.0,
// pointing in the direction of the vector attribute.
//
// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.
// These vertices are used to make up the triangles of the cone by the following:
//   segment + 0 top vertex
//   segment + 1 perimeter vertex a+1
//   segment + 2 perimeter vertex a
//   segment + 3 center base vertex
//   segment + 4 perimeter vertex a
//   segment + 5 perimeter vertex a+1
// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.
// To go from index to segment, floor(index / 6)
// To go from segment to angle, 2*pi * (segment/segmentCount)
// To go from index to segment index, index - (segment*6)
//
vec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {

  const float segmentCount = 8.0;

  float index = rawIndex - floor(rawIndex /
    (segmentCount * 6.0)) *
    (segmentCount * 6.0);

  float segment = floor(0.001 + index/6.0);
  float segmentIndex = index - (segment*6.0);

  normal = -normalize(d);

  if (segmentIndex > 2.99 && segmentIndex < 3.01) {
    return mix(vec3(0.0), -d, coneOffset);
  }

  float nextAngle = (
    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||
    (segmentIndex > 4.99 &&  segmentIndex < 5.01)
  ) ? 1.0 : 0.0;
  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);

  vec3 v1 = mix(d, vec3(0.0), coneOffset);
  vec3 v2 = v1 - d;

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d)*0.25;
  vec3 y = v * sin(angle) * length(d)*0.25;
  vec3 v3 = v2 + x + y;
  if (segmentIndex < 3.0) {
    vec3 tx = u * sin(angle);
    vec3 ty = v * -cos(angle);
    vec3 tangent = tx + ty;
    normal = normalize(cross(v3 - v1, tangent));
  }

  if (segmentIndex == 0.0) {
    return mix(d, vec3(0.0), coneOffset);
  }
  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float vectorScale, coneScale, coneOffset;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);
  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);
  gl_Position = projection * view * conePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);y.meshShader={vertex:t,fragment:n,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},y.pickShader={vertex:o,fragment:r,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:231}],82:[function(v,w,y){w.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],83:[function(v,w,y){var e=v("./1.0/numbers");w.exports=function(t){return e[t]}},{"./1.0/numbers":82}],84:[function(v,w,y){w.exports=function(l){var s=l.gl,p=e(s),u=t(s,[{buffer:p,type:s.FLOAT,size:3,offset:0,stride:40},{buffer:p,type:s.FLOAT,size:4,offset:12,stride:40},{buffer:p,type:s.FLOAT,size:3,offset:28,stride:40}]),i=n(s);i.attributes.position.location=0,i.attributes.color.location=1,i.attributes.offset.location=2;var x=new r(s,p,u,i);return x.update(l),x};var e=v("gl-buffer"),t=v("gl-vao"),n=v("./shaders/index"),o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function r(l,s,p,u){this.gl=l,this.shader=u,this.buffer=s,this.vao=p,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}var g=r.prototype;function c(l,s){for(var p=0;p<3;++p)l[0][p]=Math.min(l[0][p],s[p]),l[1][p]=Math.max(l[1][p],s[p])}g.isOpaque=function(){return!this.hasAlpha},g.isTransparent=function(){return this.hasAlpha},g.drawTransparent=g.draw=function(l){var s=this.gl,p=this.shader.uniforms;this.shader.bind();var u=p.view=l.view||o,i=p.projection=l.projection||o;p.model=l.model||o,p.clipBounds=this.clipBounds,p.opacity=this.opacity;var x=u[12],f=u[13],_=u[14],b=u[15],T=(l._ortho?2:1)*this.pixelRatio*(i[3]*x+i[7]*f+i[11]*_+i[15]*b)/s.drawingBufferHeight;this.vao.bind();for(var k=0;k<3;++k)s.lineWidth(this.lineWidth[k]*this.pixelRatio),p.capSize=this.capSize[k]*T,this.lineCount[k]&&s.drawArrays(s.LINES,this.lineOffset[k],this.lineCount[k]);this.vao.unbind()};var a=function(){for(var l=new Array(3),s=0;s<3;++s){for(var p=[],u=1;u<=2;++u)for(var i=-1;i<=1;i+=2){var x=[0,0,0];x[(u+s)%3]=i,p.push(x)}l[s]=p}return l}();function h(l,s,p,u){for(var i=a[u],x=0;x<i.length;++x){var f=i[x];l.push(s[0],s[1],s[2],p[0],p[1],p[2],p[3],f[0],f[1],f[2])}return i.length}g.update=function(l){"lineWidth"in(l=l||{})&&(this.lineWidth=l.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in l&&(this.capSize=l.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in l&&(this.opacity=+l.opacity,this.opacity<1&&(this.hasAlpha=!0));var s=l.color||[[0,0,0],[0,0,0],[0,0,0]],p=l.position,u=l.error;if(Array.isArray(s[0])||(s=[s,s,s]),p&&u){var i=[],x=p.length,f=0;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.lineCount=[0,0,0];for(var _=0;_<3;++_){this.lineOffset[_]=f;e:for(var b=0;b<x;++b){for(var T=p[b],k=0;k<3;++k)if(isNaN(T[k])||!isFinite(T[k]))continue e;var L=u[b],A=s[_];if(Array.isArray(A[0])&&(A=s[b]),A.length===3?A=[A[0],A[1],A[2],1]:A.length===4&&(A=[A[0],A[1],A[2],A[3]],!this.hasAlpha&&A[3]<1&&(this.hasAlpha=!0)),!isNaN(L[0][_])&&!isNaN(L[1][_])){var I;L[0][_]<0&&((I=T.slice())[_]+=L[0][_],i.push(T[0],T[1],T[2],A[0],A[1],A[2],A[3],0,0,0,I[0],I[1],I[2],A[0],A[1],A[2],A[3],0,0,0),c(this.bounds,I),f+=2+h(i,I,A,_)),L[1][_]>0&&((I=T.slice())[_]+=L[1][_],i.push(T[0],T[1],T[2],A[0],A[1],A[2],A[3],0,0,0,I[0],I[1],I[2],A[0],A[1],A[2],A[3],0,0,0),c(this.bounds,I),f+=2+h(i,I,A,_))}}this.lineCount[_]=f-this.lineOffset[_]}this.buffer.update(i)}},g.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()}},{"./shaders/index":85,"gl-buffer":78,"gl-vao":150}],85:[function(v,w,y){var e=v("glslify"),t=v("gl-shader"),n=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, offset;
attribute vec4 color;
uniform mat4 model, view, projection;
uniform float capSize;
varying vec4 fragColor;
varying vec3 fragPosition;

void main() {
  vec4 worldPosition  = model * vec4(position, 1.0);
  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);
  gl_Position         = projection * view * worldPosition;
  fragColor           = color;
  fragPosition        = position;
}`]),o=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float opacity;
varying vec3 fragPosition;
varying vec4 fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  gl_FragColor = opacity * fragColor;
}`]);w.exports=function(r){return t(r,n,o,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":132,glslify:231}],86:[function(v,w,y){var e=v("gl-texture2d");w.exports=function(x,f,_,b){t||(t=x.FRAMEBUFFER_UNSUPPORTED,n=x.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,o=x.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,r=x.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var T=x.getExtension("WEBGL_draw_buffers");if(!g&&T&&function(E,z){var D=E.getParameter(z.MAX_COLOR_ATTACHMENTS_WEBGL);g=new Array(D+1);for(var j=0;j<=D;++j){for(var V=new Array(D),Z=0;Z<j;++Z)V[Z]=E.COLOR_ATTACHMENT0+Z;for(Z=j;Z<D;++Z)V[Z]=E.NONE;g[j]=V}}(x,T),Array.isArray(f)&&(b=_,_=0|f[1],f=0|f[0]),typeof f!="number")throw new Error("gl-fbo: Missing shape parameter");var k=x.getParameter(x.MAX_RENDERBUFFER_SIZE);if(f<0||f>k||_<0||_>k)throw new Error("gl-fbo: Parameters are too large for FBO");var L=1;if("color"in(b=b||{})){if((L=Math.max(0|b.color,0))<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(L>1){if(!T)throw new Error("gl-fbo: Multiple draw buffer extension not supported");if(L>x.getParameter(T.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+L+" draw buffers")}}var A=x.UNSIGNED_BYTE,I=x.getExtension("OES_texture_float");if(b.float&&L>0){if(!I)throw new Error("gl-fbo: Context does not support floating point textures");A=x.FLOAT}else b.preferFloat&&L>0&&I&&(A=x.FLOAT);var P=!0;"depth"in b&&(P=!!b.depth);var S=!1;return"stencil"in b&&(S=!!b.stencil),new p(x,f,_,A,L,P,S,T)};var t,n,o,r,g=null;function c(x){return[x.getParameter(x.FRAMEBUFFER_BINDING),x.getParameter(x.RENDERBUFFER_BINDING),x.getParameter(x.TEXTURE_BINDING_2D)]}function a(x,f){x.bindFramebuffer(x.FRAMEBUFFER,f[0]),x.bindRenderbuffer(x.RENDERBUFFER,f[1]),x.bindTexture(x.TEXTURE_2D,f[2])}function h(x){switch(x){case t:throw new Error("gl-fbo: Framebuffer unsupported");case n:throw new Error("gl-fbo: Framebuffer incomplete attachment");case o:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case r:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function l(x,f,_,b,T,k){if(!b)return null;var L=e(x,f,_,T,b);return L.magFilter=x.NEAREST,L.minFilter=x.NEAREST,L.mipSamples=1,L.bind(),x.framebufferTexture2D(x.FRAMEBUFFER,k,x.TEXTURE_2D,L.handle,0),L}function s(x,f,_,b,T){var k=x.createRenderbuffer();return x.bindRenderbuffer(x.RENDERBUFFER,k),x.renderbufferStorage(x.RENDERBUFFER,b,f,_),x.framebufferRenderbuffer(x.FRAMEBUFFER,T,x.RENDERBUFFER,k),k}function p(x,f,_,b,T,k,L,A){this.gl=x,this._shape=[0|f,0|_],this._destroyed=!1,this._ext=A,this.color=new Array(T);for(var I=0;I<T;++I)this.color[I]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=b,this._useDepth=k,this._useStencil=L;var P=this,S=[0|f,0|_];Object.defineProperties(S,{0:{get:function(){return P._shape[0]},set:function(E){return P.width=E}},1:{get:function(){return P._shape[1]},set:function(E){return P.height=E}}}),this._shapeVector=S,function(E){var z=c(E.gl),D=E.gl,j=E.handle=D.createFramebuffer(),V=E._shape[0],Z=E._shape[1],Q=E.color.length,X=E._ext,$=E._useStencil,re=E._useDepth,H=E._colorType;D.bindFramebuffer(D.FRAMEBUFFER,j);for(var N=0;N<Q;++N)E.color[N]=l(D,V,Z,H,D.RGBA,D.COLOR_ATTACHMENT0+N);Q===0?(E._color_rb=s(D,V,Z,D.RGBA4,D.COLOR_ATTACHMENT0),X&&X.drawBuffersWEBGL(g[0])):Q>1&&X.drawBuffersWEBGL(g[Q]);var U=D.getExtension("WEBGL_depth_texture");U?$?E.depth=l(D,V,Z,U.UNSIGNED_INT_24_8_WEBGL,D.DEPTH_STENCIL,D.DEPTH_STENCIL_ATTACHMENT):re&&(E.depth=l(D,V,Z,D.UNSIGNED_SHORT,D.DEPTH_COMPONENT,D.DEPTH_ATTACHMENT)):re&&$?E._depth_rb=s(D,V,Z,D.DEPTH_STENCIL,D.DEPTH_STENCIL_ATTACHMENT):re?E._depth_rb=s(D,V,Z,D.DEPTH_COMPONENT16,D.DEPTH_ATTACHMENT):$&&(E._depth_rb=s(D,V,Z,D.STENCIL_INDEX,D.STENCIL_ATTACHMENT));var te=D.checkFramebufferStatus(D.FRAMEBUFFER);if(te!==D.FRAMEBUFFER_COMPLETE){for(E._destroyed=!0,D.bindFramebuffer(D.FRAMEBUFFER,null),D.deleteFramebuffer(E.handle),E.handle=null,E.depth&&(E.depth.dispose(),E.depth=null),E._depth_rb&&(D.deleteRenderbuffer(E._depth_rb),E._depth_rb=null),N=0;N<E.color.length;++N)E.color[N].dispose(),E.color[N]=null;E._color_rb&&(D.deleteRenderbuffer(E._color_rb),E._color_rb=null),a(D,z),h(te)}a(D,z)}(this)}var u=p.prototype;function i(x,f,_){if(x._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(x._shape[0]!==f||x._shape[1]!==_){var b=x.gl,T=b.getParameter(b.MAX_RENDERBUFFER_SIZE);if(f<0||f>T||_<0||_>T)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");x._shape[0]=f,x._shape[1]=_;for(var k=c(b),L=0;L<x.color.length;++L)x.color[L].shape=x._shape;x._color_rb&&(b.bindRenderbuffer(b.RENDERBUFFER,x._color_rb),b.renderbufferStorage(b.RENDERBUFFER,b.RGBA4,x._shape[0],x._shape[1])),x.depth&&(x.depth.shape=x._shape),x._depth_rb&&(b.bindRenderbuffer(b.RENDERBUFFER,x._depth_rb),x._useDepth&&x._useStencil?b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_STENCIL,x._shape[0],x._shape[1]):x._useDepth?b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_COMPONENT16,x._shape[0],x._shape[1]):x._useStencil&&b.renderbufferStorage(b.RENDERBUFFER,b.STENCIL_INDEX,x._shape[0],x._shape[1])),b.bindFramebuffer(b.FRAMEBUFFER,x.handle);var A=b.checkFramebufferStatus(b.FRAMEBUFFER);A!==b.FRAMEBUFFER_COMPLETE&&(x.dispose(),a(b,k),h(A)),a(b,k)}}Object.defineProperties(u,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(x){if(Array.isArray(x)||(x=[0|x,0|x]),x.length!==2)throw new Error("gl-fbo: Shape vector must be length 2");var f=0|x[0],_=0|x[1];return i(this,f,_),[f,_]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(x){return i(this,x|=0,this._shape[1]),x},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(x){return x|=0,i(this,this._shape[0],x),x},enumerable:!1}}),u.bind=function(){if(!this._destroyed){var x=this.gl;x.bindFramebuffer(x.FRAMEBUFFER,this.handle),x.viewport(0,0,this._shape[0],this._shape[1])}},u.dispose=function(){if(!this._destroyed){this._destroyed=!0;var x=this.gl;x.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(x.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var f=0;f<this.color.length;++f)this.color[f].dispose(),this.color[f]=null;this._color_rb&&(x.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},{"gl-texture2d":146}],87:[function(v,w,y){var e=v("sprintf-js").sprintf,t=v("gl-constants/lookup"),n=v("glsl-shader-name"),o=v("add-line-numbers");w.exports=function(r,g,c){var a=n(g)||"of unknown name (see npm glsl-shader-name)",h="unknown type";c!==void 0&&(h=c===t.FRAGMENT_SHADER?"fragment":"vertex");for(var l=e(`Error compiling %s shader %s:
`,h,a),s=e("%s%s",l,r),p=r.split(`
`),u={},i=0;i<p.length;i++){var x=p[i];if(x!==""&&x!=="\0"){var f=parseInt(x.split(":")[2]);if(isNaN(f))throw new Error(e("Could not parse error: %s",x));u[f]=x}}var _=o(g).split(`
`);for(i=0;i<_.length;i++)if(u[i+3]||u[i+2]||u[i+1]){var b=_[i];if(l+=b+`
`,u[i+1]){var T=u[i+1];T=T.substr(T.split(":",3).join(":").length+1).trim(),l+=e(`^^^ %s

`,T)}}return{long:l.trim(),short:s.trim()}}},{"add-line-numbers":9,"gl-constants/lookup":83,"glsl-shader-name":223,"sprintf-js":301}],88:[function(v,w,y){w.exports=function(s,p){var u=s.gl,i=o(u,g.vertex,g.fragment),x=o(u,g.pickVertex,g.pickFragment),f=r(u),_=r(u),b=r(u),T=r(u),k=new c(s,i,x,f,_,b,T);return k.update(p),s.addObject(k),k};var e=v("binary-search-bounds"),t=v("iota-array"),n=v("typedarray-pool"),o=v("gl-shader"),r=v("gl-buffer"),g=v("./lib/shaders");function c(s,p,u,i,x,f,_){this.plot=s,this.shader=p,this.pickShader=u,this.positionBuffer=i,this.weightBuffer=x,this.colorBuffer=f,this.idBuffer=_,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-1/0,-1/0],this.pickOffset=0}var a,h=c.prototype,l=[0,0,1,0,0,1,1,0,1,1,0,1];h.draw=(a=[1,0,0,0,1,0,0,0,1],function(){var s=this.plot,p=this.shader,u=this.bounds,i=this.numVertices;if(!(i<=0)){var x=s.gl,f=s.dataBox,_=u[2]-u[0],b=u[3]-u[1],T=f[2]-f[0],k=f[3]-f[1];a[0]=2*_/T,a[4]=2*b/k,a[6]=2*(u[0]-f[0])/T-1,a[7]=2*(u[1]-f[1])/k-1,p.bind();var L=p.uniforms;L.viewTransform=a,L.shape=this.shape;var A=p.attributes;this.positionBuffer.bind(),A.position.pointer(),this.weightBuffer.bind(),A.weight.pointer(x.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),A.color.pointer(x.UNSIGNED_BYTE,!0),x.drawArrays(x.TRIANGLES,0,i)}}),h.drawPick=function(){var s=[1,0,0,0,1,0,0,0,1],p=[0,0,0,0];return function(u){var i=this.plot,x=this.pickShader,f=this.bounds,_=this.numVertices;if(!(_<=0)){var b=i.gl,T=i.dataBox,k=f[2]-f[0],L=f[3]-f[1],A=T[2]-T[0],I=T[3]-T[1];s[0]=2*k/A,s[4]=2*L/I,s[6]=2*(f[0]-T[0])/A-1,s[7]=2*(f[1]-T[1])/I-1;for(var P=0;P<4;++P)p[P]=u>>8*P&255;this.pickOffset=u,x.bind();var S=x.uniforms;S.viewTransform=s,S.pickOffset=p,S.shape=this.shape;var E=x.attributes;return this.positionBuffer.bind(),E.position.pointer(),this.weightBuffer.bind(),E.weight.pointer(b.UNSIGNED_BYTE,!1),this.idBuffer.bind(),E.pickId.pointer(b.UNSIGNED_BYTE,!1),b.drawArrays(b.TRIANGLES,0,_),u+this.shape[0]*this.shape[1]}}}(),h.pick=function(s,p,u){var i=this.pickOffset,x=this.shape[0]*this.shape[1];if(u<i||u>=i+x)return null;var f=u-i,_=this.xData,b=this.yData;return{object:this,pointId:f,dataCoord:[_[f%this.shape[0]],b[f/this.shape[0]|0]]}},h.update=function(s){var p=(s=s||{}).shape||[0,0],u=s.x||t(p[0]),i=s.y||t(p[1]),x=s.z||new Float32Array(p[0]*p[1]),f=s.zsmooth!==!1;this.xData=u,this.yData=i;var _,b,T,k,L=s.colorLevels||[0],A=s.colorValues||[0,0,0,1],I=L.length,P=this.bounds;f?(_=P[0]=u[0],b=P[1]=i[0],T=P[2]=u[u.length-1],k=P[3]=i[i.length-1]):(_=P[0]=u[0]+(u[1]-u[0])/2,b=P[1]=i[0]+(i[1]-i[0])/2,T=P[2]=u[u.length-1]+(u[u.length-1]-u[u.length-2])/2,k=P[3]=i[i.length-1]+(i[i.length-1]-i[i.length-2])/2);var S=1/(T-_),E=1/(k-b),z=p[0],D=p[1];this.shape=[z,D];var j=(f?(z-1)*(D-1):z*D)*(l.length>>>1);this.numVertices=j;for(var V=n.mallocUint8(4*j),Z=n.mallocFloat32(2*j),Q=n.mallocUint8(2*j),X=n.mallocUint32(j),$=0,re=f?z-1:z,H=f?D-1:D,N=0;N<H;++N){var U,te;f?(U=E*(i[N]-b),te=E*(i[N+1]-b)):(U=N<D-1?E*(i[N]-(i[N+1]-i[N])/2-b):E*(i[N]-(i[N]-i[N-1])/2-b),te=N<D-1?E*(i[N]+(i[N+1]-i[N])/2-b):E*(i[N]+(i[N]-i[N-1])/2-b));for(var B=0;B<re;++B){var K,J;f?(K=S*(u[B]-_),J=S*(u[B+1]-_)):(K=B<z-1?S*(u[B]-(u[B+1]-u[B])/2-_):S*(u[B]-(u[B]-u[B-1])/2-_),J=B<z-1?S*(u[B]+(u[B+1]-u[B])/2-_):S*(u[B]+(u[B]-u[B-1])/2-_));for(var ee=0;ee<l.length;ee+=2){var ne,se,oe,me,ce=l[ee],ye=l[ee+1],Se=x[f?(N+ye)*z+(B+ce):N*z+B],fe=e.le(L,Se);if(fe<0)ne=A[0],se=A[1],oe=A[2],me=A[3];else if(fe===I-1)ne=A[4*I-4],se=A[4*I-3],oe=A[4*I-2],me=A[4*I-1];else{var ge=(Se-L[fe])/(L[fe+1]-L[fe]),Te=1-ge,le=4*fe,ve=4*(fe+1);ne=Te*A[le]+ge*A[ve],se=Te*A[le+1]+ge*A[ve+1],oe=Te*A[le+2]+ge*A[ve+2],me=Te*A[le+3]+ge*A[ve+3]}V[4*$]=255*ne,V[4*$+1]=255*se,V[4*$+2]=255*oe,V[4*$+3]=255*me,Z[2*$]=.5*K+.5*J,Z[2*$+1]=.5*U+.5*te,Q[2*$]=ce,Q[2*$+1]=ye,X[$]=N*z+B,$+=1}}}this.positionBuffer.update(Z),this.weightBuffer.update(Q),this.colorBuffer.update(V),this.idBuffer.update(X),n.free(Z),n.free(V),n.free(Q),n.free(X)},h.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)}},{"./lib/shaders":89,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"iota-array":235,"typedarray-pool":308}],89:[function(v,w,y){var e=v("glslify");w.exports={fragment:e([`precision lowp float;
#define GLSLIFY 1
varying vec4 fragColor;
void main() {
  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);
}
`]),vertex:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 color;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragColor;

void main() {
  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  fragColor = color;
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`]),pickFragment:e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;
varying vec2 vWeight;

uniform vec2 shape;
uniform vec4 pickOffset;

void main() {
  vec2 d = step(.5, vWeight);
  vec4 id = fragId + pickOffset;
  id.x += d.x + d.y*shape.x;

  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  gl_FragColor = id/255.;
}
`]),pickVertex:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;
attribute vec2 weight;

uniform vec2 shape;
uniform mat3 viewTransform;

varying vec4 fragId;
varying vec2 vWeight;

void main() {
  vWeight = weight;

  fragId = pickId;

  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);
  gl_Position = vec4(vPosition.xy, 0, vPosition.z);
}
`])}},{glslify:231}],90:[function(v,w,y){var e=v("glslify"),t=v("gl-shader"),n=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, nextPosition;
attribute float arcLength, lineWidth;
attribute vec4 color;

uniform vec2 screenShape;
uniform float pixelRatio;
uniform mat4 model, view, projection;

varying vec4 fragColor;
varying vec3 worldPosition;
varying float pixelArcLength;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  vec4 startPoint = project(position);
  vec4 endPoint   = project(nextPosition);

  vec2 A = startPoint.xy / startPoint.w;
  vec2 B =   endPoint.xy /   endPoint.w;

  float clipAngle = atan(
    (B.y - A.y) * screenShape.y,
    (B.x - A.x) * screenShape.x
  );

  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(
    sin(clipAngle),
    -cos(clipAngle)
  ) / screenShape;

  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);

  worldPosition = position;
  pixelArcLength = arcLength;
  fragColor = color;
}
`]),o=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3      clipBounds[2];
uniform sampler2D dashTexture;
uniform float     dashScale;
uniform float     opacity;

varying vec3    worldPosition;
varying float   pixelArcLength;
varying vec4    fragColor;

void main() {
  if (
    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||
    fragColor.a * opacity == 0.
  ) discard;

  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;
  if(dashWeight < 0.5) {
    discard;
  }
  gl_FragColor = fragColor * opacity;
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

#define FLOAT_MAX  1.70141184e38
#define FLOAT_MIN  1.17549435e-38

// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl
vec4 packFloat(float v) {
  float av = abs(v);

  //Handle special cases
  if(av < FLOAT_MIN) {
    return vec4(0.0, 0.0, 0.0, 0.0);
  } else if(v > FLOAT_MAX) {
    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;
  } else if(v < -FLOAT_MAX) {
    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;
  }

  vec4 c = vec4(0,0,0,0);

  //Compute exponent and mantissa
  float e = floor(log2(av));
  float m = av * pow(2.0, -e) - 1.0;

  //Unpack mantissa
  c[1] = floor(128.0 * m);
  m -= c[1] / 128.0;
  c[2] = floor(32768.0 * m);
  m -= c[2] / 32768.0;
  c[3] = floor(8388608.0 * m);

  //Unpack exponent
  float ebias = e + 127.0;
  c[0] = floor(ebias / 2.0);
  ebias -= c[0] * 2.0;
  c[1] += floor(ebias) * 128.0;

  //Unpack sign bit
  c[0] += 128.0 * step(0.0, -v);

  //Scale back to range
  return c / 255.0;
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform float pickId;
uniform vec3 clipBounds[2];

varying vec3 worldPosition;
varying float pixelArcLength;
varying vec4 fragColor;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;

  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);
}`]),g=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];y.createShader=function(c){return t(c,n,o,null,g)},y.createPickShader=function(c){return t(c,n,r,null,g)}},{"gl-shader":132,glslify:231}],91:[function(v,w,y){w.exports=function(_){var b=_.gl||_.scene&&_.scene.gl,T=h(b);T.attributes.position.location=0,T.attributes.nextPosition.location=1,T.attributes.arcLength.location=2,T.attributes.lineWidth.location=3,T.attributes.color.location=4;var k=l(b);k.attributes.position.location=0,k.attributes.nextPosition.location=1,k.attributes.arcLength.location=2,k.attributes.lineWidth.location=3,k.attributes.color.location=4;for(var L=e(b),A=t(b,[{buffer:L,size:3,offset:0,stride:48},{buffer:L,size:3,offset:12,stride:48},{buffer:L,size:1,offset:24,stride:48},{buffer:L,size:1,offset:28,stride:48},{buffer:L,size:4,offset:32,stride:48}]),I=c(new Array(1024),[256,1,4]),P=0;P<1024;++P)I.data[P]=255;var S=n(b,I);S.wrap=b.REPEAT;var E=new x(b,T,k,L,A,S);return E.update(_),E};var e=v("gl-buffer"),t=v("gl-vao"),n=v("gl-texture2d"),o=new Uint8Array(4),r=new Float32Array(o.buffer),g=v("binary-search-bounds"),c=v("ndarray"),a=v("./lib/shaders"),h=a.createShader,l=a.createPickShader,s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function p(_,b){for(var T=0,k=0;k<3;++k){var L=_[k]-b[k];T+=L*L}return Math.sqrt(T)}function u(_){for(var b=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],T=0;T<3;++T)b[0][T]=Math.max(_[0][T],b[0][T]),b[1][T]=Math.min(_[1][T],b[1][T]);return b}function i(_,b,T,k){this.arcLength=_,this.position=b,this.index=T,this.dataCoordinate=k}function x(_,b,T,k,L,A){this.gl=_,this.shader=b,this.pickShader=T,this.buffer=k,this.vao=L,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=A,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}var f=x.prototype;f.isTransparent=function(){return this.hasAlpha},f.isOpaque=function(){return!this.hasAlpha},f.pickSlots=1,f.setPickBase=function(_){this.pickId=_},f.drawTransparent=f.draw=function(_){if(this.vertexCount){var b=this.gl,T=this.shader,k=this.vao;T.bind(),T.uniforms={model:_.model||s,view:_.view||s,projection:_.projection||s,clipBounds:u(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[b.drawingBufferWidth,b.drawingBufferHeight],pixelRatio:this.pixelRatio},k.bind(),k.draw(b.TRIANGLE_STRIP,this.vertexCount),k.unbind()}},f.drawPick=function(_){if(this.vertexCount){var b=this.gl,T=this.pickShader,k=this.vao;T.bind(),T.uniforms={model:_.model||s,view:_.view||s,projection:_.projection||s,pickId:this.pickId,clipBounds:u(this.clipBounds),screenShape:[b.drawingBufferWidth,b.drawingBufferHeight],pixelRatio:this.pixelRatio},k.bind(),k.draw(b.TRIANGLE_STRIP,this.vertexCount),k.unbind()}},f.update=function(_){var b,T;this.dirty=!0;var k=!!_.connectGaps;"dashScale"in _&&(this.dashScale=_.dashScale),this.hasAlpha=!1,"opacity"in _&&(this.opacity=+_.opacity,this.opacity<1&&(this.hasAlpha=!0));var L=[],A=[],I=[],P=0,S=0,E=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],z=_.position||_.positions;if(z){var D=_.color||_.colors||[0,0,0,1],j=_.lineWidth||1,V=!1;e:for(b=1;b<z.length;++b){var Z,Q,X,$=z[b-1],re=z[b];for(A.push(P),I.push($.slice()),T=0;T<3;++T){if(isNaN($[T])||isNaN(re[T])||!isFinite($[T])||!isFinite(re[T])){if(!k&&L.length>0){for(var H=0;H<24;++H)L.push(L[L.length-12]);S+=2,V=!0}continue e}E[0][T]=Math.min(E[0][T],$[T],re[T]),E[1][T]=Math.max(E[1][T],$[T],re[T])}Array.isArray(D[0])?(Z=D.length>b-1?D[b-1]:D.length>0?D[D.length-1]:[0,0,0,1],Q=D.length>b?D[b]:D.length>0?D[D.length-1]:[0,0,0,1]):Z=Q=D,Z.length===3&&(Z=[Z[0],Z[1],Z[2],1]),Q.length===3&&(Q=[Q[0],Q[1],Q[2],1]),!this.hasAlpha&&Z[3]<1&&(this.hasAlpha=!0),X=Array.isArray(j)?j.length>b-1?j[b-1]:j.length>0?j[j.length-1]:[0,0,0,1]:j;var N=P;if(P+=p($,re),V){for(T=0;T<2;++T)L.push($[0],$[1],$[2],re[0],re[1],re[2],N,X,Z[0],Z[1],Z[2],Z[3]);S+=2,V=!1}L.push($[0],$[1],$[2],re[0],re[1],re[2],N,X,Z[0],Z[1],Z[2],Z[3],$[0],$[1],$[2],re[0],re[1],re[2],N,-X,Z[0],Z[1],Z[2],Z[3],re[0],re[1],re[2],$[0],$[1],$[2],P,-X,Q[0],Q[1],Q[2],Q[3],re[0],re[1],re[2],$[0],$[1],$[2],P,X,Q[0],Q[1],Q[2],Q[3]),S+=4}}if(this.buffer.update(L),A.push(P),I.push(z[z.length-1].slice()),this.bounds=E,this.vertexCount=S,this.points=I,this.arcLength=A,"dashes"in _){var U=_.dashes.slice();for(U.unshift(0),b=1;b<U.length;++b)U[b]=U[b-1]+U[b];var te=c(new Array(1024),[256,1,4]);for(b=0;b<256;++b){for(T=0;T<4;++T)te.set(b,0,T,0);1&g.le(U,U[U.length-1]*b/255)?te.set(b,0,0,0):te.set(b,0,0,255)}this.texture.setPixels(te)}},f.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},f.pick=function(_){if(!_||_.id!==this.pickId)return null;var b=function(z,D,j,V){return o[0]=V,o[1]=j,o[2]=D,o[3]=z,r[0]}(_.value[0],_.value[1],_.value[2],0),T=g.le(this.arcLength,b);if(T<0)return null;if(T===this.arcLength.length-1)return new i(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),T);for(var k=this.points[T],L=this.points[Math.min(T+1,this.points.length-1)],A=(b-this.arcLength[T])/(this.arcLength[T+1]-this.arcLength[T]),I=1-A,P=[0,0,0],S=0;S<3;++S)P[S]=I*k[S]+A*L[S];var E=Math.min(A<.5?T:T+1,this.points.length-1);return new i(b,P,E,this.points[E])}},{"./lib/shaders":90,"binary-search-bounds":31,"gl-buffer":78,"gl-texture2d":146,"gl-vao":150,ndarray:259}],92:[function(v,w,y){w.exports=function(e){var t=new Float32Array(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}},{}],93:[function(v,w,y){w.exports=function(){var e=new Float32Array(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],94:[function(v,w,y){w.exports=function(e){var t=e[0],n=e[1],o=e[2],r=e[3],g=e[4],c=e[5],a=e[6],h=e[7],l=e[8],s=e[9],p=e[10],u=e[11],i=e[12],x=e[13],f=e[14],_=e[15];return(t*c-n*g)*(p*_-u*f)-(t*a-o*g)*(s*_-u*x)+(t*h-r*g)*(s*f-p*x)+(n*a-o*c)*(l*_-u*i)-(n*h-r*c)*(l*f-p*i)+(o*h-r*a)*(l*x-s*i)}},{}],95:[function(v,w,y){w.exports=function(e,t){var n=t[0],o=t[1],r=t[2],g=t[3],c=n+n,a=o+o,h=r+r,l=n*c,s=o*c,p=o*a,u=r*c,i=r*a,x=r*h,f=g*c,_=g*a,b=g*h;return e[0]=1-p-x,e[1]=s+b,e[2]=u-_,e[3]=0,e[4]=s-b,e[5]=1-l-x,e[6]=i+f,e[7]=0,e[8]=u+_,e[9]=i-f,e[10]=1-l-p,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],96:[function(v,w,y){w.exports=function(e,t,n){var o=t[0],r=t[1],g=t[2],c=t[3],a=o+o,h=r+r,l=g+g,s=o*a,p=o*h,u=o*l,i=r*h,x=r*l,f=g*l,_=c*a,b=c*h,T=c*l;return e[0]=1-(i+f),e[1]=p+T,e[2]=u-b,e[3]=0,e[4]=p-T,e[5]=1-(s+f),e[6]=x+_,e[7]=0,e[8]=u+b,e[9]=x-_,e[10]=1-(s+i),e[11]=0,e[12]=n[0],e[13]=n[1],e[14]=n[2],e[15]=1,e}},{}],97:[function(v,w,y){w.exports=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}},{}],98:[function(v,w,y){w.exports=function(e,t){var n=t[0],o=t[1],r=t[2],g=t[3],c=t[4],a=t[5],h=t[6],l=t[7],s=t[8],p=t[9],u=t[10],i=t[11],x=t[12],f=t[13],_=t[14],b=t[15],T=n*a-o*c,k=n*h-r*c,L=n*l-g*c,A=o*h-r*a,I=o*l-g*a,P=r*l-g*h,S=s*f-p*x,E=s*_-u*x,z=s*b-i*x,D=p*_-u*f,j=p*b-i*f,V=u*b-i*_,Z=T*V-k*j+L*D+A*z-I*E+P*S;return Z?(Z=1/Z,e[0]=(a*V-h*j+l*D)*Z,e[1]=(r*j-o*V-g*D)*Z,e[2]=(f*P-_*I+b*A)*Z,e[3]=(u*I-p*P-i*A)*Z,e[4]=(h*z-c*V-l*E)*Z,e[5]=(n*V-r*z+g*E)*Z,e[6]=(_*L-x*P-b*k)*Z,e[7]=(s*P-u*L+i*k)*Z,e[8]=(c*j-a*z+l*S)*Z,e[9]=(o*z-n*j-g*S)*Z,e[10]=(x*I-f*L+b*T)*Z,e[11]=(p*L-s*I-i*T)*Z,e[12]=(a*E-c*D-h*S)*Z,e[13]=(n*D-o*E+r*S)*Z,e[14]=(f*k-x*A-_*T)*Z,e[15]=(s*A-p*k+u*T)*Z,e):null}},{}],99:[function(v,w,y){var e=v("./identity");w.exports=function(t,n,o,r){var g,c,a,h,l,s,p,u,i,x,f=n[0],_=n[1],b=n[2],T=r[0],k=r[1],L=r[2],A=o[0],I=o[1],P=o[2];return Math.abs(f-A)<1e-6&&Math.abs(_-I)<1e-6&&Math.abs(b-P)<1e-6?e(t):(p=f-A,u=_-I,i=b-P,x=1/Math.sqrt(p*p+u*u+i*i),g=k*(i*=x)-L*(u*=x),c=L*(p*=x)-T*i,a=T*u-k*p,(x=Math.sqrt(g*g+c*c+a*a))?(g*=x=1/x,c*=x,a*=x):(g=0,c=0,a=0),h=u*a-i*c,l=i*g-p*a,s=p*c-u*g,(x=Math.sqrt(h*h+l*l+s*s))?(h*=x=1/x,l*=x,s*=x):(h=0,l=0,s=0),t[0]=g,t[1]=h,t[2]=p,t[3]=0,t[4]=c,t[5]=l,t[6]=u,t[7]=0,t[8]=a,t[9]=s,t[10]=i,t[11]=0,t[12]=-(g*f+c*_+a*b),t[13]=-(h*f+l*_+s*b),t[14]=-(p*f+u*_+i*b),t[15]=1,t)}},{"./identity":97}],100:[function(v,w,y){w.exports=function(e,t,n){var o=t[0],r=t[1],g=t[2],c=t[3],a=t[4],h=t[5],l=t[6],s=t[7],p=t[8],u=t[9],i=t[10],x=t[11],f=t[12],_=t[13],b=t[14],T=t[15],k=n[0],L=n[1],A=n[2],I=n[3];return e[0]=k*o+L*a+A*p+I*f,e[1]=k*r+L*h+A*u+I*_,e[2]=k*g+L*l+A*i+I*b,e[3]=k*c+L*s+A*x+I*T,k=n[4],L=n[5],A=n[6],I=n[7],e[4]=k*o+L*a+A*p+I*f,e[5]=k*r+L*h+A*u+I*_,e[6]=k*g+L*l+A*i+I*b,e[7]=k*c+L*s+A*x+I*T,k=n[8],L=n[9],A=n[10],I=n[11],e[8]=k*o+L*a+A*p+I*f,e[9]=k*r+L*h+A*u+I*_,e[10]=k*g+L*l+A*i+I*b,e[11]=k*c+L*s+A*x+I*T,k=n[12],L=n[13],A=n[14],I=n[15],e[12]=k*o+L*a+A*p+I*f,e[13]=k*r+L*h+A*u+I*_,e[14]=k*g+L*l+A*i+I*b,e[15]=k*c+L*s+A*x+I*T,e}},{}],101:[function(v,w,y){w.exports=function(e,t,n,o,r,g,c){var a=1/(t-n),h=1/(o-r),l=1/(g-c);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*h,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+n)*a,e[13]=(r+o)*h,e[14]=(c+g)*l,e[15]=1,e}},{}],102:[function(v,w,y){w.exports=function(e,t,n,o,r){var g=1/Math.tan(t/2),c=1/(o-r);return e[0]=g/n,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=g,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(r+o)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*r*o*c,e[15]=0,e}},{}],103:[function(v,w,y){w.exports=function(e,t,n,o){var r,g,c,a,h,l,s,p,u,i,x,f,_,b,T,k,L,A,I,P,S,E,z,D,j=o[0],V=o[1],Z=o[2],Q=Math.sqrt(j*j+V*V+Z*Z);return Math.abs(Q)<1e-6?null:(j*=Q=1/Q,V*=Q,Z*=Q,r=Math.sin(n),g=Math.cos(n),c=1-g,a=t[0],h=t[1],l=t[2],s=t[3],p=t[4],u=t[5],i=t[6],x=t[7],f=t[8],_=t[9],b=t[10],T=t[11],k=j*j*c+g,L=V*j*c+Z*r,A=Z*j*c-V*r,I=j*V*c-Z*r,P=V*V*c+g,S=Z*V*c+j*r,E=j*Z*c+V*r,z=V*Z*c-j*r,D=Z*Z*c+g,e[0]=a*k+p*L+f*A,e[1]=h*k+u*L+_*A,e[2]=l*k+i*L+b*A,e[3]=s*k+x*L+T*A,e[4]=a*I+p*P+f*S,e[5]=h*I+u*P+_*S,e[6]=l*I+i*P+b*S,e[7]=s*I+x*P+T*S,e[8]=a*E+p*z+f*D,e[9]=h*E+u*z+_*D,e[10]=l*E+i*z+b*D,e[11]=s*E+x*z+T*D,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}},{}],104:[function(v,w,y){w.exports=function(e,t,n){var o=Math.sin(n),r=Math.cos(n),g=t[4],c=t[5],a=t[6],h=t[7],l=t[8],s=t[9],p=t[10],u=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=g*r+l*o,e[5]=c*r+s*o,e[6]=a*r+p*o,e[7]=h*r+u*o,e[8]=l*r-g*o,e[9]=s*r-c*o,e[10]=p*r-a*o,e[11]=u*r-h*o,e}},{}],105:[function(v,w,y){w.exports=function(e,t,n){var o=Math.sin(n),r=Math.cos(n),g=t[0],c=t[1],a=t[2],h=t[3],l=t[8],s=t[9],p=t[10],u=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=g*r-l*o,e[1]=c*r-s*o,e[2]=a*r-p*o,e[3]=h*r-u*o,e[8]=g*o+l*r,e[9]=c*o+s*r,e[10]=a*o+p*r,e[11]=h*o+u*r,e}},{}],106:[function(v,w,y){w.exports=function(e,t,n){var o=Math.sin(n),r=Math.cos(n),g=t[0],c=t[1],a=t[2],h=t[3],l=t[4],s=t[5],p=t[6],u=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=g*r+l*o,e[1]=c*r+s*o,e[2]=a*r+p*o,e[3]=h*r+u*o,e[4]=l*r-g*o,e[5]=s*r-c*o,e[6]=p*r-a*o,e[7]=u*r-h*o,e}},{}],107:[function(v,w,y){w.exports=function(e,t,n){var o=n[0],r=n[1],g=n[2];return e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e[3]=t[3]*o,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*g,e[9]=t[9]*g,e[10]=t[10]*g,e[11]=t[11]*g,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}},{}],108:[function(v,w,y){w.exports=function(e,t,n){var o,r,g,c,a,h,l,s,p,u,i,x,f=n[0],_=n[1],b=n[2];return t===e?(e[12]=t[0]*f+t[4]*_+t[8]*b+t[12],e[13]=t[1]*f+t[5]*_+t[9]*b+t[13],e[14]=t[2]*f+t[6]*_+t[10]*b+t[14],e[15]=t[3]*f+t[7]*_+t[11]*b+t[15]):(o=t[0],r=t[1],g=t[2],c=t[3],a=t[4],h=t[5],l=t[6],s=t[7],p=t[8],u=t[9],i=t[10],x=t[11],e[0]=o,e[1]=r,e[2]=g,e[3]=c,e[4]=a,e[5]=h,e[6]=l,e[7]=s,e[8]=p,e[9]=u,e[10]=i,e[11]=x,e[12]=o*f+a*_+p*b+t[12],e[13]=r*f+h*_+u*b+t[13],e[14]=g*f+l*_+i*b+t[14],e[15]=c*f+s*_+x*b+t[15]),e}},{}],109:[function(v,w,y){w.exports=function(e,t){if(e===t){var n=t[1],o=t[2],r=t[3],g=t[6],c=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[6]=t[9],e[7]=t[13],e[8]=o,e[9]=g,e[11]=t[14],e[12]=r,e[13]=c,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}},{}],110:[function(v,w,y){var e=v("barycentric"),t=v("polytope-closest-point/lib/closest_point_2d.js");function n(g,c){for(var a=[0,0,0,0],h=0;h<4;++h)for(var l=0;l<4;++l)a[l]+=g[4*h+l]*c[h];return a}function o(g,c,a,h,l){for(var s=n(h,n(a,n(c,[g[0],g[1],g[2],1]))),p=0;p<3;++p)s[p]/=s[3];return[.5*l[0]*(1+s[0]),.5*l[1]*(1-s[1])]}function r(g,c){for(var a=[0,0,0],h=0;h<g.length;++h)for(var l=g[h],s=c[h],p=0;p<3;++p)a[p]+=s*l[p];return a}w.exports=function(g,c,a,h,l,s){if(g.length===1)return[0,g[0].slice()];for(var p=new Array(g.length),u=0;u<g.length;++u)p[u]=o(g[u],a,h,l,s);var i=0,x=1/0;for(u=0;u<p.length;++u){for(var f=0,_=0;_<2;++_)f+=Math.pow(p[u][_]-c[_],2);f<x&&(x=f,i=u)}var b=function(k,L){if(k.length===2){for(var A=0,I=0,P=0;P<2;++P)A+=Math.pow(L[P]-k[0][P],2),I+=Math.pow(L[P]-k[1][P],2);return A=Math.sqrt(A),I=Math.sqrt(I),A+I<1e-6?[1,0]:[I/(A+I),A/(I+A)]}if(k.length===3){var S=[0,0];return t(k[0],k[1],k[2],L,S),e(k,S)}return[]}(p,c),T=0;for(u=0;u<3;++u){if(b[u]<-.001||b[u]>1.0001)return null;T+=b[u]}return Math.abs(T-1)>.001?null:[i,r(g,b),b]}},{barycentric:14,"polytope-closest-point/lib/closest_point_2d.js":270}],111:[function(v,w,y){var e=v("glslify"),t=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position, normal;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model
           , view
           , projection
           , inverseModel;
uniform vec3 eyePosition
           , lightPosition;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

vec4 project(vec3 p) {
  return projection * view * model * vec4(p, 1.0);
}

void main() {
  gl_Position      = project(position);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * vec4(position , 1.0);
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  f_color          = color;
  f_data           = position;
  f_uv             = uv;
}
`]),n=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness
            , fresnel
            , kambient
            , kdiffuse
            , kspecular;
uniform sampler2D texture;

varying vec3 f_normal
           , f_lightDirection
           , f_eyeDirection
           , f_data;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (f_color.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], f_data)
  ) discard;

  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d

  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * f_color.a;
}
`]),o=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;

uniform mat4 model, view, projection;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_color = color;
  f_data  = position;
  f_uv    = uv;
}`]),r=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec3 f_data;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;

  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),g=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 uv;
attribute float pointSize;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);
  } else {
    gl_Position = projection * view * model * vec4(position, 1.0);
  }
  gl_PointSize = pointSize;
  f_color = color;
  f_uv = uv;
}`]),c=e([`precision highp float;
#define GLSLIFY 1

uniform sampler2D texture;
uniform float opacity;

varying vec4 f_color;
varying vec2 f_uv;

void main() {
  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);
  if(dot(pointR, pointR) > 0.25) {
    discard;
  }
  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;
}`]),a=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;
attribute vec4 id;

uniform mat4 model, view, projection;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
  f_id        = id;
  f_position  = position;
}`]),h=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]),l=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3  position;
attribute float pointSize;
attribute vec4  id;

uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);
  } else {
    gl_Position  = projection * view * model * vec4(position, 1.0);
    gl_PointSize = pointSize;
  }
  f_id         = id;
  f_position   = position;
}`]),s=e([`precision highp float;
#define GLSLIFY 1

attribute vec3 position;

uniform mat4 model, view, projection;

void main() {
  gl_Position = projection * view * model * vec4(position, 1.0);
}`]),p=e([`precision highp float;
#define GLSLIFY 1

uniform vec3 contourColor;

void main() {
  gl_FragColor = vec4(contourColor, 1.0);
}
`]);y.meshShader={vertex:t,fragment:n,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},y.wireShader={vertex:o,fragment:r,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},y.pointShader={vertex:g,fragment:c,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},y.pickShader={vertex:a,fragment:h,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},y.pointPickShader={vertex:l,fragment:h,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},y.contourShader={vertex:s,fragment:p,attributes:[{name:"position",type:"vec3"}]}},{glslify:231}],112:[function(v,w,y){var e=v("gl-shader"),t=v("gl-buffer"),n=v("gl-vao"),o=v("gl-texture2d"),r=v("normals"),g=v("gl-mat4/multiply"),c=v("gl-mat4/invert"),a=v("ndarray"),h=v("colormap"),l=v("simplicial-complex-contour"),s=v("typedarray-pool"),p=v("./lib/shaders"),u=v("./lib/closest-point"),i=p.meshShader,x=p.wireShader,f=p.pointShader,_=p.pickShader,b=p.pointPickShader,T=p.contourShader,k=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function L(V,Z,Q,X,$,re,H,N,U,te,B,K,J,ee,ne,se,oe,me,ce,ye,Se,fe,ge,Te,le,ve,Me){this.gl=V,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=Z,this.dirty=!0,this.triShader=Q,this.lineShader=X,this.pointShader=$,this.pickShader=re,this.pointPickShader=H,this.contourShader=N,this.trianglePositions=U,this.triangleColors=B,this.triangleNormals=J,this.triangleUVs=K,this.triangleIds=te,this.triangleVAO=ee,this.triangleCount=0,this.lineWidth=1,this.edgePositions=ne,this.edgeColors=oe,this.edgeUVs=me,this.edgeIds=se,this.edgeVAO=ce,this.edgeCount=0,this.pointPositions=ye,this.pointColors=fe,this.pointUVs=ge,this.pointSizes=Te,this.pointIds=Se,this.pointVAO=le,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=ve,this.contourVAO=Me,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickVertex=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=k,this._view=k,this._projection=k,this._resolution=[1,1]}var A=L.prototype;function I(V,Z){if(!Z||!Z.length)return 1;for(var Q=0;Q<Z.length;++Q){if(Z.length<2)return 1;if(Z[Q][0]===V)return Z[Q][1];if(Z[Q][0]>V&&Q>0){var X=(Z[Q][0]-V)/(Z[Q][0]-Z[Q-1][0]);return Z[Q][1]*(1-X)+X*Z[Q-1][1]}}return 1}function P(V){var Z=e(V,i.vertex,i.fragment);return Z.attributes.position.location=0,Z.attributes.color.location=2,Z.attributes.uv.location=3,Z.attributes.normal.location=4,Z}function S(V){var Z=e(V,x.vertex,x.fragment);return Z.attributes.position.location=0,Z.attributes.color.location=2,Z.attributes.uv.location=3,Z}function E(V){var Z=e(V,f.vertex,f.fragment);return Z.attributes.position.location=0,Z.attributes.color.location=2,Z.attributes.uv.location=3,Z.attributes.pointSize.location=4,Z}function z(V){var Z=e(V,_.vertex,_.fragment);return Z.attributes.position.location=0,Z.attributes.id.location=1,Z}function D(V){var Z=e(V,b.vertex,b.fragment);return Z.attributes.position.location=0,Z.attributes.id.location=1,Z.attributes.pointSize.location=4,Z}function j(V){var Z=e(V,T.vertex,T.fragment);return Z.attributes.position.location=0,Z}A.isOpaque=function(){return!this.hasAlpha},A.isTransparent=function(){return this.hasAlpha},A.pickSlots=1,A.setPickBase=function(V){this.pickId=V},A.highlight=function(V){if(V&&this.contourEnable){for(var Z=l(this.cells,this.intensity,V.intensity),Q=Z.cells,X=Z.vertexIds,$=Z.vertexWeights,re=Q.length,H=s.mallocFloat32(6*re),N=0,U=0;U<re;++U)for(var te=Q[U],B=0;B<2;++B){var K=te[0];te.length===2&&(K=te[B]);for(var J=X[K][0],ee=X[K][1],ne=$[K],se=1-ne,oe=this.positions[J],me=this.positions[ee],ce=0;ce<3;++ce)H[N++]=ne*oe[ce]+se*me[ce]}this.contourCount=N/3|0,this.contourPositions.update(H.subarray(0,N)),s.free(H)}else this.contourCount=0},A.update=function(V){V=V||{};var Z=this.gl;this.dirty=!0,"contourEnable"in V&&(this.contourEnable=V.contourEnable),"contourColor"in V&&(this.contourColor=V.contourColor),"lineWidth"in V&&(this.lineWidth=V.lineWidth),"lightPosition"in V&&(this.lightPosition=V.lightPosition),this.hasAlpha=!1,"opacity"in V&&(this.opacity=V.opacity,this.opacity<1&&(this.hasAlpha=!0)),"opacityscale"in V&&(this.opacityscale=V.opacityscale,this.hasAlpha=!0),"ambient"in V&&(this.ambientLight=V.ambient),"diffuse"in V&&(this.diffuseLight=V.diffuse),"specular"in V&&(this.specularLight=V.specular),"roughness"in V&&(this.roughness=V.roughness),"fresnel"in V&&(this.fresnel=V.fresnel),V.texture?(this.texture.dispose(),this.texture=o(Z,V.texture)):V.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=Z.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=Z.LINEAR,this.texture.setPixels(function(Gt,$t){for(var Zt=h({colormap:Gt,nshades:256,format:"rgba"}),cr=new Uint8Array(1024),Dt=0;Dt<256;++Dt){for(var Ne=Zt[Dt],Ye=0;Ye<3;++Ye)cr[4*Dt+Ye]=Ne[Ye];cr[4*Dt+3]=$t?255*I(Dt/255,$t):255*Ne[3]}return a(cr,[256,256,4],[4,0,1])}(V.colormap,this.opacityscale)),this.texture.generateMipmap());var Q=V.cells,X=V.positions;if(X&&Q){var $=[],re=[],H=[],N=[],U=[],te=[],B=[],K=[],J=[],ee=[],ne=[],se=[],oe=[],me=[];this.cells=Q,this.positions=X;var ce=V.vertexNormals,ye=V.cellNormals,Se=V.vertexNormalsEpsilon===void 0?1e-6:V.vertexNormalsEpsilon,fe=V.faceNormalsEpsilon===void 0?1e-6:V.faceNormalsEpsilon;V.useFacetNormals&&!ye&&(ye=r.faceNormals(Q,X,fe)),ye||ce||(ce=r.vertexNormals(Q,X,Se));var ge=V.vertexColors,Te=V.cellColors,le=V.meshColor||[1,1,1,1],ve=V.vertexUVs,Me=V.vertexIntensity,we=V.cellUVs,de=V.cellIntensity,Ie=1/0,De=-1/0;if(!ve&&!we)if(Me)if(V.vertexIntensityBounds)Ie=+V.vertexIntensityBounds[0],De=+V.vertexIntensityBounds[1];else for(var Oe=0;Oe<Me.length;++Oe){var Ve=Me[Oe];Ie=Math.min(Ie,Ve),De=Math.max(De,Ve)}else if(de)if(V.cellIntensityBounds)Ie=+V.cellIntensityBounds[0],De=+V.cellIntensityBounds[1];else for(Oe=0;Oe<de.length;++Oe)Ve=de[Oe],Ie=Math.min(Ie,Ve),De=Math.max(De,Ve);else for(Oe=0;Oe<X.length;++Oe)Ve=X[Oe][2],Ie=Math.min(Ie,Ve),De=Math.max(De,Ve);this.intensity=Me||de||function(Gt){for(var $t=Gt.length,Zt=new Array($t),cr=0;cr<$t;++cr)Zt[cr]=Gt[cr][2];return Zt}(X),this.pickVertex=!(de||Te);var Fe=V.pointSizes,ze=V.pointSize||1;for(this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],Oe=0;Oe<X.length;++Oe)for(var Re=X[Oe],We=0;We<3;++We)!isNaN(Re[We])&&isFinite(Re[We])&&(this.bounds[0][We]=Math.min(this.bounds[0][We],Re[We]),this.bounds[1][We]=Math.max(this.bounds[1][We],Re[We]));var $e=0,at=0,gt=0;e:for(Oe=0;Oe<Q.length;++Oe){var xt=Q[Oe];switch(xt.length){case 1:for(Re=X[nt=xt[0]],We=0;We<3;++We)if(isNaN(Re[We])||!isFinite(Re[We]))continue e;ee.push(Re[0],Re[1],Re[2]),Qe=ge?ge[nt]:Te?Te[Oe]:le,this.opacityscale&&Me?re.push(Qe[0],Qe[1],Qe[2],this.opacity*I((Me[nt]-Ie)/(De-Ie),this.opacityscale)):Qe.length===3?ne.push(Qe[0],Qe[1],Qe[2],this.opacity):(ne.push(Qe[0],Qe[1],Qe[2],Qe[3]*this.opacity),Qe[3]<1&&(this.hasAlpha=!0)),vt=ve?ve[nt]:Me?[(Me[nt]-Ie)/(De-Ie),0]:we?we[Oe]:de?[(de[Oe]-Ie)/(De-Ie),0]:[(Re[2]-Ie)/(De-Ie),0],se.push(vt[0],vt[1]),Fe?oe.push(Fe[nt]):oe.push(ze),me.push(Oe),gt+=1;break;case 2:for(We=0;We<2;++We){Re=X[nt=xt[We]];for(var mt=0;mt<3;++mt)if(isNaN(Re[mt])||!isFinite(Re[mt]))continue e}for(We=0;We<2;++We)Re=X[nt=xt[We]],te.push(Re[0],Re[1],Re[2]),Qe=ge?ge[nt]:Te?Te[Oe]:le,this.opacityscale&&Me?re.push(Qe[0],Qe[1],Qe[2],this.opacity*I((Me[nt]-Ie)/(De-Ie),this.opacityscale)):Qe.length===3?B.push(Qe[0],Qe[1],Qe[2],this.opacity):(B.push(Qe[0],Qe[1],Qe[2],Qe[3]*this.opacity),Qe[3]<1&&(this.hasAlpha=!0)),vt=ve?ve[nt]:Me?[(Me[nt]-Ie)/(De-Ie),0]:we?we[Oe]:de?[(de[Oe]-Ie)/(De-Ie),0]:[(Re[2]-Ie)/(De-Ie),0],K.push(vt[0],vt[1]),J.push(Oe);at+=1;break;case 3:for(We=0;We<3;++We)for(Re=X[nt=xt[We]],mt=0;mt<3;++mt)if(isNaN(Re[mt])||!isFinite(Re[mt]))continue e;for(We=0;We<3;++We){var nt,Qe,vt,jt;Re=X[nt=xt[2-We]],$.push(Re[0],Re[1],Re[2]),(Qe=ge?ge[nt]:Te?Te[Oe]:le)?this.opacityscale&&Me?re.push(Qe[0],Qe[1],Qe[2],this.opacity*I((Me[nt]-Ie)/(De-Ie),this.opacityscale)):Qe.length===3?re.push(Qe[0],Qe[1],Qe[2],this.opacity):(re.push(Qe[0],Qe[1],Qe[2],Qe[3]*this.opacity),Qe[3]<1&&(this.hasAlpha=!0)):re.push(.5,.5,.5,1),vt=ve?ve[nt]:Me?[(Me[nt]-Ie)/(De-Ie),0]:we?we[Oe]:de?[(de[Oe]-Ie)/(De-Ie),0]:[(Re[2]-Ie)/(De-Ie),0],N.push(vt[0],vt[1]),jt=ce?ce[nt]:ye[Oe],H.push(jt[0],jt[1],jt[2]),U.push(Oe)}$e+=1}}this.pointCount=gt,this.edgeCount=at,this.triangleCount=$e,this.pointPositions.update(ee),this.pointColors.update(ne),this.pointUVs.update(se),this.pointSizes.update(oe),this.pointIds.update(new Uint32Array(me)),this.edgePositions.update(te),this.edgeColors.update(B),this.edgeUVs.update(K),this.edgeIds.update(new Uint32Array(J)),this.trianglePositions.update($),this.triangleColors.update(re),this.triangleUVs.update(N),this.triangleNormals.update(H),this.triangleIds.update(new Uint32Array(U))}},A.drawTransparent=A.draw=function(V){V=V||{};for(var Z=this.gl,Q=V.model||k,X=V.view||k,$=V.projection||k,re=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],H=0;H<3;++H)re[0][H]=Math.max(re[0][H],this.clipBounds[0][H]),re[1][H]=Math.min(re[1][H],this.clipBounds[1][H]);var N={model:Q,view:X,projection:$,inverseModel:k.slice(),clipBounds:re,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};N.inverseModel=c(N.inverseModel,N.model),Z.disable(Z.CULL_FACE),this.texture.bind(0);var U=new Array(16);for(g(U,N.view,N.model),g(U,N.projection,U),c(U,U),H=0;H<3;++H)N.eyePosition[H]=U[12+H]/U[15];var te,B=U[15];for(H=0;H<3;++H)B+=this.lightPosition[H]*U[4*H+3];for(H=0;H<3;++H){for(var K=U[12+H],J=0;J<3;++J)K+=U[4*J+H]*this.lightPosition[J];N.lightPosition[H]=K/B}this.triangleCount>0&&((te=this.triShader).bind(),te.uniforms=N,this.triangleVAO.bind(),Z.drawArrays(Z.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&this.lineWidth>0&&((te=this.lineShader).bind(),te.uniforms=N,this.edgeVAO.bind(),Z.lineWidth(this.lineWidth*this.pixelRatio),Z.drawArrays(Z.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((te=this.pointShader).bind(),te.uniforms=N,this.pointVAO.bind(),Z.drawArrays(Z.POINTS,0,this.pointCount),this.pointVAO.unbind()),this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0&&((te=this.contourShader).bind(),te.uniforms=N,this.contourVAO.bind(),Z.drawArrays(Z.LINES,0,this.contourCount),this.contourVAO.unbind())},A.drawPick=function(V){V=V||{};for(var Z=this.gl,Q=V.model||k,X=V.view||k,$=V.projection||k,re=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],H=0;H<3;++H)re[0][H]=Math.max(re[0][H],this.clipBounds[0][H]),re[1][H]=Math.min(re[1][H],this.clipBounds[1][H]);this._model=[].slice.call(Q),this._view=[].slice.call(X),this._projection=[].slice.call($),this._resolution=[Z.drawingBufferWidth,Z.drawingBufferHeight];var N,U={model:Q,view:X,projection:$,clipBounds:re,pickId:this.pickId/255};(N=this.pickShader).bind(),N.uniforms=U,this.triangleCount>0&&(this.triangleVAO.bind(),Z.drawArrays(Z.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),Z.lineWidth(this.lineWidth*this.pixelRatio),Z.drawArrays(Z.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((N=this.pointPickShader).bind(),N.uniforms=U,this.pointVAO.bind(),Z.drawArrays(Z.POINTS,0,this.pointCount),this.pointVAO.unbind())},A.pick=function(V){if(!V||V.id!==this.pickId)return null;for(var Z=V.value[0]+256*V.value[1]+65536*V.value[2],Q=this.cells[Z],X=this.positions,$=new Array(Q.length),re=0;re<Q.length;++re)$[re]=X[Q[re]];var H=V.coord[0],N=V.coord[1];if(!this.pickVertex){var U=this.positions[Q[0]],te=this.positions[Q[1]],B=this.positions[Q[2]],K=[(U[0]+te[0]+B[0])/3,(U[1]+te[1]+B[1])/3,(U[2]+te[2]+B[2])/3];return{_cellCenter:!0,position:[H,N],index:Z,cell:Q,cellId:Z,intensity:this.intensity[Z],dataCoordinate:K}}var J=u($,[H*this.pixelRatio,this._resolution[1]-N*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!J)return null;var ee=J[2],ne=0;for(re=0;re<Q.length;++re)ne+=ee[re]*this.intensity[Q[re]];return{position:J[1],index:Q[J[0]],cell:Q,cellId:Z,intensity:ne,dataCoordinate:this.positions[Q[J[0]]]}},A.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()},w.exports=function(V,Z){arguments.length===1&&(V=(Z=V).gl);var Q=V.getExtension("OES_standard_derivatives")||V.getExtension("MOZ_OES_standard_derivatives")||V.getExtension("WEBKIT_OES_standard_derivatives");if(!Q)throw new Error("derivatives not supported");var X=P(V),$=S(V),re=E(V),H=z(V),N=D(V),U=j(V),te=o(V,a(new Uint8Array([255,255,255,255]),[1,1,4]));te.generateMipmap(),te.minFilter=V.LINEAR_MIPMAP_LINEAR,te.magFilter=V.LINEAR;var B=t(V),K=t(V),J=t(V),ee=t(V),ne=t(V),se=n(V,[{buffer:B,type:V.FLOAT,size:3},{buffer:ne,type:V.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:K,type:V.FLOAT,size:4},{buffer:J,type:V.FLOAT,size:2},{buffer:ee,type:V.FLOAT,size:3}]),oe=t(V),me=t(V),ce=t(V),ye=t(V),Se=n(V,[{buffer:oe,type:V.FLOAT,size:3},{buffer:ye,type:V.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:me,type:V.FLOAT,size:4},{buffer:ce,type:V.FLOAT,size:2}]),fe=t(V),ge=t(V),Te=t(V),le=t(V),ve=t(V),Me=n(V,[{buffer:fe,type:V.FLOAT,size:3},{buffer:ve,type:V.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:ge,type:V.FLOAT,size:4},{buffer:Te,type:V.FLOAT,size:2},{buffer:le,type:V.FLOAT,size:1}]),we=t(V),de=n(V,[{buffer:we,type:V.FLOAT,size:3}]),Ie=new L(V,te,X,$,re,H,N,U,B,ne,K,J,ee,se,oe,ye,me,ce,Se,fe,ve,ge,Te,le,Me,we,de);return Ie.update(Z),Ie}},{"./lib/closest-point":110,"./lib/shaders":111,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-shader":132,"gl-texture2d":146,"gl-vao":150,ndarray:259,normals:261,"simplicial-complex-contour":291,"typedarray-pool":308}],113:[function(v,w,y){w.exports=function(a){var h=a.gl,l=e(h,[0,0,0,1,1,0,1,1]),s=t(h,n.boxVert,n.lineFrag);return new o(a,l,s)};var e=v("gl-buffer"),t=v("gl-shader"),n=v("./shaders");function o(a,h,l){this.plot=a,this.vbo=h,this.shader=l}var r,g,c=o.prototype;c.bind=function(){var a=this.shader;this.vbo.bind(),this.shader.bind(),a.attributes.coord.pointer(),a.uniforms.screenBox=this.plot.screenBox},c.drawBox=(r=[0,0],g=[0,0],function(a,h,l,s,p){var u=this.plot,i=this.shader,x=u.gl;r[0]=a,r[1]=h,g[0]=l,g[1]=s,i.uniforms.lo=r,i.uniforms.hi=g,i.uniforms.color=p,x.drawArrays(x.TRIANGLE_STRIP,0,4)}),c.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],114:[function(v,w,y){w.exports=function(u){var i=u.gl,x=e(i),f=t(i,o.gridVert,o.gridFrag),_=t(i,o.tickVert,o.gridFrag);return new r(u,x,f,_)};var e=v("gl-buffer"),t=v("gl-shader"),n=v("binary-search-bounds"),o=v("./shaders");function r(u,i,x,f){this.plot=u,this.vbo=i,this.shader=x,this.tickShader=f,this.ticks=[[],[]]}function g(u,i){return u-i}var c,a,h,l,s,p=r.prototype;p.draw=(c=[0,0],a=[0,0],h=[0,0],function(){for(var u=this.plot,i=this.vbo,x=this.shader,f=this.ticks,_=u.gl,b=u._tickBounds,T=u.dataBox,k=u.viewBox,L=u.gridLineWidth,A=u.gridLineColor,I=u.gridLineEnable,P=u.pixelRatio,S=0;S<2;++S){var E=b[S],z=b[S+2]-E,D=.5*(T[S+2]+T[S]),j=T[S+2]-T[S];a[S]=2*z/j,c[S]=2*(E-D)/j}x.bind(),i.bind(),x.attributes.dataCoord.pointer(),x.uniforms.dataShift=c,x.uniforms.dataScale=a;var V=0;for(S=0;S<2;++S){h[0]=h[1]=0,h[S]=1,x.uniforms.dataAxis=h,x.uniforms.lineWidth=L[S]/(k[S+2]-k[S])*P,x.uniforms.color=A[S];var Z=6*f[S].length;I[S]&&Z&&_.drawArrays(_.TRIANGLES,V,Z),V+=Z}}),p.drawTickMarks=function(){var u=[0,0],i=[0,0],x=[1,0],f=[0,1],_=[0,0],b=[0,0];return function(){for(var T=this.plot,k=this.vbo,L=this.tickShader,A=this.ticks,I=T.gl,P=T._tickBounds,S=T.dataBox,E=T.viewBox,z=T.pixelRatio,D=T.screenBox,j=D[2]-D[0],V=D[3]-D[1],Z=E[2]-E[0],Q=E[3]-E[1],X=0;X<2;++X){var $=P[X],re=P[X+2]-$,H=.5*(S[X+2]+S[X]),N=S[X+2]-S[X];i[X]=2*re/N,u[X]=2*($-H)/N}i[0]*=Z/j,u[0]*=Z/j,i[1]*=Q/V,u[1]*=Q/V,L.bind(),k.bind(),L.attributes.dataCoord.pointer();var U=L.uniforms;U.dataShift=u,U.dataScale=i;var te=T.tickMarkLength,B=T.tickMarkWidth,K=T.tickMarkColor,J=6*A[0].length,ee=Math.min(n.ge(A[0],(S[0]-P[0])/(P[2]-P[0]),g),A[0].length),ne=Math.min(n.gt(A[0],(S[2]-P[0])/(P[2]-P[0]),g),A[0].length),se=0+6*ee,oe=6*Math.max(0,ne-ee),me=Math.min(n.ge(A[1],(S[1]-P[1])/(P[3]-P[1]),g),A[1].length),ce=Math.min(n.gt(A[1],(S[3]-P[1])/(P[3]-P[1]),g),A[1].length),ye=J+6*me,Se=6*Math.max(0,ce-me);_[0]=2*(E[0]-te[1])/j-1,_[1]=(E[3]+E[1])/V-1,b[0]=te[1]*z/j,b[1]=B[1]*z/V,Se&&(U.color=K[1],U.tickScale=b,U.dataAxis=f,U.screenOffset=_,I.drawArrays(I.TRIANGLES,ye,Se)),_[0]=(E[2]+E[0])/j-1,_[1]=2*(E[1]-te[0])/V-1,b[0]=B[0]*z/j,b[1]=te[0]*z/V,oe&&(U.color=K[0],U.tickScale=b,U.dataAxis=x,U.screenOffset=_,I.drawArrays(I.TRIANGLES,se,oe)),_[0]=2*(E[2]+te[3])/j-1,_[1]=(E[3]+E[1])/V-1,b[0]=te[3]*z/j,b[1]=B[3]*z/V,Se&&(U.color=K[3],U.tickScale=b,U.dataAxis=f,U.screenOffset=_,I.drawArrays(I.TRIANGLES,ye,Se)),_[0]=(E[2]+E[0])/j-1,_[1]=2*(E[3]+te[2])/V-1,b[0]=B[2]*z/j,b[1]=te[2]*z/V,oe&&(U.color=K[2],U.tickScale=b,U.dataAxis=x,U.screenOffset=_,I.drawArrays(I.TRIANGLES,se,oe))}}(),p.update=(l=[1,1,-1,-1,1,-1],s=[1,-1,1,1,-1,-1],function(u){for(var i=u.ticks,x=u.bounds,f=new Float32Array(18*(i[0].length+i[1].length)),_=(this.plot.zeroLineEnable,0),b=[[],[]],T=0;T<2;++T)for(var k=b[T],L=i[T],A=x[T],I=x[T+2],P=0;P<L.length;++P){var S=(L[P].x-A)/(I-A);k.push(S);for(var E=0;E<6;++E)f[_++]=S,f[_++]=l[E],f[_++]=s[E]}this.ticks=b,this.vbo.update(f)}),p.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132}],115:[function(v,w,y){w.exports=function(a){var h=a.gl,l=e(h,[-1,-1,-1,1,1,-1,1,1]),s=t(h,n.lineVert,n.lineFrag);return new o(a,l,s)};var e=v("gl-buffer"),t=v("gl-shader"),n=v("./shaders");function o(a,h,l){this.plot=a,this.vbo=h,this.shader=l}var r,g,c=o.prototype;c.bind=function(){var a=this.shader;this.vbo.bind(),this.shader.bind(),a.attributes.coord.pointer(),a.uniforms.screenBox=this.plot.screenBox},c.drawLine=(r=[0,0],g=[0,0],function(a,h,l,s,p,u){var i=this.plot,x=this.shader,f=i.gl;r[0]=a,r[1]=h,g[0]=l,g[1]=s,x.uniforms.start=r,x.uniforms.end=g,x.uniforms.width=p*i.pixelRatio,x.uniforms.color=u,f.drawArrays(f.TRIANGLE_STRIP,0,4)}),c.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"gl-buffer":78,"gl-shader":132}],116:[function(v,w,y){var e=v("glslify"),t=e([`precision lowp float;
#define GLSLIFY 1
uniform vec4 color;
void main() {
  gl_FragColor = vec4(color.xyz * color.w, color.w);
}
`]);w.exports={lineVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 start, end;
uniform float width;

vec2 perp(vec2 v) {
  return vec2(v.y, -v.x);
}

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  vec2 delta = normalize(perp(start - end));
  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));
  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);
}
`]),lineFrag:t,textVert:e([`#define GLSLIFY 1
attribute vec3 textCoordinate;

uniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;
uniform float angle;

void main() {
  float dataOffset  = textCoordinate.z;
  vec2 glyphOffset  = textCoordinate.xy;
  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +
    glyphMatrix * glyphOffset * textScale + screenOffset;
  gl_Position = vec4(screenCoordinate, 0, 1);
}
`]),textFrag:t,gridVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale;
uniform float lineWidth;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;
  gl_Position = vec4(pos, 0, 1);
}
`]),gridFrag:t,boxVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 coord;

uniform vec4 screenBox;
uniform vec2 lo, hi;

vec2 screen(vec2 v) {
  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;
}

void main() {
  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);
}
`]),tickVert:e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 dataCoord;

uniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;

void main() {
  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);
  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);
}
`])}},{glslify:231}],117:[function(v,w,y){w.exports=function(i){var x=i.gl,f=e(x),_=t(x,r.textVert,r.textFrag);return new g(i,f,_)};var e=v("gl-buffer"),t=v("gl-shader"),n=v("text-cache"),o=v("binary-search-bounds"),r=v("./shaders");function g(i,x,f){this.plot=i,this.vbo=x,this.shader=f,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}var c,a,h,l,s,p,u=g.prototype;u.drawTicks=(c=[0,0],a=[0,0],h=[0,0],function(i){var x=this.plot,f=this.shader,_=this.tickX[i],b=this.tickOffset[i],T=x.gl,k=x.viewBox,L=x.dataBox,A=x.screenBox,I=x.pixelRatio,P=x.tickEnable,S=x.tickPad,E=x.tickColor,z=x.tickAngle,D=x.labelEnable,j=x.labelPad,V=x.labelColor,Z=x.labelAngle,Q=this.labelOffset[i],X=this.labelCount[i],$=o.lt(_,L[i]),re=o.le(_,L[i+2]);c[0]=c[1]=0,c[i]=1,a[i]=(k[2+i]+k[i])/(A[2+i]-A[i])-1;var H=2/A[2+(1^i)]-A[1^i];a[1^i]=H*k[1^i]-1,P[i]&&(a[1^i]-=H*I*S[i],$<re&&b[re]>b[$]&&(f.uniforms.dataAxis=c,f.uniforms.screenOffset=a,f.uniforms.color=E[i],f.uniforms.angle=z[i],T.drawArrays(T.TRIANGLES,b[$],b[re]-b[$]))),D[i]&&X&&(a[1^i]-=H*I*j[i],f.uniforms.dataAxis=h,f.uniforms.screenOffset=a,f.uniforms.color=V[i],f.uniforms.angle=Z[i],T.drawArrays(T.TRIANGLES,Q,X)),a[1^i]=H*k[2+(1^i)]-1,P[i+2]&&(a[1^i]+=H*I*S[i+2],$<re&&b[re]>b[$]&&(f.uniforms.dataAxis=c,f.uniforms.screenOffset=a,f.uniforms.color=E[i+2],f.uniforms.angle=z[i+2],T.drawArrays(T.TRIANGLES,b[$],b[re]-b[$]))),D[i+2]&&X&&(a[1^i]+=H*I*j[i+2],f.uniforms.dataAxis=h,f.uniforms.screenOffset=a,f.uniforms.color=V[i+2],f.uniforms.angle=Z[i+2],T.drawArrays(T.TRIANGLES,Q,X))}),u.drawTitle=function(){var i=[0,0],x=[0,0];return function(){var f=this.plot,_=this.shader,b=f.gl,T=f.screenBox,k=f.titleCenter,L=f.titleAngle,A=f.titleColor,I=f.pixelRatio;if(this.titleCount){for(var P=0;P<2;++P)x[P]=2*(k[P]*I-T[P])/(T[2+P]-T[P])-1;_.bind(),_.uniforms.dataAxis=i,_.uniforms.screenOffset=x,_.uniforms.angle=L,_.uniforms.color=A,b.drawArrays(b.TRIANGLES,this.titleOffset,this.titleCount)}}}(),u.bind=(l=[0,0],s=[0,0],p=[0,0],function(){var i=this.plot,x=this.shader,f=i._tickBounds,_=i.dataBox,b=i.screenBox,T=i.viewBox;x.bind();for(var k=0;k<2;++k){var L=f[k],A=f[k+2]-L,I=.5*(_[k+2]+_[k]),P=_[k+2]-_[k],S=T[k],E=T[k+2]-S,z=b[k],D=b[k+2]-z;s[k]=2*A/P*E/D,l[k]=2*(L-I)/P*E/D}p[1]=2*i.pixelRatio/(b[3]-b[1]),p[0]=p[1]*(b[3]-b[1])/(b[2]-b[0]),x.uniforms.dataScale=s,x.uniforms.dataShift=l,x.uniforms.textScale=p,this.vbo.bind(),x.attributes.textCoordinate.pointer()}),u.update=function(i){var x,f,_,b,T,k=[],L=i.ticks,A=i.bounds;for(T=0;T<2;++T){var I=[Math.floor(k.length/3)],P=[-1/0],S=L[T];for(x=0;x<S.length;++x){var E=S[x],z=E.x,D=E.text,j=E.font||"sans-serif";b=E.fontSize||12;for(var V=1/(A[T+2]-A[T]),Z=A[T],Q=D.split(`
`),X=0;X<Q.length;X++)for(_=n(j,Q[X]).data,f=0;f<_.length;f+=2)k.push(_[f]*b,-_[f+1]*b-X*b*1.2,(z-Z)*V);I.push(Math.floor(k.length/3)),P.push(z)}this.tickOffset[T]=I,this.tickX[T]=P}for(T=0;T<2;++T){for(this.labelOffset[T]=Math.floor(k.length/3),_=n(i.labelFont[T],i.labels[T],{textAlign:"center"}).data,b=i.labelSize[T],x=0;x<_.length;x+=2)k.push(_[x]*b,-_[x+1]*b,0);this.labelCount[T]=Math.floor(k.length/3)-this.labelOffset[T]}for(this.titleOffset=Math.floor(k.length/3),_=n(i.titleFont,i.title).data,b=i.titleSize,x=0;x<_.length;x+=2)k.push(_[x]*b,-_[x+1]*b,0);this.titleCount=Math.floor(k.length/3)-this.titleOffset,this.vbo.update(k)},u.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":116,"binary-search-bounds":31,"gl-buffer":78,"gl-shader":132,"text-cache":303}],118:[function(v,w,y){w.exports=function(l){var s=l.gl,p=e(s,[s.drawingBufferWidth,s.drawingBufferHeight]),u=new g(s,p);return u.grid=t(u),u.text=n(u),u.line=o(u),u.box=r(u),u.update(l),u};var e=v("gl-select-static"),t=v("./lib/grid"),n=v("./lib/text"),o=v("./lib/line"),r=v("./lib/box");function g(l,s){this.gl=l,this.pickBuffer=s,this.screenBox=[0,0,l.drawingBufferWidth,l.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-1/0,-1/0],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}var c=g.prototype;function a(l){for(var s=l.slice(),p=0;p<s.length;++p)s[p]=s[p].slice();return s}function h(l,s){return l.x-s.x}c.setDirty=function(){this.dirty=this.pickDirty=!0},c.setOverlayDirty=function(){this.dirty=!0},c.nextDepthValue=function(){return this._depthCounter++/65536},c.draw=function(){var l=this.gl,s=this.screenBox,p=this.viewBox,u=this.dataBox,i=this.pixelRatio,x=this.grid,f=this.line,_=this.text,b=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),this.dirty){if(this.dirty=!1,l.bindFramebuffer(l.FRAMEBUFFER,null),l.enable(l.SCISSOR_TEST),l.disable(l.DEPTH_TEST),l.depthFunc(l.LESS),l.depthMask(!1),l.enable(l.BLEND),l.blendEquation(l.FUNC_ADD,l.FUNC_ADD),l.blendFunc(l.ONE,l.ONE_MINUS_SRC_ALPHA),this.borderColor){l.scissor(s[0],s[1],s[2]-s[0],s[3]-s[1]);var T=this.borderColor;l.clearColor(T[0]*T[3],T[1]*T[3],T[2]*T[3],T[3]),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT)}l.scissor(p[0],p[1],p[2]-p[0],p[3]-p[1]),l.viewport(p[0],p[1],p[2]-p[0],p[3]-p[1]);var k=this.backgroundColor;l.clearColor(k[0]*k[3],k[1]*k[3],k[2]*k[3],k[3]),l.clear(l.COLOR_BUFFER_BIT),x.draw();var L=this.zeroLineEnable,A=this.zeroLineColor,I=this.zeroLineWidth;if(L[0]||L[1]){f.bind();for(var P=0;P<2;++P)if(L[P]&&u[P]<=0&&u[P+2]>=0){var S=s[P]-u[P]*(s[P+2]-s[P])/(u[P+2]-u[P]);P===0?f.drawLine(S,s[1],S,s[3],I[P],A[P]):f.drawLine(s[0],S,s[2],S,I[P],A[P])}}for(P=0;P<b.length;++P)b[P].draw();l.viewport(s[0],s[1],s[2]-s[0],s[3]-s[1]),l.scissor(s[0],s[1],s[2]-s[0],s[3]-s[1]),this.grid.drawTickMarks(),f.bind();var E=this.borderLineEnable,z=this.borderLineWidth,D=this.borderLineColor;for(E[1]&&f.drawLine(p[0],p[1]-.5*z[1]*i,p[0],p[3]+.5*z[3]*i,z[1],D[1]),E[0]&&f.drawLine(p[0]-.5*z[0]*i,p[1],p[2]+.5*z[2]*i,p[1],z[0],D[0]),E[3]&&f.drawLine(p[2],p[1]-.5*z[1]*i,p[2],p[3]+.5*z[3]*i,z[3],D[3]),E[2]&&f.drawLine(p[0]-.5*z[0]*i,p[3],p[2]+.5*z[2]*i,p[3],z[2],D[2]),_.bind(),P=0;P<2;++P)_.drawTicks(P);this.titleEnable&&_.drawTitle();var j=this.overlays;for(P=0;P<j.length;++P)j[P].draw();l.disable(l.SCISSOR_TEST),l.disable(l.BLEND),l.depthMask(!0)}},c.drawPick=function(){if(!this.static){var l=this.pickBuffer;this.gl,this._pickTimeout=null,l.begin();for(var s=1,p=this.objects,u=0;u<p.length;++u)s=p[u].drawPick(s);l.end()}},c.pick=function(l,s){if(!this.static){var p=this.pixelRatio,u=this.pickPixelRatio,i=this.viewBox,x=0|Math.round((l-i[0]/p)*u),f=0|Math.round((s-i[1]/p)*u),_=this.pickBuffer.query(x,f,this.pickRadius);if(!_)return null;for(var b=_.id+(_.value[0]<<8)+(_.value[1]<<16)+(_.value[2]<<24),T=this.objects,k=0;k<T.length;++k){var L=T[k].pick(x,f,b);if(L)return L}return null}},c.setScreenBox=function(l){var s=this.screenBox,p=this.pixelRatio;s[0]=0|Math.round(l[0]*p),s[1]=0|Math.round(l[1]*p),s[2]=0|Math.round(l[2]*p),s[3]=0|Math.round(l[3]*p),this.setDirty()},c.setDataBox=function(l){var s=this.dataBox;(s[0]!==l[0]||s[1]!==l[1]||s[2]!==l[2]||s[3]!==l[3])&&(s[0]=l[0],s[1]=l[1],s[2]=l[2],s[3]=l[3],this.setDirty())},c.setViewBox=function(l){var s=this.pixelRatio,p=this.viewBox;p[0]=0|Math.round(l[0]*s),p[1]=0|Math.round(l[1]*s),p[2]=0|Math.round(l[2]*s),p[3]=0|Math.round(l[3]*s);var u=this.pickPixelRatio;this.pickBuffer.shape=[0|Math.round((l[2]-l[0])*u),0|Math.round((l[3]-l[1])*u)],this.setDirty()},c.update=function(l){l=l||{};var s=this.gl;this.pixelRatio=l.pixelRatio||1;var p=this.pixelRatio;this.pickPixelRatio=Math.max(p,1),this.setScreenBox(l.screenBox||[0,0,s.drawingBufferWidth/p,s.drawingBufferHeight/p]),this.screenBox,this.setViewBox(l.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/p,.125*(this.screenBox[3]-this.screenBox[1])/p,.875*(this.screenBox[2]-this.screenBox[0])/p,.875*(this.screenBox[3]-this.screenBox[1])/p]);var u=this.viewBox,i=(u[2]-u[0])/(u[3]-u[1]);this.setDataBox(l.dataBox||[-10,-10/i,10,10/i]),this.borderColor=l.borderColor!==!1&&(l.borderColor||[0,0,0,0]).slice(),this.backgroundColor=(l.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(l.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(l.gridLineWidth||[1,1]).slice(),this.gridLineColor=a(l.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(l.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(l.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=a(l.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(l.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(l.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=a(l.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(l.titleCenter||[.5*(u[0]+u[2])/p,(u[3]+120)/p]).slice(),this.titleEnable=!("titleEnable"in l)||!!l.titleEnable,this.titleAngle=l.titleAngle||0,this.titleColor=(l.titleColor||[0,0,0,1]).slice(),this.labelPad=(l.labelPad||[15,15,15,15]).slice(),this.labelAngle=(l.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(l.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=a(l.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(l.tickPad||[15,15,15,15]).slice(),this.tickAngle=(l.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(l.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=a(l.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(l.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(l.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=a(l.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var x=l.ticks||[[],[]],f=this._tickBounds;f[0]=f[1]=1/0,f[2]=f[3]=-1/0;for(var _=0;_<2;++_){var b=x[_].slice(0);b.length!==0&&(b.sort(h),f[_]=Math.min(f[_],b[0].x),f[_+2]=Math.max(f[_+2],b[b.length-1].x))}this.grid.update({bounds:f,ticks:x}),this.text.update({bounds:f,ticks:x,labels:l.labels||["x","y"],labelSize:l.labelSize||[12,12],labelFont:l.labelFont||["sans-serif","sans-serif"],title:l.title||"",titleSize:l.titleSize||18,titleFont:l.titleFont||"sans-serif"}),this.static=!!l.static,this.setDirty()},c.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var l=this.objects.length-1;l>=0;--l)this.objects[l].dispose();for(this.objects.length=0,l=this.overlays.length-1;l>=0;--l)this.overlays[l].dispose();this.overlays.length=0,this.gl=null},c.addObject=function(l){this.objects.indexOf(l)<0&&(this.objects.push(l),this.setDirty())},c.removeObject=function(l){for(var s=this.objects,p=0;p<s.length;++p)if(s[p]===l){s.splice(p,1),this.setDirty();break}},c.addOverlay=function(l){this.overlays.indexOf(l)<0&&(this.overlays.push(l),this.setOverlayDirty())},c.removeOverlay=function(l){for(var s=this.overlays,p=0;p<s.length;++p)if(s[p]===l){s.splice(p,1),this.setOverlayDirty();break}}},{"./lib/box":113,"./lib/grid":114,"./lib/line":115,"./lib/text":117,"gl-select-static":131}],119:[function(v,w,y){w.exports=function(c,a){c=c||document.body,a=a||{};var h=[.01,1/0];"distanceLimits"in a&&(h[0]=a.distanceLimits[0],h[1]=a.distanceLimits[1]),"zoomMin"in a&&(h[0]=a.zoomMin),"zoomMax"in a&&(h[1]=a.zoomMax);var l=t({center:a.center||[0,0,0],up:a.up||[0,1,0],eye:a.eye||[0,0,10],mode:a.mode||"orbit",distanceLimits:h}),s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],p=0,u=c.clientWidth,i=c.clientHeight,x={keyBindingMode:"rotate",enableWheel:!0,view:l,element:c,delay:a.delay||16,rotateSpeed:a.rotateSpeed||1,zoomSpeed:a.zoomSpeed||1,translateSpeed:a.translateSpeed||1,flipX:!!a.flipX,flipY:!!a.flipY,modes:l.modes,_ortho:a._ortho||a.projection&&a.projection.type==="orthographic"||!1,tick:function(){var f=e(),_=this.delay,b=f-2*_;l.idle(f-_),l.recalcMatrix(b),l.flush(f-(100+2*_));for(var T=!0,k=l.computedMatrix,L=0;L<16;++L)T=T&&s[L]===k[L],s[L]=k[L];var A=c.clientWidth===u&&c.clientHeight===i;return u=c.clientWidth,i=c.clientHeight,T?!A:(p=Math.exp(l.computedRadius[0]),!0)},lookAt:function(f,_,b){l.lookAt(l.lastT(),f,_,b)},rotate:function(f,_,b){l.rotate(l.lastT(),f,_,b)},pan:function(f,_,b){l.pan(l.lastT(),f,_,b)},translate:function(f,_,b){l.translate(l.lastT(),f,_,b)}};return Object.defineProperties(x,{matrix:{get:function(){return l.computedMatrix},set:function(f){return l.setMatrix(l.lastT(),f),l.computedMatrix},enumerable:!0},mode:{get:function(){return l.getMode()},set:function(f){var _=l.computedUp.slice(),b=l.computedEye.slice(),T=l.computedCenter.slice();if(l.setMode(f),f==="turntable"){var k=e();l._active.lookAt(k,b,T,_),l._active.lookAt(k+500,b,T,[0,0,1]),l._active.flush(k)}return l.getMode()},enumerable:!0},center:{get:function(){return l.computedCenter},set:function(f){return l.lookAt(l.lastT(),null,f),l.computedCenter},enumerable:!0},eye:{get:function(){return l.computedEye},set:function(f){return l.lookAt(l.lastT(),f),l.computedEye},enumerable:!0},up:{get:function(){return l.computedUp},set:function(f){return l.lookAt(l.lastT(),null,null,f),l.computedUp},enumerable:!0},distance:{get:function(){return p},set:function(f){return l.setDistance(l.lastT(),f),f},enumerable:!0},distanceLimits:{get:function(){return l.getDistanceLimits(h)},set:function(f){return l.setDistanceLimits(f),f},enumerable:!0}}),c.addEventListener("contextmenu",function(f){return f.preventDefault(),!1}),x._lastX=-1,x._lastY=-1,x._lastMods={shift:!1,control:!1,alt:!1,meta:!1},x.enableMouseListeners=function(){function f(_,b,T,k){var L=x.keyBindingMode;if(L!==!1){var A=L==="rotate",I=L==="pan",P=L==="zoom",S=!!k.control,E=!!k.alt,z=!!k.shift,D=!!(1&_),j=!!(2&_),V=!!(4&_),Z=1/c.clientHeight,Q=Z*(b-x._lastX),X=Z*(T-x._lastY),$=x.flipX?1:-1,re=x.flipY?1:-1,H=Math.PI*x.rotateSpeed,N=e();if(x._lastX!==-1&&x._lastY!==-1&&((A&&D&&!S&&!E&&!z||D&&!S&&!E&&z)&&l.rotate(N,$*H*Q,-re*H*X,0),(I&&D&&!S&&!E&&!z||j||D&&S&&!E&&!z)&&l.pan(N,-x.translateSpeed*Q*p,x.translateSpeed*X*p,0),P&&D&&!S&&!E&&!z||V||D&&!S&&E&&!z)){var U=-x.zoomSpeed*X/window.innerHeight*(N-l.lastT())*100;l.pan(N,0,0,p*(Math.exp(U)-1))}return x._lastX=b,x._lastY=T,x._lastMods=k,!0}}x.mouseListener=n(c,f),c.addEventListener("touchstart",function(_){var b=r(_.changedTouches[0],c);f(0,b[0],b[1],x._lastMods),f(1,b[0],b[1],x._lastMods)},!!g&&{passive:!0}),c.addEventListener("touchmove",function(_){var b=r(_.changedTouches[0],c);f(1,b[0],b[1],x._lastMods),_.preventDefault()},!!g&&{passive:!1}),c.addEventListener("touchend",function(_){f(0,x._lastX,x._lastY,x._lastMods)},!!g&&{passive:!0}),x.wheelListener=o(c,function(_,b){if(x.keyBindingMode!==!1&&x.enableWheel){var T=x.flipX?1:-1,k=x.flipY?1:-1,L=e();if(Math.abs(_)>Math.abs(b))l.rotate(L,0,0,-_*T*Math.PI*x.rotateSpeed/window.innerWidth);else if(!x._ortho){var A=-x.zoomSpeed*k*b/window.innerHeight*(L-l.lastT())/20;l.pan(L,0,0,p*(Math.exp(A)-1))}}},!0)},x.enableMouseListeners(),x};var e=v("right-now"),t=v("3d-view"),n=v("mouse-change"),o=v("mouse-wheel"),r=v("mouse-event-offset"),g=v("has-passive-events")},{"3d-view":7,"has-passive-events":232,"mouse-change":247,"mouse-event-offset":248,"mouse-wheel":250,"right-now":278}],120:[function(v,w,y){var e=v("glslify"),t=v("gl-shader"),n=e([`precision mediump float;
#define GLSLIFY 1
attribute vec2 position;
varying vec2 uv;
void main() {
  uv = position;
  gl_Position = vec4(position, 0, 1);
}`]),o=e([`precision mediump float;
#define GLSLIFY 1

uniform sampler2D accumBuffer;
varying vec2 uv;

void main() {
  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));
  gl_FragColor = min(vec4(1,1,1,1), accum);
}`]);w.exports=function(r){return t(r,n,o,null,[{name:"position",type:"vec2"}])}},{"gl-shader":132,glslify:231}],121:[function(v,w,y){var e=v("./camera.js"),t=v("gl-axes3d"),n=v("gl-axes3d/properties"),o=v("gl-spikes3d"),r=v("gl-select-static"),g=v("gl-fbo"),c=v("a-big-triangle"),a=v("mouse-change"),h=v("gl-mat4/perspective"),l=v("gl-mat4/ortho"),s=v("./lib/shader"),p=v("is-mobile")({tablet:!0,featureDetect:!0});function u(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function i(f){var _=Math.round(Math.log(Math.abs(f))/Math.log(10));if(_<0){var b=Math.round(Math.pow(10,-_));return Math.ceil(f*b)/b}return _>0?(b=Math.round(Math.pow(10,_)),Math.ceil(f/b)*b):Math.ceil(f)}function x(f){return typeof f!="boolean"||f}w.exports={createScene:function(f){(f=f||{}).camera=f.camera||{};var _=f.canvas;_||(_=document.createElement("canvas"),f.container?f.container.appendChild(_):document.body.appendChild(_));var b=f.gl;if(b||(f.glOptions&&(p=!!f.glOptions.preserveDrawingBuffer),b=function(ce,ye){var Se=null;try{(Se=ce.getContext("webgl",ye))||(Se=ce.getContext("experimental-webgl",ye))}catch{return null}return Se}(_,f.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:p})),!b)throw new Error("webgl not supported");var T=f.bounds||[[-10,-10,-10],[10,10,10]],k=new u,L=g(b,b.drawingBufferWidth,b.drawingBufferHeight,{preferFloat:!p}),A=s(b),I=f.cameraObject&&f.cameraObject._ortho===!0||f.camera.projection&&f.camera.projection.type==="orthographic"||!1,P={eye:f.camera.eye||[2,0,0],center:f.camera.center||[0,0,0],up:f.camera.up||[0,1,0],zoomMin:f.camera.zoomMax||.1,zoomMax:f.camera.zoomMin||100,mode:f.camera.mode||"turntable",_ortho:I},S=f.axes||{},E=t(b,S);E.enable=!S.disable;var z=f.spikes||{},D=o(b,z),j=[],V=[],Z=[],Q=[],X=!0,$=!0,re=new Array(16),H=new Array(16),N={view:null,projection:re,model:H,_ortho:!1},U=($=!0,[b.drawingBufferWidth,b.drawingBufferHeight]),te=f.cameraObject||e(_,P),B={gl:b,contextLost:!1,pixelRatio:f.pixelRatio||1,canvas:_,selection:k,camera:te,axes:E,axesPixels:null,spikes:D,bounds:T,objects:j,shape:U,aspect:f.aspectRatio||[1,1,1],pickRadius:f.pickRadius||10,zNear:f.zNear||.01,zFar:f.zFar||1e3,fovy:f.fovy||Math.PI/4,clearColor:f.clearColor||[0,0,0,0],autoResize:x(f.autoResize),autoBounds:x(f.autoBounds),autoScale:!!f.autoScale,autoCenter:x(f.autoCenter),clipToBounds:x(f.clipToBounds),snapToData:!!f.snapToData,onselect:f.onselect||null,onrender:f.onrender||null,onclick:f.onclick||null,cameraParams:N,oncontextloss:null,mouseListener:null,_stopped:!1,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(ce){this.aspect[0]=ce.x,this.aspect[1]=ce.y,this.aspect[2]=ce.z,$=!0},setBounds:function(ce,ye){this.bounds[0][ce]=ye.min,this.bounds[1][ce]=ye.max},setClearColor:function(ce){this.clearColor=ce},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},K=[b.drawingBufferWidth/B.pixelRatio|0,b.drawingBufferHeight/B.pixelRatio|0];function J(){if(!B._stopped&&B.autoResize){var ce=_.parentNode,ye=1,Se=1;ce&&ce!==document.body?(ye=ce.clientWidth,Se=ce.clientHeight):(ye=window.innerWidth,Se=window.innerHeight);var fe=0|Math.ceil(ye*B.pixelRatio),ge=0|Math.ceil(Se*B.pixelRatio);if(fe!==_.width||ge!==_.height){_.width=fe,_.height=ge;var Te=_.style;Te.position=Te.position||"absolute",Te.left="0px",Te.top="0px",Te.width=ye+"px",Te.height=Se+"px",X=!0}}}B.autoResize&&J();function ee(){for(var ce=j.length,ye=Q.length,Se=0;Se<ye;++Se)Z[Se]=0;e:for(Se=0;Se<ce;++Se){var fe=j[Se],ge=fe.pickSlots;if(ge){for(var Te=0;Te<ye;++Te)if(Z[Te]+ge<255){V[Se]=Te,fe.setPickBase(Z[Te]+1),Z[Te]+=ge;continue e}var le=r(b,U);V[Se]=ye,Q.push(le),Z.push(ge),fe.setPickBase(1),ye+=1}else V[Se]=-1}for(;ye>0&&Z[ye-1]===0;)Z.pop(),Q.pop().dispose()}function ne(){if(B.contextLost)return!0;b.isContextLost()&&(B.contextLost=!0,B.mouseListener.enabled=!1,B.selection.object=null,B.oncontextloss&&B.oncontextloss())}window.addEventListener("resize",J),B.update=function(ce){B._stopped||(X=!0,$=!0)},B.add=function(ce){B._stopped||(ce.axes=E,j.push(ce),V.push(-1),X=!0,$=!0,ee())},B.remove=function(ce){if(!B._stopped){var ye=j.indexOf(ce);ye<0||(j.splice(ye,1),V.pop(),X=!0,$=!0,ee())}},B.dispose=function(){if(!B._stopped&&(B._stopped=!0,window.removeEventListener("resize",J),_.removeEventListener("webglcontextlost",ne),B.mouseListener.enabled=!1,!B.contextLost)){E.dispose(),D.dispose();for(var ce=0;ce<j.length;++ce)j[ce].dispose();for(L.dispose(),ce=0;ce<Q.length;++ce)Q[ce].dispose();A.dispose(),b=null,E=null,D=null,j=[]}},B._mouseRotating=!1,B._prevButtons=0,B.enableMouseListeners=function(){B.mouseListener=a(_,function(ce,ye,Se){if(!B._stopped){var fe=Q.length,ge=j.length,Te=k.object;k.distance=1/0,k.mouse[0]=ye,k.mouse[1]=Se,k.object=null,k.screen=null,k.dataCoordinate=k.dataPosition=null;var le=!1;if(ce&&B._prevButtons)B._mouseRotating=!0;else{B._mouseRotating&&($=!0),B._mouseRotating=!1;for(var ve=0;ve<fe;++ve){var Me=Q[ve].query(ye,K[1]-Se-1,B.pickRadius);if(Me){if(Me.distance>k.distance)continue;for(var we=0;we<ge;++we){var de=j[we];if(V[we]===ve){var Ie=de.pick(Me);Ie&&(k.buttons=ce,k.screen=Me.coord,k.distance=Me.distance,k.object=de,k.index=Ie.distance,k.dataPosition=Ie.position,k.dataCoordinate=Ie.dataCoordinate,k.data=Ie,le=!0)}}}}}Te&&Te!==k.object&&(Te.highlight&&Te.highlight(null),X=!0),k.object&&(k.object.highlight&&k.object.highlight(k.data),X=!0),(le=le||k.object!==Te)&&B.onselect&&B.onselect(k),1&ce&&!(1&B._prevButtons)&&B.onclick&&B.onclick(k),B._prevButtons=ce}})},_.addEventListener("webglcontextlost",ne);var se=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],oe=[se[0].slice(),se[1].slice()];function me(){if(!ne()){J();var ce=B.camera.tick();N.view=B.camera.matrix,X=X||ce,$=$||ce,E.pixelRatio=B.pixelRatio,D.pixelRatio=B.pixelRatio;var ye=j.length,Se=se[0],fe=se[1];Se[0]=Se[1]=Se[2]=1/0,fe[0]=fe[1]=fe[2]=-1/0;for(var ge=0;ge<ye;++ge){(ze=j[ge]).pixelRatio=B.pixelRatio,ze.axes=B.axes,X=X||!!ze.dirty,$=$||!!ze.dirty;var Te=ze.bounds;if(Te)for(var le=Te[0],ve=Te[1],Me=0;Me<3;++Me)Se[Me]=Math.min(Se[Me],le[Me]),fe[Me]=Math.max(fe[Me],ve[Me])}var we=B.bounds;if(B.autoBounds)for(Me=0;Me<3;++Me){if(fe[Me]<Se[Me])Se[Me]=-1,fe[Me]=1;else{Se[Me]===fe[Me]&&(Se[Me]-=1,fe[Me]+=1);var de=.05*(fe[Me]-Se[Me]);Se[Me]=Se[Me]-de,fe[Me]=fe[Me]+de}we[0][Me]=Se[Me],we[1][Me]=fe[Me]}var Ie=!1;for(Me=0;Me<3;++Me)Ie=Ie||oe[0][Me]!==we[0][Me]||oe[1][Me]!==we[1][Me],oe[0][Me]=we[0][Me],oe[1][Me]=we[1][Me];if($=$||Ie,X=X||Ie){if(Ie){var De=[0,0,0];for(ge=0;ge<3;++ge)De[ge]=i((we[1][ge]-we[0][ge])/10);E.autoTicks?E.update({bounds:we,tickSpacing:De}):E.update({bounds:we})}var Oe=b.drawingBufferWidth,Ve=b.drawingBufferHeight;for(U[0]=Oe,U[1]=Ve,K[0]=0|Math.max(Oe/B.pixelRatio,1),K[1]=0|Math.max(Ve/B.pixelRatio,1),function(Re,We){var $e=Re.bounds,at=Re.cameraParams,gt=at.projection,xt=at.model,mt=Re.gl.drawingBufferWidth,nt=Re.gl.drawingBufferHeight,Qe=Re.zNear,vt=Re.zFar,jt=Re.fovy,Gt=mt/nt;We?(l(gt,-Gt,Gt,-1,1,Qe,vt),at._ortho=!0):(h(gt,jt,Gt,Qe,vt),at._ortho=!1);for(var $t=0;$t<16;++$t)xt[$t]=0;xt[15]=1;var Zt=0;for($t=0;$t<3;++$t)Zt=Math.max(Zt,$e[1][$t]-$e[0][$t]);for($t=0;$t<3;++$t)Re.autoScale?xt[5*$t]=Re.aspect[$t]/($e[1][$t]-$e[0][$t]):xt[5*$t]=1/Zt,Re.autoCenter&&(xt[12+$t]=.5*-xt[5*$t]*($e[0][$t]+$e[1][$t]))}(B,I),ge=0;ge<ye;++ge)(ze=j[ge]).axesBounds=we,B.clipToBounds&&(ze.clipBounds=we);k.object&&(B.snapToData?D.position=k.dataCoordinate:D.position=k.dataPosition,D.bounds=we),$&&($=!1,function(){if(!ne()){b.colorMask(!0,!0,!0,!0),b.depthMask(!0),b.disable(b.BLEND),b.enable(b.DEPTH_TEST),b.depthFunc(b.LEQUAL);for(var Re=j.length,We=Q.length,$e=0;$e<We;++$e){var at=Q[$e];at.shape=K,at.begin();for(var gt=0;gt<Re;++gt)if(V[gt]===$e){var xt=j[gt];xt.drawPick&&(xt.pixelRatio=1,xt.drawPick(N))}at.end()}}}()),B.axesPixels=n(B.axes,N,Oe,Ve),B.onrender&&B.onrender(),b.bindFramebuffer(b.FRAMEBUFFER,null),b.viewport(0,0,Oe,Ve),B.clearRGBA(),b.depthMask(!0),b.colorMask(!0,!0,!0,!0),b.enable(b.DEPTH_TEST),b.depthFunc(b.LEQUAL),b.disable(b.BLEND),b.disable(b.CULL_FACE);var Fe=!1;for(E.enable&&(Fe=Fe||E.isTransparent(),E.draw(N)),D.axes=E,k.object&&D.draw(N),b.disable(b.CULL_FACE),ge=0;ge<ye;++ge)(ze=j[ge]).axes=E,ze.pixelRatio=B.pixelRatio,ze.isOpaque&&ze.isOpaque()&&ze.draw(N),ze.isTransparent&&ze.isTransparent()&&(Fe=!0);if(Fe){for(L.shape=U,L.bind(),b.clear(b.DEPTH_BUFFER_BIT),b.colorMask(!1,!1,!1,!1),b.depthMask(!0),b.depthFunc(b.LESS),E.enable&&E.isTransparent()&&E.drawTransparent(N),ge=0;ge<ye;++ge)(ze=j[ge]).isOpaque&&ze.isOpaque()&&ze.draw(N);for(b.enable(b.BLEND),b.blendEquation(b.FUNC_ADD),b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA),b.colorMask(!0,!0,!0,!0),b.depthMask(!1),b.clearColor(0,0,0,0),b.clear(b.COLOR_BUFFER_BIT),E.isTransparent()&&E.drawTransparent(N),ge=0;ge<ye;++ge){var ze;(ze=j[ge]).isTransparent&&ze.isTransparent()&&ze.drawTransparent(N)}b.bindFramebuffer(b.FRAMEBUFFER,null),b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA),b.disable(b.DEPTH_TEST),A.bind(),L.color[0].bind(0),A.uniforms.accumBuffer=0,c(b),b.disable(b.BLEND)}for(X=!1,ge=0;ge<ye;++ge)j[ge].dirty=!1}}}return B.enableMouseListeners(),function ce(){B._stopped||B.contextLost||(me(),requestAnimationFrame(ce))}(),B.redraw=function(){B._stopped||(X=!0,me())},B},createCamera:e}},{"./camera.js":119,"./lib/shader":120,"a-big-triangle":8,"gl-axes3d":70,"gl-axes3d/properties":77,"gl-fbo":86,"gl-mat4/ortho":101,"gl-mat4/perspective":102,"gl-select-static":131,"gl-spikes3d":141,"is-mobile":238,"mouse-change":247}],122:[function(v,w,y){var e=v("glslify");y.pointVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;

uniform mat3 matrix;
uniform float pointSize;
uniform float pointCloud;

highp float rand(vec2 co) {
  highp float a = 12.9898;
  highp float b = 78.233;
  highp float c = 43758.5453;
  highp float d = dot(co.xy, vec2(a, b));
  highp float e = mod(d, 3.14);
  return fract(sin(e) * c);
}

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
    // if we don't jitter the point size a bit, overall point cloud
    // saturation 'jumps' on zooming, which is disturbing and confusing
  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);
  if(pointCloud != 0.0) { // pointCloud is truthy
    // get the same square surface as circle would be
    gl_PointSize *= 0.886;
  }
}`]),y.pointFragment=e([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color, borderColor;
uniform float centerFraction;
uniform float pointCloud;

void main() {
  float radius;
  vec4 baseColor;
  if(pointCloud != 0.0) { // pointCloud is truthy
    if(centerFraction == 1.0) {
      gl_FragColor = color;
    } else {
      gl_FragColor = mix(borderColor, color, centerFraction);
    }
  } else {
    radius = length(2.0 * gl_PointCoord.xy - 1.0);
    if(radius > 1.0) {
      discard;
    }
    baseColor = mix(borderColor, color, step(radius, centerFraction));
    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);
  }
}
`]),y.pickVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 position;
attribute vec4 pickId;

uniform mat3 matrix;
uniform float pointSize;
uniform vec4 pickOffset;

varying vec4 fragId;

void main() {
  vec3 hgPosition = matrix * vec3(position, 1);
  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);
  gl_PointSize = pointSize;

  vec4 id = pickId + pickOffset;
  id.y += floor(id.x / 256.0);
  id.x -= floor(id.x / 256.0) * 256.0;

  id.z += floor(id.y / 256.0);
  id.y -= floor(id.y / 256.0) * 256.0;

  id.w += floor(id.z / 256.0);
  id.z -= floor(id.z / 256.0) * 256.0;

  fragId = id;
}
`]),y.pickFragment=e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragId;

void main() {
  float radius = length(2.0 * gl_PointCoord.xy - 1.0);
  if(radius > 1.0) {
    discard;
  }
  gl_FragColor = fragId / 255.0;
}
`])},{glslify:231}],123:[function(v,w,y){var e=v("gl-shader"),t=v("gl-buffer"),n=v("typedarray-pool"),o=v("./lib/shader");function r(h,l,s,p,u){this.plot=h,this.offsetBuffer=l,this.pickBuffer=s,this.shader=p,this.pickShader=u,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}w.exports=function(h,l){var s=h.gl,p=t(s),u=t(s),i=e(s,o.pointVertex,o.pointFragment),x=e(s,o.pickVertex,o.pickFragment),f=new r(h,p,u,i,x);return f.update(l),h.addObject(f),f};var g,c,a=r.prototype;a.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},a.update=function(h){var l;function s(b,T){return b in h?h[b]:T}h=h||{},this.sizeMin=s("sizeMin",.5),this.sizeMax=s("sizeMax",20),this.color=s("color",[1,0,0,1]).slice(),this.areaRatio=s("areaRatio",1),this.borderColor=s("borderColor",[0,0,0,1]).slice(),this.blend=s("blend",!1);var p=h.positions.length>>>1,u=h.positions instanceof Float32Array,i=h.idToIndex instanceof Int32Array&&h.idToIndex.length>=p,x=h.positions,f=u?x:n.mallocFloat32(x.length),_=i?h.idToIndex:n.mallocInt32(p);if(u||f.set(x),!i)for(f.set(x),l=0;l<p;l++)_[l]=l;this.points=x,this.offsetBuffer.update(f),this.pickBuffer.update(_),u||n.free(f),i||n.free(_),this.pointCount=p,this.pickOffset=0},a.unifiedDraw=(g=[1,0,0,0,1,0,0,0,1],c=[0,0,0,0],function(h){var l=h!==void 0,s=l?this.pickShader:this.shader,p=this.plot.gl,u=this.plot.dataBox;if(this.pointCount===0)return h;var i=u[2]-u[0],x=u[3]-u[1],f=function(k,L){var A,I=0,P=k.length>>>1;for(A=0;A<P;A++){var S=k[2*A],E=k[2*A+1];S>=L[0]&&S<=L[2]&&E>=L[1]&&E<=L[3]&&I++}return I}(this.points,u),_=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(f,.33333)));g[0]=2/i,g[4]=2/x,g[6]=-2*u[0]/i-1,g[7]=-2*u[1]/x-1,this.offsetBuffer.bind(),s.bind(),s.attributes.position.pointer(),s.uniforms.matrix=g,s.uniforms.color=this.color,s.uniforms.borderColor=this.borderColor,s.uniforms.pointCloud=_<5,s.uniforms.pointSize=_,s.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),l&&(c[0]=255&h,c[1]=h>>8&255,c[2]=h>>16&255,c[3]=h>>24&255,this.pickBuffer.bind(),s.attributes.pickId.pointer(p.UNSIGNED_BYTE),s.uniforms.pickOffset=c,this.pickOffset=h);var b=p.getParameter(p.BLEND),T=p.getParameter(p.DITHER);return b&&!this.blend&&p.disable(p.BLEND),T&&p.disable(p.DITHER),p.drawArrays(p.POINTS,0,this.pointCount),b&&!this.blend&&p.enable(p.BLEND),T&&p.enable(p.DITHER),h+this.pointCount}),a.draw=a.unifiedDraw,a.drawPick=a.unifiedDraw,a.pick=function(h,l,s){var p=this.pickOffset,u=this.pointCount;if(s<p||s>=p+u)return null;var i=s-p,x=this.points;return{object:this,pointId:i,dataCoord:[x[2*i],x[2*i+1]]}}},{"./lib/shader":122,"gl-buffer":78,"gl-shader":132,"typedarray-pool":308}],124:[function(v,w,y){w.exports=function(e,t,n,o){var r,g,c,a,h,l=t[0],s=t[1],p=t[2],u=t[3],i=n[0],x=n[1],f=n[2],_=n[3];return(g=l*i+s*x+p*f+u*_)<0&&(g=-g,i=-i,x=-x,f=-f,_=-_),1-g>1e-6?(r=Math.acos(g),c=Math.sin(r),a=Math.sin((1-o)*r)/c,h=Math.sin(o*r)/c):(a=1-o,h=o),e[0]=a*l+h*i,e[1]=a*s+h*x,e[2]=a*p+h*f,e[3]=a*u+h*_,e}},{}],125:[function(v,w,y){w.exports=function(e){return e||e===0?e.toString():""}},{}],126:[function(v,w,y){var e=v("vectorize-text");w.exports=function(n,o,r){var g=t[o];if(g||(g=t[o]={}),n in g)return g[n];var c={textAlign:"center",textBaseline:"middle",lineHeight:1,font:o,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},triangles:!0},a=e(n,c);c.triangles=!1;var h,l,s=e(n,c);if(r&&r!==1){for(h=0;h<a.positions.length;++h)for(l=0;l<a.positions[h].length;++l)a.positions[h][l]/=r;for(h=0;h<s.positions.length;++h)for(l=0;l<s.positions[h].length;++l)s.positions[h][l]/=r}var p=[[1/0,1/0],[-1/0,-1/0]],u=s.positions.length;for(h=0;h<u;++h){var i=s.positions[h];for(l=0;l<2;++l)p[0][l]=Math.min(p[0][l],i[l]),p[1][l]=Math.max(p[1][l],i[l])}return g[n]=[a,s,p]};var t={}},{"vectorize-text":311}],127:[function(v,w,y){var e=v("gl-shader"),t=v("glslify"),n=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform vec4 highlightId;
uniform float highlightScale;
uniform mat4 model, view, projection;
uniform vec3 clipBounds[2];

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = 1.0;
    if(distance(highlightId, id) < 0.0001) {
      scale = highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1);
    vec4 viewPosition = view * worldPosition;
    viewPosition = viewPosition / viewPosition.w;
    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),o=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float highlightScale, pixelRatio;
uniform vec4 highlightId;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float scale = pixelRatio;
    if(distance(highlightId.bgr, id.bgr) < 0.001) {
      scale *= highlightScale;
    }

    vec4 worldPosition = model * vec4(position, 1.0);
    vec4 viewPosition = view * worldPosition;
    vec4 clipPosition = projection * viewPosition;
    clipPosition /= clipPosition.w;

    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);
    interpColor = color;
    pickId = id;
    dataCoordinate = position;
  }
}`]),r=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

attribute vec3 position;
attribute vec4 color;
attribute vec2 glyph;
attribute vec4 id;

uniform float highlightScale;
uniform vec4 highlightId;
uniform vec3 axes[2];
uniform mat4 model, view, projection;
uniform vec2 screenSize;
uniform vec3 clipBounds[2];
uniform float scale, pixelRatio;

varying vec4 interpColor;
varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], position)) {

    gl_Position = vec4(0,0,0,0);
  } else {
    float lscale = pixelRatio * scale;
    if(distance(highlightId, id) < 0.0001) {
      lscale *= highlightScale;
    }

    vec4 clipCenter   = projection * view * model * vec4(position, 1);
    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;
    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);

    gl_Position = clipPosition;
    interpColor = color;
    pickId = id;
    dataCoordinate = dataPosition;
  }
}
`]),g=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float opacity;

varying vec4 interpColor;
varying vec3 dataCoordinate;

void main() {
  if (
    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||
    interpColor.a * opacity == 0.
  ) discard;
  gl_FragColor = interpColor * opacity;
}
`]),c=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 fragClipBounds[2];
uniform float pickGroup;

varying vec4 pickId;
varying vec3 dataCoordinate;

void main() {
  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;

  gl_FragColor = vec4(pickGroup, pickId.bgr);
}`]),a=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],h={vertex:n,fragment:g,attributes:a},l={vertex:o,fragment:g,attributes:a},s={vertex:r,fragment:g,attributes:a},p={vertex:n,fragment:c,attributes:a},u={vertex:o,fragment:c,attributes:a},i={vertex:r,fragment:c,attributes:a};function x(f,_){var b=e(f,_),T=b.attributes;return T.position.location=0,T.color.location=1,T.glyph.location=2,T.id.location=3,b}y.createPerspective=function(f){return x(f,h)},y.createOrtho=function(f){return x(f,l)},y.createProject=function(f){return x(f,s)},y.createPickPerspective=function(f){return x(f,p)},y.createPickOrtho=function(f){return x(f,u)},y.createPickProject=function(f){return x(f,i)}},{"gl-shader":132,glslify:231}],128:[function(v,w,y){var e=v("is-string-blank"),t=v("gl-buffer"),n=v("gl-vao"),o=v("typedarray-pool"),r=v("gl-mat4/multiply"),g=v("./lib/shaders"),c=v("./lib/glyphs"),a=v("./lib/get-simple-string"),h=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function l(Z,Q){var X=Z[0],$=Z[1],re=Z[2],H=Z[3];return Z[0]=Q[0]*X+Q[4]*$+Q[8]*re+Q[12]*H,Z[1]=Q[1]*X+Q[5]*$+Q[9]*re+Q[13]*H,Z[2]=Q[2]*X+Q[6]*$+Q[10]*re+Q[14]*H,Z[3]=Q[3]*X+Q[7]*$+Q[11]*re+Q[15]*H,Z}function s(Z,Q,X,$){return l($,$),l($,$),l($,$)}function p(Z,Q){this.index=Z,this.dataCoordinate=this.position=Q}function u(Z){return Z===!0||Z>1?1:Z}function i(Z,Q,X,$,re,H,N,U,te,B,K,J){this.gl=Z,this.pixelRatio=1,this.shader=Q,this.orthoShader=X,this.projectShader=$,this.pointBuffer=re,this.colorBuffer=H,this.glyphBuffer=N,this.idBuffer=U,this.vao=te,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=B,this.pickOrthoShader=K,this.pickProjectShader=J,this.points=[],this._selectResult=new p(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.dirty=!0}w.exports=function(Z){var Q=Z.gl,X=g.createPerspective(Q),$=g.createOrtho(Q),re=g.createProject(Q),H=g.createPickPerspective(Q),N=g.createPickOrtho(Q),U=g.createPickProject(Q),te=t(Q),B=t(Q),K=t(Q),J=t(Q),ee=n(Q,[{buffer:te,size:3,type:Q.FLOAT},{buffer:B,size:4,type:Q.FLOAT},{buffer:K,size:2,type:Q.FLOAT},{buffer:J,size:4,type:Q.UNSIGNED_BYTE,normalized:!0}]),ne=new i(Q,X,$,re,te,B,K,J,ee,H,N,U);return ne.update(Z),ne};var x=i.prototype;x.pickSlots=1,x.setPickBase=function(Z){this.pickId=Z},x.isTransparent=function(){if(this.hasAlpha)return!0;for(var Z=0;Z<3;++Z)if(this.axesProject[Z]&&this.projectHasAlpha)return!0;return!1},x.isOpaque=function(){if(!this.hasAlpha)return!0;for(var Z=0;Z<3;++Z)if(this.axesProject[Z]&&!this.projectHasAlpha)return!0;return!1};var f=[0,0],_=[0,0,0],b=[0,0,0],T=[0,0,0,1],k=[0,0,0,1],L=h.slice(),A=[0,0,0],I=[[0,0,0],[0,0,0]];function P(Z){return Z[0]=Z[1]=Z[2]=0,Z}function S(Z,Q){return Z[0]=Q[0],Z[1]=Q[1],Z[2]=Q[2],Z[3]=1,Z}function E(Z,Q,X,$){return Z[0]=Q[0],Z[1]=Q[1],Z[2]=Q[2],Z[X]=$,Z}function z(Z,Q,X,$){var re,H=Q.axesProject,N=Q.gl,U=Z.uniforms,te=X.model||h,B=X.view||h,K=X.projection||h,J=Q.axesBounds,ee=function(we){for(var de=I,Ie=0;Ie<2;++Ie)for(var De=0;De<3;++De)de[Ie][De]=Math.max(Math.min(we[Ie][De],1e8),-1e8);return de}(Q.clipBounds);re=Q.axes&&Q.axes.lastCubeProps?Q.axes.lastCubeProps.axis:[1,1,1],f[0]=2/N.drawingBufferWidth,f[1]=2/N.drawingBufferHeight,Z.bind(),U.view=B,U.projection=K,U.screenSize=f,U.highlightId=Q.highlightId,U.highlightScale=Q.highlightScale,U.clipBounds=ee,U.pickGroup=Q.pickId/255,U.pixelRatio=$;for(var ne=0;ne<3;++ne)if(H[ne]){U.scale=Q.projectScale[ne],U.opacity=Q.projectOpacity[ne];for(var se=L,oe=0;oe<16;++oe)se[oe]=0;for(oe=0;oe<4;++oe)se[5*oe]=1;se[5*ne]=0,re[ne]<0?se[12+ne]=J[0][ne]:se[12+ne]=J[1][ne],r(se,te,se),U.model=se;var me=(ne+1)%3,ce=(ne+2)%3,ye=P(_),Se=P(b);ye[me]=1,Se[ce]=1;var fe=s(0,0,0,S(T,ye)),ge=s(0,0,0,S(k,Se));if(Math.abs(fe[1])>Math.abs(ge[1])){var Te=fe;fe=ge,ge=Te,Te=ye,ye=Se,Se=Te;var le=me;me=ce,ce=le}fe[0]<0&&(ye[me]=-1),ge[1]>0&&(Se[ce]=-1);var ve=0,Me=0;for(oe=0;oe<4;++oe)ve+=Math.pow(te[4*me+oe],2),Me+=Math.pow(te[4*ce+oe],2);ye[me]/=Math.sqrt(ve),Se[ce]/=Math.sqrt(Me),U.axes[0]=ye,U.axes[1]=Se,U.fragClipBounds[0]=E(A,ee[0],ne,-1e8),U.fragClipBounds[1]=E(A,ee[1],ne,1e8),Q.vao.bind(),Q.vao.draw(N.TRIANGLES,Q.vertexCount),Q.lineWidth>0&&(N.lineWidth(Q.lineWidth*$),Q.vao.draw(N.LINES,Q.lineVertexCount,Q.vertexCount)),Q.vao.unbind()}}var D=[[-1e8,-1e8,-1e8],[1e8,1e8,1e8]];function j(Z,Q,X,$,re,H,N){var U=X.gl;if((H===X.projectHasAlpha||N)&&z(Q,X,$,re),H===X.hasAlpha||N){Z.bind();var te=Z.uniforms;te.model=$.model||h,te.view=$.view||h,te.projection=$.projection||h,f[0]=2/U.drawingBufferWidth,f[1]=2/U.drawingBufferHeight,te.screenSize=f,te.highlightId=X.highlightId,te.highlightScale=X.highlightScale,te.fragClipBounds=D,te.clipBounds=X.axes.bounds,te.opacity=X.opacity,te.pickGroup=X.pickId/255,te.pixelRatio=re,X.vao.bind(),X.vao.draw(U.TRIANGLES,X.vertexCount),X.lineWidth>0&&(U.lineWidth(X.lineWidth*re),X.vao.draw(U.LINES,X.lineVertexCount,X.vertexCount)),X.vao.unbind()}}function V(Z,Q,X,$){var re;re=Array.isArray(Z)?Q<Z.length?Z[Q]:void 0:Z,re=a(re);var H=!0;e(re)&&(re="\u25BC",H=!1);var N=c(re,X,$);return{mesh:N[0],lines:N[1],bounds:N[2],visible:H}}x.draw=function(Z){j(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,Z,this.pixelRatio,!1,!1)},x.drawTransparent=function(Z){j(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,Z,this.pixelRatio,!0,!1)},x.drawPick=function(Z){j(this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader,this.pickProjectShader,this,Z,1,!0,!0)},x.pick=function(Z){if(!Z||Z.id!==this.pickId)return null;var Q=Z.value[2]+(Z.value[1]<<8)+(Z.value[0]<<16);if(Q>=this.pointCount||Q<0)return null;var X=this.points[Q],$=this._selectResult;$.index=Q;for(var re=0;re<3;++re)$.position[re]=$.dataCoordinate[re]=X[re];return $},x.highlight=function(Z){if(Z){var Q=Z.index,X=255&Q,$=Q>>8&255,re=Q>>16&255;this.highlightId=[X/255,$/255,re/255,0]}else this.highlightId=[1,1,1,1]},x.update=function(Z){if("perspective"in(Z=Z||{})&&(this.useOrtho=!Z.perspective),"orthographic"in Z&&(this.useOrtho=!!Z.orthographic),"lineWidth"in Z&&(this.lineWidth=Z.lineWidth),"project"in Z)if(Array.isArray(Z.project))this.axesProject=Z.project;else{var Q=!!Z.project;this.axesProject=[Q,Q,Q]}if("projectScale"in Z)if(Array.isArray(Z.projectScale))this.projectScale=Z.projectScale.slice();else{var X=+Z.projectScale;this.projectScale=[X,X,X]}if(this.projectHasAlpha=!1,"projectOpacity"in Z){Array.isArray(Z.projectOpacity)?this.projectOpacity=Z.projectOpacity.slice():(X=+Z.projectOpacity,this.projectOpacity=[X,X,X]);for(var $=0;$<3;++$)this.projectOpacity[$]=u(this.projectOpacity[$]),this.projectOpacity[$]<1&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in Z&&(this.opacity=u(Z.opacity),this.opacity<1&&(this.hasAlpha=!0)),this.dirty=!0;var re,H,N=Z.position,U=Z.font||"normal",te=Z.alignment||[0,0];if(te.length===2)re=te[0],H=te[1];else for(re=[],H=[],$=0;$<te.length;++$)re[$]=te[$][0],H[$]=te[$][1];var B=[1/0,1/0,1/0],K=[-1/0,-1/0,-1/0],J=Z.glyph,ee=Z.color,ne=Z.size,se=Z.angle,oe=Z.lineColor,me=-1,ce=0,ye=0,Se=0;if(N.length){Se=N.length;e:for($=0;$<Se;++$){for(var fe=N[$],ge=0;ge<3;++ge)if(isNaN(fe[ge])||!isFinite(fe[ge]))continue e;var Te=($e=V(J,$,U,this.pixelRatio)).mesh,le=$e.lines,ve=$e.bounds;ce+=3*Te.cells.length,ye+=2*le.edges.length}}var Me=ce+ye,we=o.mallocFloat(3*Me),de=o.mallocFloat(4*Me),Ie=o.mallocFloat(2*Me),De=o.mallocUint32(Me);if(Me>0){var Oe=0,Ve=ce,Fe=[0,0,0,1],ze=[0,0,0,1],Re=Array.isArray(ee)&&Array.isArray(ee[0]),We=Array.isArray(oe)&&Array.isArray(oe[0]);e:for($=0;$<Se;++$){for(me+=1,fe=N[$],ge=0;ge<3;++ge){if(isNaN(fe[ge])||!isFinite(fe[ge]))continue e;K[ge]=Math.max(K[ge],fe[ge]),B[ge]=Math.min(B[ge],fe[ge])}Te=($e=V(J,$,U,this.pixelRatio)).mesh,le=$e.lines,ve=$e.bounds;var $e,at=$e.visible;if(at)if(Array.isArray(ee)){if((gt=Re?$<ee.length?ee[$]:[0,0,0,0]:ee).length===3){for(ge=0;ge<3;++ge)Fe[ge]=gt[ge];Fe[3]=1}else if(gt.length===4){for(ge=0;ge<4;++ge)Fe[ge]=gt[ge];!this.hasAlpha&&gt[3]<1&&(this.hasAlpha=!0)}}else Fe[0]=Fe[1]=Fe[2]=0,Fe[3]=1;else Fe=[1,1,1,0];if(at)if(Array.isArray(oe)){var gt;if((gt=We?$<oe.length?oe[$]:[0,0,0,0]:oe).length===3){for(ge=0;ge<3;++ge)ze[ge]=gt[ge];ze[ge]=1}else if(gt.length===4){for(ge=0;ge<4;++ge)ze[ge]=gt[ge];!this.hasAlpha&&gt[3]<1&&(this.hasAlpha=!0)}}else ze[0]=ze[1]=ze[2]=0,ze[3]=1;else ze=[1,1,1,0];var xt=.5;at?Array.isArray(ne)?xt=$<ne.length?+ne[$]:12:ne?xt=+ne:this.useOrtho&&(xt=12):xt=0;var mt=0;Array.isArray(se)?mt=$<se.length?+se[$]:0:se&&(mt=+se);var nt=Math.cos(mt),Qe=Math.sin(mt);for(fe=N[$],ge=0;ge<3;++ge)K[ge]=Math.max(K[ge],fe[ge]),B[ge]=Math.min(B[ge],fe[ge]);var vt=re,jt=H;vt=0,Array.isArray(re)?vt=$<re.length?re[$]:0:re&&(vt=re),jt=0,Array.isArray(H)?jt=$<H.length?H[$]:0:H&&(jt=H);var Gt=[vt*=vt>0?1-ve[0][0]:vt<0?1+ve[1][0]:1,jt*=jt>0?1-ve[0][1]:jt<0?1+ve[1][1]:1],$t=Te.cells||[],Zt=Te.positions||[];for(ge=0;ge<$t.length;++ge)for(var cr=$t[ge],Dt=0;Dt<3;++Dt){for(var Ne=0;Ne<3;++Ne)we[3*Oe+Ne]=fe[Ne];for(Ne=0;Ne<4;++Ne)de[4*Oe+Ne]=Fe[Ne];De[Oe]=me;var Ye=Zt[cr[Dt]];Ie[2*Oe]=xt*(nt*Ye[0]-Qe*Ye[1]+Gt[0]),Ie[2*Oe+1]=xt*(Qe*Ye[0]+nt*Ye[1]+Gt[1]),Oe+=1}for($t=le.edges,Zt=le.positions,ge=0;ge<$t.length;++ge)for(cr=$t[ge],Dt=0;Dt<2;++Dt){for(Ne=0;Ne<3;++Ne)we[3*Ve+Ne]=fe[Ne];for(Ne=0;Ne<4;++Ne)de[4*Ve+Ne]=ze[Ne];De[Ve]=me,Ye=Zt[cr[Dt]],Ie[2*Ve]=xt*(nt*Ye[0]-Qe*Ye[1]+Gt[0]),Ie[2*Ve+1]=xt*(Qe*Ye[0]+nt*Ye[1]+Gt[1]),Ve+=1}}}this.bounds=[B,K],this.points=N,this.pointCount=N.length,this.vertexCount=ce,this.lineVertexCount=ye,this.pointBuffer.update(we),this.colorBuffer.update(de),this.glyphBuffer.update(Ie),this.idBuffer.update(De),o.free(we),o.free(de),o.free(Ie),o.free(De)},x.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()}},{"./lib/get-simple-string":125,"./lib/glyphs":126,"./lib/shaders":127,"gl-buffer":78,"gl-mat4/multiply":100,"gl-vao":150,"is-string-blank":239,"typedarray-pool":308}],129:[function(v,w,y){var e=v("glslify");y.boxVertex=e([`precision mediump float;
#define GLSLIFY 1

attribute vec2 vertex;

uniform vec2 cornerA, cornerB;

void main() {
  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);
}
`]),y.boxFragment=e([`precision mediump float;
#define GLSLIFY 1

uniform vec4 color;

void main() {
  gl_FragColor = color;
}
`])},{glslify:231}],130:[function(v,w,y){var e=v("gl-shader"),t=v("gl-buffer"),n=v("./lib/shaders");function o(g,c,a){this.plot=g,this.boxBuffer=c,this.boxShader=a,this.enabled=!0,this.selectBox=[1/0,1/0,-1/0,-1/0],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}w.exports=function(g,c){var a=g.gl,h=t(a,[0,0,0,1,1,0,1,1]),l=e(a,n.boxVertex,n.boxFragment),s=new o(g,h,l);return s.update(c),g.addOverlay(s),s};var r=o.prototype;r.draw=function(){if(this.enabled){var g=this.plot,c=this.selectBox,a=this.borderWidth,h=(this.innerFill,this.innerColor),l=(this.outerFill,this.outerColor),s=this.borderColor,p=g.box,u=g.screenBox,i=g.dataBox,x=g.viewBox,f=g.pixelRatio,_=(c[0]-i[0])*(x[2]-x[0])/(i[2]-i[0])+x[0],b=(c[1]-i[1])*(x[3]-x[1])/(i[3]-i[1])+x[1],T=(c[2]-i[0])*(x[2]-x[0])/(i[2]-i[0])+x[0],k=(c[3]-i[1])*(x[3]-x[1])/(i[3]-i[1])+x[1];if(_=Math.max(_,x[0]),b=Math.max(b,x[1]),T=Math.min(T,x[2]),k=Math.min(k,x[3]),!(T<_||k<b)){p.bind();var L=u[2]-u[0],A=u[3]-u[1];if(this.outerFill&&(p.drawBox(0,0,L,b,l),p.drawBox(0,b,_,k,l),p.drawBox(0,k,L,A,l),p.drawBox(T,b,L,k,l)),this.innerFill&&p.drawBox(_,b,T,k,h),a>0){var I=a*f;p.drawBox(_-I,b-I,T+I,b+I,s),p.drawBox(_-I,k-I,T+I,k+I,s),p.drawBox(_-I,b-I,_+I,k+I,s),p.drawBox(T-I,b-I,T+I,k+I,s)}}}},r.update=function(g){g=g||{},this.innerFill=!!g.innerFill,this.outerFill=!!g.outerFill,this.innerColor=(g.innerColor||[0,0,0,.5]).slice(),this.outerColor=(g.outerColor||[0,0,0,.5]).slice(),this.borderColor=(g.borderColor||[0,0,0,1]).slice(),this.borderWidth=g.borderWidth||0,this.selectBox=(g.selectBox||this.selectBox).slice()},r.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)}},{"./lib/shaders":129,"gl-buffer":78,"gl-shader":132}],131:[function(v,w,y){w.exports=function(a,h){var l=h[0],s=h[1],p=e(a,l,s,{}),u=t.mallocUint8(l*s*4);return new g(a,p,u)};var e=v("gl-fbo"),t=v("typedarray-pool"),n=v("ndarray"),o=v("bit-twiddle").nextPow2;function r(a,h,l,s,p){this.coord=[a,h],this.id=l,this.value=s,this.distance=p}function g(a,h,l){this.gl=a,this.fbo=h,this.buffer=l,this._readTimeout=null;var s=this;this._readCallback=function(){s.gl&&(h.bind(),a.readPixels(0,0,h.shape[0],h.shape[1],a.RGBA,a.UNSIGNED_BYTE,s.buffer),s._readTimeout=null)}}var c=g.prototype;Object.defineProperty(c,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(a){if(this.gl){this.fbo.shape=a;var h=this.fbo.shape[0],l=this.fbo.shape[1];if(l*h*4>this.buffer.length){t.free(this.buffer);for(var s=this.buffer=t.mallocUint8(o(l*h*4)),p=0;p<l*h*4;++p)s[p]=255}return a}}}),c.begin=function(){var a=this.gl;this.shape,a&&(this.fbo.bind(),a.clearColor(1,1,1,1),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT))},c.end=function(){var a=this.gl;a&&(a.bindFramebuffer(a.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},c.query=function(a,h,l){if(!this.gl)return null;var s=this.fbo.shape.slice();a|=0,h|=0,typeof l!="number"&&(l=1);var p=0|Math.min(Math.max(a-l,0),s[0]),u=0|Math.min(Math.max(a+l,0),s[0]),i=0|Math.min(Math.max(h-l,0),s[1]),x=0|Math.min(Math.max(h+l,0),s[1]);if(u<=p||x<=i)return null;var f=[u-p,x-i],_=n(this.buffer,[f[0],f[1],4],[4,4*s[0],1],4*(p+s[0]*i)),b=function(L,A,I){for(var P=1e8,S=-1,E=-1,z=L.shape[0],D=L.shape[1],j=0;j<z;j++)for(var V=0;V<D;V++){var Z=L.get(j,V,0),Q=L.get(j,V,1),X=L.get(j,V,2),$=L.get(j,V,3);if(Z<255||Q<255||X<255||$<255){var re=A-j,H=I-V,N=re*re+H*H;N<P&&(P=N,S=j,E=V)}}return[S,E,P]}(_.hi(f[0],f[1],1),l,l),T=b[0],k=b[1];return T<0||Math.pow(this.radius,2)<b[2]?null:new r(T+p|0,k+i|0,_.get(T,k,0),[_.get(T,k,1),_.get(T,k,2),_.get(T,k,3)],Math.sqrt(b[2]))},c.dispose=function(){this.gl&&(this.fbo.dispose(),t.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))}},{"bit-twiddle":32,"gl-fbo":86,ndarray:259,"typedarray-pool":308}],132:[function(v,w,y){var e=v("./lib/create-uniforms"),t=v("./lib/create-attributes"),n=v("./lib/reflect"),o=v("./lib/shader-cache"),r=v("./lib/runtime-reflect"),g=v("./lib/GLError");function c(l){this.gl=l,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var a=c.prototype;function h(l,s){return l.name<s.name?-1:1}a.bind=function(){var l;this.program||this._relink();var s=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),p=this.gl.lastAttribCount;if(s>p)for(l=p;l<s;l++)this.gl.enableVertexAttribArray(l);else if(p>s)for(l=s;l<p;l++)this.gl.disableVertexAttribArray(l);this.gl.lastAttribCount=s,this.gl.useProgram(this.program)},a.dispose=function(){for(var l=this.gl.lastAttribCount,s=0;s<l;s++)this.gl.disableVertexAttribArray(s);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},a.update=function(l,s,p,u){if(!s||arguments.length===1){var i=l;l=i.vertex,s=i.fragment,p=i.uniforms,u=i.attributes}var x=this,f=x.gl,_=x._vref;x._vref=o.shader(f,f.VERTEX_SHADER,l),_&&_.dispose(),x.vertShader=x._vref.shader;var b=this._fref;if(x._fref=o.shader(f,f.FRAGMENT_SHADER,s),b&&b.dispose(),x.fragShader=x._fref.shader,!p||!u){var T=f.createProgram();if(f.attachShader(T,x.fragShader),f.attachShader(T,x.vertShader),f.linkProgram(T),!f.getProgramParameter(T,f.LINK_STATUS)){var k=f.getProgramInfoLog(T);throw new g(k,"Error linking program:"+k)}p=p||r.uniforms(f,T),u=u||r.attributes(f,T),f.deleteProgram(T)}(u=u.slice()).sort(h);var L,A=[],I=[],P=[];for(L=0;L<u.length;++L){var S=u[L];if(S.type.indexOf("mat")>=0){for(var E=0|S.type.charAt(S.type.length-1),z=new Array(E),D=0;D<E;++D)z[D]=P.length,I.push(S.name+"["+D+"]"),typeof S.location=="number"?P.push(S.location+D):Array.isArray(S.location)&&S.location.length===E&&typeof S.location[D]=="number"?P.push(0|S.location[D]):P.push(-1);A.push({name:S.name,type:S.type,locations:z})}else A.push({name:S.name,type:S.type,locations:[P.length]}),I.push(S.name),typeof S.location=="number"?P.push(0|S.location):P.push(-1)}var j=0;for(L=0;L<P.length;++L)if(P[L]<0){for(;P.indexOf(j)>=0;)j+=1;P[L]=j}var V=new Array(p.length);function Z(){x.program=o.program(f,x._vref,x._fref,I,P);for(var Q=0;Q<p.length;++Q)V[Q]=f.getUniformLocation(x.program,p[Q].name)}Z(),x._relink=Z,x.types={uniforms:n(p),attributes:n(u)},x.attributes=t(f,x,A,P),Object.defineProperty(x,"uniforms",e(f,x,p,V))},w.exports=function(l,s,p,u,i){var x=new c(l);return x.update(s,p,u,i),x}},{"./lib/GLError":133,"./lib/create-attributes":134,"./lib/create-uniforms":135,"./lib/reflect":136,"./lib/runtime-reflect":137,"./lib/shader-cache":138}],133:[function(v,w,y){function e(t,n,o){this.shortMessage=n||"",this.longMessage=o||"",this.rawError=t||"",this.message="gl-shader: "+(n||t||"")+(o?`
`+o:""),this.stack=new Error().stack}e.prototype=new Error,e.prototype.name="GLError",e.prototype.constructor=e,w.exports=e},{}],134:[function(v,w,y){w.exports=function(c,a,h,l){for(var s={},p=0,u=h.length;p<u;++p){var i=h[p],x=i.name,f=i.type,_=i.locations;switch(f){case"bool":case"int":case"float":r(c,a,_[0],l,1,s,x);break;default:if(f.indexOf("vec")>=0){if((b=f.charCodeAt(f.length-1)-48)<2||b>4)throw new e("","Invalid data type for attribute "+x+": "+f);r(c,a,_[0],l,b,s,x)}else{if(!(f.indexOf("mat")>=0))throw new e("","Unknown data type for attribute "+x+": "+f);var b;if((b=f.charCodeAt(f.length-1)-48)<2||b>4)throw new e("","Invalid data type for attribute "+x+": "+f);g(c,a,_,l,b,s,x)}}}return s};var e=v("./GLError");function t(c,a,h,l,s,p){this._gl=c,this._wrapper=a,this._index=h,this._locations=l,this._dimension=s,this._constFunc=p}var n=t.prototype;n.pointer=function(c,a,h,l){var s=this._gl,p=this._locations[this._index];s.vertexAttribPointer(p,this._dimension,c||s.FLOAT,!!a,h||0,l||0),s.enableVertexAttribArray(p)},n.set=function(c,a,h,l){return this._constFunc(this._locations[this._index],c,a,h,l)},Object.defineProperty(n,"location",{get:function(){return this._locations[this._index]},set:function(c){return c!==this._locations[this._index]&&(this._locations[this._index]=0|c,this._wrapper.program=null),0|c}});var o=[function(c,a,h){return h.length===void 0?c.vertexAttrib1f(a,h):c.vertexAttrib1fv(a,h)},function(c,a,h,l){return h.length===void 0?c.vertexAttrib2f(a,h,l):c.vertexAttrib2fv(a,h)},function(c,a,h,l,s){return h.length===void 0?c.vertexAttrib3f(a,h,l,s):c.vertexAttrib3fv(a,h)},function(c,a,h,l,s,p){return h.length===void 0?c.vertexAttrib4f(a,h,l,s,p):c.vertexAttrib4fv(a,h)}];function r(c,a,h,l,s,p,u){var i=o[s],x=new t(c,a,h,l,s,i);Object.defineProperty(p,u,{set:function(f){return c.disableVertexAttribArray(l[h]),i(c,l[h],f),f},get:function(){return x},enumerable:!0})}function g(c,a,h,l,s,p,u){for(var i=new Array(s),x=new Array(s),f=0;f<s;++f)r(c,a,h[f],l,s,i,f),x[f]=i[f];Object.defineProperty(i,"location",{set:function(T){if(Array.isArray(T))for(var k=0;k<s;++k)x[k].location=T[k];else for(k=0;k<s;++k)x[k].location=T+k;return T},get:function(){for(var T=new Array(s),k=0;k<s;++k)T[k]=l[h[k]];return T},enumerable:!0}),i.pointer=function(T,k,L,A){T=T||c.FLOAT,k=!!k,L=L||s*s,A=A||0;for(var I=0;I<s;++I){var P=l[h[I]];c.vertexAttribPointer(P,s,T,k,L,A+I*s),c.enableVertexAttribArray(P)}};var _=new Array(s),b=c["vertexAttrib"+s+"fv"];Object.defineProperty(p,u,{set:function(T){for(var k=0;k<s;++k){var L=l[h[k]];if(c.disableVertexAttribArray(L),Array.isArray(T[0]))b.call(c,L,T[k]);else{for(var A=0;A<s;++A)_[A]=T[s*k+A];b.call(c,L,_)}}return T},get:function(){return i},enumerable:!0})}},{"./GLError":133}],135:[function(v,w,y){var e=v("./reflect"),t=v("./GLError");function n(r){return function(){return r}}function o(r,g){for(var c=new Array(r),a=0;a<r;++a)c[a]=g;return c}w.exports=function(r,g,c,a){function h(u){return function(i){for(var x=function D(j,V){if(typeof V!="object")return[[j,V]];var Z=[];for(var Q in V){var X=V[Q],$=j;parseInt(Q)+""===Q?$+="["+Q+"]":$+="."+Q,typeof X=="object"?Z.push.apply(Z,D($,X)):Z.push([$,X])}return Z}("",u),f=0;f<x.length;++f){var _=x[f],b=_[0],T=_[1];if(a[T]){var k=i;if(typeof b=="string"&&(b.indexOf(".")===0||b.indexOf("[")===0)){var L=b;if(b.indexOf(".")===0&&(L=b.slice(1)),L.indexOf("]")===L.length-1){var A=L.indexOf("["),I=L.slice(0,A),P=L.slice(A+1,L.length-1);k=I?i[I][P]:i[P]}else k=i[L]}var S,E=c[T].type;switch(E){case"bool":case"int":case"sampler2D":case"samplerCube":r.uniform1i(a[T],k);break;case"float":r.uniform1f(a[T],k);break;default:var z=E.indexOf("vec");if(!(0<=z&&z<=1&&E.length===4+z)){if(E.indexOf("mat")===0&&E.length===4){if((S=E.charCodeAt(E.length-1)-48)<2||S>4)throw new t("","Invalid uniform dimension type for matrix "+name+": "+E);r["uniformMatrix"+S+"fv"](a[T],!1,k);break}throw new t("","Unknown uniform data type for "+name+": "+E)}if((S=E.charCodeAt(E.length-1)-48)<2||S>4)throw new t("","Invalid data type");switch(E.charAt(0)){case"b":case"i":r["uniform"+S+"iv"](a[T],k);break;case"v":r["uniform"+S+"fv"](a[T],k);break;default:throw new t("","Unrecognized data type for vector "+name+": "+E)}}}}}}function l(u,i,x){if(typeof x=="object"){var f=s(x);Object.defineProperty(u,i,{get:n(f),set:h(x),enumerable:!0,configurable:!1})}else a[x]?Object.defineProperty(u,i,{get:(_=x,function(b,T,k){return b.getUniform(T.program,k[_])}),set:h(x),enumerable:!0,configurable:!1}):u[i]=function(b){switch(b){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":case"float":return 0;default:var T=b.indexOf("vec");if(0<=T&&T<=1&&b.length===4+T){if((k=b.charCodeAt(b.length-1)-48)<2||k>4)throw new t("","Invalid data type");return b.charAt(0)==="b"?o(k,!1):o(k,0)}if(b.indexOf("mat")===0&&b.length===4){var k;if((k=b.charCodeAt(b.length-1)-48)<2||k>4)throw new t("","Invalid uniform dimension type for matrix "+name+": "+b);return o(k*k,0)}throw new t("","Unknown uniform data type for "+name+": "+b)}}(c[x].type);var _}function s(u){var i;if(Array.isArray(u)){i=new Array(u.length);for(var x=0;x<u.length;++x)l(i,x,u[x])}else for(var f in i={},u)l(i,f,u[f]);return i}var p=e(c,!0);return{get:n(s(p)),set:h(p),enumerable:!0,configurable:!0}}},{"./GLError":133,"./reflect":136}],136:[function(v,w,y){w.exports=function(e,t){for(var n={},o=0;o<e.length;++o)for(var r=e[o].name.split("."),g=n,c=0;c<r.length;++c){var a=r[c].split("[");if(a.length>1){a[0]in g||(g[a[0]]=[]),g=g[a[0]];for(var h=1;h<a.length;++h){var l=parseInt(a[h]);h<a.length-1||c<r.length-1?(l in g||(h<a.length-1?g[l]=[]:g[l]={}),g=g[l]):g[l]=t?o:e[o].type}}else c<r.length-1?(a[0]in g||(g[a[0]]={}),g=g[a[0]]):g[a[0]]=t?o:e[o].type}return n}},{}],137:[function(v,w,y){y.uniforms=function(o,r){for(var g=o.getProgramParameter(r,o.ACTIVE_UNIFORMS),c=[],a=0;a<g;++a){var h=o.getActiveUniform(r,a);if(h){var l=n(o,h.type);if(h.size>1)for(var s=0;s<h.size;++s)c.push({name:h.name.replace("[0]","["+s+"]"),type:l});else c.push({name:h.name,type:l})}}return c},y.attributes=function(o,r){for(var g=o.getProgramParameter(r,o.ACTIVE_ATTRIBUTES),c=[],a=0;a<g;++a){var h=o.getActiveAttrib(r,a);h&&c.push({name:h.name,type:n(o,h.type)})}return c};var e={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},t=null;function n(o,r){if(!t){var g=Object.keys(e);t={};for(var c=0;c<g.length;++c){var a=g[c];t[o[a]]=e[a]}}return t[r]}},{}],138:[function(v,w,y){y.shader=function(h,l,s){return a(h).getShaderReference(l,s)},y.program=function(h,l,s,p,u){return a(h).getProgram(l,s,p,u)};var e=v("./GLError"),t=v("gl-format-compiler-error"),n=new(typeof WeakMap>"u"?v("weakmap-shim"):WeakMap),o=0;function r(h,l,s,p,u,i,x){this.id=h,this.src=l,this.type=s,this.shader=p,this.count=i,this.programs=[],this.cache=x}function g(h){this.gl=h,this.shaders=[{},{}],this.programs={}}r.prototype.dispose=function(){if(--this.count==0){for(var h=this.cache,l=h.gl,s=this.programs,p=0,u=s.length;p<u;++p){var i=h.programs[s[p]];i&&(delete h.programs[p],l.deleteProgram(i))}l.deleteShader(this.shader),delete h.shaders[this.type===l.FRAGMENT_SHADER|0][this.src]}};var c=g.prototype;function a(h){var l=n.get(h);return l||(l=new g(h),n.set(h,l)),l}c.getShaderReference=function(h,l){var s=this.gl,p=this.shaders[h===s.FRAGMENT_SHADER|0],u=p[l];if(u&&s.isShader(u.shader))u.count+=1;else{var i=function(x,f,_){var b=x.createShader(f);if(x.shaderSource(b,_),x.compileShader(b),!x.getShaderParameter(b,x.COMPILE_STATUS)){var T=x.getShaderInfoLog(b);try{var k=t(T,_,f)}catch(L){throw console.warn("Failed to format compiler error: "+L),new e(T,`Error compiling shader:
`+T)}throw new e(T,k.short,k.long)}return b}(s,h,l);u=p[l]=new r(o++,l,h,i,[],1,this)}return u},c.getProgram=function(h,l,s,p){var u=[h.id,l.id,s.join(":"),p.join(":")].join("@"),i=this.programs[u];return i&&this.gl.isProgram(i)||(this.programs[u]=i=function(x,f,_,b,T){var k=x.createProgram();x.attachShader(k,f),x.attachShader(k,_);for(var L=0;L<b.length;++L)x.bindAttribLocation(k,T[L],b[L]);if(x.linkProgram(k),!x.getProgramParameter(k,x.LINK_STATUS)){var A=x.getProgramInfoLog(k);throw new e(A,"Error linking program: "+A)}return k}(this.gl,h.shader,l.shader,s,p),h.programs.push(u),l.programs.push(u)),i}},{"./GLError":133,"gl-format-compiler-error":87,"weakmap-shim":316}],139:[function(v,w,y){function e(n){this.plot=n,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}w.exports=function(n,o){var r=new e(n);return r.update(o),n.addOverlay(r),r};var t=e.prototype;t.update=function(n){n=n||{},this.enable=(n.enable||[!0,!0,!1,!1]).slice(),this.width=(n.width||[1,1,1,1]).slice(),this.color=(n.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map(function(o){return o.slice()}),this.center=(n.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},t.draw=function(){var n=this.enable,o=this.width,r=this.color,g=this.center,c=this.plot,a=c.line,h=c.dataBox,l=c.viewBox;if(a.bind(),h[0]<=g[0]&&g[0]<=h[2]&&h[1]<=g[1]&&g[1]<=h[3]){var s=l[0]+(g[0]-h[0])/(h[2]-h[0])*(l[2]-l[0]),p=l[1]+(g[1]-h[1])/(h[3]-h[1])*(l[3]-l[1]);n[0]&&a.drawLine(s,p,l[0],p,o[0],r[0]),n[1]&&a.drawLine(s,p,s,l[1],o[1],r[1]),n[2]&&a.drawLine(s,p,l[2],p,o[2],r[2]),n[3]&&a.drawLine(s,p,s,l[3],o[3],r[3])}},t.dispose=function(){this.plot.removeOverlay(this)}},{}],140:[function(v,w,y){var e=v("glslify"),t=v("gl-shader"),n=e([`precision mediump float;
#define GLSLIFY 1

attribute vec3 position, color;
attribute float weight;

uniform mat4 model, view, projection;
uniform vec3 coordinates[3];
uniform vec4 colors[3];
uniform vec2 screenShape;
uniform float lineWidth;

varying vec4 fragColor;

void main() {
  vec3 vertexPosition = mix(coordinates[0],
    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));

  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);
  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;
  vec2 delta = weight * clipOffset * screenShape;
  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;

  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);
  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];
}
`]),o=e([`precision mediump float;
#define GLSLIFY 1

varying vec4 fragColor;

void main() {
  gl_FragColor = fragColor;
}`]);w.exports=function(r){return t(r,n,o,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":132,glslify:231}],141:[function(v,w,y){var e=v("gl-buffer"),t=v("gl-vao"),n=v("./shaders/index");w.exports=function(l,s){var p=[];function u(b,T,k,L,A,I){var P=[b,T,k,0,0,0,1];P[L+3]=1,P[L]=A,p.push.apply(p,P),P[6]=-1,p.push.apply(p,P),P[L]=I,p.push.apply(p,P),p.push.apply(p,P),P[6]=1,p.push.apply(p,P),P[L]=A,p.push.apply(p,P)}u(0,0,0,0,0,1),u(0,0,0,1,0,1),u(0,0,0,2,0,1),u(1,0,0,1,-1,1),u(1,0,0,2,-1,1),u(0,1,0,0,-1,1),u(0,1,0,2,-1,1),u(0,0,1,0,-1,1),u(0,0,1,1,-1,1);var i=e(l,p),x=t(l,[{type:l.FLOAT,buffer:i,size:3,offset:0,stride:28},{type:l.FLOAT,buffer:i,size:3,offset:12,stride:28},{type:l.FLOAT,buffer:i,size:1,offset:24,stride:28}]),f=n(l);f.attributes.position.location=0,f.attributes.color.location=1,f.attributes.weight.location=2;var _=new r(l,i,x,f);return _.update(s),_};var o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function r(l,s,p,u){this.gl=l,this.buffer=s,this.vao=p,this.shader=u,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var g=r.prototype,c=[0,0,0],a=[0,0,0],h=[0,0];g.isTransparent=function(){return!1},g.drawTransparent=function(l){},g.draw=function(l){var s=this.gl,p=this.vao,u=this.shader;p.bind(),u.bind();var i,x=l.model||o,f=l.view||o,_=l.projection||o;this.axes&&(i=this.axes.lastCubeProps.axis);for(var b=c,T=a,k=0;k<3;++k)i&&i[k]<0?(b[k]=this.bounds[0][k],T[k]=this.bounds[1][k]):(b[k]=this.bounds[1][k],T[k]=this.bounds[0][k]);for(h[0]=s.drawingBufferWidth,h[1]=s.drawingBufferHeight,u.uniforms.model=x,u.uniforms.view=f,u.uniforms.projection=_,u.uniforms.coordinates=[this.position,b,T],u.uniforms.colors=this.colors,u.uniforms.screenShape=h,k=0;k<3;++k)u.uniforms.lineWidth=this.lineWidth[k]*this.pixelRatio,this.enabled[k]&&(p.draw(s.TRIANGLES,6,6*k),this.drawSides[k]&&p.draw(s.TRIANGLES,12,18+12*k));p.unbind()},g.update=function(l){l&&("bounds"in l&&(this.bounds=l.bounds),"position"in l&&(this.position=l.position),"lineWidth"in l&&(this.lineWidth=l.lineWidth),"colors"in l&&(this.colors=l.colors),"enabled"in l&&(this.enabled=l.enabled),"drawSides"in l&&(this.drawSides=l.drawSides))},g.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders/index":140,"gl-buffer":78,"gl-vao":150}],142:[function(v,w,y){var e=v("glslify"),t=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 color, position;
attribute vec2 uv;

uniform float vectorScale, tubeScale;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 eyePosition, lightPosition;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  // Scale the vector magnitude to stay constant with
  // model & view changes.
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * tubePosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  f_lightDirection = lightPosition - cameraCoordinate.xyz;
  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;
  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);

  // vec4 m_position  = model * vec4(tubePosition, 1.0);
  vec4 t_position  = view * tubePosition;
  gl_Position      = projection * t_position;

  f_color          = color;
  f_data           = tubePosition.xyz;
  f_position       = position.xyz;
  f_uv             = uv;
}
`]),n=e([`#extension GL_OES_standard_derivatives : enable

precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float cookTorranceSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness,
  float fresnel) {

  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);
  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);

  //Half angle vector
  vec3 H = normalize(lightDirection + viewDirection);

  //Geometric term
  float NdotH = max(dot(surfaceNormal, H), 0.0);
  float VdotH = max(dot(viewDirection, H), 0.000001);
  float LdotH = max(dot(lightDirection, H), 0.000001);
  float G1 = (2.0 * NdotH * VdotN) / VdotH;
  float G2 = (2.0 * NdotH * LdotN) / LdotH;
  float G = min(1.0, min(G1, G2));
  
  //Distribution term
  float D = beckmannDistribution(NdotH, roughness);

  //Fresnel term
  float F = pow(1.0 - VdotN, fresnel);

  //Multiply terms and done
  return  G * F * D / max(3.14159265 * VdotN, 0.000001);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform sampler2D texture;

varying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;
varying vec4 f_color;
varying vec2 f_uv;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;
  vec3 N = normalize(f_normal);
  vec3 L = normalize(f_lightDirection);
  vec3 V = normalize(f_eyeDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  vec4 surfaceColor = f_color * texture2D(texture, f_uv);
  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = litColor * opacity;
}
`]),o=e([`precision highp float;

precision highp float;
#define GLSLIFY 1

vec3 getOrthogonalVector(vec3 v) {
  // Return up-vector for only-z vector.
  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).
  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.
  // Assign z = 0, x = -b, y = a:
  // a*-b + b*a + c*0 = -ba + ba + 0 = 0
  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {
    return normalize(vec3(-v.y, v.x, 0.0));
  } else {
    return normalize(vec3(0.0, v.z, -v.y));
  }
}

// Calculate the tube vertex and normal at the given index.
//
// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.
//
// Each tube segment is made up of a ring of vertices.
// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.
// The indexes of tube segments run from 0 to 8.
//
vec3 getTubePosition(vec3 d, float index, out vec3 normal) {
  float segmentCount = 8.0;

  float angle = 2.0 * 3.14159 * (index / segmentCount);

  vec3 u = getOrthogonalVector(d);
  vec3 v = normalize(cross(u, d));

  vec3 x = u * cos(angle) * length(d);
  vec3 y = v * sin(angle) * length(d);
  vec3 v3 = x + y;

  normal = normalize(v3);

  return v3;
}

attribute vec4 vector;
attribute vec4 position;
attribute vec4 id;

uniform mat4 model, view, projection;
uniform float tubeScale;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  vec3 normal;
  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);
  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);

  gl_Position = projection * view * tubePosition;
  f_id        = id;
  f_position  = position.xyz;
}
`]),r=e([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3  clipBounds[2];
uniform float pickId;

varying vec3 f_position;
varying vec4 f_id;

void main() {
  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;

  gl_FragColor = vec4(pickId, f_id.xyz);
}`]);y.meshShader={vertex:t,fragment:n,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},y.pickShader={vertex:o,fragment:r,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:231}],143:[function(v,w,y){var e=v("gl-vec3"),t=v("gl-vec4"),n=["xyz","xzy","yxz","yzx","zxy","zyx"],o=function(l,s,p,u){for(var i=0,x=0;x<l.length;x++)for(var f=l[x].velocities,_=0;_<f.length;_++)i=Math.max(i,e.length(f[_]));var b=l.map(function(D){return function(j,V,Z,Q){for(var X=j.points,$=j.velocities,re=j.divergences,H=[],N=[],U=[],te=[],B=[],K=[],J=0,ee=0,ne=t.create(),se=t.create(),oe=0;oe<X.length;oe++){var me=X[oe],ce=$[oe],ye=re[oe];V===0&&(ye=.05*Z),ee=e.length(ce)/Q,ne=t.create(),e.copy(ne,ce),ne[3]=ye;for(var Se=0;Se<8;Se++)B[Se]=[me[0],me[1],me[2],Se];if(te.length>0)for(Se=0;Se<8;Se++){var fe=(Se+1)%8;H.push(te[Se],B[Se],B[fe],B[fe],te[fe],te[Se]),U.push(se,ne,ne,ne,se,se),K.push(J,ee,ee,ee,J,J);var ge=H.length;N.push([ge-6,ge-5,ge-4],[ge-3,ge-2,ge-1])}var Te=te;te=B,B=Te;var le=se;se=ne,ne=le;var ve=J;J=ee,ee=ve}return{positions:H,cells:N,vectors:U,vertexIntensity:K}}(D,p,u,i)}),T=[],k=[],L=[],A=[];for(x=0;x<b.length;x++){var I=b[x],P=T.length;for(T=T.concat(I.positions),L=L.concat(I.vectors),A=A.concat(I.vertexIntensity),_=0;_<I.cells.length;_++){var S=I.cells[_],E=[];k.push(E);for(var z=0;z<S.length;z++)E.push(S[z]+P)}}return{positions:T,cells:k,vectors:L,vertexIntensity:A,colormap:s}},r=function(l,s){var p,u=l.length;for(p=0;p<u;p++){var i=l[p];if(i===s)return p;if(i>s)return p-1}return p},g=function(l,s,p){return l<s?s:l>p?p:l},c=function(l){var s=1/0;l.sort(function(x,f){return x-f});for(var p=l.length,u=1;u<p;u++){var i=Math.abs(l[u]-l[u-1]);i<s&&(s=i)}return s};w.exports=function(l,s){var p=l.startingPositions,u=l.maxLength||1e3,i=l.tubeSize||1,x=l.absoluteTubeSize,f=l.gridFill||"+x+y+z",_={};f.indexOf("-x")!==-1&&(_.reversedX=!0),f.indexOf("-y")!==-1&&(_.reversedY=!0),f.indexOf("-z")!==-1&&(_.reversedZ=!0),_.filled=n.indexOf(f.replace(/-/g,"").replace(/\+/g,""));var b=l.getVelocity||function(oe){return function(me,ce,ye){var Se=ce.vectors,fe=ce.meshgrid,ge=me[0],Te=me[1],le=me[2],ve=fe[0].length,Me=fe[1].length,we=fe[2].length,de=r(fe[0],ge),Ie=r(fe[1],Te),De=r(fe[2],le),Oe=de+1,Ve=Ie+1,Fe=De+1;if(de=g(de,0,ve-1),Oe=g(Oe,0,ve-1),Ie=g(Ie,0,Me-1),Ve=g(Ve,0,Me-1),De=g(De,0,we-1),Fe=g(Fe,0,we-1),de<0||Ie<0||De<0||Oe>ve-1||Ve>Me-1||Fe>we-1)return e.create();var ze,Re,We,$e,at,gt,xt=fe[0][de],mt=fe[0][Oe],nt=fe[1][Ie],Qe=fe[1][Ve],vt=fe[2][De],jt=(ge-xt)/(mt-xt),Gt=(Te-nt)/(Qe-nt),$t=(le-vt)/(fe[2][Fe]-vt);switch(isFinite(jt)||(jt=.5),isFinite(Gt)||(Gt=.5),isFinite($t)||($t=.5),ye.reversedX&&(de=ve-1-de,Oe=ve-1-Oe),ye.reversedY&&(Ie=Me-1-Ie,Ve=Me-1-Ve),ye.reversedZ&&(De=we-1-De,Fe=we-1-Fe),ye.filled){case 5:at=De,gt=Fe,We=Ie*we,$e=Ve*we,ze=de*we*Me,Re=Oe*we*Me;break;case 4:at=De,gt=Fe,ze=de*we,Re=Oe*we,We=Ie*we*ve,$e=Ve*we*ve;break;case 3:We=Ie,$e=Ve,at=De*Me,gt=Fe*Me,ze=de*Me*we,Re=Oe*Me*we;break;case 2:We=Ie,$e=Ve,ze=de*Me,Re=Oe*Me,at=De*Me*ve,gt=Fe*Me*ve;break;case 1:ze=de,Re=Oe,at=De*ve,gt=Fe*ve,We=Ie*ve*we,$e=Ve*ve*we;break;default:ze=de,Re=Oe,We=Ie*ve,$e=Ve*ve,at=De*ve*Me,gt=Fe*ve*Me}var Zt=Se[ze+We+at],cr=Se[ze+We+gt],Dt=Se[ze+$e+at],Ne=Se[ze+$e+gt],Ye=Se[Re+We+at],pe=Se[Re+We+gt],_e=Se[Re+$e+at],Be=Se[Re+$e+gt],He=e.create(),Je=e.create(),Ze=e.create(),ct=e.create();e.lerp(He,Zt,Ye,jt),e.lerp(Je,cr,pe,jt),e.lerp(Ze,Dt,_e,jt),e.lerp(ct,Ne,Be,jt);var lt=e.create(),At=e.create();e.lerp(lt,He,Ze,Gt),e.lerp(At,Je,ct,Gt);var Ot=e.create();return e.lerp(Ot,lt,At,$t),Ot}(oe,l,_)},T=l.getDivergence||function(oe,me){var ce=e.create(),ye=1e-4;e.add(ce,oe,[ye,0,0]);var Se=b(ce);e.subtract(Se,Se,me),e.scale(Se,Se,1/ye),e.add(ce,oe,[0,ye,0]);var fe=b(ce);e.subtract(fe,fe,me),e.scale(fe,fe,1/ye),e.add(ce,oe,[0,0,ye]);var ge=b(ce);return e.subtract(ge,ge,me),e.scale(ge,ge,1/ye),e.add(ce,Se,fe),e.add(ce,ce,ge),ce},k=[],L=s[0][0],A=s[0][1],I=s[0][2],P=s[1][0],S=s[1][1],E=s[1][2],z=function(oe){var me=oe[0],ce=oe[1],ye=oe[2];return!(me<L||me>P||ce<A||ce>S||ye<I||ye>E)},D=10*e.distance(s[0],s[1])/u,j=D*D,V=1,Z=0,Q=p.length;Q>1&&(V=function(oe){for(var me=[],ce=[],ye=[],Se={},fe={},ge={},Te=oe.length,le=0;le<Te;le++){var ve=oe[le],Me=ve[0],we=ve[1],de=ve[2];Se[Me]||(me.push(Me),Se[Me]=!0),fe[we]||(ce.push(we),fe[we]=!0),ge[de]||(ye.push(de),ge[de]=!0)}var Ie=c(me),De=c(ce),Oe=c(ye),Ve=Math.min(Ie,De,Oe);return isFinite(Ve)?Ve:1}(p));for(var X=0;X<Q;X++){var $=e.create();e.copy($,p[X]);var re=[$],H=[],N=b($),U=$;H.push(N);var te=[],B=T($,N),K=e.length(B);isFinite(K)&&K>Z&&(Z=K),te.push(K),k.push({points:re,velocities:H,divergences:te});for(var J=0;J<100*u&&re.length<u&&z($);){J++;var ee=e.clone(N),ne=e.squaredLength(ee);if(ne===0)break;ne>j&&e.scale(ee,ee,D/Math.sqrt(ne)),e.add(ee,ee,$),N=b(ee),e.squaredDistance(U,ee)-j>-1e-4*j&&(re.push(ee),U=ee,H.push(N),B=T(ee,N),K=e.length(B),isFinite(K)&&K>Z&&(Z=K),te.push(K)),$=ee}}var se=o(k,l.colormap,Z,V);return x?se.tubeScale=x:(Z===0&&(Z=1),se.tubeScale=.5*i*V/Z),se};var a=v("./lib/shaders"),h=v("gl-cone3d").createMesh;w.exports.createTubeMesh=function(l,s){return h(l,s,{shaders:a,traceType:"streamtube"})}},{"./lib/shaders":142,"gl-cone3d":79,"gl-vec3":169,"gl-vec4":205}],144:[function(v,w,y){var e=v("gl-shader"),t=v("glslify"),n=t([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute vec3 f;
attribute vec3 normal;

uniform vec3 objectOffset;
uniform mat4 model, view, projection, inverseModel;
uniform vec3 lightPosition, eyePosition;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 localCoordinate = vec3(uv.zw, f.x);
  worldCoordinate = objectOffset + localCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);
  vec4 clipPosition = projection * view * worldPosition;
  gl_Position = clipPosition;
  kill = f.y;
  value = f.z;
  planeCoordinate = uv.xy;

  vColor = texture2D(colormap, vec2(value, value));

  //Lighting geometry parameters
  vec4 cameraCoordinate = view * worldPosition;
  cameraCoordinate.xyz /= cameraCoordinate.w;
  lightDirection = lightPosition - cameraCoordinate.xyz;
  eyeDirection   = eyePosition - cameraCoordinate.xyz;
  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);
}
`]),o=t([`precision highp float;
#define GLSLIFY 1

float beckmannDistribution(float x, float roughness) {
  float NdotH = max(x, 0.0001);
  float cos2Alpha = NdotH * NdotH;
  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;
  float roughness2 = roughness * roughness;
  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;
  return exp(tan2Alpha / roughness2) / denom;
}

float beckmannSpecular(
  vec3 lightDirection,
  vec3 viewDirection,
  vec3 surfaceNormal,
  float roughness) {
  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);
}

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec3 lowerBound, upperBound;
uniform float contourTint;
uniform vec4 contourColor;
uniform sampler2D colormap;
uniform vec3 clipBounds[2];
uniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;
uniform float vertexColor;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  if (
    kill > 0.0 ||
    vColor.a == 0.0 ||
    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)
  ) discard;

  vec3 N = normalize(surfaceNormal);
  vec3 V = normalize(eyeDirection);
  vec3 L = normalize(lightDirection);

  if(gl_FrontFacing) {
    N = -N;
  }

  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);
  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);

  //decide how to interpolate color \u2014 in vertex or in fragment
  vec4 surfaceColor =
    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +
    step(.5, vertexColor) * vColor;

  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);

  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;
}
`]),r=t([`precision highp float;
#define GLSLIFY 1

attribute vec4 uv;
attribute float f;

uniform vec3 objectOffset;
uniform mat3 permutation;
uniform mat4 model, view, projection;
uniform float height, zOffset;
uniform sampler2D colormap;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 lightDirection, eyeDirection, surfaceNormal;
varying vec4 vColor;

void main() {
  vec3 dataCoordinate = permutation * vec3(uv.xy, height);
  worldCoordinate = objectOffset + dataCoordinate;
  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);

  vec4 clipPosition = projection * view * worldPosition;
  clipPosition.z += zOffset;

  gl_Position = clipPosition;
  value = f + objectOffset.z;
  kill = -1.0;
  planeCoordinate = uv.zw;

  vColor = texture2D(colormap, vec2(value, value));

  //Don't do lighting for contours
  surfaceNormal   = vec3(1,0,0);
  eyeDirection    = vec3(0,1,0);
  lightDirection  = vec3(0,0,1);
}
`]),g=t([`precision highp float;
#define GLSLIFY 1

bool outOfRange(float a, float b, float p) {
  return ((p > max(a, b)) || 
          (p < min(a, b)));
}

bool outOfRange(vec2 a, vec2 b, vec2 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y));
}

bool outOfRange(vec3 a, vec3 b, vec3 p) {
  return (outOfRange(a.x, b.x, p.x) ||
          outOfRange(a.y, b.y, p.y) ||
          outOfRange(a.z, b.z, p.z));
}

bool outOfRange(vec4 a, vec4 b, vec4 p) {
  return outOfRange(a.xyz, b.xyz, p.xyz);
}

uniform vec2 shape;
uniform vec3 clipBounds[2];
uniform float pickId;

varying float value, kill;
varying vec3 worldCoordinate;
varying vec2 planeCoordinate;
varying vec3 surfaceNormal;

vec2 splitFloat(float v) {
  float vh = 255.0 * v;
  float upper = floor(vh);
  float lower = fract(vh);
  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);
}

void main() {
  if ((kill > 0.0) ||
      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;

  vec2 ux = splitFloat(planeCoordinate.x / shape.x);
  vec2 uy = splitFloat(planeCoordinate.y / shape.y);
  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));
}
`]);y.createShader=function(c){var a=e(c,n,o,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return a.attributes.uv.location=0,a.attributes.f.location=1,a.attributes.normal.location=2,a},y.createPickShader=function(c){var a=e(c,n,g,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return a.attributes.uv.location=0,a.attributes.f.location=1,a.attributes.normal.location=2,a},y.createContourShader=function(c){var a=e(c,r,o,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return a.attributes.uv.location=0,a.attributes.f.location=1,a},y.createPickContourShader=function(c){var a=e(c,r,g,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return a.attributes.uv.location=0,a.attributes.f.location=1,a}},{"gl-shader":132,glslify:231}],145:[function(v,w,y){w.exports=function(N){var U=N.gl,te=f(U),B=b(U),K=_(U),J=T(U),ee=t(U),ne=n(U,[{buffer:ee,size:4,stride:40,offset:0},{buffer:ee,size:3,stride:40,offset:16},{buffer:ee,size:3,stride:40,offset:28}]),se=t(U),oe=n(U,[{buffer:se,size:4,stride:20,offset:0},{buffer:se,size:1,stride:20,offset:16}]),me=t(U),ce=n(U,[{buffer:me,size:2,type:U.FLOAT}]),ye=o(U,1,256,U.RGBA,U.UNSIGNED_BYTE);ye.minFilter=U.LINEAR,ye.magFilter=U.LINEAR;var Se=new P(U,[0,0],[[0,0,0],[0,0,0]],te,B,ee,ne,ye,K,J,se,oe,me,ce,[0,0,0]),fe={levels:[[],[],[]]};for(var ge in N)fe[ge]=N[ge];return fe.colormap=fe.colormap||"jet",Se.update(fe),Se};var e=v("bit-twiddle"),t=v("gl-buffer"),n=v("gl-vao"),o=v("gl-texture2d"),r=v("typedarray-pool"),g=v("colormap"),c=v("ndarray-ops"),a=v("ndarray-pack"),h=v("ndarray"),l=v("surface-nets"),s=v("gl-mat4/multiply"),p=v("gl-mat4/invert"),u=v("binary-search-bounds"),i=v("ndarray-gradient"),x=v("./lib/shaders"),f=x.createShader,_=x.createContourShader,b=x.createPickShader,T=x.createPickContourShader,k=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],L=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],A=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];function I(N,U,te,B,K){this.position=N,this.index=U,this.uv=te,this.level=B,this.dataCoordinate=K}(function(){for(var N=0;N<3;++N){var U=A[N],te=(N+2)%3;U[(N+1)%3+0]=1,U[te+3]=1,U[N+6]=1}})();function P(N,U,te,B,K,J,ee,ne,se,oe,me,ce,ye,Se,fe){this.gl=N,this.shape=U,this.bounds=te,this.objectOffset=fe,this.intensityBounds=[],this._shader=B,this._pickShader=K,this._coordinateBuffer=J,this._vao=ee,this._colorMap=ne,this._contourShader=se,this._contourPickShader=oe,this._contourBuffer=me,this._contourVAO=ce,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new I([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=ye,this._dynamicVAO=Se,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[h(r.mallocFloat(1024),[0,0]),h(r.mallocFloat(1024),[0,0]),h(r.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}var S=P.prototype;S.genColormap=function(N,U){var te=!1,B=a([g({colormap:N,nshades:256,format:"rgba"}).map(function(K,J){var ee=U?function(ne,se){if(!se||!se.length)return 1;for(var oe=0;oe<se.length;++oe){if(se.length<2)return 1;if(se[oe][0]===ne)return se[oe][1];if(se[oe][0]>ne&&oe>0){var me=(se[oe][0]-ne)/(se[oe][0]-se[oe-1][0]);return se[oe][1]*(1-me)+me*se[oe-1][1]}}return 1}(J/255,U):K[3];return ee<1&&(te=!0),[K[0],K[1],K[2],255*ee]})]);return c.divseq(B,255),this.hasAlphaScale=te,B},S.isTransparent=function(){return this.opacity<1||this.hasAlphaScale},S.isOpaque=function(){return!this.isTransparent()},S.pickSlots=1,S.setPickBase=function(N){this.pickId=N};var E=[0,0,0],z={showSurface:!1,showContour:!1,projections:[k.slice(),k.slice(),k.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function D(N,U){var te,B,K,J=U.axes&&U.axes.lastCubeProps.axis||E,ee=U.showSurface,ne=U.showContour;for(te=0;te<3;++te)for(ee=ee||U.surfaceProject[te],B=0;B<3;++B)ne=ne||U.contourProject[te][B];for(te=0;te<3;++te){var se=z.projections[te];for(B=0;B<16;++B)se[B]=0;for(B=0;B<4;++B)se[5*B]=1;se[5*te]=0,se[12+te]=U.axesBounds[+(J[te]>0)][te],s(se,N.model,se);var oe=z.clipBounds[te];for(K=0;K<2;++K)for(B=0;B<3;++B)oe[K][B]=N.clipBounds[K][B];oe[0][te]=-1e8,oe[1][te]=1e8}return z.showSurface=ee,z.showContour=ne,z}var j={model:k,view:k,projection:k,inverseModel:k.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},V=k.slice(),Z=[1,0,0,0,1,0,0,0,1];function Q(N,U){N=N||{};var te=this.gl;te.disable(te.CULL_FACE),this._colorMap.bind(0);var B=j;B.model=N.model||k,B.view=N.view||k,B.projection=N.projection||k,B.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],B.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],B.objectOffset=this.objectOffset,B.contourColor=this.contourColor[0],B.inverseModel=p(B.inverseModel,B.model);for(var K=0;K<2;++K)for(var J=B.clipBounds[K],ee=0;ee<3;++ee)J[ee]=Math.min(Math.max(this.clipBounds[K][ee],-1e8),1e8);B.kambient=this.ambientLight,B.kdiffuse=this.diffuseLight,B.kspecular=this.specularLight,B.roughness=this.roughness,B.fresnel=this.fresnel,B.opacity=this.opacity,B.height=0,B.permutation=Z,B.vertexColor=this.vertexColor;var ne=V;for(s(ne,B.view,B.model),s(ne,B.projection,ne),p(ne,ne),K=0;K<3;++K)B.eyePosition[K]=ne[12+K]/ne[15];var se=ne[15];for(K=0;K<3;++K)se+=this.lightPosition[K]*ne[4*K+3];for(K=0;K<3;++K){var oe=ne[12+K];for(ee=0;ee<3;++ee)oe+=ne[4*ee+K]*this.lightPosition[ee];B.lightPosition[K]=oe/se}var me=D(B,this);if(me.showSurface){for(this._shader.bind(),this._shader.uniforms=B,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(te.TRIANGLES,this._vertexCount),K=0;K<3;++K)this.surfaceProject[K]&&this.vertexCount&&(this._shader.uniforms.model=me.projections[K],this._shader.uniforms.clipBounds=me.clipBounds[K],this._vao.draw(te.TRIANGLES,this._vertexCount));this._vao.unbind()}if(me.showContour){var ce=this._contourShader;B.kambient=1,B.kdiffuse=0,B.kspecular=0,B.opacity=1,ce.bind(),ce.uniforms=B;var ye=this._contourVAO;for(ye.bind(),K=0;K<3;++K)for(ce.uniforms.permutation=A[K],te.lineWidth(this.contourWidth[K]*this.pixelRatio),ee=0;ee<this.contourLevels[K].length;++ee)ee===this.highlightLevel[K]?(ce.uniforms.contourColor=this.highlightColor[K],ce.uniforms.contourTint=this.highlightTint[K]):ee!==0&&ee-1!==this.highlightLevel[K]||(ce.uniforms.contourColor=this.contourColor[K],ce.uniforms.contourTint=this.contourTint[K]),this._contourCounts[K][ee]&&(ce.uniforms.height=this.contourLevels[K][ee],ye.draw(te.LINES,this._contourCounts[K][ee],this._contourOffsets[K][ee]));for(K=0;K<3;++K)for(ce.uniforms.model=me.projections[K],ce.uniforms.clipBounds=me.clipBounds[K],ee=0;ee<3;++ee)if(this.contourProject[K][ee]){ce.uniforms.permutation=A[ee],te.lineWidth(this.contourWidth[ee]*this.pixelRatio);for(var Se=0;Se<this.contourLevels[ee].length;++Se)Se===this.highlightLevel[ee]?(ce.uniforms.contourColor=this.highlightColor[ee],ce.uniforms.contourTint=this.highlightTint[ee]):Se!==0&&Se-1!==this.highlightLevel[ee]||(ce.uniforms.contourColor=this.contourColor[ee],ce.uniforms.contourTint=this.contourTint[ee]),this._contourCounts[ee][Se]&&(ce.uniforms.height=this.contourLevels[ee][Se],ye.draw(te.LINES,this._contourCounts[ee][Se],this._contourOffsets[ee][Se]))}for(ye.unbind(),(ye=this._dynamicVAO).bind(),K=0;K<3;++K)if(this._dynamicCounts[K]!==0)for(ce.uniforms.model=B.model,ce.uniforms.clipBounds=B.clipBounds,ce.uniforms.permutation=A[K],te.lineWidth(this.dynamicWidth[K]*this.pixelRatio),ce.uniforms.contourColor=this.dynamicColor[K],ce.uniforms.contourTint=this.dynamicTint[K],ce.uniforms.height=this.dynamicLevel[K],ye.draw(te.LINES,this._dynamicCounts[K],this._dynamicOffsets[K]),ee=0;ee<3;++ee)this.contourProject[ee][K]&&(ce.uniforms.model=me.projections[ee],ce.uniforms.clipBounds=me.clipBounds[ee],ye.draw(te.LINES,this._dynamicCounts[K],this._dynamicOffsets[K]));ye.unbind()}}S.draw=function(N){return Q.call(this,N,!1)},S.drawTransparent=function(N){return Q.call(this,N,!0)};var X={model:k,view:k,projection:k,inverseModel:k,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};function $(N,U){return Array.isArray(N)?[U(N[0]),U(N[1]),U(N[2])]:[U(N),U(N),U(N)]}function re(N){return Array.isArray(N)?N.length===3?[N[0],N[1],N[2],1]:[N[0],N[1],N[2],N[3]]:[0,0,0,1]}function H(N){if(Array.isArray(N)){if(Array.isArray(N))return[re(N[0]),re(N[1]),re(N[2])];var U=re(N);return[U.slice(),U.slice(),U.slice()]}}S.drawPick=function(N){N=N||{};var U=this.gl;U.disable(U.CULL_FACE);var te=X;te.model=N.model||k,te.view=N.view||k,te.projection=N.projection||k,te.shape=this._field[2].shape,te.pickId=this.pickId/255,te.lowerBound=this.bounds[0],te.upperBound=this.bounds[1],te.objectOffset=this.objectOffset,te.permutation=Z;for(var B=0;B<2;++B)for(var K=te.clipBounds[B],J=0;J<3;++J)K[J]=Math.min(Math.max(this.clipBounds[B][J],-1e8),1e8);var ee=D(te,this);if(ee.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=te,this._vao.bind(),this._vao.draw(U.TRIANGLES,this._vertexCount),B=0;B<3;++B)this.surfaceProject[B]&&(this._pickShader.uniforms.model=ee.projections[B],this._pickShader.uniforms.clipBounds=ee.clipBounds[B],this._vao.draw(U.TRIANGLES,this._vertexCount));this._vao.unbind()}if(ee.showContour){var ne=this._contourPickShader;ne.bind(),ne.uniforms=te;var se=this._contourVAO;for(se.bind(),J=0;J<3;++J)for(U.lineWidth(this.contourWidth[J]*this.pixelRatio),ne.uniforms.permutation=A[J],B=0;B<this.contourLevels[J].length;++B)this._contourCounts[J][B]&&(ne.uniforms.height=this.contourLevels[J][B],se.draw(U.LINES,this._contourCounts[J][B],this._contourOffsets[J][B]));for(B=0;B<3;++B)for(ne.uniforms.model=ee.projections[B],ne.uniforms.clipBounds=ee.clipBounds[B],J=0;J<3;++J)if(this.contourProject[B][J]){ne.uniforms.permutation=A[J],U.lineWidth(this.contourWidth[J]*this.pixelRatio);for(var oe=0;oe<this.contourLevels[J].length;++oe)this._contourCounts[J][oe]&&(ne.uniforms.height=this.contourLevels[J][oe],se.draw(U.LINES,this._contourCounts[J][oe],this._contourOffsets[J][oe]))}se.unbind()}},S.pick=function(N){if(!N||N.id!==this.pickId)return null;var U=this._field[2].shape,te=this._pickResult,B=U[0]*(N.value[0]+(N.value[2]>>4)/16)/255,K=Math.floor(B),J=B-K,ee=U[1]*(N.value[1]+(15&N.value[2])/16)/255,ne=Math.floor(ee),se=ee-ne;K+=1,ne+=1;var oe=te.position;oe[0]=oe[1]=oe[2]=0;for(var me=0;me<2;++me)for(var ce=me?J:1-J,ye=0;ye<2;++ye)for(var Se=K+me,fe=ne+ye,ge=ce*(ye?se:1-se),Te=0;Te<3;++Te)oe[Te]+=this._field[Te].get(Se,fe)*ge;for(var le=this._pickResult.level,ve=0;ve<3;++ve)if(le[ve]=u.le(this.contourLevels[ve],oe[ve]),le[ve]<0)this.contourLevels[ve].length>0&&(le[ve]=0);else if(le[ve]<this.contourLevels[ve].length-1){var Me=this.contourLevels[ve][le[ve]],we=this.contourLevels[ve][le[ve]+1];Math.abs(Me-oe[ve])>Math.abs(we-oe[ve])&&(le[ve]+=1)}for(te.index[0]=J<.5?K:K+1,te.index[1]=se<.5?ne:ne+1,te.uv[0]=B/U[0],te.uv[1]=ee/U[1],Te=0;Te<3;++Te)te.dataCoordinate[Te]=this._field[Te].get(te.index[0],te.index[1]);return te},S.padField=function(N,U){var te=U.shape.slice(),B=N.shape.slice();c.assign(N.lo(1,1).hi(te[0],te[1]),U),c.assign(N.lo(1).hi(te[0],1),U.hi(te[0],1)),c.assign(N.lo(1,B[1]-1).hi(te[0],1),U.lo(0,te[1]-1).hi(te[0],1)),c.assign(N.lo(0,1).hi(1,te[1]),U.hi(1)),c.assign(N.lo(B[0]-1,1).hi(1,te[1]),U.lo(te[0]-1)),N.set(0,0,U.get(0,0)),N.set(0,B[1]-1,U.get(0,te[1]-1)),N.set(B[0]-1,0,U.get(te[0]-1,0)),N.set(B[0]-1,B[1]-1,U.get(te[0]-1,te[1]-1))},S.update=function(N){N=N||{},this.objectOffset=N.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in N&&(this.contourWidth=$(N.contourWidth,Number)),"showContour"in N&&(this.showContour=$(N.showContour,Boolean)),"showSurface"in N&&(this.showSurface=!!N.showSurface),"contourTint"in N&&(this.contourTint=$(N.contourTint,Boolean)),"contourColor"in N&&(this.contourColor=H(N.contourColor)),"contourProject"in N&&(this.contourProject=$(N.contourProject,function(Jt){return $(Jt,Boolean)})),"surfaceProject"in N&&(this.surfaceProject=N.surfaceProject),"dynamicColor"in N&&(this.dynamicColor=H(N.dynamicColor)),"dynamicTint"in N&&(this.dynamicTint=$(N.dynamicTint,Number)),"dynamicWidth"in N&&(this.dynamicWidth=$(N.dynamicWidth,Number)),"opacity"in N&&(this.opacity=N.opacity),"opacityscale"in N&&(this.opacityscale=N.opacityscale),"colorBounds"in N&&(this.colorBounds=N.colorBounds),"vertexColor"in N&&(this.vertexColor=N.vertexColor?1:0),"colormap"in N&&this._colorMap.setPixels(this.genColormap(N.colormap,this.opacityscale));var U=N.field||N.coords&&N.coords[2]||null,te=!1;if(U||(U=this._field[2].shape[0]||this._field[2].shape[2]?this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):this._field[2].hi(0,0)),"field"in N||"coords"in N){var B=(U.shape[0]+2)*(U.shape[1]+2);B>this._field[2].data.length&&(r.freeFloat(this._field[2].data),this._field[2].data=r.mallocFloat(e.nextPow2(B))),this._field[2]=h(this._field[2].data,[U.shape[0]+2,U.shape[1]+2]),this.padField(this._field[2],U),this.shape=U.shape.slice();for(var K=this.shape,J=0;J<2;++J)this._field[2].size>this._field[J].data.length&&(r.freeFloat(this._field[J].data),this._field[J].data=r.mallocFloat(this._field[2].size)),this._field[J]=h(this._field[J].data,[K[0]+2,K[1]+2]);if(N.coords){var ee=N.coords;if(!Array.isArray(ee)||ee.length!==3)throw new Error("gl-surface: invalid coordinates for x/y");for(J=0;J<2;++J){var ne=ee[J];for(ye=0;ye<2;++ye)if(ne.shape[ye]!==K[ye])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[J],ne)}}else if(N.ticks){var se=N.ticks;if(!Array.isArray(se)||se.length!==2)throw new Error("gl-surface: invalid ticks");for(J=0;J<2;++J){var oe=se[J];if((Array.isArray(oe)||oe.length)&&(oe=h(oe)),oe.shape[0]!==K[J])throw new Error("gl-surface: invalid tick length");var me=h(oe.data,K);me.stride[J]=oe.stride[0],me.stride[1^J]=0,this.padField(this._field[J],me)}}else{for(J=0;J<2;++J){var ce=[0,0];ce[J]=1,this._field[J]=h(this._field[J].data,[K[0]+2,K[1]+2],ce,0)}this._field[0].set(0,0,0);for(var ye=0;ye<K[0];++ye)this._field[0].set(ye+1,0,ye);for(this._field[0].set(K[0]+1,0,K[0]-1),this._field[1].set(0,0,0),ye=0;ye<K[1];++ye)this._field[1].set(0,ye+1,ye);this._field[1].set(0,K[1]+1,K[1]-1)}var Se=this._field,fe=h(r.mallocFloat(3*Se[2].size*2),[3,K[0]+2,K[1]+2,2]);for(J=0;J<3;++J)i(fe.pick(J),Se[J],"mirror");var ge=h(r.mallocFloat(3*Se[2].size),[K[0]+2,K[1]+2,3]);for(J=0;J<K[0]+2;++J)for(ye=0;ye<K[1]+2;++ye){var Te=fe.get(0,J,ye,0),le=fe.get(0,J,ye,1),ve=fe.get(1,J,ye,0),Me=fe.get(1,J,ye,1),we=fe.get(2,J,ye,0),de=fe.get(2,J,ye,1),Ie=ve*de-Me*we,De=we*le-de*Te,Oe=Te*Me-le*ve,Ve=Math.sqrt(Ie*Ie+De*De+Oe*Oe);Ve<1e-8?(Ve=Math.max(Math.abs(Ie),Math.abs(De),Math.abs(Oe)))<1e-8?(Oe=1,De=Ie=0,Ve=1):Ve=1/Ve:Ve=1/Math.sqrt(Ve),ge.set(J,ye,0,Ie*Ve),ge.set(J,ye,1,De*Ve),ge.set(J,ye,2,Oe*Ve)}r.free(fe.data);var Fe=[1/0,1/0,1/0],ze=[-1/0,-1/0,-1/0],Re=1/0,We=-1/0,$e=(K[0]-1)*(K[1]-1)*6,at=r.mallocFloat(e.nextPow2(10*$e)),gt=0,xt=0;for(J=0;J<K[0]-1;++J)e:for(ye=0;ye<K[1]-1;++ye){for(var mt=0;mt<2;++mt)for(var nt=0;nt<2;++nt)for(var Qe=0;Qe<3;++Qe){var vt=this._field[Qe].get(1+J+mt,1+ye+nt);if(isNaN(vt)||!isFinite(vt))continue e}for(Qe=0;Qe<6;++Qe){var jt=J+L[Qe][0],Gt=ye+L[Qe][1],$t=this._field[0].get(jt+1,Gt+1),Zt=this._field[1].get(jt+1,Gt+1);vt=this._field[2].get(jt+1,Gt+1),Ie=ge.get(jt+1,Gt+1,0),De=ge.get(jt+1,Gt+1,1),Oe=ge.get(jt+1,Gt+1,2),N.intensity&&(cr=N.intensity.get(jt,Gt));var cr=N.intensity?N.intensity.get(jt,Gt):vt+this.objectOffset[2];at[gt++]=jt,at[gt++]=Gt,at[gt++]=$t,at[gt++]=Zt,at[gt++]=vt,at[gt++]=0,at[gt++]=cr,at[gt++]=Ie,at[gt++]=De,at[gt++]=Oe,Fe[0]=Math.min(Fe[0],$t+this.objectOffset[0]),Fe[1]=Math.min(Fe[1],Zt+this.objectOffset[1]),Fe[2]=Math.min(Fe[2],vt+this.objectOffset[2]),Re=Math.min(Re,cr),ze[0]=Math.max(ze[0],$t+this.objectOffset[0]),ze[1]=Math.max(ze[1],Zt+this.objectOffset[1]),ze[2]=Math.max(ze[2],vt+this.objectOffset[2]),We=Math.max(We,cr),xt+=1}}for(N.intensityBounds&&(Re=+N.intensityBounds[0],We=+N.intensityBounds[1]),J=6;J<gt;J+=10)at[J]=(at[J]-Re)/(We-Re);this._vertexCount=xt,this._coordinateBuffer.update(at.subarray(0,gt)),r.freeFloat(at),r.free(ge.data),this.bounds=[Fe,ze],this.intensity=N.intensity||this._field[2],this.intensityBounds[0]===Re&&this.intensityBounds[1]===We||(te=!0),this.intensityBounds=[Re,We]}if("levels"in N){var Dt=N.levels;for(Dt=Array.isArray(Dt[0])?Dt.slice():[[],[],Dt],J=0;J<3;++J)Dt[J]=Dt[J].slice(),Dt[J].sort(function(Jt,qt){return Jt-qt});for(J=0;J<3;++J)for(ye=0;ye<Dt[J].length;++ye)Dt[J][ye]-=this.objectOffset[J];e:for(J=0;J<3;++J){if(Dt[J].length!==this.contourLevels[J].length){te=!0;break}for(ye=0;ye<Dt[J].length;++ye)if(Dt[J][ye]!==this.contourLevels[J][ye]){te=!0;break e}}this.contourLevels=Dt}if(te){Se=this._field,K=this.shape;for(var Ne=[],Ye=0;Ye<3;++Ye){var pe=this.contourLevels[Ye],_e=[],Be=[],He=[0,0,0];for(J=0;J<pe.length;++J){var Je=l(this._field[Ye],pe[J]);_e.push(Ne.length/5|0),xt=0;e:for(ye=0;ye<Je.cells.length;++ye){var Ze=Je.cells[ye];for(Qe=0;Qe<2;++Qe){var ct=Je.positions[Ze[Qe]],lt=ct[0],At=0|Math.floor(lt),Ot=lt-At,it=ct[1],ht=0|Math.floor(it),Ut=it-ht,Mt=!1;t:for(var It=0;It<3;++It){He[It]=0;var Le=(Ye+It+1)%3;for(mt=0;mt<2;++mt){var Xe=mt?Ot:1-Ot;for(jt=0|Math.min(Math.max(At+mt,0),K[0]),nt=0;nt<2;++nt){var ot=nt?Ut:1-Ut;if(Gt=0|Math.min(Math.max(ht+nt,0),K[1]),vt=It<2?this._field[Le].get(jt,Gt):(this.intensity.get(jt,Gt)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(vt)||isNaN(vt)){Mt=!0;break t}var pt=Xe*ot;He[It]+=pt*vt}}}if(Mt){if(Qe>0){for(var St=0;St<5;++St)Ne.pop();xt-=1}continue e}Ne.push(He[0],He[1],ct[0],ct[1],He[2]),xt+=1}}Be.push(xt)}this._contourOffsets[Ye]=_e,this._contourCounts[Ye]=Be}var Vt=r.mallocFloat(Ne.length);for(J=0;J<Ne.length;++J)Vt[J]=Ne[J];this._contourBuffer.update(Vt),r.freeFloat(Vt)}},S.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var N=0;N<3;++N)r.freeFloat(this._field[N].data)},S.highlight=function(N){var U,te;if(!N)return this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],void(this.highlightLevel=[-1,-1,-1]);for(U=0;U<3;++U)this.enableHighlight[U]?this.highlightLevel[U]=N.level[U]:this.highlightLevel[U]=-1;for(te=this.snapToData?N.dataCoordinate:N.position,U=0;U<3;++U)te[U]-=this.objectOffset[U];if(this.enableDynamic[0]&&te[0]!==this.dynamicLevel[0]||this.enableDynamic[1]&&te[1]!==this.dynamicLevel[1]||this.enableDynamic[2]&&te[2]!==this.dynamicLevel[2]){for(var B=0,K=this.shape,J=r.mallocFloat(12*K[0]*K[1]),ee=0;ee<3;++ee)if(this.enableDynamic[ee]){this.dynamicLevel[ee]=te[ee];var ne=(ee+1)%3,se=(ee+2)%3,oe=this._field[ee],me=this._field[ne],ce=this._field[se],ye=l(oe,te[ee]),Se=ye.cells,fe=ye.positions;for(this._dynamicOffsets[ee]=B,U=0;U<Se.length;++U)for(var ge=Se[U],Te=0;Te<2;++Te){var le=fe[ge[Te]],ve=+le[0],Me=0|ve,we=0|Math.min(Me+1,K[0]),de=ve-Me,Ie=1-de,De=+le[1],Oe=0|De,Ve=0|Math.min(Oe+1,K[1]),Fe=De-Oe,ze=1-Fe,Re=Ie*ze,We=Ie*Fe,$e=de*ze,at=de*Fe,gt=Re*me.get(Me,Oe)+We*me.get(Me,Ve)+$e*me.get(we,Oe)+at*me.get(we,Ve),xt=Re*ce.get(Me,Oe)+We*ce.get(Me,Ve)+$e*ce.get(we,Oe)+at*ce.get(we,Ve);if(isNaN(gt)||isNaN(xt)){Te&&(B-=1);break}J[2*B+0]=gt,J[2*B+1]=xt,B+=1}this._dynamicCounts[ee]=B-this._dynamicOffsets[ee]}else this.dynamicLevel[ee]=NaN,this._dynamicCounts[ee]=0;this._dynamicBuffer.update(J.subarray(0,2*B)),r.freeFloat(J)}}},{"./lib/shaders":144,"binary-search-bounds":31,"bit-twiddle":32,colormap:53,"gl-buffer":78,"gl-mat4/invert":98,"gl-mat4/multiply":100,"gl-texture2d":146,"gl-vao":150,ndarray:259,"ndarray-gradient":252,"ndarray-ops":254,"ndarray-pack":255,"surface-nets":302,"typedarray-pool":308}],146:[function(v,w,y){var e=v("ndarray"),t=v("ndarray-ops"),n=v("typedarray-pool");w.exports=function(b){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(o||c(b),typeof arguments[1]=="number")return x(b,arguments[1],arguments[2],arguments[3]||b.RGBA,arguments[4]||b.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return x(b,0|arguments[1][0],0|arguments[1][1],arguments[2]||b.RGBA,arguments[3]||b.UNSIGNED_BYTE);if(typeof arguments[1]=="object"){var T=arguments[1],k=a(T)?T:T.raw;if(k)return f(b,k,0|T.width,0|T.height,arguments[2]||b.RGBA,arguments[3]||b.UNSIGNED_BYTE);if(T.shape&&T.data&&T.stride)return _(b,T)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")};var o=null,r=null,g=null;function c(b){o=[b.LINEAR,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_NEAREST],r=[b.NEAREST,b.LINEAR,b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,b.LINEAR_MIPMAP_LINEAR],g=[b.REPEAT,b.CLAMP_TO_EDGE,b.MIRRORED_REPEAT]}function a(b){return typeof HTMLCanvasElement<"u"&&b instanceof HTMLCanvasElement||typeof HTMLImageElement<"u"&&b instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&b instanceof HTMLVideoElement||typeof ImageData<"u"&&b instanceof ImageData}var h=function(b,T){t.muls(b,T,255)};function l(b,T,k){var L=b.gl,A=L.getParameter(L.MAX_TEXTURE_SIZE);if(T<0||T>A||k<0||k>A)throw new Error("gl-texture2d: Invalid texture size");return b._shape=[T,k],b.bind(),L.texImage2D(L.TEXTURE_2D,0,b.format,T,k,0,b.format,b.type,null),b._mipLevels=[0],b}function s(b,T,k,L,A,I){this.gl=b,this.handle=T,this.format=A,this.type=I,this._shape=[k,L],this._mipLevels=[0],this._magFilter=b.NEAREST,this._minFilter=b.NEAREST,this._wrapS=b.CLAMP_TO_EDGE,this._wrapT=b.CLAMP_TO_EDGE,this._anisoSamples=1;var P=this,S=[this._wrapS,this._wrapT];Object.defineProperties(S,[{get:function(){return P._wrapS},set:function(z){return P.wrapS=z}},{get:function(){return P._wrapT},set:function(z){return P.wrapT=z}}]),this._wrapVector=S;var E=[this._shape[0],this._shape[1]];Object.defineProperties(E,[{get:function(){return P._shape[0]},set:function(z){return P.width=z}},{get:function(){return P._shape[1]},set:function(z){return P.height=z}}]),this._shapeVector=E}var p=s.prototype;function u(b,T){return b.length===3?T[2]===1&&T[1]===b[0]*b[2]&&T[0]===b[2]:T[0]===1&&T[1]===b[0]}function i(b){var T=b.createTexture();return b.bindTexture(b.TEXTURE_2D,T),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),T}function x(b,T,k,L,A){var I=b.getParameter(b.MAX_TEXTURE_SIZE);if(T<0||T>I||k<0||k>I)throw new Error("gl-texture2d: Invalid texture shape");if(A===b.FLOAT&&!b.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var P=i(b);return b.texImage2D(b.TEXTURE_2D,0,L,T,k,0,L,A,null),new s(b,P,T,k,L,A)}function f(b,T,k,L,A,I){var P=i(b);return b.texImage2D(b.TEXTURE_2D,0,A,A,I,T),new s(b,P,k,L,A,I)}function _(b,T){var k=T.dtype,L=T.shape.slice(),A=b.getParameter(b.MAX_TEXTURE_SIZE);if(L[0]<0||L[0]>A||L[1]<0||L[1]>A)throw new Error("gl-texture2d: Invalid texture size");var I=u(L,T.stride.slice()),P=0;k==="float32"?P=b.FLOAT:k==="float64"?(P=b.FLOAT,I=!1,k="float32"):k==="uint8"?P=b.UNSIGNED_BYTE:(P=b.UNSIGNED_BYTE,I=!1,k="uint8");var S,E,z=0;if(L.length===2)z=b.LUMINANCE,L=[L[0],L[1],1],T=e(T.data,L,[T.stride[0],T.stride[1],1],T.offset);else{if(L.length!==3)throw new Error("gl-texture2d: Invalid shape for texture");if(L[2]===1)z=b.ALPHA;else if(L[2]===2)z=b.LUMINANCE_ALPHA;else if(L[2]===3)z=b.RGB;else{if(L[2]!==4)throw new Error("gl-texture2d: Invalid shape for pixel coords");z=b.RGBA}}P!==b.FLOAT||b.getExtension("OES_texture_float")||(P=b.UNSIGNED_BYTE,I=!1);var D=T.size;if(I)S=T.offset===0&&T.data.length===D?T.data:T.data.subarray(T.offset,T.offset+D);else{var j=[L[2],L[2]*L[0],1];E=n.malloc(D,k);var V=e(E,L,j,0);k!=="float32"&&k!=="float64"||P!==b.UNSIGNED_BYTE?t.assign(V,T):h(V,T),S=E.subarray(0,D)}var Z=i(b);return b.texImage2D(b.TEXTURE_2D,0,z,L[0],L[1],0,z,P,S),I||n.free(E),new s(b,Z,L[0],L[1],z,P)}Object.defineProperties(p,{minFilter:{get:function(){return this._minFilter},set:function(b){this.bind();var T=this.gl;if(this.type===T.FLOAT&&o.indexOf(b)>=0&&(T.getExtension("OES_texture_float_linear")||(b=T.NEAREST)),r.indexOf(b)<0)throw new Error("gl-texture2d: Unknown filter mode "+b);return T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,b),this._minFilter=b}},magFilter:{get:function(){return this._magFilter},set:function(b){this.bind();var T=this.gl;if(this.type===T.FLOAT&&o.indexOf(b)>=0&&(T.getExtension("OES_texture_float_linear")||(b=T.NEAREST)),r.indexOf(b)<0)throw new Error("gl-texture2d: Unknown filter mode "+b);return T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MAG_FILTER,b),this._magFilter=b}},mipSamples:{get:function(){return this._anisoSamples},set:function(b){var T=this._anisoSamples;if(this._anisoSamples=0|Math.max(b,1),T!==this._anisoSamples){var k=this.gl.getExtension("EXT_texture_filter_anisotropic");k&&this.gl.texParameterf(this.gl.TEXTURE_2D,k.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(b){if(this.bind(),g.indexOf(b)<0)throw new Error("gl-texture2d: Unknown wrap mode "+b);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,b),this._wrapS=b}},wrapT:{get:function(){return this._wrapT},set:function(b){if(this.bind(),g.indexOf(b)<0)throw new Error("gl-texture2d: Unknown wrap mode "+b);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,b),this._wrapT=b}},wrap:{get:function(){return this._wrapVector},set:function(b){if(Array.isArray(b)||(b=[b,b]),b.length!==2)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var T=0;T<2;++T)if(g.indexOf(b[T])<0)throw new Error("gl-texture2d: Unknown wrap mode "+b);this._wrapS=b[0],this._wrapT=b[1];var k=this.gl;return this.bind(),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_S,this._wrapS),k.texParameteri(k.TEXTURE_2D,k.TEXTURE_WRAP_T,this._wrapT),b}},shape:{get:function(){return this._shapeVector},set:function(b){if(Array.isArray(b)){if(b.length!==2)throw new Error("gl-texture2d: Invalid texture shape")}else b=[0|b,0|b];return l(this,0|b[0],0|b[1]),[0|b[0],0|b[1]]}},width:{get:function(){return this._shape[0]},set:function(b){return l(this,b|=0,this._shape[1]),b}},height:{get:function(){return this._shape[1]},set:function(b){return b|=0,l(this,this._shape[0],b),b}}}),p.bind=function(b){var T=this.gl;return b!==void 0&&T.activeTexture(T.TEXTURE0+(0|b)),T.bindTexture(T.TEXTURE_2D,this.handle),b!==void 0?0|b:T.getParameter(T.ACTIVE_TEXTURE)-T.TEXTURE0},p.dispose=function(){this.gl.deleteTexture(this.handle)},p.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var b=Math.min(this._shape[0],this._shape[1]),T=0;b>0;++T,b>>>=1)this._mipLevels.indexOf(T)<0&&this._mipLevels.push(T)},p.setPixels=function(b,T,k,L){var A=this.gl;this.bind(),Array.isArray(T)?(L=k,k=0|T[1],T=0|T[0]):(T=T||0,k=k||0),L=L||0;var I=a(b)?b:b.raw;if(I)this._mipLevels.indexOf(L)<0?(A.texImage2D(A.TEXTURE_2D,0,this.format,this.format,this.type,I),this._mipLevels.push(L)):A.texSubImage2D(A.TEXTURE_2D,L,T,k,this.format,this.type,I);else{if(!(b.shape&&b.stride&&b.data))throw new Error("gl-texture2d: Unsupported data type");if(b.shape.length<2||T+b.shape[1]>this._shape[1]>>>L||k+b.shape[0]>this._shape[0]>>>L||T<0||k<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");(function(P,S,E,z,D,j,V,Z){var Q=Z.dtype,X=Z.shape.slice();if(X.length<2||X.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var $=0,re=0,H=u(X,Z.stride.slice());if(Q==="float32"?$=P.FLOAT:Q==="float64"?($=P.FLOAT,H=!1,Q="float32"):Q==="uint8"?$=P.UNSIGNED_BYTE:($=P.UNSIGNED_BYTE,H=!1,Q="uint8"),X.length===2)re=P.LUMINANCE,X=[X[0],X[1],1],Z=e(Z.data,X,[Z.stride[0],Z.stride[1],1],Z.offset);else{if(X.length!==3)throw new Error("gl-texture2d: Invalid shape for texture");if(X[2]===1)re=P.ALPHA;else if(X[2]===2)re=P.LUMINANCE_ALPHA;else if(X[2]===3)re=P.RGB;else{if(X[2]!==4)throw new Error("gl-texture2d: Invalid shape for pixel coords");re=P.RGBA}X[2]}if(re!==P.LUMINANCE&&re!==P.ALPHA||D!==P.LUMINANCE&&D!==P.ALPHA||(re=D),re!==D)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var N=Z.size,U=V.indexOf(z)<0;if(U&&V.push(z),$===j&&H)Z.offset===0&&Z.data.length===N?U?P.texImage2D(P.TEXTURE_2D,z,D,X[0],X[1],0,D,j,Z.data):P.texSubImage2D(P.TEXTURE_2D,z,S,E,X[0],X[1],D,j,Z.data):U?P.texImage2D(P.TEXTURE_2D,z,D,X[0],X[1],0,D,j,Z.data.subarray(Z.offset,Z.offset+N)):P.texSubImage2D(P.TEXTURE_2D,z,S,E,X[0],X[1],D,j,Z.data.subarray(Z.offset,Z.offset+N));else{var te;te=j===P.FLOAT?n.mallocFloat32(N):n.mallocUint8(N);var B=e(te,X,[X[2],X[2]*X[0],1]);$===P.FLOAT&&j===P.UNSIGNED_BYTE?h(B,Z):t.assign(B,Z),U?P.texImage2D(P.TEXTURE_2D,z,D,X[0],X[1],0,D,j,te.subarray(0,N)):P.texSubImage2D(P.TEXTURE_2D,z,S,E,X[0],X[1],D,j,te.subarray(0,N)),j===P.FLOAT?n.freeFloat32(te):n.freeUint8(te)}})(A,T,k,L,this.format,this.type,this._mipLevels,b)}}},{ndarray:259,"ndarray-ops":254,"typedarray-pool":308}],147:[function(v,w,y){w.exports=function(e,t,n){t?t.bind():e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null);var o=0|e.getParameter(e.MAX_VERTEX_ATTRIBS);if(n){if(n.length>o)throw new Error("gl-vao: Too many vertex attributes");for(var r=0;r<n.length;++r){var g=n[r];if(g.buffer){var c=g.buffer,a=g.size||4,h=g.type||e.FLOAT,l=!!g.normalized,s=g.stride||0,p=g.offset||0;c.bind(),e.enableVertexAttribArray(r),e.vertexAttribPointer(r,a,h,l,s,p)}else{if(typeof g=="number")e.vertexAttrib1f(r,g);else if(g.length===1)e.vertexAttrib1f(r,g[0]);else if(g.length===2)e.vertexAttrib2f(r,g[0],g[1]);else if(g.length===3)e.vertexAttrib3f(r,g[0],g[1],g[2]);else{if(g.length!==4)throw new Error("gl-vao: Invalid vertex attribute");e.vertexAttrib4f(r,g[0],g[1],g[2],g[3])}e.disableVertexAttribArray(r)}}for(;r<o;++r)e.disableVertexAttribArray(r)}else for(e.bindBuffer(e.ARRAY_BUFFER,null),r=0;r<o;++r)e.disableVertexAttribArray(r)}},{}],148:[function(v,w,y){var e=v("./do-bind.js");function t(n){this.gl=n,this._elements=null,this._attributes=null,this._elementsType=n.UNSIGNED_SHORT}t.prototype.bind=function(){e(this.gl,this._elements,this._attributes)},t.prototype.update=function(n,o,r){this._elements=o,this._attributes=n,this._elementsType=r||this.gl.UNSIGNED_SHORT},t.prototype.dispose=function(){},t.prototype.unbind=function(){},t.prototype.draw=function(n,o,r){r=r||0;var g=this.gl;this._elements?g.drawElements(n,o,this._elementsType,r):g.drawArrays(n,r,o)},w.exports=function(n){return new t(n)}},{"./do-bind.js":147}],149:[function(v,w,y){var e=v("./do-bind.js");function t(o,r,g,c,a,h){this.location=o,this.dimension=r,this.a=g,this.b=c,this.c=a,this.d=h}function n(o,r,g){this.gl=o,this._ext=r,this.handle=g,this._attribs=[],this._useElements=!1,this._elementsType=o.UNSIGNED_SHORT}t.prototype.bind=function(o){switch(this.dimension){case 1:o.vertexAttrib1f(this.location,this.a);break;case 2:o.vertexAttrib2f(this.location,this.a,this.b);break;case 3:o.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:o.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d)}},n.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var o=0;o<this._attribs.length;++o)this._attribs[o].bind(this.gl)},n.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},n.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},n.prototype.update=function(o,r,g){if(this.bind(),e(this.gl,r,o),this.unbind(),this._attribs.length=0,o)for(var c=0;c<o.length;++c){var a=o[c];typeof a=="number"?this._attribs.push(new t(c,1,a)):Array.isArray(a)&&this._attribs.push(new t(c,a.length,a[0],a[1],a[2],a[3]))}this._useElements=!!r,this._elementsType=g||this.gl.UNSIGNED_SHORT},n.prototype.draw=function(o,r,g){g=g||0;var c=this.gl;this._useElements?c.drawElements(o,r,this._elementsType,g):c.drawArrays(o,g,r)},w.exports=function(o,r){return new n(o,r,r.createVertexArrayOES())}},{"./do-bind.js":147}],150:[function(v,w,y){var e=v("./lib/vao-native.js"),t=v("./lib/vao-emulated.js");function n(o){this.bindVertexArrayOES=o.bindVertexArray.bind(o),this.createVertexArrayOES=o.createVertexArray.bind(o),this.deleteVertexArrayOES=o.deleteVertexArray.bind(o)}w.exports=function(o,r,g,c){var a,h=o.createVertexArray?new n(o):o.getExtension("OES_vertex_array_object");return(a=h?e(o,h):t(o)).update(r,g,c),a}},{"./lib/vao-emulated.js":148,"./lib/vao-native.js":149}],151:[function(v,w,y){w.exports=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e}},{}],152:[function(v,w,y){w.exports=function(o,r){var g=e(o[0],o[1],o[2]),c=e(r[0],r[1],r[2]);t(g,g),t(c,c);var a=n(g,c);return a>1?0:Math.acos(a)};var e=v("./fromValues"),t=v("./normalize"),n=v("./dot")},{"./dot":162,"./fromValues":168,"./normalize":179}],153:[function(v,w,y){w.exports=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}},{}],154:[function(v,w,y){w.exports=function(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}},{}],155:[function(v,w,y){w.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}},{}],156:[function(v,w,y){w.exports=function(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e}},{}],157:[function(v,w,y){w.exports=function(e,t,n){var o=t[0],r=t[1],g=t[2],c=n[0],a=n[1],h=n[2];return e[0]=r*h-g*a,e[1]=g*c-o*h,e[2]=o*a-r*c,e}},{}],158:[function(v,w,y){w.exports=v("./distance")},{"./distance":159}],159:[function(v,w,y){w.exports=function(e,t){var n=t[0]-e[0],o=t[1]-e[1],r=t[2]-e[2];return Math.sqrt(n*n+o*o+r*r)}},{}],160:[function(v,w,y){w.exports=v("./divide")},{"./divide":161}],161:[function(v,w,y){w.exports=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e}},{}],162:[function(v,w,y){w.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}},{}],163:[function(v,w,y){w.exports=1e-6},{}],164:[function(v,w,y){w.exports=function(t,n){var o=t[0],r=t[1],g=t[2],c=n[0],a=n[1],h=n[2];return Math.abs(o-c)<=e*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(r-a)<=e*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(g-h)<=e*Math.max(1,Math.abs(g),Math.abs(h))};var e=v("./epsilon")},{"./epsilon":163}],165:[function(v,w,y){w.exports=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}},{}],166:[function(v,w,y){w.exports=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}},{}],167:[function(v,w,y){w.exports=function(t,n,o,r,g,c){var a,h;for(n||(n=3),o||(o=0),h=r?Math.min(r*n+o,t.length):t.length,a=o;a<h;a+=n)e[0]=t[a],e[1]=t[a+1],e[2]=t[a+2],g(e,e,c),t[a]=e[0],t[a+1]=e[1],t[a+2]=e[2];return t};var e=v("./create")()},{"./create":156}],168:[function(v,w,y){w.exports=function(e,t,n){var o=new Float32Array(3);return o[0]=e,o[1]=t,o[2]=n,o}},{}],169:[function(v,w,y){w.exports={EPSILON:v("./epsilon"),create:v("./create"),clone:v("./clone"),angle:v("./angle"),fromValues:v("./fromValues"),copy:v("./copy"),set:v("./set"),equals:v("./equals"),exactEquals:v("./exactEquals"),add:v("./add"),subtract:v("./subtract"),sub:v("./sub"),multiply:v("./multiply"),mul:v("./mul"),divide:v("./divide"),div:v("./div"),min:v("./min"),max:v("./max"),floor:v("./floor"),ceil:v("./ceil"),round:v("./round"),scale:v("./scale"),scaleAndAdd:v("./scaleAndAdd"),distance:v("./distance"),dist:v("./dist"),squaredDistance:v("./squaredDistance"),sqrDist:v("./sqrDist"),length:v("./length"),len:v("./len"),squaredLength:v("./squaredLength"),sqrLen:v("./sqrLen"),negate:v("./negate"),inverse:v("./inverse"),normalize:v("./normalize"),dot:v("./dot"),cross:v("./cross"),lerp:v("./lerp"),random:v("./random"),transformMat4:v("./transformMat4"),transformMat3:v("./transformMat3"),transformQuat:v("./transformQuat"),rotateX:v("./rotateX"),rotateY:v("./rotateY"),rotateZ:v("./rotateZ"),forEach:v("./forEach")}},{"./add":151,"./angle":152,"./ceil":153,"./clone":154,"./copy":155,"./create":156,"./cross":157,"./dist":158,"./distance":159,"./div":160,"./divide":161,"./dot":162,"./epsilon":163,"./equals":164,"./exactEquals":165,"./floor":166,"./forEach":167,"./fromValues":168,"./inverse":170,"./len":171,"./length":172,"./lerp":173,"./max":174,"./min":175,"./mul":176,"./multiply":177,"./negate":178,"./normalize":179,"./random":180,"./rotateX":181,"./rotateY":182,"./rotateZ":183,"./round":184,"./scale":185,"./scaleAndAdd":186,"./set":187,"./sqrDist":188,"./sqrLen":189,"./squaredDistance":190,"./squaredLength":191,"./sub":192,"./subtract":193,"./transformMat3":194,"./transformMat4":195,"./transformQuat":196}],170:[function(v,w,y){w.exports=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}},{}],171:[function(v,w,y){w.exports=v("./length")},{"./length":172}],172:[function(v,w,y){w.exports=function(e){var t=e[0],n=e[1],o=e[2];return Math.sqrt(t*t+n*n+o*o)}},{}],173:[function(v,w,y){w.exports=function(e,t,n,o){var r=t[0],g=t[1],c=t[2];return e[0]=r+o*(n[0]-r),e[1]=g+o*(n[1]-g),e[2]=c+o*(n[2]-c),e}},{}],174:[function(v,w,y){w.exports=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e}},{}],175:[function(v,w,y){w.exports=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e}},{}],176:[function(v,w,y){w.exports=v("./multiply")},{"./multiply":177}],177:[function(v,w,y){w.exports=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e}},{}],178:[function(v,w,y){w.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}},{}],179:[function(v,w,y){w.exports=function(e,t){var n=t[0],o=t[1],r=t[2],g=n*n+o*o+r*r;return g>0&&(g=1/Math.sqrt(g),e[0]=t[0]*g,e[1]=t[1]*g,e[2]=t[2]*g),e}},{}],180:[function(v,w,y){w.exports=function(e,t){t=t||1;var n=2*Math.random()*Math.PI,o=2*Math.random()-1,r=Math.sqrt(1-o*o)*t;return e[0]=Math.cos(n)*r,e[1]=Math.sin(n)*r,e[2]=o*t,e}},{}],181:[function(v,w,y){w.exports=function(e,t,n,o){var r=n[1],g=n[2],c=t[1]-r,a=t[2]-g,h=Math.sin(o),l=Math.cos(o);return e[0]=t[0],e[1]=r+c*l-a*h,e[2]=g+c*h+a*l,e}},{}],182:[function(v,w,y){w.exports=function(e,t,n,o){var r=n[0],g=n[2],c=t[0]-r,a=t[2]-g,h=Math.sin(o),l=Math.cos(o);return e[0]=r+a*h+c*l,e[1]=t[1],e[2]=g+a*l-c*h,e}},{}],183:[function(v,w,y){w.exports=function(e,t,n,o){var r=n[0],g=n[1],c=t[0]-r,a=t[1]-g,h=Math.sin(o),l=Math.cos(o);return e[0]=r+c*l-a*h,e[1]=g+c*h+a*l,e[2]=t[2],e}},{}],184:[function(v,w,y){w.exports=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}},{}],185:[function(v,w,y){w.exports=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}},{}],186:[function(v,w,y){w.exports=function(e,t,n,o){return e[0]=t[0]+n[0]*o,e[1]=t[1]+n[1]*o,e[2]=t[2]+n[2]*o,e}},{}],187:[function(v,w,y){w.exports=function(e,t,n,o){return e[0]=t,e[1]=n,e[2]=o,e}},{}],188:[function(v,w,y){w.exports=v("./squaredDistance")},{"./squaredDistance":190}],189:[function(v,w,y){w.exports=v("./squaredLength")},{"./squaredLength":191}],190:[function(v,w,y){w.exports=function(e,t){var n=t[0]-e[0],o=t[1]-e[1],r=t[2]-e[2];return n*n+o*o+r*r}},{}],191:[function(v,w,y){w.exports=function(e){var t=e[0],n=e[1],o=e[2];return t*t+n*n+o*o}},{}],192:[function(v,w,y){w.exports=v("./subtract")},{"./subtract":193}],193:[function(v,w,y){w.exports=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e}},{}],194:[function(v,w,y){w.exports=function(e,t,n){var o=t[0],r=t[1],g=t[2];return e[0]=o*n[0]+r*n[3]+g*n[6],e[1]=o*n[1]+r*n[4]+g*n[7],e[2]=o*n[2]+r*n[5]+g*n[8],e}},{}],195:[function(v,w,y){w.exports=function(e,t,n){var o=t[0],r=t[1],g=t[2],c=n[3]*o+n[7]*r+n[11]*g+n[15];return c=c||1,e[0]=(n[0]*o+n[4]*r+n[8]*g+n[12])/c,e[1]=(n[1]*o+n[5]*r+n[9]*g+n[13])/c,e[2]=(n[2]*o+n[6]*r+n[10]*g+n[14])/c,e}},{}],196:[function(v,w,y){w.exports=function(e,t,n){var o=t[0],r=t[1],g=t[2],c=n[0],a=n[1],h=n[2],l=n[3],s=l*o+a*g-h*r,p=l*r+h*o-c*g,u=l*g+c*r-a*o,i=-c*o-a*r-h*g;return e[0]=s*l+i*-c+p*-h-u*-a,e[1]=p*l+i*-a+u*-c-s*-h,e[2]=u*l+i*-h+s*-a-p*-c,e}},{}],197:[function(v,w,y){w.exports=function(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e[2]=t[2]+n[2],e[3]=t[3]+n[3],e}},{}],198:[function(v,w,y){w.exports=function(e){var t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}},{}],199:[function(v,w,y){w.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}},{}],200:[function(v,w,y){w.exports=function(){var e=new Float32Array(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}},{}],201:[function(v,w,y){w.exports=function(e,t){var n=t[0]-e[0],o=t[1]-e[1],r=t[2]-e[2],g=t[3]-e[3];return Math.sqrt(n*n+o*o+r*r+g*g)}},{}],202:[function(v,w,y){w.exports=function(e,t,n){return e[0]=t[0]/n[0],e[1]=t[1]/n[1],e[2]=t[2]/n[2],e[3]=t[3]/n[3],e}},{}],203:[function(v,w,y){w.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}},{}],204:[function(v,w,y){w.exports=function(e,t,n,o){var r=new Float32Array(4);return r[0]=e,r[1]=t,r[2]=n,r[3]=o,r}},{}],205:[function(v,w,y){w.exports={create:v("./create"),clone:v("./clone"),fromValues:v("./fromValues"),copy:v("./copy"),set:v("./set"),add:v("./add"),subtract:v("./subtract"),multiply:v("./multiply"),divide:v("./divide"),min:v("./min"),max:v("./max"),scale:v("./scale"),scaleAndAdd:v("./scaleAndAdd"),distance:v("./distance"),squaredDistance:v("./squaredDistance"),length:v("./length"),squaredLength:v("./squaredLength"),negate:v("./negate"),inverse:v("./inverse"),normalize:v("./normalize"),dot:v("./dot"),lerp:v("./lerp"),random:v("./random"),transformMat4:v("./transformMat4"),transformQuat:v("./transformQuat")}},{"./add":197,"./clone":198,"./copy":199,"./create":200,"./distance":201,"./divide":202,"./dot":203,"./fromValues":204,"./inverse":206,"./length":207,"./lerp":208,"./max":209,"./min":210,"./multiply":211,"./negate":212,"./normalize":213,"./random":214,"./scale":215,"./scaleAndAdd":216,"./set":217,"./squaredDistance":218,"./squaredLength":219,"./subtract":220,"./transformMat4":221,"./transformQuat":222}],206:[function(v,w,y){w.exports=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}},{}],207:[function(v,w,y){w.exports=function(e){var t=e[0],n=e[1],o=e[2],r=e[3];return Math.sqrt(t*t+n*n+o*o+r*r)}},{}],208:[function(v,w,y){w.exports=function(e,t,n,o){var r=t[0],g=t[1],c=t[2],a=t[3];return e[0]=r+o*(n[0]-r),e[1]=g+o*(n[1]-g),e[2]=c+o*(n[2]-c),e[3]=a+o*(n[3]-a),e}},{}],209:[function(v,w,y){w.exports=function(e,t,n){return e[0]=Math.max(t[0],n[0]),e[1]=Math.max(t[1],n[1]),e[2]=Math.max(t[2],n[2]),e[3]=Math.max(t[3],n[3]),e}},{}],210:[function(v,w,y){w.exports=function(e,t,n){return e[0]=Math.min(t[0],n[0]),e[1]=Math.min(t[1],n[1]),e[2]=Math.min(t[2],n[2]),e[3]=Math.min(t[3],n[3]),e}},{}],211:[function(v,w,y){w.exports=function(e,t,n){return e[0]=t[0]*n[0],e[1]=t[1]*n[1],e[2]=t[2]*n[2],e[3]=t[3]*n[3],e}},{}],212:[function(v,w,y){w.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}},{}],213:[function(v,w,y){w.exports=function(e,t){var n=t[0],o=t[1],r=t[2],g=t[3],c=n*n+o*o+r*r+g*g;return c>0&&(c=1/Math.sqrt(c),e[0]=n*c,e[1]=o*c,e[2]=r*c,e[3]=g*c),e}},{}],214:[function(v,w,y){var e=v("./normalize"),t=v("./scale");w.exports=function(n,o){return o=o||1,n[0]=Math.random(),n[1]=Math.random(),n[2]=Math.random(),n[3]=Math.random(),e(n,n),t(n,n,o),n}},{"./normalize":213,"./scale":215}],215:[function(v,w,y){w.exports=function(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e}},{}],216:[function(v,w,y){w.exports=function(e,t,n,o){return e[0]=t[0]+n[0]*o,e[1]=t[1]+n[1]*o,e[2]=t[2]+n[2]*o,e[3]=t[3]+n[3]*o,e}},{}],217:[function(v,w,y){w.exports=function(e,t,n,o,r){return e[0]=t,e[1]=n,e[2]=o,e[3]=r,e}},{}],218:[function(v,w,y){w.exports=function(e,t){var n=t[0]-e[0],o=t[1]-e[1],r=t[2]-e[2],g=t[3]-e[3];return n*n+o*o+r*r+g*g}},{}],219:[function(v,w,y){w.exports=function(e){var t=e[0],n=e[1],o=e[2],r=e[3];return t*t+n*n+o*o+r*r}},{}],220:[function(v,w,y){w.exports=function(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e[2]=t[2]-n[2],e[3]=t[3]-n[3],e}},{}],221:[function(v,w,y){w.exports=function(e,t,n){var o=t[0],r=t[1],g=t[2],c=t[3];return e[0]=n[0]*o+n[4]*r+n[8]*g+n[12]*c,e[1]=n[1]*o+n[5]*r+n[9]*g+n[13]*c,e[2]=n[2]*o+n[6]*r+n[10]*g+n[14]*c,e[3]=n[3]*o+n[7]*r+n[11]*g+n[15]*c,e}},{}],222:[function(v,w,y){w.exports=function(e,t,n){var o=t[0],r=t[1],g=t[2],c=n[0],a=n[1],h=n[2],l=n[3],s=l*o+a*g-h*r,p=l*r+h*o-c*g,u=l*g+c*r-a*o,i=-c*o-a*r-h*g;return e[0]=s*l+i*-c+p*-h-u*-a,e[1]=p*l+i*-a+u*-c-s*-h,e[2]=u*l+i*-h+s*-a-p*-c,e[3]=t[3],e}},{}],223:[function(v,w,y){var e=v("glsl-tokenizer"),t=v("atob-lite");w.exports=function(n){for(var o=Array.isArray(n)?n:e(n),r=0;r<o.length;r++){var g=o[r];if(g.type==="preprocessor"){var c=g.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(c&&c[2]){var a=c[1],h=c[2];return(a?t(h):h).trim()}}}}},{"atob-lite":13,"glsl-tokenizer":230}],224:[function(v,w,y){w.exports=function(c){var a,h,l,s=0,p=0,u=999,i=[],x=[],f=1,_=0,b=0,T=!1,k=!1,L="",A=n,I=e;(c=c||{}).version==="300 es"&&(A=r,I=o);var P={},S={};for(s=0;s<A.length;s++)P[A[s]]=!0;for(s=0;s<I.length;s++)S[I[s]]=!0;return function(N){return x=[],N!==null?function(U){s=0,U.toString&&(U=U.toString());var te;for(L+=U.replace(/\r\n/g,`
`),l=L.length;a=L[s],s<l;){switch(te=s,u){case 0:s=V();break;case 1:case 2:s=j();break;case 3:s=Z();break;case 4:s=$();break;case 11:s=X();break;case 5:s=re();break;case 9999:s=H();break;case 9:s=D();break;case 999:s=z()}if(te!==s)switch(L[te]){case`
`:_=0,++f;break;default:++_}}return p+=s,L=L.slice(s),x}(N):function(U){return i.length&&E(i.join("")),u=10,E("(eof)"),x}()};function E(N){N.length&&x.push({type:g[u],data:N,position:b,line:f,column:_})}function z(){return i=i.length?[]:i,h==="/"&&a==="*"?(b=p+s-1,u=0,h=a,s+1):h==="/"&&a==="/"?(b=p+s-1,u=1,h=a,s+1):a==="#"?(u=2,b=p+s,s):/\s/.test(a)?(u=9,b=p+s,s):(T=/\d/.test(a),k=/[^\w_]/.test(a),b=p+s,u=T?4:k?3:9999,s)}function D(){return/[^\s]/g.test(a)?(E(i.join("")),u=999,s):(i.push(a),h=a,s+1)}function j(){return a!=="\r"&&a!==`
`||h==="\\"?(i.push(a),h=a,s+1):(E(i.join("")),u=999,s)}function V(){return a==="/"&&h==="*"?(i.push(a),E(i.join("")),u=999,s+1):(i.push(a),h=a,s+1)}function Z(){if(h==="."&&/\d/.test(a))return u=5,s;if(h==="/"&&a==="*")return u=0,s;if(h==="/"&&a==="/")return u=1,s;if(a==="."&&i.length){for(;Q(i););return u=5,s}if(a===";"||a===")"||a==="("){if(i.length)for(;Q(i););return E(a),u=999,s+1}var N=i.length===2&&a!=="=";if(/[\w_\d\s]/.test(a)||N){for(;Q(i););return u=999,s}return i.push(a),h=a,s+1}function Q(N){for(var U,te,B=0;;){if(U=t.indexOf(N.slice(0,N.length+B).join("")),te=t[U],U===-1){if(B--+N.length>0)continue;te=N.slice(0,1).join("")}return E(te),b+=te.length,(i=i.slice(te.length)).length}}function X(){return/[^a-fA-F0-9]/.test(a)?(E(i.join("")),u=999,s):(i.push(a),h=a,s+1)}function $(){return a==="."||/[eE]/.test(a)?(i.push(a),u=5,h=a,s+1):a==="x"&&i.length===1&&i[0]==="0"?(u=11,i.push(a),h=a,s+1):/[^\d]/.test(a)?(E(i.join("")),u=999,s):(i.push(a),h=a,s+1)}function re(){return a==="f"&&(i.push(a),h=a,s+=1),/[eE]/.test(a)?(i.push(a),h=a,s+1):(a!=="-"&&a!=="+"||!/[eE]/.test(h))&&/[^\d]/.test(a)?(E(i.join("")),u=999,s):(i.push(a),h=a,s+1)}function H(){if(/[^\d\w_]/.test(a)){var N=i.join("");return u=S[N]?8:P[N]?7:6,E(i.join("")),u=999,s}return i.push(a),h=a,s+1}};var e=v("./lib/literals"),t=v("./lib/operators"),n=v("./lib/builtins"),o=v("./lib/literals-300es"),r=v("./lib/builtins-300es"),g=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"]},{"./lib/builtins":226,"./lib/builtins-300es":225,"./lib/literals":228,"./lib/literals-300es":227,"./lib/operators":229}],225:[function(v,w,y){var e=v("./builtins");e=e.slice().filter(function(t){return!/^(gl\_|texture)/.test(t)}),w.exports=e.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":226}],226:[function(v,w,y){w.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],227:[function(v,w,y){var e=v("./literals");w.exports=e.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":228}],228:[function(v,w,y){w.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],229:[function(v,w,y){w.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],230:[function(v,w,y){var e=v("./index");w.exports=function(t,n){var o=e(n),r=[];return r=(r=r.concat(o(t))).concat(o(null))}},{"./index":224}],231:[function(v,w,y){w.exports=function(e){typeof e=="string"&&(e=[e]);for(var t=[].slice.call(arguments,1),n=[],o=0;o<e.length-1;o++)n.push(e[o],t[o]||"");return n.push(e[o]),n.join("")}},{}],232:[function(v,w,y){var e=v("is-browser");w.exports=e&&function(){var t=!1;try{var n=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,n),window.removeEventListener("test",null,n)}catch{t=!1}return t}()},{"is-browser":236}],233:[function(v,w,y){w.exports=function(h,l){var s=h.length;if(s===0)throw new Error("Must have at least d+1 points");var p=h[0].length;if(s<=p)throw new Error("Must input at least d+1 points");var u=h.slice(0,p+1),i=e.apply(void 0,u);if(i===0)throw new Error("Input not in general position");for(var x=new Array(p+1),f=0;f<=p;++f)x[f]=f;i<0&&(x[0]=1,x[1]=0);var _=new n(x,new Array(p+1),!1),b=_.adjacent,T=new Array(p+2);for(f=0;f<=p;++f){for(var k=x.slice(),L=0;L<=p;++L)L===f&&(k[L]=-1);var A=k[0];k[0]=k[1],k[1]=A;var I=new n(k,new Array(p+1),!0);b[f]=I,T[f]=I}for(T[p+1]=_,f=0;f<=p;++f){k=b[f].vertices;var P=b[f].adjacent;for(L=0;L<=p;++L){var S=k[L];if(S<0)P[L]=_;else for(var E=0;E<=p;++E)b[E].vertices.indexOf(S)<0&&(P[L]=b[E])}}var z=new c(p,u,T),D=!!l;for(f=p+1;f<s;++f)z.insert(h[f],D);return z.boundary()};var e=v("robust-orientation"),t=v("simplicial-complex").compareCells;function n(h,l,s){this.vertices=h,this.adjacent=l,this.boundary=s,this.lastVisited=-1}function o(h,l,s){this.vertices=h,this.cell=l,this.index=s}function r(h,l){return t(h.vertices,l.vertices)}n.prototype.flip=function(){var h=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=h;var l=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=l};var g=[];function c(h,l,s){this.dimension=h,this.vertices=l,this.simplices=s,this.interior=s.filter(function(x){return!x.boundary}),this.tuple=new Array(h+1);for(var p=0;p<=h;++p)this.tuple[p]=this.vertices[p];var u,i=g[h];i||(i=g[h]=((u=e[h+1])||(u=e),function(x){return function(){var f=this.tuple;return x.apply(this,f)}}(u))),this.orient=i}var a=c.prototype;a.handleBoundaryDegeneracy=function(h,l){var s=this.dimension,p=this.vertices.length-1,u=this.tuple,i=this.vertices,x=[h];for(h.lastVisited=-p;x.length>0;)for(var f=(h=x.pop()).adjacent,_=0;_<=s;++_){var b=f[_];if(b.boundary&&!(b.lastVisited<=-p)){for(var T=b.vertices,k=0;k<=s;++k){var L=T[k];u[k]=L<0?l:i[L]}var A=this.orient();if(A>0)return b;b.lastVisited=-p,A===0&&x.push(b)}}return null},a.walk=function(h,l){var s=this.vertices.length-1,p=this.dimension,u=this.vertices,i=this.tuple,x=l?this.interior.length*Math.random()|0:this.interior.length-1,f=this.interior[x];e:for(;!f.boundary;){for(var _=f.vertices,b=f.adjacent,T=0;T<=p;++T)i[T]=u[_[T]];for(f.lastVisited=s,T=0;T<=p;++T){var k=b[T];if(!(k.lastVisited>=s)){var L=i[T];i[T]=h;var A=this.orient();if(i[T]=L,A<0){f=k;continue e}k.boundary?k.lastVisited=-s:k.lastVisited=s}}return}return f},a.addPeaks=function(h,l){var s=this.vertices.length-1,p=this.dimension,u=this.vertices,i=this.tuple,x=this.interior,f=this.simplices,_=[l];l.lastVisited=s,l.vertices[l.vertices.indexOf(-1)]=s,l.boundary=!1,x.push(l);for(var b=[];_.length>0;){var T=(l=_.pop()).vertices,k=l.adjacent,L=T.indexOf(s);if(!(L<0)){for(var A=0;A<=p;++A)if(A!==L){var I=k[A];if(I.boundary&&!(I.lastVisited>=s)){var P=I.vertices;if(I.lastVisited!==-s){for(var S=0,E=0;E<=p;++E)P[E]<0?(S=E,i[E]=h):i[E]=u[P[E]];if(this.orient()>0){P[S]=s,I.boundary=!1,x.push(I),_.push(I),I.lastVisited=s;continue}I.lastVisited=-s}var z=I.adjacent,D=T.slice(),j=k.slice(),V=new n(D,j,!0);f.push(V);var Z=z.indexOf(l);if(!(Z<0))for(z[Z]=V,j[L]=I,D[A]=-1,j[A]=l,k[A]=V,V.flip(),E=0;E<=p;++E){var Q=D[E];if(!(Q<0||Q===s)){for(var X=new Array(p-1),$=0,re=0;re<=p;++re){var H=D[re];H<0||re===E||(X[$++]=H)}b.push(new o(X,V,E))}}}}}}for(b.sort(r),A=0;A+1<b.length;A+=2){var N=b[A],U=b[A+1],te=N.index,B=U.index;te<0||B<0||(N.cell.adjacent[N.index]=U.cell,U.cell.adjacent[U.index]=N.cell)}},a.insert=function(h,l){var s=this.vertices;s.push(h);var p=this.walk(h,l);if(p){for(var u=this.dimension,i=this.tuple,x=0;x<=u;++x){var f=p.vertices[x];i[x]=f<0?h:s[f]}var _=this.orient(i);_<0||(_!==0||(p=this.handleBoundaryDegeneracy(p,h)))&&this.addPeaks(h,p)}},a.boundary=function(){for(var h=this.dimension,l=[],s=this.simplices,p=s.length,u=0;u<p;++u){var i=s[u];if(i.boundary){for(var x=new Array(h),f=i.vertices,_=0,b=0,T=0;T<=h;++T)f[T]>=0?x[_++]=f[T]:b=1&T;if(b===(1&h)){var k=x[0];x[0]=x[1],x[1]=k}l.push(x)}}return l}},{"robust-orientation":284,"simplicial-complex":293}],234:[function(v,w,y){var e=v("binary-search-bounds");function t(_,b,T,k,L){this.mid=_,this.left=b,this.right=T,this.leftPoints=k,this.rightPoints=L,this.count=(b?b.count:0)+(T?T.count:0)+k.length}w.exports=function(_){return!_||_.length===0?new x(null):new x(i(_))};var n=t.prototype;function o(_,b){_.mid=b.mid,_.left=b.left,_.right=b.right,_.leftPoints=b.leftPoints,_.rightPoints=b.rightPoints,_.count=b.count}function r(_,b){var T=i(b);_.mid=T.mid,_.left=T.left,_.right=T.right,_.leftPoints=T.leftPoints,_.rightPoints=T.rightPoints,_.count=T.count}function g(_,b){var T=_.intervals([]);T.push(b),r(_,T)}function c(_,b){var T=_.intervals([]),k=T.indexOf(b);return k<0?0:(T.splice(k,1),r(_,T),1)}function a(_,b,T){for(var k=0;k<_.length&&_[k][0]<=b;++k){var L=T(_[k]);if(L)return L}}function h(_,b,T){for(var k=_.length-1;k>=0&&_[k][1]>=b;--k){var L=T(_[k]);if(L)return L}}function l(_,b){for(var T=0;T<_.length;++T){var k=b(_[T]);if(k)return k}}function s(_,b){return _-b}function p(_,b){var T=_[0]-b[0];return T||_[1]-b[1]}function u(_,b){var T=_[1]-b[1];return T||_[0]-b[0]}function i(_){if(_.length===0)return null;for(var b=[],T=0;T<_.length;++T)b.push(_[T][0],_[T][1]);b.sort(s);var k=b[b.length>>1],L=[],A=[],I=[];for(T=0;T<_.length;++T){var P=_[T];P[1]<k?L.push(P):k<P[0]?A.push(P):I.push(P)}var S=I,E=I.slice();return S.sort(p),E.sort(u),new t(k,i(L),i(A),S,E)}function x(_){this.root=_}n.intervals=function(_){return _.push.apply(_,this.leftPoints),this.left&&this.left.intervals(_),this.right&&this.right.intervals(_),_},n.insert=function(_){var b=this.count-this.leftPoints.length;if(this.count+=1,_[1]<this.mid)this.left?4*(this.left.count+1)>3*(b+1)?g(this,_):this.left.insert(_):this.left=i([_]);else if(_[0]>this.mid)this.right?4*(this.right.count+1)>3*(b+1)?g(this,_):this.right.insert(_):this.right=i([_]);else{var T=e.ge(this.leftPoints,_,p),k=e.ge(this.rightPoints,_,u);this.leftPoints.splice(T,0,_),this.rightPoints.splice(k,0,_)}},n.remove=function(_){var b=this.count-this.leftPoints;if(_[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(b-1)?c(this,_):(A=this.left.remove(_))===2?(this.left=null,this.count-=1,1):(A===1&&(this.count-=1),A):0;if(_[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(b-1)?c(this,_):(A=this.right.remove(_))===2?(this.right=null,this.count-=1,1):(A===1&&(this.count-=1),A):0;if(this.count===1)return this.leftPoints[0]===_?2:0;if(this.leftPoints.length===1&&this.leftPoints[0]===_){if(this.left&&this.right){for(var T=this,k=this.left;k.right;)T=k,k=k.right;if(T===this)k.right=this.right;else{var L=this.left,A=this.right;T.count-=k.count,T.right=k.left,k.left=L,k.right=A}o(this,k),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?o(this,this.left):o(this,this.right);return 1}for(L=e.ge(this.leftPoints,_,p);L<this.leftPoints.length&&this.leftPoints[L][0]===_[0];++L)if(this.leftPoints[L]===_){for(this.count-=1,this.leftPoints.splice(L,1),A=e.ge(this.rightPoints,_,u);A<this.rightPoints.length&&this.rightPoints[A][1]===_[1];++A)if(this.rightPoints[A]===_)return this.rightPoints.splice(A,1),1}return 0},n.queryPoint=function(_,b){if(_<this.mid)return this.left&&(T=this.left.queryPoint(_,b))?T:a(this.leftPoints,_,b);if(_>this.mid){var T;return this.right&&(T=this.right.queryPoint(_,b))?T:h(this.rightPoints,_,b)}return l(this.leftPoints,b)},n.queryInterval=function(_,b,T){var k;return _<this.mid&&this.left&&(k=this.left.queryInterval(_,b,T))||b>this.mid&&this.right&&(k=this.right.queryInterval(_,b,T))?k:b<this.mid?a(this.leftPoints,b,T):_>this.mid?h(this.rightPoints,_,T):l(this.leftPoints,T)};var f=x.prototype;f.insert=function(_){this.root?this.root.insert(_):this.root=new t(_[0],null,null,[_],[_])},f.remove=function(_){if(this.root){var b=this.root.remove(_);return b===2&&(this.root=null),b!==0}return!1},f.queryPoint=function(_,b){if(this.root)return this.root.queryPoint(_,b)},f.queryInterval=function(_,b,T){if(_<=b&&this.root)return this.root.queryInterval(_,b,T)},Object.defineProperty(f,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(f,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}})},{"binary-search-bounds":31}],235:[function(v,w,y){w.exports=function(e){for(var t=new Array(e),n=0;n<e;++n)t[n]=n;return t}},{}],236:[function(v,w,y){w.exports=!0},{}],237:[function(v,w,y){function e(t){return!!t.constructor&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)}/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */w.exports=function(t){return t!=null&&(e(t)||function(n){return typeof n.readFloatLE=="function"&&typeof n.slice=="function"&&e(n.slice(0,0))}(t)||!!t._isBuffer)}},{}],238:[function(v,w,y){w.exports=n,w.exports.isMobile=n,w.exports.default=n;var e=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,t=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function n(o){o||(o={});var r=o.ua;if(r||typeof navigator>"u"||(r=navigator.userAgent),r&&r.headers&&typeof r.headers["user-agent"]=="string"&&(r=r.headers["user-agent"]),typeof r!="string")return!1;var g=o.tablet?t.test(r):e.test(r);return!g&&o.tablet&&o.featureDetect&&navigator&&navigator.maxTouchPoints>1&&r.indexOf("Macintosh")!==-1&&r.indexOf("Safari")!==-1&&(g=!0),g}},{}],239:[function(v,w,y){w.exports=function(e){for(var t,n=e.length,o=0;o<n;o++)if(((t=e.charCodeAt(o))<9||t>13)&&t!==32&&t!==133&&t!==160&&t!==5760&&t!==6158&&(t<8192||t>8205)&&t!==8232&&t!==8233&&t!==8239&&t!==8287&&t!==8288&&t!==12288&&t!==65279)return!1;return!0}},{}],240:[function(v,w,y){w.exports=function(e,t,n){return e*(1-n)+t*n}},{}],241:[function(v,w,y){var e=v("./normalize"),t=v("gl-mat4/create"),n=v("gl-mat4/clone"),o=v("gl-mat4/determinant"),r=v("gl-mat4/invert"),g=v("gl-mat4/transpose"),c={length:v("gl-vec3/length"),normalize:v("gl-vec3/normalize"),dot:v("gl-vec3/dot"),cross:v("gl-vec3/cross")},a=t(),h=t(),l=[0,0,0,0],s=[[0,0,0],[0,0,0],[0,0,0]],p=[0,0,0];function u(i,x,f,_,b){i[0]=x[0]*_+f[0]*b,i[1]=x[1]*_+f[1]*b,i[2]=x[2]*_+f[2]*b}w.exports=function(i,x,f,_,b,T){if(x||(x=[0,0,0]),f||(f=[0,0,0]),_||(_=[0,0,0]),b||(b=[0,0,0,1]),T||(T=[0,0,0,1]),!e(a,i)||(n(h,a),h[3]=0,h[7]=0,h[11]=0,h[15]=1,Math.abs(o(h)<1e-8)))return!1;var k,L,A,I,P,S,E,z=a[3],D=a[7],j=a[11],V=a[12],Z=a[13],Q=a[14],X=a[15];if(z!==0||D!==0||j!==0){if(l[0]=z,l[1]=D,l[2]=j,l[3]=X,!r(h,h))return!1;g(h,h),k=b,A=h,I=(L=l)[0],P=L[1],S=L[2],E=L[3],k[0]=A[0]*I+A[4]*P+A[8]*S+A[12]*E,k[1]=A[1]*I+A[5]*P+A[9]*S+A[13]*E,k[2]=A[2]*I+A[6]*P+A[10]*S+A[14]*E,k[3]=A[3]*I+A[7]*P+A[11]*S+A[15]*E}else b[0]=b[1]=b[2]=0,b[3]=1;if(x[0]=V,x[1]=Z,x[2]=Q,function(re,H){re[0][0]=H[0],re[0][1]=H[1],re[0][2]=H[2],re[1][0]=H[4],re[1][1]=H[5],re[1][2]=H[6],re[2][0]=H[8],re[2][1]=H[9],re[2][2]=H[10]}(s,a),f[0]=c.length(s[0]),c.normalize(s[0],s[0]),_[0]=c.dot(s[0],s[1]),u(s[1],s[1],s[0],1,-_[0]),f[1]=c.length(s[1]),c.normalize(s[1],s[1]),_[0]/=f[1],_[1]=c.dot(s[0],s[2]),u(s[2],s[2],s[0],1,-_[1]),_[2]=c.dot(s[1],s[2]),u(s[2],s[2],s[1],1,-_[2]),f[2]=c.length(s[2]),c.normalize(s[2],s[2]),_[1]/=f[2],_[2]/=f[2],c.cross(p,s[1],s[2]),c.dot(s[0],p)<0)for(var $=0;$<3;$++)f[$]*=-1,s[$][0]*=-1,s[$][1]*=-1,s[$][2]*=-1;return T[0]=.5*Math.sqrt(Math.max(1+s[0][0]-s[1][1]-s[2][2],0)),T[1]=.5*Math.sqrt(Math.max(1-s[0][0]+s[1][1]-s[2][2],0)),T[2]=.5*Math.sqrt(Math.max(1-s[0][0]-s[1][1]+s[2][2],0)),T[3]=.5*Math.sqrt(Math.max(1+s[0][0]+s[1][1]+s[2][2],0)),s[2][1]>s[1][2]&&(T[0]=-T[0]),s[0][2]>s[2][0]&&(T[1]=-T[1]),s[1][0]>s[0][1]&&(T[2]=-T[2]),!0}},{"./normalize":242,"gl-mat4/clone":92,"gl-mat4/create":93,"gl-mat4/determinant":94,"gl-mat4/invert":98,"gl-mat4/transpose":109,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/length":172,"gl-vec3/normalize":179}],242:[function(v,w,y){w.exports=function(e,t){var n=t[15];if(n===0)return!1;for(var o=1/n,r=0;r<16;r++)e[r]=t[r]*o;return!0}},{}],243:[function(v,w,y){var e=v("gl-vec3/lerp"),t=v("mat4-recompose"),n=v("mat4-decompose"),o=v("gl-mat4/determinant"),r=v("quat-slerp"),g=h(),c=h(),a=h();function h(){return{translate:l(),scale:l(1),skew:l(),perspective:[0,0,0,1],quaternion:[0,0,0,1]}}function l(s){return[s||0,s||0,s||0]}w.exports=function(s,p,u,i){if(o(p)===0||o(u)===0)return!1;var x=n(p,g.translate,g.scale,g.skew,g.perspective,g.quaternion),f=n(u,c.translate,c.scale,c.skew,c.perspective,c.quaternion);return!(!x||!f)&&(e(a.translate,g.translate,c.translate,i),e(a.skew,g.skew,c.skew,i),e(a.scale,g.scale,c.scale,i),e(a.perspective,g.perspective,c.perspective,i),r(a.quaternion,g.quaternion,c.quaternion,i),t(s,a.translate,a.scale,a.skew,a.perspective,a.quaternion),!0)}},{"gl-mat4/determinant":94,"gl-vec3/lerp":173,"mat4-decompose":241,"mat4-recompose":244,"quat-slerp":271}],244:[function(v,w,y){var e={identity:v("gl-mat4/identity"),translate:v("gl-mat4/translate"),multiply:v("gl-mat4/multiply"),create:v("gl-mat4/create"),scale:v("gl-mat4/scale"),fromRotationTranslation:v("gl-mat4/fromRotationTranslation")},t=(e.create(),e.create());w.exports=function(n,o,r,g,c,a){return e.identity(n),e.fromRotationTranslation(n,a,o),n[3]=c[0],n[7]=c[1],n[11]=c[2],n[15]=c[3],e.identity(t),g[2]!==0&&(t[9]=g[2],e.multiply(n,n,t)),g[1]!==0&&(t[9]=0,t[8]=g[1],e.multiply(n,n,t)),g[0]!==0&&(t[8]=0,t[4]=g[0],e.multiply(n,n,t)),e.scale(n,n,r),n}},{"gl-mat4/create":93,"gl-mat4/fromRotationTranslation":96,"gl-mat4/identity":97,"gl-mat4/multiply":100,"gl-mat4/scale":107,"gl-mat4/translate":108}],245:[function(v,w,y){var e=v("binary-search-bounds"),t=v("mat4-interpolate"),n=v("gl-mat4/invert"),o=v("gl-mat4/rotateX"),r=v("gl-mat4/rotateY"),g=v("gl-mat4/rotateZ"),c=v("gl-mat4/lookAt"),a=v("gl-mat4/translate"),h=(v("gl-mat4/scale"),v("gl-vec3/normalize")),l=[0,0,0];function s(i){this._components=i.slice(),this._time=[0],this.prevMatrix=i.slice(),this.nextMatrix=i.slice(),this.computedMatrix=i.slice(),this.computedInverse=i.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}w.exports=function(i){return new s((i=i||{}).matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])};var p=s.prototype;p.recalcMatrix=function(i){var x=this._time,f=e.le(x,i),_=this.computedMatrix;if(!(f<0)){var b=this._components;if(f===x.length-1)for(var T=16*f,k=0;k<16;++k)_[k]=b[T++];else{var L=x[f+1]-x[f],A=(T=16*f,this.prevMatrix),I=!0;for(k=0;k<16;++k)A[k]=b[T++];var P=this.nextMatrix;for(k=0;k<16;++k)P[k]=b[T++],I=I&&A[k]===P[k];if(L<1e-6||I)for(k=0;k<16;++k)_[k]=A[k];else t(_,A,P,(i-x[f])/L)}var S=this.computedUp;S[0]=_[1],S[1]=_[5],S[2]=_[9],h(S,S);var E=this.computedInverse;n(E,_);var z=this.computedEye,D=E[15];z[0]=E[12]/D,z[1]=E[13]/D,z[2]=E[14]/D;var j=this.computedCenter,V=Math.exp(this.computedRadius[0]);for(k=0;k<3;++k)j[k]=z[k]-_[2+4*k]*V}},p.idle=function(i){if(!(i<this.lastT())){for(var x=this._components,f=x.length-16,_=0;_<16;++_)x.push(x[f++]);this._time.push(i)}},p.flush=function(i){var x=e.gt(this._time,i)-2;x<0||(this._time.splice(0,x),this._components.splice(0,16*x))},p.lastT=function(){return this._time[this._time.length-1]},p.lookAt=function(i,x,f,_){this.recalcMatrix(i),x=x||this.computedEye,f=f||l,_=_||this.computedUp,this.setMatrix(i,c(this.computedMatrix,x,f,_));for(var b=0,T=0;T<3;++T)b+=Math.pow(f[T]-x[T],2);b=Math.log(Math.sqrt(b)),this.computedRadius[0]=b},p.rotate=function(i,x,f,_){this.recalcMatrix(i);var b=this.computedInverse;x&&r(b,b,x),f&&o(b,b,f),_&&g(b,b,_),this.setMatrix(i,n(this.computedMatrix,b))};var u=[0,0,0];p.pan=function(i,x,f,_){u[0]=-(x||0),u[1]=-(f||0),u[2]=-(_||0),this.recalcMatrix(i);var b=this.computedInverse;a(b,b,u),this.setMatrix(i,n(b,b))},p.translate=function(i,x,f,_){u[0]=x||0,u[1]=f||0,u[2]=_||0,this.recalcMatrix(i);var b=this.computedMatrix;a(b,b,u),this.setMatrix(i,b)},p.setMatrix=function(i,x){if(!(i<this.lastT())){this._time.push(i);for(var f=0;f<16;++f)this._components.push(x[f])}},p.setDistance=function(i,x){this.computedRadius[0]=x},p.setDistanceLimits=function(i,x){var f=this._limits;f[0]=i,f[1]=x},p.getDistanceLimits=function(i){var x=this._limits;return i?(i[0]=x[0],i[1]=x[1],i):x}},{"binary-search-bounds":31,"gl-mat4/invert":98,"gl-mat4/lookAt":99,"gl-mat4/rotateX":104,"gl-mat4/rotateY":105,"gl-mat4/rotateZ":106,"gl-mat4/scale":107,"gl-mat4/translate":108,"gl-vec3/normalize":179,"mat4-interpolate":243}],246:[function(v,w,y){w.exports=function(t){var n=t.length;if(n<3){for(var o=new Array(n),r=0;r<n;++r)o[r]=r;return n===2&&t[0][0]===t[1][0]&&t[0][1]===t[1][1]?[0]:o}var g=new Array(n);for(r=0;r<n;++r)g[r]=r;g.sort(function(x,f){var _=t[x][0]-t[f][0];return _||t[x][1]-t[f][1]});var c=[g[0],g[1]],a=[g[0],g[1]];for(r=2;r<n;++r){for(var h=g[r],l=t[h],s=c.length;s>1&&e(t[c[s-2]],t[c[s-1]],l)<=0;)s-=1,c.pop();for(c.push(h),s=a.length;s>1&&e(t[a[s-2]],t[a[s-1]],l)>=0;)s-=1,a.pop();a.push(h)}o=new Array(a.length+c.length-2);for(var p=0,u=(r=0,c.length);r<u;++r)o[p++]=c[r];for(var i=a.length-2;i>0;--i)o[p++]=a[i];return o};var e=v("robust-orientation")[3]},{"robust-orientation":284}],247:[function(v,w,y){w.exports=function(t,n){n||(n=t,t=window);var o=0,r=0,g=0,c={shift:!1,alt:!1,control:!1,meta:!1},a=!1;function h(T){var k=!1;return"altKey"in T&&(k=k||T.altKey!==c.alt,c.alt=!!T.altKey),"shiftKey"in T&&(k=k||T.shiftKey!==c.shift,c.shift=!!T.shiftKey),"ctrlKey"in T&&(k=k||T.ctrlKey!==c.control,c.control=!!T.ctrlKey),"metaKey"in T&&(k=k||T.metaKey!==c.meta,c.meta=!!T.metaKey),k}function l(T,k){var L=e.x(k),A=e.y(k);"buttons"in k&&(T=0|k.buttons),(T!==o||L!==r||A!==g||h(k))&&(o=0|T,r=L||0,g=A||0,n&&n(o,r,g,c))}function s(T){l(0,T)}function p(){(o||r||g||c.shift||c.alt||c.meta||c.control)&&(r=g=0,o=0,c.shift=c.alt=c.control=c.meta=!1,n&&n(0,0,0,c))}function u(T){h(T)&&n&&n(o,r,g,c)}function i(T){e.buttons(T)===0?l(0,T):l(o,T)}function x(T){l(o|e.buttons(T),T)}function f(T){l(o&~e.buttons(T),T)}function _(){a||(a=!0,t.addEventListener("mousemove",i),t.addEventListener("mousedown",x),t.addEventListener("mouseup",f),t.addEventListener("mouseleave",s),t.addEventListener("mouseenter",s),t.addEventListener("mouseout",s),t.addEventListener("mouseover",s),t.addEventListener("blur",p),t.addEventListener("keyup",u),t.addEventListener("keydown",u),t.addEventListener("keypress",u),t!==window&&(window.addEventListener("blur",p),window.addEventListener("keyup",u),window.addEventListener("keydown",u),window.addEventListener("keypress",u)))}_();var b={element:t};return Object.defineProperties(b,{enabled:{get:function(){return a},set:function(T){T?_():function(){!a||(a=!1,t.removeEventListener("mousemove",i),t.removeEventListener("mousedown",x),t.removeEventListener("mouseup",f),t.removeEventListener("mouseleave",s),t.removeEventListener("mouseenter",s),t.removeEventListener("mouseout",s),t.removeEventListener("mouseover",s),t.removeEventListener("blur",p),t.removeEventListener("keyup",u),t.removeEventListener("keydown",u),t.removeEventListener("keypress",u),t!==window&&(window.removeEventListener("blur",p),window.removeEventListener("keyup",u),window.removeEventListener("keydown",u),window.removeEventListener("keypress",u)))}()},enumerable:!0},buttons:{get:function(){return o},enumerable:!0},x:{get:function(){return r},enumerable:!0},y:{get:function(){return g},enumerable:!0},mods:{get:function(){return c},enumerable:!0}}),b};var e=v("mouse-event")},{"mouse-event":249}],248:[function(v,w,y){var e={left:0,top:0};w.exports=function(t,n,o){n=n||t.currentTarget||t.srcElement,Array.isArray(o)||(o=[0,0]);var r=t.clientX||0,g=t.clientY||0,c=(a=n,a===window||a===document||a===document.body?e:a.getBoundingClientRect()),a;return o[0]=r-c.left,o[1]=g-c.top,o}},{}],249:[function(v,w,y){function e(t){return t.target||t.srcElement||window}y.buttons=function(t){if(typeof t=="object"){if("buttons"in t)return t.buttons;if("which"in t){if((n=t.which)===2)return 4;if(n===3)return 2;if(n>0)return 1<<n-1}else if("button"in t){var n;if((n=t.button)===1)return 4;if(n===2)return 2;if(n>=0)return 1<<n}}return 0},y.element=e,y.x=function(t){if(typeof t=="object"){if("offsetX"in t)return t.offsetX;var n=e(t).getBoundingClientRect();return t.clientX-n.left}return 0},y.y=function(t){if(typeof t=="object"){if("offsetY"in t)return t.offsetY;var n=e(t).getBoundingClientRect();return t.clientY-n.top}return 0}},{}],250:[function(v,w,y){var e=v("to-px");w.exports=function(t,n,o){typeof t=="function"&&(o=!!n,n=t,t=window);var r=e("ex",t),g=function(c){o&&c.preventDefault();var a=c.deltaX||0,h=c.deltaY||0,l=c.deltaZ||0,s=1;switch(c.deltaMode){case 1:s=r;break;case 2:s=window.innerHeight}if(h*=s,l*=s,(a*=s)||h||l)return n(a,h,l,c)};return t.addEventListener("wheel",g),g}},{"to-px":304}],251:[function(v,w,y){var e=v("typedarray-pool");w.exports=function(n){function o(s){throw new Error("ndarray-extract-contour: "+s)}typeof n!="object"&&o("Must specify arguments");var r=n.order;Array.isArray(r)||o("Must specify order");var g=n.arrayArguments||1;g<1&&o("Must have at least one array argument");var c=n.scalarArguments||0;c<0&&o("Scalar arg count must be > 0"),typeof n.vertex!="function"&&o("Must specify vertex creation function"),typeof n.cell!="function"&&o("Must specify cell creation function"),typeof n.phase!="function"&&o("Must specify phase function");for(var a=n.getters||[],h=new Array(g),l=0;l<g;++l)a.indexOf(l)>=0?h[l]=!0:h[l]=!1;return function(s,p,u,i,x,f){var _=[f,x].join(",");return(0,t[_])(s,p,u,e.mallocUint32,e.freeUint32)}(n.vertex,n.cell,n.phase,0,r,h)};var t={"false,0,1":function(n,o,r,g,c){return function(a,h,l,s){var p,u=0|a.shape[0],i=0|a.shape[1],x=a.data,f=0|a.offset,_=0|a.stride[0],b=0|a.stride[1],T=f,k=0|-_,L=0,A=0|-b,I=0,P=-_-b|0,S=0,E=0|_,z=b-_*u|0,D=0,j=0,V=0,Z=2*u|0,Q=g(Z),X=g(Z),$=0,re=0,H=-1,N=-1,U=0,te=0|-u,B=0|u,K=0,J=-u-1|0,ee=u-1|0,ne=0,se=0,oe=0;for(D=0;D<u;++D)Q[$++]=r(x[T],h,l,s),T+=E;if(T+=z,i>0){if(j=1,Q[$++]=r(x[T],h,l,s),T+=E,u>0)for(D=1,p=x[T],re=Q[$]=r(p,h,l,s),U=Q[$+H],K=Q[$+te],ne=Q[$+J],re===U&&re===K&&re===ne||(L=x[T+k],I=x[T+A],S=x[T+P],n(D,j,p,L,I,S,re,U,K,ne,h,l,s),se=X[$]=V++),$+=1,T+=E,D=2;D<u;++D)p=x[T],re=Q[$]=r(p,h,l,s),U=Q[$+H],K=Q[$+te],ne=Q[$+J],re===U&&re===K&&re===ne||(L=x[T+k],I=x[T+A],S=x[T+P],n(D,j,p,L,I,S,re,U,K,ne,h,l,s),se=X[$]=V++,ne!==U&&o(X[$+H],se,S,L,ne,U,h,l,s)),$+=1,T+=E;for(T+=z,$=0,oe=H,H=N,N=oe,oe=te,te=B,B=oe,oe=J,J=ee,ee=oe,j=2;j<i;++j){if(Q[$++]=r(x[T],h,l,s),T+=E,u>0)for(D=1,p=x[T],re=Q[$]=r(p,h,l,s),U=Q[$+H],K=Q[$+te],ne=Q[$+J],re===U&&re===K&&re===ne||(L=x[T+k],I=x[T+A],S=x[T+P],n(D,j,p,L,I,S,re,U,K,ne,h,l,s),se=X[$]=V++,ne!==K&&o(X[$+te],se,I,S,K,ne,h,l,s)),$+=1,T+=E,D=2;D<u;++D)p=x[T],re=Q[$]=r(p,h,l,s),U=Q[$+H],K=Q[$+te],ne=Q[$+J],re===U&&re===K&&re===ne||(L=x[T+k],I=x[T+A],S=x[T+P],n(D,j,p,L,I,S,re,U,K,ne,h,l,s),se=X[$]=V++,ne!==K&&o(X[$+te],se,I,S,K,ne,h,l,s),ne!==U&&o(X[$+H],se,S,L,ne,U,h,l,s)),$+=1,T+=E;1&j&&($=0),oe=H,H=N,N=oe,oe=te,te=B,B=oe,oe=J,J=ee,ee=oe,T+=z}}c(X),c(Q)}},"false,1,0":function(n,o,r,g,c){return function(a,h,l,s){var p,u=0|a.shape[0],i=0|a.shape[1],x=a.data,f=0|a.offset,_=0|a.stride[0],b=0|a.stride[1],T=f,k=0|-_,L=0,A=0|-b,I=0,P=-_-b|0,S=0,E=0|b,z=_-b*i|0,D=0,j=0,V=0,Z=2*i|0,Q=g(Z),X=g(Z),$=0,re=0,H=-1,N=-1,U=0,te=0|-i,B=0|i,K=0,J=-i-1|0,ee=i-1|0,ne=0,se=0,oe=0;for(j=0;j<i;++j)Q[$++]=r(x[T],h,l,s),T+=E;if(T+=z,u>0){if(D=1,Q[$++]=r(x[T],h,l,s),T+=E,i>0)for(j=1,p=x[T],re=Q[$]=r(p,h,l,s),K=Q[$+te],U=Q[$+H],ne=Q[$+J],re===K&&re===U&&re===ne||(L=x[T+k],I=x[T+A],S=x[T+P],n(D,j,p,L,I,S,re,K,U,ne,h,l,s),se=X[$]=V++),$+=1,T+=E,j=2;j<i;++j)p=x[T],re=Q[$]=r(p,h,l,s),K=Q[$+te],U=Q[$+H],ne=Q[$+J],re===K&&re===U&&re===ne||(L=x[T+k],I=x[T+A],S=x[T+P],n(D,j,p,L,I,S,re,K,U,ne,h,l,s),se=X[$]=V++,ne!==U&&o(X[$+H],se,I,S,U,ne,h,l,s)),$+=1,T+=E;for(T+=z,$=0,oe=te,te=B,B=oe,oe=H,H=N,N=oe,oe=J,J=ee,ee=oe,D=2;D<u;++D){if(Q[$++]=r(x[T],h,l,s),T+=E,i>0)for(j=1,p=x[T],re=Q[$]=r(p,h,l,s),K=Q[$+te],U=Q[$+H],ne=Q[$+J],re===K&&re===U&&re===ne||(L=x[T+k],I=x[T+A],S=x[T+P],n(D,j,p,L,I,S,re,K,U,ne,h,l,s),se=X[$]=V++,ne!==K&&o(X[$+te],se,S,L,ne,K,h,l,s)),$+=1,T+=E,j=2;j<i;++j)p=x[T],re=Q[$]=r(p,h,l,s),K=Q[$+te],U=Q[$+H],ne=Q[$+J],re===K&&re===U&&re===ne||(L=x[T+k],I=x[T+A],S=x[T+P],n(D,j,p,L,I,S,re,K,U,ne,h,l,s),se=X[$]=V++,ne!==U&&o(X[$+H],se,I,S,U,ne,h,l,s),ne!==K&&o(X[$+te],se,S,L,ne,K,h,l,s)),$+=1,T+=E;1&D&&($=0),oe=te,te=B,B=oe,oe=H,H=N,N=oe,oe=J,J=ee,ee=oe,T+=z}}c(X),c(Q)}}}},{"typedarray-pool":308}],252:[function(v,w,y){var e=v("dup"),t={zero:function(u,i,x,f){var _=u[0];f|=0;var b=0,T=x[0];for(b=0;b<_;++b)i[f]=0,f+=T},fdTemplate1:function(u,i,x,f,_,b,T){var k=u[0],L=x[0],A=-1*L,I=L;f|=0,T|=0;var P=0,S=L,E=b[0];for(P=0;P<k;++P)_[T]=.5*(i[f+A]-i[f+I]),f+=S,T+=E},fdTemplate2:function(u,i,x,f,_,b,T,k,L,A){var I=u[0],P=u[1],S=x[0],E=x[1],z=b[0],D=b[1],j=L[0],V=L[1],Z=-1*S,Q=S,X=-1*E,$=E;f|=0,T|=0,A|=0;var re=0,H=0,N=E,U=S-P*E,te=D,B=z-P*D,K=V,J=j-P*V;for(H=0;H<I;++H){for(re=0;re<P;++re)_[T]=.5*(i[f+Z]-i[f+Q]),k[A]=.5*(i[f+X]-i[f+$]),f+=N,T+=te,A+=K;f+=U,T+=B,A+=J}}},n={cdiff:function(u){var i={};return function(x,f,_){var b=x.dtype,T=x.order,k=f.dtype,L=f.order,A=_.dtype,I=_.order,P=[b,T.join(),k,L.join(),A,I.join()].join(),S=i[P];return S||(i[P]=S=u([b,T,k,L,A,I])),S(x.shape.slice(0),x.data,x.stride,0|x.offset,f.data,f.stride,0|f.offset,_.data,_.stride,0|_.offset)}},zero:function(u){var i={};return function(x){var f=x.dtype,_=x.order,b=[f,_.join()].join(),T=i[b];return T||(i[b]=T=u([f,_])),T(x.shape.slice(0),x.data,x.stride,0|x.offset)}},fdTemplate1:function(u){var i={};return function(x,f){var _=x.dtype,b=x.order,T=f.dtype,k=f.order,L=[_,b.join(),T,k.join()].join(),A=i[L];return A||(i[L]=A=u([_,b,T,k])),A(x.shape.slice(0),x.data,x.stride,0|x.offset,f.data,f.stride,0|f.offset)}},fdTemplate2:function(u){var i={};return function(x,f,_){var b=x.dtype,T=x.order,k=f.dtype,L=f.order,A=_.dtype,I=_.order,P=[b,T.join(),k,L.join(),A,I.join()].join(),S=i[P];return S||(i[P]=S=u([b,T,k,L,A,I])),S(x.shape.slice(0),x.data,x.stride,0|x.offset,f.data,f.stride,0|f.offset,_.data,_.stride,0|_.offset)}}};function o(u){return(0,n[u.funcName])(r.bind(void 0,u))}function r(u){return t[u.funcName]}function g(u){return o({funcName:u.funcName})}var c={},a={},h=g({funcName:"cdiff"}),l=g({funcName:"zero"});function s(u){return u in c?c[u]:c[u]=g({funcName:"fdTemplate"+u})}function p(u,i,x,f){return function(_,b){var T=b.shape.slice();return T[0]>2&&T[1]>2&&f(b.pick(-1,-1).lo(1,1).hi(T[0]-2,T[1]-2),_.pick(-1,-1,0).lo(1,1).hi(T[0]-2,T[1]-2),_.pick(-1,-1,1).lo(1,1).hi(T[0]-2,T[1]-2)),T[1]>2&&(x(b.pick(0,-1).lo(1).hi(T[1]-2),_.pick(0,-1,1).lo(1).hi(T[1]-2)),i(_.pick(0,-1,0).lo(1).hi(T[1]-2))),T[1]>2&&(x(b.pick(T[0]-1,-1).lo(1).hi(T[1]-2),_.pick(T[0]-1,-1,1).lo(1).hi(T[1]-2)),i(_.pick(T[0]-1,-1,0).lo(1).hi(T[1]-2))),T[0]>2&&(x(b.pick(-1,0).lo(1).hi(T[0]-2),_.pick(-1,0,0).lo(1).hi(T[0]-2)),i(_.pick(-1,0,1).lo(1).hi(T[0]-2))),T[0]>2&&(x(b.pick(-1,T[1]-1).lo(1).hi(T[0]-2),_.pick(-1,T[1]-1,0).lo(1).hi(T[0]-2)),i(_.pick(-1,T[1]-1,1).lo(1).hi(T[0]-2))),_.set(0,0,0,0),_.set(0,0,1,0),_.set(T[0]-1,0,0,0),_.set(T[0]-1,0,1,0),_.set(0,T[1]-1,0,0),_.set(0,T[1]-1,1,0),_.set(T[0]-1,T[1]-1,0,0),_.set(T[0]-1,T[1]-1,1,0),_}}w.exports=function(u,i,x){return Array.isArray(x)||(x=e(i.dimension,typeof x=="string"?x:"clamp")),i.size===0?u:i.dimension===0?(u.set(0),u):function(f){var _=f.join();if(L=a[_])return L;for(var b=f.length,T=[h,l],k=1;k<=b;++k)T.push(s(k));var L=p.apply(void 0,T);return a[_]=L,L}(x)(u,i)}},{dup:65}],253:[function(v,w,y){function e(r,g){var c=Math.floor(g),a=g-c,h=0<=c&&c<r.shape[0],l=0<=c+1&&c+1<r.shape[0];return(1-a)*(h?+r.get(c):0)+a*(l?+r.get(c+1):0)}function t(r,g,c){var a=Math.floor(g),h=g-a,l=0<=a&&a<r.shape[0],s=0<=a+1&&a+1<r.shape[0],p=Math.floor(c),u=c-p,i=0<=p&&p<r.shape[1],x=0<=p+1&&p+1<r.shape[1],f=l&&i?r.get(a,p):0,_=l&&x?r.get(a,p+1):0;return(1-u)*((1-h)*f+h*(s&&i?r.get(a+1,p):0))+u*((1-h)*_+h*(s&&x?r.get(a+1,p+1):0))}function n(r,g,c,a){var h=Math.floor(g),l=g-h,s=0<=h&&h<r.shape[0],p=0<=h+1&&h+1<r.shape[0],u=Math.floor(c),i=c-u,x=0<=u&&u<r.shape[1],f=0<=u+1&&u+1<r.shape[1],_=Math.floor(a),b=a-_,T=0<=_&&_<r.shape[2],k=0<=_+1&&_+1<r.shape[2],L=s&&x&&T?r.get(h,u,_):0,A=s&&f&&T?r.get(h,u+1,_):0,I=p&&x&&T?r.get(h+1,u,_):0,P=p&&f&&T?r.get(h+1,u+1,_):0,S=s&&x&&k?r.get(h,u,_+1):0,E=s&&f&&k?r.get(h,u+1,_+1):0;return(1-b)*((1-i)*((1-l)*L+l*I)+i*((1-l)*A+l*P))+b*((1-i)*((1-l)*S+l*(p&&x&&k?r.get(h+1,u,_+1):0))+i*((1-l)*E+l*(p&&f&&k?r.get(h+1,u+1,_+1):0)))}function o(r){var g,c,a=0|r.shape.length,h=new Array(a),l=new Array(a),s=new Array(a),p=new Array(a);for(g=0;g<a;++g)c=+arguments[g+1],h[g]=Math.floor(c),l[g]=c-h[g],s[g]=0<=h[g]&&h[g]<r.shape[g],p[g]=0<=h[g]+1&&h[g]+1<r.shape[g];var u,i,x,f=0;e:for(g=0;g<1<<a;++g){for(i=1,x=r.offset,u=0;u<a;++u)if(g&1<<u){if(!p[u])continue e;i*=l[u],x+=r.stride[u]*(h[u]+1)}else{if(!s[u])continue e;i*=1-l[u],x+=r.stride[u]*h[u]}f+=i*r.data[x]}return f}w.exports=function(r,g,c,a){switch(r.shape.length){case 0:return 0;case 1:return e(r,g);case 2:return t(r,g,c);case 3:return n(r,g,c,a);default:return o.apply(void 0,arguments)}},w.exports.d1=e,w.exports.d2=t,w.exports.d3=n},{}],254:[function(v,w,y){var e={"float64,2,1,0":function(){return function(g,c,a,h,l){var s=g[0],p=g[1],u=g[2],i=a[0],x=a[1],f=a[2];h|=0;var _=0,b=0,T=0,k=f,L=x-u*f,A=i-p*x;for(T=0;T<s;++T){for(b=0;b<p;++b){for(_=0;_<u;++_)c[h]/=l,h+=k;h+=L}h+=A}}},"uint8,2,0,1,float64,2,1,0":function(){return function(g,c,a,h,l,s,p,u){for(var i=g[0],x=g[1],f=g[2],_=a[0],b=a[1],T=a[2],k=s[0],L=s[1],A=s[2],I=h|=0,P=p|=0,S=0|g[0];S>0;){S<64?(i=S,S=0):(i=64,S-=64);for(var E=0|g[1];E>0;){E<64?(x=E,E=0):(x=64,E-=64),h=I+S*_+E*b,p=P+S*k+E*L;var z=0,D=0,j=0,V=T,Z=_-f*T,Q=b-i*_,X=A,$=k-f*A,re=L-i*k;for(j=0;j<x;++j){for(D=0;D<i;++D){for(z=0;z<f;++z)c[h]=l[p]*u,h+=V,p+=X;h+=Z,p+=$}h+=Q,p+=re}}}}},"float32,1,0,float32,1,0":function(){return function(g,c,a,h,l,s,p){var u=g[0],i=g[1],x=a[0],f=a[1],_=s[0],b=s[1];h|=0,p|=0;var T=0,k=0,L=f,A=x-i*f,I=b,P=_-i*b;for(k=0;k<u;++k){for(T=0;T<i;++T)c[h]=l[p],h+=L,p+=I;h+=A,p+=P}}},"float32,1,0,float32,0,1":function(){return function(g,c,a,h,l,s,p){for(var u=g[0],i=g[1],x=a[0],f=a[1],_=s[0],b=s[1],T=h|=0,k=p|=0,L=0|g[1];L>0;){L<64?(i=L,L=0):(i=64,L-=64);for(var A=0|g[0];A>0;){A<64?(u=A,A=0):(u=64,A-=64),h=T+L*f+A*x,p=k+L*b+A*_;var I=0,P=0,S=f,E=x-i*f,z=b,D=_-i*b;for(P=0;P<u;++P){for(I=0;I<i;++I)c[h]=l[p],h+=S,p+=z;h+=E,p+=D}}}}},"uint8,2,0,1,uint8,1,2,0":function(){return function(g,c,a,h,l,s,p){for(var u=g[0],i=g[1],x=g[2],f=a[0],_=a[1],b=a[2],T=s[0],k=s[1],L=s[2],A=h|=0,I=p|=0,P=0|g[2];P>0;){P<64?(x=P,P=0):(x=64,P-=64);for(var S=0|g[0];S>0;){S<64?(u=S,S=0):(u=64,S-=64);for(var E=0|g[1];E>0;){E<64?(i=E,E=0):(i=64,E-=64),h=A+P*b+S*f+E*_,p=I+P*L+S*T+E*k;var z=0,D=0,j=0,V=b,Z=f-x*b,Q=_-u*f,X=L,$=T-x*L,re=k-u*T;for(j=0;j<i;++j){for(D=0;D<u;++D){for(z=0;z<x;++z)c[h]=l[p],h+=V,p+=X;h+=Z,p+=$}h+=Q,p+=re}}}}}},"uint8,2,0,1,array,2,0,1":function(){return function(g,c,a,h,l,s,p){var u=g[0],i=g[1],x=g[2],f=a[0],_=a[1],b=a[2],T=s[0],k=s[1],L=s[2];h|=0,p|=0;var A=0,I=0,P=0,S=b,E=f-x*b,z=_-u*f,D=L,j=T-x*L,V=k-u*T;for(P=0;P<i;++P){for(I=0;I<u;++I){for(A=0;A<x;++A)c[h]=l[p],h+=S,p+=D;h+=E,p+=j}h+=z,p+=V}}}},t=function(g,c){var a=c.join(",");return(0,e[a])()},n={mul:function(g){var c={};return function(a,h,l){var s=a.dtype,p=a.order,u=h.dtype,i=h.order,x=l.dtype,f=l.order,_=[s,p.join(),u,i.join(),x,f.join()].join(),b=c[_];return b||(c[_]=b=g([s,p,u,i,x,f])),b(a.shape.slice(0),a.data,a.stride,0|a.offset,h.data,h.stride,0|h.offset,l.data,l.stride,0|l.offset)}},muls:function(g){var c={};return function(a,h,l){var s=a.dtype,p=a.order,u=h.dtype,i=h.order,x=[s,p.join(),u,i.join()].join(),f=c[x];return f||(c[x]=f=g([s,p,u,i])),f(a.shape.slice(0),a.data,a.stride,0|a.offset,h.data,h.stride,0|h.offset,l)}},mulseq:function(g){var c={};return function(a,h){var l=a.dtype,s=a.order,p=[l,s.join()].join(),u=c[p];return u||(c[p]=u=g([l,s])),u(a.shape.slice(0),a.data,a.stride,0|a.offset,h)}},div:function(g){var c={};return function(a,h,l){var s=a.dtype,p=a.order,u=h.dtype,i=h.order,x=l.dtype,f=l.order,_=[s,p.join(),u,i.join(),x,f.join()].join(),b=c[_];return b||(c[_]=b=g([s,p,u,i,x,f])),b(a.shape.slice(0),a.data,a.stride,0|a.offset,h.data,h.stride,0|h.offset,l.data,l.stride,0|l.offset)}},divs:function(g){var c={};return function(a,h,l){var s=a.dtype,p=a.order,u=h.dtype,i=h.order,x=[s,p.join(),u,i.join()].join(),f=c[x];return f||(c[x]=f=g([s,p,u,i])),f(a.shape.slice(0),a.data,a.stride,0|a.offset,h.data,h.stride,0|h.offset,l)}},divseq:function(g){var c={};return function(a,h){var l=a.dtype,s=a.order,p=[l,s.join()].join(),u=c[p];return u||(c[p]=u=g([l,s])),u(a.shape.slice(0),a.data,a.stride,0|a.offset,h)}},assign:function(g){var c={};return function(a,h){var l=a.dtype,s=a.order,p=h.dtype,u=h.order,i=[l,s.join(),p,u.join()].join(),x=c[i];return x||(c[i]=x=g([l,s,p,u])),x(a.shape.slice(0),a.data,a.stride,0|a.offset,h.data,h.stride,0|h.offset)}}};function o(g){return c={funcName:g.funcName},(0,n[c.funcName])(t.bind(void 0,c));var c}var r={mul:"*",div:"/"};(function(){for(var g in r)y[g]=o({funcName:g}),y[g+"s"]=o({funcName:g+"s"}),y[g+"seq"]=o({funcName:g+"seq"})})(),y.assign=o({funcName:"assign"})},{}],255:[function(v,w,y){var e=v("ndarray"),t=v("./doConvert.js");w.exports=function(n,o){for(var r=[],g=n,c=1;Array.isArray(g);)r.push(g.length),c*=g.length,g=g[0];return r.length===0?e():(o||(o=e(new Float64Array(c),r)),t(o,n),o)}},{"./doConvert.js":256,ndarray:259}],256:[function(v,w,y){var e,t=function(){return function(n,o,r,g,c){var a=n[0],h=n[1],l=n[2],s=r[0],p=r[1],u=r[2],i=[0,0,0];g|=0;var x=0,f=0,_=0,b=u,T=p-l*u,k=s-h*p;for(_=0;_<a;++_){for(f=0;f<h;++f){for(x=0;x<l;++x){var L,A=c;for(L=0;L<i.length-1;++L)A=A[i[L]];o[g]=A[i[i.length-1]],g+=b,++i[2]}g+=T,i[2]-=l,++i[1]}g+=k,i[1]-=h,++i[0]}}};w.exports=(e={funcName:"convert"},function(n){var o={};return function(r,g){var c=r.dtype,a=r.order,h=[c,a.join()].join(),l=o[h];return l||(o[h]=l=n([c,a])),l(r.shape.slice(0),r.data,r.stride,0|r.offset,g)}}(t.bind(void 0,e)))},{}],257:[function(v,w,y){var e=v("typedarray-pool");function t(g){switch(g){case"uint32":return[e.mallocUint32,e.freeUint32];default:return null}}var n={"uint32,1,0":function(g,c){return function(a,h,l,s,p,u,i,x,f,_,b){var T,k,L,A,I,P,S,E,z=a*p+s,D=g(x);for(T=a+1;T<=h;++T){for(k=T,L=z+=p,I=0,P=z,A=0;A<x;++A)D[I++]=l[P],P+=f;e:for(;k-- >a;){I=0,P=L-p;t:for(A=0;A<x;++A){if((S=l[P])<(E=D[I]))break e;if(S>E)break t;P+=_,I+=b}for(I=L,P=L-p,A=0;A<x;++A)l[I]=l[P],I+=f,P+=f;L-=p}for(I=L,P=0,A=0;A<x;++A)l[I]=D[P++],I+=f}c(D)}}},o={"uint32,1,0":function(g,c,a){return function h(l,s,p,u,i,x,f,_,b,T,k){var L,A,I,P,S,E,z,D,j,V,Z,Q,X,$,re,H,N,U,te,B,K,J,ee,ne,se,oe=(s-l+1)/6|0,me=l+oe,ce=s-oe,ye=l+s>>1,Se=ye-oe,fe=ye+oe,ge=me,Te=Se,le=ye,ve=fe,Me=ce,we=l+1,de=s-1,Ie=!0,De=0,Oe=0,Ve=0,Fe=_,ze=c(Fe),Re=c(Fe);Z=i*ge,Q=i*Te,se=u;e:for(V=0;V<_;++V){if(D=Q+se,(Ve=p[z=Z+se]-p[D])>0){A=ge,ge=Te,Te=A;break e}if(Ve<0)break e;se+=T}Z=i*ve,Q=i*Me,se=u;e:for(V=0;V<_;++V){if(D=Q+se,(Ve=p[z=Z+se]-p[D])>0){A=ve,ve=Me,Me=A;break e}if(Ve<0)break e;se+=T}Z=i*ge,Q=i*le,se=u;e:for(V=0;V<_;++V){if(D=Q+se,(Ve=p[z=Z+se]-p[D])>0){A=ge,ge=le,le=A;break e}if(Ve<0)break e;se+=T}Z=i*Te,Q=i*le,se=u;e:for(V=0;V<_;++V){if(D=Q+se,(Ve=p[z=Z+se]-p[D])>0){A=Te,Te=le,le=A;break e}if(Ve<0)break e;se+=T}Z=i*ge,Q=i*ve,se=u;e:for(V=0;V<_;++V){if(D=Q+se,(Ve=p[z=Z+se]-p[D])>0){A=ge,ge=ve,ve=A;break e}if(Ve<0)break e;se+=T}Z=i*le,Q=i*ve,se=u;e:for(V=0;V<_;++V){if(D=Q+se,(Ve=p[z=Z+se]-p[D])>0){A=le,le=ve,ve=A;break e}if(Ve<0)break e;se+=T}Z=i*Te,Q=i*Me,se=u;e:for(V=0;V<_;++V){if(D=Q+se,(Ve=p[z=Z+se]-p[D])>0){A=Te,Te=Me,Me=A;break e}if(Ve<0)break e;se+=T}Z=i*Te,Q=i*le,se=u;e:for(V=0;V<_;++V){if(D=Q+se,(Ve=p[z=Z+se]-p[D])>0){A=Te,Te=le,le=A;break e}if(Ve<0)break e;se+=T}Z=i*ve,Q=i*Me,se=u;e:for(V=0;V<_;++V){if(D=Q+se,(Ve=p[z=Z+se]-p[D])>0){A=ve,ve=Me,Me=A;break e}if(Ve<0)break e;se+=T}for(Z=i*ge,Q=i*Te,X=i*le,$=i*ve,re=i*Me,H=i*me,N=i*ye,U=i*ce,ne=0,se=u,V=0;V<_;++V)z=Z+se,D=Q+se,j=X+se,te=$+se,B=re+se,K=H+se,J=N+se,ee=U+se,ze[ne]=p[D],Re[ne]=p[te],Ie=Ie&&ze[ne]===Re[ne],I=p[z],P=p[j],S=p[B],p[K]=I,p[J]=P,p[ee]=S,++ne,se+=b;for(Z=i*Se,Q=i*l,se=u,V=0;V<_;++V)D=Q+se,p[z=Z+se]=p[D],se+=b;for(Z=i*fe,Q=i*s,se=u,V=0;V<_;++V)D=Q+se,p[z=Z+se]=p[D],se+=b;if(Ie)for(E=we;E<=de;++E){for(z=u+E*i,ne=0,V=0;V<_&&(Ve=p[z]-ze[ne])===0;++V)ne+=k,z+=T;if(Ve!==0)if(Ve<0){if(E!==we)for(Z=i*E,Q=i*we,se=u,V=0;V<_;++V)D=Q+se,L=p[z=Z+se],p[z]=p[D],p[D]=L,se+=b;++we}else for(;;){for(z=u+de*i,ne=0,V=0;V<_&&(Ve=p[z]-ze[ne])===0;++V)ne+=k,z+=T;if(!(Ve>0)){if(Ve<0){for(Z=i*E,Q=i*we,X=i*de,se=u,V=0;V<_;++V)D=Q+se,j=X+se,L=p[z=Z+se],p[z]=p[D],p[D]=p[j],p[j]=L,se+=b;++we,--de;break}for(Z=i*E,Q=i*de,se=u,V=0;V<_;++V)D=Q+se,L=p[z=Z+se],p[z]=p[D],p[D]=L,se+=b;--de;break}de--}}else for(E=we;E<=de;++E){for(z=u+E*i,ne=0,V=0;V<_&&(De=p[z]-ze[ne])===0;++V)ne+=k,z+=T;if(De<0){if(E!==we)for(Z=i*E,Q=i*we,se=u,V=0;V<_;++V)D=Q+se,L=p[z=Z+se],p[z]=p[D],p[D]=L,se+=b;++we}else{for(z=u+E*i,ne=0,V=0;V<_&&(Oe=p[z]-Re[ne])===0;++V)ne+=k,z+=T;if(Oe>0)for(;;){for(z=u+de*i,ne=0,V=0;V<_&&(Ve=p[z]-Re[ne])===0;++V)ne+=k,z+=T;if(!(Ve>0)){for(z=u+de*i,ne=0,V=0;V<_&&(Ve=p[z]-ze[ne])===0;++V)ne+=k,z+=T;if(Ve<0){for(Z=i*E,Q=i*we,X=i*de,se=u,V=0;V<_;++V)D=Q+se,j=X+se,L=p[z=Z+se],p[z]=p[D],p[D]=p[j],p[j]=L,se+=b;++we,--de}else{for(Z=i*E,Q=i*de,se=u,V=0;V<_;++V)D=Q+se,L=p[z=Z+se],p[z]=p[D],p[D]=L,se+=b;--de}break}if(--de<E)break}}}for(Z=i*l,Q=i*(we-1),ne=0,se=u,V=0;V<_;++V)D=Q+se,p[z=Z+se]=p[D],p[D]=ze[ne],++ne,se+=b;for(Z=i*s,Q=i*(de+1),ne=0,se=u,V=0;V<_;++V)D=Q+se,p[z=Z+se]=p[D],p[D]=Re[ne],++ne,se+=b;if(we-2-l<=32?g(l,we-2,p,u,i,x,f,_,b,T,k):h(l,we-2,p,u,i,x,f,_,b,T,k),s-(de+2)<=32?g(de+2,s,p,u,i,x,f,_,b,T,k):h(de+2,s,p,u,i,x,f,_,b,T,k),Ie)return a(ze),void a(Re);if(we<me&&de>ce){e:for(;;){for(z=u+we*i,ne=0,se=u,V=0;V<_;++V){if(p[z]!==ze[ne])break e;++ne,z+=b}++we}e:for(;;){for(z=u+de*i,ne=0,se=u,V=0;V<_;++V){if(p[z]!==Re[ne])break e;++ne,z+=b}--de}for(E=we;E<=de;++E){for(z=u+E*i,ne=0,V=0;V<_&&(De=p[z]-ze[ne])===0;++V)ne+=k,z+=T;if(De===0){if(E!==we)for(Z=i*E,Q=i*we,se=u,V=0;V<_;++V)D=Q+se,L=p[z=Z+se],p[z]=p[D],p[D]=L,se+=b;++we}else{for(z=u+E*i,ne=0,V=0;V<_&&(Oe=p[z]-Re[ne])===0;++V)ne+=k,z+=T;if(Oe===0)for(;;){for(z=u+de*i,ne=0,V=0;V<_&&(Ve=p[z]-Re[ne])===0;++V)ne+=k,z+=T;if(Ve!==0){for(z=u+de*i,ne=0,V=0;V<_&&(Ve=p[z]-ze[ne])===0;++V)ne+=k,z+=T;if(Ve<0){for(Z=i*E,Q=i*we,X=i*de,se=u,V=0;V<_;++V)D=Q+se,j=X+se,L=p[z=Z+se],p[z]=p[D],p[D]=p[j],p[j]=L,se+=b;++we,--de}else{for(Z=i*E,Q=i*de,se=u,V=0;V<_;++V)D=Q+se,L=p[z=Z+se],p[z]=p[D],p[D]=L,se+=b;--de}break}if(--de<E)break}}}}a(ze),a(Re),de-we<=32?g(we,de,p,u,i,x,f,_,b,T,k):h(we,de,p,u,i,x,f,_,b,T,k)}}},r={"uint32,1,0":function(g,c){return function(a){var h=a.data,l=0|a.offset,s=a.shape,p=a.stride,u=0|p[0],i=0|s[0],x=0|p[1],f=0|s[1],_=x,b=x;i<=32?g(0,i-1,h,l,u,x,i,f,_,b,1):c(0,i-1,h,l,u,x,i,f,_,b,1)}}};w.exports=function(g,c){var a=[c,g].join(","),h=r[a],l=function(p,u){var i=t(u),x=[u,p].join(","),f=n[x];return i?f(i[0],i[1]):f()}(g,c),s=function(p,u,i){var x=t(u),f=[u,p].join(","),_=o[f];return p.length>1&&x?_(i,x[0],x[1]):_(i)}(g,c,l);return h(l,s)}},{"typedarray-pool":308}],258:[function(v,w,y){var e=v("./lib/compile_sort.js"),t={};w.exports=function(n){var o=n.order,r=n.dtype,g=[o,r].join(":"),c=t[g];return c||(t[g]=c=e(o,r)),c(n),n}},{"./lib/compile_sort.js":257}],259:[function(v,w,y){var e=v("is-buffer"),t=typeof Float64Array<"u";function n(a,h){return a[0]-h[0]}function o(){var a,h=this.stride,l=new Array(h.length);for(a=0;a<l.length;++a)l[a]=[Math.abs(h[a]),a];l.sort(n);var s=new Array(l.length);for(a=0;a<s.length;++a)s[a]=l[a][1];return s}var r={T:function(a){function h(s){this.data=s}var l=h.prototype;return l.dtype=a,l.index=function(){return-1},l.size=0,l.dimension=-1,l.shape=l.stride=l.order=[],l.lo=l.hi=l.transpose=l.step=function(){return new h(this.data)},l.get=l.set=function(){},l.pick=function(){return null},function(s){return new h(s)}},0:function(a,h){function l(p,u){this.data=p,this.offset=u}var s=l.prototype;return s.dtype=a,s.index=function(){return this.offset},s.dimension=0,s.size=1,s.shape=s.stride=s.order=[],s.lo=s.hi=s.transpose=s.step=function(){return new l(this.data,this.offset)},s.pick=function(){return h(this.data)},s.valueOf=s.get=function(){return a==="generic"?this.data.get(this.offset):this.data[this.offset]},s.set=function(p){return a==="generic"?this.data.set(this.offset,p):this.data[this.offset]=p},function(p,u,i,x){return new l(p,x)}},1:function(a,h,l){function s(u,i,x,f){this.data=u,this.shape=[i],this.stride=[x],this.offset=0|f}var p=s.prototype;return p.dtype=a,p.dimension=1,Object.defineProperty(p,"size",{get:function(){return this.shape[0]}}),p.order=[0],p.set=function(u,i){return a==="generic"?this.data.set(this.offset+this.stride[0]*u,i):this.data[this.offset+this.stride[0]*u]=i},p.get=function(u){return a==="generic"?this.data.get(this.offset+this.stride[0]*u):this.data[this.offset+this.stride[0]*u]},p.index=function(u){return this.offset+this.stride[0]*u},p.hi=function(u){return new s(this.data,typeof u!="number"||u<0?this.shape[0]:0|u,this.stride[0],this.offset)},p.lo=function(u){var i=this.offset,x=0,f=this.shape[0],_=this.stride[0];return typeof u=="number"&&u>=0&&(i+=_*(x=0|u),f-=x),new s(this.data,f,_,i)},p.step=function(u){var i=this.shape[0],x=this.stride[0],f=this.offset,_=0,b=Math.ceil;return typeof u=="number"&&((_=0|u)<0?(f+=x*(i-1),i=b(-i/_)):i=b(i/_),x*=_),new s(this.data,i,x,f)},p.transpose=function(u){u=u===void 0?0:0|u;var i=this.shape,x=this.stride;return new s(this.data,i[u],x[u],this.offset)},p.pick=function(u){var i=[],x=[],f=this.offset;return typeof u=="number"&&u>=0?f=f+this.stride[0]*u|0:(i.push(this.shape[0]),x.push(this.stride[0])),(0,h[i.length+1])(this.data,i,x,f)},function(u,i,x,f){return new s(u,i[0],x[0],f)}},2:function(a,h,l){function s(u,i,x,f,_,b){this.data=u,this.shape=[i,x],this.stride=[f,_],this.offset=0|b}var p=s.prototype;return p.dtype=a,p.dimension=2,Object.defineProperty(p,"size",{get:function(){return this.shape[0]*this.shape[1]}}),Object.defineProperty(p,"order",{get:function(){return Math.abs(this.stride[0])>Math.abs(this.stride[1])?[1,0]:[0,1]}}),p.set=function(u,i,x){return a==="generic"?this.data.set(this.offset+this.stride[0]*u+this.stride[1]*i,x):this.data[this.offset+this.stride[0]*u+this.stride[1]*i]=x},p.get=function(u,i){return a==="generic"?this.data.get(this.offset+this.stride[0]*u+this.stride[1]*i):this.data[this.offset+this.stride[0]*u+this.stride[1]*i]},p.index=function(u,i){return this.offset+this.stride[0]*u+this.stride[1]*i},p.hi=function(u,i){return new s(this.data,typeof u!="number"||u<0?this.shape[0]:0|u,typeof i!="number"||i<0?this.shape[1]:0|i,this.stride[0],this.stride[1],this.offset)},p.lo=function(u,i){var x=this.offset,f=0,_=this.shape[0],b=this.shape[1],T=this.stride[0],k=this.stride[1];return typeof u=="number"&&u>=0&&(x+=T*(f=0|u),_-=f),typeof i=="number"&&i>=0&&(x+=k*(f=0|i),b-=f),new s(this.data,_,b,T,k,x)},p.step=function(u,i){var x=this.shape[0],f=this.shape[1],_=this.stride[0],b=this.stride[1],T=this.offset,k=0,L=Math.ceil;return typeof u=="number"&&((k=0|u)<0?(T+=_*(x-1),x=L(-x/k)):x=L(x/k),_*=k),typeof i=="number"&&((k=0|i)<0?(T+=b*(f-1),f=L(-f/k)):f=L(f/k),b*=k),new s(this.data,x,f,_,b,T)},p.transpose=function(u,i){u=u===void 0?0:0|u,i=i===void 0?1:0|i;var x=this.shape,f=this.stride;return new s(this.data,x[u],x[i],f[u],f[i],this.offset)},p.pick=function(u,i){var x=[],f=[],_=this.offset;return typeof u=="number"&&u>=0?_=_+this.stride[0]*u|0:(x.push(this.shape[0]),f.push(this.stride[0])),typeof i=="number"&&i>=0?_=_+this.stride[1]*i|0:(x.push(this.shape[1]),f.push(this.stride[1])),(0,h[x.length+1])(this.data,x,f,_)},function(u,i,x,f){return new s(u,i[0],i[1],x[0],x[1],f)}},3:function(a,h,l){function s(u,i,x,f,_,b,T,k){this.data=u,this.shape=[i,x,f],this.stride=[_,b,T],this.offset=0|k}var p=s.prototype;return p.dtype=a,p.dimension=3,Object.defineProperty(p,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]}}),Object.defineProperty(p,"order",{get:function(){var u=Math.abs(this.stride[0]),i=Math.abs(this.stride[1]),x=Math.abs(this.stride[2]);return u>i?i>x?[2,1,0]:u>x?[1,2,0]:[1,0,2]:u>x?[2,0,1]:x>i?[0,1,2]:[0,2,1]}}),p.set=function(u,i,x,f){return a==="generic"?this.data.set(this.offset+this.stride[0]*u+this.stride[1]*i+this.stride[2]*x,f):this.data[this.offset+this.stride[0]*u+this.stride[1]*i+this.stride[2]*x]=f},p.get=function(u,i,x){return a==="generic"?this.data.get(this.offset+this.stride[0]*u+this.stride[1]*i+this.stride[2]*x):this.data[this.offset+this.stride[0]*u+this.stride[1]*i+this.stride[2]*x]},p.index=function(u,i,x){return this.offset+this.stride[0]*u+this.stride[1]*i+this.stride[2]*x},p.hi=function(u,i,x){return new s(this.data,typeof u!="number"||u<0?this.shape[0]:0|u,typeof i!="number"||i<0?this.shape[1]:0|i,typeof x!="number"||x<0?this.shape[2]:0|x,this.stride[0],this.stride[1],this.stride[2],this.offset)},p.lo=function(u,i,x){var f=this.offset,_=0,b=this.shape[0],T=this.shape[1],k=this.shape[2],L=this.stride[0],A=this.stride[1],I=this.stride[2];return typeof u=="number"&&u>=0&&(f+=L*(_=0|u),b-=_),typeof i=="number"&&i>=0&&(f+=A*(_=0|i),T-=_),typeof x=="number"&&x>=0&&(f+=I*(_=0|x),k-=_),new s(this.data,b,T,k,L,A,I,f)},p.step=function(u,i,x){var f=this.shape[0],_=this.shape[1],b=this.shape[2],T=this.stride[0],k=this.stride[1],L=this.stride[2],A=this.offset,I=0,P=Math.ceil;return typeof u=="number"&&((I=0|u)<0?(A+=T*(f-1),f=P(-f/I)):f=P(f/I),T*=I),typeof i=="number"&&((I=0|i)<0?(A+=k*(_-1),_=P(-_/I)):_=P(_/I),k*=I),typeof x=="number"&&((I=0|x)<0?(A+=L*(b-1),b=P(-b/I)):b=P(b/I),L*=I),new s(this.data,f,_,b,T,k,L,A)},p.transpose=function(u,i,x){u=u===void 0?0:0|u,i=i===void 0?1:0|i,x=x===void 0?2:0|x;var f=this.shape,_=this.stride;return new s(this.data,f[u],f[i],f[x],_[u],_[i],_[x],this.offset)},p.pick=function(u,i,x){var f=[],_=[],b=this.offset;return typeof u=="number"&&u>=0?b=b+this.stride[0]*u|0:(f.push(this.shape[0]),_.push(this.stride[0])),typeof i=="number"&&i>=0?b=b+this.stride[1]*i|0:(f.push(this.shape[1]),_.push(this.stride[1])),typeof x=="number"&&x>=0?b=b+this.stride[2]*x|0:(f.push(this.shape[2]),_.push(this.stride[2])),(0,h[f.length+1])(this.data,f,_,b)},function(u,i,x,f){return new s(u,i[0],i[1],i[2],x[0],x[1],x[2],f)}},4:function(a,h,l){function s(u,i,x,f,_,b,T,k,L,A){this.data=u,this.shape=[i,x,f,_],this.stride=[b,T,k,L],this.offset=0|A}var p=s.prototype;return p.dtype=a,p.dimension=4,Object.defineProperty(p,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]}}),Object.defineProperty(p,"order",{get:l}),p.set=function(u,i,x,f,_){return a==="generic"?this.data.set(this.offset+this.stride[0]*u+this.stride[1]*i+this.stride[2]*x+this.stride[3]*f,_):this.data[this.offset+this.stride[0]*u+this.stride[1]*i+this.stride[2]*x+this.stride[3]*f]=_},p.get=function(u,i,x,f){return a==="generic"?this.data.get(this.offset+this.stride[0]*u+this.stride[1]*i+this.stride[2]*x+this.stride[3]*f):this.data[this.offset+this.stride[0]*u+this.stride[1]*i+this.stride[2]*x+this.stride[3]*f]},p.index=function(u,i,x,f){return this.offset+this.stride[0]*u+this.stride[1]*i+this.stride[2]*x+this.stride[3]*f},p.hi=function(u,i,x,f){return new s(this.data,typeof u!="number"||u<0?this.shape[0]:0|u,typeof i!="number"||i<0?this.shape[1]:0|i,typeof x!="number"||x<0?this.shape[2]:0|x,typeof f!="number"||f<0?this.shape[3]:0|f,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.offset)},p.lo=function(u,i,x,f){var _=this.offset,b=0,T=this.shape[0],k=this.shape[1],L=this.shape[2],A=this.shape[3],I=this.stride[0],P=this.stride[1],S=this.stride[2],E=this.stride[3];return typeof u=="number"&&u>=0&&(_+=I*(b=0|u),T-=b),typeof i=="number"&&i>=0&&(_+=P*(b=0|i),k-=b),typeof x=="number"&&x>=0&&(_+=S*(b=0|x),L-=b),typeof f=="number"&&f>=0&&(_+=E*(b=0|f),A-=b),new s(this.data,T,k,L,A,I,P,S,E,_)},p.step=function(u,i,x,f){var _=this.shape[0],b=this.shape[1],T=this.shape[2],k=this.shape[3],L=this.stride[0],A=this.stride[1],I=this.stride[2],P=this.stride[3],S=this.offset,E=0,z=Math.ceil;return typeof u=="number"&&((E=0|u)<0?(S+=L*(_-1),_=z(-_/E)):_=z(_/E),L*=E),typeof i=="number"&&((E=0|i)<0?(S+=A*(b-1),b=z(-b/E)):b=z(b/E),A*=E),typeof x=="number"&&((E=0|x)<0?(S+=I*(T-1),T=z(-T/E)):T=z(T/E),I*=E),typeof f=="number"&&((E=0|f)<0?(S+=P*(k-1),k=z(-k/E)):k=z(k/E),P*=E),new s(this.data,_,b,T,k,L,A,I,P,S)},p.transpose=function(u,i,x,f){u=u===void 0?0:0|u,i=i===void 0?1:0|i,x=x===void 0?2:0|x,f=f===void 0?3:0|f;var _=this.shape,b=this.stride;return new s(this.data,_[u],_[i],_[x],_[f],b[u],b[i],b[x],b[f],this.offset)},p.pick=function(u,i,x,f){var _=[],b=[],T=this.offset;return typeof u=="number"&&u>=0?T=T+this.stride[0]*u|0:(_.push(this.shape[0]),b.push(this.stride[0])),typeof i=="number"&&i>=0?T=T+this.stride[1]*i|0:(_.push(this.shape[1]),b.push(this.stride[1])),typeof x=="number"&&x>=0?T=T+this.stride[2]*x|0:(_.push(this.shape[2]),b.push(this.stride[2])),typeof f=="number"&&f>=0?T=T+this.stride[3]*f|0:(_.push(this.shape[3]),b.push(this.stride[3])),(0,h[_.length+1])(this.data,_,b,T)},function(u,i,x,f){return new s(u,i[0],i[1],i[2],i[3],x[0],x[1],x[2],x[3],f)}},5:function(a,h,l){function s(u,i,x,f,_,b,T,k,L,A,I,P){this.data=u,this.shape=[i,x,f,_,b],this.stride=[T,k,L,A,I],this.offset=0|P}var p=s.prototype;return p.dtype=a,p.dimension=5,Object.defineProperty(p,"size",{get:function(){return this.shape[0]*this.shape[1]*this.shape[2]*this.shape[3]*this.shape[4]}}),Object.defineProperty(p,"order",{get:l}),p.set=function(u,i,x,f,_,b){return a==="generic"?this.data.set(this.offset+this.stride[0]*u+this.stride[1]*i+this.stride[2]*x+this.stride[3]*f+this.stride[4]*_,b):this.data[this.offset+this.stride[0]*u+this.stride[1]*i+this.stride[2]*x+this.stride[3]*f+this.stride[4]*_]=b},p.get=function(u,i,x,f,_){return a==="generic"?this.data.get(this.offset+this.stride[0]*u+this.stride[1]*i+this.stride[2]*x+this.stride[3]*f+this.stride[4]*_):this.data[this.offset+this.stride[0]*u+this.stride[1]*i+this.stride[2]*x+this.stride[3]*f+this.stride[4]*_]},p.index=function(u,i,x,f,_){return this.offset+this.stride[0]*u+this.stride[1]*i+this.stride[2]*x+this.stride[3]*f+this.stride[4]*_},p.hi=function(u,i,x,f,_){return new s(this.data,typeof u!="number"||u<0?this.shape[0]:0|u,typeof i!="number"||i<0?this.shape[1]:0|i,typeof x!="number"||x<0?this.shape[2]:0|x,typeof f!="number"||f<0?this.shape[3]:0|f,typeof _!="number"||_<0?this.shape[4]:0|_,this.stride[0],this.stride[1],this.stride[2],this.stride[3],this.stride[4],this.offset)},p.lo=function(u,i,x,f,_){var b=this.offset,T=0,k=this.shape[0],L=this.shape[1],A=this.shape[2],I=this.shape[3],P=this.shape[4],S=this.stride[0],E=this.stride[1],z=this.stride[2],D=this.stride[3],j=this.stride[4];return typeof u=="number"&&u>=0&&(b+=S*(T=0|u),k-=T),typeof i=="number"&&i>=0&&(b+=E*(T=0|i),L-=T),typeof x=="number"&&x>=0&&(b+=z*(T=0|x),A-=T),typeof f=="number"&&f>=0&&(b+=D*(T=0|f),I-=T),typeof _=="number"&&_>=0&&(b+=j*(T=0|_),P-=T),new s(this.data,k,L,A,I,P,S,E,z,D,j,b)},p.step=function(u,i,x,f,_){var b=this.shape[0],T=this.shape[1],k=this.shape[2],L=this.shape[3],A=this.shape[4],I=this.stride[0],P=this.stride[1],S=this.stride[2],E=this.stride[3],z=this.stride[4],D=this.offset,j=0,V=Math.ceil;return typeof u=="number"&&((j=0|u)<0?(D+=I*(b-1),b=V(-b/j)):b=V(b/j),I*=j),typeof i=="number"&&((j=0|i)<0?(D+=P*(T-1),T=V(-T/j)):T=V(T/j),P*=j),typeof x=="number"&&((j=0|x)<0?(D+=S*(k-1),k=V(-k/j)):k=V(k/j),S*=j),typeof f=="number"&&((j=0|f)<0?(D+=E*(L-1),L=V(-L/j)):L=V(L/j),E*=j),typeof _=="number"&&((j=0|_)<0?(D+=z*(A-1),A=V(-A/j)):A=V(A/j),z*=j),new s(this.data,b,T,k,L,A,I,P,S,E,z,D)},p.transpose=function(u,i,x,f,_){u=u===void 0?0:0|u,i=i===void 0?1:0|i,x=x===void 0?2:0|x,f=f===void 0?3:0|f,_=_===void 0?4:0|_;var b=this.shape,T=this.stride;return new s(this.data,b[u],b[i],b[x],b[f],b[_],T[u],T[i],T[x],T[f],T[_],this.offset)},p.pick=function(u,i,x,f,_){var b=[],T=[],k=this.offset;return typeof u=="number"&&u>=0?k=k+this.stride[0]*u|0:(b.push(this.shape[0]),T.push(this.stride[0])),typeof i=="number"&&i>=0?k=k+this.stride[1]*i|0:(b.push(this.shape[1]),T.push(this.stride[1])),typeof x=="number"&&x>=0?k=k+this.stride[2]*x|0:(b.push(this.shape[2]),T.push(this.stride[2])),typeof f=="number"&&f>=0?k=k+this.stride[3]*f|0:(b.push(this.shape[3]),T.push(this.stride[3])),typeof _=="number"&&_>=0?k=k+this.stride[4]*_|0:(b.push(this.shape[4]),T.push(this.stride[4])),(0,h[b.length+1])(this.data,b,T,k)},function(u,i,x,f){return new s(u,i[0],i[1],i[2],i[3],i[4],x[0],x[1],x[2],x[3],x[4],f)}}};function g(a,h){var l=h===-1?"T":String(h),s=r[l];return h===-1?s(a):h===0?s(a,c[a][0]):s(a,c[a],o)}var c={generic:[],buffer:[],array:[],float32:[],float64:[],int8:[],int16:[],int32:[],uint8_clamped:[],uint8:[],uint16:[],uint32:[],bigint64:[],biguint64:[]};w.exports=function(a,h,l,s){if(a===void 0)return(0,c.array[0])([]);typeof a=="number"&&(a=[a]),h===void 0&&(h=[a.length]);var p=h.length;if(l===void 0){l=new Array(p);for(var u=p-1,i=1;u>=0;--u)l[u]=i,i*=h[u]}if(s===void 0)for(s=0,u=0;u<p;++u)l[u]<0&&(s-=(h[u]-1)*l[u]);for(var x=function(_){if(e(_))return"buffer";if(t)switch(Object.prototype.toString.call(_)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(_)?"array":"generic"}(a),f=c[x];f.length<=p+1;)f.push(g(x,f.length-1));return(0,f[p+1])(a,h,l,s)}},{"is-buffer":237}],260:[function(v,w,y){var e=v("double-bits"),t=Math.pow(2,-1074);w.exports=function(n,o){if(isNaN(n)||isNaN(o))return NaN;if(n===o)return n;if(n===0)return o<0?-t:t;var r=e.hi(n),g=e.lo(n);return o>n==n>0?g===-1>>>0?(r+=1,g=0):g+=1:g===0?(g=-1>>>0,r-=1):g-=1,e.pack(g,r)}},{"double-bits":64}],261:[function(v,w,y){y.vertexNormals=function(e,t,n){for(var o=t.length,r=new Array(o),g=n===void 0?1e-6:n,c=0;c<o;++c)r[c]=[0,0,0];for(c=0;c<e.length;++c)for(var a=e[c],h=0,l=a[a.length-1],s=a[0],p=0;p<a.length;++p){h=l,l=s,s=a[(p+1)%a.length];for(var u=t[h],i=t[l],x=t[s],f=new Array(3),_=0,b=new Array(3),T=0,k=0;k<3;++k)f[k]=u[k]-i[k],_+=f[k]*f[k],b[k]=x[k]-i[k],T+=b[k]*b[k];if(_*T>g){var L=r[l],A=1/Math.sqrt(_*T);for(k=0;k<3;++k){var I=(k+1)%3,P=(k+2)%3;L[k]+=A*(b[I]*f[P]-b[P]*f[I])}}}for(c=0;c<o;++c){L=r[c];var S=0;for(k=0;k<3;++k)S+=L[k]*L[k];if(S>g)for(A=1/Math.sqrt(S),k=0;k<3;++k)L[k]*=A;else for(k=0;k<3;++k)L[k]=0}return r},y.faceNormals=function(e,t,n){for(var o=e.length,r=new Array(o),g=n===void 0?1e-6:n,c=0;c<o;++c){for(var a=e[c],h=new Array(3),l=0;l<3;++l)h[l]=t[a[l]];var s=new Array(3),p=new Array(3);for(l=0;l<3;++l)s[l]=h[1][l]-h[0][l],p[l]=h[2][l]-h[0][l];var u=new Array(3),i=0;for(l=0;l<3;++l){var x=(l+1)%3,f=(l+2)%3;u[l]=s[x]*p[f]-s[f]*p[x],i+=u[l]*u[l]}for(i=i>g?1/Math.sqrt(i):0,l=0;l<3;++l)u[l]*=i;r[c]=u}return r}},{}],262:[function(v,w,y){w.exports=function(e,t,n,o,r,g,c,a,h,l){var s=t+g+l;if(p>0){var p=Math.sqrt(s+1);e[0]=.5*(c-h)/p,e[1]=.5*(a-o)/p,e[2]=.5*(n-g)/p,e[3]=.5*p}else{var u=Math.max(t,g,l);p=Math.sqrt(2*u-s+1),t>=u?(e[0]=.5*p,e[1]=.5*(r+n)/p,e[2]=.5*(a+o)/p,e[3]=.5*(c-h)/p):g>=u?(e[0]=.5*(n+r)/p,e[1]=.5*p,e[2]=.5*(h+c)/p,e[3]=.5*(a-o)/p):(e[0]=.5*(o+a)/p,e[1]=.5*(c+h)/p,e[2]=.5*p,e[3]=.5*(n-r)/p)}return e}},{}],263:[function(v,w,y){w.exports=function(s){var p=(s=s||{}).center||[0,0,0],u=s.rotation||[0,0,0,1],i=s.radius||1;p=[].slice.call(p,0,3),a(u=[].slice.call(u,0,4),u);var x=new h(u,p,Math.log(i));return x.setDistanceLimits(s.zoomMin,s.zoomMax),("eye"in s||"up"in s)&&x.lookAt(0,s.eye,s.center,s.up),x};var e=v("filtered-vector"),t=v("gl-mat4/lookAt"),n=v("gl-mat4/fromQuat"),o=v("gl-mat4/invert"),r=v("./lib/quatFromFrame");function g(s,p,u){return Math.sqrt(Math.pow(s,2)+Math.pow(p,2)+Math.pow(u,2))}function c(s,p,u,i){return Math.sqrt(Math.pow(s,2)+Math.pow(p,2)+Math.pow(u,2)+Math.pow(i,2))}function a(s,p){var u=p[0],i=p[1],x=p[2],f=p[3],_=c(u,i,x,f);_>1e-6?(s[0]=u/_,s[1]=i/_,s[2]=x/_,s[3]=f/_):(s[0]=s[1]=s[2]=0,s[3]=1)}function h(s,p,u){this.radius=e([u]),this.center=e(p),this.rotation=e(s),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var l=h.prototype;l.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},l.recalcMatrix=function(s){this.radius.curve(s),this.center.curve(s),this.rotation.curve(s);var p=this.computedRotation;a(p,p);var u=this.computedMatrix;n(u,p);var i=this.computedCenter,x=this.computedEye,f=this.computedUp,_=Math.exp(this.computedRadius[0]);x[0]=i[0]+_*u[2],x[1]=i[1]+_*u[6],x[2]=i[2]+_*u[10],f[0]=u[1],f[1]=u[5],f[2]=u[9];for(var b=0;b<3;++b){for(var T=0,k=0;k<3;++k)T+=u[b+4*k]*x[k];u[12+b]=-T}},l.getMatrix=function(s,p){this.recalcMatrix(s);var u=this.computedMatrix;if(p){for(var i=0;i<16;++i)p[i]=u[i];return p}return u},l.idle=function(s){this.center.idle(s),this.radius.idle(s),this.rotation.idle(s)},l.flush=function(s){this.center.flush(s),this.radius.flush(s),this.rotation.flush(s)},l.pan=function(s,p,u,i){p=p||0,u=u||0,i=i||0,this.recalcMatrix(s);var x=this.computedMatrix,f=x[1],_=x[5],b=x[9],T=g(f,_,b);f/=T,_/=T,b/=T;var k=x[0],L=x[4],A=x[8],I=k*f+L*_+A*b,P=g(k-=f*I,L-=_*I,A-=b*I);k/=P,L/=P,A/=P,x[2],x[6],x[10];var S=k*p+f*u,E=L*p+_*u,z=A*p+b*u;this.center.move(s,S,E,z);var D=Math.exp(this.computedRadius[0]);D=Math.max(1e-4,D+i),this.radius.set(s,Math.log(D))},l.rotate=function(s,p,u,i){this.recalcMatrix(s),p=p||0,u=u||0;var x=this.computedMatrix,f=x[0],_=x[4],b=x[8],T=x[1],k=x[5],L=x[9],A=x[2],I=x[6],P=x[10],S=p*f+u*T,E=p*_+u*k,z=p*b+u*L,D=-(I*z-P*E),j=-(P*S-A*z),V=-(A*E-I*S),Z=Math.sqrt(Math.max(0,1-Math.pow(D,2)-Math.pow(j,2)-Math.pow(V,2))),Q=c(D,j,V,Z);Q>1e-6?(D/=Q,j/=Q,V/=Q,Z/=Q):(D=j=V=0,Z=1);var X=this.computedRotation,$=X[0],re=X[1],H=X[2],N=X[3],U=$*Z+N*D+re*V-H*j,te=re*Z+N*j+H*D-$*V,B=H*Z+N*V+$*j-re*D,K=N*Z-$*D-re*j-H*V;if(i){D=A,j=I,V=P;var J=Math.sin(i)/g(D,j,V);D*=J,j*=J,V*=J,K=K*(Z=Math.cos(p))-(U=U*Z+K*D+te*V-B*j)*D-(te=te*Z+K*j+B*D-U*V)*j-(B=B*Z+K*V+U*j-te*D)*V}var ee=c(U,te,B,K);ee>1e-6?(U/=ee,te/=ee,B/=ee,K/=ee):(U=te=B=0,K=1),this.rotation.set(s,U,te,B,K)},l.lookAt=function(s,p,u,i){this.recalcMatrix(s),u=u||this.computedCenter,p=p||this.computedEye,i=i||this.computedUp;var x=this.computedMatrix;t(x,p,u,i);var f=this.computedRotation;r(f,x[0],x[1],x[2],x[4],x[5],x[6],x[8],x[9],x[10]),a(f,f),this.rotation.set(s,f[0],f[1],f[2],f[3]);for(var _=0,b=0;b<3;++b)_+=Math.pow(u[b]-p[b],2);this.radius.set(s,.5*Math.log(Math.max(_,1e-6))),this.center.set(s,u[0],u[1],u[2])},l.translate=function(s,p,u,i){this.center.move(s,p||0,u||0,i||0)},l.setMatrix=function(s,p){var u=this.computedRotation;r(u,p[0],p[1],p[2],p[4],p[5],p[6],p[8],p[9],p[10]),a(u,u),this.rotation.set(s,u[0],u[1],u[2],u[3]);var i=this.computedMatrix;o(i,p);var x=i[15];if(Math.abs(x)>1e-6){var f=i[12]/x,_=i[13]/x,b=i[14]/x;this.recalcMatrix(s);var T=Math.exp(this.computedRadius[0]);this.center.set(s,f-i[2]*T,_-i[6]*T,b-i[10]*T),this.radius.idle(s)}else this.center.idle(s),this.radius.idle(s)},l.setDistance=function(s,p){p>0&&this.radius.set(s,Math.log(p))},l.setDistanceLimits=function(s,p){s=s>0?Math.log(s):-1/0,p=p>0?Math.log(p):1/0,p=Math.max(p,s),this.radius.bounds[0][0]=s,this.radius.bounds[1][0]=p},l.getDistanceLimits=function(s){var p=this.radius.bounds;return s?(s[0]=Math.exp(p[0][0]),s[1]=Math.exp(p[1][0]),s):[Math.exp(p[0][0]),Math.exp(p[1][0])]},l.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},l.fromJSON=function(s){var p=this.lastT(),u=s.center;u&&this.center.set(p,u[0],u[1],u[2]);var i=s.rotation;i&&this.rotation.set(p,i[0],i[1],i[2],i[3]);var x=s.distance;x&&x>0&&this.radius.set(p,Math.log(x)),this.setDistanceLimits(s.zoomMin,s.zoomMax)}},{"./lib/quatFromFrame":262,"filtered-vector":68,"gl-mat4/fromQuat":95,"gl-mat4/invert":98,"gl-mat4/lookAt":99}],264:[function(v,w,y){var e=v("repeat-string");w.exports=function(t,n,o){return e(o=o!==void 0?o+"":" ",n)+t}},{"repeat-string":277}],265:[function(v,w,y){w.exports=function(e,t){t||(t=[0,""]),e=String(e);var n=parseFloat(e,10);return t[0]=n,t[1]=e.match(/[\d.\-\+]*\s*(.*)/)[1]||"",t}},{}],266:[function(v,w,y){w.exports=function(t,n){for(var o=0|n.length,r=t.length,g=[new Array(o),new Array(o)],c=0;c<o;++c)g[0][c]=[],g[1][c]=[];for(c=0;c<r;++c){var a=t[c];g[0][a[0]].push(a),g[1][a[1]].push(a)}var h=[];for(c=0;c<o;++c)g[0][c].length+g[1][c].length===0&&h.push([c]);function l(_,b){var T=g[b][_[b]];T.splice(T.indexOf(_),1)}function s(_,b,T){for(var k,L,A,I=0;I<2;++I)if(g[I][b].length>0){k=g[I][b][0],A=I;break}L=k[1^A];for(var P=0;P<2;++P)for(var S=g[P][b],E=0;E<S.length;++E){var z=S[E],D=z[1^P];e(n[_],n[b],n[L],n[D])>0&&(k=z,L=D,A=P)}return T||k&&l(k,A),L}function p(_,b){var T=g[b][_][0],k=[_];l(T,b);for(var L=T[1^b];;){for(;L!==_;)k.push(L),L=s(k[k.length-2],L,!1);if(g[0][_].length+g[1][_].length===0)break;var A=k[k.length-1],I=_,P=k[1],S=s(A,I,!0);if(e(n[A],n[I],n[P],n[S])<0)break;k.push(_),L=s(A,I)}return k}function u(_,b){return b[1]===b[b.length-1]}for(c=0;c<o;++c)for(var i=0;i<2;++i){for(var x=[];g[i][c].length>0;){g[0][c].length;var f=p(c,i);u(0,f)?x.push.apply(x,f):(x.length>0&&h.push(x),x=f)}x.length>0&&h.push(x)}return h};var e=v("compare-angle")},{"compare-angle":54}],267:[function(v,w,y){w.exports=function(t,n){for(var o=e(t,n.length),r=new Array(n.length),g=new Array(n.length),c=[],a=0;a<n.length;++a){var h=o[a].length;g[a]=h,r[a]=!0,h<=1&&c.push(a)}for(;c.length>0;){var l=c.pop();r[l]=!1;var s=o[l];for(a=0;a<s.length;++a){var p=s[a];--g[p]==0&&c.push(p)}}var u=new Array(n.length),i=[];for(a=0;a<n.length;++a)r[a]?(l=i.length,u[a]=l,i.push(n[a])):u[a]=-1;var x=[];for(a=0;a<t.length;++a){var f=t[a];r[f[0]]&&r[f[1]]&&x.push([u[f[0]],u[f[1]]])}return[x,i]};var e=v("edges-to-adjacency-list")},{"edges-to-adjacency-list":66}],268:[function(v,w,y){w.exports=function(h,l){var s=c(h,l);h=s[0];for(var p=(l=s[1]).length,u=(h.length,e(h,l.length)),i=0;i<p;++i)if(u[i].length%2==1)throw new Error("planar-graph-to-polyline: graph must be manifold");var x=t(h,l),f=(x=x.filter(function(oe){for(var me=oe.length,ce=[0],ye=0;ye<me;++ye){var Se=l[oe[ye]],fe=l[oe[(ye+1)%me]],ge=o(-Se[0],Se[1]),Te=o(-Se[0],fe[1]),le=o(fe[0],Se[1]),ve=o(fe[0],fe[1]);ce=r(ce,r(r(ge,Te),r(le,ve)))}return ce[ce.length-1]>0})).length,_=new Array(f),b=new Array(f);for(i=0;i<f;++i){_[i]=i;var T=new Array(f),k=x[i].map(function(oe){return l[oe]}),L=n([k]),A=0;e:for(var I=0;I<f;++I)if(T[I]=0,i!==I){for(var P=(ne=x[I]).length,S=0;S<P;++S){var E=L(l[ne[S]]);if(E!==0){E<0&&(T[I]=1,A+=1);continue e}}T[I]=1,A+=1}b[i]=[A,i,T]}for(b.sort(function(oe,me){return me[0]-oe[0]}),i=0;i<f;++i){var z=(T=b[i])[1],D=T[2];for(I=0;I<f;++I)D[I]&&(_[I]=z)}var j=function(oe){for(var me=new Array(oe),ce=0;ce<oe;++ce)me[ce]=[];return me}(f);for(i=0;i<f;++i)j[i].push(_[i]),j[_[i]].push(i);var V={},Z=a(p,!1);for(i=0;i<f;++i)for(P=(ne=x[i]).length,I=0;I<P;++I){var Q=ne[I],X=ne[(I+1)%P],$=Math.min(Q,X)+":"+Math.max(Q,X);if($ in V){var re=V[$];j[re].push(i),j[i].push(re),Z[Q]=Z[X]=!0}else V[$]=i}function H(oe){for(var me=oe.length,ce=0;ce<me;++ce)if(!Z[oe[ce]])return!1;return!0}var N=[],U=a(f,-1);for(i=0;i<f;++i)_[i]!==i||H(x[i])?U[i]=-1:(N.push(i),U[i]=0);for(s=[];N.length>0;){var te=N.pop(),B=j[te];g(B,function(oe,me){return oe-me});var K,J=B.length,ee=U[te];if(ee===0){var ne=x[te];K=[ne]}for(i=0;i<J;++i){var se=B[i];U[se]>=0||(U[se]=1^ee,N.push(se),ee===0&&(H(ne=x[se])||(ne.reverse(),K.push(ne))))}ee===0&&s.push(K)}return s};var e=v("edges-to-adjacency-list"),t=v("planar-dual"),n=v("point-in-big-polygon"),o=v("two-product"),r=v("robust-sum"),g=v("uniq"),c=v("./lib/trim-leaves");function a(h,l){for(var s=new Array(h),p=0;p<h;++p)s[p]=l;return s}},{"./lib/trim-leaves":267,"edges-to-adjacency-list":66,"planar-dual":266,"point-in-big-polygon":269,"robust-sum":289,"two-product":306,uniq:310}],269:[function(v,w,y){w.exports=function(a){for(var h=a.length,l=[],s=[],p=0;p<h;++p)for(var u=a[p],i=u.length,x=i-1,f=0;f<i;x=f++){var _=u[x],b=u[f];_[0]===b[0]?s.push([_,b]):l.push([_,b])}if(l.length===0)return s.length===0?c:(T=g(s),function(A){return T(A[0],A[1])?0:1});var T,k=t(l),L=function(A,I){return function(P){var S=o.le(I,P[0]);if(S<0)return 1;var E=A[S];if(!E){if(!(S>0&&I[S]===P[0]))return 1;E=A[S-1]}for(var z=1;E;){var D=E.key,j=e(P,D[0],D[1]);if(D[0][0]<D[1][0])if(j<0)E=E.left;else{if(!(j>0))return 0;z=-1,E=E.right}else if(j>0)E=E.left;else{if(!(j<0))return 0;z=1,E=E.right}}return z}}(k.slabs,k.coordinates);return s.length===0?L:function(A,I){return function(P){return A(P[0],P[1])?0:I(P)}}(g(s),L)};var e=v("robust-orientation")[3],t=v("slab-decomposition"),n=v("interval-tree-1d"),o=v("binary-search-bounds");function r(){return!0}function g(a){for(var h={},l=0;l<a.length;++l){var s=a[l],p=s[0][0],u=s[0][1],i=s[1][1],x=[Math.min(u,i),Math.max(u,i)];p in h?h[p].push(x):h[p]=[x]}var f={},_=Object.keys(h);for(l=0;l<_.length;++l){var b=h[_[l]];f[_[l]]=n(b)}return function(T){return function(k,L){var A=T[k];return!!A&&!!A.queryPoint(L,r)}}(f)}function c(a){return 1}},{"binary-search-bounds":31,"interval-tree-1d":234,"robust-orientation":284,"slab-decomposition":299}],270:[function(v,w,y){var e=new Float64Array(4),t=new Float64Array(4),n=new Float64Array(4);w.exports=function(o,r,g,c,a){e.length<c.length&&(e=new Float64Array(c.length),t=new Float64Array(c.length),n=new Float64Array(c.length));for(var h=0;h<c.length;++h)e[h]=o[h]-c[h],t[h]=r[h]-o[h],n[h]=g[h]-o[h];var l=0,s=0,p=0,u=0,i=0,x=0;for(h=0;h<c.length;++h){var f=t[h],_=n[h],b=e[h];l+=f*f,s+=f*_,p+=_*_,u+=b*f,i+=b*_,x+=b*b}var T,k,L,A,I,P=Math.abs(l*p-s*s),S=s*i-p*u,E=s*u-l*i;if(S+E<=P)if(S<0)E<0&&u<0?(E=0,-u>=l?(S=1,T=l+2*u+x):T=u*(S=-u/l)+x):(S=0,i>=0?(E=0,T=x):-i>=p?(E=1,T=p+2*i+x):T=i*(E=-i/p)+x);else if(E<0)E=0,u>=0?(S=0,T=x):-u>=l?(S=1,T=l+2*u+x):T=u*(S=-u/l)+x;else{var z=1/P;T=(S*=z)*(l*S+s*(E*=z)+2*u)+E*(s*S+p*E+2*i)+x}else S<0?(L=p+i)>(k=s+u)?(A=L-k)>=(I=l-2*s+p)?(S=1,E=0,T=l+2*u+x):T=(S=A/I)*(l*S+s*(E=1-S)+2*u)+E*(s*S+p*E+2*i)+x:(S=0,L<=0?(E=1,T=p+2*i+x):i>=0?(E=0,T=x):T=i*(E=-i/p)+x):E<0?(L=l+u)>(k=s+i)?(A=L-k)>=(I=l-2*s+p)?(E=1,S=0,T=p+2*i+x):T=(S=1-(E=A/I))*(l*S+s*E+2*u)+E*(s*S+p*E+2*i)+x:(E=0,L<=0?(S=1,T=l+2*u+x):u>=0?(S=0,T=x):T=u*(S=-u/l)+x):(A=p+i-s-u)<=0?(S=0,E=1,T=p+2*i+x):A>=(I=l-2*s+p)?(S=1,E=0,T=l+2*u+x):T=(S=A/I)*(l*S+s*(E=1-S)+2*u)+E*(s*S+p*E+2*i)+x;var D=1-S-E;for(h=0;h<c.length;++h)a[h]=D*o[h]+S*r[h]+E*g[h];return T<0?0:T}},{}],271:[function(v,w,y){w.exports=v("gl-quat/slerp")},{"gl-quat/slerp":124}],272:[function(v,w,y){var e=v("big-rat/add");w.exports=function(t,n){for(var o=t.length,r=new Array(o),g=0;g<o;++g)r[g]=e(t[g],n[g]);return r}},{"big-rat/add":15}],273:[function(v,w,y){w.exports=function(t){for(var n=new Array(t.length),o=0;o<t.length;++o)n[o]=e(t[o]);return n};var e=v("big-rat")},{"big-rat":18}],274:[function(v,w,y){var e=v("big-rat"),t=v("big-rat/mul");w.exports=function(n,o){for(var r=e(o),g=n.length,c=new Array(g),a=0;a<g;++a)c[a]=t(n[a],r);return c}},{"big-rat":18,"big-rat/mul":27}],275:[function(v,w,y){var e=v("big-rat/sub");w.exports=function(t,n){for(var o=t.length,r=new Array(o),g=0;g<o;++g)r[g]=e(t[g],n[g]);return r}},{"big-rat/sub":29}],276:[function(v,w,y){var e=v("compare-cell"),t=v("compare-oriented-cell"),n=v("cell-orientation");w.exports=function(o){o.sort(t);for(var r=o.length,g=0,c=0;c<r;++c){var a=o[c],h=n(a);if(h!==0){if(g>0){var l=o[g-1];if(e(a,l)===0&&n(l)!==h){g-=1;continue}}o[g++]=a}}return o.length=g,o}},{"cell-orientation":47,"compare-cell":56,"compare-oriented-cell":57}],277:[function(v,w,y){var e,t="";w.exports=function(n,o){if(typeof n!="string")throw new TypeError("expected a string");if(o===1)return n;if(o===2)return n+n;var r=n.length*o;if(e!==n||e===void 0)e=n,t="";else if(t.length>=r)return t.substr(0,r);for(;r>t.length&&o>1;)1&o&&(t+=n),o>>=1,n+=n;return t=(t+=n).substr(0,r)}},{}],278:[function(v,w,y){(function(e){(function(){w.exports=e.performance&&e.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this)}).call(this,d!==void 0?d:typeof self<"u"?self:typeof window<"u"?window:{})},{}],279:[function(v,w,y){w.exports=function(e){for(var t=e.length,n=e[e.length-1],o=t,r=t-2;r>=0;--r){var g=n,c=e[r];(h=c-((n=g+c)-g))&&(e[--o]=n,n=h)}var a=0;for(r=o;r<t;++r){var h;g=e[r],(h=(c=n)-((n=g+c)-g))&&(e[a++]=h)}return e[a++]=n,e.length=a,e}},{}],280:[function(v,w,y){var e=v("two-product"),t=v("robust-sum"),n=v("robust-scale"),o=v("robust-compress");function r(p,u,i,x){return function(f){return x(p(i(f[0][0],f[1][1]),i(-f[0][1],f[1][0])))}}function g(p,u,i,x){return function(f){return x(p(u(p(i(f[1][1],f[2][2]),i(-f[1][2],f[2][1])),f[0][0]),p(u(p(i(f[1][0],f[2][2]),i(-f[1][2],f[2][0])),-f[0][1]),u(p(i(f[1][0],f[2][1]),i(-f[1][1],f[2][0])),f[0][2]))))}}function c(p,u,i,x){return function(f){return x(p(p(u(p(u(p(i(f[2][2],f[3][3]),i(-f[2][3],f[3][2])),f[1][1]),p(u(p(i(f[2][1],f[3][3]),i(-f[2][3],f[3][1])),-f[1][2]),u(p(i(f[2][1],f[3][2]),i(-f[2][2],f[3][1])),f[1][3]))),f[0][0]),u(p(u(p(i(f[2][2],f[3][3]),i(-f[2][3],f[3][2])),f[1][0]),p(u(p(i(f[2][0],f[3][3]),i(-f[2][3],f[3][0])),-f[1][2]),u(p(i(f[2][0],f[3][2]),i(-f[2][2],f[3][0])),f[1][3]))),-f[0][1])),p(u(p(u(p(i(f[2][1],f[3][3]),i(-f[2][3],f[3][1])),f[1][0]),p(u(p(i(f[2][0],f[3][3]),i(-f[2][3],f[3][0])),-f[1][1]),u(p(i(f[2][0],f[3][1]),i(-f[2][1],f[3][0])),f[1][3]))),f[0][2]),u(p(u(p(i(f[2][1],f[3][2]),i(-f[2][2],f[3][1])),f[1][0]),p(u(p(i(f[2][0],f[3][2]),i(-f[2][2],f[3][0])),-f[1][1]),u(p(i(f[2][0],f[3][1]),i(-f[2][1],f[3][0])),f[1][2]))),-f[0][3]))))}}function a(p,u,i,x){return function(f){return x(p(p(u(p(p(u(p(u(p(i(f[3][3],f[4][4]),i(-f[3][4],f[4][3])),f[2][2]),p(u(p(i(f[3][2],f[4][4]),i(-f[3][4],f[4][2])),-f[2][3]),u(p(i(f[3][2],f[4][3]),i(-f[3][3],f[4][2])),f[2][4]))),f[1][1]),u(p(u(p(i(f[3][3],f[4][4]),i(-f[3][4],f[4][3])),f[2][1]),p(u(p(i(f[3][1],f[4][4]),i(-f[3][4],f[4][1])),-f[2][3]),u(p(i(f[3][1],f[4][3]),i(-f[3][3],f[4][1])),f[2][4]))),-f[1][2])),p(u(p(u(p(i(f[3][2],f[4][4]),i(-f[3][4],f[4][2])),f[2][1]),p(u(p(i(f[3][1],f[4][4]),i(-f[3][4],f[4][1])),-f[2][2]),u(p(i(f[3][1],f[4][2]),i(-f[3][2],f[4][1])),f[2][4]))),f[1][3]),u(p(u(p(i(f[3][2],f[4][3]),i(-f[3][3],f[4][2])),f[2][1]),p(u(p(i(f[3][1],f[4][3]),i(-f[3][3],f[4][1])),-f[2][2]),u(p(i(f[3][1],f[4][2]),i(-f[3][2],f[4][1])),f[2][3]))),-f[1][4]))),f[0][0]),u(p(p(u(p(u(p(i(f[3][3],f[4][4]),i(-f[3][4],f[4][3])),f[2][2]),p(u(p(i(f[3][2],f[4][4]),i(-f[3][4],f[4][2])),-f[2][3]),u(p(i(f[3][2],f[4][3]),i(-f[3][3],f[4][2])),f[2][4]))),f[1][0]),u(p(u(p(i(f[3][3],f[4][4]),i(-f[3][4],f[4][3])),f[2][0]),p(u(p(i(f[3][0],f[4][4]),i(-f[3][4],f[4][0])),-f[2][3]),u(p(i(f[3][0],f[4][3]),i(-f[3][3],f[4][0])),f[2][4]))),-f[1][2])),p(u(p(u(p(i(f[3][2],f[4][4]),i(-f[3][4],f[4][2])),f[2][0]),p(u(p(i(f[3][0],f[4][4]),i(-f[3][4],f[4][0])),-f[2][2]),u(p(i(f[3][0],f[4][2]),i(-f[3][2],f[4][0])),f[2][4]))),f[1][3]),u(p(u(p(i(f[3][2],f[4][3]),i(-f[3][3],f[4][2])),f[2][0]),p(u(p(i(f[3][0],f[4][3]),i(-f[3][3],f[4][0])),-f[2][2]),u(p(i(f[3][0],f[4][2]),i(-f[3][2],f[4][0])),f[2][3]))),-f[1][4]))),-f[0][1])),p(u(p(p(u(p(u(p(i(f[3][3],f[4][4]),i(-f[3][4],f[4][3])),f[2][1]),p(u(p(i(f[3][1],f[4][4]),i(-f[3][4],f[4][1])),-f[2][3]),u(p(i(f[3][1],f[4][3]),i(-f[3][3],f[4][1])),f[2][4]))),f[1][0]),u(p(u(p(i(f[3][3],f[4][4]),i(-f[3][4],f[4][3])),f[2][0]),p(u(p(i(f[3][0],f[4][4]),i(-f[3][4],f[4][0])),-f[2][3]),u(p(i(f[3][0],f[4][3]),i(-f[3][3],f[4][0])),f[2][4]))),-f[1][1])),p(u(p(u(p(i(f[3][1],f[4][4]),i(-f[3][4],f[4][1])),f[2][0]),p(u(p(i(f[3][0],f[4][4]),i(-f[3][4],f[4][0])),-f[2][1]),u(p(i(f[3][0],f[4][1]),i(-f[3][1],f[4][0])),f[2][4]))),f[1][3]),u(p(u(p(i(f[3][1],f[4][3]),i(-f[3][3],f[4][1])),f[2][0]),p(u(p(i(f[3][0],f[4][3]),i(-f[3][3],f[4][0])),-f[2][1]),u(p(i(f[3][0],f[4][1]),i(-f[3][1],f[4][0])),f[2][3]))),-f[1][4]))),f[0][2]),p(u(p(p(u(p(u(p(i(f[3][2],f[4][4]),i(-f[3][4],f[4][2])),f[2][1]),p(u(p(i(f[3][1],f[4][4]),i(-f[3][4],f[4][1])),-f[2][2]),u(p(i(f[3][1],f[4][2]),i(-f[3][2],f[4][1])),f[2][4]))),f[1][0]),u(p(u(p(i(f[3][2],f[4][4]),i(-f[3][4],f[4][2])),f[2][0]),p(u(p(i(f[3][0],f[4][4]),i(-f[3][4],f[4][0])),-f[2][2]),u(p(i(f[3][0],f[4][2]),i(-f[3][2],f[4][0])),f[2][4]))),-f[1][1])),p(u(p(u(p(i(f[3][1],f[4][4]),i(-f[3][4],f[4][1])),f[2][0]),p(u(p(i(f[3][0],f[4][4]),i(-f[3][4],f[4][0])),-f[2][1]),u(p(i(f[3][0],f[4][1]),i(-f[3][1],f[4][0])),f[2][4]))),f[1][2]),u(p(u(p(i(f[3][1],f[4][2]),i(-f[3][2],f[4][1])),f[2][0]),p(u(p(i(f[3][0],f[4][2]),i(-f[3][2],f[4][0])),-f[2][1]),u(p(i(f[3][0],f[4][1]),i(-f[3][1],f[4][0])),f[2][2]))),-f[1][4]))),-f[0][3]),u(p(p(u(p(u(p(i(f[3][2],f[4][3]),i(-f[3][3],f[4][2])),f[2][1]),p(u(p(i(f[3][1],f[4][3]),i(-f[3][3],f[4][1])),-f[2][2]),u(p(i(f[3][1],f[4][2]),i(-f[3][2],f[4][1])),f[2][3]))),f[1][0]),u(p(u(p(i(f[3][2],f[4][3]),i(-f[3][3],f[4][2])),f[2][0]),p(u(p(i(f[3][0],f[4][3]),i(-f[3][3],f[4][0])),-f[2][2]),u(p(i(f[3][0],f[4][2]),i(-f[3][2],f[4][0])),f[2][3]))),-f[1][1])),p(u(p(u(p(i(f[3][1],f[4][3]),i(-f[3][3],f[4][1])),f[2][0]),p(u(p(i(f[3][0],f[4][3]),i(-f[3][3],f[4][0])),-f[2][1]),u(p(i(f[3][0],f[4][1]),i(-f[3][1],f[4][0])),f[2][3]))),f[1][2]),u(p(u(p(i(f[3][1],f[4][2]),i(-f[3][2],f[4][1])),f[2][0]),p(u(p(i(f[3][0],f[4][2]),i(-f[3][2],f[4][0])),-f[2][1]),u(p(i(f[3][0],f[4][1]),i(-f[3][1],f[4][0])),f[2][2]))),-f[1][3]))),f[0][4])))))}}function h(p){return(p===2?r:p===3?g:p===4?c:p===5?a:void 0)(t,n,e,o)}var l=[function(){return[0]},function(p){return[p[0][0]]}];function s(p,u,i,x,f,_,b,T){return function(k){switch(k.length){case 0:return p(k);case 1:return u(k);case 2:return i(k);case 3:return x(k);case 4:return f(k);case 5:return _(k)}var L=b[k.length];return L||(L=b[k.length]=T(k.length)),L(k)}}(function(){for(;l.length<6;)l.push(h(l.length));w.exports=s.apply(void 0,l.concat([l,h]));for(var p=0;p<l.length;++p)w.exports[p]=l[p]})()},{"robust-compress":279,"robust-scale":286,"robust-sum":289,"two-product":306}],281:[function(v,w,y){var e=v("two-product"),t=v("robust-sum");w.exports=function(n,o){for(var r=e(n[0],o[0]),g=1;g<n.length;++g)r=t(r,e(n[g],o[g]));return r}},{"robust-sum":289,"two-product":306}],282:[function(v,w,y){var e=v("two-product"),t=v("robust-sum"),n=v("robust-subtract"),o=v("robust-scale");function r(u){return(u===3?g:u===4?c:u===5?a:h)(t,n,e,o)}function g(u,i,x,f){return function(_,b,T){var k=x(_[0],_[0]),L=f(k,b[0]),A=f(k,T[0]),I=x(b[0],b[0]),P=f(I,_[0]),S=f(I,T[0]),E=x(T[0],T[0]),z=f(E,_[0]),D=f(E,b[0]),j=u(i(D,S),i(P,L)),V=i(z,A),Z=i(j,V);return Z[Z.length-1]}}function c(u,i,x,f){return function(_,b,T,k){var L=u(x(_[0],_[0]),x(_[1],_[1])),A=f(L,b[0]),I=f(L,T[0]),P=f(L,k[0]),S=u(x(b[0],b[0]),x(b[1],b[1])),E=f(S,_[0]),z=f(S,T[0]),D=f(S,k[0]),j=u(x(T[0],T[0]),x(T[1],T[1])),V=f(j,_[0]),Z=f(j,b[0]),Q=f(j,k[0]),X=u(x(k[0],k[0]),x(k[1],k[1])),$=f(X,_[0]),re=f(X,b[0]),H=f(X,T[0]),N=u(u(f(i(H,Q),b[1]),u(f(i(re,D),-T[1]),f(i(Z,z),k[1]))),u(f(i(re,D),_[1]),u(f(i($,P),-b[1]),f(i(E,A),k[1])))),U=u(u(f(i(H,Q),_[1]),u(f(i($,P),-T[1]),f(i(V,I),k[1]))),u(f(i(Z,z),_[1]),u(f(i(V,I),-b[1]),f(i(E,A),T[1])))),te=i(N,U);return te[te.length-1]}}function a(u,i,x,f){return function(_,b,T,k,L){var A=u(x(_[0],_[0]),u(x(_[1],_[1]),x(_[2],_[2]))),I=f(A,b[0]),P=f(A,T[0]),S=f(A,k[0]),E=f(A,L[0]),z=u(x(b[0],b[0]),u(x(b[1],b[1]),x(b[2],b[2]))),D=f(z,_[0]),j=f(z,T[0]),V=f(z,k[0]),Z=f(z,L[0]),Q=u(x(T[0],T[0]),u(x(T[1],T[1]),x(T[2],T[2]))),X=f(Q,_[0]),$=f(Q,b[0]),re=f(Q,k[0]),H=f(Q,L[0]),N=u(x(k[0],k[0]),u(x(k[1],k[1]),x(k[2],k[2]))),U=f(N,_[0]),te=f(N,b[0]),B=f(N,T[0]),K=f(N,L[0]),J=u(x(L[0],L[0]),u(x(L[1],L[1]),x(L[2],L[2]))),ee=f(J,_[0]),ne=f(J,b[0]),se=f(J,T[0]),oe=f(J,k[0]),me=u(u(u(f(u(f(i(oe,K),T[1]),u(f(i(se,H),-k[1]),f(i(B,re),L[1]))),b[2]),u(f(u(f(i(oe,K),b[1]),u(f(i(ne,Z),-k[1]),f(i(te,V),L[1]))),-T[2]),f(u(f(i(se,H),b[1]),u(f(i(ne,Z),-T[1]),f(i($,j),L[1]))),k[2]))),u(f(u(f(i(B,re),b[1]),u(f(i(te,V),-T[1]),f(i($,j),k[1]))),-L[2]),u(f(u(f(i(oe,K),b[1]),u(f(i(ne,Z),-k[1]),f(i(te,V),L[1]))),_[2]),f(u(f(i(oe,K),_[1]),u(f(i(ee,E),-k[1]),f(i(U,S),L[1]))),-b[2])))),u(u(f(u(f(i(ne,Z),_[1]),u(f(i(ee,E),-b[1]),f(i(D,I),L[1]))),k[2]),u(f(u(f(i(te,V),_[1]),u(f(i(U,S),-b[1]),f(i(D,I),k[1]))),-L[2]),f(u(f(i(B,re),b[1]),u(f(i(te,V),-T[1]),f(i($,j),k[1]))),_[2]))),u(f(u(f(i(B,re),_[1]),u(f(i(U,S),-T[1]),f(i(X,P),k[1]))),-b[2]),u(f(u(f(i(te,V),_[1]),u(f(i(U,S),-b[1]),f(i(D,I),k[1]))),T[2]),f(u(f(i($,j),_[1]),u(f(i(X,P),-b[1]),f(i(D,I),T[1]))),-k[2]))))),ce=u(u(u(f(u(f(i(oe,K),T[1]),u(f(i(se,H),-k[1]),f(i(B,re),L[1]))),_[2]),f(u(f(i(oe,K),_[1]),u(f(i(ee,E),-k[1]),f(i(U,S),L[1]))),-T[2])),u(f(u(f(i(se,H),_[1]),u(f(i(ee,E),-T[1]),f(i(X,P),L[1]))),k[2]),f(u(f(i(B,re),_[1]),u(f(i(U,S),-T[1]),f(i(X,P),k[1]))),-L[2]))),u(u(f(u(f(i(se,H),b[1]),u(f(i(ne,Z),-T[1]),f(i($,j),L[1]))),_[2]),f(u(f(i(se,H),_[1]),u(f(i(ee,E),-T[1]),f(i(X,P),L[1]))),-b[2])),u(f(u(f(i(ne,Z),_[1]),u(f(i(ee,E),-b[1]),f(i(D,I),L[1]))),T[2]),f(u(f(i($,j),_[1]),u(f(i(X,P),-b[1]),f(i(D,I),T[1]))),-L[2])))),ye=i(me,ce);return ye[ye.length-1]}}function h(u,i,x,f){return function(_,b,T,k,L,A){var I=u(u(x(_[0],_[0]),x(_[1],_[1])),u(x(_[2],_[2]),x(_[3],_[3]))),P=f(I,b[0]),S=f(I,T[0]),E=f(I,k[0]),z=f(I,L[0]),D=f(I,A[0]),j=u(u(x(b[0],b[0]),x(b[1],b[1])),u(x(b[2],b[2]),x(b[3],b[3]))),V=f(j,_[0]),Z=f(j,T[0]),Q=f(j,k[0]),X=f(j,L[0]),$=f(j,A[0]),re=u(u(x(T[0],T[0]),x(T[1],T[1])),u(x(T[2],T[2]),x(T[3],T[3]))),H=f(re,_[0]),N=f(re,b[0]),U=f(re,k[0]),te=f(re,L[0]),B=f(re,A[0]),K=u(u(x(k[0],k[0]),x(k[1],k[1])),u(x(k[2],k[2]),x(k[3],k[3]))),J=f(K,_[0]),ee=f(K,b[0]),ne=f(K,T[0]),se=f(K,L[0]),oe=f(K,A[0]),me=u(u(x(L[0],L[0]),x(L[1],L[1])),u(x(L[2],L[2]),x(L[3],L[3]))),ce=f(me,_[0]),ye=f(me,b[0]),Se=f(me,T[0]),fe=f(me,k[0]),ge=f(me,A[0]),Te=u(u(x(A[0],A[0]),x(A[1],A[1])),u(x(A[2],A[2]),x(A[3],A[3]))),le=f(Te,_[0]),ve=f(Te,b[0]),Me=f(Te,T[0]),we=f(Te,k[0]),de=f(Te,L[0]),Ie=u(u(u(f(u(u(f(u(f(i(de,ge),k[1]),u(f(i(we,oe),-L[1]),f(i(fe,se),A[1]))),T[2]),f(u(f(i(de,ge),T[1]),u(f(i(Me,B),-L[1]),f(i(Se,te),A[1]))),-k[2])),u(f(u(f(i(we,oe),T[1]),u(f(i(Me,B),-k[1]),f(i(ne,U),A[1]))),L[2]),f(u(f(i(fe,se),T[1]),u(f(i(Se,te),-k[1]),f(i(ne,U),L[1]))),-A[2]))),b[3]),u(f(u(u(f(u(f(i(de,ge),k[1]),u(f(i(we,oe),-L[1]),f(i(fe,se),A[1]))),b[2]),f(u(f(i(de,ge),b[1]),u(f(i(ve,$),-L[1]),f(i(ye,X),A[1]))),-k[2])),u(f(u(f(i(we,oe),b[1]),u(f(i(ve,$),-k[1]),f(i(ee,Q),A[1]))),L[2]),f(u(f(i(fe,se),b[1]),u(f(i(ye,X),-k[1]),f(i(ee,Q),L[1]))),-A[2]))),-T[3]),f(u(u(f(u(f(i(de,ge),T[1]),u(f(i(Me,B),-L[1]),f(i(Se,te),A[1]))),b[2]),f(u(f(i(de,ge),b[1]),u(f(i(ve,$),-L[1]),f(i(ye,X),A[1]))),-T[2])),u(f(u(f(i(Me,B),b[1]),u(f(i(ve,$),-T[1]),f(i(N,Z),A[1]))),L[2]),f(u(f(i(Se,te),b[1]),u(f(i(ye,X),-T[1]),f(i(N,Z),L[1]))),-A[2]))),k[3]))),u(u(f(u(u(f(u(f(i(we,oe),T[1]),u(f(i(Me,B),-k[1]),f(i(ne,U),A[1]))),b[2]),f(u(f(i(we,oe),b[1]),u(f(i(ve,$),-k[1]),f(i(ee,Q),A[1]))),-T[2])),u(f(u(f(i(Me,B),b[1]),u(f(i(ve,$),-T[1]),f(i(N,Z),A[1]))),k[2]),f(u(f(i(ne,U),b[1]),u(f(i(ee,Q),-T[1]),f(i(N,Z),k[1]))),-A[2]))),-L[3]),f(u(u(f(u(f(i(fe,se),T[1]),u(f(i(Se,te),-k[1]),f(i(ne,U),L[1]))),b[2]),f(u(f(i(fe,se),b[1]),u(f(i(ye,X),-k[1]),f(i(ee,Q),L[1]))),-T[2])),u(f(u(f(i(Se,te),b[1]),u(f(i(ye,X),-T[1]),f(i(N,Z),L[1]))),k[2]),f(u(f(i(ne,U),b[1]),u(f(i(ee,Q),-T[1]),f(i(N,Z),k[1]))),-L[2]))),A[3])),u(f(u(u(f(u(f(i(de,ge),k[1]),u(f(i(we,oe),-L[1]),f(i(fe,se),A[1]))),b[2]),f(u(f(i(de,ge),b[1]),u(f(i(ve,$),-L[1]),f(i(ye,X),A[1]))),-k[2])),u(f(u(f(i(we,oe),b[1]),u(f(i(ve,$),-k[1]),f(i(ee,Q),A[1]))),L[2]),f(u(f(i(fe,se),b[1]),u(f(i(ye,X),-k[1]),f(i(ee,Q),L[1]))),-A[2]))),_[3]),f(u(u(f(u(f(i(de,ge),k[1]),u(f(i(we,oe),-L[1]),f(i(fe,se),A[1]))),_[2]),f(u(f(i(de,ge),_[1]),u(f(i(le,D),-L[1]),f(i(ce,z),A[1]))),-k[2])),u(f(u(f(i(we,oe),_[1]),u(f(i(le,D),-k[1]),f(i(J,E),A[1]))),L[2]),f(u(f(i(fe,se),_[1]),u(f(i(ce,z),-k[1]),f(i(J,E),L[1]))),-A[2]))),-b[3])))),u(u(u(f(u(u(f(u(f(i(de,ge),b[1]),u(f(i(ve,$),-L[1]),f(i(ye,X),A[1]))),_[2]),f(u(f(i(de,ge),_[1]),u(f(i(le,D),-L[1]),f(i(ce,z),A[1]))),-b[2])),u(f(u(f(i(ve,$),_[1]),u(f(i(le,D),-b[1]),f(i(V,P),A[1]))),L[2]),f(u(f(i(ye,X),_[1]),u(f(i(ce,z),-b[1]),f(i(V,P),L[1]))),-A[2]))),k[3]),f(u(u(f(u(f(i(we,oe),b[1]),u(f(i(ve,$),-k[1]),f(i(ee,Q),A[1]))),_[2]),f(u(f(i(we,oe),_[1]),u(f(i(le,D),-k[1]),f(i(J,E),A[1]))),-b[2])),u(f(u(f(i(ve,$),_[1]),u(f(i(le,D),-b[1]),f(i(V,P),A[1]))),k[2]),f(u(f(i(ee,Q),_[1]),u(f(i(J,E),-b[1]),f(i(V,P),k[1]))),-A[2]))),-L[3])),u(f(u(u(f(u(f(i(fe,se),b[1]),u(f(i(ye,X),-k[1]),f(i(ee,Q),L[1]))),_[2]),f(u(f(i(fe,se),_[1]),u(f(i(ce,z),-k[1]),f(i(J,E),L[1]))),-b[2])),u(f(u(f(i(ye,X),_[1]),u(f(i(ce,z),-b[1]),f(i(V,P),L[1]))),k[2]),f(u(f(i(ee,Q),_[1]),u(f(i(J,E),-b[1]),f(i(V,P),k[1]))),-L[2]))),A[3]),f(u(u(f(u(f(i(we,oe),T[1]),u(f(i(Me,B),-k[1]),f(i(ne,U),A[1]))),b[2]),f(u(f(i(we,oe),b[1]),u(f(i(ve,$),-k[1]),f(i(ee,Q),A[1]))),-T[2])),u(f(u(f(i(Me,B),b[1]),u(f(i(ve,$),-T[1]),f(i(N,Z),A[1]))),k[2]),f(u(f(i(ne,U),b[1]),u(f(i(ee,Q),-T[1]),f(i(N,Z),k[1]))),-A[2]))),_[3]))),u(u(f(u(u(f(u(f(i(we,oe),T[1]),u(f(i(Me,B),-k[1]),f(i(ne,U),A[1]))),_[2]),f(u(f(i(we,oe),_[1]),u(f(i(le,D),-k[1]),f(i(J,E),A[1]))),-T[2])),u(f(u(f(i(Me,B),_[1]),u(f(i(le,D),-T[1]),f(i(H,S),A[1]))),k[2]),f(u(f(i(ne,U),_[1]),u(f(i(J,E),-T[1]),f(i(H,S),k[1]))),-A[2]))),-b[3]),f(u(u(f(u(f(i(we,oe),b[1]),u(f(i(ve,$),-k[1]),f(i(ee,Q),A[1]))),_[2]),f(u(f(i(we,oe),_[1]),u(f(i(le,D),-k[1]),f(i(J,E),A[1]))),-b[2])),u(f(u(f(i(ve,$),_[1]),u(f(i(le,D),-b[1]),f(i(V,P),A[1]))),k[2]),f(u(f(i(ee,Q),_[1]),u(f(i(J,E),-b[1]),f(i(V,P),k[1]))),-A[2]))),T[3])),u(f(u(u(f(u(f(i(Me,B),b[1]),u(f(i(ve,$),-T[1]),f(i(N,Z),A[1]))),_[2]),f(u(f(i(Me,B),_[1]),u(f(i(le,D),-T[1]),f(i(H,S),A[1]))),-b[2])),u(f(u(f(i(ve,$),_[1]),u(f(i(le,D),-b[1]),f(i(V,P),A[1]))),T[2]),f(u(f(i(N,Z),_[1]),u(f(i(H,S),-b[1]),f(i(V,P),T[1]))),-A[2]))),-k[3]),f(u(u(f(u(f(i(ne,U),b[1]),u(f(i(ee,Q),-T[1]),f(i(N,Z),k[1]))),_[2]),f(u(f(i(ne,U),_[1]),u(f(i(J,E),-T[1]),f(i(H,S),k[1]))),-b[2])),u(f(u(f(i(ee,Q),_[1]),u(f(i(J,E),-b[1]),f(i(V,P),k[1]))),T[2]),f(u(f(i(N,Z),_[1]),u(f(i(H,S),-b[1]),f(i(V,P),T[1]))),-k[2]))),A[3]))))),De=u(u(u(f(u(u(f(u(f(i(de,ge),k[1]),u(f(i(we,oe),-L[1]),f(i(fe,se),A[1]))),T[2]),f(u(f(i(de,ge),T[1]),u(f(i(Me,B),-L[1]),f(i(Se,te),A[1]))),-k[2])),u(f(u(f(i(we,oe),T[1]),u(f(i(Me,B),-k[1]),f(i(ne,U),A[1]))),L[2]),f(u(f(i(fe,se),T[1]),u(f(i(Se,te),-k[1]),f(i(ne,U),L[1]))),-A[2]))),_[3]),u(f(u(u(f(u(f(i(de,ge),k[1]),u(f(i(we,oe),-L[1]),f(i(fe,se),A[1]))),_[2]),f(u(f(i(de,ge),_[1]),u(f(i(le,D),-L[1]),f(i(ce,z),A[1]))),-k[2])),u(f(u(f(i(we,oe),_[1]),u(f(i(le,D),-k[1]),f(i(J,E),A[1]))),L[2]),f(u(f(i(fe,se),_[1]),u(f(i(ce,z),-k[1]),f(i(J,E),L[1]))),-A[2]))),-T[3]),f(u(u(f(u(f(i(de,ge),T[1]),u(f(i(Me,B),-L[1]),f(i(Se,te),A[1]))),_[2]),f(u(f(i(de,ge),_[1]),u(f(i(le,D),-L[1]),f(i(ce,z),A[1]))),-T[2])),u(f(u(f(i(Me,B),_[1]),u(f(i(le,D),-T[1]),f(i(H,S),A[1]))),L[2]),f(u(f(i(Se,te),_[1]),u(f(i(ce,z),-T[1]),f(i(H,S),L[1]))),-A[2]))),k[3]))),u(u(f(u(u(f(u(f(i(we,oe),T[1]),u(f(i(Me,B),-k[1]),f(i(ne,U),A[1]))),_[2]),f(u(f(i(we,oe),_[1]),u(f(i(le,D),-k[1]),f(i(J,E),A[1]))),-T[2])),u(f(u(f(i(Me,B),_[1]),u(f(i(le,D),-T[1]),f(i(H,S),A[1]))),k[2]),f(u(f(i(ne,U),_[1]),u(f(i(J,E),-T[1]),f(i(H,S),k[1]))),-A[2]))),-L[3]),f(u(u(f(u(f(i(fe,se),T[1]),u(f(i(Se,te),-k[1]),f(i(ne,U),L[1]))),_[2]),f(u(f(i(fe,se),_[1]),u(f(i(ce,z),-k[1]),f(i(J,E),L[1]))),-T[2])),u(f(u(f(i(Se,te),_[1]),u(f(i(ce,z),-T[1]),f(i(H,S),L[1]))),k[2]),f(u(f(i(ne,U),_[1]),u(f(i(J,E),-T[1]),f(i(H,S),k[1]))),-L[2]))),A[3])),u(f(u(u(f(u(f(i(de,ge),T[1]),u(f(i(Me,B),-L[1]),f(i(Se,te),A[1]))),b[2]),f(u(f(i(de,ge),b[1]),u(f(i(ve,$),-L[1]),f(i(ye,X),A[1]))),-T[2])),u(f(u(f(i(Me,B),b[1]),u(f(i(ve,$),-T[1]),f(i(N,Z),A[1]))),L[2]),f(u(f(i(Se,te),b[1]),u(f(i(ye,X),-T[1]),f(i(N,Z),L[1]))),-A[2]))),_[3]),f(u(u(f(u(f(i(de,ge),T[1]),u(f(i(Me,B),-L[1]),f(i(Se,te),A[1]))),_[2]),f(u(f(i(de,ge),_[1]),u(f(i(le,D),-L[1]),f(i(ce,z),A[1]))),-T[2])),u(f(u(f(i(Me,B),_[1]),u(f(i(le,D),-T[1]),f(i(H,S),A[1]))),L[2]),f(u(f(i(Se,te),_[1]),u(f(i(ce,z),-T[1]),f(i(H,S),L[1]))),-A[2]))),-b[3])))),u(u(u(f(u(u(f(u(f(i(de,ge),b[1]),u(f(i(ve,$),-L[1]),f(i(ye,X),A[1]))),_[2]),f(u(f(i(de,ge),_[1]),u(f(i(le,D),-L[1]),f(i(ce,z),A[1]))),-b[2])),u(f(u(f(i(ve,$),_[1]),u(f(i(le,D),-b[1]),f(i(V,P),A[1]))),L[2]),f(u(f(i(ye,X),_[1]),u(f(i(ce,z),-b[1]),f(i(V,P),L[1]))),-A[2]))),T[3]),f(u(u(f(u(f(i(Me,B),b[1]),u(f(i(ve,$),-T[1]),f(i(N,Z),A[1]))),_[2]),f(u(f(i(Me,B),_[1]),u(f(i(le,D),-T[1]),f(i(H,S),A[1]))),-b[2])),u(f(u(f(i(ve,$),_[1]),u(f(i(le,D),-b[1]),f(i(V,P),A[1]))),T[2]),f(u(f(i(N,Z),_[1]),u(f(i(H,S),-b[1]),f(i(V,P),T[1]))),-A[2]))),-L[3])),u(f(u(u(f(u(f(i(Se,te),b[1]),u(f(i(ye,X),-T[1]),f(i(N,Z),L[1]))),_[2]),f(u(f(i(Se,te),_[1]),u(f(i(ce,z),-T[1]),f(i(H,S),L[1]))),-b[2])),u(f(u(f(i(ye,X),_[1]),u(f(i(ce,z),-b[1]),f(i(V,P),L[1]))),T[2]),f(u(f(i(N,Z),_[1]),u(f(i(H,S),-b[1]),f(i(V,P),T[1]))),-L[2]))),A[3]),f(u(u(f(u(f(i(fe,se),T[1]),u(f(i(Se,te),-k[1]),f(i(ne,U),L[1]))),b[2]),f(u(f(i(fe,se),b[1]),u(f(i(ye,X),-k[1]),f(i(ee,Q),L[1]))),-T[2])),u(f(u(f(i(Se,te),b[1]),u(f(i(ye,X),-T[1]),f(i(N,Z),L[1]))),k[2]),f(u(f(i(ne,U),b[1]),u(f(i(ee,Q),-T[1]),f(i(N,Z),k[1]))),-L[2]))),_[3]))),u(u(f(u(u(f(u(f(i(fe,se),T[1]),u(f(i(Se,te),-k[1]),f(i(ne,U),L[1]))),_[2]),f(u(f(i(fe,se),_[1]),u(f(i(ce,z),-k[1]),f(i(J,E),L[1]))),-T[2])),u(f(u(f(i(Se,te),_[1]),u(f(i(ce,z),-T[1]),f(i(H,S),L[1]))),k[2]),f(u(f(i(ne,U),_[1]),u(f(i(J,E),-T[1]),f(i(H,S),k[1]))),-L[2]))),-b[3]),f(u(u(f(u(f(i(fe,se),b[1]),u(f(i(ye,X),-k[1]),f(i(ee,Q),L[1]))),_[2]),f(u(f(i(fe,se),_[1]),u(f(i(ce,z),-k[1]),f(i(J,E),L[1]))),-b[2])),u(f(u(f(i(ye,X),_[1]),u(f(i(ce,z),-b[1]),f(i(V,P),L[1]))),k[2]),f(u(f(i(ee,Q),_[1]),u(f(i(J,E),-b[1]),f(i(V,P),k[1]))),-L[2]))),T[3])),u(f(u(u(f(u(f(i(Se,te),b[1]),u(f(i(ye,X),-T[1]),f(i(N,Z),L[1]))),_[2]),f(u(f(i(Se,te),_[1]),u(f(i(ce,z),-T[1]),f(i(H,S),L[1]))),-b[2])),u(f(u(f(i(ye,X),_[1]),u(f(i(ce,z),-b[1]),f(i(V,P),L[1]))),T[2]),f(u(f(i(N,Z),_[1]),u(f(i(H,S),-b[1]),f(i(V,P),T[1]))),-L[2]))),-k[3]),f(u(u(f(u(f(i(ne,U),b[1]),u(f(i(ee,Q),-T[1]),f(i(N,Z),k[1]))),_[2]),f(u(f(i(ne,U),_[1]),u(f(i(J,E),-T[1]),f(i(H,S),k[1]))),-b[2])),u(f(u(f(i(ee,Q),_[1]),u(f(i(J,E),-b[1]),f(i(V,P),k[1]))),T[2]),f(u(f(i(N,Z),_[1]),u(f(i(H,S),-b[1]),f(i(V,P),T[1]))),-k[2]))),L[3]))))),Oe=i(Ie,De);return Oe[Oe.length-1]}}var l=[function(){return 0},function(){return 0},function(){return 0}];function s(u){var i=l[u.length];return i||(i=l[u.length]=r(u.length)),i.apply(void 0,u)}function p(u,i,x,f,_,b,T,k){return function(L,A,I,P,S,E){switch(arguments.length){case 0:case 1:return 0;case 2:return f(L,A);case 3:return _(L,A,I);case 4:return b(L,A,I,P);case 5:return T(L,A,I,P,S);case 6:return k(L,A,I,P,S,E)}for(var z=new Array(arguments.length),D=0;D<arguments.length;++D)z[D]=arguments[D];return u(z)}}(function(){for(;l.length<=6;)l.push(r(l.length));w.exports=p.apply(void 0,[s].concat(l));for(var u=0;u<=6;++u)w.exports[u]=l[u]})()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],283:[function(v,w,y){var e=v("robust-determinant");function t(l){var s=l===2?n:l===3?o:l===4?r:l===5?g:c;return s(l<6?e[l]:e)}function n(l){return function(s,p){return[l([[+p[0],+s[0][1]],[+p[1],+s[1][1]]]),l([[+s[0][0],+p[0]],[+s[1][0],+p[1]]]),l(s)]}}function o(l){return function(s,p){return[l([[+p[0],+s[0][1],+s[0][2]],[+p[1],+s[1][1],+s[1][2]],[+p[2],+s[2][1],+s[2][2]]]),l([[+s[0][0],+p[0],+s[0][2]],[+s[1][0],+p[1],+s[1][2]],[+s[2][0],+p[2],+s[2][2]]]),l([[+s[0][0],+s[0][1],+p[0]],[+s[1][0],+s[1][1],+p[1]],[+s[2][0],+s[2][1],+p[2]]]),l(s)]}}function r(l){return function(s,p){return[l([[+p[0],+s[0][1],+s[0][2],+s[0][3]],[+p[1],+s[1][1],+s[1][2],+s[1][3]],[+p[2],+s[2][1],+s[2][2],+s[2][3]],[+p[3],+s[3][1],+s[3][2],+s[3][3]]]),l([[+s[0][0],+p[0],+s[0][2],+s[0][3]],[+s[1][0],+p[1],+s[1][2],+s[1][3]],[+s[2][0],+p[2],+s[2][2],+s[2][3]],[+s[3][0],+p[3],+s[3][2],+s[3][3]]]),l([[+s[0][0],+s[0][1],+p[0],+s[0][3]],[+s[1][0],+s[1][1],+p[1],+s[1][3]],[+s[2][0],+s[2][1],+p[2],+s[2][3]],[+s[3][0],+s[3][1],+p[3],+s[3][3]]]),l([[+s[0][0],+s[0][1],+s[0][2],+p[0]],[+s[1][0],+s[1][1],+s[1][2],+p[1]],[+s[2][0],+s[2][1],+s[2][2],+p[2]],[+s[3][0],+s[3][1],+s[3][2],+p[3]]]),l(s)]}}function g(l){return function(s,p){return[l([[+p[0],+s[0][1],+s[0][2],+s[0][3],+s[0][4]],[+p[1],+s[1][1],+s[1][2],+s[1][3],+s[1][4]],[+p[2],+s[2][1],+s[2][2],+s[2][3],+s[2][4]],[+p[3],+s[3][1],+s[3][2],+s[3][3],+s[3][4]],[+p[4],+s[4][1],+s[4][2],+s[4][3],+s[4][4]]]),l([[+s[0][0],+p[0],+s[0][2],+s[0][3],+s[0][4]],[+s[1][0],+p[1],+s[1][2],+s[1][3],+s[1][4]],[+s[2][0],+p[2],+s[2][2],+s[2][3],+s[2][4]],[+s[3][0],+p[3],+s[3][2],+s[3][3],+s[3][4]],[+s[4][0],+p[4],+s[4][2],+s[4][3],+s[4][4]]]),l([[+s[0][0],+s[0][1],+p[0],+s[0][3],+s[0][4]],[+s[1][0],+s[1][1],+p[1],+s[1][3],+s[1][4]],[+s[2][0],+s[2][1],+p[2],+s[2][3],+s[2][4]],[+s[3][0],+s[3][1],+p[3],+s[3][3],+s[3][4]],[+s[4][0],+s[4][1],+p[4],+s[4][3],+s[4][4]]]),l([[+s[0][0],+s[0][1],+s[0][2],+p[0],+s[0][4]],[+s[1][0],+s[1][1],+s[1][2],+p[1],+s[1][4]],[+s[2][0],+s[2][1],+s[2][2],+p[2],+s[2][4]],[+s[3][0],+s[3][1],+s[3][2],+p[3],+s[3][4]],[+s[4][0],+s[4][1],+s[4][2],+p[4],+s[4][4]]]),l([[+s[0][0],+s[0][1],+s[0][2],+s[0][3],+p[0]],[+s[1][0],+s[1][1],+s[1][2],+s[1][3],+p[1]],[+s[2][0],+s[2][1],+s[2][2],+s[2][3],+p[2]],[+s[3][0],+s[3][1],+s[3][2],+s[3][3],+p[3]],[+s[4][0],+s[4][1],+s[4][2],+s[4][3],+p[4]]]),l(s)]}}function c(l){return function(s,p){return[l([[+p[0],+s[0][1],+s[0][2],+s[0][3],+s[0][4],+s[0][5]],[+p[1],+s[1][1],+s[1][2],+s[1][3],+s[1][4],+s[1][5]],[+p[2],+s[2][1],+s[2][2],+s[2][3],+s[2][4],+s[2][5]],[+p[3],+s[3][1],+s[3][2],+s[3][3],+s[3][4],+s[3][5]],[+p[4],+s[4][1],+s[4][2],+s[4][3],+s[4][4],+s[4][5]],[+p[5],+s[5][1],+s[5][2],+s[5][3],+s[5][4],+s[5][5]]]),l([[+s[0][0],+p[0],+s[0][2],+s[0][3],+s[0][4],+s[0][5]],[+s[1][0],+p[1],+s[1][2],+s[1][3],+s[1][4],+s[1][5]],[+s[2][0],+p[2],+s[2][2],+s[2][3],+s[2][4],+s[2][5]],[+s[3][0],+p[3],+s[3][2],+s[3][3],+s[3][4],+s[3][5]],[+s[4][0],+p[4],+s[4][2],+s[4][3],+s[4][4],+s[4][5]],[+s[5][0],+p[5],+s[5][2],+s[5][3],+s[5][4],+s[5][5]]]),l([[+s[0][0],+s[0][1],+p[0],+s[0][3],+s[0][4],+s[0][5]],[+s[1][0],+s[1][1],+p[1],+s[1][3],+s[1][4],+s[1][5]],[+s[2][0],+s[2][1],+p[2],+s[2][3],+s[2][4],+s[2][5]],[+s[3][0],+s[3][1],+p[3],+s[3][3],+s[3][4],+s[3][5]],[+s[4][0],+s[4][1],+p[4],+s[4][3],+s[4][4],+s[4][5]],[+s[5][0],+s[5][1],+p[5],+s[5][3],+s[5][4],+s[5][5]]]),l([[+s[0][0],+s[0][1],+s[0][2],+p[0],+s[0][4],+s[0][5]],[+s[1][0],+s[1][1],+s[1][2],+p[1],+s[1][4],+s[1][5]],[+s[2][0],+s[2][1],+s[2][2],+p[2],+s[2][4],+s[2][5]],[+s[3][0],+s[3][1],+s[3][2],+p[3],+s[3][4],+s[3][5]],[+s[4][0],+s[4][1],+s[4][2],+p[4],+s[4][4],+s[4][5]],[+s[5][0],+s[5][1],+s[5][2],+p[5],+s[5][4],+s[5][5]]]),l([[+s[0][0],+s[0][1],+s[0][2],+s[0][3],+p[0],+s[0][5]],[+s[1][0],+s[1][1],+s[1][2],+s[1][3],+p[1],+s[1][5]],[+s[2][0],+s[2][1],+s[2][2],+s[2][3],+p[2],+s[2][5]],[+s[3][0],+s[3][1],+s[3][2],+s[3][3],+p[3],+s[3][5]],[+s[4][0],+s[4][1],+s[4][2],+s[4][3],+p[4],+s[4][5]],[+s[5][0],+s[5][1],+s[5][2],+s[5][3],+p[5],+s[5][5]]]),l([[+s[0][0],+s[0][1],+s[0][2],+s[0][3],+s[0][4],+p[0]],[+s[1][0],+s[1][1],+s[1][2],+s[1][3],+s[1][4],+p[1]],[+s[2][0],+s[2][1],+s[2][2],+s[2][3],+s[2][4],+p[2]],[+s[3][0],+s[3][1],+s[3][2],+s[3][3],+s[3][4],+p[3]],[+s[4][0],+s[4][1],+s[4][2],+s[4][3],+s[4][4],+p[4]],[+s[5][0],+s[5][1],+s[5][2],+s[5][3],+s[5][4],+p[5]]]),l(s)]}}var a=[function(){return[[0]]},function(l,s){return[[s[0]],[l[0][0]]]}];function h(l,s,p,u,i,x,f,_){return function(b,T){switch(b.length){case 0:return l(b,T);case 1:return s(b,T);case 2:return p(b,T);case 3:return u(b,T);case 4:return i(b,T);case 5:return x(b,T)}var k=f[b.length];return k||(k=f[b.length]=_(b.length)),k(b,T)}}(function(){for(;a.length<6;)a.push(t(a.length));w.exports=h.apply(void 0,a.concat([a,t]));for(var l=0;l<6;++l)w.exports[l]=a[l]})()},{"robust-determinant":280}],284:[function(v,w,y){var e=v("two-product"),t=v("robust-sum"),n=v("robust-scale"),o=v("robust-subtract");function r(i,x,f,_){return function(b,T,k){var L=i(i(x(T[1],k[0]),x(-k[1],T[0])),i(x(b[1],T[0]),x(-T[1],b[0]))),A=i(x(b[1],k[0]),x(-k[1],b[0])),I=_(L,A);return I[I.length-1]}}function g(i,x,f,_){return function(b,T,k,L){var A=i(i(f(i(x(k[1],L[0]),x(-L[1],k[0])),T[2]),i(f(i(x(T[1],L[0]),x(-L[1],T[0])),-k[2]),f(i(x(T[1],k[0]),x(-k[1],T[0])),L[2]))),i(f(i(x(T[1],L[0]),x(-L[1],T[0])),b[2]),i(f(i(x(b[1],L[0]),x(-L[1],b[0])),-T[2]),f(i(x(b[1],T[0]),x(-T[1],b[0])),L[2])))),I=i(i(f(i(x(k[1],L[0]),x(-L[1],k[0])),b[2]),i(f(i(x(b[1],L[0]),x(-L[1],b[0])),-k[2]),f(i(x(b[1],k[0]),x(-k[1],b[0])),L[2]))),i(f(i(x(T[1],k[0]),x(-k[1],T[0])),b[2]),i(f(i(x(b[1],k[0]),x(-k[1],b[0])),-T[2]),f(i(x(b[1],T[0]),x(-T[1],b[0])),k[2])))),P=_(A,I);return P[P.length-1]}}function c(i,x,f,_){return function(b,T,k,L,A){var I=i(i(i(f(i(f(i(x(L[1],A[0]),x(-A[1],L[0])),k[2]),i(f(i(x(k[1],A[0]),x(-A[1],k[0])),-L[2]),f(i(x(k[1],L[0]),x(-L[1],k[0])),A[2]))),T[3]),i(f(i(f(i(x(L[1],A[0]),x(-A[1],L[0])),T[2]),i(f(i(x(T[1],A[0]),x(-A[1],T[0])),-L[2]),f(i(x(T[1],L[0]),x(-L[1],T[0])),A[2]))),-k[3]),f(i(f(i(x(k[1],A[0]),x(-A[1],k[0])),T[2]),i(f(i(x(T[1],A[0]),x(-A[1],T[0])),-k[2]),f(i(x(T[1],k[0]),x(-k[1],T[0])),A[2]))),L[3]))),i(f(i(f(i(x(k[1],L[0]),x(-L[1],k[0])),T[2]),i(f(i(x(T[1],L[0]),x(-L[1],T[0])),-k[2]),f(i(x(T[1],k[0]),x(-k[1],T[0])),L[2]))),-A[3]),i(f(i(f(i(x(L[1],A[0]),x(-A[1],L[0])),T[2]),i(f(i(x(T[1],A[0]),x(-A[1],T[0])),-L[2]),f(i(x(T[1],L[0]),x(-L[1],T[0])),A[2]))),b[3]),f(i(f(i(x(L[1],A[0]),x(-A[1],L[0])),b[2]),i(f(i(x(b[1],A[0]),x(-A[1],b[0])),-L[2]),f(i(x(b[1],L[0]),x(-L[1],b[0])),A[2]))),-T[3])))),i(i(f(i(f(i(x(T[1],A[0]),x(-A[1],T[0])),b[2]),i(f(i(x(b[1],A[0]),x(-A[1],b[0])),-T[2]),f(i(x(b[1],T[0]),x(-T[1],b[0])),A[2]))),L[3]),i(f(i(f(i(x(T[1],L[0]),x(-L[1],T[0])),b[2]),i(f(i(x(b[1],L[0]),x(-L[1],b[0])),-T[2]),f(i(x(b[1],T[0]),x(-T[1],b[0])),L[2]))),-A[3]),f(i(f(i(x(k[1],L[0]),x(-L[1],k[0])),T[2]),i(f(i(x(T[1],L[0]),x(-L[1],T[0])),-k[2]),f(i(x(T[1],k[0]),x(-k[1],T[0])),L[2]))),b[3]))),i(f(i(f(i(x(k[1],L[0]),x(-L[1],k[0])),b[2]),i(f(i(x(b[1],L[0]),x(-L[1],b[0])),-k[2]),f(i(x(b[1],k[0]),x(-k[1],b[0])),L[2]))),-T[3]),i(f(i(f(i(x(T[1],L[0]),x(-L[1],T[0])),b[2]),i(f(i(x(b[1],L[0]),x(-L[1],b[0])),-T[2]),f(i(x(b[1],T[0]),x(-T[1],b[0])),L[2]))),k[3]),f(i(f(i(x(T[1],k[0]),x(-k[1],T[0])),b[2]),i(f(i(x(b[1],k[0]),x(-k[1],b[0])),-T[2]),f(i(x(b[1],T[0]),x(-T[1],b[0])),k[2]))),-L[3]))))),P=i(i(i(f(i(f(i(x(L[1],A[0]),x(-A[1],L[0])),k[2]),i(f(i(x(k[1],A[0]),x(-A[1],k[0])),-L[2]),f(i(x(k[1],L[0]),x(-L[1],k[0])),A[2]))),b[3]),f(i(f(i(x(L[1],A[0]),x(-A[1],L[0])),b[2]),i(f(i(x(b[1],A[0]),x(-A[1],b[0])),-L[2]),f(i(x(b[1],L[0]),x(-L[1],b[0])),A[2]))),-k[3])),i(f(i(f(i(x(k[1],A[0]),x(-A[1],k[0])),b[2]),i(f(i(x(b[1],A[0]),x(-A[1],b[0])),-k[2]),f(i(x(b[1],k[0]),x(-k[1],b[0])),A[2]))),L[3]),f(i(f(i(x(k[1],L[0]),x(-L[1],k[0])),b[2]),i(f(i(x(b[1],L[0]),x(-L[1],b[0])),-k[2]),f(i(x(b[1],k[0]),x(-k[1],b[0])),L[2]))),-A[3]))),i(i(f(i(f(i(x(k[1],A[0]),x(-A[1],k[0])),T[2]),i(f(i(x(T[1],A[0]),x(-A[1],T[0])),-k[2]),f(i(x(T[1],k[0]),x(-k[1],T[0])),A[2]))),b[3]),f(i(f(i(x(k[1],A[0]),x(-A[1],k[0])),b[2]),i(f(i(x(b[1],A[0]),x(-A[1],b[0])),-k[2]),f(i(x(b[1],k[0]),x(-k[1],b[0])),A[2]))),-T[3])),i(f(i(f(i(x(T[1],A[0]),x(-A[1],T[0])),b[2]),i(f(i(x(b[1],A[0]),x(-A[1],b[0])),-T[2]),f(i(x(b[1],T[0]),x(-T[1],b[0])),A[2]))),k[3]),f(i(f(i(x(T[1],k[0]),x(-k[1],T[0])),b[2]),i(f(i(x(b[1],k[0]),x(-k[1],b[0])),-T[2]),f(i(x(b[1],T[0]),x(-T[1],b[0])),k[2]))),-A[3])))),S=_(I,P);return S[S.length-1]}}function a(i){return(i===3?r:i===4?g:c)(t,e,n,o)}var h=a(3),l=a(4),s=[function(){return 0},function(){return 0},function(i,x){return x[0]-i[0]},function(i,x,f){var _,b=(i[1]-f[1])*(x[0]-f[0]),T=(i[0]-f[0])*(x[1]-f[1]),k=b-T;if(b>0){if(T<=0)return k;_=b+T}else{if(!(b<0)||T>=0)return k;_=-(b+T)}var L=33306690738754716e-32*_;return k>=L||k<=-L?k:h(i,x,f)},function(i,x,f,_){var b=i[0]-_[0],T=x[0]-_[0],k=f[0]-_[0],L=i[1]-_[1],A=x[1]-_[1],I=f[1]-_[1],P=i[2]-_[2],S=x[2]-_[2],E=f[2]-_[2],z=T*I,D=k*A,j=k*L,V=b*I,Z=b*A,Q=T*L,X=P*(z-D)+S*(j-V)+E*(Z-Q),$=7771561172376103e-31*((Math.abs(z)+Math.abs(D))*Math.abs(P)+(Math.abs(j)+Math.abs(V))*Math.abs(S)+(Math.abs(Z)+Math.abs(Q))*Math.abs(E));return X>$||-X>$?X:l(i,x,f,_)}];function p(i){var x=s[i.length];return x||(x=s[i.length]=a(i.length)),x.apply(void 0,i)}function u(i,x,f,_,b,T,k){return function(L,A,I,P,S){switch(arguments.length){case 0:case 1:return 0;case 2:return _(L,A);case 3:return b(L,A,I);case 4:return T(L,A,I,P);case 5:return k(L,A,I,P,S)}for(var E=new Array(arguments.length),z=0;z<arguments.length;++z)E[z]=arguments[z];return i(E)}}(function(){for(;s.length<=5;)s.push(a(s.length));w.exports=u.apply(void 0,[p].concat(s));for(var i=0;i<=5;++i)w.exports[i]=s[i]})()},{"robust-scale":286,"robust-subtract":288,"robust-sum":289,"two-product":306}],285:[function(v,w,y){var e=v("robust-sum"),t=v("robust-scale");w.exports=function(n,o){if(n.length===1)return t(o,n[0]);if(o.length===1)return t(n,o[0]);if(n.length===0||o.length===0)return[0];var r=[0];if(n.length<o.length)for(var g=0;g<n.length;++g)r=e(r,t(o,n[g]));else for(g=0;g<o.length;++g)r=e(r,t(n,o[g]));return r}},{"robust-scale":286,"robust-sum":289}],286:[function(v,w,y){var e=v("two-product"),t=v("two-sum");w.exports=function(n,o){var r=n.length;if(r===1){var g=e(n[0],o);return g[0]?g:[g[1]]}var c=new Array(2*r),a=[.1,.1],h=[.1,.1],l=0;e(n[0],o,a),a[0]&&(c[l++]=a[0]);for(var s=1;s<r;++s){e(n[s],o,h);var p=a[1];t(p,h[0],a),a[0]&&(c[l++]=a[0]);var u=h[1],i=a[1],x=u+i,f=i-(x-u);a[1]=x,f&&(c[l++]=f)}return a[1]&&(c[l++]=a[1]),l===0&&(c[l++]=0),c.length=l,c}},{"two-product":306,"two-sum":307}],287:[function(v,w,y){w.exports=function(t,n,o,r){var g=e(t,o,r),c=e(n,o,r);if(g>0&&c>0||g<0&&c<0)return!1;var a=e(o,t,n),h=e(r,t,n);return a>0&&h>0||a<0&&h<0?!1:g===0&&c===0&&a===0&&h===0?function(l,s,p,u){for(var i=0;i<2;++i){var x=l[i],f=s[i],_=Math.min(x,f),b=Math.max(x,f),T=p[i],k=u[i],L=Math.min(T,k);if(Math.max(T,k)<_||b<L)return!1}return!0}(t,n,o,r):!0};var e=v("robust-orientation")[3]},{"robust-orientation":284}],288:[function(v,w,y){w.exports=function(e,t){var n=0|e.length,o=0|t.length;if(n===1&&o===1)return function(I,P){var S=I+P,E=S-I,z=I-(S-E)+(P-E);return z?[z,S]:[S]}(e[0],-t[0]);var r,g,c=new Array(n+o),a=0,h=0,l=0,s=Math.abs,p=e[h],u=s(p),i=-t[l],x=s(i);u<x?(g=p,(h+=1)<n&&(p=e[h],u=s(p))):(g=i,(l+=1)<o&&(i=-t[l],x=s(i))),h<n&&u<x||l>=o?(r=p,(h+=1)<n&&(p=e[h],u=s(p))):(r=i,(l+=1)<o&&(i=-t[l],x=s(i)));for(var f,_,b=r+g,T=b-r,k=g-T,L=k,A=b;h<n&&l<o;)u<x?(r=p,(h+=1)<n&&(p=e[h],u=s(p))):(r=i,(l+=1)<o&&(i=-t[l],x=s(i))),(k=(g=L)-(T=(b=r+g)-r))&&(c[a++]=k),L=A-((f=A+b)-(_=f-A))+(b-_),A=f;for(;h<n;)(k=(g=L)-(T=(b=(r=p)+g)-r))&&(c[a++]=k),L=A-((f=A+b)-(_=f-A))+(b-_),A=f,(h+=1)<n&&(p=e[h]);for(;l<o;)(k=(g=L)-(T=(b=(r=i)+g)-r))&&(c[a++]=k),L=A-((f=A+b)-(_=f-A))+(b-_),A=f,(l+=1)<o&&(i=-t[l]);return L&&(c[a++]=L),A&&(c[a++]=A),a||(c[a++]=0),c.length=a,c}},{}],289:[function(v,w,y){w.exports=function(e,t){var n=0|e.length,o=0|t.length;if(n===1&&o===1)return function(I,P){var S=I+P,E=S-I,z=I-(S-E)+(P-E);return z?[z,S]:[S]}(e[0],t[0]);var r,g,c=new Array(n+o),a=0,h=0,l=0,s=Math.abs,p=e[h],u=s(p),i=t[l],x=s(i);u<x?(g=p,(h+=1)<n&&(p=e[h],u=s(p))):(g=i,(l+=1)<o&&(i=t[l],x=s(i))),h<n&&u<x||l>=o?(r=p,(h+=1)<n&&(p=e[h],u=s(p))):(r=i,(l+=1)<o&&(i=t[l],x=s(i)));for(var f,_,b=r+g,T=b-r,k=g-T,L=k,A=b;h<n&&l<o;)u<x?(r=p,(h+=1)<n&&(p=e[h],u=s(p))):(r=i,(l+=1)<o&&(i=t[l],x=s(i))),(k=(g=L)-(T=(b=r+g)-r))&&(c[a++]=k),L=A-((f=A+b)-(_=f-A))+(b-_),A=f;for(;h<n;)(k=(g=L)-(T=(b=(r=p)+g)-r))&&(c[a++]=k),L=A-((f=A+b)-(_=f-A))+(b-_),A=f,(h+=1)<n&&(p=e[h]);for(;l<o;)(k=(g=L)-(T=(b=(r=i)+g)-r))&&(c[a++]=k),L=A-((f=A+b)-(_=f-A))+(b-_),A=f,(l+=1)<o&&(i=t[l]);return L&&(c[a++]=L),A&&(c[a++]=A),a||(c[a++]=0),c.length=a,c}},{}],290:[function(v,w,y){w.exports=function(n){return t(e(n))};var e=v("boundary-cells"),t=v("reduce-simplicial-complex")},{"boundary-cells":34,"reduce-simplicial-complex":276}],291:[function(v,w,y){w.exports=function(r,g,c,a){if(c=c||0,a===void 0&&(a=function(f){for(var _=f.length,b=0,T=0;T<_;++T)b=0|Math.max(b,f[T].length);return b-1}(r)),r.length===0||a<1)return{cells:[],vertexIds:[],vertexWeights:[]};var h=function(f,_){for(var b=f.length,T=t.mallocUint8(b),k=0;k<b;++k)T[k]=f[k]<_|0;return T}(g,+c),l=function(f,_){for(var b=f.length,T=_*(_+1)/2*b|0,k=t.mallocUint32(2*T),L=0,A=0;A<b;++A)for(var I=f[A],P=(_=I.length,0);P<_;++P)for(var S=0;S<P;++S){var E=I[S],z=I[P];k[L++]=0|Math.min(E,z),k[L++]=0|Math.max(E,z)}n(e(k,[L/2|0,2]));var D=2;for(A=2;A<L;A+=2)k[A-2]===k[A]&&k[A-1]===k[A+1]||(k[D++]=k[A],k[D++]=k[A+1]);return e(k,[D/2|0,2])}(r,a),s=function(f,_,b,T){for(var k=f.data,L=f.shape[0],A=t.mallocDouble(L),I=0,P=0;P<L;++P){var S=k[2*P],E=k[2*P+1];if(b[S]!==b[E]){var z=_[S],D=_[E];k[2*I]=S,k[2*I+1]=E,A[I++]=(D-T)/(D-z)}}return f.shape[0]=I,e(A,[I])}(l,g,h,+c),p=function(f,_){var b=t.mallocInt32(2*_),T=f.shape[0],k=f.data;b[0]=0;for(var L=0,A=0;A<T;++A){var I=k[2*A];if(I!==L){for(b[2*L+1]=A;++L<I;)b[2*L]=A,b[2*L+1]=A;b[2*L]=A}}for(b[2*L+1]=T;++L<_;)b[2*L]=b[2*L+1]=T;return b}(l,0|g.length),u=o(a)(r,l.data,p,h),i=function(f){for(var _=0|f.shape[0],b=f.data,T=new Array(_),k=0;k<_;++k)T[k]=[b[2*k],b[2*k+1]];return T}(l),x=[].slice.call(s.data,0,s.shape[0]);return t.free(h),t.free(l.data),t.free(s.data),t.free(p),{cells:u,vertexIds:i,vertexWeights:x}};var e=v("ndarray"),t=v("typedarray-pool"),n=v("ndarray-sort"),o=v("./lib/codegen")},{"./lib/codegen":292,ndarray:259,"ndarray-sort":258,"typedarray-pool":308}],292:[function(v,w,y){w.exports=function(t){return e[t]()};var e=[function(){return function(t,n,o,r){for(var g=t.length,c=0;c<g;++c)t[c].length;return[]}},function(){function t(n,o,r,g){for(var c=0|Math.min(r,g),a=0|Math.max(r,g),h=n[2*c],l=n[2*c+1];h<l;){var s=h+l>>1,p=o[2*s+1];if(p===a)return s;a<p?l=s:h=s+1}return h}return function(n,o,r,g){for(var c=n.length,a=[],h=0;h<c;++h){var l=n[h];if(l.length===2){var s=(g[l[0]]<<0)+(g[l[1]]<<1);if(s===0||s===3)continue;switch(s){case 0:break;case 1:a.push([t(r,o,l[0],l[1])]);break;case 2:a.push([t(r,o,l[1],l[0])])}}}return a}},function(){function t(n,o,r,g){for(var c=0|Math.min(r,g),a=0|Math.max(r,g),h=n[2*c],l=n[2*c+1];h<l;){var s=h+l>>1,p=o[2*s+1];if(p===a)return s;a<p?l=s:h=s+1}return h}return function(n,o,r,g){for(var c=n.length,a=[],h=0;h<c;++h){var l=n[h],s=l.length;if(s===3){if((p=(g[l[0]]<<0)+(g[l[1]]<<1)+(g[l[2]]<<2))===0||p===7)continue;switch(p){case 0:break;case 1:a.push([t(r,o,l[0],l[2]),t(r,o,l[0],l[1])]);break;case 2:a.push([t(r,o,l[1],l[0]),t(r,o,l[1],l[2])]);break;case 3:a.push([t(r,o,l[0],l[2]),t(r,o,l[1],l[2])]);break;case 4:a.push([t(r,o,l[2],l[1]),t(r,o,l[2],l[0])]);break;case 5:a.push([t(r,o,l[2],l[1]),t(r,o,l[0],l[1])]);break;case 6:a.push([t(r,o,l[1],l[0]),t(r,o,l[2],l[0])])}}else if(s===2){var p;if((p=(g[l[0]]<<0)+(g[l[1]]<<1))===0||p===3)continue;switch(p){case 0:break;case 1:a.push([t(r,o,l[0],l[1])]);break;case 2:a.push([t(r,o,l[1],l[0])])}}}return a}},function(){function t(n,o,r,g){for(var c=0|Math.min(r,g),a=0|Math.max(r,g),h=n[2*c],l=n[2*c+1];h<l;){var s=h+l>>1,p=o[2*s+1];if(p===a)return s;a<p?l=s:h=s+1}return h}return function(n,o,r,g){for(var c=n.length,a=[],h=0;h<c;++h){var l=n[h],s=l.length;if(s===4){if((p=(g[l[0]]<<0)+(g[l[1]]<<1)+(g[l[2]]<<2)+(g[l[3]]<<3))===0||p===15)continue;switch(p){case 0:break;case 1:a.push([t(r,o,l[0],l[1]),t(r,o,l[0],l[2]),t(r,o,l[0],l[3])]);break;case 2:a.push([t(r,o,l[1],l[2]),t(r,o,l[1],l[0]),t(r,o,l[1],l[3])]);break;case 3:a.push([t(r,o,l[1],l[2]),t(r,o,l[0],l[2]),t(r,o,l[0],l[3])],[t(r,o,l[1],l[3]),t(r,o,l[1],l[2]),t(r,o,l[0],l[3])]);break;case 4:a.push([t(r,o,l[2],l[0]),t(r,o,l[2],l[1]),t(r,o,l[2],l[3])]);break;case 5:a.push([t(r,o,l[0],l[1]),t(r,o,l[2],l[1]),t(r,o,l[0],l[3])],[t(r,o,l[2],l[1]),t(r,o,l[2],l[3]),t(r,o,l[0],l[3])]);break;case 6:a.push([t(r,o,l[2],l[0]),t(r,o,l[1],l[0]),t(r,o,l[1],l[3])],[t(r,o,l[2],l[3]),t(r,o,l[2],l[0]),t(r,o,l[1],l[3])]);break;case 7:a.push([t(r,o,l[0],l[3]),t(r,o,l[1],l[3]),t(r,o,l[2],l[3])]);break;case 8:a.push([t(r,o,l[3],l[1]),t(r,o,l[3],l[0]),t(r,o,l[3],l[2])]);break;case 9:a.push([t(r,o,l[3],l[1]),t(r,o,l[0],l[1]),t(r,o,l[0],l[2])],[t(r,o,l[3],l[2]),t(r,o,l[3],l[1]),t(r,o,l[0],l[2])]);break;case 10:a.push([t(r,o,l[1],l[0]),t(r,o,l[3],l[0]),t(r,o,l[1],l[2])],[t(r,o,l[3],l[0]),t(r,o,l[3],l[2]),t(r,o,l[1],l[2])]);break;case 11:a.push([t(r,o,l[1],l[2]),t(r,o,l[0],l[2]),t(r,o,l[3],l[2])]);break;case 12:a.push([t(r,o,l[3],l[0]),t(r,o,l[2],l[0]),t(r,o,l[2],l[1])],[t(r,o,l[3],l[1]),t(r,o,l[3],l[0]),t(r,o,l[2],l[1])]);break;case 13:a.push([t(r,o,l[0],l[1]),t(r,o,l[2],l[1]),t(r,o,l[3],l[1])]);break;case 14:a.push([t(r,o,l[2],l[0]),t(r,o,l[1],l[0]),t(r,o,l[3],l[0])])}}else if(s===3){if((p=(g[l[0]]<<0)+(g[l[1]]<<1)+(g[l[2]]<<2))===0||p===7)continue;switch(p){case 0:break;case 1:a.push([t(r,o,l[0],l[2]),t(r,o,l[0],l[1])]);break;case 2:a.push([t(r,o,l[1],l[0]),t(r,o,l[1],l[2])]);break;case 3:a.push([t(r,o,l[0],l[2]),t(r,o,l[1],l[2])]);break;case 4:a.push([t(r,o,l[2],l[1]),t(r,o,l[2],l[0])]);break;case 5:a.push([t(r,o,l[2],l[1]),t(r,o,l[0],l[1])]);break;case 6:a.push([t(r,o,l[1],l[0]),t(r,o,l[2],l[0])])}}else if(s===2){var p;if((p=(g[l[0]]<<0)+(g[l[1]]<<1))===0||p===3)continue;switch(p){case 0:break;case 1:a.push([t(r,o,l[0],l[1])]);break;case 2:a.push([t(r,o,l[1],l[0])])}}}return a}}]},{}],293:[function(v,w,y){var e=v("bit-twiddle"),t=v("union-find");function n(l,s){var p=l.length,u=l.length-s.length,i=Math.min;if(u)return u;switch(p){case 0:return 0;case 1:return l[0]-s[0];case 2:return(_=l[0]+l[1]-s[0]-s[1])||i(l[0],l[1])-i(s[0],s[1]);case 3:var x=l[0]+l[1],f=s[0]+s[1];if(_=x+l[2]-(f+s[2]))return _;var _,b=i(l[0],l[1]),T=i(s[0],s[1]);return(_=i(b,l[2])-i(T,s[2]))||i(b+l[2],x)-i(T+s[2],f);default:var k=l.slice(0);k.sort();var L=s.slice(0);L.sort();for(var A=0;A<p;++A)if(u=k[A]-L[A])return u;return 0}}function o(l,s){return n(l[0],s[0])}function r(l,s){if(s){for(var p=l.length,u=new Array(p),i=0;i<p;++i)u[i]=[l[i],s[i]];for(u.sort(o),i=0;i<p;++i)l[i]=u[i][0],s[i]=u[i][1];return l}return l.sort(n),l}function g(l){if(l.length===0)return[];for(var s=1,p=l.length,u=1;u<p;++u){var i=l[u];if(n(i,l[u-1])){if(u===s){s++;continue}l[s++]=i}}return l.length=s,l}function c(l,s){for(var p=0,u=l.length-1,i=-1;p<=u;){var x=p+u>>1,f=n(l[x],s);f<=0?(f===0&&(i=x),p=x+1):f>0&&(u=x-1)}return i}function a(l,s){for(var p=new Array(l.length),u=0,i=p.length;u<i;++u)p[u]=[];for(var x=[],f=(u=0,s.length);u<f;++u)for(var _=s[u],b=_.length,T=1,k=1<<b;T<k;++T){x.length=e.popCount(T);for(var L=0,A=0;A<b;++A)T&1<<A&&(x[L++]=_[A]);var I=c(l,x);if(!(I<0))for(;p[I++].push(u),!(I>=l.length||n(l[I],x)!==0););}return p}function h(l,s){if(s<0)return[];for(var p=[],u=(1<<s+1)-1,i=0;i<l.length;++i)for(var x=l[i],f=u;f<1<<x.length;f=e.nextCombination(f)){for(var _=new Array(s+1),b=0,T=0;T<x.length;++T)f&1<<T&&(_[b++]=x[T]);p.push(_)}return r(p)}y.dimension=function(l){for(var s=0,p=Math.max,u=0,i=l.length;u<i;++u)s=p(s,l[u].length);return s-1},y.countVertices=function(l){for(var s=-1,p=Math.max,u=0,i=l.length;u<i;++u)for(var x=l[u],f=0,_=x.length;f<_;++f)s=p(s,x[f]);return s+1},y.cloneCells=function(l){for(var s=new Array(l.length),p=0,u=l.length;p<u;++p)s[p]=l[p].slice(0);return s},y.compareCells=n,y.normalize=r,y.unique=g,y.findCell=c,y.incidence=a,y.dual=function(l,s){if(!s)return a(g(h(l,0)),l);for(var p=new Array(s),u=0;u<s;++u)p[u]=[];u=0;for(var i=l.length;u<i;++u)for(var x=l[u],f=0,_=x.length;f<_;++f)p[x[f]].push(u);return p},y.explode=function(l){for(var s=[],p=0,u=l.length;p<u;++p)for(var i=l[p],x=0|i.length,f=1,_=1<<x;f<_;++f){for(var b=[],T=0;T<x;++T)f>>>T&1&&b.push(i[T]);s.push(b)}return r(s)},y.skeleton=h,y.boundary=function(l){for(var s=[],p=0,u=l.length;p<u;++p)for(var i=l[p],x=0,f=i.length;x<f;++x){for(var _=new Array(i.length-1),b=0,T=0;b<f;++b)b!==x&&(_[T++]=i[b]);s.push(_)}return r(s)},y.connectedComponents=function(l,s){return s?function(p,u){for(var i=new t(u),x=0;x<p.length;++x)for(var f=p[x],_=0;_<f.length;++_)for(var b=_+1;b<f.length;++b)i.link(f[_],f[b]);var T=[],k=i.ranks;for(x=0;x<k.length;++x)k[x]=-1;for(x=0;x<p.length;++x){var L=i.find(p[x][0]);k[L]<0?(k[L]=T.length,T.push([p[x].slice(0)])):T[k[L]].push(p[x].slice(0))}return T}(l,s):function(p){for(var u=g(r(h(p,0))),i=new t(u.length),x=0;x<p.length;++x)for(var f=p[x],_=0;_<f.length;++_)for(var b=c(u,[f[_]]),T=_+1;T<f.length;++T)i.link(b,c(u,[f[T]]));var k=[],L=i.ranks;for(x=0;x<L.length;++x)L[x]=-1;for(x=0;x<p.length;++x){var A=i.find(c(u,[p[x][0]]));L[A]<0?(L[A]=k.length,k.push([p[x].slice(0)])):k[L[A]].push(p[x].slice(0))}return k}(l)}},{"bit-twiddle":32,"union-find":309}],294:[function(v,w,y){arguments[4][32][0].apply(y,arguments)},{dup:32}],295:[function(v,w,y){arguments[4][293][0].apply(y,arguments)},{"bit-twiddle":294,dup:293,"union-find":296}],296:[function(v,w,y){function e(t){this.roots=new Array(t),this.ranks=new Array(t);for(var n=0;n<t;++n)this.roots[n]=n,this.ranks[n]=0}w.exports=e,e.prototype.length=function(){return this.roots.length},e.prototype.makeSet=function(){var t=this.roots.length;return this.roots.push(t),this.ranks.push(0),t},e.prototype.find=function(t){for(var n=this.roots;n[t]!==t;){var o=n[t];n[t]=n[o],t=o}return t},e.prototype.link=function(t,n){var o=this.find(t),r=this.find(n);if(o!==r){var g=this.ranks,c=this.roots,a=g[o],h=g[r];a<h?c[o]=r:h<a?c[r]=o:(c[r]=o,++g[o])}}},{}],297:[function(v,w,y){w.exports=function(n,o,r){for(var g=o.length,c=n.length,a=new Array(g),h=new Array(g),l=new Array(g),s=new Array(g),p=0;p<g;++p)a[p]=h[p]=-1,l[p]=1/0,s[p]=!1;for(p=0;p<c;++p){var u=n[p];if(u.length!==2)throw new Error("Input must be a graph");var i=u[1],x=u[0];h[x]!==-1?h[x]=-2:h[x]=i,a[i]!==-1?a[i]=-2:a[i]=x}function f(Q){if(s[Q])return 1/0;var X,$,re,H,N,U=a[Q],te=h[Q];return U<0||te<0?1/0:(X=o[Q],$=o[U],re=o[te],H=Math.abs(e(X,$,re)),N=Math.sqrt(Math.pow($[0]-re[0],2)+Math.pow($[1]-re[1],2)),H/N)}function _(Q,X){var $=S[Q],re=S[X];S[Q]=re,S[X]=$,E[$]=X,E[re]=Q}function b(Q){return l[S[Q]]}function T(Q){return 1&Q?Q-1>>1:(Q>>1)-1}function k(Q){for(var X=b(Q);;){var $=X,re=2*Q+1,H=2*(Q+1),N=Q;if(re<z){var U=b(re);U<$&&(N=re,$=U)}if(H<z&&b(H)<$&&(N=H),N===Q)return Q;_(Q,N),Q=N}}function L(Q){for(var X=b(Q);Q>0;){var $=T(Q);if($>=0&&X<b($)){_(Q,$),Q=$;continue}return Q}}function A(){if(z>0){var Q=S[0];return _(0,z-1),z-=1,k(0),Q}return-1}function I(Q,X){var $=S[Q];return l[$]===X?Q:(l[$]=-1/0,L(Q),A(),l[$]=X,L((z+=1)-1))}function P(Q){if(!s[Q]){s[Q]=!0;var X=a[Q],$=h[Q];a[$]>=0&&(a[$]=X),h[X]>=0&&(h[X]=$),E[X]>=0&&I(E[X],f(X)),E[$]>=0&&I(E[$],f($))}}var S=[],E=new Array(g);for(p=0;p<g;++p)(l[p]=f(p))<1/0?(E[p]=S.length,S.push(p)):E[p]=-1;var z=S.length;for(p=z>>1;p>=0;--p)k(p);for(;;){var D=A();if(D<0||l[D]>r)break;P(D)}var j=[];for(p=0;p<g;++p)s[p]||(E[p]=j.length,j.push(o[p].slice()));j.length;function V(Q,X){if(Q[X]<0)return X;var $=X,re=X;do{var H=Q[re];if(!s[re]||H<0||H===re||(H=Q[re=H],!s[re]||H<0||H===re))break;re=H,$=Q[$]}while($!==re);for(var N=X;N!==re;N=Q[N])Q[N]=re;return re}var Z=[];return n.forEach(function(Q){var X=V(a,Q[0]),$=V(h,Q[1]);if(X>=0&&$>=0&&X!==$){var re=E[X],H=E[$];re!==H&&Z.push([re,H])}}),t.unique(t.normalize(Z)),{positions:j,edges:Z}};var e=v("robust-orientation"),t=v("simplicial-complex")},{"robust-orientation":284,"simplicial-complex":295}],298:[function(v,w,y){w.exports=function(n,o){var r,g,c,a;if(o[0][0]<o[1][0])r=o[0],g=o[1];else{if(!(o[0][0]>o[1][0]))return t(o,n);r=o[1],g=o[0]}if(n[0][0]<n[1][0])c=n[0],a=n[1];else{if(!(n[0][0]>n[1][0]))return-t(n,o);c=n[1],a=n[0]}var h=e(r,g,a),l=e(r,g,c);if(h<0){if(l<=0)return h}else if(h>0){if(l>=0)return h}else if(l)return l;if(h=e(a,c,g),l=e(a,c,r),h<0){if(l<=0)return h}else if(h>0){if(l>=0)return h}else if(l)return l;return g[0]-a[0]};var e=v("robust-orientation");function t(n,o){var r,g,c,a;if(o[0][0]<o[1][0])r=o[0],g=o[1];else{if(!(o[0][0]>o[1][0])){var h=Math.min(n[0][1],n[1][1]),l=Math.max(n[0][1],n[1][1]),s=Math.min(o[0][1],o[1][1]),p=Math.max(o[0][1],o[1][1]);return l<s?l-s:h>p?h-p:l-p}r=o[1],g=o[0]}n[0][1]<n[1][1]?(c=n[0],a=n[1]):(c=n[1],a=n[0]);var u=e(g,r,c);return u||(u=e(g,r,a))||a-g}},{"robust-orientation":284}],299:[function(v,w,y){w.exports=function(l){for(var s=l.length,p=2*s,u=new Array(p),i=0;i<s;++i){var x=l[i],f=x[0][0]<x[1][0];u[2*i]=new h(x[0][0],x,f,i),u[2*i+1]=new h(x[1][0],x,!f,i)}u.sort(function(P,S){var E=P.x-S.x;return E||(E=P.create-S.create)||Math.min(P.segment[0][1],P.segment[1][1])-Math.min(S.segment[0][1],S.segment[1][1])});var _=t(o),b=[],T=[],k=[];for(i=0;i<p;){for(var L=u[i].x,A=[];i<p;){var I=u[i];if(I.x!==L)break;i+=1,I.segment[0][0]===I.x&&I.segment[1][0]===I.x?I.create&&(I.segment[0][1]<I.segment[1][1]?(A.push(new a(I.segment[0][1],I.index,!0,!0)),A.push(new a(I.segment[1][1],I.index,!1,!1))):(A.push(new a(I.segment[1][1],I.index,!0,!1)),A.push(new a(I.segment[0][1],I.index,!1,!0)))):_=I.create?_.insert(I.segment,I.index):_.remove(I.segment)}b.push(_.root),T.push(L),k.push(A)}return new r(b,T,k)};var e=v("binary-search-bounds"),t=v("functional-red-black-tree"),n=v("robust-orientation"),o=v("./lib/order-segments");function r(l,s,p){this.slabs=l,this.coordinates=s,this.horizontal=p}function g(l,s){return l.y-s}function c(l,s){for(var p=null;l;){var u,i,x=l.key;x[0][0]<x[1][0]?(u=x[0],i=x[1]):(u=x[1],i=x[0]);var f=n(u,i,s);if(f<0)l=l.left;else if(f>0)if(s[0]!==x[1][0])p=l,l=l.right;else{if(_=c(l.right,s))return _;l=l.left}else{if(s[0]!==x[1][0])return l;var _;if(_=c(l.right,s))return _;l=l.left}}return p}function a(l,s,p,u){this.y=l,this.index=s,this.start=p,this.closed=u}function h(l,s,p,u){this.x=l,this.segment=s,this.create=p,this.index=u}r.prototype.castUp=function(l){var s=e.le(this.coordinates,l[0]);if(s<0)return-1;this.slabs[s];var p=c(this.slabs[s],l),u=-1;if(p&&(u=p.value),this.coordinates[s]===l[0]){var i=null;if(p&&(i=p.key),s>0){var x=c(this.slabs[s-1],l);x&&(i?o(x.key,i)>0&&(i=x.key,u=x.value):(u=x.value,i=x.key))}var f=this.horizontal[s];if(f.length>0){var _=e.ge(f,l[1],g);if(_<f.length){var b=f[_];if(l[1]===b.y){if(b.closed)return b.index;for(;_<f.length-1&&f[_+1].y===l[1];)if((b=f[_+=1]).closed)return b.index;if(b.y===l[1]&&!b.start){if((_+=1)>=f.length)return u;b=f[_]}}if(b.start)if(i){var T=n(i[0],i[1],[l[0],b.y]);i[0][0]>i[1][0]&&(T=-T),T>0&&(u=b.index)}else u=b.index;else b.y!==l[1]&&(u=b.index)}}}return u}},{"./lib/order-segments":298,"binary-search-bounds":31,"functional-red-black-tree":69,"robust-orientation":284}],300:[function(v,w,y){var e=v("robust-dot-product"),t=v("robust-sum");function n(r,g){var c=t(e(r,g),[g[g.length-1]]);return c[c.length-1]}function o(r,g,c,a){var h=-g/(a-g);h<0?h=0:h>1&&(h=1);for(var l=1-h,s=r.length,p=new Array(s),u=0;u<s;++u)p[u]=h*r[u]+l*c[u];return p}w.exports=function(r,g){for(var c=[],a=[],h=n(r[r.length-1],g),l=r[r.length-1],s=r[0],p=0;p<r.length;++p,l=s){var u=n(s=r[p],g);if(h<0&&u>0||h>0&&u<0){var i=o(l,u,s,h);c.push(i),a.push(i.slice())}u<0?a.push(s.slice()):u>0?c.push(s.slice()):(c.push(s.slice()),a.push(s.slice())),h=u}return{positive:c,negative:a}},w.exports.positive=function(r,g){for(var c=[],a=n(r[r.length-1],g),h=r[r.length-1],l=r[0],s=0;s<r.length;++s,h=l){var p=n(l=r[s],g);(a<0&&p>0||a>0&&p<0)&&c.push(o(h,p,l,a)),p>=0&&c.push(l.slice()),a=p}return c},w.exports.negative=function(r,g){for(var c=[],a=n(r[r.length-1],g),h=r[r.length-1],l=r[0],s=0;s<r.length;++s,h=l){var p=n(l=r[s],g);(a<0&&p>0||a>0&&p<0)&&c.push(o(h,p,l,a)),p<=0&&c.push(l.slice()),a=p}return c}},{"robust-dot-product":281,"robust-sum":289}],301:[function(v,w,y){(function(){var e={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function t(c){return o(g(c),arguments)}function n(c,a){return t.apply(null,[c].concat(a||[]))}function o(c,a){var h,l,s,p,u,i,x,f,_,b=1,T=c.length,k="";for(l=0;l<T;l++)if(typeof c[l]=="string")k+=c[l];else if(typeof c[l]=="object"){if((p=c[l]).keys)for(h=a[b],s=0;s<p.keys.length;s++){if(h==null)throw new Error(t('[sprintf] Cannot access property "%s" of undefined value "%s"',p.keys[s],p.keys[s-1]));h=h[p.keys[s]]}else h=p.param_no?a[p.param_no]:a[b++];if(e.not_type.test(p.type)&&e.not_primitive.test(p.type)&&h instanceof Function&&(h=h()),e.numeric_arg.test(p.type)&&typeof h!="number"&&isNaN(h))throw new TypeError(t("[sprintf] expecting number but found %T",h));switch(e.number.test(p.type)&&(f=h>=0),p.type){case"b":h=parseInt(h,10).toString(2);break;case"c":h=String.fromCharCode(parseInt(h,10));break;case"d":case"i":h=parseInt(h,10);break;case"j":h=JSON.stringify(h,null,p.width?parseInt(p.width):0);break;case"e":h=p.precision?parseFloat(h).toExponential(p.precision):parseFloat(h).toExponential();break;case"f":h=p.precision?parseFloat(h).toFixed(p.precision):parseFloat(h);break;case"g":h=p.precision?String(Number(h.toPrecision(p.precision))):parseFloat(h);break;case"o":h=(parseInt(h,10)>>>0).toString(8);break;case"s":h=String(h),h=p.precision?h.substring(0,p.precision):h;break;case"t":h=String(!!h),h=p.precision?h.substring(0,p.precision):h;break;case"T":h=Object.prototype.toString.call(h).slice(8,-1).toLowerCase(),h=p.precision?h.substring(0,p.precision):h;break;case"u":h=parseInt(h,10)>>>0;break;case"v":h=h.valueOf(),h=p.precision?h.substring(0,p.precision):h;break;case"x":h=(parseInt(h,10)>>>0).toString(16);break;case"X":h=(parseInt(h,10)>>>0).toString(16).toUpperCase()}e.json.test(p.type)?k+=h:(!e.number.test(p.type)||f&&!p.sign?_="":(_=f?"+":"-",h=h.toString().replace(e.sign,"")),i=p.pad_char?p.pad_char==="0"?"0":p.pad_char.charAt(1):" ",x=p.width-(_+h).length,u=p.width&&x>0?i.repeat(x):"",k+=p.align?_+h+u:i==="0"?_+u+h:u+_+h)}return k}var r=Object.create(null);function g(c){if(r[c])return r[c];for(var a,h=c,l=[],s=0;h;){if((a=e.text.exec(h))!==null)l.push(a[0]);else if((a=e.modulo.exec(h))!==null)l.push("%");else{if((a=e.placeholder.exec(h))===null)throw new SyntaxError("[sprintf] unexpected placeholder");if(a[2]){s|=1;var p=[],u=a[2],i=[];if((i=e.key.exec(u))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");for(p.push(i[1]);(u=u.substring(i[0].length))!=="";)if((i=e.key_access.exec(u))!==null)p.push(i[1]);else{if((i=e.index_access.exec(u))===null)throw new SyntaxError("[sprintf] failed to parse named argument key");p.push(i[1])}a[2]=p}else s|=2;if(s===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");l.push({placeholder:a[0],param_no:a[1],keys:a[2],sign:a[3],pad_char:a[4],align:a[5],width:a[6],precision:a[7],type:a[8]})}h=h.substring(a[0].length)}return r[c]=l}y!==void 0&&(y.sprintf=t,y.vsprintf=n),typeof window<"u"&&(window.sprintf=t,window.vsprintf=n)})()},{}],302:[function(v,w,y){w.exports=function(r,g){if(r.dimension<=0)return{positions:[],cells:[]};if(r.dimension===1)return function(h,l){for(var s=t(h,l),p=s.length,u=new Array(p),i=new Array(p),x=0;x<p;++x)u[x]=[s[x]],i[x]=[x];return{positions:u,cells:i}}(r,g);var c=r.order.join()+"-"+r.dtype,a=o[c];return g=+g||0,a||(a=o[c]=function(h,l){var s=h.length+"d",p=n[s];if(p)return p(e,h,l)}(r.order,r.dtype)),a(r,g)};var e=v("ndarray-extract-contour"),t=v("zero-crossings"),n={"2d":function(r,g,c){var a=r({order:g,scalarArguments:3,getters:c==="generic"?[0]:void 0,phase:function(h,l,s,p){return h>p|0},vertex:function(h,l,s,p,u,i,x,f,_,b,T,k,L){var A=(x<<0)+(f<<1)+(_<<2)+(b<<3)|0;if(A!==0&&A!==15)switch(A){case 0:T.push([h-.5,l-.5]);break;case 1:T.push([h-.25-.25*(p+s-2*L)/(s-p),l-.25-.25*(u+s-2*L)/(s-u)]);break;case 2:T.push([h-.75-.25*(-p-s+2*L)/(p-s),l-.25-.25*(i+p-2*L)/(p-i)]);break;case 3:T.push([h-.5,l-.5-.5*(u+s+i+p-4*L)/(s-u+p-i)]);break;case 4:T.push([h-.25-.25*(i+u-2*L)/(u-i),l-.75-.25*(-u-s+2*L)/(u-s)]);break;case 5:T.push([h-.5-.5*(p+s+i+u-4*L)/(s-p+u-i),l-.5]);break;case 6:T.push([h-.5-.25*(-p-s+i+u)/(p-s+u-i),l-.5-.25*(-u-s+i+p)/(u-s+p-i)]);break;case 7:T.push([h-.75-.25*(i+u-2*L)/(u-i),l-.75-.25*(i+p-2*L)/(p-i)]);break;case 8:T.push([h-.75-.25*(-i-u+2*L)/(i-u),l-.75-.25*(-i-p+2*L)/(i-p)]);break;case 9:T.push([h-.5-.25*(p+s+-i-u)/(s-p+i-u),l-.5-.25*(u+s+-i-p)/(s-u+i-p)]);break;case 10:T.push([h-.5-.5*(-p-s-i-u+4*L)/(p-s+i-u),l-.5]);break;case 11:T.push([h-.25-.25*(-i-u+2*L)/(i-u),l-.75-.25*(u+s-2*L)/(s-u)]);break;case 12:T.push([h-.5,l-.5-.5*(-u-s-i-p+4*L)/(u-s+i-p)]);break;case 13:T.push([h-.75-.25*(p+s-2*L)/(s-p),l-.25-.25*(-i-p+2*L)/(i-p)]);break;case 14:T.push([h-.25-.25*(-p-s+2*L)/(p-s),l-.25-.25*(-u-s+2*L)/(u-s)]);break;case 15:T.push([h-.5,l-.5])}},cell:function(h,l,s,p,u,i,x,f,_){u?f.push([h,l]):f.push([l,h])}});return function(h,l){var s=[],p=[];return a(h,s,p,l),{positions:s,cells:p}}}},o={}},{"ndarray-extract-contour":251,"zero-crossings":318}],303:[function(v,w,y){(function(e){(function(){w.exports=function r(g,c,a){a=a||{};var h=o[g];h||(h=o[g]={" ":{data:new Float32Array(0),shape:.2}});var l=h[c];if(!l)if(c.length<=1||!/\d/.test(c))l=h[c]=function(L){for(var A=L.cells,I=L.positions,P=new Float32Array(6*A.length),S=0,E=0,z=0;z<A.length;++z)for(var D=A[z],j=0;j<3;++j){var V=I[D[j]];P[S++]=V[0],P[S++]=V[1]+1.4,E=Math.max(V[0],E)}return{data:P,shape:E}}(t(c,{triangles:!0,font:g,textAlign:a.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var s=c.split(/(\d|\s)/),p=new Array(s.length),u=0,i=0,x=0;x<s.length;++x)p[x]=r(g,s[x]),u+=p[x].data.length,i+=p[x].shape,x>0&&(i+=.02);var f=new Float32Array(u),_=0,b=-.5*i;for(x=0;x<p.length;++x){for(var T=p[x].data,k=0;k<T.length;k+=2)f[_++]=T[k]+b,f[_++]=T[k+1];b+=p[x].shape+.02}l=h[c]={data:f,shape:i}}return l};var t=v("vectorize-text"),n=window||e.global||{},o=n.__TEXT_CACHE||{};n.__TEXT_CACHE={}}).call(this)}).call(this,v("_process"))},{_process:5,"vectorize-text":311}],304:[function(v,w,y){var e=v("parse-unit");w.exports=n;function t(o,r){var g=e(getComputedStyle(o).getPropertyValue(r));return g[0]*n(g[1],o)}function n(o,r){switch(r=r||document.body,o=(o||"px").trim().toLowerCase(),r!==window&&r!==document||(r=document.body),o){case"%":return r.clientHeight/100;case"ch":case"ex":return function(g,c){var a=document.createElement("div");a.style["font-size"]="128"+g,c.appendChild(a);var h=t(a,"font-size")/128;return c.removeChild(a),h}(o,r);case"em":return t(r,"font-size");case"rem":return t(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return 96;case"cm":return 96/2.54;case"mm":return 96/25.4;case"pt":return 96/72;case"pc":return 16}return 1}},{"parse-unit":265}],305:[function(v,w,y){w.exports=function(u){var i=(u=u||{}).center||[0,0,0],x=u.up||[0,1,0],f=u.right||h(x),_=u.radius||1,b=u.theta||0,T=u.phi||0;if(i=[].slice.call(i,0,3),x=[].slice.call(x,0,3),r(x,x),f=[].slice.call(f,0,3),r(f,f),"eye"in u){var k=u.eye,L=[k[0]-i[0],k[1]-i[1],k[2]-i[2]];o(f,L,x),c(f[0],f[1],f[2])<1e-6?f=h(x):r(f,f),_=c(L[0],L[1],L[2]);var A=g(x,L)/_,I=g(f,L)/_;T=Math.acos(A),b=Math.acos(I)}return _=Math.log(_),new l(u.zoomMin,u.zoomMax,i,x,f,_,b,T)};var e=v("filtered-vector"),t=v("gl-mat4/invert"),n=v("gl-mat4/rotate"),o=v("gl-vec3/cross"),r=v("gl-vec3/normalize"),g=v("gl-vec3/dot");function c(u,i,x){return Math.sqrt(Math.pow(u,2)+Math.pow(i,2)+Math.pow(x,2))}function a(u){return Math.min(1,Math.max(-1,u))}function h(u){var i=Math.abs(u[0]),x=Math.abs(u[1]),f=Math.abs(u[2]),_=[0,0,0];i>Math.max(x,f)?_[2]=1:x>Math.max(i,f)?_[0]=1:_[1]=1;for(var b=0,T=0,k=0;k<3;++k)b+=u[k]*u[k],T+=_[k]*u[k];for(k=0;k<3;++k)_[k]-=T/b*u[k];return r(_,_),_}function l(u,i,x,f,_,b,T,k){this.center=e(x),this.up=e(f),this.right=e(_),this.radius=e([b]),this.angle=e([T,k]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(u,i),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var L=0;L<16;++L)this.computedMatrix[L]=.5;this.recalcMatrix(0)}var s=l.prototype;s.setDistanceLimits=function(u,i){u=u>0?Math.log(u):-1/0,i=i>0?Math.log(i):1/0,i=Math.max(i,u),this.radius.bounds[0][0]=u,this.radius.bounds[1][0]=i},s.getDistanceLimits=function(u){var i=this.radius.bounds[0];return u?(u[0]=Math.exp(i[0][0]),u[1]=Math.exp(i[1][0]),u):[Math.exp(i[0][0]),Math.exp(i[1][0])]},s.recalcMatrix=function(u){this.center.curve(u),this.up.curve(u),this.right.curve(u),this.radius.curve(u),this.angle.curve(u);for(var i=this.computedUp,x=this.computedRight,f=0,_=0,b=0;b<3;++b)_+=i[b]*x[b],f+=i[b]*i[b];var T=Math.sqrt(f),k=0;for(b=0;b<3;++b)x[b]-=i[b]*_/f,k+=x[b]*x[b],i[b]/=T;var L=Math.sqrt(k);for(b=0;b<3;++b)x[b]/=L;var A=this.computedToward;o(A,i,x),r(A,A);var I=Math.exp(this.computedRadius[0]),P=this.computedAngle[0],S=this.computedAngle[1],E=Math.cos(P),z=Math.sin(P),D=Math.cos(S),j=Math.sin(S),V=this.computedCenter,Z=E*D,Q=z*D,X=j,$=-E*j,re=-z*j,H=D,N=this.computedEye,U=this.computedMatrix;for(b=0;b<3;++b){var te=Z*x[b]+Q*A[b]+X*i[b];U[4*b+1]=$*x[b]+re*A[b]+H*i[b],U[4*b+2]=te,U[4*b+3]=0}var B=U[1],K=U[5],J=U[9],ee=U[2],ne=U[6],se=U[10],oe=K*se-J*ne,me=J*ee-B*se,ce=B*ne-K*ee,ye=c(oe,me,ce);for(oe/=ye,me/=ye,ce/=ye,U[0]=oe,U[4]=me,U[8]=ce,b=0;b<3;++b)N[b]=V[b]+U[2+4*b]*I;for(b=0;b<3;++b){k=0;for(var Se=0;Se<3;++Se)k+=U[b+4*Se]*N[Se];U[12+b]=-k}U[15]=1},s.getMatrix=function(u,i){this.recalcMatrix(u);var x=this.computedMatrix;if(i){for(var f=0;f<16;++f)i[f]=x[f];return i}return x};var p=[0,0,0];s.rotate=function(u,i,x,f){if(this.angle.move(u,i,x),f){this.recalcMatrix(u);var _=this.computedMatrix;p[0]=_[2],p[1]=_[6],p[2]=_[10];for(var b=this.computedUp,T=this.computedRight,k=this.computedToward,L=0;L<3;++L)_[4*L]=b[L],_[4*L+1]=T[L],_[4*L+2]=k[L];for(n(_,_,f,p),L=0;L<3;++L)b[L]=_[4*L],T[L]=_[4*L+1];this.up.set(u,b[0],b[1],b[2]),this.right.set(u,T[0],T[1],T[2])}},s.pan=function(u,i,x,f){i=i||0,x=x||0,f=f||0,this.recalcMatrix(u);var _=this.computedMatrix,b=(Math.exp(this.computedRadius[0]),_[1]),T=_[5],k=_[9],L=c(b,T,k);b/=L,T/=L,k/=L;var A=_[0],I=_[4],P=_[8],S=A*b+I*T+P*k,E=c(A-=b*S,I-=T*S,P-=k*S),z=(A/=E)*i+b*x,D=(I/=E)*i+T*x,j=(P/=E)*i+k*x;this.center.move(u,z,D,j);var V=Math.exp(this.computedRadius[0]);V=Math.max(1e-4,V+f),this.radius.set(u,Math.log(V))},s.translate=function(u,i,x,f){this.center.move(u,i||0,x||0,f||0)},s.setMatrix=function(u,i,x,f){var _=1;typeof x=="number"&&(_=0|x),(_<0||_>3)&&(_=1);var b=(_+2)%3;i||(this.recalcMatrix(u),i=this.computedMatrix);var T=i[_],k=i[_+4],L=i[_+8];if(f){var A=Math.abs(T),I=Math.abs(k),P=Math.abs(L),S=Math.max(A,I,P);A===S?(T=T<0?-1:1,k=L=0):P===S?(L=L<0?-1:1,T=k=0):(k=k<0?-1:1,T=L=0)}else{var E=c(T,k,L);T/=E,k/=E,L/=E}var z,D,j=i[b],V=i[b+4],Z=i[b+8],Q=j*T+V*k+Z*L,X=c(j-=T*Q,V-=k*Q,Z-=L*Q),$=k*(Z/=X)-L*(V/=X),re=L*(j/=X)-T*Z,H=T*V-k*j,N=c($,re,H);if($/=N,re/=N,H/=N,this.center.jump(u,le,ve,Me),this.radius.idle(u),this.up.jump(u,T,k,L),this.right.jump(u,j,V,Z),_===2){var U=i[1],te=i[5],B=i[9],K=U*j+te*V+B*Z,J=U*$+te*re+B*H;z=oe<0?-Math.PI/2:Math.PI/2,D=Math.atan2(J,K)}else{var ee=i[2],ne=i[6],se=i[10],oe=ee*T+ne*k+se*L,me=ee*j+ne*V+se*Z,ce=ee*$+ne*re+se*H;z=Math.asin(a(oe)),D=Math.atan2(ce,me)}this.angle.jump(u,D,z),this.recalcMatrix(u);var ye=i[2],Se=i[6],fe=i[10],ge=this.computedMatrix;t(ge,i);var Te=ge[15],le=ge[12]/Te,ve=ge[13]/Te,Me=ge[14]/Te,we=Math.exp(this.computedRadius[0]);this.center.jump(u,le-ye*we,ve-Se*we,Me-fe*we)},s.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},s.idle=function(u){this.center.idle(u),this.up.idle(u),this.right.idle(u),this.radius.idle(u),this.angle.idle(u)},s.flush=function(u){this.center.flush(u),this.up.flush(u),this.right.flush(u),this.radius.flush(u),this.angle.flush(u)},s.setDistance=function(u,i){i>0&&this.radius.set(u,Math.log(i))},s.lookAt=function(u,i,x,f){this.recalcMatrix(u),i=i||this.computedEye,x=x||this.computedCenter;var _=(f=f||this.computedUp)[0],b=f[1],T=f[2],k=c(_,b,T);if(!(k<1e-6)){_/=k,b/=k,T/=k;var L=i[0]-x[0],A=i[1]-x[1],I=i[2]-x[2],P=c(L,A,I);if(!(P<1e-6)){L/=P,A/=P,I/=P;var S=this.computedRight,E=S[0],z=S[1],D=S[2],j=_*E+b*z+T*D,V=c(E-=j*_,z-=j*b,D-=j*T);if(!(V<.01&&(V=c(E=b*I-T*A,z=T*L-_*I,D=_*A-b*L))<1e-6)){E/=V,z/=V,D/=V,this.up.set(u,_,b,T),this.right.set(u,E,z,D),this.center.set(u,x[0],x[1],x[2]),this.radius.set(u,Math.log(P));var Z=b*D-T*z,Q=T*E-_*D,X=_*z-b*E,$=c(Z,Q,X),re=_*L+b*A+T*I,H=E*L+z*A+D*I,N=(Z/=$)*L+(Q/=$)*A+(X/=$)*I,U=Math.asin(a(re)),te=Math.atan2(N,H),B=this.angle._state,K=B[B.length-1],J=B[B.length-2];K%=2*Math.PI;var ee=Math.abs(K+2*Math.PI-te),ne=Math.abs(K-te),se=Math.abs(K-2*Math.PI-te);ee<ne&&(K+=2*Math.PI),se<ne&&(K-=2*Math.PI),this.angle.jump(this.angle.lastT(),K,J),this.angle.set(u,te,U)}}}}},{"filtered-vector":68,"gl-mat4/invert":98,"gl-mat4/rotate":103,"gl-vec3/cross":157,"gl-vec3/dot":162,"gl-vec3/normalize":179}],306:[function(v,w,y){w.exports=function(t,n,o){var r=t*n,g=e*t,c=g-(g-t),a=t-c,h=e*n,l=h-(h-n),s=n-l,p=a*s-(r-c*l-a*l-c*s);return o?(o[0]=p,o[1]=r,o):[p,r]};var e=+(Math.pow(2,27)+1)},{}],307:[function(v,w,y){w.exports=function(e,t,n){var o=e+t,r=o-e,g=t-r,c=e-(o-r);return n?(n[0]=c+g,n[1]=o,n):[c+g,o]}},{}],308:[function(v,w,y){(function(e){(function(){var t=v("bit-twiddle"),n=v("dup"),o=v("buffer").Buffer;e.__TYPEDARRAY_POOL||(e.__TYPEDARRAY_POOL={UINT8:n([32,0]),UINT16:n([32,0]),UINT32:n([32,0]),BIGUINT64:n([32,0]),INT8:n([32,0]),INT16:n([32,0]),INT32:n([32,0]),BIGINT64:n([32,0]),FLOAT:n([32,0]),DOUBLE:n([32,0]),DATA:n([32,0]),UINT8C:n([32,0]),BUFFER:n([32,0])});var r=typeof Uint8ClampedArray<"u",g=typeof BigUint64Array<"u",c=typeof BigInt64Array<"u",a=e.__TYPEDARRAY_POOL;a.UINT8C||(a.UINT8C=n([32,0])),a.BIGUINT64||(a.BIGUINT64=n([32,0])),a.BIGINT64||(a.BIGINT64=n([32,0])),a.BUFFER||(a.BUFFER=n([32,0]));var h=a.DATA,l=a.BUFFER;function s(E){if(E){var z=E.length||E.byteLength,D=t.log2(z);h[D].push(E)}}function p(E){E=t.nextPow2(E);var z=t.log2(E),D=h[z];return D.length>0?D.pop():new ArrayBuffer(E)}function u(E){return new Uint8Array(p(E),0,E)}function i(E){return new Uint16Array(p(2*E),0,E)}function x(E){return new Uint32Array(p(4*E),0,E)}function f(E){return new Int8Array(p(E),0,E)}function _(E){return new Int16Array(p(2*E),0,E)}function b(E){return new Int32Array(p(4*E),0,E)}function T(E){return new Float32Array(p(4*E),0,E)}function k(E){return new Float64Array(p(8*E),0,E)}function L(E){return r?new Uint8ClampedArray(p(E),0,E):u(E)}function A(E){return g?new BigUint64Array(p(8*E),0,E):null}function I(E){return c?new BigInt64Array(p(8*E),0,E):null}function P(E){return new DataView(p(E),0,E)}function S(E){E=t.nextPow2(E);var z=t.log2(E),D=l[z];return D.length>0?D.pop():new o(E)}y.free=function(E){if(o.isBuffer(E))l[t.log2(E.length)].push(E);else{if(Object.prototype.toString.call(E)!=="[object ArrayBuffer]"&&(E=E.buffer),!E)return;var z=E.length||E.byteLength,D=0|t.log2(z);h[D].push(E)}},y.freeUint8=y.freeUint16=y.freeUint32=y.freeBigUint64=y.freeInt8=y.freeInt16=y.freeInt32=y.freeBigInt64=y.freeFloat32=y.freeFloat=y.freeFloat64=y.freeDouble=y.freeUint8Clamped=y.freeDataView=function(E){s(E.buffer)},y.freeArrayBuffer=s,y.freeBuffer=function(E){l[t.log2(E.length)].push(E)},y.malloc=function(E,z){if(z===void 0||z==="arraybuffer")return p(E);switch(z){case"uint8":return u(E);case"uint16":return i(E);case"uint32":return x(E);case"int8":return f(E);case"int16":return _(E);case"int32":return b(E);case"float":case"float32":return T(E);case"double":case"float64":return k(E);case"uint8_clamped":return L(E);case"bigint64":return I(E);case"biguint64":return A(E);case"buffer":return S(E);case"data":case"dataview":return P(E);default:return null}return null},y.mallocArrayBuffer=p,y.mallocUint8=u,y.mallocUint16=i,y.mallocUint32=x,y.mallocInt8=f,y.mallocInt16=_,y.mallocInt32=b,y.mallocFloat32=y.mallocFloat=T,y.mallocFloat64=y.mallocDouble=k,y.mallocUint8Clamped=L,y.mallocBigUint64=A,y.mallocBigInt64=I,y.mallocDataView=P,y.mallocBuffer=S,y.clearCache=function(){for(var E=0;E<32;++E)a.UINT8[E].length=0,a.UINT16[E].length=0,a.UINT32[E].length=0,a.INT8[E].length=0,a.INT16[E].length=0,a.INT32[E].length=0,a.FLOAT[E].length=0,a.DOUBLE[E].length=0,a.BIGUINT64[E].length=0,a.BIGINT64[E].length=0,a.UINT8C[E].length=0,h[E].length=0,l[E].length=0}}).call(this)}).call(this,d!==void 0?d:typeof self<"u"?self:typeof window<"u"?window:{})},{"bit-twiddle":32,buffer:3,dup:65}],309:[function(v,w,y){function e(n){this.roots=new Array(n),this.ranks=new Array(n);for(var o=0;o<n;++o)this.roots[o]=o,this.ranks[o]=0}w.exports=e;var t=e.prototype;Object.defineProperty(t,"length",{get:function(){return this.roots.length}}),t.makeSet=function(){var n=this.roots.length;return this.roots.push(n),this.ranks.push(0),n},t.find=function(n){for(var o=n,r=this.roots;r[n]!==n;)n=r[n];for(;r[o]!==n;){var g=r[o];r[o]=n,o=g}return n},t.link=function(n,o){var r=this.find(n),g=this.find(o);if(r!==g){var c=this.ranks,a=this.roots,h=c[r],l=c[g];h<l?a[r]=g:l<h?a[g]=r:(a[g]=r,++c[r])}}},{}],310:[function(v,w,y){w.exports=function(e,t,n){return e.length===0?e:t?(n||e.sort(t),function(o,r){for(var g=1,c=o.length,a=o[0],h=o[0],l=1;l<c;++l)if(h=a,r(a=o[l],h)){if(l===g){g++;continue}o[g++]=a}return o.length=g,o}(e,t)):(n||e.sort(),function(o){for(var r=1,g=o.length,c=o[0],a=o[0],h=1;h<g;++h,a=c)if(a=c,(c=o[h])!==a){if(h===r){r++;continue}o[r++]=c}return o.length=r,o}(e))}},{}],311:[function(v,w,y){w.exports=function(o,r){return typeof r=="object"&&r!==null||(r={}),e(o,r.canvas||t,r.context||n,r)};var e=v("./lib/vtext"),t=null,n=null;typeof document<"u"&&((t=document.createElement("canvas")).width=8192,t.height=1024,n=t.getContext("2d"))},{"./lib/vtext":312}],312:[function(v,w,y){w.exports=function(s,p,u,i){var x=64,f=1.25,_={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};return i&&(i.size&&i.size>0&&(x=i.size),i.lineSpacing&&i.lineSpacing>0&&(f=i.lineSpacing),i.styletags&&i.styletags.breaklines&&(_.breaklines=!!i.styletags.breaklines),i.styletags&&i.styletags.bolds&&(_.bolds=!!i.styletags.bolds),i.styletags&&i.styletags.italics&&(_.italics=!!i.styletags.italics),i.styletags&&i.styletags.subscripts&&(_.subscripts=!!i.styletags.subscripts),i.styletags&&i.styletags.superscripts&&(_.superscripts=!!i.styletags.superscripts)),u.font=[i.fontStyle,i.fontVariant,i.fontWeight,x+"px",i.font].filter(function(b){return b}).join(" "),u.textAlign="start",u.textBaseline="alphabetic",u.direction="ltr",l(function(b,T,k,L,A,I){k=k.replace(/\n/g,""),k=I.breaklines===!0?k.replace(/\<br\>/g,`
`):k.replace(/\<br\>/g," ");var P="",S=[];for(j=0;j<k.length;++j)S[j]=P;I.bolds===!0&&(S=c("b","b|",k,S)),I.italics===!0&&(S=c("i","i|",k,S)),I.superscripts===!0&&(S=c("sup","+1",k,S)),I.subscripts===!0&&(S=c("sub","-1",k,S));var E=[],z="";for(j=0;j<k.length;++j)S[j]!==null&&(z+=k[j],E.push(S[j]));var D,j,V,Z,Q,X=z.split(`
`),$=X.length,re=Math.round(A*L),H=L,N=2*L,U=0,te=$*re+N;b.height<te&&(b.height=te),T.fillStyle="#000",T.fillRect(0,0,b.width,b.height),T.fillStyle="#fff";var B=0,K="";function J(){if(K!==""){var Se=T.measureText(K).width;T.fillText(K,H+V,N+Z),V+=Se}}function ee(){return Math.round(Q)+"px "}function ne(Se,fe){var ge=""+T.font;if(I.subscripts===!0){var Te=Se.indexOf("-"),le=fe.indexOf("-"),ve=Te>-1?parseInt(Se[1+Te]):0,Me=le>-1?parseInt(fe[1+le]):0;ve!==Me&&(ge=ge.replace(ee(),"?px "),Q*=Math.pow(.75,Me-ve),ge=ge.replace("?px ",ee())),Z+=.25*re*(Me-ve)}if(I.superscripts===!0){var we=Se.indexOf("+"),de=fe.indexOf("+"),Ie=we>-1?parseInt(Se[1+we]):0,De=de>-1?parseInt(fe[1+de]):0;Ie!==De&&(ge=ge.replace(ee(),"?px "),Q*=Math.pow(.75,De-Ie),ge=ge.replace("?px ",ee())),Z-=.25*re*(De-Ie)}if(I.bolds===!0){var Oe=Se.indexOf("b|")>-1,Ve=fe.indexOf("b|")>-1;!Oe&&Ve&&(ge=Fe?ge.replace("italic ","italic bold "):"bold "+ge),Oe&&!Ve&&(ge=ge.replace("bold ",""))}if(I.italics===!0){var Fe=Se.indexOf("i|")>-1,ze=fe.indexOf("i|")>-1;!Fe&&ze&&(ge="italic "+ge),Fe&&!ze&&(ge=ge.replace("italic ",""))}T.font=ge}for(D=0;D<$;++D){var se=X[D]+`
`;for(V=0,Z=D*re,Q=L,K="",j=0;j<se.length;++j){var oe=j+B<E.length?E[j+B]:E[E.length-1];P===oe?K+=se[j]:(J(),K=se[j],oe!==void 0&&(ne(P,oe),P=oe))}J(),B+=se.length;var me=0|Math.round(V+2*H);U<me&&(U=me)}var ce=U,ye=N+re*$;return t(T.getImageData(0,0,ce,ye).data,[ye,ce,4]).pick(-1,-1,0).transpose(1,0)}(p,u,s,x,f,_),i,x)},w.exports.processPixels=l;var e=v("surface-nets"),t=v("ndarray"),n=v("simplify-planar-graph"),o=v("clean-pslg"),r=v("cdt2d"),g=v("planar-graph-to-polyline");function c(s,p,u,i){for(var x="<"+s+">",f="</"+s+">",_=x.length,b=f.length,T=p[0]==="+"||p[0]==="-",k=0,L=-b;k>-1&&(k=u.indexOf(x,k))!==-1&&(L=u.indexOf(f,k+_))!==-1&&!(L<=k);){for(var A=k;A<L+b;++A)if(A<k+_||A>=L)i[A]=null,u=u.substr(0,A)+" "+u.substr(A+1);else if(i[A]!==null){var I=i[A].indexOf(p[0]);I===-1?i[A]+=p:T&&(i[A]=i[A].substr(0,I+1)+(1+parseInt(i[A][I+1]))+i[A].substr(I+2))}var P=k+_,S=u.substr(P,L-P).indexOf(x);k=S!==-1?S:L+b}return i}function a(s,p){var u=e(s,128);return p?n(u.cells,u.positions,.25):{edges:u.cells,positions:u.positions}}function h(s,p,u,i){var x=a(s,i),f=function(D,j,V){for(var Z=j.textAlign||"start",Q=j.textBaseline||"alphabetic",X=[1<<30,1<<30],$=[0,0],re=D.length,H=0;H<re;++H)for(var N=D[H],U=0;U<2;++U)X[U]=0|Math.min(X[U],N[U]),$[U]=0|Math.max($[U],N[U]);var te=0;switch(Z){case"center":te=-.5*(X[0]+$[0]);break;case"right":case"end":te=-$[0];break;case"left":case"start":te=-X[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+Z+"'")}var B=0;switch(Q){case"hanging":case"top":B=-X[1];break;case"middle":B=-.5*(X[1]+$[1]);break;case"alphabetic":case"ideographic":B=-3*V;break;case"bottom":B=-$[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+Q+"'")}var K=1/V;return"lineHeight"in j?K*=+j.lineHeight:"width"in j?K=j.width/($[0]-X[0]):"height"in j&&(K=j.height/($[1]-X[1])),D.map(function(J){return[K*(J[0]+te),K*(J[1]+B)]})}(x.positions,p,u),_=x.edges,b=p.orientation==="ccw";if(o(f,_),p.polygons||p.polygon||p.polyline){for(var T=g(_,f),k=new Array(T.length),L=0;L<T.length;++L){for(var A=T[L],I=new Array(A.length),P=0;P<A.length;++P){for(var S=A[P],E=new Array(S.length),z=0;z<S.length;++z)E[z]=f[S[z]].slice();b&&E.reverse(),I[P]=E}k[L]=I}return k}return p.triangles||p.triangulate||p.triangle?{cells:r(f,_,{delaunay:!1,exterior:!1,interior:!0}),positions:f}:{edges:_,positions:f}}function l(s,p,u){try{return h(s,p,u,!0)}catch{}try{return h(s,p,u,!1)}catch{}return p.polygons||p.polyline||p.polygon?[]:p.triangles||p.triangulate||p.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}},{cdt2d:42,"clean-pslg":50,ndarray:259,"planar-graph-to-polyline":268,"simplify-planar-graph":297,"surface-nets":302}],313:[function(v,w,y){(function(){if(typeof ses>"u"||!ses.ok||ses.ok()){typeof ses<"u"&&(ses.weakMapPermitHostObjects=x);var e=!1;if(typeof WeakMap=="function"){var t=WeakMap;if(!(typeof navigator<"u"&&/Firefox/.test(navigator.userAgent))){var n=new t,o=Object.freeze({});if(n.set(o,1),n.get(o)===1)return void(w.exports=WeakMap);e=!0}}var r=Object.getOwnPropertyNames,g=Object.defineProperty,c=Object.isExtensible,a="weakmap:ident:"+Math.random()+"___";if(typeof crypto<"u"&&typeof crypto.getRandomValues=="function"&&typeof ArrayBuffer=="function"&&typeof Uint8Array=="function"){var h=new ArrayBuffer(25),l=new Uint8Array(h);crypto.getRandomValues(l),a="weakmap:rand:"+Array.prototype.map.call(l,function(k){return(k%36).toString(36)}).join("")+"___"}if(g(Object,"getOwnPropertyNames",{value:function(k){return r(k).filter(f)}}),"getPropertyNames"in Object){var s=Object.getPropertyNames;g(Object,"getPropertyNames",{value:function(k){return s(k).filter(f)}})}(function(){var k=Object.freeze;g(Object,"freeze",{value:function(I){return _(I),k(I)}});var L=Object.seal;g(Object,"seal",{value:function(I){return _(I),L(I)}});var A=Object.preventExtensions;g(Object,"preventExtensions",{value:function(I){return _(I),A(I)}})})();var p=!1,u=0,i=function(){this instanceof i||T();var k=[],L=[],A=u++;return Object.create(i.prototype,{get___:{value:b(function(I,P){var S,E=_(I);return E?A in E?E[A]:P:(S=k.indexOf(I))>=0?L[S]:P})},has___:{value:b(function(I){var P=_(I);return P?A in P:k.indexOf(I)>=0})},set___:{value:b(function(I,P){var S,E=_(I);return E?E[A]=P:(S=k.indexOf(I))>=0?L[S]=P:(S=k.length,L[S]=P,k[S]=I),this})},delete___:{value:b(function(I){var P,S,E=_(I);return E?A in E&&delete E[A]:!((P=k.indexOf(I))<0)&&(S=k.length-1,k[P]=void 0,L[P]=L[S],k[P]=k[S],k.length=S,L.length=S,!0)})}})};i.prototype=Object.create(Object.prototype,{get:{value:function(k,L){return this.get___(k,L)},writable:!0,configurable:!0},has:{value:function(k){return this.has___(k)},writable:!0,configurable:!0},set:{value:function(k,L){return this.set___(k,L)},writable:!0,configurable:!0},delete:{value:function(k){return this.delete___(k)},writable:!0,configurable:!0}}),typeof t=="function"?function(){function k(){this instanceof i||T();var L,A=new t,I=void 0,P=!1;return L=e?function(S,E){return A.set(S,E),A.has(S)||(I||(I=new i),I.set(S,E)),this}:function(S,E){if(P)try{A.set(S,E)}catch{I||(I=new i),I.set___(S,E)}else A.set(S,E);return this},Object.create(i.prototype,{get___:{value:b(function(S,E){return I?A.has(S)?A.get(S):I.get___(S,E):A.get(S,E)})},has___:{value:b(function(S){return A.has(S)||!!I&&I.has___(S)})},set___:{value:b(L)},delete___:{value:b(function(S){var E=!!A.delete(S);return I&&I.delete___(S)||E})},permitHostObjects___:{value:b(function(S){if(S!==x)throw new Error("bogus call to permitHostObjects___");P=!0})}})}e&&typeof Proxy<"u"&&(Proxy=void 0),k.prototype=i.prototype,w.exports=k,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():(typeof Proxy<"u"&&(Proxy=void 0),w.exports=i)}function x(k){k.permitHostObjects___&&k.permitHostObjects___(x)}function f(k){return!(k.substr(0,8)=="weakmap:"&&k.substr(k.length-3)==="___")}function _(k){if(k!==Object(k))throw new TypeError("Not an object: "+k);var L=k[a];if(L&&L.key===k)return L;if(c(k)){L={key:k};try{return g(k,a,{value:L,writable:!1,enumerable:!1,configurable:!1}),L}catch{return}}}function b(k){return k.prototype=null,Object.freeze(k)}function T(){p||typeof console>"u"||(p=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}})()},{}],314:[function(v,w,y){var e=v("./hidden-store.js");w.exports=function(){var t={};return function(n){if((typeof n!="object"||n===null)&&typeof n!="function")throw new Error("Weakmap-shim: Key must be object");var o=n.valueOf(t);return o&&o.identity===t?o:e(n,t)}}},{"./hidden-store.js":315}],315:[function(v,w,y){w.exports=function(e,t){var n={identity:t},o=e.valueOf;return Object.defineProperty(e,"valueOf",{value:function(r){return r!==t?o.apply(this,arguments):n},writable:!0}),n}},{}],316:[function(v,w,y){var e=v("./create-store.js");w.exports=function(){var t=e();return{get:function(n,o){var r=t(n);return r.hasOwnProperty("value")?r.value:o},set:function(n,o){return t(n).value=o,this},has:function(n){return"value"in t(n)},delete:function(n){return delete t(n).value}}}},{"./create-store.js":314}],317:[function(v,w,y){var e,t=function(){return function(n,o,r,g,c,a){var h=n[0],l=r[0],s=[0],p=l;g|=0;var u=0,i=l;for(u=0;u<h;++u){var x=o[g]-a,f=o[g+p]-a;x>=0!=f>=0&&c.push(s[0]+.5+.5*(x+f)/(x-f)),g+=i,++s[0]}}};w.exports=(e={funcName:"zeroCrossings"},function(n){var o={};return function(r,g,c){var a=r.dtype,h=r.order,l=[a,h.join()].join(),s=o[l];return s||(o[l]=s=n([a,h])),s(r.shape.slice(0),r.data,r.stride,0|r.offset,g,c)}}(t.bind(void 0,e)))},{}],318:[function(v,w,y){w.exports=function(t,n){var o=[];return n=+n||0,e(t.hi(t.shape[0]-1),o,n),o};var e=v("./lib/zc-core")},{"./lib/zc-core":317}]},{},[6])(6)})}).call(this)}).call(this,typeof Ka<"u"?Ka:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[27])(27)})})(bm);const M0=ex(bm.exports);function Fh(Ee){return[null,void 0,!1].indexOf(Ee)!==-1}function tx(Ee){return Ee&&Ee.__esModule&&Object.prototype.hasOwnProperty.call(Ee,"default")?Ee.default:Ee}function _m(Ee){var Ge={exports:{}};return Ee(Ge,Ge.exports),Ge.exports}var A0=_m(function(Ee,Ge){Ee.exports=function(){var m=["decimals","thousand","mark","prefix","suffix","encoder","decoder","negativeBefore","negative","edit","undo"];function G(g){return g.split("").reverse().join("")}function Y(g,c){return g.substring(0,c.length)===c}function d(g,c){return g.slice(-1*c.length)===c}function v(g,c,a){if((g[c]||g[a])&&g[c]===g[a])throw new Error(c)}function w(g){return typeof g=="number"&&isFinite(g)}function y(g,c){return g=g.toString().split("e"),(+((g=(g=Math.round(+(g[0]+"e"+(g[1]?+g[1]+c:c)))).toString().split("e"))[0]+"e"+(g[1]?+g[1]-c:-c))).toFixed(c)}function e(g,c,a,h,l,s,p,u,i,x,f,_){var b,T,k,L=_,A="",I="";return s&&(_=s(_)),!!w(_)&&(g!==!1&&parseFloat(_.toFixed(g))===0&&(_=0),_<0&&(b=!0,_=Math.abs(_)),g!==!1&&(_=y(_,g)),(_=_.toString()).indexOf(".")!==-1?(k=(T=_.split("."))[0],a&&(A=a+T[1])):k=_,c&&(k=G(k).match(/.{1,3}/g),k=G(k.join(G(c)))),b&&u&&(I+=u),h&&(I+=h),b&&i&&(I+=i),I+=k,I+=A,l&&(I+=l),x&&(I=x(I,L)),I)}function t(g,c,a,h,l,s,p,u,i,x,f,_){var b,T="";return f&&(_=f(_)),!(!_||typeof _!="string")&&(u&&Y(_,u)&&(_=_.replace(u,""),b=!0),h&&Y(_,h)&&(_=_.replace(h,"")),i&&Y(_,i)&&(_=_.replace(i,""),b=!0),l&&d(_,l)&&(_=_.slice(0,-1*l.length)),c&&(_=_.split(c).join("")),a&&(_=_.replace(a,".")),b&&(T+="-"),(T=(T+=_).replace(/[^0-9\.\-.]/g,""))!==""&&(T=Number(T),p&&(T=p(T)),!!w(T)&&T))}function n(g){var c,a,h,l={};for(g.suffix===void 0&&(g.suffix=g.postfix),c=0;c<m.length;c+=1)if((h=g[a=m[c]])===void 0)a!=="negative"||l.negativeBefore?a==="mark"&&l.thousand!=="."?l[a]=".":l[a]=!1:l[a]="-";else if(a==="decimals"){if(!(h>=0&&h<8))throw new Error(a);l[a]=h}else if(a==="encoder"||a==="decoder"||a==="edit"||a==="undo"){if(typeof h!="function")throw new Error(a);l[a]=h}else{if(typeof h!="string")throw new Error(a);l[a]=h}return v(l,"mark","thousand"),v(l,"prefix","negative"),v(l,"prefix","negativeBefore"),l}function o(g,c,a){var h,l=[];for(h=0;h<m.length;h+=1)l.push(g[m[h]]);return l.push(a),c.apply("",l)}function r(g){if(!(this instanceof r))return new r(g);typeof g=="object"&&(g=n(g),this.to=function(c){return o(g,e,c)},this.from=function(c){return o(g,t,c)})}return r}()}),rx=tx(_m(function(Ee,Ge){(function(m){function G(we){return Y(we)&&typeof we.from=="function"}function Y(we){return typeof we=="object"&&typeof we.to=="function"}function d(we){we.parentElement.removeChild(we)}function v(we){return we!=null}function w(we){we.preventDefault()}function y(we){return we.filter(function(de){return!this[de]&&(this[de]=!0)},{})}function e(we,de){return Math.round(we/de)*de}function t(we,de){var Ie=we.getBoundingClientRect(),De=we.ownerDocument,Oe=De.documentElement,Ve=s(De);return/webkit.*Chrome.*Mobile/i.test(navigator.userAgent)&&(Ve.x=0),de?Ie.top+Ve.y-Oe.clientTop:Ie.left+Ve.x-Oe.clientLeft}function n(we){return typeof we=="number"&&!isNaN(we)&&isFinite(we)}function o(we,de,Ie){Ie>0&&(a(we,de),setTimeout(function(){h(we,de)},Ie))}function r(we){return Math.max(Math.min(we,100),0)}function g(we){return Array.isArray(we)?we:[we]}function c(we){var de=(we=String(we)).split(".");return de.length>1?de[1].length:0}function a(we,de){we.classList&&!/\s/.test(de)?we.classList.add(de):we.className+=" "+de}function h(we,de){we.classList&&!/\s/.test(de)?we.classList.remove(de):we.className=we.className.replace(new RegExp("(^|\\b)"+de.split(" ").join("|")+"(\\b|$)","gi")," ")}function l(we,de){return we.classList?we.classList.contains(de):new RegExp("\\b"+de+"\\b").test(we.className)}function s(we){var de=window.pageXOffset!==void 0,Ie=(we.compatMode||"")==="CSS1Compat";return{x:de?window.pageXOffset:Ie?we.documentElement.scrollLeft:we.body.scrollLeft,y:de?window.pageYOffset:Ie?we.documentElement.scrollTop:we.body.scrollTop}}function p(){return window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"}}function u(){var we=!1;try{var de=Object.defineProperty({},"passive",{get:function(){we=!0}});window.addEventListener("test",null,de)}catch{}return we}function i(){return window.CSS&&CSS.supports&&CSS.supports("touch-action","none")}function x(we,de){return 100/(de-we)}function f(we,de,Ie){return 100*de/(we[Ie+1]-we[Ie])}function _(we,de){return f(we,we[0]<0?de+Math.abs(we[0]):de-we[0],0)}function b(we,de){return de*(we[1]-we[0])/100+we[0]}function T(we,de){for(var Ie=1;we>=de[Ie];)Ie+=1;return Ie}function k(we,de,Ie){if(Ie>=we.slice(-1)[0])return 100;var De=T(Ie,we),Oe=we[De-1],Ve=we[De],Fe=de[De-1],ze=de[De];return Fe+_([Oe,Ve],Ie)/x(Fe,ze)}function L(we,de,Ie){if(Ie>=100)return we.slice(-1)[0];var De=T(Ie,de),Oe=we[De-1],Ve=we[De],Fe=de[De-1];return b([Oe,Ve],(Ie-Fe)*x(Fe,de[De]))}function A(we,de,Ie,De){if(De===100)return De;var Oe=T(De,we),Ve=we[Oe-1],Fe=we[Oe];return Ie?De-Ve>(Fe-Ve)/2?Fe:Ve:de[Oe-1]?we[Oe-1]+e(De-we[Oe-1],de[Oe-1]):De}var I,P;m.PipsMode=void 0,(P=m.PipsMode||(m.PipsMode={})).Range="range",P.Steps="steps",P.Positions="positions",P.Count="count",P.Values="values",m.PipsType=void 0,(I=m.PipsType||(m.PipsType={}))[I.None=-1]="None",I[I.NoValue=0]="NoValue",I[I.LargeValue=1]="LargeValue",I[I.SmallValue=2]="SmallValue";var S=function(){function we(de,Ie,De){var Oe;this.xPct=[],this.xVal=[],this.xSteps=[],this.xNumSteps=[],this.xHighestCompleteStep=[],this.xSteps=[De||!1],this.xNumSteps=[!1],this.snap=Ie;var Ve=[];for(Object.keys(de).forEach(function(Fe){Ve.push([g(de[Fe]),Fe])}),Ve.sort(function(Fe,ze){return Fe[0][0]-ze[0][0]}),Oe=0;Oe<Ve.length;Oe++)this.handleEntryPoint(Ve[Oe][1],Ve[Oe][0]);for(this.xNumSteps=this.xSteps.slice(0),Oe=0;Oe<this.xNumSteps.length;Oe++)this.handleStepPoint(Oe,this.xNumSteps[Oe])}return we.prototype.getDistance=function(de){for(var Ie=[],De=0;De<this.xNumSteps.length-1;De++)Ie[De]=f(this.xVal,de,De);return Ie},we.prototype.getAbsoluteDistance=function(de,Ie,De){var Oe,Ve=0;if(de<this.xPct[this.xPct.length-1])for(;de>this.xPct[Ve+1];)Ve++;else de===this.xPct[this.xPct.length-1]&&(Ve=this.xPct.length-2);De||de!==this.xPct[Ve+1]||Ve++,Ie===null&&(Ie=[]);var Fe=1,ze=Ie[Ve],Re=0,We=0,$e=0,at=0;for(Oe=De?(de-this.xPct[Ve])/(this.xPct[Ve+1]-this.xPct[Ve]):(this.xPct[Ve+1]-de)/(this.xPct[Ve+1]-this.xPct[Ve]);ze>0;)Re=this.xPct[Ve+1+at]-this.xPct[Ve+at],Ie[Ve+at]*Fe+100-100*Oe>100?(We=Re*Oe,Fe=(ze-100*Oe)/Ie[Ve+at],Oe=1):(We=Ie[Ve+at]*Re/100*Fe,Fe=0),De?($e-=We,this.xPct.length+at>=1&&at--):($e+=We,this.xPct.length-at>=1&&at++),ze=Ie[Ve+at]*Fe;return de+$e},we.prototype.toStepping=function(de){return de=k(this.xVal,this.xPct,de)},we.prototype.fromStepping=function(de){return L(this.xVal,this.xPct,de)},we.prototype.getStep=function(de){return de=A(this.xPct,this.xSteps,this.snap,de)},we.prototype.getDefaultStep=function(de,Ie,De){var Oe=T(de,this.xPct);return(de===100||Ie&&de===this.xPct[Oe-1])&&(Oe=Math.max(Oe-1,1)),(this.xVal[Oe]-this.xVal[Oe-1])/De},we.prototype.getNearbySteps=function(de){var Ie=T(de,this.xPct);return{stepBefore:{startValue:this.xVal[Ie-2],step:this.xNumSteps[Ie-2],highestStep:this.xHighestCompleteStep[Ie-2]},thisStep:{startValue:this.xVal[Ie-1],step:this.xNumSteps[Ie-1],highestStep:this.xHighestCompleteStep[Ie-1]},stepAfter:{startValue:this.xVal[Ie],step:this.xNumSteps[Ie],highestStep:this.xHighestCompleteStep[Ie]}}},we.prototype.countStepDecimals=function(){var de=this.xNumSteps.map(c);return Math.max.apply(null,de)},we.prototype.hasNoSize=function(){return this.xVal[0]===this.xVal[this.xVal.length-1]},we.prototype.convert=function(de){return this.getStep(this.toStepping(de))},we.prototype.handleEntryPoint=function(de,Ie){var De;if(!n(De=de==="min"?0:de==="max"?100:parseFloat(de))||!n(Ie[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");this.xPct.push(De),this.xVal.push(Ie[0]);var Oe=Number(Ie[1]);De?this.xSteps.push(!isNaN(Oe)&&Oe):isNaN(Oe)||(this.xSteps[0]=Oe),this.xHighestCompleteStep.push(0)},we.prototype.handleStepPoint=function(de,Ie){if(Ie)if(this.xVal[de]!==this.xVal[de+1]){this.xSteps[de]=f([this.xVal[de],this.xVal[de+1]],Ie,0)/x(this.xPct[de],this.xPct[de+1]);var De=(this.xVal[de+1]-this.xVal[de])/this.xNumSteps[de],Oe=Math.ceil(Number(De.toFixed(3))-1),Ve=this.xVal[de]+this.xNumSteps[de]*Oe;this.xHighestCompleteStep[de]=Ve}else this.xSteps[de]=this.xHighestCompleteStep[de]=this.xVal[de]},we}(),E={to:function(we){return we===void 0?"":we.toFixed(2)},from:Number},z={target:"target",base:"base",origin:"origin",handle:"handle",handleLower:"handle-lower",handleUpper:"handle-upper",touchArea:"touch-area",horizontal:"horizontal",vertical:"vertical",background:"background",connect:"connect",connects:"connects",ltr:"ltr",rtl:"rtl",textDirectionLtr:"txt-dir-ltr",textDirectionRtl:"txt-dir-rtl",draggable:"draggable",drag:"state-drag",tap:"state-tap",active:"active",tooltip:"tooltip",pips:"pips",pipsHorizontal:"pips-horizontal",pipsVertical:"pips-vertical",marker:"marker",markerHorizontal:"marker-horizontal",markerVertical:"marker-vertical",markerNormal:"marker-normal",markerLarge:"marker-large",markerSub:"marker-sub",value:"value",valueHorizontal:"value-horizontal",valueVertical:"value-vertical",valueNormal:"value-normal",valueLarge:"value-large",valueSub:"value-sub"},D={tooltips:".__tooltips",aria:".__aria"};function j(we,de){if(!n(de))throw new Error("noUiSlider: 'step' is not numeric.");we.singleStep=de}function V(we,de){if(!n(de))throw new Error("noUiSlider: 'keyboardPageMultiplier' is not numeric.");we.keyboardPageMultiplier=de}function Z(we,de){if(!n(de))throw new Error("noUiSlider: 'keyboardMultiplier' is not numeric.");we.keyboardMultiplier=de}function Q(we,de){if(!n(de))throw new Error("noUiSlider: 'keyboardDefaultStep' is not numeric.");we.keyboardDefaultStep=de}function X(we,de){if(typeof de!="object"||Array.isArray(de))throw new Error("noUiSlider: 'range' is not an object.");if(de.min===void 0||de.max===void 0)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");we.spectrum=new S(de,we.snap||!1,we.singleStep)}function $(we,de){if(de=g(de),!Array.isArray(de)||!de.length)throw new Error("noUiSlider: 'start' option is incorrect.");we.handles=de.length,we.start=de}function re(we,de){if(typeof de!="boolean")throw new Error("noUiSlider: 'snap' option must be a boolean.");we.snap=de}function H(we,de){if(typeof de!="boolean")throw new Error("noUiSlider: 'animate' option must be a boolean.");we.animate=de}function N(we,de){if(typeof de!="number")throw new Error("noUiSlider: 'animationDuration' option must be a number.");we.animationDuration=de}function U(we,de){var Ie,De=[!1];if(de==="lower"?de=[!0,!1]:de==="upper"&&(de=[!1,!0]),de===!0||de===!1){for(Ie=1;Ie<we.handles;Ie++)De.push(de);De.push(!1)}else{if(!Array.isArray(de)||!de.length||de.length!==we.handles+1)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");De=de}we.connect=De}function te(we,de){switch(de){case"horizontal":we.ort=0;break;case"vertical":we.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function B(we,de){if(!n(de))throw new Error("noUiSlider: 'margin' option must be numeric.");de!==0&&(we.margin=we.spectrum.getDistance(de))}function K(we,de){if(!n(de))throw new Error("noUiSlider: 'limit' option must be numeric.");if(we.limit=we.spectrum.getDistance(de),!we.limit||we.handles<2)throw new Error("noUiSlider: 'limit' option is only supported on linear sliders with 2 or more handles.")}function J(we,de){var Ie;if(!n(de)&&!Array.isArray(de))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(Array.isArray(de)&&de.length!==2&&!n(de[0])&&!n(de[1]))throw new Error("noUiSlider: 'padding' option must be numeric or array of exactly 2 numbers.");if(de!==0){for(Array.isArray(de)||(de=[de,de]),we.padding=[we.spectrum.getDistance(de[0]),we.spectrum.getDistance(de[1])],Ie=0;Ie<we.spectrum.xNumSteps.length-1;Ie++)if(we.padding[0][Ie]<0||we.padding[1][Ie]<0)throw new Error("noUiSlider: 'padding' option must be a positive number(s).");var De=de[0]+de[1],Oe=we.spectrum.xVal[0];if(De/(we.spectrum.xVal[we.spectrum.xVal.length-1]-Oe)>1)throw new Error("noUiSlider: 'padding' option must not exceed 100% of the range.")}}function ee(we,de){switch(de){case"ltr":we.dir=0;break;case"rtl":we.dir=1;break;default:throw new Error("noUiSlider: 'direction' option was not recognized.")}}function ne(we,de){if(typeof de!="string")throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var Ie=de.indexOf("tap")>=0,De=de.indexOf("drag")>=0,Oe=de.indexOf("fixed")>=0,Ve=de.indexOf("snap")>=0,Fe=de.indexOf("hover")>=0,ze=de.indexOf("unconstrained")>=0,Re=de.indexOf("drag-all")>=0,We=de.indexOf("smooth-steps")>=0;if(Oe){if(we.handles!==2)throw new Error("noUiSlider: 'fixed' behaviour must be used with 2 handles");B(we,we.start[1]-we.start[0])}if(ze&&(we.margin||we.limit))throw new Error("noUiSlider: 'unconstrained' behaviour cannot be used with margin or limit");we.events={tap:Ie||Ve,drag:De,dragAll:Re,smoothSteps:We,fixed:Oe,snap:Ve,hover:Fe,unconstrained:ze}}function se(we,de){if(de!==!1)if(de===!0||Y(de)){we.tooltips=[];for(var Ie=0;Ie<we.handles;Ie++)we.tooltips.push(de)}else{if((de=g(de)).length!==we.handles)throw new Error("noUiSlider: must pass a formatter for all handles.");de.forEach(function(De){if(typeof De!="boolean"&&!Y(De))throw new Error("noUiSlider: 'tooltips' must be passed a formatter or 'false'.")}),we.tooltips=de}}function oe(we,de){if(de.length!==we.handles)throw new Error("noUiSlider: must pass a attributes for all handles.");we.handleAttributes=de}function me(we,de){if(!Y(de))throw new Error("noUiSlider: 'ariaFormat' requires 'to' method.");we.ariaFormat=de}function ce(we,de){if(!G(de))throw new Error("noUiSlider: 'format' requires 'to' and 'from' methods.");we.format=de}function ye(we,de){if(typeof de!="boolean")throw new Error("noUiSlider: 'keyboardSupport' option must be a boolean.");we.keyboardSupport=de}function Se(we,de){we.documentElement=de}function fe(we,de){if(typeof de!="string"&&de!==!1)throw new Error("noUiSlider: 'cssPrefix' must be a string or `false`.");we.cssPrefix=de}function ge(we,de){if(typeof de!="object")throw new Error("noUiSlider: 'cssClasses' must be an object.");typeof we.cssPrefix=="string"?(we.cssClasses={},Object.keys(de).forEach(function(Ie){we.cssClasses[Ie]=we.cssPrefix+de[Ie]})):we.cssClasses=de}function Te(we){var de={margin:null,limit:null,padding:null,animate:!0,animationDuration:300,ariaFormat:E,format:E},Ie={step:{r:!1,t:j},keyboardPageMultiplier:{r:!1,t:V},keyboardMultiplier:{r:!1,t:Z},keyboardDefaultStep:{r:!1,t:Q},start:{r:!0,t:$},connect:{r:!0,t:U},direction:{r:!0,t:ee},snap:{r:!1,t:re},animate:{r:!1,t:H},animationDuration:{r:!1,t:N},range:{r:!0,t:X},orientation:{r:!1,t:te},margin:{r:!1,t:B},limit:{r:!1,t:K},padding:{r:!1,t:J},behaviour:{r:!0,t:ne},ariaFormat:{r:!1,t:me},format:{r:!1,t:ce},tooltips:{r:!1,t:se},keyboardSupport:{r:!0,t:ye},documentElement:{r:!1,t:Se},cssPrefix:{r:!0,t:fe},cssClasses:{r:!0,t:ge},handleAttributes:{r:!1,t:oe}},De={connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal",keyboardSupport:!0,cssPrefix:"noUi-",cssClasses:z,keyboardPageMultiplier:5,keyboardMultiplier:1,keyboardDefaultStep:10};we.format&&!we.ariaFormat&&(we.ariaFormat=we.format),Object.keys(Ie).forEach(function(Re){if(v(we[Re])||De[Re]!==void 0)Ie[Re].t(de,v(we[Re])?we[Re]:De[Re]);else if(Ie[Re].r)throw new Error("noUiSlider: '"+Re+"' is required.")}),de.pips=we.pips;var Oe=document.createElement("div"),Ve=Oe.style.msTransform!==void 0,Fe=Oe.style.transform!==void 0;de.transformRule=Fe?"transform":Ve?"msTransform":"webkitTransform";var ze=[["left","top"],["right","bottom"]];return de.style=ze[de.dir][de.ort],de}function le(we,de,Ie){var De,Oe,Ve,Fe,ze,Re=p(),We=i()&&u(),$e=we,at=de.spectrum,gt=[],xt=[],mt=[],nt=0,Qe={},vt=we.ownerDocument,jt=de.documentElement||vt.documentElement,Gt=vt.body,$t=vt.dir==="rtl"||de.ort===1?0:100;function Zt(sr,xr){var jr=vt.createElement("div");return xr&&a(jr,xr),sr.appendChild(jr),jr}function cr(sr,xr){var jr=Zt(sr,de.cssClasses.origin),Rt=Zt(jr,de.cssClasses.handle);if(Zt(Rt,de.cssClasses.touchArea),Rt.setAttribute("data-handle",String(xr)),de.keyboardSupport&&(Rt.setAttribute("tabindex","0"),Rt.addEventListener("keydown",function(wt){return gr(wt,xr)})),de.handleAttributes!==void 0){var or=de.handleAttributes[xr];Object.keys(or).forEach(function(wt){Rt.setAttribute(wt,or[wt])})}return Rt.setAttribute("role","slider"),Rt.setAttribute("aria-orientation",de.ort?"vertical":"horizontal"),xr===0?a(Rt,de.cssClasses.handleLower):xr===de.handles-1&&a(Rt,de.cssClasses.handleUpper),jr}function Dt(sr,xr){return!!xr&&Zt(sr,de.cssClasses.connect)}function Ne(sr,xr){var jr=Zt(xr,de.cssClasses.connects);Oe=[],(Ve=[]).push(Dt(jr,sr[0]));for(var Rt=0;Rt<de.handles;Rt++)Oe.push(cr(xr,Rt)),mt[Rt]=Rt,Ve.push(Dt(jr,sr[Rt+1]))}function Ye(sr){return a(sr,de.cssClasses.target),de.dir===0?a(sr,de.cssClasses.ltr):a(sr,de.cssClasses.rtl),de.ort===0?a(sr,de.cssClasses.horizontal):a(sr,de.cssClasses.vertical),a(sr,getComputedStyle(sr).direction==="rtl"?de.cssClasses.textDirectionRtl:de.cssClasses.textDirectionLtr),Zt(sr,de.cssClasses.base)}function pe(sr,xr){return!(!de.tooltips||!de.tooltips[xr])&&Zt(sr.firstChild,de.cssClasses.tooltip)}function _e(){return $e.hasAttribute("disabled")}function Be(sr){return Oe[sr].hasAttribute("disabled")}function He(){ze&&(nr("update"+D.tooltips),ze.forEach(function(sr){sr&&d(sr)}),ze=null)}function Je(){He(),ze=Oe.map(pe),mr("update"+D.tooltips,function(sr,xr,jr){if(ze&&de.tooltips&&ze[xr]!==!1){var Rt=sr[xr];de.tooltips[xr]!==!0&&(Rt=de.tooltips[xr].to(jr[xr])),ze[xr].innerHTML=Rt}})}function Ze(){nr("update"+D.aria),mr("update"+D.aria,function(sr,xr,jr,Rt,or){mt.forEach(function(wt){var ir=Oe[wt],ar=dr(xt,wt,0,!0,!0,!0),Dr=dr(xt,wt,100,!0,!0,!0),Pr=or[wt],Er=String(de.ariaFormat.to(jr[wt]));ar=at.fromStepping(ar).toFixed(1),Dr=at.fromStepping(Dr).toFixed(1),Pr=at.fromStepping(Pr).toFixed(1),ir.children[0].setAttribute("aria-valuemin",ar),ir.children[0].setAttribute("aria-valuemax",Dr),ir.children[0].setAttribute("aria-valuenow",Pr),ir.children[0].setAttribute("aria-valuetext",Er)})})}function ct(sr){if(sr.mode===m.PipsMode.Range||sr.mode===m.PipsMode.Steps)return at.xVal;if(sr.mode===m.PipsMode.Count){if(sr.values<2)throw new Error("noUiSlider: 'values' (>= 2) required for mode 'count'.");for(var xr=sr.values-1,jr=100/xr,Rt=[];xr--;)Rt[xr]=xr*jr;return Rt.push(100),lt(Rt,sr.stepped)}return sr.mode===m.PipsMode.Positions?lt(sr.values,sr.stepped):sr.mode===m.PipsMode.Values?sr.stepped?sr.values.map(function(or){return at.fromStepping(at.getStep(at.toStepping(or)))}):sr.values:[]}function lt(sr,xr){return sr.map(function(jr){return at.fromStepping(xr?at.getStep(jr):jr)})}function At(sr){function xr(Pr,Er){return Number((Pr+Er).toFixed(7))}var jr=ct(sr),Rt={},or=at.xVal[0],wt=at.xVal[at.xVal.length-1],ir=!1,ar=!1,Dr=0;return(jr=y(jr.slice().sort(function(Pr,Er){return Pr-Er})))[0]!==or&&(jr.unshift(or),ir=!0),jr[jr.length-1]!==wt&&(jr.push(wt),ar=!0),jr.forEach(function(Pr,Er){var Ar,vr,wr,Mr,Lr,Zr,Yr,rn,sn,yn,kn=Pr,wn=jr[Er+1],Pn=sr.mode===m.PipsMode.Steps;for(Pn&&(Ar=at.xNumSteps[Er]),Ar||(Ar=wn-kn),wn===void 0&&(wn=kn),Ar=Math.max(Ar,1e-7),vr=kn;vr<=wn;vr=xr(vr,Ar)){for(rn=(Lr=(Mr=at.toStepping(vr))-Dr)/(sr.density||1),yn=Lr/(sn=Math.round(rn)),wr=1;wr<=sn;wr+=1)Rt[(Zr=Dr+wr*yn).toFixed(5)]=[at.fromStepping(Zr),0];Yr=jr.indexOf(vr)>-1?m.PipsType.LargeValue:Pn?m.PipsType.SmallValue:m.PipsType.NoValue,!Er&&ir&&vr!==wn&&(Yr=0),vr===wn&&ar||(Rt[Mr.toFixed(5)]=[vr,Yr]),Dr=Mr}}),Rt}function Ot(sr,xr,jr){var Rt,or,wt=vt.createElement("div"),ir=((Rt={})[m.PipsType.None]="",Rt[m.PipsType.NoValue]=de.cssClasses.valueNormal,Rt[m.PipsType.LargeValue]=de.cssClasses.valueLarge,Rt[m.PipsType.SmallValue]=de.cssClasses.valueSub,Rt),ar=((or={})[m.PipsType.None]="",or[m.PipsType.NoValue]=de.cssClasses.markerNormal,or[m.PipsType.LargeValue]=de.cssClasses.markerLarge,or[m.PipsType.SmallValue]=de.cssClasses.markerSub,or),Dr=[de.cssClasses.valueHorizontal,de.cssClasses.valueVertical],Pr=[de.cssClasses.markerHorizontal,de.cssClasses.markerVertical];function Er(vr,wr){var Mr=wr===de.cssClasses.value,Lr=Mr?ir:ar;return wr+" "+(Mr?Dr:Pr)[de.ort]+" "+Lr[vr]}function Ar(vr,wr,Mr){if((Mr=xr?xr(wr,Mr):Mr)!==m.PipsType.None){var Lr=Zt(wt,!1);Lr.className=Er(Mr,de.cssClasses.marker),Lr.style[de.style]=vr+"%",Mr>m.PipsType.NoValue&&((Lr=Zt(wt,!1)).className=Er(Mr,de.cssClasses.value),Lr.setAttribute("data-value",String(wr)),Lr.style[de.style]=vr+"%",Lr.innerHTML=String(jr.to(wr)))}}return a(wt,de.cssClasses.pips),a(wt,de.ort===0?de.cssClasses.pipsHorizontal:de.cssClasses.pipsVertical),Object.keys(sr).forEach(function(vr){Ar(vr,sr[vr][0],sr[vr][1])}),wt}function it(){Fe&&(d(Fe),Fe=null)}function ht(sr){it();var xr=At(sr),jr=sr.filter,Rt=sr.format||{to:function(or){return String(Math.round(or))}};return Fe=$e.appendChild(Ot(xr,jr,Rt))}function Ut(){var sr=De.getBoundingClientRect(),xr="offset"+["Width","Height"][de.ort];return de.ort===0?sr.width||De[xr]:sr.height||De[xr]}function Mt(sr,xr,jr,Rt){var or=function(ir){var ar=It(ir,Rt.pageOffset,Rt.target||xr);return!!ar&&!(_e()&&!Rt.doNotReject)&&!(l($e,de.cssClasses.tap)&&!Rt.doNotReject)&&!(sr===Re.start&&ar.buttons!==void 0&&ar.buttons>1)&&(!Rt.hover||!ar.buttons)&&(We||ar.preventDefault(),ar.calcPoint=ar.points[de.ort],void jr(ar,Rt))},wt=[];return sr.split(" ").forEach(function(ir){xr.addEventListener(ir,or,!!We&&{passive:!0}),wt.push([ir,or])}),wt}function It(sr,xr,jr){var Rt=sr.type.indexOf("touch")===0,or=sr.type.indexOf("mouse")===0,wt=sr.type.indexOf("pointer")===0,ir=0,ar=0;if(sr.type.indexOf("MSPointer")===0&&(wt=!0),sr.type==="mousedown"&&!sr.buttons&&!sr.touches)return!1;if(Rt){var Dr=function(Ar){var vr=Ar.target;return vr===jr||jr.contains(vr)||sr.composed&&sr.composedPath().shift()===jr};if(sr.type==="touchstart"){var Pr=Array.prototype.filter.call(sr.touches,Dr);if(Pr.length>1)return!1;ir=Pr[0].pageX,ar=Pr[0].pageY}else{var Er=Array.prototype.find.call(sr.changedTouches,Dr);if(!Er)return!1;ir=Er.pageX,ar=Er.pageY}}return xr=xr||s(vt),(or||wt)&&(ir=sr.clientX+xr.x,ar=sr.clientY+xr.y),sr.pageOffset=xr,sr.points=[ir,ar],sr.cursor=or||wt,sr}function Le(sr){var xr=100*(sr-t(De,de.ort))/Ut();return xr=r(xr),de.dir?100-xr:xr}function Xe(sr){var xr=100,jr=!1;return Oe.forEach(function(Rt,or){if(!Be(or)){var wt=xt[or],ir=Math.abs(wt-sr);(ir<xr||ir<=xr&&sr>wt||ir===100&&xr===100)&&(jr=or,xr=ir)}}),jr}function ot(sr,xr){sr.type==="mouseout"&&sr.target.nodeName==="HTML"&&sr.relatedTarget===null&&St(sr,xr)}function pt(sr,xr){if(navigator.appVersion.indexOf("MSIE 9")===-1&&sr.buttons===0&&xr.buttonsProperty!==0)return St(sr,xr);var jr=(de.dir?-1:1)*(sr.calcPoint-xr.startCalcPoint);Ir(jr>0,100*jr/xr.baseSize,xr.locations,xr.handleNumbers,xr.connect)}function St(sr,xr){xr.handle&&(h(xr.handle,de.cssClasses.active),nt-=1),xr.listeners.forEach(function(jr){jt.removeEventListener(jr[0],jr[1])}),nt===0&&(h($e,de.cssClasses.drag),Xr(),sr.cursor&&(Gt.style.cursor="",Gt.removeEventListener("selectstart",w))),de.events.smoothSteps&&(xr.handleNumbers.forEach(function(jr){cn(jr,xt[jr],!0,!0,!1,!1)}),xr.handleNumbers.forEach(function(jr){Qt("update",jr)})),xr.handleNumbers.forEach(function(jr){Qt("change",jr),Qt("set",jr),Qt("end",jr)})}function Vt(sr,xr){if(!xr.handleNumbers.some(Be)){var jr;xr.handleNumbers.length===1&&(jr=Oe[xr.handleNumbers[0]].children[0],nt+=1,a(jr,de.cssClasses.active)),sr.stopPropagation();var Rt=[],or=Mt(Re.move,jt,pt,{target:sr.target,handle:jr,connect:xr.connect,listeners:Rt,startCalcPoint:sr.calcPoint,baseSize:Ut(),pageOffset:sr.pageOffset,handleNumbers:xr.handleNumbers,buttonsProperty:sr.buttons,locations:xt.slice()}),wt=Mt(Re.end,jt,St,{target:sr.target,handle:jr,listeners:Rt,doNotReject:!0,handleNumbers:xr.handleNumbers}),ir=Mt("mouseout",jt,ot,{target:sr.target,handle:jr,listeners:Rt,doNotReject:!0,handleNumbers:xr.handleNumbers});Rt.push.apply(Rt,or.concat(wt,ir)),sr.cursor&&(Gt.style.cursor=getComputedStyle(sr.target).cursor,Oe.length>1&&a($e,de.cssClasses.drag),Gt.addEventListener("selectstart",w,!1)),xr.handleNumbers.forEach(function(ar){Qt("start",ar)})}}function Jt(sr){sr.stopPropagation();var xr=Le(sr.calcPoint),jr=Xe(xr);jr!==!1&&(de.events.snap||o($e,de.cssClasses.tap,de.animationDuration),cn(jr,xr,!0,!0),Xr(),Qt("slide",jr,!0),Qt("update",jr,!0),de.events.snap?Vt(sr,{handleNumbers:[jr]}):(Qt("change",jr,!0),Qt("set",jr,!0)))}function qt(sr){var xr=Le(sr.calcPoint),jr=at.getStep(xr),Rt=at.fromStepping(jr);Object.keys(Qe).forEach(function(or){or.split(".")[0]==="hover"&&Qe[or].forEach(function(wt){wt.call(qn,Rt)})})}function gr(sr,xr){if(_e()||Be(xr))return!1;var jr=["Left","Right"],Rt=["Down","Up"],or=["PageDown","PageUp"],wt=["Home","End"];de.dir&&!de.ort?jr.reverse():de.ort&&!de.dir&&(Rt.reverse(),or.reverse());var ir,ar=sr.key.replace("Arrow",""),Dr=ar===or[0],Pr=ar===or[1],Er=ar===Rt[0]||ar===jr[0]||Dr,Ar=ar===Rt[1]||ar===jr[1]||Pr,vr=ar===wt[0],wr=ar===wt[1];if(!(Er||Ar||vr||wr))return!0;if(sr.preventDefault(),Ar||Er){var Mr=Er?0:1,Lr=ln(xr)[Mr];if(Lr===null)return!1;Lr===!1&&(Lr=at.getDefaultStep(xt[xr],Er,de.keyboardDefaultStep)),Lr*=Pr||Dr?de.keyboardPageMultiplier:de.keyboardMultiplier,Lr=Math.max(Lr,1e-7),Lr*=Er?-1:1,ir=gt[xr]+Lr}else ir=wr?de.spectrum.xVal[de.spectrum.xVal.length-1]:de.spectrum.xVal[0];return cn(xr,at.toStepping(ir),!0,!0),Qt("slide",xr),Qt("update",xr),Qt("change",xr),Qt("set",xr),!1}function Cr(sr){sr.fixed||Oe.forEach(function(xr,jr){Mt(Re.start,xr.children[0],Vt,{handleNumbers:[jr]})}),sr.tap&&Mt(Re.start,De,Jt,{}),sr.hover&&Mt(Re.move,De,qt,{hover:!0}),sr.drag&&Ve.forEach(function(xr,jr){if(xr!==!1&&jr!==0&&jr!==Ve.length-1){var Rt=Oe[jr-1],or=Oe[jr],wt=[xr],ir=[Rt,or],ar=[jr-1,jr];a(xr,de.cssClasses.draggable),sr.fixed&&(wt.push(Rt.children[0]),wt.push(or.children[0])),sr.dragAll&&(ir=Oe,ar=mt),wt.forEach(function(Dr){Mt(Re.start,Dr,Vt,{handles:ir,handleNumbers:ar,connect:xr})})}})}function mr(sr,xr){Qe[sr]=Qe[sr]||[],Qe[sr].push(xr),sr.split(".")[0]==="update"&&Oe.forEach(function(jr,Rt){Qt("update",Rt)})}function tr(sr){return sr===D.aria||sr===D.tooltips}function nr(sr){var xr=sr&&sr.split(".")[0],jr=xr?sr.substring(xr.length):sr;Object.keys(Qe).forEach(function(Rt){var or=Rt.split(".")[0],wt=Rt.substring(or.length);xr&&xr!==or||jr&&jr!==wt||tr(wt)&&jr!==wt||delete Qe[Rt]})}function Qt(sr,xr,jr){Object.keys(Qe).forEach(function(Rt){var or=Rt.split(".")[0];sr===or&&Qe[Rt].forEach(function(wt){wt.call(qn,gt.map(de.format.to),xr,gt.slice(),jr||!1,xt.slice(),qn)})})}function dr(sr,xr,jr,Rt,or,wt,ir){var ar;return Oe.length>1&&!de.events.unconstrained&&(Rt&&xr>0&&(ar=at.getAbsoluteDistance(sr[xr-1],de.margin,!1),jr=Math.max(jr,ar)),or&&xr<Oe.length-1&&(ar=at.getAbsoluteDistance(sr[xr+1],de.margin,!0),jr=Math.min(jr,ar))),Oe.length>1&&de.limit&&(Rt&&xr>0&&(ar=at.getAbsoluteDistance(sr[xr-1],de.limit,!1),jr=Math.min(jr,ar)),or&&xr<Oe.length-1&&(ar=at.getAbsoluteDistance(sr[xr+1],de.limit,!0),jr=Math.max(jr,ar))),de.padding&&(xr===0&&(ar=at.getAbsoluteDistance(0,de.padding[0],!1),jr=Math.max(jr,ar)),xr===Oe.length-1&&(ar=at.getAbsoluteDistance(100,de.padding[1],!0),jr=Math.min(jr,ar))),ir||(jr=at.getStep(jr)),!((jr=r(jr))===sr[xr]&&!wt)&&jr}function _r(sr,xr){var jr=de.ort;return(jr?xr:sr)+", "+(jr?sr:xr)}function Ir(sr,xr,jr,Rt,or){var wt=jr.slice(),ir=Rt[0],ar=de.events.smoothSteps,Dr=[!sr,sr],Pr=[sr,!sr];Rt=Rt.slice(),sr&&Rt.reverse(),Rt.length>1?Rt.forEach(function(Ar,vr){var wr=dr(wt,Ar,wt[Ar]+xr,Dr[vr],Pr[vr],!1,ar);wr===!1?xr=0:(xr=wr-wt[Ar],wt[Ar]=wr)}):Dr=Pr=[!0];var Er=!1;Rt.forEach(function(Ar,vr){Er=cn(Ar,jr[Ar]+xr,Dr[vr],Pr[vr],!1,ar)||Er}),Er&&(Rt.forEach(function(Ar){Qt("update",Ar),Qt("slide",Ar)}),or!=null&&Qt("drag",ir))}function Rr(sr,xr){return de.dir?100-sr-xr:sr}function Vr(sr,xr){xt[sr]=xr,gt[sr]=at.fromStepping(xr);var jr="translate("+_r(Rr(xr,0)-$t+"%","0")+")";Oe[sr].style[de.transformRule]=jr,an(sr),an(sr+1)}function Xr(){mt.forEach(function(sr){var xr=xt[sr]>50?-1:1,jr=3+(Oe.length+xr*sr);Oe[sr].style.zIndex=String(jr)})}function cn(sr,xr,jr,Rt,or,wt){return or||(xr=dr(xt,sr,xr,jr,Rt,!1,wt)),xr!==!1&&(Vr(sr,xr),!0)}function an(sr){if(Ve[sr]){var xr=0,jr=100;sr!==0&&(xr=xt[sr-1]),sr!==Ve.length-1&&(jr=xt[sr]);var Rt=jr-xr,or="translate("+_r(Rr(xr,Rt)+"%","0")+")",wt="scale("+_r(Rt/100,"1")+")";Ve[sr].style[de.transformRule]=or+" "+wt}}function zn(sr,xr){return sr===null||sr===!1||sr===void 0?xt[xr]:(typeof sr=="number"&&(sr=String(sr)),(sr=de.format.from(sr))!==!1&&(sr=at.toStepping(sr)),sr===!1||isNaN(sr)?xt[xr]:sr)}function on(sr,xr,jr){var Rt=g(sr),or=xt[0]===void 0;xr=xr===void 0||xr,de.animate&&!or&&o($e,de.cssClasses.tap,de.animationDuration),mt.forEach(function(ar){cn(ar,zn(Rt[ar],ar),!0,!1,jr)});var wt=mt.length===1?0:1;if(or&&at.hasNoSize()&&(jr=!0,xt[0]=0,mt.length>1)){var ir=100/(mt.length-1);mt.forEach(function(ar){xt[ar]=ar*ir})}for(;wt<mt.length;++wt)mt.forEach(function(ar){cn(ar,xt[ar],!0,!0,jr)});Xr(),mt.forEach(function(ar){Qt("update",ar),Rt[ar]!==null&&xr&&Qt("set",ar)})}function Tn(sr){on(de.start,sr)}function Mn(sr,xr,jr,Rt){if(!((sr=Number(sr))>=0&&sr<mt.length))throw new Error("noUiSlider: invalid handle number, got: "+sr);cn(sr,zn(xr,sr),!0,!0,Rt),Qt("update",sr),jr&&Qt("set",sr)}function ei(sr){if(sr===void 0&&(sr=!1),sr)return gt.length===1?gt[0]:gt.slice(0);var xr=gt.map(de.format.to);return xr.length===1?xr[0]:xr}function Hr(){for(nr(D.aria),nr(D.tooltips),Object.keys(de.cssClasses).forEach(function(sr){h($e,de.cssClasses[sr])});$e.firstChild;)$e.removeChild($e.firstChild);delete $e.noUiSlider}function ln(sr){var xr=xt[sr],jr=at.getNearbySteps(xr),Rt=gt[sr],or=jr.thisStep.step,wt=null;if(de.snap)return[Rt-jr.stepBefore.startValue||null,jr.stepAfter.startValue-Rt||null];or!==!1&&Rt+or>jr.stepAfter.startValue&&(or=jr.stepAfter.startValue-Rt),wt=Rt>jr.thisStep.startValue?jr.thisStep.step:jr.stepBefore.step!==!1&&Rt-jr.stepBefore.highestStep,xr===100?or=null:xr===0&&(wt=null);var ir=at.countStepDecimals();return or!==null&&or!==!1&&(or=Number(or.toFixed(ir))),wt!==null&&wt!==!1&&(wt=Number(wt.toFixed(ir))),[wt,or]}function bn(){return mt.map(ln)}function nn(sr,xr){var jr=ei(),Rt=["margin","limit","padding","range","animate","snap","step","format","pips","tooltips"];Rt.forEach(function(wt){sr[wt]!==void 0&&(Ie[wt]=sr[wt])});var or=Te(Ie);Rt.forEach(function(wt){sr[wt]!==void 0&&(de[wt]=or[wt])}),at=or.spectrum,de.margin=or.margin,de.limit=or.limit,de.padding=or.padding,de.pips?ht(de.pips):it(),de.tooltips?Je():He(),xt=[],on(v(sr.start)?sr.start:jr,xr)}function pn(){De=Ye($e),Ne(de.connect,De),Cr(de.events),on(de.start),de.pips&&ht(de.pips),de.tooltips&&Je(),Ze()}pn();var qn={destroy:Hr,steps:bn,on:mr,off:nr,get:ei,set:on,setHandle:Mn,reset:Tn,__moveHandles:function(sr,xr,jr){Ir(sr,xr,xt,jr)},options:Ie,updateOptions:nn,target:$e,removePips:it,removeTooltips:He,getPositions:function(){return xt.slice()},getTooltips:function(){return ze},getOrigins:function(){return Oe},pips:ht};return qn}function ve(we,de){if(!we||!we.nodeName)throw new Error("noUiSlider: create requires a single element, got: "+we);if(we.noUiSlider)throw new Error("noUiSlider: Slider was already initialized.");var Ie=le(we,Te(de),de);return we.noUiSlider=Ie,Ie}var Me={__spectrum:S,cssClasses:z,create:ve};m.create=ve,m.cssClasses=z,m.default=Me,Object.defineProperty(m,"__esModule",{value:!0})})(Ge)}));function S0(Ee,Ge){if(!Array.isArray(Ee)||!Array.isArray(Ge))return!1;const m=Ge.slice().sort();return Ee.length===Ge.length&&Ee.slice().sort().every(function(G,Y){return G===m[Y]})}var Jh={name:"Slider",emits:["input","update:modelValue","update","change"],props:{value:{validator:function(Ee){return Ge=>typeof Ge=="number"||Ge instanceof Array||Ge==null||Ge===!1},required:!1},modelValue:{validator:function(Ee){return Ge=>typeof Ge=="number"||Ge instanceof Array||Ge==null||Ge===!1},required:!1},id:{type:[String,Number],required:!1},disabled:{type:Boolean,required:!1,default:!1},min:{type:Number,required:!1,default:0},max:{type:Number,required:!1,default:100},step:{type:Number,required:!1,default:1},orientation:{type:String,required:!1,default:"horizontal"},direction:{type:String,required:!1,default:"ltr"},tooltips:{type:Boolean,required:!1,default:!0},options:{type:Object,required:!1,default:()=>({})},merge:{type:Number,required:!1,default:-1},format:{type:[Object,Function,Boolean],required:!1,default:null},classes:{type:Object,required:!1,default:()=>({})},showTooltip:{type:String,required:!1,default:"always"},tooltipPosition:{type:String,required:!1,default:null},lazy:{type:Boolean,required:!1,default:!0},ariaLabelledby:{type:String,required:!1,default:void 0},aria:{required:!1,type:Object,default:()=>({})}},setup(Ee,Ge){const m=function(v,w,y){const{value:e,modelValue:t}=wf(v),n=t&&t.value!==void 0?t:e,o=ku(n.value);if(Fh(n.value))throw new Error("Slider v-model must be a Number or Array");if(Array.isArray(n.value)&&n.value.length==0)throw new Error("Slider v-model must not be an empty array");return{value:n,initialValue:o}}(Ee),G=function(v,w,y){const{classes:e,showTooltip:t,tooltipPosition:n,orientation:o}=wf(v),r=Gl(()=>({target:"slider-target",focused:"slider-focused",tooltipFocus:"slider-tooltip-focus",tooltipDrag:"slider-tooltip-drag",ltr:"slider-ltr",rtl:"slider-rtl",horizontal:"slider-horizontal",vertical:"slider-vertical",textDirectionRtl:"slider-txt-dir-rtl",textDirectionLtr:"slider-txt-dir-ltr",base:"slider-base",connects:"slider-connects",connect:"slider-connect",origin:"slider-origin",handle:"slider-handle",handleLower:"slider-handle-lower",handleUpper:"slider-handle-upper",touchArea:"slider-touch-area",tooltip:"slider-tooltip",tooltipTop:"slider-tooltip-top",tooltipBottom:"slider-tooltip-bottom",tooltipLeft:"slider-tooltip-left",tooltipRight:"slider-tooltip-right",tooltipHidden:"slider-tooltip-hidden",active:"slider-active",draggable:"slider-draggable",tap:"slider-state-tap",drag:"slider-state-drag",pips:"slider-pips",pipsHorizontal:"slider-pips-horizontal",pipsVertical:"slider-pips-vertical",marker:"slider-marker",markerHorizontal:"slider-marker-horizontal",markerVertical:"slider-marker-vertical",markerNormal:"slider-marker-normal",markerLarge:"slider-marker-large",markerSub:"slider-marker-sub",value:"slider-value",valueHorizontal:"slider-value-horizontal",valueVertical:"slider-value-vertical",valueNormal:"slider-value-normal",valueLarge:"slider-value-large",valueSub:"slider-value-sub",...e.value}));return{classList:Gl(()=>{const g={...r.value};return Object.keys(g).forEach(c=>{g[c]=Array.isArray(g[c])?g[c].filter(a=>a!==null).join(" "):g[c]}),t.value!=="always"&&(g.target+=` ${t.value==="drag"?g.tooltipDrag:g.tooltipFocus}`),o.value==="horizontal"&&(g.tooltip+=n.value==="bottom"?` ${g.tooltipBottom}`:` ${g.tooltipTop}`),o.value==="vertical"&&(g.tooltip+=n.value==="right"?` ${g.tooltipRight}`:` ${g.tooltipLeft}`),g})}}(Ee),Y=function(v,w,y){const{format:e,step:t}=wf(v),n=y.value,o=y.classList,r=Gl(()=>e&&e.value?typeof e.value=="function"?{to:e.value}:A0({...e.value}):A0({decimals:t.value>=0?0:2})),g=Gl(()=>Array.isArray(n.value)?n.value.map(c=>r.value):r.value);return{tooltipFormat:r,tooltipsFormat:g,tooltipsMerge:(c,a,h)=>{var l=getComputedStyle(c).direction==="rtl",s=c.noUiSlider.options.direction==="rtl",p=c.noUiSlider.options.orientation==="vertical",u=c.noUiSlider.getTooltips(),i=c.noUiSlider.getOrigins();u.forEach(function(x,f){x&&i[f].appendChild(x)}),c.noUiSlider.on("update",function(x,f,_,b,T){var k=[[]],L=[[]],A=[[]],I=0;u[0]&&(k[0][0]=0,L[0][0]=T[0],A[0][0]=r.value.to(parseFloat(x[0])));for(var P=1;P<x.length;P++)(!u[P]||x[P]-x[P-1]>a)&&(k[++I]=[],A[I]=[],L[I]=[]),u[P]&&(k[I].push(P),A[I].push(r.value.to(parseFloat(x[P]))),L[I].push(T[P]));k.forEach(function(S,E){for(var z=S.length,D=0;D<z;D++){var j=S[D];if(D===z-1){var V=0;L[E].forEach(function($){V+=1e3-$});var Z=p?"bottom":"right",Q=s?0:z-1,X=1e3-L[E][Q];V=(l&&!p?100:0)+V/z-X,u[j].innerHTML=A[E].join(h),u[j].style.display="block",u[j].style[Z]=V+"%",o.value.tooltipHidden.split(" ").forEach($=>{u[j].classList.contains($)&&u[j].classList.remove($)})}else u[j].style.display="none",o.value.tooltipHidden.split(" ").forEach($=>{u[j].classList.add($)})}})})}}}(Ee,0,{value:m.value,classList:G.classList}),d=function(v,w,y){const{orientation:e,direction:t,tooltips:n,step:o,min:r,max:g,merge:c,id:a,disabled:h,options:l,classes:s,format:p,lazy:u,ariaLabelledby:i,aria:x}=wf(v),f=y.value,_=y.initialValue,b=y.tooltipsFormat,T=y.tooltipsMerge,k=y.tooltipFormat,L=y.classList,A=ku(null),I=ku(null),P=ku(!1),S=Gl(()=>{let $={cssPrefix:"",cssClasses:L.value,orientation:e.value,direction:t.value,tooltips:!!n.value&&b.value,connect:"lower",start:Fh(f.value)?r.value:f.value,range:{min:r.value,max:g.value}};if(o.value>0&&($.step=o.value),Array.isArray(f.value)&&($.connect=!0),i&&i.value||x&&Object.keys(x.value).length){let re=Array.isArray(f.value)?f.value:[f.value];$.handleAttributes=re.map(H=>Object.assign({},x.value,i&&i.value?{"aria-labelledby":i.value}:{}))}return p.value&&($.ariaFormat=k.value),$}),E=Gl(()=>{let $={id:a&&a.value?a.value:void 0};return h.value&&($.disabled=!0),$}),z=Gl(()=>Array.isArray(f.value)),D=()=>{let $=I.value.get();return Array.isArray($)?$.map(re=>parseFloat(re)):parseFloat($)},j=function($){let re=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];I.value.set($,re)},V=$=>{w.emit("input",$),w.emit("update:modelValue",$),w.emit("update",$)},Z=()=>{I.value=rx.create(A.value,Object.assign({},S.value,l.value)),n.value&&z.value&&c.value>=0&&T(A.value,c.value," - "),I.value.on("set",$=>{const re=D();w.emit("change",re),u.value&&V(re)}),I.value.on("update",$=>{if(!P.value)return;const re=D();z.value&&S0(f.value,re)||!z.value&&f.value==re?w.emit("update",re):u.value||V(re)}),A.value.querySelectorAll("[data-handle]").forEach($=>{$.onblur=()=>{L.value.focused.split(" ").forEach(re=>{A.value.classList.remove(re)})},$.onfocus=()=>{L.value.focused.split(" ").forEach(re=>{A.value.classList.add(re)})}}),P.value=!0},Q=()=>{I.value.off(),I.value.destroy(),I.value=null},X=($,re)=>{P.value=!1,Q(),Z()};return Hf(Z),vp(Q),rs(f,($,re)=>{re&&(typeof re=="object"&&typeof $=="object"&&$&&Object.keys(re)>Object.keys($)||typeof re=="object"&&typeof $!="object"||!$)&&X()},{immediate:!1}),rs(z,X,{immediate:!1}),rs(r,X,{immediate:!1}),rs(g,X,{immediate:!1}),rs(o,X,{immediate:!1}),rs(e,X,{immediate:!1}),rs(t,X,{immediate:!1}),rs(n,X,{immediate:!1}),rs(c,X,{immediate:!1}),rs(p,X,{immediate:!1,deep:!0}),rs(l,X,{immediate:!1,deep:!0}),rs(s,X,{immediate:!1,deep:!0}),rs(f,$=>{if(Fh($))return void j(r.value,!1);let re=D();z.value&&!Array.isArray(re)&&(re=[re]),(z.value&&!S0($,re)||!z.value&&$!=re)&&j($,!1)},{deep:!0}),{slider:A,slider$:I,isRange:z,sliderProps:E,init:Z,destroy:Q,refresh:X,update:j,reset:()=>{V(_.value)}}}(Ee,Ge,{value:m.value,initialValue:m.initialValue,tooltipFormat:Y.tooltipFormat,tooltipsFormat:Y.tooltipsFormat,tooltipsMerge:Y.tooltipsMerge,classList:G.classList});return{...G,...Y,...d}}};Jh.render=function(Ee,Ge,m,G,Y,d){return Pl(),Il("div",dm(Ee.sliderProps,{ref:"slider"}),null,16)},Jh.__file="src/Slider.vue";const nx="/palbert/assets/model_lambda_vue.c6ec2dc2.svg";const ix={components:{Slider:Jh},data:function(){let Ee=0,Ge=12,m=!0;return window.innerWidth<=768?(Ee=400,Ge=12,m=!1):Ee=600,{lambdas:[.1,.1,.7,.4],data:[{x:[1,2,3,4],y:[.3,.4,.5,.6],type:"scatter",line:{color:"#A1E887",width:4,shape:"spline"},name:"Model's CDF"},{x:[3,3],y:[0,1],mode:"lines",line:{color:"#D0C4DF",width:4},name:"Exit Layer"},{x:[1,4],y:[.5,.5],mode:"lines",line:{color:"black"},name:"Threshold"},{x:[1,2,3,4],y:[.1,.1,.1,.1],name:"Model's PDF",line:{color:"#E3D985",width:4,shape:"spline"}}],attr:{displayModeBar:!0},layout:{height:Ee,width:Ee,font:{size:Ge},title:"Lambda-layers conditioning",xaxis:{title:"Layer",showgrid:!1,zeroline:!1,tickfont:{size:14},dtick:1},yaxis:{tickfont:{size:14},range:[0,1.05],tickvals:[0,.2,.4,.5,.6,.8,1]},showlegend:m}}},created(){window.addEventListener("resize",this.update_layout)},destroyed(){window.removeEventListener("resize",this.update_layout)},methods:{fun:function(){let Ee=1,Ge=0,m=!1,G=0;for(const Y of Array(4).keys())G=Ee*this.lambdas[Y],this.data[3].y[Y]=G,Ge+=G,this.data[0].y[Y]=Ge,Ee=Ee*(1-this.lambdas[Y]),Ge>.5&&m==!1&&(this.data[1].x[0]=Y+1,this.data[1].x[1]=Y+1,m=!0);M0.newPlot(this.$refs.plot1,this.data,this.layout)},format_n:function(Ee){return Ee},update_layout:function(){let Ee=0,Ge=!0,m=0;window.innerWidth<=768?(Ee=400,Ge=!1,m=370):(Ee=650,m=600),this.layout.width=Ee,this.layout.height=m,this.layout.showlegend=Ge,M0.newPlot(this.$refs.plot1,this.data,this.layout)}},mounted(){this.fun(),this.update_layout()}},ax=Ee=>(mp("data-v-dd687839"),Ee=Ee(),gp(),Ee),ox={class:"pic-container"},sx={ref:"plot1",id:"plot1"},lx={class:"text-container"},cx={class:"row"},ux=ax(()=>Aa("div",{class:"column-1"},[Aa("div",{class:"pic-container-c"},[Aa("img",{class:"pic",alt:"",src:nx})])],-1)),fx={class:"column-2"},hx={class:"container-slider"},px={class:"container-slider"},dx={class:"container-slider"},mx={class:"container-slider"};function gx(Ee,Ge,m,G,Y,d){const v=yp("Slider");return Pl(),Il(Is,null,[Aa("div",ox,[Aa("div",sx,null,512)]),Aa("div",lx,[Aa("div",cx,[ux,Aa("div",fx,[Aa("div",hx,[Ra(v,{modelValue:Ee.lambdas[0],"onUpdate:modelValue":Ge[0]||(Ge[0]=w=>Ee.lambdas[0]=w),onUpdate:d.fun,max:1,step:.1,format:d.format_n},null,8,["modelValue","onUpdate","step","format"])]),Aa("div",px,[Ra(v,{modelValue:Ee.lambdas[1],"onUpdate:modelValue":Ge[1]||(Ge[1]=w=>Ee.lambdas[1]=w),onUpdate:d.fun,max:1,step:.1,format:d.format_n},null,8,["modelValue","onUpdate","step","format"])]),Aa("div",dx,[Ra(v,{modelValue:Ee.lambdas[2],"onUpdate:modelValue":Ge[2]||(Ge[2]=w=>Ee.lambdas[2]=w),onUpdate:d.fun,max:1,step:.1,format:d.format_n},null,8,["modelValue","onUpdate","step","format"])]),Aa("div",mx,[Ra(v,{modelValue:Ee.lambdas[3],"onUpdate:modelValue":Ge[3]||(Ge[3]=w=>Ee.lambdas[3]=w),onUpdate:d.fun,max:1,step:.1,format:d.format_n},null,8,["modelValue","onUpdate","step","format"])])])])])],64)}const vx=Ol(ix,[["render",gx],["__scopeId","data-v-dd687839"]]),yx={data(){return{h:"h \\in \\{0, 1\\}",h_pure:"h = 1",lambda:"\\lambda",bern_sample:"h \\sim \\operatorname{Bern}(\\lambda_i)"}}},xx=Aa("div",{class:"text-container"},[Aa("h2",null,"Q-Exit")],-1),bx={class:"text-container"},_x={class:"text"},wx={class:"text-container"},Tx={class:"text-container"},kx={class:"text"},Mx={class:"text-container"},Ax={class:"text"};function Sx(Ee,Ge,m,G,Y,d){const v=yp("math-jax");return Pl(),Il(Is,null,[xx,Aa("div",bx,[Aa("div",_x,[tl(" After the model training is finished, we must choose the exit layer. The original PonderNet paper proposed a criterion based on sampling from the Bernoulli distribution. On every step after we get the current "),Ra(v,{latex:Y.lambda},null,8,["latex"]),tl(", we perform sampling of a random number "),Ra(v,{latex:Y.h},null,8,["latex"]),tl(". ")])]),Aa("div",wx,[Ra(v,{class:"formula",latex:Y.bern_sample,block:!0},null,8,["latex"])]),Aa("div",Tx,[Aa("div",kx,[tl(" Halting is performed if "),Ra(v,{latex:Y.h_pure},null,8,["latex"]),tl(". ")])]),Aa("div",Mx,[Aa("div",Ax,[tl(" However, this criterion could be seen as running the Monte-Carlo algorithm for a sample size 1, which implies high variance. This criterion could yield different predictions for the same example. To address this issue, we present a novel exit criterion called Q-Exit (where Q stands for quantile). At every step, we can calculate the value of the Cumulative Distribution Function (CDF). If CDF becomes greater than the predefined threshold, we perform an exit. In the demo below, you can see how CDF changes with different "),Ra(v,{latex:Y.lambda},null,8,["latex"]),tl(" values: ")])])],64)}const Ex=Ol(yx,[["render",Sx]]),Lx="/palbert/assets/logo.81cfb7c3.svg";const Cx={},Px={class:"text-container"},Ix=Gf('<div class="container" data-v-f91a99f5><div class="centered" data-v-f91a99f5><a href="https://github.com/tinkoff-ai" data-v-f91a99f5><img class="logo" alt="" src="'+Lx+'" data-v-f91a99f5></a><p class="centered-text" target="_blank" data-v-f91a99f5>Tinkoff 2022</p></div></div>',1),Ox=[Ix];function Dx(Ee,Ge){return Pl(),Il("div",Px,Ox)}const zx=Ol(Cx,[["render",Dx],["__scopeId","data-v-f91a99f5"]]),Rx="/palbert/assets/glue_results_albert.d4e80377.png";const Fx={},Bx=Gf('<div class="text-container" data-v-0d501f0c><h2 data-v-0d501f0c>Results</h2></div><div class="text-container" data-v-0d501f0c><div class="text" data-v-0d501f0c>We evaluate our method on the GLUE benchmark.</div></div><div class="pic-container" data-v-0d501f0c><img class="pic" src="'+Rx+'" alt="" data-v-0d501f0c></div><div class="text-container" data-v-0d501f0c><div class="text" data-v-0d501f0c> As you can see, PALBERT with Q-Exit and some additional tricks described in the paper outperforms all early exiting strategies in the macro score. </div></div><div class="text-container" data-v-0d501f0c><div class="text" data-v-0d501f0c> More experiments and analysis can be found in our paper. </div></div>',5);function Nx(Ee,Ge){return Bx}const jx=Ol(Fx,[["render",Nx],["__scopeId","data-v-0d501f0c"]]),Ux="/palbert/assets/bg_filler.a943a2ec.svg";const Vx={},wm=Ee=>(mp("data-v-c3c8d906"),Ee=Ee(),gp(),Ee),Hx={class:"text-container"},qx=wm(()=>Aa("img",{alt:"",class:"b-image",src:Ux},null,-1)),Gx=wm(()=>Aa("h1",{class:"title-container"},"PALBERT: Teaching ALBERT to Ponder",-1)),Yx=[qx,Gx];function Wx(Ee,Ge){return Pl(),Il("div",Hx,Yx)}const Zx=Ol(Vx,[["render",Wx],["__scopeId","data-v-c3c8d906"]]);const Xx={__name:"App",setup(Ee){return(Ge,m)=>(Pl(),Il("main",null,[Ra(By),Ra(Zx),Ra(Vy),Ra(Qy),Ra(Ex),Ra(vx),Ra(jx),Ra(zx)]))}},Kx=Ol(Xx,[["__scopeId","data-v-656f851a"]]);function Jx(){const Ee=document.getElementById("elementId");vm(Ee)}Hy({},Jx);Ly(Kx).use(qy).mount("#app");
